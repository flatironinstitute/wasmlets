import { describe, expect, test } from "vitest";

import { init, wavedec, waverec } from "wasmlets";
import { expectArrayCloseTo } from "./util";

// prettier-ignore-start
describe("test all wavelets against pywt", () => {
  test("test_bior1.1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5052308594296697, 0.9326220113612328, 1.2201182018886811,
      1.333599619168563, 1.2726398581448075, 1.0686460628031518,
      0.7759781047690972, 0.4583088743661669, 0.173592280495732,
      -0.038716967765984545, -0.16516074434954808, -0.21880984461175948,
      -0.23289917948333128, -0.24935296076053387, -0.3052518218114983,
      -0.4207932335385479, -0.5919085203132999, -0.7895209721630747,
      -0.965751673462469, -1.0656176709550804, -1.041357197847016,
      -0.8658090811668362, -0.541446228634588, -0.10267809810944911,
      0.3893509436944699, 0.858423957471813, 1.228753737735673,
      1.4407525047923198, 1.4634041123532178, 1.3003657332540013,
      0.9884107424287303, 0.5886419332445382, 0.17261300686649939,
      -0.1933179352445339, -0.46170263707887776, -0.6126053824078508,
      -0.6552021955108098, -0.622220249838725, -0.558818245044472,
      -0.5088560673136783, -0.5021108036294496, -0.5457191272507544,
      -0.6220343668768245, -0.693451862854099, -0.7129837478407759,
      -0.6378932350250475, -0.44289393699860724, -0.12948284093752704,
      0.2711060188011039, 0.7022894845972374, 1.093023412532557,
      1.3727354453144027, 1.4868193770540519, 1.4090218113424047,
      1.147755920922597, 0.744803096718189, 0.26666601352700353,
      -0.20942130411003942, -0.6115623060092881, -0.8876114045075509,
      -1.0146286217271885, -1.001296059986188, -0.8829337299396947,
      -0.7105415207202952, -0.5367188388984263, -0.40202721684947884,
      -0.32519270117243976, -0.29953968293496125, -0.29645703870171736,
      -0.2749155669176612, -0.19452375576134948, -0.028705978424746648,
      0.22546279420147586, 0.5434150513130895, 0.8764076063811013,
      1.1613780919214647, 1.335074595581436, 1.3490895782258026,
      1.182145992646726, 0.8465932994439318, 0.3874289302364491,
      -0.12606181820496798, -0.6141893046047913, -1.003085007596567,
      -1.2395282401168042, -1.3009743300898777, -1.1985420868127725,
      -0.9724101976576799, -0.6808859057500105, -0.3859036176841789,
      -0.13852369898059502, 0.032062109277547546, 0.1234322546511728,
      0.15770386647356455, 0.1729178813553924, 0.21038191886495805,
      0.30131301998138293, 0.4562867969356009, 0.6602876210988509,
      0.8747424575596126, 1.0461578244807894, 1.119301052423115,
      1.0516892925446577, 0.825765889954591, 0.4556524407126126,
      -0.013354456902343992, -0.5126305391198781, -0.9637248957017953,
      -1.2944427888004206, -1.4537930035987237, -1.4223322943545027,
      -1.215525331569065, -0.8793972385644929, -0.4795845016837514,
      -0.08644475432218651, 0.24020994131875323, 0.463155379374737,
      0.5738085154473563, 0.5910279783782533, 0.5531927776981125,
      0.5057378219625619, 0.4874213715796496, 0.5188773405943362,
      0.5963986995418474, 0.6925591914968521, 0.7635415170662905,
      0.7613319376417795, 0.6476872979657512, 0.4062925868898035,
      0.04992878333967421, -0.3793335873880711, -0.8172012091866302,
      -1.1899852783388147, -1.4302548257918433, -1.49165117503417,
      -1.3593544649842717, -1.05370052012967, -0.6260624628006782,
      -0.1479446270692731, 0.30415836948423813, 0.6645964805949274,
      0.8914199297675243, 0.9733360767721216, 0.9293003875207075,
      0.8010696454498207, 0.6407439536380897, 0.49651121608821325,
      0.40019556222868136, 0.35970831015200183, 0.3582341904102748,
      0.3602716252645071, 0.32290859294650226, 0.20938502478131418,
      0.0013983870370250506, -0.2931007836319124, -0.6387719317405482,
      -0.9789061732292568, -1.2473197152087028, -1.3833470784083284,
      -1.3463464786705863, -1.12618730295927, -0.7471108206043331,
      -0.26391881886204244, 0.24872822597126695, 0.7114755870910869,
      1.0564084540561214, 1.2404381773904023, 1.252892606810445,
      1.115662741302588, 0.8760468338701629, 0.5941747141173923,
      0.3281658902127924, 0.12066754872100238, -0.009983358362397499,
      -0.07192305792439575, -0.09488588460022768, -0.11969300235246755,
      -0.18491307136353008, -0.3142042793742118, -0.5076708403563179,
      -0.7395570582741842, -0.9630078425641809, -1.1208399148127746,
      -1.1597341657279963, -1.0443570745716446, -0.7678736510433465,
      -0.35614165240496637, 0.1356218547437199, 0.6330998423990928,
      1.0577802404971322, 1.3430897465832725, 1.4480241746638338,
      1.3651264225086663, 1.1210047970097228, 0.7693585418879447,
      0.3782529112538041, 0.01473211740273439, -0.2695504800916717,
      -0.4483099766512978, -0.5239616100397537, -0.5237128511312836,
      -0.4896118000777523, -0.46522710922061766, -0.4824411806387956,
      -0.551775760099489, -0.6587551243792795, -0.7672743465459123,
      -0.8291597635887529, -0.797526786010073, -0.6405490306973229,
      -0.3520997542050621, 0.04354703262104187, 0.4943377787705353,
      0.9299790421532825, 1.276287683822922, 1.471039977031108,
      1.4776013958788758, 1.2931118757264102, 0.9492767789950536,
      0.5055631997845532, 0.03640022884906352, -0.38460618450014167,
      -0.6997501336068679, -0.8781107384707112, -0.9198103722709392,
      -0.8528403410336529, -0.7234577625148382, -0.5827046567283825,
      -0.47250796787922233, -0.4148679168146879, -0.40682367581944456,
      -0.422404913181534, -0.4210028412957666, -0.3599646541415195,
      -0.20813424839531858, 0.04320180809147933, 0.3748839658062239,
      0.7415326496176607, 1.080097503737181, 1.3233915537889782,
      1.4154299128311087, 1.3248935445152956, 1.0534358091906062,
      0.6367501476673051, 0.13803150297854133, -0.364724019783491,
      -0.7946676506209469, -1.0916119099961574, -1.223544853889938,
      -1.1915539898586864, -1.027162307757313, -0.7829014812854338,
      -0.5185552923589434, -0.2865090474096454, -0.11979656273127859,
    ]);
    const expected = [
      [0.1230805895644313],
      [0.8339005849158545],
      [0.13009495023100665, -0.2829493516491658],
      [
        1.3832992435494642, -0.9704031797762138, -0.4994614501935749,
        1.3276676091111193,
      ],
      [
        0.9273644090397647, -1.9031494699305038, 1.687212866905078,
        -0.4852538511362303, -0.8655605435913698, 1.4464713663282251,
        -0.8587059876272525, -0.5150953848307029,
      ],
      [
        1.9217812703714907, -3.462247052925423, 0.5808328606937513,
        2.737313236415397, -2.4210460134506704, -0.6391878123576534,
        2.5247549079248577, -1.4179526673004565, -0.9627415472948052,
        2.0884471420515514, -1.108054223833736, -0.97156425854329,
        2.2103495725291555, -1.1309552338228712, -1.5198331754425716,
        2.743544061463699,
      ],
      [
        -0.6338832478729404, 0.5071147977843693, 0.26384126095986804,
        -0.9966961946345829, 0.9033573530089681, 0.10907207576561007,
        -1.2301524225950526, 1.4060660363110333, -0.32139567089129956,
        -1.206009076585492, 1.8511704705690408, -0.9418094984749458,
        -0.8710216531912437, 2.0823327090772903, -1.6012976261727165,
        -0.2646707872946469, 1.9988733383632615, -2.1285939732822228,
        0.49116185546623503, 1.587078585283537, -2.3831668868647204,
        1.2274842943903441, 0.9253833678150334, -2.2972832395511147,
        1.7778041089207217, 0.16183306870073377, -1.8962789689517943,
        2.027071112047595, -0.5293807939926211, -1.2909021244782215,
        1.9451661992452018, -0.9991810122986275,
      ],
      [
        -0.823754676910122, 0.3808076548705609, 0.41788943348871577,
        0.05144787923847072, 0.3712854458868481, -0.3498597795003361,
        -0.9002524248112327, 0.307690070731403, 0.7081377562172246,
        -0.043384541517731745, 0.07839331159222551, -0.1628242193356101,
        -0.8268448596331089, 0.1513885450517265, 0.9162263601822602,
        -0.009005118154428504, -0.26002022079840154, -0.063278699478834,
        -0.6115329209587309, -0.01739144168481377, 0.9871366762450702,
        0.12845158459463946, -0.5644343933714584, -0.08756369195011832,
        -0.30243973959405546, -0.1250450314636854, 0.903701663344713,
        0.30897880672550526, -0.7644466570638101, -0.2307355865660597,
        0.02631594374334434, -0.1179577818346852, 0.6916923444519758,
        0.4573597566502845, -0.8195239476219951, -0.44800057823024025,
        0.2965574316221127, 0.020699028352950732, 0.411998007161352,
        0.5064943443236131, -0.7307520710817406, -0.6683214091920849,
        0.44916690006273885, 0.26536992761029404, 0.14226923189252336,
        0.41830992937322686, -0.540037968425664, -0.8160741449687962,
        0.46139362913741633, 0.5554227426997541, -0.04641777593633373,
        0.19590626509345355, -0.31701888234822045, -0.8341909572923137,
        0.35312635909426016, 0.8131598733703133, -0.11081150359657965,
        -0.1167605159867362, -0.13765442597023125, -0.7017721897285694,
        0.1802460564570929, 0.9670866605251424, -0.048220233135048085,
        -0.44757558175172657,
      ],
      [
        -0.3572521667674268, -0.2032905058872584, 0.04310506039940898,
        0.2069474977618999, 0.20132503424212073, 0.08940925186107457,
        0.009962664230096507, 0.03952646370974153, 0.12099677964310784,
        0.12461392394206272, -0.017154745049506315, -0.22935917259056482,
        -0.34791707200027044, -0.26186269889989944, -0.016017105311087576,
        0.2205854894375363, 0.2941768750116702, 0.1897766426337942,
        0.030120495402038316, -0.044831987530838335, -0.004769621692009451,
        0.05396302344747045, 0.013811128323435007, -0.13788532596111241,
        -0.28325909918897274, -0.2762906100827204, -0.08066952175752906,
        0.18474288280858753, 0.33809397386124374, 0.28435662943611106,
        0.08981473562345044, -0.0836948062129157, -0.12291119704027509,
        -0.05433020706441846, -0.002179758641312368, -0.05684559482049639,
        -0.1797244626898637, -0.23546129377322594, -0.12282197560635966,
        0.11804694143856176, 0.3246782391458546, 0.3451582557168593,
        0.16719061308072747, -0.07243053383339126, -0.2061388036885196,
        -0.174924018044681, -0.06460844939169108, -0.010757933092013519,
        -0.0642979982201837, -0.14425036613347852, -0.12120896834954442,
        0.04780873389801377, 0.26170972976734597, 0.35304150342027063,
        0.23385286486976564, -0.022246080847526883, -0.23767845391083553,
        -0.27799178131332863, -0.1576462310839915, -0.012175999006827642,
        0.03355572100151527, -0.02224272899907881, -0.06799573594361824,
        0.001562408594641962, 0.17069183714437003, 0.30353433324980245,
        0.26359814321582453, 0.043413774889346834, -0.21612997710310788,
        -0.33808036385191237, -0.25486823256443863, -0.0579234630356249,
        0.09067282727490711, 0.10198794679061723, 0.02862881049502919,
        -0.0014406840016534805, 0.08027328487409777, 0.20824236063382007,
        0.24051122867040858, 0.09618587094538078, -0.15567604608591246,
        -0.3416683410470758, -0.32721179702400494, -0.13012866530955425,
        0.09703616848192365, 0.1993136873046107, 0.14672348435380672,
        0.0437979815849464, 0.017541281184301996, 0.09142268993215355,
        0.1639683171534247, 0.11160412857570567, -0.0815839235502347,
        -0.291138488268689, -0.3517700585621517, -0.20174428649049436,
        0.058617562694040615, 0.24865145157546398, 0.25704801843440844,
        0.12640205221880493, -0.00017589911105980738, -0.017242580262217477,
        0.04902695130737389, 0.0767346778831155, -0.02236789295500652,
        -0.20396443943603104, -0.3187571934984504, -0.24487718890810428,
        -0.004639623761461875, 0.2431281285086747, 0.33174831823011186,
        0.22284042346327432, 0.02948609383313694, -0.09148729863805483,
        -0.07792082594954514, -0.005688137357235334, -0.0009914145381371142,
        -0.10736030949344366, -0.23453470291868184, -0.23940150421934703,
        -0.06508094780797269, 0.19194960545363093, 0.35264733556358924,
        0.30401605689313077, 0.09329067928919665, -0.11624247318454428,
        -0.1869209827707416, -0.11788352842453158,
      ],
    ];
    const result = wavedec(data, "bior1.1");

    const reconstruction = waverec(result, "bior1.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior1.1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49615943626980136, 0.9158782855251091, 1.198544234591333,
      1.3114929530916406, 1.2556137133078757, 1.0632191990800943,
      0.7888326615251247, 0.4952506364221681, 0.2383562992466572,
      0.05441454743344937, -0.04708470574112894, -0.08338611666818627,
      -0.09139960190291845, -0.11553542391906252, -0.19365189247622955,
      -0.3447925812982938, -0.5619364127697726, -0.811721026456818,
      -1.0413412334000425, -1.1910070214653725, -1.2089215712120926,
      -1.0650643075866006, -0.7603075657965328, -0.3285012329320271,
      0.1691423903970473, 0.6561582363126552, 1.0566400887734968,
      1.311051232569176, 1.3883223327205767, 1.2914202317807553,
      1.0551513407404507, 0.7368395456477905, 0.40223021347721005,
      0.11009921573441434, -0.10068622720354459, -0.21856238848839651,
      -0.2594386650766435, -0.25977837399176656, -0.2644988397091467,
      -0.3128859380482636, -0.42620207820744405, -0.6002280853960739,
      -0.8047282925630554, -0.9900756748511712, -1.0994559152575825,
      -1.0836383655078574, -0.9146150542556433, -0.5946394088895932,
      -0.1582904947546585, 0.33312122720778875, 0.8036198549910442,
      1.1783244819256726, 1.3992091975063812, 1.43714992273958,
      1.2974330030170063, 1.0174762197048886, 0.6573899444392604,
      0.28572381193837304, -0.036118527836817516, -0.2670348455213203,
      -0.3938327421122897, -0.43157982440004516, -0.4168021270153809,
      -0.3954158334739918, -0.408576517585887, -0.48012898358965045,
      -0.6089170911919777, -0.7679732851004594, -0.9108608322542715,
      -0.9836227624681467, -0.9393531538052379, -0.7517076683486444,
      -0.4238871693642492, 0.009289773129391776, 0.48692760878938174,
      0.9340416971150001, 1.2772338001378967, 1.460370638235901,
      1.4565540054336292, 1.273550392327211, 0.9514190457608973,
      0.5529546720128922, 0.1492839907681045, -0.19589824388965693,
      -0.4396782405055806, -0.5677168525167047, -0.594748356388083,
      -0.5578630225354932, -0.5044376178147294, -0.4778891940513217,
      -0.5049412201952377, -0.5876819600112573, -0.7024664475335668,
      -0.8059720190856743, -0.8468968054888562, -0.7803442865768229,
      -0.5812258247685874, -0.25321592550896826, 0.16913566288820314,
      0.6258573055799276, 1.043431206201982, 1.350351954199895,
      1.4926959687634715, 1.4459935112565683, 1.2205657447924951,
      0.8590549781450619, 0.4267530865137721, -0.0029392014972471903,
      -0.36443443963037164, -0.6134742065187453, -0.7350768785208452,
      -0.7441515828631051, -0.67883145636597, -0.5883715936916238,
      -0.5187801496113751, -0.4998793211382547, -0.5370979452772997,
      -0.6100795827453982, -0.6784534122843748, -0.693292657363341,
      -0.6113305127323867, -0.40827941393928696, -0.08778778372821322,
      0.3163752290019933, 0.7456516553460275, 1.128425444723961,
      1.3954347643164813, 1.4952086039650445, 1.405824222081277,
      1.140143621344969, 0.7432469706556886, 0.28265666684448365,
      -0.16632252288902458, -0.536658741798841, -0.7832454064811027,
      -0.8909699265506525, -0.8754089217883695, -0.7761797356196161,
      -0.6447769652516917, -0.5300573963469157, -0.4650791765304696,
      -0.4586197978130736, -0.49348979663389414, -0.5320268837003245,
      -0.5273300680759331, -0.43732965555784226, -0.23805150107493955,
      0.06739272803920848, 0.44651440601921, 0.8426251137456264,
      1.1863918173605545, 1.4110771753243108, 1.467824208546479,
      1.3372881138902766, 1.0347699420621228, 0.6075600224237512,
      0.1250730584486039, -0.33590800625102, -0.7073916946814229,
      -0.9439344312602452, -1.0307960866936776, -0.9846830811172272,
      -0.8470877285828995, -0.6720378382294917, -0.5114164747403387,
      -0.40156796426161495, -0.35453819881573745, -0.35609932297603375,
      -0.37098053467018266, -0.3538985620696741, -0.2635083314394949,
      -0.07564309390147328, 0.20762854742356096, 0.5555716088395553,
      0.9137756400831765, 1.2155069206096218, 1.3967553402566333,
      1.4113532232629278, 1.2424761580918753, 0.9076775298772316,
      0.45615440252072004, -0.04118593903389274, -0.5065514524808792,
      -0.8714978850556051, -1.090755267260158, -1.150436196456711,
      -1.068794981184714, -0.889527323218557, -0.6694116126334035,
      -0.46344957077595517, -0.31123338679845114, -0.22791115680260388,
      -0.20193363079451396, -0.20004027209544578, -0.17811100108229516,
      -0.09502721227849209, 0.07407963198362966, 0.32867075614990626,
      0.6401969842624148, 0.9568746122175928, 1.2148111572193994,
      1.3528423118586068, 1.3274765927379315, 1.1242656955576937,
      0.7627492846621464, 0.2936610463125391, -0.21104848848673266,
      -0.6730765014149005, -1.024039748094409, -1.2193366357752022,
      -1.2463752062194984, -1.1253189637307506, -0.9023231647751486,
      -0.6370512203629781, -0.3876277785974158, -0.19676713535656204,
      -0.08247242318098758, -0.03552086589807443, -0.024228272302619647,
      -0.005150458074102582, 0.06311353403393488, 0.20663107453217244,
      0.42684583668229903, 0.6977727422322999, 0.9705335776831341,
      1.1842374797469382, 1.2805968720941387, 1.2186954218309476,
      0.9862342590212456, 0.6044018876065318, 0.1250428554234238,
      -0.37933462013518704, -0.830429665952686, -1.160425447763401,
      -1.3258529111138264, -1.3158074516052178, -1.1526554360571686,
      -0.885187853419919, -0.5760005417435273, -0.28625703995328217,
      -0.06158427468562261, 0.07748033061625853, 0.13824376269436922,
      0.1512874283254574, 0.15988501164606878, 0.20622399604263703,
      0.3180405485099693, 0.49916569566613106, 0.7264915618729443,
      0.9542458418353091, 1.1246134023767, 1.182125834199077, 1.088256068338501,
      0.8325524248455662,
    ]);
    const expected = [
      [0.3760212294020173, 0.5088178778375668],
      [0.8484264211674852, -0.8141793637092688],
      [
        0.8594340446149523, -0.8922109988069997, 1.264610795799699,
        -0.9107857252669811,
      ],
      [
        1.3563035190623143, -2.1561055100070057, 0.4972650842220592,
        1.4802532652177423, -1.2908600358558147, -0.8938352641110052,
        2.4438059794799463, -1.502867401982438,
      ],
      [
        1.6931941852490575, -3.396119085086915, 1.594508471119252,
        1.3201764686366384, -2.485917786149483, 1.5293286735713045,
        0.20756086655960326, -1.6602104424006594, 2.1788587825642947,
        -1.0330267157518855, -1.5007269387476672, 3.149323101621949,
        -1.6704270281841447, -1.8919001273515914, 3.673302255857399,
        -1.6341708726959856,
      ],
      [
        -0.6394283786897231, 0.43307101731937336, 0.518135750896244,
        -1.234787216083281, 0.7604088491814416, 0.6872160850995374,
        -1.7424190934657022, 1.214003697409339, 0.6041419956824752,
        -2.053288750452672, 1.6706280861286653, 0.31745070242993967,
        -2.106466437329933, 2.004043872045582, -0.07234569322874396,
        -1.904442725083489, 2.1170753773296527, -0.4384378056045043,
        -1.5123819652795536, 1.9663317506836426, -0.6600632681227019,
        -1.0415044558959776, 1.5733115633082473, -0.65331802978542,
        -0.6208101334942068, 1.0190742093970462, -0.3926235024129776,
        -0.364311554961846, 0.42382787146475764, 0.0825931259875381,
        -0.34208207006190183, -0.2230816714198518,
      ],
      [
        -0.8091315419233204, 0.35752740289714857, 0.36313854698825243,
        0.0672007989120937, 0.4731666328943971, -0.28727835964716597,
        -0.9360785838105662, 0.17640099638427342, 0.5648283852970655,
        0.02313808006793669, 0.3329341808517109, -0.0456390851726266,
        -0.9448354929215423, -0.07852462316226627, 0.7126304400212966,
        0.09375718189090804, 0.1425268618608746, 0.12207089945932681,
        -0.8359061098158337, -0.3528245732083166, 0.761365387653556,
        0.26344436225477513, -0.039735113051831694, 0.18136020851485324,
        -0.6387449243623227, -0.5868797055907286, 0.6903755956951148,
        0.4905887219559859, -0.15791564796303814, 0.12577786430710935,
        -0.4042779862141138, -0.7309166623462109, 0.5088211170228324,
        0.7181191461177014, -0.17271107373385708, -0.02151348921520868,
        -0.19198789757173795, -0.7575548985238811, 0.2534216639591953,
        0.8879663909023991, -0.07147985412689795, -0.21367407494623902,
        -0.05483648206852376, -0.6686808977003221, -0.020783560244273858,
        0.9557846619563619, 0.12848901266283086, -0.39212798913877717,
        -0.02584675720968846, -0.4949076603535918, -0.25431656757977317,
        0.9022012111970171, 0.38429779624269544, -0.5014815647727526,
        -0.10974521016842777, -0.28775691762731964, -0.39826401596282157,
        0.7377424689111189, 0.6382570363946773, -0.5036372462494701,
        -0.2817827039747663, -0.1065460522905401, -0.42660099333646706,
        0.30263852642322275,
      ],
      [
        -0.3508377019360712, -0.19987500939525826, 0.03951258937864932,
        0.19402058137141642, 0.18165172786522715, 0.07177081020511453,
        0.005666389750417389, 0.05523668463911853, 0.15354387572631148,
        0.1623660054270124, 0.012667499607809551, -0.2154955587320747,
        -0.3518871806702325, -0.2831834336172115, -0.05463891890680028,
        0.16706733503802496, 0.23660452782611946, 0.1490478160768408,
        0.028903892365206352, 0.0033378733191181398, 0.0801266111244418,
        0.14460348324182654, 0.07734350971918824, -0.11951752956504513,
        -0.3085452761481989, -0.3326927702445053, -0.15618908024758094,
        0.09879478138232844, 0.2546194470525315, 0.22757690092798216,
        0.08965965251966507, -0.010449410031018791, 0.009306008980575153,
        0.09106694422178835, 0.10103675353957309, -0.03130334048601757,
        -0.2318040978438236, -0.3377409525464447, -0.24267346329716244,
        0.0026987669357854127, 0.22778125958979423, 0.28543827607438266,
        0.17237848872475323, 0.019114159693122024, -0.03777746596568793,
        0.01912867113119876, 0.08116488950204775, 0.028938193984300975,
        -0.1407980146040379, -0.29864767220054944, -0.2952693367763722,
        -0.10065241795922175, 0.15940150233448358, 0.30568359909225706,
        0.25561573425057815, 0.08598607398308844, -0.04618830439408733,
        -0.04920858202170836, 0.026317541515152088, 0.04834759852270348,
        -0.057955988269140335, -0.22662180503578164, -0.3035442720713941,
        -0.1888041005238772, 0.06320430256217979, 0.2806483131326186,
        0.31747622967220523, 0.17436310274700062, -0.011003291989486574,
        -0.09291578999385802, -0.04594653986163916, 0.02465681262616909,
        -0.003321150177990062, -0.14091093437720092, -0.26807950939448166,
        -0.24307976727226166, -0.04012621200361355, 0.21391265073184473,
        0.3411698040609361, 0.26267863518932855, 0.06142046558206937,
        -0.09729460683677682, -0.11357645532660943, -0.03325506606439277,
        0.010522605701205279, -0.06391554503161567, -0.20030329849877518,
        -0.2532884995407225, -0.12816198661174683, 0.11941411796933377,
        0.31927506521634647, 0.3290631102887236, 0.15503838178204987,
        -0.05772905694313979, -0.15564531160045753, -0.10763309589683223,
        -0.018368884798770302, -0.015506336239876406, -0.11957659632280371,
        -0.22028230841582208, -0.18238868008660647, 0.017936271999902775,
        0.2556307056544638, 0.35688353458607286, 0.24816849167432753,
        0.019119156514751934, -0.15768184161761822, -0.17636900705931707,
        -0.08081856603311335, -0.007985069508529855, -0.04826993173045826,
        -0.15571535163373718, -0.19287103638939285, -0.06813637975972064,
        0.1643748645852503, 0.3389580222796962, 0.3189723658572099,
        0.11697488112957477, -0.11536589655827867, -0.2186284447432152,
        -0.1588676358686955, -0.042966234870600264, -0.006079409467820651,
        -0.07906624249855204, -0.16074366153394348, -0.12046805735302724,
        0.06637594798840674, 0.0,
      ],
    ];
    const result = wavedec(data, "bior1.1");

    const reconstruction = waverec(result, "bior1.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior1.3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.504501808656409, 0.9326025604935406, 1.2229961375873422,
      1.3411782575973135, 1.2851735120443275, 1.0840932818066826,
      0.790009840091484, 0.46517992375021294, 0.16770491946489124,
      -0.060973878695371575, -0.2038478165724492, -0.26967331921859244,
      -0.28774405393353736, -0.2975847430015889, -0.33627841969431066,
      -0.42670053873922315, -0.5696923698342193, -0.7422220605984499,
      -0.9020936691827799, -0.9981332466856191, -0.9834025927652327,
      -0.8282011469816561, -0.5296088979122686, -0.11510425451918124,
      0.3608233931627135, 0.8264862095941626, 1.2071172162708,
      1.4401312180045232, 1.488058933876666, 1.3462011017067357,
      1.0432624500074499, 0.6348492199712064, 0.19136302736201177,
      -0.21689295336749911, -0.5339657634784573, -0.7286316986636999,
      -0.7986326674390367, -0.7679895059132792, -0.6782716228030644,
      -0.5761339650565429, -0.5002935120173262, -0.47120411070413765,
      -0.48598314676656085, -0.5198198022129142, -0.5334748331110282,
      -0.4849593973040477, -0.3424253034421535, -0.09496821046562554,
      0.24147889082688734, 0.6248145259918615, 0.9940684780861321,
      1.2817838423184453, 1.4286726288947234, 1.3971383531354844,
      1.1804709292895867, 0.8054942356969246, 0.32795550897882825,
      -0.178369375659533, -0.6364199751433686, -0.9811206080082076,
      -1.171743867465283, -1.198636901302395, -1.0829172299225749,
      -0.8694014410636881, -0.6146096329228881, -0.3728150592057112,
      -0.18351564434827494, -0.06329863389347617, -0.003953596333869991,
      0.022865322473499636, 0.055742498967859655, 0.13096963030975528,
      0.2706257767588705, 0.4743630391796325, 0.7170813611877256,
      0.9532255157006064, 1.1267982316987475, 1.1847527076095266,
      1.09055314583538, 0.8345879877236821, 0.43881680403620604,
      -0.045634542745187565, -0.5475612860415715, -0.989499467597591,
      -1.3031980822508056, -1.4432562002233644, -1.3958507840257928,
      -1.1806176222798617, -0.845338199927742, -0.4547514894192837,
      -0.07615601773822217, 0.23482442389013697, 0.4450338340308492,
      0.5487306912851916, 0.5657195017589397, 0.5333514592781599,
      0.49455013301942197, 0.484955103040411, 0.5224551295049376,
      0.6017622773774243, 0.6954116799673866, 0.7609665150331025,
      0.7526541517772786, 0.6345349130096208, 0.39188384676288635,
      0.03785325033183373, -0.38641052715599045, -0.818461745580811,
      -1.1866853568629212, -1.4251582422218545, -1.487843218527861,
      -1.3588268442911153, -1.056202423167291, -0.6286614894794331,
      -0.14554414616010136, 0.31738949474145806, 0.6932265484391882,
      0.9367541873403886, 1.0320456773106605, 0.9931957534616443,
      0.8582529890538485, 0.67800061577278, 0.5024304619049706,
      0.3682540010998209, 0.29048403419206925, 0.2600792565144765,
      0.24812651249342613, 0.21541068836839566, 0.12488402767453705,
      -0.046180333699687326, -0.29750485754297445, -0.6029130139969916,
      -0.9141334723308815, -1.1705698662949056, -1.3128228069773495,
      -1.2967924428787634, -1.104987491694386, -0.7522734477429179,
      -0.28456757391364706, 0.22937037858370796, 0.711285269485721,
      1.0889367500490317, 1.3102869668020225, 1.3531888882964096,
      1.2284530345436977, 0.9757197509242176, 0.6532391923919956,
      0.3240635439493015, 0.04195341601770175, -0.15969397189453155,
      -0.2733700617580977, -0.3162882079068813, -0.32302056562396164,
      -0.33394076832786806, -0.3824833718446359, -0.48449988388984766,
      -0.6324566149236415, -0.7960121854424972, -0.9289254258040944,
      -0.9806626435866991, -0.9098810356502197, -0.6964532380397903,
      -0.3489939530210624, 0.09411383616060062, 0.5706640589377859,
      1.0063542858939014, 1.3297116599040073, 1.4868462541583967,
      1.4526647233117076, 1.2359773979741993, 0.8773393730046495,
      0.4401470457749909, -0.002932946017452198, -0.38506415077702705,
      -0.6584152510852761, -0.8024551006338743, -0.825607942900514,
      -0.7601091142104065, -0.651522826884446, -0.5456375951098981,
      -0.47604247259728993, -0.4554704992389353, -0.47303051434954363,
      -0.497970922391777, -0.48898844665919294, -0.4067073442189858,
      -0.22614717693257336, 0.054032782246009825, 0.40796749711338376,
      0.7857900656099265, 1.1230546201874432, 1.3543011630256174,
      1.4276443373109544, 1.3169656664833462, 1.0288015099812062,
      0.602228348099456, 0.10166734503777719, -0.3958231216231106,
      -0.8159165993766415, -1.101587049719836, -1.2236170883521906,
      -1.1847543378387448, -1.0167255772499033, -0.7709943584410096,
      -0.5055988686230433, -0.27128839045495773, -0.10028142656967148,
      -0.0002758990869006772, 0.044977318971583385, 0.06885102257235681,
      0.11061864752676326, 0.20275895773471797, 0.36007329386667924,
      0.5734519347100444, 0.8099806184201633, 1.0195126858735002,
      1.146225639774693, 1.1424228172495778, 0.9812378366967418,
      0.6651009186771245, 0.22778823646722351, -0.2706288084219669,
      -0.7549438879734479, -1.1496431898084905, -1.3940747709700312,
      -1.4545330513961385, -1.3305371702812003, -1.0539276457780447,
      -0.6810721570551301, -0.2800624625020352, 0.08407692773761605,
      0.36273039274923224, 0.5325450252478118, 0.597875690858973,
      0.5864638518773247, 0.5396253166685421, 0.49953132634653674,
      0.4968396096080805, 0.5418077067917204, 0.6211327589541986,
      0.7013270619585315, 0.7378058311632595, 0.6874294302202675,
      0.5213556480549444, 0.2349354819169531, -0.1479389181882273,
      -0.5773125478808581, -0.9861136247545845, -1.3036409938588072,
      -1.4705448379984605, -1.4518490256481105, -1.244977896202112,
      -0.8808874027362456, -0.41799183857131345, 0.06975449267191572,
    ]);
    const expected = [
      [
        1.7720606094607667, 1.772060609460767, 0.8076165990023632,
        -0.5176809418836794, 0.08211865359953313, 0.3711271135907026,
        -0.5866417715573298, 0.44976244638833607, -0.0024598727250747243,
        -0.6613337591382844, -2.8058629336761785, -2.8058629336761785,
      ],
      [
        0.0, 0.0, 0.0466483226810942, -0.9680304887838731, 1.3645594635415856,
        -1.0473365501224217, 0.2024034483988556, 0.6830970548225046,
        -1.1000895644905437, 1.1737484967987593, 0.0, 0.0,
      ],
      [
        5.551115123125783e-17, -5.551115123125783e-17, 2.7452967043503236,
        -3.6116110097900767, -0.6779561144869584, 4.180618335064966,
        -2.036023042827586, -2.754700463960327, 3.6858570910097406,
        0.13735257914519305, -3.3772688150071923, 2.192009900174032,
        1.3354207566536938, -2.9253530643993715, 1.2249358365740424,
        1.6750197524557606, -2.796250955457624, 1.2857299121796288,
        1.7473502792230509, -1.7473502792230509,
      ],
      [
        0.0, 0.0, 0.875057194257197, 0.21226579915067695, -0.9234642990155644,
        0.7133689725062455, -0.006754375488637554, -0.4175453854234298,
        0.21311402923626033, 0.24588179614764716, -0.318211691905706,
        -0.18808833053830365, 0.7647971040163888, -0.6913826643171394,
        -0.19423585911650698, 1.208460589074988, -1.3635776521961167,
        0.29897757519286067, 1.2582717899258322, -2.0006805352614196,
        1.152737668327917, 0.7677171107306823, -2.2605037813116367,
        2.0445082183551735, -0.1661643471496571, -1.949994639147172,
        2.6114898694460846, -1.2415872530403786, -1.1157828509341505,
        2.6132650112796822, -2.083732447693253, -0.02692681633142824,
        2.0400249995462474, -1.7728986705202976, 0.0, 1.7728986705202976,
      ],
      [
        -2.7755575615628914e-17, 2.7755575615628914e-17, -0.23687468981785442,
        0.6451516245021849, 0.1353463384180282, 0.18149882071929918,
        0.187406390624707, -0.8254619815283698, -0.4632664709184986,
        0.811455636569838, 0.3902844164650974, -0.20056297213293695,
        0.06347922729297506, -0.49465908267612224, -0.5705594248940834,
        0.7460200399781866, 0.6869659875604592, -0.42201123637671334,
        -0.24210020339968769, -0.15339816552461927, -0.46746682684920204,
        0.5110515757277205, 0.8789545849345499, -0.42643732986589233,
        -0.6201664231014903, 0.0601194223976641, -0.15602330731029684,
        0.23862276943173055, 0.8587418719483625, -0.25680145369444163,
        -0.9212257447802759, 0.07367044695949321, 0.2674993094645998,
        0.06979208360522679, 0.6072909838426603, -0.034123031537462545,
        -1.022277434662617, -0.08728285490893195, 0.6543571631025766,
        0.08998210219737424, 0.2038195378499854, 0.09915517064579182,
        -0.8819794509452028, -0.31242649367083386, 0.868937922211096,
        0.289917460717818, -0.20865682839482091, 0.0453999795548109,
        -0.5591928909957069, -0.4581027304257024, 0.8485591701696363,
        0.5698316631557029, -0.4864713018344152, -0.20245418515286828,
        -0.1865125444584989, -0.41409740388600436, 0.6304417204705139,
        0.7850369984176823, -0.5486066819695661, -0.556412374693042,
        0.08923448479722673, -0.15538330172227532, 0.33369814323035746,
        0.8122001165852291, -0.4115497413339322, 0.0, 0.0,
      ],
      [
        0.3567366500218249, -0.3567366500218249, -0.2053392675760456,
        0.03960133535914345, 0.20794839587149572, 0.2103465927636483,
        0.1010271303277071, 0.01277793905796068, 0.027360561178463444,
        0.10111049342155326, 0.11304629854918125, -0.010416145278417388,
        -0.21113660412670654, -0.33653166703002985, -0.26914676595091236,
        -0.0338900128999744, 0.21420997490007465, 0.31359209415656486,
        0.22420433415933302, 0.0494981597106684, -0.06344012354093492,
        -0.053627298632290044, 0.010450356619139956, 0.009655564945368178,
        -0.10078682432002528, -0.23790402683449308, -0.2611019735057913,
        -0.10386605706834962, 0.1532070046636541, 0.33767087194155554,
        0.32389068502158347, 0.13479099941398065, -0.08182616434934964,
        -0.18016501532714152, -0.13385489992033867, -0.041963278488167895,
        -0.023247674445428933, -0.09875180818855098, -0.17162777141014268,
        -0.12273444451125226, 0.06660914891530001, 0.2798524877836411,
        0.35491580384375254, 0.22181841767011368, -0.033520691258273616,
        -0.23707835313749237, -0.26770742535219816, -0.1486404993797218,
        -0.012012903090280358, 0.027436680916585188, -0.02651652300774171,
        -0.06622012762543145, 0.00587772842587897, 0.17158021440521215,
        0.299999794073461, 0.26037341253057944, 0.04432497182449513,
        -0.21398778032930965, -0.3416155495699289, -0.2657569292908376,
        -0.06738125874734924, 0.09541894378481108, 0.12414684637389356,
        0.05499167097312463, 0.008451866351071674, 0.06401201565480112,
        0.1777132750880685, 0.22006609653187892, 0.1005880190002838,
        -0.13562658164762798, -0.3307179949854573, -0.3407652873115887,
        -0.1565182392831519, 0.08820156804563606, 0.2280281897389596,
        0.19948198450183863, 0.08038113400129898, 0.0047604957951210836,
        0.0343248041231565, 0.10462120783618972, 0.09398385356916295,
        -0.05005015495517218, -0.24569081662297193, -0.3369718941017077,
        -0.2286481919092206, 0.02416999225303096, 0.253595379447319,
        0.31330486680451636, 0.19328841667276708, 0.01637153177048345,
        -0.07678210011205755, -0.04921118306617378, 0.012416805762449412,
        -0.006351569502353771, -0.1276753187003997, -0.25026963698004734,
        -0.23848205359562258, -0.051861455890908736, 0.20376282915756483,
        0.35395007966245334, 0.2970509468517618, 0.08628826782539434,
        -0.11881427604674077, -0.18766295054660936, -0.12092018379340895,
        -0.03199885735966761, -0.02953417083931726, -0.11123803385676972,
        -0.16725103619655318, -0.08959958896771192, 0.1139749927743321,
        0.3092267630894987, 0.34246247698175447, 0.1728392285754754,
        -0.08767832837557377, -0.2636486444785972, -0.25748543213559194,
        -0.12007707818444707, 0.008069388729732452, 0.028350732441517812,
        -0.0317972464556075, -0.056705935466892454, 0.035621494718562074,
        0.20252964174475122, 0.3036130052183408, 0.22452575590591972,
        -0.013219935692723617, -0.2574508568952706, -0.3448887383209474,
        0.3448887383209474,
      ],
    ];
    const result = wavedec(data, "bior1.3");

    const reconstruction = waverec(result, "bior1.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior1.3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5033664070939932, 0.9255496422632533, 1.2031085007856612,
      1.3037056334541894, 1.231830734984056, 1.0255793594879297,
      0.7454613606293459, 0.458230617531158, 0.21996323965716663,
      0.06274805162154629, -0.011640677937621302, -0.02958091336627069,
      -0.03568827006389497, -0.07792803278103161, -0.19183927300264136,
      -0.3881882043911297, -0.6474643689040525, -0.9228298768254646,
      -1.1508985149919502, -1.2676402748928597, -1.2253210874314218,
      -1.0060605966238663, -0.6284114156090727, -0.14512239044767003,
      0.36750699882468285, 0.8261233578059102, 1.1586087633018904,
      1.3196417547880392, 1.2997042327413901, 1.125382315926257,
      0.8510288755118309, 0.5440477603616274, 0.26765913093823507,
      0.06560057597460683, -0.04734073167616065, -0.08663468583495103,
      -0.09098474463676764, -0.1089989167110963, -0.1832345611457203,
      -0.3359815103152281, -0.5606856745082482, -0.8214261267707702,
      -1.0607308025550288, -1.21380405677928, -1.2255205534051812,
      -1.0657639816797893, -0.7390611505228688, -0.285889431347068,
      0.22484851866415628, 0.7104303387909277, 1.0924301914213501,
      1.3138701351561428, 1.351171411734488, 1.217995119129439,
      0.9601288245186435, 0.6428513063612507, 0.33410456183369364,
      0.08783196382382846, -0.06825927469520437, -0.13745436412493534,
      -0.15023538006190293, -0.15311652532821843, -0.19322589550540592,
      -0.3028593578395985, -0.4882305567071204, -0.7255289468637516,
      -0.9654652513335638, -1.1452347000934637, -1.2048495217650985,
      -1.1036005265811117, -0.832316316736147, -0.4181252651378031,
      0.07967543165880461, 0.5817672607118369, 1.0060402804073814,
      1.28566007561293, 1.3835016973788323, 1.29940092691, 1.0685014960372121,
      0.7512410605975066, 0.41763439146443115, 0.12993409700970954,
      -0.07188781055811172, -0.17818033216078222, -0.20924636754043072,
      -0.2068563193037745, -0.220060666106632, -0.2892077681043965,
      -0.43253251536627296, -0.6389933544634661, -0.8693796740422367,
      -1.0655203595845415, -1.1652691145255523, -1.1193856673406637,
      -0.9058819635189119, -0.5380054934461493, -0.06363523867561326,
      0.4439434758576468, 0.9017065826931974, 1.2351611597582461,
      1.394697171088252, 1.365978459921485, 1.1718436840205257,
      0.8653462256877208, 0.5158084860957914, 0.19152107815086666,
      -0.056470261815948386, -0.2053845656203236, -0.26382260810738956,
      -0.26636002377061035, -0.2612328897318142, -0.2945356425801215,
      -0.3952523044642614, -0.5652071189238344, -0.7767120349927265,
      -0.9786477466523424, -1.109474624296112, -1.1138146656751693,
      -0.9582607459564708, -0.6422144104081371, -0.20079434827740406,
      0.30112415896377787, 0.782404108318078, 1.1633989123284876,
      1.3835775960966576, 1.414654322895402, 1.2659887794740163,
      0.980986540567094, 0.6255121070167808, 0.27134283857405117,
      -0.021079649603055972, -0.21621767662013244, -0.3099469409022464,
      -0.3275005082289521, -0.313590934322611, -0.3174973583101215,
      -0.377209517688433, -0.506949077191968, -0.6914822534622924,
      -0.8888336593695132, -1.0407804934479536, -1.0884308983250754,
      -0.9888127749582765, -0.7280809111897111, -0.32777736512605765,
      0.1576585771717706, 0.651693127855983, 1.0722338171568917,
      1.3498312654160884, 1.4430324775100496, 1.3470812701271617,
      1.0938465336129326, 0.7430847150884035, 0.3673350911443364,
      0.034340068961923875, -0.20853165967257697, -0.34395192098570293,
      -0.38605799725322987, -0.3734724150610623, -0.35595132492773884,
      -0.37834959417684794, -0.466273136561437, -0.6173232951197634,
      -0.8003469903041228, -0.9629794303021281, -1.0455586520745752,
      -0.9977795502951414, -0.793687379456934, -0.4409899874444791,
      0.01790068382890228, 0.5135724998898109, 0.9642854101395171,
      1.2940295360411413, 1.449495433681362, 1.4117383274854094,
      1.199655581197834, 0.8644717912876076, 0.4767035368184609,
      0.10896876643018077, -0.18097318294379205, -0.36267693345880947,
      -0.43790021310605476, -0.43686059737618, -0.4070520426722499,
      -0.39774762612381986, -0.4444228303104823, -0.5573286387848423,
      -0.7173286820752314, -0.880181576740186, -0.988203248742553,
      -0.9862709779710748, -0.8379469912129823, -0.5374157048113748,
      -0.1139704423655952, 0.37231467183906963, 0.8428246279739411,
      1.2176044368709786, 1.4332729124042185, 1.4571917019646292,
      1.2943662189211724, 0.9853933066849518, 0.5960387964055979,
      0.20114173874067287, -0.1330435047090604, -0.3636040458608952,
      -0.47915888631241516, -0.49955573962143035, -0.46737179484632974,
      -0.4336488056543392, -0.4417800098055313, -0.5139225184824411,
      -0.6436171864299197, -0.7966404783901404, -0.9199226949592149,
      -0.9562160219678988, -0.8606461975014288, -0.6147391171024326,
      -0.23412278495075994, 0.2322892717312914, 0.711638925122239,
      1.1227902868862738, 1.3944750977968887, 1.4814039727519506,
      1.3743232258285822, 1.1015217765192062, 0.7214572497171111,
      0.3084168067086434, -0.06512249525416747, -0.3449668928843751,
      -0.5063952225619847, -0.5573541812167434, -0.5330468646115148,
      -0.48354381088751536, -0.4578498241493656, -0.48875838491961865,
      -0.5825867514691797, -0.7165731620321415, -0.8446762460791418,
      -0.910279066045425, -0.8624506093807733, -0.6714398432966074,
      -0.33922898553768654, 0.09778268706000523, 0.574875813815088,
      1.0125317698955558, 1.3340890814618127, 1.4831542747606434,
      1.4364163888076433, 1.2086624306868843, 0.8487618771142267,
      0.427674115073434, 0.021544249445673125, -0.30582801892029543,
      -0.5167473775990863,
    ]);
    const expected = [
      [
        1.7660240219245928, 1.766024021924593, 0.6974485193397254,
        -0.11557937114167002, -0.4803428730273454, 0.6053860508029375,
        -0.11610988898382756, -0.4764146044807809, 0.518560648986256,
        0.1251528188248309, -1.2969021188485927, -1.2969021188485927,
      ],
      [
        0.0, 0.0, 0.3899090463973874, -1.7255308447271853, 1.2032430963678764,
        0.5972878827496036, -1.7770579113699343, 1.099686004984725,
        0.6826413483510689, -2.0040442481022938, 0.0, 0.0,
      ],
      [
        0.0, 0.0, 2.4055914996084504, -3.7627957384475406, 1.1934728997578592,
        2.6533802392857813, -3.938294384005732, 1.3066419043623956,
        2.657731610475466, -3.9911786108819713, 1.36123928375514,
        2.585863386530343, -3.922904527907691, 1.393108541142524,
        2.4128142398964583, -3.750996830992221, 1.440390276085794,
        1.929643579664003, -0.8923859002526516, 0.8923859002526516,
      ],
      [
        0.0, 0.0, 0.8637396658913009, 0.39947858004088177, -1.2074905400810743,
        0.7910608862142194, 0.2872615057516743, -0.9181521267965195,
        0.5861554451844182, 0.21795885401047912, -0.6332627720674915,
        0.34358392792909376, 0.19522811912642318, -0.3630503222765309,
        0.07109213775553003, 0.22066855655475298, -0.11704966168849795,
        -0.2222897631589369, 0.2937528759163179, 0.09629396599435136,
        -0.526621632593633, 0.4118483537516589, 0.26997578048960924,
        -0.8314659693813531, 0.5703264820829689, 0.39872171946923585,
        -1.1263214729278987, 0.762756553830833, 0.47920595351780315,
        -1.4010593586708104, 0.9811750640603202, 0.5101865423927048,
        -1.6468384445939805, 0.8449355499468612, 0.0, -0.8449355499468612,
      ],
      [
        0.0, 0.0, -0.2023413346832197, 0.5696810407584302, 0.041208120317119755,
        0.39163084687265604, 0.22862413945386573, -0.9606454338880839,
        -0.32194892912277706, 0.608468602577888, 0.08335633067224292,
        0.30567217061092794, 0.3006475803902098, -0.9010894488325998,
        -0.4414923504521979, 0.6285729800514233, 0.14238222539218467,
        0.2206714498964179, 0.35363652040055404, -0.8240101742077341,
        -0.5566279519073738, 0.6282963488303837, 0.21561630101462645,
        0.14085394522427616, 0.38622784974467383, -0.732429674787516,
        -0.6631706136038258, 0.6067847902577542, 0.2997551685876125,
        0.07020042735156579, 0.3979246742376482, -0.6299408833567307,
        -0.7572681277224651, 0.5640657381779446, 0.3910005840476401,
        0.012278975780966483, 0.38911553447768155, -0.5205573205353342,
        -0.8355616675390285, 0.5010484652169503, 0.4852193108299687,
        -0.029905854905759532, 0.36105645890544125, -0.4085452375922133,
        -0.8953256097400997, 0.4194875850668851, 0.5781171064958057,
        -0.05404017029731273, 0.31581660676374806, -0.2982452239467216,
        -0.9345808456319531, 0.3219110990006069, 0.6654195324375836,
        -0.05859883682357081, 0.2561897846923213, -0.19389076295340624,
        -0.9521768290572424, 0.2115160024198932, 0.7430519993243074,
        -0.042910429981705134, 0.18557555253435187, -0.09943134747879001,
        -0.9478389204251102, 0.09203582829281487, 0.8129040103490166,
        -0.3892090412799717, 0.3892090412799717,
      ],
      [
        0.3559337998776709, -0.3559337998776709, -0.19626375103959226,
        0.050823228105326024, 0.19807333652531012, 0.16848047863023685,
        0.05260077511513958, 0.0043185533360152045, 0.08054741041407006,
        0.18333593412712657, 0.16126888062350309, -0.02992418442828748,
        -0.2670382968051065, -0.3624837173899991, -0.23510268487176667,
        0.014097957039241882, 0.19399717815890005, 0.19543627410813647,
        0.07986156451593379, 0.0030759560773247624, 0.05249252758547601,
        0.15888983826173994, 0.16921395901669745, 0.008284814215923975,
        -0.2310137873439021, -0.3611462678622527, -0.27011468620723356,
        -0.026375985615462727, 0.1823390055587416, 0.21831691672470616,
        0.11037317324061496, 0.00903754303948312, 0.02836160764141074,
        0.1310772317559048, 0.1696605879434443, 0.04215404466323969,
        -0.191826904410209, -0.35199824838426985, -0.3000063293012131,
        -0.06918447423295893, 0.16327055334226281, 0.23589553799305457,
        0.14270963943321102, 0.021967004281530644, 0.009336883165439458,
        0.10134590070072091, 0.1629077288667598, 0.07053302103370385,
        -0.15096991678080496, -0.3354304239414363, -0.32368739702043986,
        -0.11280899545490108, 0.13727401650369908, 0.2471605059460708,
        0.17535635816607342, 0.04132193612187193, -0.0036254312468851357,
        0.07121743459674801, 0.1495565604066052, 0.09250857234337218,
        -0.10999323147323958, -0.3121311192844285, -0.34031631583754385,
        -0.1556898403652015, 0.10512241388204502, 0.2513583825018732,
        0.20677392436147551, 0.06627659836950883, -0.009835554032589261,
        0.04222287281569598, 0.1304846602946389, 0.10744263675669252,
        -0.07044065056174165, -0.28305735195463083, -0.34933518092925575,
        -0.19629103810415982, 0.06784774940347682, 0.24802606046001974,
        0.23546303828654871, 0.09575658508456564, -0.00889935051326235,
        0.015837968072887176, 0.10680859141589577, 0.11499850116350385,
        -0.033784926867239884, -0.24939471759881693, -0.3504929023797196,
        -0.2331643074814692, 0.02669830582913857, 0.23701073078932822,
        0.26002774981963095, 0.12848395415619746, -0.0007351193324226513,
        -0.006579216036379232, 0.07983646280756951, 0.11515438615344797,
        -0.0013663217656008086, -0.21250771057329315, -0.3438555018441933,
        -0.2650093443228936, -0.016913138295940433, 0.21847684144518753,
        0.2792343873454836, 0.16303092212250245, 0.014422753289671908,
        -0.023845754339537173, 0.05101245709725227, 0.10820380742456098,
        0.025663257639661263, -0.17388256409191583, -0.32980312810704293,
        -0.2907279159974324, -0.061467996961641735, 0.19289975472417797,
        0.2920636981555833, 0.19787987124138445, 0.03603342522698483,
        -0.035003944977682, 0.02185565291736241, 0.09474269949591518,
        0.04638819886311896, -0.13506500797775117, -0.3090139171515032,
        -0.30946949437118065, -0.10540500902048677, 0.16104636822926566,
        0.2977540120137118, 0.23148715093399863, 0.0, -0.23148715093399863,
      ],
    ];
    const result = wavedec(data, "bior1.3");

    const reconstruction = waverec(result, "bior1.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior1.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.495411086010062, 0.9134055007802845, 1.1929688648323786,
      1.3019666463850723, 1.2427459873357478, 1.0496143373966729,
      0.7789541273348365, 0.49454040207698347, 0.2517854133453238,
      0.08485293331376148, -0.00018618853811147584, -0.024549827681013173,
      -0.028645204744662034, -0.05888996097226906, -0.15296286075910737,
      -0.32739192574048825, -0.5707910731401667, -0.8446148395003059,
      -1.0913782921877706, -1.2483711667584767, -1.263466486913718,
      -1.1090466956517058, -0.7904930517533766, -0.3470037356015635,
      0.1556059390924591, 0.6384835758638748, 1.0264786372855674,
      1.2640324879612257, 1.3264198480968086, 1.2236926151531007,
      0.9964821130631141, 0.7048235124697265, 0.4128742542491326,
      0.1733803973450211, 0.015757267542913678, -0.05930621950353013,
      -0.07749292675037904, -0.08150859766651147, -0.11727669410102615,
      -0.2193467145717109, -0.39938200711402705, -0.6408046424902308,
      -0.9011008828991265, -1.1213285646782942, -1.240512956097632,
      -1.2113394938710376, -1.0131747569417588, -0.6590692011447744,
      -0.19486336068427587, 0.3095327589280832, 0.7746768203102112,
      1.1284905450947436, 1.3214673915469743, 1.336557526769392,
      1.1914113470171097, 0.9325501615070755, 0.6230198529343758,
      0.3266735427425438, 0.09302588035521592, -0.053572410772307344,
      -0.11782363045915718, -0.12960309883576865, -0.13346059910821192,
      -0.17433649510831356, -0.2832835967720397, -0.4669776539411688,
      -0.7038276269576205, -0.9478071482513437, -1.1391476217732754,
      -1.219261794040878, -1.1461527664644455, -0.9063905871973112,
      -0.5205535078428307, -0.040631958430506855, 0.4601194600490885,
      0.9025205570367844, 1.2183385077302236, 1.3646503521162325,
      1.3322656246219358, 1.1462454747570652, 0.858504070884419,
      0.5344235326465407, 0.23686896620824466, 0.011592746736370618,
      -0.12238116324331466, -0.17509802177710332, -0.18030830332203807,
      -0.18393163425930897, -0.22944682732365473, -0.34407987509063953,
      -0.5294491947887632, -0.759182794453258, -0.9842346654372577,
      -1.144649175862531, -1.1848527187288647, -1.0686142097384197,
      -0.7898492583228405, -0.37644184499023586, 0.11402603501284259,
      0.605741087053103, 1.020634518929344, 1.2950509287507286,
      1.3931118586646665, 1.3135858723003766, 1.088677634931327,
      0.7751391229358502, 0.43998898617636184, 0.14443095986900062,
      -0.07003567606966815, -0.1899190587934408, -0.2305021025024308,
      -0.2290517301481354, -0.23236854825360015, -0.28200692429146,
      -0.40107670787153044, -0.5861231671490557, -0.8062764416508775,
      -1.0099959339740014, -1.13778013069254, -1.137662769947465,
      -0.9795648472071548, -0.6648108810875024, -0.22829024504867979,
      0.267441707478104, 0.7448262638744287, 1.1277433366751617,
      1.3577978386366107, 1.4065412171962595, 1.2807153877823718,
      1.0193246515101155, 0.6833517510585183, 0.34073441633116625,
      0.05035920861036275, -0.15097319911580398, -0.25544934613745107,
      -0.2834285590020447, -0.2752979122423629, -0.27824066703885075,
      -0.3314443381054493, -0.45365718386348886, -0.6363895778735977,
      -0.8446047618394963, -1.0248190446512746, -1.118621086981276,
      -1.0782068587654, -0.8799696987790429, -0.5326269797554488,
      -0.07769809809613687, 0.41795968066548517, 0.8758741508557069,
      1.2226903104049633, 1.4058998745965237, 1.4047899418567598,
      1.2340045970585358, 0.9389309266436059, 0.5841299004504532,
      0.2377308153412619, -0.044328164514806256, -0.23034039250707433,
      -0.31825648976954213, -0.33329671023455987, -0.3185386057734342,
      -0.3210456099465891, -0.37722117356292756, -0.5012529995260631,
      -0.6797084689310153, -0.8737592346447071, -1.0285505484913837,
      -1.087385403043164, -1.007132149852769, -0.7709073229135288,
      -0.394725883223926, 0.07370911521595533, 0.5639559726072187,
      0.9974706406154478, 1.304449901659823, 1.4388356361370516,
      1.3878733956532834, 1.1739534985154814, 0.8483604503341623,
      0.47854239399502746, 0.13209040803133987, -0.13860561744045263,
      -0.3072741405002376, -0.3776539818193455, -0.37955887672838007,
      -0.3582983736650799, -0.3603147903115251, -0.4188399402526922,
      -0.5433506015755972, -0.7156157178140732, -0.8934309799595641,
      -1.021157042773857, -1.0444168213091953, -0.9252110177615249,
      -0.6535581363412226, -0.25259729058328245, 0.22429736962335933,
      0.7038555199540703, 1.108303617931979, 1.3721388107693708,
      1.4562473367544193, 1.3559706626418446, 1.1012063108408894,
      0.7485875147829564, 0.3677274183543953, 0.024954641688829604,
      -0.23145129663766423, -0.3809370273323188, -0.43299184450286665,
      -0.4217063934327803, -0.39413981105602475, -0.39561854392796475,
      -0.45584895891225524, -0.5794967283772706, -0.7437280102838518,
      -0.9034140296844675, -1.0027254577596714, -0.9901856871195294,
      -0.8333326538257655, -0.5291916378404342, -0.10777617788746302,
      0.37244173072443776, 0.8361491710164005, 1.2071771189654243,
      1.4250255199850048, 1.457944690487291, 1.3094226525541193,
      1.016544561741177, 0.6406862332115957, 0.25288025431118955,
      -0.08251814767693866, -0.32185811275563225, -0.4505264517189311,
      -0.48366374119257194, -0.459275200450177, -0.4256683552946115,
      -0.4265708292270071, -0.48784726330469647, -0.6093032903876638,
      -0.7637469321704876, -0.9036074826288902, -0.9734620418128763,
      -0.9252838013653877, -0.7324934148828619, -0.3991526743554375,
      0.038173780004204044, 0.5165438896290131, 0.959409966218427,
      1.2930242370178078, 1.4625381992611517, 1.443906991113321,
      1.2487284579184117, 0.9208786916192496, 0.5258189759172238,
    ]);
    const expected = [
      [
        3.126562248543102, 2.5622538195437956, 2.562253819543795,
        3.1265622485431024, -0.1754164935744317, 0.7413318114385857,
        -1.0614230734491001, 0.5801628911427106, 0.41700707468696324,
        -1.0918820191891294, 0.8290006306631388, 0.16209365781030477,
        -1.0077063855490458, 0.9712045574296414, -0.11611529330816561,
        -0.7963221680489981, 1.0164679238089027, -0.3871237915300978,
        -0.748237818383743, 2.3803905737738944, 4.38528630482242,
        4.670758401976065, 4.38528630482242, 2.3803905737738944,
      ],
      [
        0.21127777301039963, -0.2112777730103994, 0.2112777730103994,
        -0.21127777301039963, 2.7877815893479942, -2.8175722741675,
        0.06362611902822946, 3.0762218154895287, -3.7621566166713363,
        1.0417295615281792, 2.787081681343353, -4.141960714357571,
        1.7332400906930974, 2.1191111122514843, -3.8900889158948466,
        2.264041901741053, 1.004956379936946, -3.1536503226363086,
        2.7450659883172883, -1.8304481909753159, 4.440892098500626e-16, 0.0,
        -4.440892098500626e-16, 1.8304481909753159,
      ],
      [
        -0.09460879431499147, 0.09460879431499125, -0.09460879431499125,
        0.09460879431499147, 1.5419545034135163, 0.9841822158961278,
        -2.4032618805539565, 1.524414536834676, 0.6251435147967594,
        -1.9369189033882814, 1.3365961576248842, 0.3212261198669495,
        -1.3395739907523871, 0.9427363645803057, 0.13788547340361912,
        -0.692583220057503, 0.37613801538975156, 0.11729235570271965,
        -0.08149021517676402, -0.3016851667561278, 0.27127401855143063,
        0.41728362073707004, -1.0102077143944017, 0.5792213580962565,
        0.7482081251010286, -1.6621690557543929, 0.9913024305070228,
        0.884995310095883, -2.176972325724371, 1.4364687603710782,
        0.8342048931883727, -2.4930689729116566, 1.8339694019416977,
        0.6335398366662249, -2.6058077185564867, -0.030584349372219988,
        0.030584349372219766, -0.030584349372219766, 0.030584349372219988,
      ],
      [
        0.9197963304478253, -0.9197963304478253, 0.9197963304478253,
        -0.9197963304478253, 0.3852067431313031, 0.3339641502889891,
        0.061427725448472914, 0.5466823980555119, -0.30893690357984527,
        -0.9646755580595948, 0.20463995457852158, 0.47863866229036595,
        0.009126985328173146, 0.48218819653748585, -0.05887907992862762,
        -1.0076420335902554, -0.030621114593417875, 0.5919494454242011,
        0.024633295475771894, 0.36714342604998285, 0.15934847539193053,
        -0.9588040674409017, -0.2926188000635337, 0.6471415015282936,
        0.10631145584566085, 0.22947154565637978, 0.31974398233804746,
        -0.8260507909276862, -0.5483812834410893, 0.6259435209961043,
        0.2403041332642897, 0.09989749633290526, 0.4063238388397644,
        -0.6291386477888091, -0.7650063839527207, 0.5217152152086425,
        0.402772780267226, 0.006819741483368114, 0.41546457988255914,
        -0.3965563239855441, -0.9147554575454516, 0.340742495899387,
        0.5637765599496579, -0.02842087047944808, 0.35624956496736665,
        -0.1610241069642212, -0.9793442076910139, 0.10146740756153783,
        0.6921655800949171, 0.004887788935518944, 0.2487701263482407,
        0.04565170481194525, -0.9527455051007454, -0.16822906566934615,
        0.7607011661809893, 0.10499448084951829, 0.1206593174157109,
        0.1975460020980907, -0.8420574333051616, -0.4352608128710549,
        0.7505787137528854, 0.2578834694863499, 0.0024200467046419094,
        0.2786096873982339, -0.6662995262796547, -0.6664130981749152,
        0.7213495532281525, -0.7213495532281526, 0.7213495532281526,
        -0.7213495532281525,
      ],
      [
        0.1976811504925593, 0.3503085383927068, -0.3503085383927068,
        -0.1976811504925593, 0.04187532960011375, 0.19138566993209993,
        0.17165369869902053, 0.060131739727608484, 0.002895868893221961,
        0.0665195853651559, 0.1721091876613367, 0.17448811074431203,
        0.010674003245953023, -0.22525144177219325, -0.3553987092661081,
        -0.2743539389981699, -0.04411452541219785, 0.1606620867846298,
        0.20643930025016438, 0.11145638395491755, 0.012859944021701389,
        0.0252918635389797, 0.1273041762095756, 0.18405723671049395,
        0.08427609138420555, -0.1401236292747412, -0.3282430976560191,
        -0.32890652003195453, -0.13645523673836746, 0.10263384796616037,
        0.21887098017452056, 0.16521384648246457, 0.045432473140078124,
        0.0027276646010735983, 0.07703723437704094, 0.16747822204378376,
        0.13529814634280302, -0.05169588916524981, -0.2728280152447653,
        -0.35408472369570454, -0.22331701455576958, 0.022899460418095652,
        0.20346389790648522, 0.21040285170154227, 0.09473386024871154,
        0.0036842254123144874, 0.032184101662813824, 0.1310759029824803,
        0.15913570409150624, 0.02842819778850858, -0.19711658750309458,
        -0.3468131639043667, -0.2933739591494489, -0.06933954851160418,
        0.15903413978836867, 0.236986934418233, 0.15165081261049923,
        0.02869654540781688, 0.0023453445743364387, 0.08419505140388245,
        0.15567187330066168, 0.09035707202815435, -0.11179211326118033,
        -0.3086667018709163, -0.33756185706157305, -0.16267309837943456,
        0.08897229722698174, 0.2375687162042373, 0.2053262784678325,
        0.07387579203124937, -0.005749235459203472, 0.03762067659521037,
        0.12921131494700006, 0.1274307414428787, -0.028577174827866703,
        -0.245608392017357, -0.3504829765102045, -0.24523605824235484,
        0.000784840966948086, 0.2086485933000013, 0.24494114207752524,
        0.13153050779695089, 0.010635041881354751, 0.0017727196513008248,
        0.08770374522148283, 0.13721461233059346, 0.041602524623687964,
        -0.16703617701335538, -0.3312335639419499, -0.30654116149245364,
        -0.09502506414358303, 0.1512642098968685, 0.2615008554426309,
        0.19141099525135088, 0.04976606305557438, -0.015033445887496943,
        0.041383530393358736, 0.12180983185411515, 0.09031596515024543,
        -0.08429123204534916, -0.2835221330257328, -0.33909882007212344,
        -0.18655965397098018, 0.07090631625983501, 0.24933914186640072,
        0.2423769547863635, 0.10570237386481632, -0.007980018980407066,
        0.0010456220413122552, 0.08743217626730332, 0.1129150671788619,
        -0.008866956854168384, -0.21506017484019396, -0.3395653396266968,
        -0.2623563780044842, -0.02327736869320285, 0.20709608407480096,
        0.2742202374651644, 0.16923891231609572, 0.023431602096953053,
        -0.023763628103786627, 0.043328982063264576, 0.1092081464157807,
        0.04939463249579357, -0.1363233896293693, -0.3092365014699717,
        -0.31315360591385555, -0.11986447220806884, 0.13801206436416413,
        0.279349403946532, -0.279349403946532, -0.13801206436416413,
      ],
    ];
    const result = wavedec(data, "bior1.5");

    const reconstruction = waverec(result, "bior1.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior1.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49620210313599955, 0.9133415868417117, 1.1895667883187344,
      1.293224905838608, 1.2284760226055116, 1.03225221887231,
      0.7634693192148942, 0.4873461517999743, 0.258894746516491,
      0.10980727886706643, 0.04204330123311012, 0.02965400911183809,
      0.02822578374125026, -0.01066099641511159, -0.12386774373512244,
      -0.32422678772211533, -0.5945599314288013, -0.8898950826461555,
      -1.1474521757665122, -1.3019333194170875, -1.302242692596124,
      -1.1253442517481242, -0.7836502644014952, -0.323948306510383,
      0.1819931278785959, 0.6528950704617249, 1.0157301337188884,
      1.2214127145426792, 1.2545830851073485, 1.1351527724715338,
      0.9113679645100075, 0.6462896642285877, 0.40123602730070357,
      0.22046355755559155, 0.1209948907799277, 0.09012979942292473,
      0.09115817971792578, 0.0756503663875204, -0.00101585471099791,
      -0.16507816995336766, -0.41470699160617963, -0.7178930703874946,
      -1.0186135620520014, -1.2498241990455226, -1.3500294572945903,
      -1.2792155737842954, -1.0300444659418329, -0.6313741820716361,
      -0.14309670933904142, 0.3565248619358325, 0.7879410769710526,
      1.0876270607067438, 1.2213725341572652, 1.1903306413746182,
      1.028447084642434, 0.7920757352276694, 0.5445551131333761,
      0.339768761895289, 0.20892374155508348, 0.15390415871596996,
      0.1488194722434517, 0.14921962947471998, 0.10644537578023827,
      -0.01676070675891078, -0.23359225657502758, -0.5269171868007105,
      -0.8512084654862621, -1.1423298254525076, -1.3327847301250897,
      -1.368589651753652, -1.2234666733326527, -0.9066884589412003,
      -0.46249007652795204, 0.03891612580515971, 0.516566612661787,
      0.8964821016425764, 1.1275522403136018, 1.19168850376979,
      1.1058276592917438, 0.9154404109612301, 0.6813499919801663,
      0.4633431848126434, 0.3048331257076711, 0.22251272512499287,
      0.20360517757127347, 0.21131935607786217, 0.19696937322468394,
      0.11547381720822836, -0.059938839778652164, -0.32779668835640696,
      -0.6559704270271378, -0.9875780058883622, -1.2538414014801091,
      -1.3907050076915946, -1.355013548998115, -1.1361110911899046,
      -0.7598484540572729, -0.28388815217016156, 0.2146115846407212,
      0.6559296115047307, 0.9751663777094659, 1.135812225327342,
      1.136212518518805, 1.0074553209546335, 0.8033868168655147,
      0.5854475682963709, 0.4063105201435131, 0.2965612904758519,
      0.25782910420503047, 0.264069778662607, 0.27056216683876244,
      0.2281591207301482, 0.09895487741573095, -0.13085101417809558,
      -0.4443982870762254, -0.7957960034513899, -1.1196923090398179,
      -1.3464675219446585, -1.4192495486868664, -1.3084359543093462,
      -1.0199975162160666, -0.5953852635200786, -0.10297259059977514,
      0.376902892645287, 0.7696218912825179, 1.0223369082287423,
      1.1144720149443152, 1.0601685087426846, 0.9022300735819728,
      0.699278107165766, 0.5095355016720015, 0.375479016339353,
      0.31332815513393647, 0.31004524235621234, 0.3285426603277204,
      0.3196404717677499, 0.2375467897064424, 0.05470157694711286,
      -0.22802687956426082, -0.5786119746847503, -0.9394957748296087,
      -1.2402939497009022, -1.4144479878435379, -1.4156381774078286,
      -1.2297846650220192, -0.8795469264065642, -0.4201091843240126,
      0.07276837509750131, 0.519505563105093, 0.8541339681077795,
      1.0381191436390218, 1.067222345564406, 0.9698335585795621,
      0.7973805896800377, 0.6094253648019745, 0.4573846721194346,
      0.37112024646625125, 0.351856175125779, 0.3732054785728894,
      0.3899562338011183, 0.3522314473884259, 0.2212218927747397,
      -0.01773696798752944, -0.34830253561027, -0.7244383605574286,
      -1.0797505683784183, -1.3426083339763533, -1.4532878501728324,
      -1.3788159502230246, -1.1217319331725608, -0.7204979721501874,
      -0.2413845977643957, 0.23619720344184944, 0.6372999485090078,
      0.907636217870246, 1.024402629312829, 0.9991504625694998,
      0.8721568066241321, 0.69991278655594, 0.5390818846645913,
      0.4311475269801373, 0.391745044267613, 0.40741940927654763,
      0.4405921074833677, 0.4413643792878887, 0.36298682381253455,
      0.1768513298635631, -0.11703720903292286, -0.4869996458659293,
      -0.8750144133508735, -1.209252413066363, -1.4207465080544601,
      -1.4600273283891332, -1.309520818414024, -0.9885424297366497,
      -0.5495742063427543, -0.06670183308824135, 0.3809407003877321,
      0.7266243010305072, 0.9300762105905551, 0.984717758693777,
      0.9164280886961358, 0.7743389001733176, 0.6161888820928096,
      0.4921300108769707, 0.4312331492280977, 0.43419885457160945,
      0.4741345735990276, 0.5051372478464512, 0.476369177412197,
      0.3478646933234182, 0.1038308689982721, -0.2401690850967128,
      -0.6381954491878887, -1.023016313314701, -1.3211368224958964,
      -1.4700558637933734, -1.433420849126122, -1.2102449730104685,
      -0.8358267578707708, -0.37409298829620585, 0.0967581915595091,
      0.5017579425253806, 0.785480895611447, 0.9231702366288941,
      0.9240150272615273, 0.8259352451004254, 0.6833971266790662,
      0.5515456231423501, 0.47085056871725584, 0.45628711332996064,
      0.49385713394585656, 0.5453216959289864, 0.5598559746950054,
      0.48951509968240103, 0.3043833311510237, 0.003333228458127113,
      -0.38256618447817164, -0.7950675859371916, -1.1610904639361972,
      -1.409389338932835, -1.487397810519627, -1.3740145095943004,
      -1.0850921590228317, -0.6702151981340938, -0.20153936816474927,
      0.24254060767962385, 0.5948405524716467, 0.8136429581409139,
      0.8902895734117398, 0.8483600006554237, 0.7348424080036104,
      0.6057421984060041, 0.5099744819058757,
    ]);
    const expected = [
      [
        3.121857746506402, 2.555118870833535, 2.5551188708335344,
        3.121857746506401, -0.15247567334609236, 0.7260375112748378,
        -1.0985702864454279, 0.6979880985254785, 0.27504430978403305,
        -1.0661059232196899, 1.0096383923931314, -0.1188592064857203,
        -0.8833730171951721, 1.162744255830669, -0.4908340477069883,
        -0.5636641460176378, 1.1356915171949908, -0.7942875299110281,
        -0.16394896744116988, 1.1620404921802565, 2.9443279896575865,
        3.238097777312232, 2.944327989657587, 1.1620404921802565,
      ],
      [
        0.20189258438011626, -0.20189258438011626, 0.20189258438011626,
        -0.20189258438011626, 2.7864670296884766, -2.8446309021860805,
        0.2805496759047287, 2.740137499598856, -3.7552911478655377,
        1.6835232768863144, 1.9513639882570046, -4.079611193705368,
        2.7797205940367316, 0.8822363833203909, -3.749207035282203,
        3.4233405821081813, -0.34170050635939675, -2.8066664085451793,
        3.5435056867700627, -1.4701492472320994, 2.220446049250313e-16, 0.0,
        -2.220446049250313e-16, 1.4701492472320994,
      ],
      [
        -0.09291922324132917, 0.09291922324132884, -0.09291922324132884,
        0.09291922324132917, 1.4920522061740737, 1.1188606135253267,
        -2.478348548752477, 1.3744092283618432, 0.9497366622469798,
        -2.1557558155198646, 1.2018078370684204, 0.7531862415665033,
        -1.7221369475660233, 0.9411046374673794, 0.5476994911390831,
        -1.202983018035631, 0.6015896607000286, 0.35074486611353134,
        -0.6284974387416411, 0.19860010125091998, 0.1774205911493777,
        -0.03169705348527274, -0.24724351324474747, 0.03934019657722221,
        0.5536452355976333, -0.7112055201392895, -0.05616707943282628,
        1.0950807631714659, -1.1659356709470425, -0.10648512498302254,
        1.5634522869760585, -1.5832049004682647, -0.11374195335007964,
        1.9346141440924478, -1.9363235312502909, -0.3214805711454203,
        0.3214805711454203, -0.3214805711454203, 0.3214805711454203,
      ],
      [
        0.9181271635798429, -0.9181271635798429, 0.9181271635798429,
        -0.9181271635798429, 0.39129723327190935, 0.29834878094464007,
        0.07873382455200742, 0.5895727888175579, -0.3537562117545415,
        -0.9407167205351497, 0.2378571992175358, 0.36139716668054417,
        0.032131099641315046, 0.6054517488965329, -0.14191277059019436,
        -0.9980390407588737, 0.061298943402160466, 0.40911340837007604,
        0.0003903211807687601, 0.5859717288203246, 0.07101980334656344,
        -1.0015763398945525, -0.12878258143268284, 0.43527517218571715,
        -0.014247951429660122, 0.5353276655859552, 0.27287435526154646,
        -0.9507398376756699, -0.32149020253320804, 0.4349132643744948,
        -0.011395812119764925, 0.45954093899857007, 0.4524955398214675,
        -0.8481824040945949, -0.5053023113084485, 0.40478053276815684,
        0.007478654852824618, 0.3659412124843788, 0.6004144637772363,
        -0.69964560404432, -0.6688113171741931, 0.3437043792589909,
        0.039202786152516766, 0.2625730335687503, 0.7093994618742062,
        -0.5136089373194546, -0.8014732504100929, 0.25279329389459504,
        0.07919298340320025, 0.15757208124982913, 0.7748483832807944,
        -0.300764085773386, -0.8943174851888871, 0.13547814680552717,
        0.12186717739856417, 0.05855734568208398, 0.7949990162299414,
        -0.07334869426547508, -0.9405675907243176, -0.002619160106401619,
        0.16114356198813273, -0.027916440026161338, 0.770947023420014,
        0.1556164226687653, -0.9361297850546689, -0.15438513739363724,
        0.17686967519308333, -0.22838082288030592, 0.22838082288030592,
        -0.17686967519308333,
      ],
      [
        0.1953207130990231, 0.35086787196649194, -0.35086787196649194,
        -0.1953207130990231, 0.04578437440837846, 0.19005821101474207,
        0.1615395378475473, 0.04791636810514405, 0.001009907844605324,
        0.08004925870605169, 0.19115439909447507, 0.1821203670880993,
        0.00021875987281394504, -0.24161413554347178, -0.3577546191396957,
        -0.2565631336813902, -0.02345499396074835, 0.15823975523612466,
        0.173279088426133, 0.07033496879265697, -0.0007271746802338663,
        0.054211204826709464, 0.17651423257031063, 0.21264149889772543,
        0.07085581761846504, -0.17619058003116983, -0.3452643120698473,
        -0.30505733116523803, -0.09457233122986908, 0.11446896072792456,
        0.17502351036638758, 0.09252140116705107, 0.003595416284925157,
        0.030245964847561743, 0.1533230592501649, 0.22930856223821,
        0.1346719546042202, -0.10261744214747759, -0.3140956883965032,
        -0.3377498982933771, -0.163391261983998, 0.06071278536883007,
        0.16552692267231023, 0.11208353767940638, 0.01336965509084212,
        0.010146970185393012, 0.12403547926137305, 0.23205387602141572,
        0.18827665260468052, -0.025237672472598893, -0.26605786222361716,
        -0.3524925443186844, -0.2257344821874327, -0.0002830500301463923,
        0.14429822306801066, 0.12666902151062687, 0.02738779156227833,
        -0.004590811705454889, 0.0913611966057011, 0.2217114028888166,
        0.22902927408284768, 0.05146466465791577, -0.2039567755306142,
        -0.34818834016414, -0.2776942670371765, -0.0651493587439278,
        0.11167933851213119, 0.13416828302464479, 0.04394729541493392,
        -0.013079649682095268, 0.05804899927812296, 0.19991920883359826,
        0.2551833823028001, 0.12314550134167845, -0.13141827891534386,
        -0.3248715429596083, -0.3158908950483777, -0.13009716525593873,
        0.06886427168851539, 0.13290441407072096, 0.06099816035452876,
        -0.015096237241061072, 0.026675452291228946, 0.16896943086961252,
        0.26596819246733205, 0.18586850854184378, -0.05265958546235505,
        -0.28371525468125913, -0.33770133020422166, -0.19115660926600458,
        0.017855978343861545, 0.12179491460905045, 0.07632111624169174,
        -0.01108344978861081, -0.0005460786298959741, 0.13161766999082533,
        0.2616029478689186, 0.23634195612905007, 0.02777573442921777,
        -0.22696599524810268, -0.34144232957590787, -0.2444352181594887,
        -0.03863740919831915, 0.1004722287377785, 0.08772286910306826,
        -0.002097070359398323, -0.021922201195270774, 0.0908663921120543,
        0.24324470026842493, 0.27210944256613606, 0.10530166394924545,
        -0.1578091753986275, -0.32649507956900164, -0.28637807028683077,
        -0.0973610667305439, 0.06935287906341459, 0.09323309226045401,
        0.010297918061864197, -0.03639094076906646, 0.049738509716007906,
        0.21287456909105368, 0.29168253822062745, 0.1755738182711135,
        -0.08017410095761346, -0.2933623124024927, -0.3140119623087144,
        -0.15471666478866875, 0.02964868522824582, 0.09128763365907211, 0.0,
        -0.09128763365907211, -0.02964868522824582,
      ],
    ];
    const result = wavedec(data, "bior1.5");

    const reconstruction = waverec(result, "bior1.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.2", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5056118812055455, 0.9312143064636077, 1.2137048687657368,
      1.3197474829707723, 1.2515450064727742, 1.0442497207840853,
      0.7558096087746662, 0.4519097387506615, 0.1898497261001017,
      0.005405115257017923, -0.09409541482049963, -0.12887298841120526,
      -0.138401305212198, -0.16803290053907527, -0.254172407490663,
      -0.41198585855321906, -0.6289738391023969, -0.8662171388362978,
      -1.0671136139247444, -1.1714715767814838, -1.1314068768998213,
      -0.924971434617853, -0.5639562761877641, -0.09373571748604721,
      0.4150057109331259, 0.880793102983834, 1.2286864519208547,
      1.4062543601475694, 1.394360307335817, 1.2102036631925115,
      0.9019714072471773, 0.5365246053443775, 0.18324621865984114,
      -0.10191314998428508, -0.2882635931968433, -0.37524601669827495,
      -0.38931338938817645, -0.37384101132972664, -0.37485845562683384,
      -0.4264466634105385, -0.5397048988047606, -0.6982500425759417,
      -0.8615063426868181, -0.9750124408852268, -0.9851328419458747,
      -0.8543833205061444, -0.5733667121208867, -0.16612509771512884,
      0.31265507299875744, 0.7881072892340963, 1.1809048896748697,
      1.4244814263834178, 1.4795903527120444, 1.3426769143315704,
      1.0460513153967557, 0.6498701313199631, 0.22794551986733186,
      -0.14909638668167086, -0.429171555984732, -0.5888959612694247,
      -0.6361844422187759, -0.604864592625019, -0.5429063402908549,
      -0.49747250469837934, -0.5007726857069903, -0.5604574886484956,
      -0.6570874011304898, -0.7493589270719597, -0.7857430693016193,
      -0.7195058831654617, -0.5231687801048054, -0.1985624347490967,
      0.22028862253023435, 0.6724154471064239, 1.08219395074231,
      1.375781576782123, 1.497727983986418, 1.423698560030082,
      1.1661802815641829, 0.7717566345149518, 0.31061125632799835,
      -0.1391720448964888, -0.5086812730406267, -0.7524850506639247,
      -0.8567737435844529, -0.8395060658294761, -0.7427582900845776,
      -0.619430844435245, -0.5178637642392494, -0.468396681912824,
      -0.47536130333062937, -0.5165572369636284, -0.5503038933166136,
      -0.5281823379278535, -0.4100868854583579, -0.1775790158920728,
      0.15806230437229302, 0.5553693114877238, 0.9501451729895181,
      1.2691779692463303, 1.4469131852051849, 1.440992391185944,
      1.2427966624165543, 0.8803370646536446, 0.41271059838413854,
      -0.08258250142922746, -0.526407384251118, -0.8548016590719327,
      -1.0317899760101685, -1.0551969090489288, -0.9542163701201795,
      -0.7795616421928471, -0.5888626646649017, -0.43113228839733586,
      -0.3343016649634981, -0.29898555507663876, -0.2999980829970572,
      -0.29511815724413143, -0.23871748711389393, -0.09659414257415111,
      0.1419747024210571, 0.45825074830850415, 0.8058668174295005,
      1.120212957734329, 1.3331637542615615, 1.3895309102468256,
      1.2611297924635596, 0.9548907473712516, 0.5128926203817593,
      0.004184938658386844, -0.48970318724305495, -0.8921064547495328,
      -1.1472571573039565, -1.2311846224606682, -1.1549449810309595,
      -0.9595618148674102, -0.7041171207068329, -0.4501152671492965,
      -0.24612746271220665, -0.11659070154101342, -0.057521407233785904,
      -0.04009646178532248, -0.021014755395965173, 0.04319928594049022,
      0.18180645167541837, 0.3992586496392732, 0.6713059142653395,
      0.9489839192908053, 1.169622583300365, 1.2721847078810005,
      1.2130867815841408, 0.9784693346986771, 0.5897227139782761,
      0.1007277260410371, -0.41267575018411096, -0.8685424089116027,
      -1.1962162820734876, -1.3510954917265687, -1.3232459996311752,
      -1.137870076306091, -0.847653967711697, -0.5190217876362635,
      -0.21580556343845964, 0.0155667701136879, 0.15570834362626873,
      0.2144426384073307, 0.22514722340752596, 0.23292612883540992,
      0.2798425991267599, 0.39118643512920986, 0.5664695929935886,
      0.7776125091704998, 0.9749159761379081, 1.0993856124084356,
      1.0983055880021504, 0.9400726773237945, 0.6244296094391086,
      0.18534983055000825, -0.31435412737859847, -0.7955576064162552,
      -1.1795495065114063, -1.4049518690465872, -1.4407585446823081,
      -1.2923655560026068, -0.999193112437812, -0.6245723072200917,
      -0.24046717750391755, 0.08915132697731748, 0.3221800670375283,
      0.44615543518505474, 0.4781557007009499, 0.4570862168339638,
      0.43053854571111705, 0.43978181548165846, 0.5068944958868019,
      0.6274649334139727, 0.7708289351251435, 0.8878457246412688,
      0.9242419938359709, 0.8360812931473579, 0.6033199642500624,
      0.2378462317874807, -0.21624091146257912, -0.6904136506525653,
      -1.1058237851837471, -1.390391107057954, -1.4947447784637156,
      -1.4031416473007945, -1.136706819871872, -0.7482278732432263,
      -0.30981119545933944, 0.10354468689972429, 0.4304263477565212,
      0.6355356849893854, 0.7153106970643933, 0.6954451410568234,
      0.6211717911615805, 0.5429948446770082, 0.5016819169450923,
      0.5164720352886438, 0.5795890167009341, 0.6584928780184579,
      0.7052793003104214, 0.670765361800165, 0.5195571770760244,
      0.24210036466640794, -0.1395547222975329, -0.5739671705278997,
      -0.9901738755813723, -1.3129334215012571, -1.479675063567889,
      -1.4550070639419541, -1.2392031100655463, -0.8685506205728504,
      -0.4074435197148033, 0.06586737935661624, 0.4764010113267377,
      0.7682998303751634, 0.9156143313532539, 0.9255217335149977,
      0.8333979936814507, 0.6912088072347862, 0.552345296102333,
      0.45688543577074253, 0.4210994355741015, 0.4338813495660091,
      0.4609721545470531, 0.45580602538063447, 0.37408084630487204,
      0.18816821575707937, -0.10251000212501293, -0.4680031241858191,
      -0.8523651324788906, -1.1852652600255658, -1.3979136718130118,
    ]);
    const expected = [
      [
        2.8610633153330576, 1.103592946847309, 2.952726263058722,
        -0.12412593533097782, -1.8961132890008723, 1.7015224187706854,
        0.08006673707557477, -1.7160608080265025, 1.61871534958309,
        1.0714976085043468, -6.447297819641555, -9.13019331422089,
      ],
      [
        -0.09990803114170699, 1.0877054705762885, 3.304940602778462,
        -2.1382985279251536, -0.15215333424568844, 2.025675627136195,
        -1.8613795235300141, -0.17069502591742136, 2.2602690124105873,
        -4.080753935421508, -0.26471440083135045, 3.402752260387963,
      ],
      [
        -0.31150773044232705, 1.29276368217125, -0.5413481030527625,
        -2.9053278723226876, 2.9056765411018524, 0.019193679549222242,
        -2.5104383003074404, 2.2760944557524168, 0.02438009215205139,
        -2.080307727804078, 2.161391009989076, -0.2652013764800203,
        -2.0040647940900613, 2.5150103256766494, -0.43610354823245423,
        -2.4633506566628705, 3.0232021026357114, -0.962186198116795,
        -0.611047803515802, 2.428745446764969,
      ],
      [
        0.17301778635683934, 0.19837387750507657, -1.0225285122705678,
        -0.48330016765406564, 1.5302679793844138, -1.2986197848998289,
        -0.09219903797765734, 1.480841888433607, -1.63926165531732,
        0.36668357703183885, 1.2790609935964548, -1.8654305497780121,
        0.8415311588393697, 0.943165506636184, -1.9471042979684308,
        1.2781211069460514, 0.5080513982818979, -1.8718080294890034,
        1.626593163536679, 0.02093917098094411, -1.646193865924947,
        1.8476733464247124, -0.4645029058458245, -1.2952244621056272,
        1.9175726879908568, -0.8948440583527806, -0.8590627185751815,
        1.8309463286324092, -1.2235462907980195, -0.3880577683173047,
        1.601541857414242, -1.4167549729697506, 0.0640021896687617,
        0.8463778410069287, 0.2103194175952745, -0.9276751821922249,
      ],
      [
        -0.2567498410408009, 0.7649857336040197, -0.34576994080478285,
        0.0814505228009384, 0.049976484536702837, -0.11566194219706209,
        0.2867497384009778, 0.07603443055736037, -0.3759071926666422,
        0.02285809149119633, 0.14432890578537322, -0.12054559007506918,
        0.20555088601726518, 0.14119009412746725, -0.37398681765188435,
        -0.05201744746673931, 0.22257802201605084, -0.09493077067326638,
        0.11157068457399255, 0.1859618766459632, -0.34075814243075964,
        -0.13294793388447224, 0.27622849994653265, -0.0415733660874954,
        0.015725507061997823, 0.20341956251270116, -0.28079717372703505,
        -0.2088636885603088, 0.2998497311107188, 0.033186963306321426,
        -0.07091317605801742, 0.19008589750912303, -0.20192980614049724,
        -0.26924836666214014, 0.2917487457104368, 0.12021990068736443,
        -0.138501718330591, 0.14638124396369695, -0.1142479474475338,
        -0.3054648781047943, 0.2541743646309374, 0.2087484197401488,
        -0.17965269230852327, 0.07657898334272134, -0.02884201989063817,
        -0.3118459711864824, 0.19302702861421012, 0.2877000374719747,
        -0.1903546760834402, -0.011722791106784536, 0.04359112251729766,
        -0.28641260026508514, 0.11711076412443197, 0.3470958386837204,
        -0.17046807291201357, -0.10854705666884185, 0.09409019376985484,
        -0.23112989715313853, 0.03702119110172952, 0.37930299415251856,
        -0.12373480267472631, -0.2027825011668123, 0.11655301423902947,
        -0.15166857994592314, -0.03878377193265738, 0.11062357058202521,
        0.26597395458573303,
      ],
      [
        0.17876079492446414, -0.02828761442975586, -0.0623837703129535,
        -0.04917673429651204, -0.00546584986380827, 0.027441188471292427,
        0.022883020715133286, -0.0071075822848674156, -0.02534056595762567,
        -0.007161336775307808, 0.034131518322350285, 0.05882094007114819,
        0.03860993953712971, -0.01518654519773762, -0.06021913706742227,
        -0.0609040232376542, -0.02022839671451665, 0.02408370979207139,
        0.03513190028540809, 0.010443879034359782, -0.01787946489557704,
        -0.01601134000616078, 0.017589352568852995, 0.04980503873262038,
        0.04462727885620421, -0.001176609589630527, -0.052757613030463224,
        -0.06789015811264065, -0.03519821467944367, 0.015868432497675222,
        0.04255042067918518, 0.027792241792392675, -0.005842263566600225,
        -0.01993497426169466, 0.0015409223389184212, 0.0362821185909204,
        0.04535002552224593, 0.011764760352397097, -0.04107967873009963,
        -0.06928791958117608, -0.04840335725305889, 0.004017100834261655,
        0.04444358824769796, 0.04297666700053765, 0.009397332415562676,
        -0.018420130896688897, -0.012102596498138662, 0.01975239568767695,
        0.04045089799054177, 0.021802112669457085, -0.02677921753129095,
        -0.06493220503058772, -0.058076047834628386, -0.00978163209573324,
        0.04081088283702343, 0.05429921900966678, 0.026047759319658692,
        -0.011656160758724887, -0.02174866483523008, 0.00208329697512466,
        0.030307542188203876, 0.02747364434896373, -0.01176269613775302,
        -0.05536067702505132, -0.06287520217619197, -0.023585389261130962,
        0.03234478187348508, 0.060536556130318164, 0.04212359713688296,
        -0.0005101211872907685, -0.0263224187798643, -0.014723500738065179,
        0.015956690045937832, 0.02787592847597297, 0.0019907673597582554,
        -0.04174636086461653, -0.06205552161940686, -0.03544315013095267,
        0.020342336910242793, 0.06109213915996142, 0.055694003869315334,
        0.013582132325395124, -0.02540065113118417, -0.028781819414500205,
        -0.001034383932580138, 0.02277851359415224, 0.012678339137251249,
        -0.025750647792778636, -0.055561935783009775, -0.04364146769929278,
        0.006540907039494656, 0.05606986871694686, 0.06512441586486045,
        0.028796344420658926, -0.01926393109379776, -0.03855618939535882,
        -0.018762989832252996, 0.012654008505380815, 0.018900171284004452,
        -0.009315146204238817, -0.04403753902427038, -0.04692092025428979,
        -0.0071013305466474524, 0.04625992004963403, 0.06928119195797461,
        0.043149112145031865, -0.008860329193410621, -0.04305301789766283,
        -0.0352282606862353, -0.001380129809665731, 0.019835422162592126,
        0.005581504917384128, -0.02874401821808137, -0.044635630375947866,
        -0.01865254395449914, 0.03303855995298921, 0.06767352781265074,
        0.05474722479554195, 0.00431469423645392, -0.041943740350864275,
        -0.04858074567810439, -0.017700808401634183, 0.015345507904771516,
        0.017171350735404572, -0.011404548437979334, -0.036835826725208465,
        -0.02645106303929516, 0.018194522424195114, 0.07518256699172626,
        0.042515401831334065,
      ],
    ];
    const result = wavedec(data, "bior2.2");

    const reconstruction = waverec(result, "bior2.2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.2_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5123283074320415, 0.9411504600183211, 1.2211597570802735,
      1.3189551381503453, 1.2389154184908304, 1.0199119524974642,
      0.7238716753473167, 0.4192688292134951, 0.1638797359617834,
      -0.008742324328790019, -0.09565276737834272, -0.12226493796869067,
      -0.13226699907946818, -0.1725861405098948, -0.27758582072248883,
      -0.45687635460003684, -0.6901519062564627, -0.9305920813430236,
      -1.1160762218070168, -1.1853549564973789, -1.094960319782638,
      -0.8323736771371406, -0.42188317712473816, 0.07858412024496841,
      0.5890558437671146, 1.024759835546368, 1.3147796283135316,
      1.4174985535758569, 1.3290204707779876, 1.0825438750115133,
      0.7389705722760913, 0.3712526873738174, 0.046546946620649565,
      -0.1892506885365029, -0.3207005899219961, -0.3635442405003662,
      -0.357005995133188, -0.3499389022809606, -0.3846906447429021,
      -0.48314411410591757, -0.6387852463521231, -0.8170281019111638,
      -0.9638109262935959, -1.0202500255781581, -0.9394869711317697,
      -0.7012250343442742, -0.3199946357257303, 0.15522276424117348,
      0.6501591137347162, 1.0810796655572759, 1.373383987527979,
      1.478365474752387, 1.3839485830537555, 1.1167423850030673,
      0.7349530968946189, 0.3140160288463922, -0.07136123150894663,
      -0.364180828822538, -0.536909029359824, -0.5951582910577508,
      -0.5725870546959962, -0.5186093733896362, -0.48237422894861576,
      -0.4974208235458687, -0.5711961572550446, -0.6822953557305844,
      -0.7862036910472078, -0.8280301621809877, -0.7588284780587323,
      -0.5511017273524408, -0.20924740206905582, 0.22801832553747983,
      0.6941460779723859, 1.108714952758847, 1.3954699634877041,
      1.4999381449772553, 1.4021884654279126, 1.1215089941410397,
      0.7118179507148582, 0.2489746876010835, -0.1867960515593589,
      -0.5289377678647326, -0.738554235761907, -0.8109495143837699,
      -0.7732676170350151, -0.6741051506090295, -0.5680454418357193,
      -0.49935111779262176, -0.48922010117545295, -0.5300173642439836,
      -0.5880051747951027, -0.6138062020329291, -0.5577491613624255,
      -0.38591464946454335, -0.09247132584935752, 0.2951677679200574,
      0.7199754435555273, 1.107032186175263, 1.3805062471789091,
      1.4816437999931642, 1.3832019110038605, 1.0966211604708813,
      0.6700609899636749, 0.17773742761641745, -0.2967901134834022,
      -0.6792103993709558, -0.9203075511967658, -1.0051812306391796,
      -0.9536927826419672, -0.8122677352134203, -0.6394107662850766,
      -0.48888435051147183, -0.3950536760953729, -0.36426832013607086,
      -0.37450538818844825, -0.38327403555473916, -0.3415632057322166,
      -0.2099865268539408, 0.0273307976360615, 0.35500701545275065,
      0.7270809035658987, 1.076173460855438, 1.3289457166906349,
      1.4239698831650298, 1.3274395509198358, 1.0426407948870775,
      0.610665253889417, 0.1020663998405081, -0.398533557196813,
      -0.811084300075695, -1.0773763837743342, -1.1726902452335877,
      -1.1090382861022983, -0.9293838126558609, -0.6945357367336735,
      -0.46627592322919775, -0.29119572106155606, -0.18946401671781843,
      -0.15139241735187722, -0.1425630793544869, -0.11599415527342483,
      -0.02793879249895531, 0.14706035505428122, 0.40605194703187125,
      0.7153829510189805, 1.0170500697587892, 1.242211904151494,
      1.3284510503071365, 1.2363303290242538, 0.9609020070550021,
      0.5350782468838198, 0.023833825044590053, -0.4894457170240861,
      -0.9211436764810577, -1.205630627086308, -1.3090241753890315,
      -1.2351395663970597, -1.0222851121963674, -0.7318973999720565,
      -0.43208110885340145, -0.18038097161289768, -0.010244137070233306,
      0.0753992060956944, 0.10192678315619766, 0.11297668897534316,
      0.15542984054445091, 0.26360300629174604, 0.4470349926212323,
      0.6852880404126934, 0.9313158092891591, 1.1226597050116598,
      1.1976283108120724, 1.1122449368810903, 0.8534783442655789,
      0.4451769864759423, -0.05502404050378411, -0.5672404136945781,
      -1.0065597917866733, -1.3017112891095468, -1.4105598589038573,
      -1.3286034793578774, -1.0884341594468936, -0.7504263762428789,
      -0.3871415173747588, -0.06550802773033837, 0.1686509574337257,
      0.29984644412484945, 0.34369545177183547, 0.33926895203188134,
      0.33526991534674366, 0.37390967070211045, 0.47693643491205406,
      0.6376751989006433, 0.8213207751616338, 0.9735114138287484,
      1.0349813935317798, 0.9584341432888697, 0.7231303215961944,
      0.3432216516088207, -0.13255453298850975, -0.6299832366455442,
      -1.065163585195021, -1.3631184726747096, -1.4745996943538415,
      -1.3868996538365548, -1.1259935997043797, -0.7495373593549179,
      -0.33256453061582664, 0.05043646778012978, 0.3425056654852482,
      0.5159977947913644, 0.5763155186024908, 0.5568647364709561,
      0.5068095389866754, 0.4750763029704985, 0.4950096485008654,
      0.5738705129680387, 0.6900469380326963, 0.7987698246777761,
      0.844836138647844, 0.7789436221585263, 0.5732345673643474,
      0.23179896832696903, -0.20683663960033524, -0.6761393873231583,
      -1.0955006216736072, -1.3882764028472647, -1.4994433496229498,
      -1.4084290305209217, -1.1338771977607687, -0.7291471886196219,
      -0.2696962042165389, 0.16445545706132936, 0.5067534902355452,
      0.7181311832379178, 0.7936032341650199, 0.7599687478040104,
      0.6654810657752719, 0.5644203712522631, 0.5007996557193599,
      0.49561022714745007, 0.5410272651216257, 0.6031107410176069,
      0.6322493815565156, 0.5785075105585968, 0.40769640017122005,
      0.11375674504248096, -0.27602831338415307, -0.7046109076019978,
      -1.09686698382391, -1.3765738101902243, -1.4844329315406437,
      -1.3925677260351639, -1.1117810994702297,
    ]);
    const expected = [
      [
        2.9148511403740556, 1.1360254142071664, 3.0602911127930716,
        -0.30324678578602715, -2.16718799395743, 2.9600526522284123,
        -1.824665050707392, -0.4942774753147462, 2.484405403150354,
        -1.1039390119770276, -5.980702514620109, -10.115155309294515,
      ],
      [
        -0.09301196990939159, 1.075733807371567, 3.176135573341067,
        -2.680770877144392, 0.9627517450870468, 1.3762839626343766,
        -2.812610028687333, 2.414533570537061, -0.44689327592018524,
        -5.302026968797144, -0.0383134373956433, 3.2733861197168173,
      ],
      [
        -0.31916705027785125, 1.3014866923437636, -0.5730605182902277,
        -3.323987622395255, 3.2605754832890486, 0.6888962286623086,
        -3.8111298231801904, 2.3861683157878324, 1.8805119874337821,
        -3.899216798562766, 1.2675061765220605, 2.870719038193484,
        -3.581007915703271, 0.022237099273472394, 3.5574074683002195,
        -2.891604427866731, -1.2187107824241625, 1.4450235380980185,
        0.12730814908165766, 0.20982481430054745,
      ],
      [
        0.174323204143931, 0.2008683238945176, -0.9863979799774226,
        -0.5466161625943862, 1.4486825012958828, -1.037873028682343,
        -0.3148045726231389, 1.3835978083243616, -1.1987473964543414,
        -0.0736097846046102, 1.2807464449683925, -1.3276906240642778,
        0.17045657153826438, 1.1427838316412173, -1.4210891037420108,
        0.4107817900039271, 0.9733280213637308, -1.4762814013560557,
        0.6408313375198117, 0.7768648023542705, -1.49163386679085,
        0.8543265970516782, 0.5586288961015867, -1.466588579757631,
        1.0454162702899161, 0.32446439878052036, -1.401682233800324,
        1.2088367585803799, 0.08066818883546606, -1.2985353468034306,
        1.3400571259926692, -0.1661795008450052, -1.1636599459921286,
        -0.04039743102260007, 0.0627430316906622, 1.1817104666302818,
      ],
      [
        -0.26024582250843115, 0.774229941481587, -0.35274324054847095,
        0.09587035598659888, 0.03294476885205902, -0.10517174398573938,
        0.31672115461837275, 0.019503829408926088, -0.3792458899571469,
        0.08377864246310307, 0.09794499006646148, -0.11141288941494626,
        0.2721520405381548, 0.038441748620487604, -0.3955137346901899,
        0.06924726490728916, 0.1603012811879443, -0.1144124105724969,
        0.22023908271510595, 0.056264180123846874, -0.4011077667548617,
        0.05269751338892603, 0.21833043766111915, -0.11408270318428698,
        0.1623837429331746, 0.07245374256658407, -0.395877191974922,
        0.03460915621682625, 0.2704661239568171, -0.11043248289633345,
        0.10014790548923014, 0.08654018922350586, -0.3799634971233661,
        0.015506603981143674, 0.3153011754186724, -0.10356655478190524,
        0.03521168916637546, 0.09811399214308994, -0.35379662077574614,
        -0.004056214799649238, 0.3516255989256437, -0.09368281596157335,
        -0.03067193380907723, 0.10683818141053034, -0.3180833315660491,
        -0.023511832190227178, 0.37845924560774635, -0.08106657676539492,
        -0.09572448540432223, 0.11245809890690012, -0.27378812815763387,
        -0.04229561467672793, 0.3950782728990322, -0.0660823627700583,
        -0.15819001647299405, 0.1148087856445571, -0.22210717736728652,
        -0.05986206202996108, 0.4010346811196238, -0.04916343232260845,
        -0.21638253044895223, 0.1138197895141509, -0.1644359950347627,
        -0.07570056287521695, 0.4179357170588459, 0.14106849489474493,
        -0.3556840566537539,
      ],
      [
        0.18113541018951143, -0.02952388418112606, -0.06442234781220729,
        -0.0491311036858767, -0.0030273252963667896, 0.029262565132755713,
        0.021318658674868856, -0.010718706539900563, -0.026265783203313242,
        -0.0025330769060482594, 0.041084815216534454, 0.060879067529876096,
        0.031811601780398824, -0.026434385064668078, -0.06622085676739697,
        -0.0558609099687456, -0.00853639888954838, 0.03143376218469604,
        0.031327040400616374, 0.00018697582144586167, -0.02252196153252145,
        -0.007990915910503937, 0.03194133032717844, 0.05568426386634945,
        0.033229422998407254, -0.02263300231810912, -0.0662286233600961,
        -0.061090245119029496, -0.013840830331907916, 0.032724075593799556,
        0.04047441697817547, 0.011103855096646242, -0.01813083271250099,
        -0.013195978938192826, 0.021949253576195427, 0.04897600697294496,
        0.03373302479260887, -0.018228816007791526, -0.06444812653805371,
        -0.06467544810932524, -0.018792147488107147, 0.0331028584883447,
        0.04851501672952779, 0.021736663652858923, -0.013210658462188857,
        -0.018005865959961592, 0.01137974637270564, 0.040933517506754835,
        0.033303233917572395, -0.01334697036577244, -0.060930156793364665,
        -0.06651713240112489, -0.023250870161964088, 0.03256483237853661,
        0.0552333383514044, 0.03179738966737744, -0.007895042781681239,
        -0.022289886101433287, 0.0005191651123831464, 0.03177237563220489,
        0.03194669310590606, -0.008125127433032536, -0.05577237185312228,
        -0.06656293957174475, -0.027090432127758746, 0.031130098204789423,
        0.060449930190345114, 0.041013082253465394, -0.002329302515900189,
        -0.025932610100564663, -0.010338700655465868, 0.021738738875559674,
        0.029695813510447276, -0.0027095926143009263, -0.04911658745654579,
        -0.06480902374418362, -0.03020076455945908, 0.028843445142333442,
        0.06402618639813007, 0.04913325996376561, 0.003333506036571565,
        -0.028836982216806625, -0.020900579544091736, 0.011102724010532972,
        0.02660801118888452, 0.002748779000520396, -0.041144878333229495,
        -0.06130022483789038, -0.03249143963655643, 0.02577297978120618,
        0.06586803170517641, 0.05593672150177853, 0.008936795805327136,
        -0.030926907649496516, -0.030881643822439242, 0.00015113101238371784,
        0.02276424529069479, 0.0080987811465911, -0.03207459657360773,
        -0.056128924115027845, -0.03389428483810042, 0.022008117007131192,
        0.0659283968001439, 0.061237573384688604, 0.014324777200425576,
        -0.032149246446997556, -0.04001319479113169, -0.010820294815088255,
        0.018266895086144375, 0.01319304297112936, -0.022152443712204373,
        -0.049432611178698016, -0.034365392708729625, 0.01765699138416217,
        0.0642084191630955, 0.06489031025488934, 0.01934678634042819,
        -0.032475161654339946, -0.048049900556467795, -0.02151485365676148,
        0.013237031515692776, 0.017892087833313614, -0.01164775824303016,
        -0.04139022652031854, -0.0338864673087505, 0.012843363605909583,
        0.060757338774042324, 0.06679380897126952, -0.09927306385527984,
        0.07061321294386258,
      ],
    ];
    const result = wavedec(data, "bior2.2");

    const reconstruction = waverec(result, "bior2.2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5064596300931461, 0.9339492522760809, 1.2197730243860545,
      1.3299780169389572, 1.2651409159983815, 1.05822398920271,
      0.7651763847198777, 0.4507033005440756, 0.17276366254624803,
      -0.030391716890246112, -0.1475228089361736, -0.1943863164026824,
      -0.20660924438728798, -0.22745117068960163, -0.2937391714347215,
      -0.42370859941663364, -0.6099872024329609, -0.819644201474294,
      -1.00141969621639, -1.0984057101603577, -1.0630309620296823,
      -0.8705644301557866, -0.5276609179636274, -0.07365282836490639,
      0.4259436823434734, 0.8923287622531451, 1.2497605866987744,
      1.441508676428934, 1.4416587015433695, 1.2599986161894923,
      0.9388827852659587, 0.5429038936788397, 0.14392569057229426,
      -0.19488073831818042, -0.4321647767480976, -0.5556090166731045,
      -0.5816532808330085, -0.5480372739685545, -0.5012567241611734,
      -0.48227740065350605, -0.5142533817201986, -0.5954526910035032,
      -0.6992431883864304, -0.7811740261909413, -0.7913593537841415,
      -0.688990474225504, -0.455217955034334, -0.10100559571936335,
      0.3322227278118383, 0.7795453373411579, 1.165621974539236,
      1.4208575029043848, 1.4968154944871372, 1.3771850769934972,
      1.0816516559732503, 0.6617224670062385, 0.18949322927420742,
      -0.25796400413093634, -0.6148760731605959, -0.8398675110916062,
      -0.9228593219056188, -0.8842950294962499, -0.7671209501932391,
      -0.6237243868692219, -0.501247357273577, -0.4290456146560975,
      -0.41146925332395606, -0.42775394570857506, -0.43898028269486516,
      -0.4002426615807686, -0.27482434156864644, -0.046639529534060586,
      0.2723875001132789, 0.6420823658406313, 1.0012084705643745,
      1.280496216091001, 1.4184315596428143, 1.3759814690630505,
      1.1466362480335628, 0.7592481019048194, 0.2728730371528443,
      -0.2352457433296353, -0.6857563425084207, -1.0135650813523216,
      -1.1806635030786363, -1.1824667963559574, -1.0463104412015503,
      -0.8226678311890544, -0.5714141627895502, -0.346636224519727,
      -0.18378602522469495, -0.09232883556144433, -0.05560873341120656,
      -0.03780640184595972, 0.003941929230836139, 0.10550690891234848,
      0.2835412904674746, 0.5283434324189406, 0.803797444410332,
      1.054581631726742, 1.2189798915055277, 1.2441786390113914,
      1.1002498952514843, 0.7892834521971899, 0.3472769492422386,
      -0.16185832462035488, -0.6588971439593131, -1.0656086372775193,
      -1.3209613499400588, -1.3934286394715998, -1.2865404755830185,
      -1.0364650074082369, -0.7023312960256451, -0.3517479209201126,
      -0.04510176757176759, 0.17753898728438627, 0.30379890072824534,
      0.34899821956556487, 0.34900385480381946, 0.34794444526281737,
      0.3840843115513208, 0.47759356365155337, 0.6234489176433231,
      0.7913791072145103, 0.9329616775930988, 0.9941376384873776,
      0.9299988767241834, 0.7180759168604995, 0.3666709676511247,
      -0.08403171873626353, -0.5685812223225692, -1.0091979000854105,
      -1.3320560654651847, -1.4830820939180454, -1.4395234611087968,
      -1.21454679075233, -0.8537975758248678, -0.4247887340788348,
      -0.0017032383080748392, 0.3507247454868261, 0.5904093943686289,
      0.7051191233134553, 0.712130452554611, 0.6506581235330938,
      0.5691774720395657, 0.5110000392417909, 0.5018579021427609,
      0.5427010088163626, 0.6095556382295368, 0.6604724028775715,
      0.6477659305335934, 0.5323740559934602, 0.29658786598812636,
      -0.048227875675732, -0.461080432893922, -0.8783404306700108,
      -1.2267696790154012, -1.4395464949966745, -1.4714608500046331,
      -1.309603330450302, -0.9769301153490642, -0.527792319567,
      -0.03645263910072738, 0.4187011403590224, 0.771512765925435,
      0.9811421053211327, 1.038865464638401, 0.9671409303467111,
      0.8113930336398187, 0.6267472325107799, 0.4631529717501505,
      0.35267742937707525, 0.30214923207002514, 0.29293679702932596,
      0.2878108427045346, 0.24302558876495947, 0.12241328460090645,
      -0.0902419150434855, -0.3838686498386198, -0.7198714040620844,
      -1.0392646043266682, -1.275580304359743, -1.3704663557702135,
      -1.288163752423713, -1.0252663239937545, -0.613274410243537,
      -0.11318562488584184, 0.39670582169157576, 0.8369802326207829,
      1.1434495221943066, 1.2798763303608047, 1.2441249159984327,
      1.066419172705721, 0.8003033640322865, 0.5086617449818325,
      0.24832029492500773, 0.05704160107770223, -0.053934420346357925,
      -0.1000876022609396, -0.11668916215933942, -0.1466904926193377,
      -0.22667888802381003, -0.3746322259019657, -0.5827419138233563,
      -0.8172818919123883, -1.0257044602375862, -1.1492911428883101,
      -1.1382432334854382, -0.9654254201495791, -0.6352484560000135,
      -0.1853299208621744, 0.31967697218625846, 0.8007799110603273,
      1.1809546196634386, 1.4012470176516851, 1.432885451816596,
      1.2825739693553866, 0.9897837686947972, 0.616790659901177,
      0.233945833485811, -0.09621236913531628, -0.3321705645437084,
      -0.46085893361621577, -0.4976396705138807, -0.47910135180052993,
      -0.4506926702892462, -0.45250353805538585, -0.5069370738201957,
      -0.6115059805287977, -0.7386609279764786, -0.8427501004902752,
      -0.872371924216029, -0.7849784468139649, -0.5599686197646401,
      -0.20683671191305902, 0.23386623673056084, 0.697234497320079,
      1.106948870880616, 1.3914684675144722, 1.4996468688349958,
      1.4120457983142027, 1.1452340765480782, 0.7480413402516348,
      0.29067114911793424, -0.15070971930243005, -0.5102209024135848,
      -0.7455096063497628, -0.8449160219892238, -0.8270223214463611,
      -0.732936915081236, -0.6134534539378501, -0.5144641854188025,
      -0.4643938636595177, -0.46686076601732157, -0.5004086967674191,
    ]);
    const expected = [
      [
        4.00947797410437, 2.775919113738945, 2.949749019280411,
        2.6100277588775387, 3.4936370484769594, -1.758184564260157,
        -0.6925432426118826, 2.1250859689251143, -0.9773368909551275,
        -1.2893757412635525, 1.8993913616865505, -0.24504404998439341,
        -1.575474914229919, 1.4637805563425517, 0.28450568067995236,
        -1.5888896513132278, 1.0642708849712668, 0.5900599875770556,
        -1.657426904012257, 1.6542769919139395, -2.87723173469397,
        -1.5268406468277123, -1.6309747239302668, -1.9437342217912827,
      ],
      [
        0.05740107345483636, 0.022108572471496335, -0.0737108662750563,
        0.34019243944476796, 0.024721430462903538, -4.84059544227533,
        2.9770547236734504, 2.4856383153970842, -4.618163575754599,
        1.0488087433419442, 3.4713281373971228, -3.5267749869037703,
        -0.4487792596906506, 3.4778748892275306, -2.3620516345779543,
        -1.1460229444076115, 3.1022630461679688, -1.7092979281890144,
        -1.393481308853648, 1.7300155039529428, 0.06767485631194681,
        -0.03932682512722707, -0.4329153264151152, -1.3737981197110725,
      ],
      [
        -1.7458527484319482, -0.3576095218890828, 1.0978162859586087,
        2.1272360225606612, 0.32714745149896785, -0.5176104820919247,
        0.4594718894559163, -0.0824087678053611, -0.45880940969838563,
        0.7937932371694976, -0.5830943985291419, -0.14707670473131496,
        0.9058612632551974, -1.0557802465980088, 0.3537378519643807,
        0.7484990995683146, -1.3767249028739532, 0.9345414772481497,
        0.33534911502872883, -1.453580354104591, 1.464921745074573,
        -0.26162226055383037, -1.246183149346375, 1.8218389381236813,
        -0.9274725037565069, -0.7759255339131663, 1.916788494174177,
        -1.5291259480565684, -0.12163654743857744, 1.71546831737162,
        -1.9442685084040046, 0.5971366810691922, 1.2456286943736616,
        -2.087950311747902, 1.231303983771779, 0.0012767124421368403,
        -0.01728267510226561, 0.005440519732742899, -0.3308125307112434,
      ],
      [
        0.7842103852109013, -0.41513933741823106, 0.1565148403959889,
        -0.32833415950788847, -0.1721894279891485, 0.1715383681019108,
        -0.09051862260279445, 0.055943459535855306, 0.300330794889593,
        -0.2176249364458548, -0.27860141570317654, 0.20251056092471287,
        0.026483055649460907, -0.044790697801138146, 0.2623023315887192,
        -0.12245235468980267, -0.3513243089544671, 0.1806498095190347,
        0.15711911242284676, -0.1087353202366513, 0.17300514038560524,
        -0.021347439971712012, -0.3732411965520278, 0.11496645891733898,
        0.27558521118503043, -0.1233308160837196, 0.04776250837651342,
        0.060891696369108246, -0.33775769277467493, 0.024188460566959558,
        0.3582151481888258, -0.08745701403188999, -0.09026154333715403,
        0.10416989168505311, -0.25029183969985364, -0.06745189879912927,
        0.3886192280887, -0.011629265029400204, -0.21504291058715158,
        0.09755414913450144, -0.12714157688511157, -0.13563924741867178,
        0.36123969213695833, 0.08437249350304277, -0.3033070813832305,
        0.04170740216926816, 0.008023012174904948, -0.16141207812202574,
        0.28254387088116667, 0.17591984613510625, -0.3395390927965428,
        -0.05123813929671461, 0.12927446965953057, -0.13541973250972328,
        0.1695938315035797, 0.23902617099569767, -0.31929655986231953,
        -0.1603407138056564, 0.21402910610204812, -0.060062844191495046,
        0.04630670609364895, 0.2557040742153856, -0.2501008527297465,
        -0.26045813546188945, 0.2479073433728473, 0.05124670018207278,
        -0.036851322151845944, -0.026007717889509285, 0.044958677672182173,
        -0.10119941412620731,
      ],
      [
        -0.05008644162457382, 0.17906051941804704, -0.027920114051832867,
        -0.062090614964255164, -0.05023280416597098, -0.007575050990536736,
        0.026440228177363495, 0.024843342776853114, -0.0030472760787434022,
        -0.02251478451738674, -0.00826551118127311, 0.02997760842282149,
        0.05554033277676079, 0.03928140005252273, -0.011742013965337177,
        -0.05857804617481088, -0.0642795810002097, -0.02646808892780056,
        0.021273934792104737, 0.04024844674586617, 0.021093091104375433,
        -0.009829217820914699, -0.017403074587268696, 0.007728556761163796,
        0.039793921564069856, 0.042581913838281554, 0.004983082602625907,
        -0.04625931765686564, -0.06915094518970288, -0.04398054553303282,
        0.008758226121562268, 0.04664098641413192, 0.04297657244193248,
        0.009271048135404802, -0.01777499817418024, -0.011971690350621594,
        0.01766492679385198, 0.03633344169391867, 0.017913785240112792,
        -0.028227122593544263, -0.06377588185085886, -0.055876612028120665,
        -0.007687564420616133, 0.043381658753500724, 0.05844065311169244,
        0.030931062035384538, -0.009360584155781282, -0.02524124061997457,
        -0.006688441932789245, 0.021148378928123934, 0.023605968070445238,
        -0.00872210015918129, -0.04921445953302156, -0.059056744942430406,
        -0.023733604560756016, 0.03193553237786091, 0.06465976143805002,
        0.05062435692029704, 0.005815834383364915, -0.029700393465053265,
        -0.028659248066648893, -0.0003765501928398446, 0.020283140869990515,
        0.0078046329658920666, -0.028428029409287014, -0.052249604314536124,
        -0.03510705165752642, 0.015532599528229576, 0.06075183462339795,
        0.06414096228959698, 0.024133422502337354, -0.024981202929949792,
        -0.044185306682841, -0.024212629578999112, 0.008238931981620123,
        0.01767245241544521, -0.0056348861265321515, -0.03630477211088462,
        -0.03854776766373583, -0.0015582655530834676, 0.047960377404558385,
        0.06850870325311198, 0.04117644738373, -0.012793647992528717,
        -0.05062258274855269, -0.04576674169060452, -0.010216952089490194,
        0.018780302989889003, 0.01460732783421402, -0.014021679847361315,
        -0.03254207777709614, -0.014982185348732635, 0.029372331888863568,
        0.06264564966398806, 0.05271286080373666, 0.003465764111070052,
        -0.04730725433404634, -0.06087419436140523, -0.031257678377927645,
        0.011066280873840095, 0.028391282108939382, 0.01044807616135194,
        -0.017673096296924977, -0.021268481523501512, 0.009233898775517446,
        0.04760051651169106, 0.05563486131106432, 0.019476675721506242,
        -0.035683518018875676, -0.0666992485586011, -0.0503738339067743,
        -0.0034831081683356913, 0.03330473194397336, 0.032494254976814976,
        0.0034897002335949057, -0.01860492269299402, -0.0079853712833792,
        0.026328183652504444, 0.04865472701885848, 0.03096103838980721,
        -0.018969513677604743, -0.062346027504299406, -0.06336053337821568,
        -0.02127594319498588, 0.0289453048278754, 0.04804164374887715,
        0.026937835928546205, -0.007245791289806458, -0.018574713718955388,
        0.011860984664085306, -0.010988802971221207, -0.017295459491166038,
      ],
    ];
    const result = wavedec(data, "bior2.4");

    const reconstruction = waverec(result, "bior2.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4967068200757372, 0.9176577188305484, 1.2025232596049982,
      1.3182681806888417, 1.2647561910030962, 1.072889490662163,
      0.795864666571782, 0.495760088015578, 0.2287573042021781,
      0.0325783362599007, -0.08087239253097672, -0.12599013878411644,
      -0.13712151518517499, -0.1571261526753765, -0.22384591071284632,
      -0.3579908905904164, -0.5555927671121248, -0.7870352108336389,
      -1.003028598582293, -1.1461552195462867, -1.1651998060298494,
      -1.0287464150652925, -0.7346491952050624, -0.3129440552242374,
      0.17867026751700366, 0.6658682179810944, 1.0727621729833756,
      1.3375262740199578, 1.424961254112708, 1.3331036512636072,
      1.0923997997073254, 0.757734123651413, 0.3952938051102217,
      0.06745822767582438, -0.1806690825176006, -0.32991721779409927,
      -0.3889389077002092, -0.3890620578831416, -0.37356293852389355,
      -0.38418662323285824, -0.4484011294138501, -0.5706683882298562,
      -0.7299989347909452, -0.8844785046704566, -0.9817018989642797,
      -0.9725537962486588, -0.8249063275716162, -0.5337750653107449,
      -0.12529874834292032, 0.3466147156305231, 0.8103611730197249,
      1.1911813427549671, 1.4268188076995179, 1.4806476010664031,
      1.3492045987934205, 1.06238305919902, 0.6762839719260565,
      0.26046005649397524, -0.11739732388616675, -0.40570286974476155,
      -0.5788303339748553, -0.6403533707890171, -0.6190862596431764,
      -0.5590987888857373, -0.5063412394784335, -0.49532031540755805,
      -0.5392200845000814, -0.6259772532892174, -0.7213162987981645,
      -0.7779975543002937, -0.7489616288037494, -0.6010532433813687,
      -0.32582415572199086, 0.055404088634895154, 0.49365537708503876,
      0.9212840197783483, 1.2658365118455366, 1.465585237764734,
      1.483087638088044, 1.3135629484952578, 0.986093322797061,
      0.5573538729304849, 0.09934615046375389, -0.3159765434548971,
      -0.6315876313636132, -0.8163188712386091, -0.8693782283689289,
      -0.8175594326490663, -0.7060252709374791, -0.5850944683660895,
      -0.49640461579183415, -0.4619331515374234, -0.47861104492286977,
      -0.519845319159117, -0.5435267109662865, -0.5044658465534421,
      -0.3680772381860609, -0.12179243567704573, 0.21878345822217654,
      0.6106825994006584, 0.99135658816203, 1.2917128420559156,
      1.4513735737743294, 1.4325411966137622, 1.2291447034004985,
      0.8690399783084913, 0.40867860952731383, -0.07855247414097113,
      -0.5176172559271068, -0.8471887032546368, -1.0315293350414403,
      -1.0662025747703785, -0.9764237499379712, -0.8086372267239809,
      -0.6175282573167167, -0.45175086585063357, -0.3419174775077671,
      -0.29379077772150525, -0.2882947730446992, -0.2882468665575582,
      -0.2500279985895606, -0.13716772575774389, 0.06766943846285883,
      0.3554297310933033, 0.6901220934694298, 1.0152958996155714,
      1.2661188163732602, 1.3842214715581391, 1.331751739828269,
      1.101221349403514, 0.7187005936523319, 0.2394893301949308,
      -0.262816164178576, -0.7113647384482864, -1.0417258936209464,
      -1.214580943176613, -1.2225366782487164, -1.0895859823261134,
      -0.8635049256770887, -0.6031596545237854, -0.3638906218751008,
      -0.18455815242051915, -0.07937390910382686, -0.036423299222066885,
      -0.023105338051194017, 0.0030082837445650767, 0.08074078800867845,
      0.23279026072627973, 0.45738280830044437, 0.7263252056318692,
      0.9900926641605173, 1.1888307510152092, 1.266659350592739,
      1.1858080305552279, 0.9370993395288858, 0.5441361926487525,
      0.06004015022523211, -0.4426316598681428, -0.8865241557431665,
      -1.2053107445547853, -1.3570515328595596, -1.3320136084088383,
      -1.1532074417867269, -0.869632371880227, -0.5439564271683658,
      -0.2376617760629296, 0.0027483433554849612, 0.15519644423732953,
      0.224953882014407, 0.24049284561973533, 0.24347239934099946,
      0.27550912205859307, 0.3651674628934753, 0.5185372044588457,
      0.715862877176654, 0.9151747066164284, 1.0621151005365281,
      1.1035904224480608, 1.0018901529500512, 0.7457492011431263,
      0.3555282149141318, -0.11891620915648508, -0.6073428781495598,
      -1.0332010434430141, -1.3294405498495976, -1.4523918816849282,
      -1.3904957903659187, -1.165881790382331, -0.8284939742088208,
      -0.4442297205039155, -0.07996414521108153, 0.210959263975533,
      0.39935264754584315, 0.4844907772684097, 0.4912395998162914,
      0.46091250232910136, 0.4382931217955487, 0.45818696705468753,
      0.5349538109345096, 0.6577085554371824, 0.7924490810166814,
      0.8906273618291196, 0.9020535608118643, 0.7889125422907197,
      0.537352791912218, 0.16366031087210042, -0.2866775242841239,
      -0.7469943468289064, -1.142802860324779, -1.4074245113260602,
      -1.496247844000288, -1.3962712951872336, -1.1286919579842793,
      -0.7439478492296913, -0.3104091738815994, 0.10058876721019006,
      0.42983387427216646, 0.6419205998109858, 0.7308632928022643,
      0.7184734621846478, 0.6461047369156508, 0.5619777952081081,
      0.5073527809036944, 0.5050627533008638, 0.5533008555716581,
      0.6262206741001641, 0.6811925246735886, 0.67088077151912,
      0.5570817983648793, 0.32279129955222785, -0.020629134167143348,
      -0.4331384639669612, -0.852840127082193, -1.2084765625442835,
      -1.4347207874208459, -1.4866742876603332, -1.3501301625204207,
      -1.0451434315688037, -0.622030173952617, -0.15071177064501,
      0.2941044561082802, 0.6484425647566063, 0.8716689542979792,
      0.9533213362158055, 0.9126970143824931, 0.7915007020737709,
      0.6415243070388468, 0.5105099177050094, 0.42974718930299427,
      0.4064827659888837, 0.4229912509236689, 0.4424779125428612,
      0.42026626364756153, 0.3173912938047483,
    ]);
    const expected = [
      [
        3.906145227708389, 2.7325200849316946, 2.8759844548361277,
        2.530122146678685, 3.679165871960528, -2.174896403714199,
        -0.15501037724441483, 2.046229188592923, -1.8578883831984774,
        0.021499789816148432, 1.6318007910493781, -1.7995040250199794,
        0.46759107364120034, 1.3303595526528085, -2.0829424949490876,
        0.8828440616653586, 1.3807848417698132, -2.4178700579971197,
        1.1586122927096105, 0.5520989504587179, 1.6242281751381475,
        1.429116410722289, 1.2640347410967687, 3.1676903424439247,
      ],
      [
        0.06344362121460234, 0.0302186097082362, -0.08554162192613624,
        0.34070188402784896, -0.2777558137086269, -4.352458079930531,
        3.441525779162839, 0.7441686700912102, -3.3647870580285786,
        2.5580333033968676, -0.09864953574783542, -2.0393473852010833,
        2.911121274753052, -1.5925683740594105, -1.7801391789087013,
        4.1864169177698445, -2.249944187858938, -2.669193544232777,
        4.965730648574193, 0.899480494840621, 0.029428181662013386,
        0.024540699206711036, -0.18194458995839174, -3.458527472534235,
      ],
      [
        -1.7217636900922741, -0.3495100900898691, 1.0789487133385212,
        2.1028343054405836, 0.296809003750774, -0.6037899446253777,
        0.7262439662944673, -0.34321238318394043, -0.5028484785331798,
        1.219759047510681, -1.0846806255108534, -0.024049172357779924,
        1.325342896568269, -1.6931527867575311, 0.6678467384373441,
        1.017016527665298, -1.9696676412794971, 1.336804929864743,
        0.4066674676769125, -1.8255516823565614, 1.754165594533366,
        -0.2932404104603715, -1.3119580871045038, 1.7748344177601032,
        -0.8404662878253963, -0.6028196619047106, 1.385632155785928,
        -1.0437125844861197, 0.06310461162746528, 0.709694042371353,
        -0.8263721455426335, 0.4617809123130885, -0.03454675002921226,
        -0.25198641358667206, 0.368827721235444, 0.055987914562342644,
        0.05802326495099924, -0.10280549625750524, 0.05176685002537168,
      ],
      [
        0.7695581848832433, -0.4100292958244414, 0.15649292198473436,
        -0.31642824557638555, -0.17023632097215935, 0.164974353810452,
        -0.09310578880846922, 0.031106536537790108, 0.3147794285406842,
        -0.16040246775497558, -0.29734876779636177, 0.15893843662354729,
        0.031302218544375926, -0.07370132179440034, 0.2765780900862031,
        -0.016418062319949245, -0.370048500698282, 0.07561942085703044,
        0.16535105085427745, -0.10934306360633361, 0.17124028940334524,
        0.11370136986250412, -0.3640090760089573, -0.058580050474681844,
        0.2629031083693778, -0.06407860666209408, 0.035201694242571524,
        0.1880924769766582, -0.28107803197710973, -0.20027089635634643,
        0.2899555810120117, 0.04681672817505367, -0.08490870762755007,
        0.18348300662766154, -0.14866156017681356, -0.30353188397986164,
        0.23597127239132565, 0.18614179871189862, -0.14780586744351382,
        0.10294345726950171, -0.010593809483059241, -0.33520760757581347,
        0.11739135108357768, 0.3071643894797449, -0.13130542974955972,
        -0.02513798700052626, 0.08746707851076643, -0.28595329221556015,
        -0.027840326632968537, 0.36919153308697983, -0.03971660377549302,
        -0.15651571170640893, 0.11325055982509646, -0.17334659696430665,
        -0.1529169788119386, 0.3511277972272503, 0.09759195374918217,
        -0.2458302150775288, 0.05862481711985579, -0.03602965148696999,
        -0.21776152293904572, 0.2585042846493955, 0.2359754376890022,
        -0.26172278904890045, -0.05769455529268264, 0.08149522889385527,
        0.12081076796803772, -0.008319487000179426, -0.040200630597660714,
        -0.10314484343314095,
      ],
      [
        -0.04811343972405624, 0.17561238036858007, -0.026783762840530634,
        -0.059793168510849426, -0.048915777056692866, -0.00815992544545191,
        0.02504000023598907, 0.02415935766556813, -0.0031371715436858683,
        -0.02383841579307109, -0.011964447273090845, 0.025762292458286096,
        0.05497683715717916, 0.045116212825192015, -0.0015614233927086218,
        -0.05025049177409971, -0.06338950060731718, -0.03322052163817446,
        0.012234623548909473, 0.03495906755094468, 0.020823778420122077,
        -0.009235805950120413, -0.020524747527381926, 0.001715079253460594,
        0.03760800343017118, 0.050729181716748006, 0.022428418413400486,
        -0.029318870169370556, -0.06427907227554269, -0.05493460869541078,
        -0.010509313780458496, 0.031661354728940785, 0.039458123718123655,
        0.013689714425671518, -0.014756125399615405, -0.015152378974748554,
        0.013667592729753236, 0.04202776125494251, 0.037476361250431744,
        -0.003755672424399996, -0.051195862492297683, -0.06612406177262875,
        -0.03580428969951516, 0.015091436570744354, 0.04627301403265416,
        0.03708002653934156, 0.003322214236170462, -0.019169095022983806,
        -0.008681991710500409, 0.022182737420057802, 0.03885417205207137,
        0.01814550809183925, -0.028396607487171266, -0.06310684384169823,
        -0.05540472671460672, -0.009499878802611439, 0.03871173964520343,
        0.052915413923311116, 0.027579886255186148, -0.008956065270182334,
        -0.02181660896147075, -0.001926193587241165, 0.026389721768248525,
        0.029317753207900962, -0.0033653178286638386, -0.04692369847949307,
        -0.06295394961284834, -0.03418525683771878, 0.019005941370548923,
        0.055686817680030254, 0.0498179464345756, 0.012114229214002903,
        -0.021190775137783113, -0.022002912109859246, 0.004523949198809376,
        0.02627501617534402, 0.015680039753981675, -0.022991354843477363,
        -0.05610182359896587, -0.0510016519752956, -0.006567525642550004,
        0.04423161762551375, 0.06250071327941986, 0.03704140098493436,
        -0.0068523220686353414, -0.031099269897032718, -0.019169125376215748,
        0.010273260619694038, 0.02252538174771085, 0.0007022124433007371,
        -0.03728753379779265, -0.054603026875855665, -0.02977748201632746,
        0.02212130662734857, 0.061266621669385624, 0.05752946831860828,
        0.016573323428158537, -0.025930371500308996, -0.03650624509443895,
        -0.013108317237764677, 0.015030695124063548, 0.016259178191475487,
        -0.012926705605095568, -0.044041162105269815, -0.043180441027829364,
        -0.00352810482591228, 0.046381560036256375, 0.06675083824343697,
        0.04142400224016657, -0.007969353022777681, -0.04142174302393253,
        -0.03582645729929776, -0.004157157289177427, 0.018503211994998575,
        0.008726304468575141, -0.023081239448144303, -0.042600187434287506,
        -0.024426613461588254, 0.022650478455898043, 0.06162107664439642,
        0.05955345440509441, 0.017043092703244334, -0.031988845430508714,
        -0.050053970415182863, -0.028486500419430072, 0.006704081408068219,
        0.020328720717195187, 0.0010529444645579478, -0.028518790617506923,
        0.03637179439510743, -0.014742579064409733, 0.014061846565152247,
      ],
    ];
    const result = wavedec(data, "bior2.4");

    const reconstruction = waverec(result, "bior2.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.6", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4859350839015243, 0.8969355213839364, 1.173925997691279,
      1.285772135683453, 1.2347365500555696, 1.0540905221297754,
      0.7985863638961156, 0.5302372540635694, 0.30297952694774527,
      0.15002870665878465, 0.07702872920614534, 0.06261345545298394,
      0.06612149950440362, 0.040399000391218465, -0.053658607723612806,
      -0.23461502707050486, -0.49332784900763976, -0.793047193080731,
      -1.0768856825086317, -1.280902345325892, -1.3496093711016515,
      -1.2500672038917493, -0.9810428020245674, -0.5748936020393297,
      -0.09161268563189551, 0.39361010315802475, 0.8063665340308275,
      1.0887371398454566, 1.2109885711468933, 1.17651481602331,
      1.0189416605728177, 0.7922393728410468, 0.5563963682206836,
      0.36227350115068846, 0.2394214066576324, 0.1898639700300907,
      0.18932603160581052, 0.19549479143571813, 0.16112427329636328,
      0.04856544936218943, -0.15806218004463712, -0.4462565979992328,
      -0.7758843131201317, -1.0872526597078656, -1.314610584560117,
      -1.4018001573199532, -1.3162068002606178, -1.057538018747528,
      -0.6592057341344526, -0.18188878404907918, 0.2992361858984697,
      0.7105590231922615, 0.995558048271678, 1.1260864124218928,
      1.1067826067034499, 0.9716648149539865, 0.7738931959837798,
      0.5713553845237789, 0.41173437019935044, 0.3208067757654,
      0.2968737182656789, 0.31265894285717066, 0.32411237302069884,
      0.2838059292258103, 0.15544025895105873, -0.07431183822178022,
      -0.3897431385352222, -0.7475060863354039, -1.0852688199666378,
      -1.3356081971596245, -1.4417804855674081, -1.3715060622803212,
      -1.125357978376381, -0.7376451962906184, -0.2695084782284433,
      0.20415196651235157, 0.6107937730689614, 0.8955365641121789,
      1.0320109515964782, 1.026222766358795, 0.9126344629413925,
      0.7435859123657355, 0.5748088626246859, 0.4507285941271108,
      0.3932609718912495, 0.39690186770027197, 0.4312980768075727,
      0.45058706809497723, 0.4070728974098581, 0.26569758828856227,
      0.015548747535829965, -0.3246292303965579, -0.70846146419748,
      -1.0711621223507368, -1.3437935372065775, -1.4691292891518661,
      -1.4152518654126447, -1.1835399258748511, -0.8090547256438169,
      -0.35318528451381487, 0.10970043942964972, 0.5083932445115577,
      0.7898968132510708, 0.929813542678734, 0.935647368955411,
      0.8423695367844191, 0.7015065121258429, 0.5665996697347901,
      0.47875951184519183, 0.45597750609567334, 0.48888321091824016,
      0.543988378656057, 0.5735553672564666, 0.5295408779150709,
      0.37801972764671726, 0.1103494019634198, -0.2518681725813344,
      -0.6594329315947492, -1.0453080107078734, -1.339217403902627,
      -1.4835735245691775, -1.4468655160453139, -1.2312335907984056,
      -0.8723606165904101, -0.4316822043092446, 0.017212163631466992,
      0.40470514778475747, 0.67992414000289, 0.8206388101825876,
      0.8359879814201302, 0.7615273385210128, 0.6479928405241544,
      0.5467210851086677, 0.49547348279128345, 0.508277049570155,
      0.5718563136343406, 0.6495490058381348, 0.6916939359849201,
      0.6498291947935637, 0.4910556614049706, 0.20885153220877672,
      -0.17251283810906948, -0.6012278031557111, -1.0082244917179988,
      -1.322082192213512, -1.484991440523159, -1.4659099382315104,
      -1.2677118574291462, -0.9265862322889711, -0.5038272648942408,
      -0.07201137282056097, 0.30108571496228687, 0.5669492985316227,
      0.7057107188593764, 0.7282844607790421, 0.6708957508580832,
      0.5835277027876804, 0.5153170418879405, 0.5006642551782527,
      0.5496156637006435, 0.6449751039519356, 0.7468875671851961,
      0.8037356323621272, 0.7665776137655049, 0.6034376609826099,
      0.30976348853189206, -0.08770247440411844, -0.5347679792710089,
      -0.9605654601023645, -1.2927391845112732, -1.47341399472974,
      -1.4720951276144416, -1.2923799268760008, -0.9708643245884971,
      -0.5685282574912522, -0.1567140229683186, 0.19888287817939448,
      0.4523320966847271, 0.5863176759099468, 0.6136724227653283,
      0.5713838392131151, 0.5087331773637227, 0.472680503091862,
      0.49427550701968864, 0.5795913520454523, 0.7075190341708737,
      0.8350132716683063, 0.9084848375139314, 0.8784629175645609,
      0.7137980953133674, 0.4117565895326001, 0.0013515678173334766,
      -0.4610782884353279, -0.9031123536410156, -1.2516840168913759,
      -1.4490244011762505, -1.4652818052556102, -1.3047828579842928,
      -1.0044480102062365, -0.6247864906059984, -0.23570068509708936,
      0.09941956111338879, 0.3374446936539999, 0.4637968489149557,
      0.49336953584097654, 0.46401096022184385, 0.42436320724218973,
      0.4192499915384952, 0.4764015286329236, 0.597948853743067,
      0.7589016903619951, 0.9130488252216667, 1.004831910353764,
      0.9842150350470671, 0.8207862518561344, 0.5134816143483879,
      0.09338100102321847, -0.38127355994619383, -0.8367642412151589,
      -1.1995503763126496, -1.4121558135177903, -1.4454832262409139,
      -1.3046113938543087, -1.0267202675248677, -0.6717093887938431,
      -0.30785224705681785, 0.003977289651760585, 0.22365475712182364,
      0.33951789236727703, 0.36866080903737874, 0.3498945104150139,
      0.3312945602277441, 0.3556043162342132, 0.4472860382294904,
      0.604582619541268, 0.7986777440532755, 0.9802409295618816,
      1.0917665889854096, 1.0826325256475997, 0.9230849609885041,
      0.6135855584964351, 0.18707647553182108, -0.2965445866374328,
      -0.7625264663858181, -1.1371020064860358, -1.363287173233275,
      -1.4128651206501894, -1.2917060018733355, -1.037201836595613,
      -0.7085217812305625, -0.3721395863609298, -0.08621967624056087,
      0.11230868726498061, 0.21486628296124105, 0.24088305440646612,
    ]);
    const expected = [
      [
        4.329546440682893, 3.73075833070937, 3.511106653462655,
        3.2431061179479026, 3.6251331399591367, 3.7734601585054244,
        2.768732056730743, -1.875045352300593, 0.10054379767045817,
        1.7049257961921598, -2.367279490663334, 1.4857572388014708,
        0.23884047114718993, -1.6948744120158665, 2.1274551345594577,
        -1.3748073679125619, -0.1987202869176762, 1.7680989667974112,
        -2.3220454337297602, 1.3844780632805123, 0.3716905492954268,
        -1.5737623792931879, 0.12110942393682814, 1.1235509988351904,
        -3.7184505314775205, -0.29074986200546477, 0.8231691223410659,
        -2.293611316945389,
      ],
      [
        0.1442714215491473, 1.3798782596406738, 0.5124718212452302,
        -1.1948494190027343, -1.0350240052523791, 0.4765217418094997,
        0.04757973314977049, -3.77128129816205, 4.196945356828573,
        -1.3150745872939167, -2.261445314505291, 3.67191978821881,
        -2.604871898109048, 0.6052576916656097, 1.2767077028139213,
        -2.839971179510806, 3.337133005089671, -1.5898125442075357,
        -1.9089044423205466, 4.371468163210398, -3.4953802208546496,
        -2.1153468589407534, -0.45921468589288356, -1.3709092393994864,
        1.1729291342458894, 0.3393594941293617, 0.7347713104930297,
        4.356539237984474,
      ],
      [
        1.2011683778199043, -0.58221159321753, -1.0855426630424174,
        1.9084726680202224, -1.084122356123244, -0.05465479899113784,
        0.8821006537980222, 0.20664434416529673, -0.7786395762058428,
        0.7275384816974075, -0.4109254810912556, 0.04914574101768232,
        0.42006809772240317, -0.8930595485332363, 0.8794983238567893,
        -0.03511649756697399, -1.1521577806062446, 1.5549061696913768,
        -0.5411024475194903, -1.1523653524268918, 1.9467578728259642,
        -0.982765841427536, -0.9146865453092186, 1.9808064152817124,
        -1.2522275946547292, -0.5098417089218117, 1.6518169392411695,
        -1.2735845122646916, -0.040654427068128496, 1.0244261119125249,
        -1.0214249964421414, 0.3819559326133752, 0.22006243119313096,
        -0.5288873766850752, 0.6639952904620112, -0.6070198098446979,
        0.1528968157124051, -0.1024074078444589, -0.8092955516628444,
        0.2714321926496532, 0.8493306364330887, -0.9691187762228669,
        1.9122995585205735,
      ],
      [
        -0.3235359915141013, 0.15849101780690378, -0.014664520174959672,
        -0.3925068968837718, 0.7607762648442082, -0.315098335389366,
        0.08209577686058672, 0.035820819806496075, -0.15540347066019033,
        0.2705504638126631, 0.1542130444798676, -0.32012621933653773,
        -0.018327525528543553, 0.09796705261505918, -0.1880292387024643,
        0.16799911351554278, 0.27923695863828213, -0.25254849243699157,
        -0.12530301045738634, 0.1338863399205265, -0.17603414082714397,
        0.040030389966546634, 0.35163678769029627, -0.13397225805057747,
        -0.2155458283201091, 0.13311367139091362, -0.1255640371271945,
        -0.08723325858663691, 0.3583188656295655, 0.014049615911942426,
        -0.2680732117078846, 0.09403666032211361, -0.05108510147646858,
        -0.18898999876575473, 0.2990249894661849, 0.16357631765930503,
        -0.26889758141042197, 0.024464312255903287, 0.028168956768271025,
        -0.2467497179679009, 0.18623970864550832, 0.2857762710062093,
        -0.214361137171189, -0.05997126277586662, 0.09272135917121777,
        -0.25186917064362285, 0.04254920628308137, 0.3566863661157055,
        -0.1123565469541637, -0.13924796561578834, 0.12733036891686889,
        -0.20692921957864613, -0.10398789972742445, 0.3620548056185274,
        0.0188822865713546, -0.19347719592565046, 0.12442531815786612,
        -0.12471958560404905, -0.22549473680530296, 0.3002690520825498,
        0.15422161679412427, -0.2075212919300864, 0.08574456540121281,
        -0.025106399924566036, -0.2997917263825426, 0.18275880665254807,
        0.2665984030985197, -0.17863610312363093, -0.06695531612000175,
        0.2477338075458405, -0.19124882176545396, -0.1350655982158967,
        0.016013779220187763,
      ],
      [
        -0.05758738565154792, -0.047379676146718785, 0.17180399652161088,
        -0.02649339831438524, -0.05838734074861052, -0.04582421133072012,
        -0.004541376189792834, 0.02627145885313606, 0.020712820629852732,
        -0.010334557644729077, -0.030723369349619955, -0.014497994937605535,
        0.028221277441540238, 0.05948507264466274, 0.04848093730905684,
        0.0006865555649273603, -0.046098350534618665, -0.055410721051928735,
        -0.024440839106816936, 0.014750296086950387, 0.02591357480072659,
        0.002371175907454101, -0.027643740618501972, -0.028838214650868384,
        0.006455661654992728, 0.04955699613614528, 0.06119140314399485,
        0.027925296282606427, -0.024678780670377265, -0.05461362591870317,
        -0.04094642743938931, -0.0016851035149870186, 0.024286791513725953,
        0.014042533301888427, -0.018299878934678715, -0.03584551498995589,
        -0.014966497498336062, 0.030908824085786657, 0.062383333178755385,
        0.050050679030496814, 0.0019529322959365714, -0.043097810244742005,
        -0.05029741494037909, -0.019608158425941824, 0.015802698557236233,
        0.021605123748898947, -0.0053412080826553965, -0.034599137301427996,
        -0.031830106702054176, 0.007471140218810318, 0.052076881041709655,
        0.06287399602509824, 0.02877367431068978, -0.022695624115582264,
        -0.050058507102089506, -0.035041262891495784, 0.0021058284356744172,
        0.023001530274858295, 0.00784869538303623, -0.02601498101118946,
        -0.041064934782566315, -0.01603265082275361, 0.032514780074676036,
        0.06401583679008949, 0.050643358532329485, 0.002904778980396483,
        -0.03969485052411694, -0.04432339721441639, -0.013814693953356605,
        0.01768620893939113, 0.017951919934960536, -0.012568031803258384,
        -0.041333499871497564, -0.03505843946060677, 0.007678570288885529,
        0.05336833707511973, 0.06332727364392987, 0.028861744939559175,
        -0.020760232348606522, -0.04493740076580109, -0.02827099596840421,
        0.006773159189095934, 0.0224874788802579, 0.0023168434939106197,
        -0.03323616965453513, -0.046150815952005986, -0.017536086221535893,
        0.03310099652323492, 0.06434448168789103, 0.05013401275515883,
        0.003351038229962966, -0.036114659539459304, -0.03769969232613926,
        -0.007199081821493397, 0.02038153208732943, 0.01506555948599228,
        -0.019099898731403664, -0.04760345462812848, -0.03831228847525048,
        0.007211001078489475, 0.05346833144200458, 0.06249280732892781,
        0.028046213787212282, -0.01907970646522264, -0.03948235975486777,
        -0.02083534768478143, 0.012209802746485338, 0.02276734919288176,
        -0.002406178932351677, -0.039739387115685476, -0.050867796118213404,
        -0.019287733159870007, 0.03277600662233546, 0.06338435341448118,
        0.04844363595018608, 0.0031276262798514143, -0.03258067652946324,
        -0.030660227310305405, 5.881305324773045e-5, 0.023819587006277843,
        0.013010249717334388, -0.024762004816144156, -0.05317920338314647,
        -0.04136916926330392, 0.0062363927521914, 0.0524639196303473,
        0.06036466865275508, 0.02622513744064886, -0.017841111870185444,
        -0.03393079035681113, -0.009198317756749591, -0.027061267932757427,
        -0.030897577614862393, 0.0027231175366673743,
      ],
    ];
    const result = wavedec(data, "bior2.6");

    const reconstruction = waverec(result, "bior2.6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.6_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5054033951067185, 0.9305286411997402, 1.2121681246664764,
      1.3171444513187305, 1.2480783863769005, 1.040683084929519,
      0.7534149044994956, 0.4522021974506098, 0.19416592097333907,
      0.014440390388390179, -0.08064614353910296, -0.11244306842497619,
      -0.1213786594446414, -0.15329932172859867, -0.24445774718376867,
      -0.4092028180721546, -0.6337184286004955, -0.8775860055341418,
      -1.082908844748404, -1.1887569286275184, -1.1472762308920004,
      -0.9373208859495745, -0.5720378996082085, -0.09832102313879394,
      0.4119217944793513, 0.8766875003113055, 1.2214217329382175,
      1.3949536440166912, 1.3799776212358732, 1.195590967534027,
      0.8913714285208052, 0.5345756285629271, 0.19372914375042727,
      -0.07726466226692191, -0.25056043121404814, -0.3285995057637095,
      -0.3402539577813847, -0.33009206892322623, -0.34373250023076724,
      -0.4132440039221917, -0.5465141977772769, -0.7234646343825026,
      -0.9001989426290393, -1.0200952006060913, -1.029025089707485,
      -0.8907704122632962, -0.5985995079105662, -0.17989349279535552,
      0.30755747667100425, 0.7868722165855631, 1.178365982240447,
      1.416890163732195, 1.466015658483275, 1.3256168939383284,
      1.0310436526658793, 0.6441512416775602, 0.23846993189320692,
      -0.1177753756080554, -0.37659428315361054, -0.5194785924619338,
      -0.5588211799129885, -0.5313736945613343, -0.4856435362415339,
      -0.46666336529772995, -0.5022097521224309, -0.594139523096519,
      -0.7171594743123888, -0.8253952134475803, -0.8650782357135727,
      -0.7900520992401114, -0.5760248229856755, -0.2297662114317632,
      0.20930009985403752, 0.6757454198671125, 1.091568725374544,
      1.3832184619174108, 1.4980680862762603, 1.4163083010579554,
      1.15533378995876, 0.765553550384364, 0.31867458472959015,
      -0.10863663588520922, -0.4516896510850614, -0.6711714613642054,
      -0.7598161545484307, -0.7408771227088218, -0.6590253655908668,
      -0.5662114728905936, -0.5062817953237344, -0.5024141948964558,
      -0.5506685834843108, -0.6213318786965927, -0.6676913104499922,
      -0.6399191306527842, -0.5003963972930212, -0.23639235079764226,
      0.13334326759956278, 0.5599856416882555, 0.9739143233141488,
      1.2997237816993887, 1.4733331260910103, 1.456985274382812,
      1.2484093464771873, 0.881845544722951, 0.420640633790678,
      -0.05679257535273913, -0.47422312641442943, -0.7738558961929367,
      -0.9276737750702201, -0.9412154846935152, -0.849060580756122,
      -0.7033864967380025, -0.5586934465743483, -0.4567233365681315,
      -0.41549489778271764, -0.4252692835771502, -0.4524345519875521,
      -0.450222743575179, -0.37338180082133743, -0.1928759279353594,
      0.09334803551930793, 0.45650288858621607, 0.8412255441112662,
      1.177091200867417, 1.394625909791183, 1.441875183533493,
      1.2973893284593563, 0.9763372680486029, 0.5281474069884824,
      0.026171588258065703, -0.44815329284811917, -0.8228118689177396,
      -1.050153443246019, -1.1157039591951894, -1.0388345761500686,
      -0.865326235499314, -0.6538966187946875, -0.4602449310993858,
      -0.32274533784612824, -0.2534391216657104, -0.23656530998439154,
      -0.2348928677851035, -0.20208164150702235, -0.09772571221388066,
      0.0989751505469868, 0.38063071629379136, 0.7105757042520393,
      1.0297674813160218, 1.2700797394845904, 1.3707293853626172,
      1.2937194017387221, 1.0343693810945016, 0.624193972471875,
      0.12527943215115322, -0.38257716180747003, -0.8188973477887247,
      -1.11961332686092, -1.2501083391754357, -1.211113547983396,
      -1.0361631465063543, -0.781419277339412, -0.5105702914051011,
      -0.2787018553175256, -0.11924009100010213, -0.03722277345094155,
      -0.010487463335650968, 0.0016974700933693743, 0.044963329412352315,
      0.15484146747859012, 0.3444862409745812, 0.5984697603999131,
      0.8744262242532905, 1.1122859543426955, 1.2488566954675875,
      1.2340903994361314, 1.044882859856434, 0.6928204219344869,
      0.2237725393289699, -0.2907427363623245, -0.7684341045447316,
      -1.1337986356957874, -1.334135310027043, -1.3501576233210206,
      -1.1986989733973823, -0.9269754186762528, -0.5999668967618741,
      -0.28417018149157913, -0.03183819820455541, 0.13036408605920108,
      0.20553598525358274, 0.22266815124977926, 0.22592034599338617,
      0.2600110859216227, 0.355671743625151, 0.5190869257747223,
      0.7281988143019595, 0.9369634453065702, 1.0865700575158375,
      1.120802904676943, 1.0016086072114483, 0.720819628881094,
      0.30490861439433, -0.1886223173482469, -0.6825156984304117,
      -1.096060557688298, -1.3625067585483754, -1.4433772439241217,
      -1.3362217334370328, -1.0739802734398534, -0.7162061805843896,
      -0.33440946767720503, 0.004783947282418266, 0.25446575469134225,
      0.39664395168058, 0.44365607846928623, 0.43165733344523904,
      0.4080751481821746, 0.41645536220746465, 0.4827708678387648,
      0.6068584207439485, 0.7612986388101057, 0.8981049463683718,
      0.9615392623693719, 0.9037509858995341, 0.6991582078538354,
      0.3537580823600535, -0.09319765969323512, -0.5758109744421804,
      -1.0149827575602428, -1.3355044575757984, -1.4826575163686746,
      -1.4342727522249725, -1.2053103399461105, -0.843868613331795,
      -0.4196502069716965, -0.007771706501125408, 0.3280704690818159,
      0.5489524086620441, 0.6473938091796938, 0.6458748897524216,
      0.5878119261664969, 0.523517650673148, 0.4949273323909447,
      0.5231492871381919, 0.60213164517408, 0.7001239517491253,
      0.7685670921841106, 0.7560928446154057, 0.6239561790466794,
      0.35880890837343793, -0.020638586404267745, -0.4649898100054949,
      -0.9034550452066901, -1.2589275263467339,
    ]);
    const expected = [
      [
        4.409817901417459, 3.824650969856937, 3.6113272080671526,
        3.439644955394265, 3.6812305703276835, 4.060541854422715,
        2.1083267845268727, -0.8588517032952383, -0.7761766530323859,
        1.5109767566071606, -0.6176716926336565, -0.9755699409708188,
        1.5160135689501488, -0.3789854004510307, -1.188997003311217,
        1.4449957843278252, -0.10453389220155694, -1.3394519018478435,
        1.2971970406952744, 0.1612213387935339, -1.56782177657337,
        2.09782113609458, -1.7665828601696525, -2.1665673245179717,
        -0.19370568789973172, -0.7311830280354262, -2.5075027020948086,
        0.18938281934023987,
      ],
      [
        0.17422168969849727, 1.3958232562138, 0.4805289202475417,
        -1.1607751955648467, -1.0739645251403305, 0.45110573575669377,
        1.08004621138993, -4.394379140060016, 2.33911484004115,
        2.453621780730492, -4.6619305453243545, 1.6634260150509967,
        3.290981014998625, -4.612456901834208, 0.7527928243898325,
        3.952162091065435, -4.2070102983985675, -0.21555290330393095,
        4.2953160961486, -3.5357409149629206, -1.1562311446136746,
        3.407292472360897, 2.244574367042331, -0.26877619516343654,
        0.027066117392616357, -0.4518995190344297, -3.0247217423717565,
        -2.5389750139137504,
      ],
      [
        1.218203163117368, -0.6112739941230432, -1.1146844478838818,
        1.9588114773743277, -1.0812297974702534, -0.09209773674888735,
        0.9319782215008803, 0.4567132293388063, -1.3018580594318085,
        1.0182815510989647, 0.04925417036866736, -0.9619552179439191,
        1.0180967993599233, -0.28383844725615187, -0.5689304176328599,
        0.880930964882402, -0.507927282482002, -0.16824750835630287,
        0.6259991929049354, -0.6002941487965496, 0.19402250847511487,
        0.28507689719691287, -0.5524651919917037, 0.4760921941857954,
        -0.10088216779907588, -0.37110279210812613, 0.6448941357461179,
        -0.4860996448424275, -0.07729416786860832, 0.6795935123910095,
        -0.8248372118373537, 0.29568799221380715, 0.5738049176125597,
        -1.0762571309793496, 0.7059186108688449, 0.33545575406388145,
        -1.2217906937696836, -0.4062675154687849, 1.8302482426693159,
        -0.39144345856454604, -2.0651154868587813, 2.4223612907038756,
        -0.3492545029575229,
      ],
      [
        -0.3446194024902056, 0.160719473307127, -0.001378587017188293,
        -0.4181596552389101, 0.7907441123811644, -0.33702000517327746,
        0.08625254782504554, 0.045702348716019296, -0.11942241792290047,
        0.29456987519971983, 0.07301183808012346, -0.37689192081574896,
        0.03182732011755662, 0.13271043740563995, -0.12739296947584886,
        0.22187831778045392, 0.1374140615871905, -0.37867427106760954,
        -0.03761252092385248, 0.2069923680820579, -0.10893616348680585,
        0.1370900072744295, 0.18551178314190664, -0.35349095654780227,
        -0.11419187922586937, 0.26156052409466807, -0.06567135683228359,
        0.04863289367325907, 0.21134273396174613, -0.3043163195485276,
        -0.18923690676950766, 0.2915054639320291, -0.001895189446042056,
        -0.03471870047909614, 0.2113117336657739, -0.23661218635551945,
        -0.254195316817902, 0.29451222472882277, 0.0758721140547951,
        -0.104770550997907, 0.1845745676936815, -0.15774874680601406,
        -0.30154398815046946, 0.2711020497433123, 0.1595760092049796,
        -0.15477344676429744, 0.13313062655535282, -0.07622364122950223,
        -0.3255877825509571, 0.22457396609636357, 0.2404795087269721,
        -0.18013500763766566, 0.06161448847993904, -0.0007619163722751288,
        -0.3230650121443134, 0.1606524092633964, 0.3100875044342616,
        -0.1789030706229568, -0.02319150629757269, 0.06060787904761644,
        -0.2934954584794209, 0.08687820507183186, 0.36104569767217365,
        -0.15196948903992774, -0.11307210843233478, 0.10140366373613907,
        -0.23963974949738776, -0.011469573570358826, 0.2988636100226132,
        -0.32642601503013613, -0.1566476017587885, 0.6193708834466832,
        -0.22412316160387313,
      ],
      [
        -0.06153327765505068, -0.050729877878384844, 0.17868708395733232,
        -0.02838261177434459, -0.06245985808467136, -0.0489067705847166,
        -0.0049301346663169765, 0.027687029730118662, 0.022376255865987436,
        -0.008126449878518467, -0.026016807995298534, -0.006841953337242801,
        0.03516963702717796, 0.059564782749007894, 0.038337169509990054,
        -0.016078587066397185, -0.06052916126089025, -0.059895702964675224,
        -0.018588515321699972, 0.024696651430048372, 0.03367832728093102,
        0.007713241286989608, -0.01975340707740421, -0.015443297926249377,
        0.020095285387487227, 0.05203760254519202, 0.044736917439170465,
        -0.0028765915446844065, -0.05408291513851998, -0.06700694447378908,
        -0.032639755469801746, 0.017478266224563638, 0.040989070293842335,
        0.023613856697369345, -0.009457548735110788, -0.019934536639138828,
        0.0052270083083738594, 0.040555812004435865, 0.04675083693780585,
        0.009679941366610642, -0.04390198632948958, -0.06951192337854467,
        -0.04553970203024382, 0.006918242605147673, 0.04368901847941266,
        0.03803659075483093, 0.0038757002032717702, -0.0198209374564004,
        -0.007922744916554203, 0.0262094826138608, 0.04401079032460006,
        0.020119576422388555, -0.031154850153178593, -0.06716001074868255,
        -0.05585714847179901, -0.005737569856108793, 0.041647804977034235,
        0.049595115259183475, 0.01892188757931279, -0.015104840348775544,
        -0.01803222156003867, 0.010386365116411167, 0.03665108753383167,
        0.027199176863764607, -0.01727355756895571, -0.060204992977054894,
        -0.062425580560949046, -0.019016207700639554, 0.03523736007358082,
        0.057201777257608166, 0.03416703112487146, -0.0062854470789733274,
        -0.024109999680108102, -0.005374495722033107, 0.025294872329963455,
        0.030036023287522584, -0.0038018341714320947, -0.04937819011443495,
        -0.06446693832943917, -0.03137402089016461, 0.025291939591262386,
        0.06018219994724261, 0.04806756698644027, 0.005694018639003762,
        -0.025599624305911534, -0.019545141167047305, 0.010988766731174545,
        0.028201764412406825, 0.007768609003853108, -0.0358110654781682,
        -0.06167429311578787, -0.04136060061793806, 0.013019217354660245,
        0.05834615832098178, 0.05921346240541542, 0.01954618760001109,
        -0.022438171175778926, -0.0307698877259157, -0.00490731089769024,
        0.02176825318800349, 0.016156225478769104, -0.020915518125874222,
        -0.05424468719177905, -0.04777285402696563, -0.00012814519292962678,
        0.05200722942826708, 0.06647722835698233, 0.03377588625934885,
        -0.015062540439815753, -0.03800826596489847, -0.02086349381126401,
        0.011300414639893758, 0.020425503195196454, -0.0062345288494832785,
        -0.042858658584571385, -0.049782915110714976, -0.01260685572687556,
        0.041949139175065014, 0.06913306028845456, 0.0468385107667717,
        -0.004362815566844314, -0.04064458122216218, -0.035341310041315604,
        -0.0022031014527140735, 0.02008617175687305, 0.0067210317610227055,
        -0.028608616886656085, -0.04702635041956443, -0.0229469333877024,
        0.029342369592993717, 0.12567850096966615, 0.0020810111558239777,
        -0.04041123177770431, -0.04230705361049719,
      ],
    ];
    const result = wavedec(data, "bior2.6");

    const reconstruction = waverec(result, "bior2.6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5102425058019384, 0.939021601863089, 1.2221462741788571,
      1.325817352353957, 1.252482096859554, 1.0381298761950364,
      0.7418684536374494, 0.4305290680429483, 0.16224978164640969,
      -0.026821111307983425, -0.12942060334713087, -0.16607406995440227,
      -0.17649807775742077, -0.20593771332059585, -0.29017748588188474,
      -0.4432971404708702, -0.6515197242386277, -0.8749053540542711,
      -1.0565897446856982, -1.1372794862225573, -1.0713076289170436,
      -0.8400874375211203, -0.45940286875941455, 0.021507271795035032,
      0.5290618361988966, 0.9805704846306615, 1.301956719870199,
      1.4436930067047715, 1.3910967305218953, 1.1665292236619382,
      0.823048303735258, 0.431179628082021, 0.06215895341005806,
      -0.22816919922964612, -0.4108386960786782, -0.48790341338491616,
      -0.4884107570298588, -0.4574862423326138, -0.4415656240360737,
      -0.4737757552423317, -0.5633926487138958, -0.6922161617611092,
      -0.8188766291736358, -0.8899991837145297, -0.8553341698008528,
      -0.6828854000681505, -0.3700113151018518, 0.05254403607699093,
      0.5249600369454409, 0.9701438882416344, 1.310268259653442,
      1.4840492959069682, 1.460543417431554, 1.2460760804818087,
      0.8826046896939914, 0.4379349138843268, -0.009780339278239902,
      -0.38943485232096886, -0.6520024369307302, -0.7795988198710104,
      -0.7865087075075765, -0.7121705686981247, -0.6081511616449486,
      -0.522645566156068, -0.48662504249576843, -0.5052780283926692,
      -0.5569747529318886, -0.5999988098366753, -0.5852413248921626,
      -0.4714721460703772, -0.23909541882243635, 0.10135209441381537,
      0.5083794931226024, 0.9168592080984931, 1.251852227644595,
      1.445615539028537, 1.4536056707115628, 1.2654883962918508,
      0.9083718613538365, 0.4413955103627693, -0.0570533091787388,
      -0.5064002875384478, -0.8410823559064958, -1.0237381406936614,
      -1.0512807311356427, -0.9525527739356986, -0.7783875008896887,
      -0.5867965871974312, -0.4271956755846175, -0.3277613051172884,
      -0.28914670737800585, -0.2860942883304677, -0.27640542796403,
      -0.21479783343491413, -0.06789330377499353, 0.1737343111514984,
      0.48977831499026275, 0.8324030616915857, 1.1360846830362674,
      1.3327486895758291, 1.368456962005561, 1.217436755652491,
      0.889854034018575, 0.43126213884420894, -0.08628058698161303,
      -0.5793557854163209, -0.9709627863207826, -1.2066467190003927,
      -1.2651163701408799, -1.1608792288736354, -0.9384229285720274,
      -0.659579645544557, -0.38738897774950126, -0.17060148363427158,
      -0.0327333552670826, 0.031643354002073326, 0.05259352339594994,
      0.07380379104587287, 0.1379098417171346, 0.27216263798262075,
      0.4783385244425328, 0.7296926945217621, 0.9759197828003126,
      1.1549903651539264, 1.2089160374854837, 1.0994261940266108,
      0.819494291490565, 0.3976467143765129, -0.10622595374639379,
      -0.6127091964774565, -1.0395838411581984, -1.3194146704510246,
      -1.4137658805796378, -1.3206325973561057, -1.0733638094912403,
      -0.7314657996533512, -0.3656814042308941, -0.04113217299999283,
      0.19726232140848388, 0.33351529329977525, 0.3814231663992691,
      0.3775510729534632, 0.3683941881788256, 0.39524233422712746,
      0.48084407989914324, 0.6214736241473605, 0.7865772531887489,
      0.9261834242216038, 0.9842140892106392, 0.914261449490833,
      0.69370014572808, 0.3323716976017264, -0.12658358382664278,
      -0.6142000334244697, -1.0498134667625867, -1.3584877151477996,
      -1.487522823055442, -1.418022021819629, -1.1687022774502922,
      -0.7910491931364176, -0.35705714324324644, 0.057381243017474326,
      0.38932587170484434, 0.6017628805743989, 0.6896140245795763,
      0.677496111563235, 0.6100565398668669, 0.5375936636038667,
      0.500844970517486, 0.518994448376151, 0.5840732487450504,
      0.6632326260301831, 0.7082921232665023, 0.6700434884063851,
      0.5135169853999738, 0.23012088333860345, -0.15667394060079814,
      -0.5938056774136465, -1.0088722118182838, -1.3257826594869815,
      -1.4820205671187485, -1.4432701678685784, -1.2117702160066455,
      -0.8262934458238448, -0.35371725785559877, 0.12576957950074957,
      0.536214193867811, 0.8219345842880713, 0.9581928638094838,
      0.9540386325358166, 0.8468468545098186, 0.6901704593325333,
      0.5381941472218731, 0.43089036126579044, 0.38373714036253687,
      0.3846265876230659, 0.3986908008025186, 0.3796892802504676,
      0.2848738522944684, 0.0893186642710952, -0.20418637827916902,
      -0.5624566698444251, -0.9273758584853827, -1.2283234446489268,
      -1.39856982366433, -1.3915736359208393, -1.1930767827638,
      -0.8258961034164961, -0.34610641994962504, 0.16855572734220167,
      0.6353048521175628, 0.9839301430025913, 1.1711863954905146,
      1.1885350503469532, 1.061497792248602, 0.8409909295723604,
      0.5890059859720519, 0.36238466198016717, 0.19885617408770778,
      0.1088596326864475, 0.07513309409998703, 0.06001197394327577,
      0.01836685263536264, -0.08735899380405943, -0.2741016388085039,
      -0.5306957988977197, -0.8180969496630984, -1.0774386716853819,
      -1.2440070839415227, -1.2636430372797236, -1.107396117389941,
      -0.7806324231963282, -0.3241490487818835, 0.19316777780353678,
      0.6884889458626855, 1.0826315971309806, 1.3168596866498952,
      1.3648554551865741, 1.2370251710466729, 0.9762142533088877,
      0.646042056985185, 0.3148846323762851, 0.039575609325356476,
      -0.14709981141251, -0.24207135637320712, -0.26955951157639163,
      -0.27140991233436296, -0.29290267031843326, -0.36790927652671335,
      -0.5074200231561372, -0.6945720610679935, -0.8876023563863218,
      -1.0300694536090704, -1.0657679437940693, -0.9544943319860522,
    ]);
    const expected = [
      [
        2.7681475307249768, 2.087492289662075, 2.9372144504452122,
        1.885570586176662, 3.717032734953711, 1.4515135063736135,
        3.372179427091629, 1.805669249512664, 2.3527465334534026,
        -3.051768998677336, 0.5335101149884719, 2.584874287182917,
        -3.3681550672056035, 1.084116264834402, 2.196666366536528,
        -3.489402928515643, 1.6076281793839657, 1.7499978387892055,
        -3.5326485974560855, 2.106945599687639, 1.2490960210307323,
        -3.492050784486963, 2.571107620546803, 0.6996922622710879,
        -3.361871968824734, 2.987300743131334, 0.10996883773445526,
        -3.137322492476771, 3.341101390745075, -0.5088316703962092,
        -2.8155682782872264, 3.6170696640645312, -1.1420678941162097,
        -2.396773052259288, 3.7995936794189475, -1.772174796153424,
        -1.870383223344302, 3.7645741864249893, -1.9025469645618354,
        -2.9556965710819068, -1.2167762149581973, -2.992163308520467,
        -1.4982497430339696, -2.670799504886903, -1.6732617585529705,
        -2.8749976169802345,
      ],
      [
        2.1599374150043125, 0.9258631367014406, 1.1066842993376675,
        -0.30240812929461447, -0.04445287102543316, -1.2434767688541493,
        -1.435007128051374, -2.025060184153685, 0.2836201613471206,
        1.6174506180861365, -2.1403388439164392, 0.8394580940748357,
        1.169924769605498, -2.1737266286254404, 1.3238201004734726,
        0.6442701009515327, -2.049089466998396, 1.7024528433540058,
        0.08401537780430263, -1.779053518873006, 1.946733202436493,
        -0.4648687562397732, -1.388712720568432, 2.040135338899603,
        -0.9581243618900004, -0.9132244978233588, 1.9796133875084547,
        -1.357227289958282, -0.3944775572159937, 1.7757101900983019,
        -1.6328405637666386, 0.12284686458103283, 1.4513873175558563,
        -1.7673732987476258, 0.5954414175991177, 1.039694442883592,
        -1.7565052164079935, 0.9684463549250458, 0.31406655964130736,
        0.013604825939818266, 0.4982902120700862, -0.41444498601334545,
        0.44761679943644184, -0.8285792909277576, 0.43240680387813946,
        -0.4859362532953343,
      ],
      [
        -0.33731037753841653, 0.803332981230601, -0.4333257206825787,
        0.2690810371745226, -0.2631476666776257, 0.16572293964494522,
        -0.3583292398927516, -0.1666396408014189, 0.1729176539540212,
        -0.10957956906931575, 0.08340878514430933, 0.29890226202713643,
        -0.2602270915014095, -0.23781640243010904, 0.21529016752955835,
        -0.02999354580723776, 0.004340251874022455, 0.28082346450411755,
        -0.21010845703169975, -0.29799043453639873, 0.23414735720572183,
        0.0593689383698911, -0.06606684212681346, 0.23718989935671048,
        -0.1469711400858547, -0.3379753153515731, 0.22930654223876792,
        0.15087256405073457, -0.12161444458022361, 0.17057309188439387,
        -0.07789246893683183, -0.3530985474851166, 0.20291860302034745,
        0.23642798004270282, -0.15781160786185286, 0.0857772280135737,
        -0.010268244022464124, -0.34085693182555876, 0.15920661965094698,
        0.3082534042553604, -0.1722829666855596, -0.010576085122902174,
        0.04892759852177461, -0.3011920813215227, 0.10400369941419527,
        0.3596147243428933, -0.164964204017662, -0.11064135077862375,
        0.09383358615997739, -0.23653488359014208, 0.04413654074770518,
        0.3854726369721533, -0.138066598677284, -0.20606484777125772,
        0.1202740227299944, -0.15161338365493518, -0.013283787466104036,
        0.38297412846230283, -0.09581539779249454, -0.28875429587014556,
        0.1261591547162006, -0.053041396005335154, -0.0615934679350323,
        0.3517404537297112, -0.043988905464839634, -0.35162899409854653,
        0.1116734563927056, 0.051129476626084455, -0.10493700963613098,
        0.12519581729178308, 0.2495227680057674, -0.16963700819748254,
        -0.02084996519792448, -0.1119475720429377, 0.13902003823632028,
        -0.10530225484829456,
      ],
      [
        -0.028959276050083638, -0.06258118942533697, -0.05149661537008943,
        0.1803979679510835, -0.02880166472314466, -0.06344642666258254,
        -0.04985702616706772, -0.005330864954941061, 0.028004396064916587,
        0.023315440887590036, -0.006723039668862951, -0.024352715834556823,
        -0.005360946341952028, 0.03570700061916249, 0.05842410880755433,
        0.03543509073147416, -0.01981522362084047, -0.06351584837848195,
        -0.06080101169037988, -0.01710765510032325, 0.027822007978840976,
        0.037336927870210035, 0.011112840089527898, -0.01701678967850978,
        -0.013861633284671437, 0.019635617402239514, 0.04871391403849212,
        0.038778183554008444, -0.009628018814414462, -0.05881125014780375,
        -0.06751507111623622, -0.028707964335172198, 0.02406310543565629,
        0.04771952598269358, 0.028725515229001575, -0.006545620851361622,
        -0.019330004679581958, 0.003066251047642188, 0.03500592007869305,
        0.03820879281024739, 0.0005134713404482058, -0.04993224217323017,
        -0.06933443834807484, -0.0388413104555102, 0.01736012243419749,
        0.053749408019315575, 0.04464338025087228, 0.00616089433374073,
        -0.021272084622255827, -0.012573128853350102, 0.018356044498525695,
        0.03348966796345207, 0.009397711763545528, -0.03783644056755514,
        -0.06601848679398375, -0.04631873750404869, 0.008650577268562193,
        0.055127129442602646, 0.05752553812830952, 0.019935808928053023,
        -0.019587979904130498, -0.025983140401620856, 9.195862031256656e-5,
        0.024800619743921837, 0.01597293535479423, -0.023743410370158646,
        -0.057776109683255306, -0.05017476792538578, -0.000922977504110245,
        0.051987839496169, 0.06628577830831306, 0.03345648227776604,
        -0.014578832111594942, -0.03611248160631009, -0.018306982736897,
        0.012729700725865573, 0.019455264763499763, -0.0090147127304267,
        -0.04524893131914309, -0.04976870117388388, -0.010133253184675783,
        0.04487977923924594, 0.07019304383218677, 0.04537268746355061,
        -0.006913264075773196, -0.0422523241883206, -0.035344399064370285,
        -0.001776006361515453, 0.019409434474990106, 0.004978235710243695,
        -0.02945387256668741, -0.04485517690909002, -0.01779678621840533,
        0.03470341727285886, 0.06893877702415069, 0.05443902619010743,
        0.002443283522364892, -0.04409667226550627, -0.049643319273315056,
        -0.017495454176047698, 0.01579412308831757, 0.01698564822245288,
        -0.011690502273227543, -0.03561688373937294, -0.022897973381868032,
        0.022617376957574598, 0.06266471043506172, 0.05963873868781455,
        0.012329277823654394, -0.0417630819818038, -0.06007140723016918,
        -0.03304649561592571, 0.008967393710276272, 0.025997468998886622,
        0.0065780087692444145, -0.022655957641920594, -0.024696239996298098,
        0.009920506170231658, 0.051948469038644585, 0.06028678370814716,
        0.02150787327654219, -0.03577200766660478, -0.06584306852132427,
        -0.04701575389177365, -0.0003483308007398711, 0.03133671061827896,
        0.02385898125749599, -0.006944621996531591, -0.022805657553199993,
        -0.0020782778368381716, 0.037748403027117294, -0.0393411627382842,
        0.051962484982251256, 0.017876790125931546, -0.0168437400651458,
        -0.018920002483363216,
      ],
    ];
    const result = wavedec(data, "bior2.8");

    const reconstruction = waverec(result, "bior2.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior2.8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4904135421844118, 0.9064581777256162, 1.1889857587298294,
      1.305768074396989, 1.2569986834480362, 1.0734080199066307,
      0.8075687972711777, 0.5205870315661154, 0.26745261752377963,
      0.08460251922846734, -0.017335669153367927, -0.053956239181730314,
      -0.06068312565755592, -0.08129628930982735, -0.15435389068147853,
      -0.3010043564663276, -0.5173363368746486, -0.773290196114314,
      -1.0185271450118525, -1.1939197082099613, -1.2459142965235879,
      -1.1402701727776676, -0.8717838849486974, -0.4675417944716243,
      0.01721889043585148, 0.509790230926946, 0.9347915313755981,
      1.2296677355493473, 1.357297040032248, 1.312805651532334,
      1.123072760441881, 0.8391542465508114, 0.523536491060172,
      0.23534474693871238, 0.017081315487582238, -0.11394946488644925,
      -0.1675548941850012, -0.17558781318163652, -0.18130646492460462,
      -0.22593680656788323, -0.3358964017921689, -0.5139671967109027,
      -0.7367207252440418, -0.9589446194291147, -1.1240744179669715,
      -1.1781271043823118, -1.0837326321396694, -0.830789191451737,
      -0.44104730600568576, 0.034630040257495595, 0.5258280525355619,
      0.9568143895859509, 1.2621672393973953, 1.4001715902344471,
      1.3608837330244286, 1.1670342682085515, 0.8676471510695873,
      0.5259831435065121, 0.2047516564581991, -0.047846941353304195,
      -0.2079334196141727, -0.2793500299230381, -0.2899759242219316,
      -0.2820314725932688, -0.29891943760620826, -0.37199254149834515,
      -0.5106411330630369, -0.6982612902319896, -0.8951973467063356,
      -1.0480128427138116, -1.1028567170926076, -1.0196466997897107,
      -0.7835468619166235, -0.41083375772920827, 0.05242217805466046,
      0.5387086012241387, 0.9726064819976785, 1.2863985324265417,
      1.4341263707712628, 1.400828956657344, 1.2048376330488115,
      0.8926553511131442, 0.5277094041524983, 0.17571201305752981,
      -0.10985753759374306, -0.298708633057145, -0.3885973456384485,
      -0.40306519520982265, -0.38278959152940845, -0.37283978303598536,
      -0.409124324000844, -0.5074962258275413, -0.6583072757157585,
      -0.8278395710802969, -0.9663245379519388, -1.0206087072624421,
      -0.9483464217432465, -0.730182660708193, -0.37683875560428404,
      0.07077701308847675, 0.5486355486816595, 0.9822946991572541,
      1.3023387932513888, 1.458962190446497, 1.432293936755395,
      1.236064726171705, 0.9137982972775288, 0.528484697284452,
      0.14823304106673518, -0.16866561387342677, -0.38573313879458704,
      -0.4945767939788318, -0.5140791739750904, -0.4828861011584157,
      -0.4472090770918335, -0.4470918789746329, -0.5046452738237106,
      -0.6172445644139408, -0.7574377337257651, -0.8796334796914542,
      -0.931940069193813, -0.8702243665296049, -0.6708756401505716,
      -0.339036069939324, 0.08986583083473706, 0.5558311417180137,
      0.9860505655953473, 1.3100273693282587, 1.4745473793032962,
      1.4549910976406188, 1.2603385375105023, 0.9307114152982012,
      0.5280686970697779, 0.1222917077105457, -0.22402751016194683,
      -0.46850567120886594, -0.5965980899088532, -0.6222533696046313,
      -0.5816188025871424, -0.5215155389306851, -0.4856651442558026,
      -0.5021743115051034, -0.5754457592192959, -0.6845653138381198,
      -0.7885927140654672, -0.8374548570750542, -0.7857291429968545,
      -0.6058579339397732, -0.2974375223002233, 0.10984621351713103,
      0.5605325638055331, 0.9840873417549936, 1.3095645030139345,
      1.4808185802603107, 1.4686954140588138, 1.2773272134830365,
      0.943050412664211, 0.5262147509094844, 0.0978362746833692,
      -0.27574166018303486, -0.546569013379106, -0.6940059365128024,
      -0.7268413223557724, -0.6782836770488777, -0.5952284337619433,
      -0.5245854900284002, -0.500141497700563, -0.5332666455912094,
      -0.6097977036229888, -0.69387881083042, -0.737799431184214,
      -0.6953624147310667, -0.5354140507142339, -0.2520944940218065,
      0.13085892520936898, 0.5629882029973297, 0.9766567888499011,
      1.3011095478855792, 1.4777809686375387, 1.4732466409658684,
      1.2867477538011147, 0.950495481243278, 0.5226734467180808,
      0.07478819445847157, -0.3236490332238525, -0.6195129000130172,
      -0.7861849231510685, -0.8271205402377206, -0.772180631091352,
      -0.6678024094747639, -0.5635677271430762, -0.4985763885532126,
      -0.49104292860104976, -0.5337071654659788, -0.5961861715567301,
      -0.6336573536779337, -0.5996754341259904, -0.45987966763953714,
      -0.20309903409047664, 0.1530249993254446, 0.563453869387186,
      0.9640456337302037, 1.2848786965340944, 1.465507899226685,
      1.4685510105844897, 1.2883693288753322, 0.9527553507387011,
      0.5171962837572619, 0.05304432634464179, -0.3676331259231072,
      -0.6869764539523012, -0.872564054594227, -0.9223982499921242,
      -0.8626192771079806, -0.7386820699344252, -0.6023024821563494,
      -0.497479602535765, -0.4490872757789829, -0.4568579182883818,
      -0.4962212443603036, -0.5257439787035979, -0.4992651236946108,
      -0.3796399287317841, -0.15058454817632483, 0.17644306415257616,
      0.5621890055042468, 0.9465717734391665, 1.2611422454469852,
      1.4441399857540815, 1.4545823794299437, 1.2820161826514993,
      0.9495711488586589, 0.5095394052833117, 0.03247944389387522,
      -0.40761951121782264, -0.748650139413078, -0.9526208732971476,
      -1.0120169118101987, -0.9489246971299419, -0.8073067433637051,
      -0.6404589175823336, -0.4968228810494701, -0.40768669340272845,
      -0.37980139837479193, -0.3946966975782128, -0.4148007843183832,
      -0.39476973652621056, -0.29512725749756236, -0.09472605481370355,
      0.2011869395321504, 0.5594529328079572, 0.9245802613377633,
      1.2302214267337244, 1.4138836227235625,
    ]);
    const expected = [
      [
        2.6785664514902163, 2.083366883929305, 3.011820185847417,
        1.80518486048005, 3.810153232930792, 1.344427725496369,
        3.522651538510522, 1.6691409062493114, 2.499502758326671,
        -2.3804859798608136, -1.060977317816407, 3.5712064357694575,
        -2.0659725982785013, -1.9596632944917904, 4.048009895625559,
        -1.730882999895509, -2.629503844420801, 4.320496276618934,
        -1.4236015189434168, -3.0280162416513154, 4.292772567110263,
        -1.0484313328377621, -3.1955277514129654, 3.931165780603163,
        -0.5183919505482689, -3.2239728814368505, 3.2776103560142933,
        0.2070053151599349, -3.219724411687342, 2.4380010398472085,
        1.0998599935230502, -3.262590906205133, 1.5496359611991808,
        2.0657578298697383, -3.3753813177810836, 0.7386653654581261,
        2.971484733674532, -3.5205913174912484, 0.08133508689592539,
        3.670885590320517, -1.9039457714568577, 3.7231851820845527,
        1.0318911081241968, 2.0255025504822766, -0.4935974853144955,
        3.457618523375987,
      ],
      [
        2.1113899997545613, 0.7872459458205959, 1.1111517302632392,
        -0.3477634598700471, 0.010611633074346871, -1.2040658943309501,
        -1.322158907037943, -1.9097055341386118, 0.3201570636053618,
        1.3713425069900453, -1.8456244953615484, 0.8390779711531793,
        0.6482126942361777, -1.3875219003398767, 0.999602670842414,
        -0.07697755418701105, -0.5832959810633812, 0.7106837539995738,
        -0.5486028175960378, 0.32386529646933815, 0.036805793949775456,
        -0.6070725521357128, 1.0584969445307453, -0.8190177574217732,
        -0.24406607616222176, 1.407154514527735, -1.584676035958048,
        0.3949954907531405, 1.2910964365168396, -2.012598298857203,
        1.0621341194280993, 0.7921564650102029, -1.9651041273824499,
        1.4938545426746679, 0.12287125335817434, -1.4618431717420095,
        1.5037439175696306, -0.4531255662400968, -0.7711971547196455,
        0.8718254916114883, -0.05049167096005802, 1.0600826798703311,
        -1.7977977361187762, 1.0368244407917573, -1.3837579590309117,
        1.119449117754525,
      ],
      [
        -0.3149973810537492, 0.7729540898804885, -0.4027336705553959,
        0.2369539323885545, -0.25155045679018334, 0.16613795638901413,
        -0.33156442637374295, -0.16722489240056293, 0.16180374083762955,
        -0.10487546642553448, 0.021442856796903387, 0.3256634555768142,
        -0.13513196548235099, -0.29046879821490723, 0.1398368534779405,
        0.004630614017236925, -0.08934741291053719, 0.29687735696340983,
        0.03103720610583688, -0.3545640575787509, 0.040852447448943896,
        0.12157145858335555, -0.13113017861497803, 0.19593608221000014,
        0.18107073051777067, -0.33210898077181916, -0.10552836688856315,
        0.19790620334230846, -0.09245238772755474, 0.06209977809505543,
        0.2703397351466913, -0.2272183337643235, -0.25206355191174423,
        0.19964155683355014, 0.008974058742411584, -0.05517213777922103,
        0.27524701177459837, -0.07149174715655832, -0.35017352640029653,
        0.11889989169037946, 0.13257355320817238, -0.11350387308247833,
        0.20116480557983557, 0.08679349715272244, -0.36673391550291945,
        -0.023090789466591155, 0.2291867682225718, -0.09237933756394301,
        0.08032197822229498, 0.19924831154560496, -0.29554770454060797,
        -0.18313239793783376, 0.2583628770984487, -0.00027708929813613503,
        -0.03961697338850212, 0.23394938301864632, -0.1595132259935137,
        -0.3108476515066122, 0.20265016201518876, 0.12831440758946477,
        -0.11230618151159624, 0.18627846010736857, -0.0027344111581564384,
        -0.36599630411279305, 0.07391293230960827, 0.24496310685861666,
        -0.10897961588053623, 0.08026586367326793, 0.12428506913918877,
        -0.35731540976836, 0.017166423131321218, 0.14784194784846322,
        0.1901712949443361, -0.25830439277994155, -0.11697592230128619,
        0.20154226656416868,
      ],
      [
        -0.029079256939111786, -0.05853136719262941, -0.04720540733358031,
        0.17338737063215628, -0.02629337909842061, -0.0585998005346971,
        -0.04766651804916172, -0.007475017788024674, 0.02484925813788838,
        0.02309326543434779, -0.004909540378450414, -0.026019006736757208,
        -0.014008449602497697, 0.02469371937793774, 0.05573370113740955,
        0.047996924318948087, 0.00276148376434468, -0.046006168989268154,
        -0.060853854595337986, -0.033299646286297224, 0.009696559310023223,
        0.03084139955874822, 0.016112315535089523, -0.013757359897968821,
        -0.024080945589347716, 0.000187254019533456, 0.03927168960822497,
        0.056055525368898296, 0.0303827735440918, -0.021288041930046346,
        -0.05916662922309146, -0.05464578042459839, -0.014947137953184808,
        0.02426539069588668, 0.03134953245788856, 0.00656560876717753,
        -0.019864446351694195, -0.017314063062047386, 0.015598973747937478,
        0.04880942148865913, 0.04830008350545256, 0.008142506902197866,
        -0.04246382354838091, -0.06400209178975552, -0.04107970727284038,
        0.004578005829596665, 0.034195137764615385, 0.026665301838631375,
        -0.0036507198989323975, -0.021951196945691198, -0.006618959814282344,
        0.02976947746839842, 0.05158396136119303, 0.03333013700938514,
        -0.015626842470461234, -0.057777941481766515, -0.05994885122161431,
        -0.022290541109330486, 0.022398668405939542, 0.03826291608861124,
        0.017923549229673902, -0.012572297033310531, -0.019461663077528335,
        0.006363050045968599, 0.040312967998706595, 0.046842587059443275,
        0.013103894311062209, -0.03756243857757366, -0.06508079703635034,
        -0.047720714067998604, -0.0011081321853360637, 0.03600625094228375,
        0.036216997817612645, 0.006883223707139119, -0.018511900648273488,
        -0.012674219742482618, 0.01950386373228921, 0.04530627423903688,
        0.03495346346838474, -0.009592459392559448, -0.054526094260393565,
        -0.06337268965003473, -0.02918896520740638, 0.019374917204072833,
        0.04362510491531485, 0.028776782133698636, -0.00438841059216083,
        -0.02035376471778444, -0.0026693454851976495, 0.030532035296716553,
        0.043618303471992526, 0.01738629152808667, -0.031542558065695,
        -0.06406590675016594, -0.05294581715854563, -0.007093418656212491,
        0.03626515952832404, 0.04445453268048477, 0.017479082999055873,
        -0.013874617238139236, -0.017747565909656066, 0.008841600955793338,
        0.0374108443554137, 0.03512319585599202, -0.003477942080479232,
        -0.04956955011661518, -0.06477974682957544, -0.035335925034227944,
        0.015370558698333897, 0.04728979092903829, 0.03875410729978651,
        0.004399045849780181, -0.019951213298050247, -0.01116970039147036,
        0.019799551794111248, 0.038689413149526425, 0.020760064315971646,
        -0.02468237393012762, -0.061007527866470346, -0.05652570491054909,
        -0.013091451955797528, 0.035025942881711125, 0.0511148737424133,
        0.02776304130269097, -0.008206606790546467, -0.02165546076224309,
        -0.0018415844944977833, 0.028146891443639188, 0.03376851778373674,
        0.0024258483430485978, -0.04312607821460801, -0.06493439211601365,
        -0.02103153466935545, 0.0220451141853436, 0.03562358838015042,
        0.014189912895827078,
      ],
    ];
    const result = wavedec(data, "bior2.8");

    const reconstruction = waverec(result, "bior2.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49718237565850243, 0.9157098825497738, 1.1938390602633768,
      1.2995450802179214, 1.2361527167473922, 1.0395212126796631,
      0.7676281375867037, 0.48528870679239133, 0.2479359880238705,
      0.08857439836974429, 0.011159662012392324, -0.008024875948142982,
      -0.011501248807103875, -0.04668152625173971, -0.15064911877932174,
      -0.3377174459128804, -0.5931297472299211, -0.8746774342683102,
      -1.1219640561217028, -1.2710520784770982, -1.2708098439932238,
      -1.0967911002183417, -0.7590562548698706, -0.3018395058949965,
      0.20499845138543926, 0.6807320843567579, 1.051184542114695,
      1.2645626063186945, 1.3018788922729898, 1.1794869829369627,
      0.943233524942639, 0.6558262428584849, 0.38069737546276783,
      0.16648325151909632, 0.03603169000772005, -0.017353738018261178,
      -0.025610281851512255, -0.034818549778289465, -0.09033035214574275,
      -0.22211382020869563, -0.43425037232247965, -0.7014454200596656,
      -0.9736009495653727, -1.1874070225684692, -1.2820758735495283,
      -1.2152365643712766, -0.9749150135248275, -0.5844707679125354,
      -0.09911033050027471, 0.4052951732529102, 0.8484271748819462,
      1.162843361239783, 1.3081994417807898, 1.2789390373342937,
      1.1036613379616174, 0.8364608265265449, 0.5425343860481047,
      0.2817616853366566, 0.09442881712341161, -0.007332063353915064,
      -0.0403174290800406, -0.043194753814898706, -0.06359101864486827,
      -0.1428152222086445, -0.3023108508192279, -0.5354857847342775,
      -0.8071768097148855, -1.061029225626185, -1.2330145480243744,
      -1.2676977309615185, -1.1331133024940223, -0.8304122089733789,
      -0.3957243652067304, 0.10637775761845916, 0.5963231553094035,
      0.9966651145032053, 1.2487262311638074, 1.3247265991531885,
      1.2324894215325077, 1.01167974113603, 0.7226493800146482,
      0.43079776477139187, 0.1904493504462611, 0.03231927554139091,
      -0.042324981382486, -0.05944807174622513, -0.06270684638092905,
      -0.09920629628881655, -0.2043826588507041, -0.39006694293531474,
      -0.6389585126603987, -0.9070798398587149, -1.1337142021025646,
      -1.2563774031627344, -1.2270422846070679, -1.0254634829905336,
      -0.6661375392011173, -0.19700825302494968, 0.30990898946869094,
      0.7737804495555607, 1.1224008421378167, 1.307594436644715,
      1.314842327668456, 1.1648557990291417, 0.9068332977684671,
      0.6052139855897459, 0.3233483073887127, 0.10823927148150142,
      -0.019816203771850505, -0.07015248791585268, -0.07662798236021359,
      -0.0859638635736697, -0.14269660899521697, -0.27478172191260697,
      -0.4837140450247384, -0.7418605830170591, -0.9978339488791882,
      -1.1886461403128514, -1.2556078924574312, -1.159933388307431,
      -0.8940330797989643, -0.4855263182905408, 0.0071835461030579015,
      0.5068143954006783, 0.9337519111236805, 1.2232272075343396,
      1.338952116290007, 1.2799254069251114, 1.078834937783168,
      0.7925832799824318, 0.4874246939405766, 0.22252314687052377,
      0.03609097328910138, -0.06243992428438799, -0.09234422739592495,
      -0.09380664460647964, -0.11457631327813239, -0.19467369813670193,
      -0.3532489104053797, -0.5811305004429375, -0.8411300231082086,
      -1.076156991057052, -1.2231656348766757, -1.2294198920192898,
      -1.0669204429136194, -0.7412544672646103, -0.2925022698068418,
      0.2121817399734258, 0.6926056027718079, 1.0728184057196073,
      1.29743479407479, 1.3430440717674106, 1.2219735259142253,
      0.9775905743675818, 0.6724416691208723, 0.37230204067992945,
      0.13020009759542278, -0.02556511357325625, -0.09646058893696505,
      -0.11066862243239789, -0.11289986604283755, -0.14986060778845067,
      -0.25528040241779437, -0.4385137013630653, -0.6798013369670717,
      -0.9335520683516292, -1.1389223274486924, -1.2350666782823945,
      -1.177190727511975, -0.949281653317538, -0.5701878975117874,
      -0.09136929741026642, 0.4132752889881765, 0.8631029093635738,
      1.1881499819156227, 1.3440493225230907, 1.3208302490273716,
      1.1435230688938938, 0.8645399049533435, 0.5498534117603218,
      0.2625243754969472, 0.04775219348637927, -0.07681648465006657,
      -0.12317105473500069, -0.1270384873577486, -0.13569054653543783,
      -0.1927634786408119, -0.3241609400751248, -0.528824796917355,
      -0.7768957164245721, -1.0158692801558207, -1.1832739488392652,
      -1.2226870177160811, -1.0990024976028807, -0.8090038176520057,
      -0.3844423334461488, 0.11330947077898491, 0.6058465709671035,
      1.014553480455617, 1.277580055428597, 1.3628455985847066,
      1.2739380047981592, 1.0475532667465768, 0.743234650848986,
      0.4280844770438165, 0.16035039040101196, -0.02397736394914074,
      -0.11823723064898611, -0.1441714936732608, -0.14341143546895757,
      -0.16373496323669023, -0.2438011428127903, -0.4004512501011002,
      -0.6219963830644826, -0.8693589457947442, -1.0848967202858844,
      -1.206735498820776, -1.1849824519169128, -0.9956611398182202,
      -0.6487390530004689, -0.18807807811992205, 0.31684147132964763,
      0.7855037951136772, 1.1437358541359732, 1.3396583016753238,
      1.3543377658387865, 1.2045940197104188, 0.9373781833797947,
      0.617240884996755, 0.3101195549691398, 0.06755937480968877,
      -0.08467925346068139, -0.15083800436856037, -0.16128106744286105,
      -0.161689003196511, -0.1982782713012901, -0.3030157142936471,
      -0.48279001128397214, -0.7154729577284051, -0.9540158934785653,
      -1.1376381048983677, -1.2073092377739336, -1.1215822448789958,
      -0.8686922903848546, -0.47173965352958197, 0.014505729362385422,
      0.5145391268827602, 0.9482063622528979, 1.2480474066268554,
      1.373680679623973, 1.31974642956853, 1.1155383994558241,
      0.8165303938402728, 0.49002180588698835, 0.19857285275907188,
    ]);
    const expected = [
      [
        -94.16301158901653, 37.55314019182167, -1.772210653644605,
        -6.992015682990776, 5.724602399751522, -11.752912223404119,
      ],
      [
        8.881784197001252e-16, -15.000013787974474, 13.576550515784584,
        0.5417934201253942, 6.005574472979338, -2.220446049250313e-16,
      ],
      [
        6.661338147750939e-16, -5.86803779563086, 10.156015404741684,
        -4.313904402718357, -4.34519111500461, 5.099580445461532,
        1.3495071929673876, -4.460708763228996, -2.8152422302062914,
        6.938893903907228e-18,
      ],
      [
        -1.1102230246251565e-16, -2.8078164940378993, 6.139252966319188,
        -2.745842200540732, -3.2891333567226075, 5.362054108408285,
        -1.867191189427048, -2.6409246326065903, 3.526545017104239,
        -1.1508184912320285, -0.9666675138907577, 1.2246839383677135,
        -1.0407063726957404, 1.3891209554970858, -0.8430842331411024,
        -1.6502392822238305, 3.3995270378353943, 0.0,
      ],
      [
        5.551115123125783e-17, -0.6063932091009777, 0.8553178305941019,
        -0.44144456386855724, -0.28495393172837813, 0.8299386757232556,
        -0.7916261260012962, 0.14086286593229896, 0.6891615016996213,
        -1.0491193729982495, 0.5719708016440896, 0.44813127641323336,
        -1.191661776093883, 0.9672417813244866, 0.13289362642404928,
        -1.2089377625771043, 1.2887503538255554, -0.22230503507909405,
        -1.103547683068562, 1.5056106189022784, -0.5785710570744829,
        -0.8906501570320311, 1.5971017853377332, -0.8964053190544685,
        -0.5963163826990897, 1.554762566345365, -1.1398174285171705,
        -0.25476715352148194, 1.3832401621751023, -1.2800889111372087,
        0.09522207997062405, 1.0998071136371768, -1.5016225936722207,
        -1.3877787807814457e-17,
      ],
      [
        2.7755575615628914e-17, 0.0685089375976426, -0.12815366764735625,
        0.04655705735280989, 0.02798931129078625, -0.1263785731582183,
        0.08774949380852015, 0.10269722282252236, -0.12393582046897572,
        0.012939260274578646, 0.058909370185107876, -0.12518989772208247,
        0.04645710878780712, 0.13365221428403662, -0.10685841133488266,
        -0.024246947474327374, 0.08130905787923302, -0.11149240654197862,
        0.002522037977926772, 0.15344227350749778, -0.07828555377204766,
        -0.06094216545131015, 0.09275536027410966, -0.08707535965087829,
        -0.039812502291226265, 0.16014440086226278, -0.04077195350179977,
        -0.09309589729550649, 0.09199342554995388, -0.05481300227590951,
        -0.07650614696955516, 0.1531233927975305, 0.002191401211273439,
        -0.11708810331373287, 0.07907699565260673, -0.018361972966919833,
        -0.10412966632591583, 0.13309593081000498, 0.04652801490222701,
        -0.13010732137399855, 0.055363399352280185, 0.018221101426387384,
        -0.12020986890303952, 0.10205711918081994, 0.08798728665010855,
        -0.13044641790788442, 0.023373610105202003, 0.05090243514607444,
        -0.1234758770236691, 0.06307700799448357, 0.12257446657325699,
        -0.11768547052624612, -0.013468257711538978, 0.07609081332842915,
        -0.11398165980447877, 0.019987954824787102, 0.14695517716055392,
        -0.09274285610917116, -0.05118924547331899, 0.09101103201313344,
        -0.09309241383148614, -0.023005143932822214, 0.15879310248953687,
        -0.05778913596974258, -0.14238785110818353, 0.14238785110818356,
      ],
      [
        0.0, 0.010914804887535823, -0.0005877426193688917,
        -0.010249083150263738, -0.009799274522959256, -0.0006992798484660584,
        0.0075169045232264895, 0.00655548275803623, -0.002608651340772778,
        -0.010676684998869174, -0.009038885409830139, 0.0017784456296220663,
        0.012349742849943529, 0.01311273857036719, 0.003356527118843558,
        -0.008104618682042264, -0.011213341546489286, -0.004038961934064306,
        0.005645761386822157, 0.00801714315888899, 0.0007214996489785545,
        -0.008856161330190924, -0.010745860302991087, -0.002116738558353509,
        0.009759223153191193, 0.014198451104212265, 0.007131930356743935,
        -0.00505567030720111, -0.011525289523745291, -0.007121642339437323,
        0.0029692249868775444, 0.008419340323405489, 0.0037907086460508936,
        -0.00621603680916178, -0.011318743884827412, -0.00565075049378605,
        0.0063869269409555784, 0.014066299162635576, 0.01037279757407968,
        -0.0013829599837862638, -0.010668795657287566, -0.009603297635761898,
        -0.000224060671325646, 0.0077175138169805505, 0.006264300937927894,
        -0.003058349237794522, -0.010733301540011772, -0.008490082352124617,
        0.002562650591410781, 0.012730641959838446, 0.012764211682548113,
        0.002566604117315241, -0.008697138881757382, -0.01119888229423957,
        -0.003588022152393025, 0.005985376309235256, 0.007873011301818937,
        0.00026425335229962946, -0.00908409245562445, -0.010374894291448944,
        -0.0013416552255289538, 0.010324351227543549, 0.014073956118947878,
        0.006414902477981391, -0.0057784515742913545, -0.01171220920595914,
        -0.006755050215454472, 0.0034073145065935326, 0.008440934706133732,
        0.0033852933765988295, -0.006574050435275702, -0.0111450227692272,
        -0.004949627184364397, 0.007085263817461024, 0.014176069555191434,
        0.00979083997912867, -0.0021791770784728715, -0.011056755085921494,
        -0.009374186820427288, 0.0002593307244904003, 0.00790380130216276,
        0.005962599222276925, -0.0034929603602505167, -0.010755724893125054,
        -0.007918604822597403, 0.0033319652551407064, 0.013063595903231862,
        0.012367930781773392, 0.0017625842418514948, -0.009265241867490198,
        -0.01114767738408276, -0.0031195164031137673, 0.006315695793741116,
        0.00771387142892346, -0.00018705341773947448, -0.009281557580463881,
        -0.009974219286962793, -0.0005686147646365436, 0.01084922494533283,
        0.013897385931349399, 0.005671119651742079, -0.006486996316179522,
        -0.011862126365453196, -0.006362236597047988, 0.003843529109254975,
        0.008446020543113896, 0.002977145098860153, -0.0069080082647877405,
        -0.010937917964331356, -0.004238475785057899, 0.007753759372569863,
        0.014233317084630173, 0.009171059467524306, -0.0029733439014390517,
        -0.011411046723650842, -0.00911198684628739, 0.0007498292053344652,
        0.008075258526773385, 0.005650992782661374, -0.003911750872111618,
        -0.010744613694358293, -0.007326872038463106, 0.0040835910241358575,
        0.013347476897617144, 0.011925360964001572, 0.0009474791888445799,
        -0.009806475844661433, -0.011059188447132967, 0.0,
      ],
    ];
    const result = wavedec(data, "bior3.1");

    const reconstruction = waverec(result, "bior3.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5094014632107859, 0.9368873796919595, 1.2181392787575107,
      1.3197500184195248, 1.245057498750941, 1.0311922011232535,
      0.7382472277132033, 0.43344933234653277, 0.17443173407825258,
      -0.004125818802972969, -0.09715488900256927, -0.1276010469539553,
      -0.13718860264510804, -0.17216126233154577, -0.2679195636859221,
      -0.4367557041782417, -0.6620672102836456, -0.9007252483336735,
      -1.0931230668991545, -1.1783923246472836, -1.1108788320974843,
      -0.8735786640137134, -0.48495594643749823, 0.0027861609268744203,
      0.513750743033675, 0.9643632312373887, 1.281484782493848,
      1.4182008546443232, 1.363435771953601, 1.1430926865105258,
      0.8125468780972471, 0.4424845546549139, 0.10172639872165573,
      -0.1586143208027354, -0.3156934725470611, -0.3776826630809095,
      -0.37821598786999266, -0.3642114594537681, -0.38045238855629,
      -0.45513542405113594, -0.5903134830085369, -0.7598572205799552,
      -0.9155670338413171, -0.9999056175633928, -0.9620499384831,
      -0.773041907786564, -0.4359903820472603, 0.011497056257319338,
      0.5035079797805866, 0.9592974708856554, 1.300818428192838,
      1.4700275452021085, 1.4417090715133516, 1.2286650940040453,
      0.8780283797903949, 0.45967485369932065, 0.04968027927367713,
      -0.2870221699946648, -0.5104775763572919, -0.6126804507406451,
      -0.6161218267483435, -0.5645356851872898, -0.5084729148900277,
      -0.4896416972391273, -0.5282338034148837, -0.6166371943788704,
      -0.7212309769592332, -0.7918122707645293, -0.7761731876242438,
      -0.6359576378902131, -0.3595439829386223, 0.031576715646884634,
      0.48480929940953676, 0.9265828990202944, 1.2782335323504852,
      1.473768721946454, 1.4751168848132004, 1.2810588190187693,
      0.9276034874001898, 0.4797069553452922, 0.016396349035194546,
      -0.3870021726627927, -0.675138385658119, -0.8234469179066138,
      -0.8409513743968264, -0.7645914951710449, -0.6467715856388558,
      -0.5395447657599103, -0.47966994711296296, -0.47849823986377227,
      -0.5193387981752633, -0.5629618547383155, -0.5597365385722889,
      -0.46513380650784864, -0.2544096508264825, 0.06754023977247642,
      0.4639388236565902, 0.8723246963666144, 1.2178243459460796,
      1.4302818255561134, 1.4609878814770985, 1.2947959415982648,
      0.9545356351075712, 0.4965510466802544, -0.0015880135948343477,
      -0.45819513619802804, -0.8051948760507646, -1.002138890026727,
      -1.0431510505820316, -0.9552595216527591, -0.7887709236665004,
      -0.6023541671896153, -0.4468137419719733, -0.35180989678649865,
      -0.3189589907630852, -0.3230381751195518, -0.32086923449247384,
      -0.2654247154257867, -0.12131236739232631, 0.12258842770007095,
      0.44684176551351174, 0.8033828094799279, 1.1253798542105224,
      1.3426699977006302, 1.398919898721908, 1.26615739526099,
      0.9529305870085422, 0.50392576012499, -0.008986520592669356,
      -0.5021528260933499, -0.8982405611889415, -1.1426264851243364,
      -1.2141004253316043, -1.127366712838327, -0.9269092816379535,
      -0.673966645795191, -0.43008181792858613, -0.241511022654124,
      -0.12848744941536144, -0.0820210493992814, -0.06891577195024644,
      -0.04352070307283773, 0.037037793662510254, 0.19831154371788473,
      0.4386671558826935, 0.7268763168023804, 1.0079810231805382,
      1.2160779625593117, 1.2908273511504695, 1.1934682947603052,
      0.9181831727514538, 0.4957868222591335, -0.011364807938495817,
      -0.5221373521185926, -0.9539996470606191, -1.2407979427945215,
      -1.3465929525167049, -1.2722238548478737, -1.0531000283248808,
      -0.7489304295236616, -0.42811684822444507, -0.15084586537622802,
      0.04481708714568772, 0.15036404497334582, 0.18606434090393734,
      0.19237959370496488, 0.2160230770595995, 0.29450271712747295,
      0.4433707707842571, 0.6496824680564812, 0.8735278317582168,
      1.057370066912518, 1.1408526684260716, 1.0772633581510855,
      0.8473503347700911, 0.46680662439158427, -0.014683796964224005,
      -0.5228115151876721, -0.9742506163394549, -1.2947422261210006,
      -1.4352358267631693, -1.382143758348132, -1.159237161575327,
      -0.8208089130537775, -0.43791474023771443, -0.08121940604939121,
      0.1952164026949887, 0.365174654002575, 0.4338406072460209,
      0.4329950690789167, 0.4093225102096622, 0.40909433567515335,
      0.46340481829868607, 0.5779632445142566, 0.7302267199905403,
      0.874710985704819, 0.9551468723748566, 0.9203208599368815,
      0.7394252886235082, 0.41281245255986687, -0.024816504074873902,
      -0.5098416255449018, -0.9626236971262839, -1.3047990317393603,
      -1.4767443615542901, -1.4509075380610754, -1.2377151511373357,
      -0.8826202011542056, -0.45506895881888976, -0.03218019672913691,
      0.318771762099493, 0.5547260425785052, 0.6645661433349578,
      0.6684604243044148, 0.6092318301193407, 0.5382227809846143,
      0.4995152136032309, 0.5167503248973876, 0.5860714078010293,
      0.6770756254219825, 0.7415325948924397, 0.727561810477616,
      0.5954938095495229, 0.33115368833962655, -0.047070941417187484,
      -0.4894398757860464, -0.9242866618243161, -1.273474201643197,
      -1.4701128687657443, -1.4741495365350383, -1.2819296876175004,
      -0.9273238936746506, -0.4741154659076603, -0.0015305874158949573,
      0.41350205183223365, 0.7129831056205937, 0.8693089851174838,
      0.8888665517138334, 0.8070797771294227, 0.6764184781974814,
      0.5506601891260539, 0.46961539041680633, 0.44835024805428314,
      0.4737190881574885, 0.50907018793247, 0.5058195457340704,
      0.4187611102871521, 0.22097279488484467, -0.08575135312020526,
      -0.467877162320786, -0.8655404432000015, -1.2052269974658318,
      -1.4166517431794095, -1.4496364469993797,
    ]);
    const expected = [
      [
        -96.30546645290073, 31.75451044773363, 20.230646411049577,
        -25.443595190399634, 5.647481452612427, -20.23427154484262,
      ],
      [
        4.440892098500626e-16, -19.922343159580816, 17.966921563247425,
        13.771859630064114, -7.320779168998756, 0.0,
      ],
      [
        6.661338147750939e-16, -4.58071300066278, 8.897301544327867,
        -8.415402472501974, 2.5962715085473147, 4.776689367684337,
        -8.953597123867432, 7.368087096406453, 4.183406059253834,
        5.551115123125783e-17,
      ],
      [
        -1.1102230246251565e-16, -3.246541946747665, 6.341079320222856,
        -1.5691421038394993, -5.145401795462082, 5.6397548738410475,
        0.7010249910587338, -6.1762600908005005, 4.158075977365742,
        2.8548973851117823, -6.3427615452108155, 2.1550876970396997,
        4.534908119901668, -5.645693400586932, -0.013425031700141643,
        5.48552477705409, -1.8166019150321846, 0.0,
      ],
      [
        5.551115123125783e-17, -0.6256929634326598, 0.823514394188254,
        -0.2827453371300824, -0.4801419430451859, 0.8384052472540029,
        -0.5057028030987621, -0.23769258367783092, 0.780584789431894,
        -0.6806404685168004, 0.022213678820317384, 0.6547409735863092,
        -0.794862798517449, 0.2803445160097294, 0.47021928638240607,
        -0.8398484669578574, 0.5175872109847368, 0.2404025897607509,
        -0.8118163794781534, 0.7162161517853141, -0.018172382789693575,
        -0.7119828706818471, 0.8610706206773063, -0.28690482201505163,
        -0.546493344952745, 0.9405667005036968, -0.5463555868898282,
        -0.3260325835038441, 0.9474777760357667, -0.7775297790731943,
        -0.06513862531834824, 0.8830327992575084, -0.12903554928759312,
        1.1102230246251565e-16,
      ],
      [
        -2.7755575615628914e-17, 0.07146453184381293, -0.1329224134331332,
        0.04495404140985512, 0.023983761143213794, -0.12019397387682978,
        0.10356345446814419, 0.09300260676815778, -0.13981090826905668,
        0.015743297111131815, 0.05545237122401063, -0.11356014893723676,
        0.07473055042523974, 0.11495493186176653, -0.1382595253633726,
        -0.01623361923561134, 0.0821965438628065, -0.09901720318130534,
        0.04288516061729694, 0.1306195956094875, -0.12858395039206583,
        -0.04896016899082539, 0.10268663206862591, -0.07728666451035038,
        0.010086605214926853, 0.1387995392538912, -0.1116083823085085,
        -0.08034215337261386, 0.11581014556705563, -0.049564657864961253,
        -0.021574405950214162, 0.13876275293635484, -0.08860933156225032,
        -0.10834188319265858, 0.12093973297922778, -0.017448494256623787,
        -0.050109585437807844, 0.130292629452467, -0.061230685499896076,
        -0.13110921746854676, 0.1179698546873123, 0.017162737843327447,
        -0.07375982737327699, 0.11370546973140695, -0.03137553632591389,
        -0.14710106492702368, 0.10731985438002056, 0.052187256383232794,
        -0.0911068004583918, 0.08983395812134036, -0.001081751266652109,
        -0.15518167387231074, 0.08990329350099091, 0.08549175592735575,
        -0.10116224148351212, 0.05997760460965909, 0.027610699275581047,
        -0.1546972594955338, 0.0670655767438238, 0.11502629432360834,
        -0.10342925284557838, 0.025823267269594385, 0.05279211808345559,
        -0.15570199415594865, 0.10101423184836583, -0.10101423184836583,
      ],
      [
        0.0, 0.01137000669440641, -0.0005900629441246974, -0.01062306001292751,
        -0.010188210003851922, -0.0008959815952531147, 0.00737588563320704,
        0.006257990061495813, -0.0029349304034744644, -0.01053708453501695,
        -0.008070596742822844, 0.003264027183161794, 0.013416805824993605,
        0.012929242971167362, 0.0019579213546481455, -0.009789058961015007,
        -0.012165892827149527, -0.0040383100507226655, 0.005945724245720194,
        0.00791664567424076, 0.00036290789539351886, -0.00852056651952783,
        -0.008984327865198732, 0.000549573391210173, 0.011651781085309537,
        0.013796908659382729, 0.004457557025157155, -0.008331974810988685,
        -0.013448422071274196, -0.007063098320413436, 0.003975890594253337,
        0.008936219072124704, 0.0035694345814384493, -0.0059433903878416405,
        -0.009229137939199966, -0.0020544348698497417, 0.009297598300590904,
        0.013905958799580323, 0.0067301686265678895, -0.006365545451389398,
        -0.013970154205088403, -0.009784629698655789, 0.0015951630695380525,
        0.009263859929622364, 0.006498118911593548, -0.0029505525687837098,
        -0.00877358135665128, -0.004374163912873083, 0.006501323882569174,
        0.013235892008917801, 0.008610660902919343, -0.004035746402694995,
        -0.01371253468229483, -0.01203415221183586, -0.0010387624083492975,
        0.008893038110731749, 0.008981049804213742, 0.00028573462539520367,
        -0.007632902220752684, -0.006256525087302733, 0.0034358149389543333,
        0.011814288019669956, 0.009958421897364317, -0.0015111048143821304,
        -0.012705040933915945, -0.013670600616066675, -0.003749464213230011,
        0.00786372284515563, 0.010879370389305837, 0.0035767563651427497,
        -0.005868288131803345, -0.0075790597633681005, 0.0002887455003350494,
        0.009715294202840528, 0.01066666757299714, 0.001028419750762788,
        -0.01102307855708945, -0.014589586293113951, -0.00635322835245751,
        0.006259552920252431, 0.012091842349724102, 0.0067290812519550935,
        -0.0035831456677551735, -0.008257818148198336, -0.0027492765748856687,
        0.007055153876292609, 0.010669623510050519, 0.003403269815409532,
        -0.008782969090050274, -0.014730079698762305, -0.008670988433817486,
        0.004202183696278061, 0.012560996681257486, 0.009556669560834896,
        -0.0009166330161535629, -0.00825272645350357, -0.005496742792354292,
        0.003985058362312874, 0.009947077792800699, 0.005446076283501494,
        -0.006134353591005531, -0.014078357194916027, -0.010540004249745424,
        0.001843178101778975, 0.012276482236295183, 0.011892532501009134,
        0.001965138375969182, -0.007570098634997913, -0.007792659092631021,
        0.0006817759298644172, 0.008526007696262522, 0.007012636507569267,
        -0.0032505012368907182, -0.012668958714830786, -0.011824527118220782,
        -0.000646033497134324, 0.011275402969220027, 0.01359919958611533,
        0.004879671211995349, -0.006262132654904218, -0.009506614778499928,
        -0.002663347033538363, 0.006479170432443282, 0.007991376351829116,
        -0.00031714576220656654, -0.010582593589408447, -0.012424764513806336,
        0.02571311397791265, -0.025713113977912705,
      ],
    ];
    const result = wavedec(data, "bior3.1");

    const reconstruction = waverec(result, "bior3.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4990240207424328, 0.9232698999570984, 1.2126874079947556,
      1.3333890537658302, 1.2832683077106215, 1.0906345125388583,
      0.8063205525412117, 0.4912242914668553, 0.20227680111469137,
      -0.01985250786703674, -0.15847308788625092, -0.22231207845167264,
      -0.24050968579609674, -0.2525685768433294, -0.29586991129550316,
      -0.39394597879525206, -0.5485015266629494, -0.7372511439008913,
      -0.9182110677596493, -1.0394940421425498, -1.0522878313226653,
      -0.9238816435751053, -0.6475386220377712, -0.24671629515560933,
      0.22755390101453826, 0.705711558344473, 1.1131995379116295,
      1.3854720158182832, 1.4810951832602866, 1.3899784630882241,
      1.1348897997255785, 0.7659562191757113, 0.34946533706906735,
      -0.046415911163690926, -0.3657082359251523, -0.5752730187638779,
      -0.6697009915885225, -0.6694823091103366, -0.6131125389245505,
      -0.545226606056529, -0.5037769414513318, -0.5094643223746518,
      -0.5600468353613406, -0.6309362194315302, -0.6819351328723722,
      -0.6684483773650549, -0.5543821444584618, -0.32349826942105164,
      0.013675035791355983, 0.4192357935354023, 0.8339672225185724,
      1.1888274503540766, 1.4193156236547448, 1.4794371449343529,
      1.3520385770763206, 1.0530932456167603, 0.6289024240292457,
      0.14680847852517712, -0.3184893315919772, -0.6999210209998012,
      -0.9509599807600779, -1.0536025441853492, -1.0197291701624176,
      -0.8857280341777475, -0.7018404912863734, -0.5189062756844962,
      -0.3757568439211842, -0.2902954330064623, -0.25636607332619055,
      -0.24707814284841476, -0.2236641196145791, -0.1475881651267773,
      0.007180952642841687, 0.24487362729603246, 0.5440317850171332,
      0.8601579593120281, 1.1344424089448097, 1.3066200650521098,
      1.3289745881347244, 1.1781774069845292, 0.862107723046422,
      0.4199399774083893, -0.0846596998469792, -0.5757841098240261,
      -0.9802679671536509, -1.242050355936838, -1.332709338634021,
      -1.2558561870015874, -1.0445087068420305, -0.7521932891245472,
      -0.43996818096620066, -0.16247581298910407, 0.04369431336435631,
      0.1666560263957311, 0.21945030182045305, 0.2339718762662517,
      0.2502536565323407, 0.30388061395067134, 0.41474577373747373,
      0.5800213281938476, 0.7731801255315482, 0.9494164465791641,
      1.056237390864107, 1.046706975481051, 0.8921354196793653,
      0.5910844094854832, 0.17239052067554345, -0.3087014340255027,
      -0.7805841991557905, -1.169337580658766, -1.413644829834562,
      -1.47721038862103, -1.3558735443318626, -1.0778303773299172,
      -0.6969650123120597, -0.2808757949488535, 0.10361097595867874,
      0.4041013469704682, 0.5923714181844867, 0.668054441399164,
      0.6556115115984202, 0.5955260286886184, 0.5320287480880452,
      0.5004625691676177, 0.5174447469777366, 0.5762700025570762,
      0.6486945781967024, 0.6926630598336537, 0.664066894659888,
      0.5296109295757389, 0.27755691815767325, -0.07641292670663546,
      -0.48982437805767437, -0.9005996132578459, -1.2392980637927447,
      -1.4436714914644002, -1.4722044091113509, -1.31350377612995,
      -0.9893356840793215, -0.5505628619110048, -0.06687233354835642,
      0.387388346138867, 0.748062165666985, 0.9733827936604346,
      1.050832829872712, 0.9972426170201832, 0.8523080721473149,
      0.6672453333128279, 0.4914178831412605, 0.36020469380343934,
      0.28702620445067073, 0.26139633165846055, 0.2533771562563513,
      0.22323775233960474, 0.133838649554901, -0.037413546934286834,
      -0.2901075706659815, -0.5980959552575057, -0.9133396486898364,
      -1.1755797579039198, -1.3256560560901867, -1.3193714037269477,
      -1.1386145699342707, -0.7970495373243285, -0.3389193449494097,
      0.16889477191397062, 0.6498489188503249, 1.0328621912488705,
      1.266206183800166, 1.3270620778449949, 1.2246618708394543,
      0.996426048660459, 0.6981345190020273, 0.3905369151941181,
      0.12559982790569202, -0.06438247736867897, -0.17232362838460347,
      -0.2153591847152354, -0.22776143542649, -0.2496535964424894,
      -0.31443123239240695, -0.43809968446732767, -0.6132577957720005,
      -0.8093158464194571, -0.9790040321179738, -1.0696752340528288,
      -1.0367059634496856, -0.8557421660617661, -0.5307588258039191,
      -0.09585476346702437, 0.38983712283414296, 0.8531239404018565,
      1.221214443882196, 1.4364307935496272, 1.4678491625159613,
      1.3172426268232156, 1.018010056053619, 0.6273916756456003,
      0.21381409459394707, -0.1576885624000809, -0.4386242766874947,
      -0.6057944392565632, -0.6637578372874273, -0.6406347841972683,
      -0.5784690556423833, -0.5206500751335921, -0.4995718394788812,
      -0.5276096179838274, -0.5936559817683065, -0.6660776882886965,
      -0.7013670893269722, -0.6563484776935131, -0.5009018539105556,
      -0.2280015127216179, 0.14152311465272105, 0.5608550532647629,
      0.9654576208642152, 1.285974623242163, 1.4628624416892793,
      1.459399976804441, 1.2700588034779485, 0.9222655944803024,
      0.4711056620154267, -0.011857050280177195, -0.4531157082555587,
      -0.7918245820256042, -0.9911951987289567, -1.0441863370416622,
      -0.9723474448350359, -0.818289624157898, -0.6337459974851457,
      -0.4661916999544404, -0.34728561210063974, -0.2859053024952566,
      -0.2673943685532855, -0.25910607574136885, -0.2207786001714092,
      -0.11708767952817212, 0.07082180132146093, 0.3377913410871968,
      0.653103019032197, 0.9654950902353097, 1.2137051816766278,
      1.3401458081316844, 1.304518028016766, 1.0941267961484993,
      0.7283900067711645, 0.2563628019787127, -0.2522836024449815,
      -0.7208657621641097, -1.080842790388105, -1.285129178695317,
      -1.3166047906907556, -1.189983959151503, -0.9467531201021825,
    ]);
    const expected = [
      [
        1.5727853123596602, -1.1725171876782228, 1.5727853123596596,
        4.9483771187835925, -4.891187566096566, -0.13514464542684174,
        5.247010704980031, -5.914749735765184, 1.7738852001157226,
        2.5384949886056454, -1.4400485898117485, -11.22585532605274,
        -5.831366814637885, -11.22585532605274,
      ],
      [
        1.9699421679086169, 0.0, -1.9699421679086169, 1.9258102055327293,
        3.6912069410323993, -5.0314472070737475, 2.981523957468574,
        0.8844623246985465, -3.449292341900604, 2.691586274390292,
        4.053289647644604, -0.4354216914128698, 0.0, 0.4354216914128698,
      ],
      [
        -0.6590950703091473, 0.0, 0.6590950703091472, -1.8016478717926652,
        5.091153876888381, -0.0020141270961969715, -6.0859993865984805,
        3.860472750526433, 3.7163499384428675, -5.671194987810723,
        0.1681845914488087, 4.082341069377752, -2.5222816542445208,
        -0.47526988849118834, 1.541153374638116, -2.1490762897031477,
        1.8856578980436638, 1.5908748704652627, -4.206119054385959,
        1.1102230246251565e-16, -1.1102230246251565e-16,
        -1.1102230246251565e-16,
      ],
      [
        1.9169801821463743, 5.551115123125783e-17, -1.9169801821463743,
        -1.532741518772054, 0.4653602923289526, 0.5190908301802218,
        -1.0513585243695256, 0.9066906064823891, -0.3066244598201128,
        -0.3429823799792612, 0.7370850057379907, -0.77035477827527,
        0.472657625409221, 0.056921325997660754, -0.6318272015433928,
        0.9616400139386434, -0.7715474610126114, 0.03986786679529819,
        0.8576253539057562, -1.309372302381705, 0.9015716979420894,
        0.19809135987854853, -1.2653468491950348, 1.5114242127982687,
        -0.6947005288561907, -0.644949830030834, 1.5546834326595713,
        -1.3782811616506792, 0.2523254126805504, 1.0045945931764229,
        -1.5159882438064765, 0.9858904938093735, 0.13609822416490386,
        -1.0831169652329944, 0.9454587826690182, -0.3927237739541808,
        0.3927237739541808, -0.9454587826690182,
      ],
      [
        -0.6140260244111122, -1.3877787807814457e-17, 0.6140260244111122,
        -0.05736013879832361, -0.08122590631001925, 0.0787843286167231,
        -0.04450754133218156, -0.06524895603079037, 0.1389202593309668,
        0.020162053767286386, -0.13611934692327798, 0.04083401332298797,
        0.04130473330202028, -0.08896755124908039, 0.07572401338578072,
        0.09182562380671644, -0.13447754857153105, -0.03600321493853163,
        0.10147226199349979, -0.05362277461915227, -0.008380190883422456,
        0.12030549157690855, -0.07825417808519974, -0.11196848696261383,
        0.10684123494228032, 0.023784686123666438, -0.07097089710691983,
        0.08944040863640725, 0.0028112469039217325, -0.14761529833919507,
        0.05628445138776128, 0.10464699898038199, -0.08075189018797176,
        0.013380520829899822, 0.06639909116726922, -0.12397299595610534,
        -0.02273492486927922, 0.1484721009763858, -0.033540561415025164,
        -0.07063158040413503, 0.07924340037726957, -0.05224726636655308,
        -0.08821050063651845, 0.13357043053679502, 0.04560081418700895,
        -0.12128093578624216, 0.03413798137180807, 0.031899753135137286,
        -0.10507194009271843, 0.06813378351643978, 0.115180008662108,
        -0.11428150237175033, -0.046376064110120324, 0.08656670050902718,
        -0.06311953893951003, -0.013955402599828526, 0.13848698639891838,
        -0.05477514171552467, -0.12152586582564912, 0.0850178819311892,
        0.017751288204413074, -0.0704426804648982, 0.10236295292056524,
        0.02530797202654908, -0.15314050873955615, 0.034382278709830655,
        -0.3761438601567155, 0.3761438601567155, -0.034382278709830655,
      ],
      [
        -0.010615481149196943, 0.0, 0.010615481149196915, 0.000372385334108577,
        -0.008986069297301169, -0.010064086732305494, -0.002950499846018792,
        0.005151309358095923, 0.006608117878498826, 0.0003013595976114128,
        -0.007421750834962021, -0.008628865721846707, -0.0011909192927682388,
        0.00902116862237018, 0.013179964629503313, 0.007324531793949901,
        -0.004024841973880783, -0.011718105630243586, -0.009895833820083716,
        -0.0009562325371615769, 0.00680511922305313, 0.00670910532094153,
        -0.0003963180535099392, -0.007105953227707032, -0.0063805441786581735,
        0.0018611425169322848, 0.010468146902994468, 0.01140224770559671,
        0.003032327926447753, -0.00818498611268409, -0.013205088200773624,
        -0.008224820171456971, 0.002100188260616559, 0.008881500713854018,
        0.006864496562299205, -0.0010882319647341904, -0.006853194416673307,
        -0.004601715172383482, 0.0037932873765639634, 0.010396191706934073,
        0.008435136808321642, -0.0013928591930054135, -0.011254688078325997,
        -0.012933917357984909, -0.0050243361921720325, 0.0058367785957108564,
        0.010793675145959802, 0.006468171147536561, -0.002305340590417912,
        -0.007076884967083252, -0.003516623257177838, 0.004689382228758171,
        0.009279521472079305, 0.005071684629881668, -0.005097634569376758,
        -0.012658493979810476, -0.010839372201496902, -0.0007355170387641496,
        0.00952545749286382, 0.011813332260950327, 0.0049893277530635785,
        -0.004324151534594534, -0.007818966773318545, -0.0029375434327112288,
        0.004992838150544257, 0.00779736419972292, 0.002075048411329772,
        -0.007508453477181987, -0.012275474221496217, -0.007338970624033103,
        0.0038477377353459685, 0.012319041794228547, 0.01134146447019338,
        0.0022127846492821512, -0.007017313031890238, -0.008726313326698792,
        -0.002372420882597509, 0.005292326415011303, 0.006565392834127291,
        -7.270232603466542e-5, -0.00849218486110609, -0.010458149388395135,
        -0.0032016435427089096, 0.00782113823354355, 0.013531176699904501,
        0.009144376543567964, -0.0016320020012757508, -0.009860587746100047,
        -0.009186482164291881, -0.0012527054670052884, 0.006058542001323566,
        0.005903557552710506, -0.0013083520573144158, -0.008356199790009636,
        -0.007888392878133782, 0.0007026845203241538, 0.010453318312042659,
        0.012867795800192622, 0.005466611923219344, -0.005904141791389872,
        -0.01209622980845354, -0.008572258805031124, 0.0008058873322660011,
        0.007432359718313394, 0.005726503703165686, -0.001963534570670833,
        -0.007691138272111167, -0.00532451397001546, 0.003682158016082515,
        0.011408581413615816, 0.01052592414143777, 0.0009772967210875672,
        -0.009737799450793228, -0.01299429522292292, -0.006503344657440728,
        0.0038094401801581634, 0.009145210428488565, 0.005596552277743139,
        -0.002590910413914349, -0.0071173521735530265, -0.003333144942670306,
        0.005430212514242295, 0.010829759848488954, 0.007123913717120983,
        -0.0034326311741234017, -0.012316247283572196, -0.01211643145953726,
        -0.003026441134933916, 0.007333835060068322, -2.7755575615628914e-17,
        -0.007333835060068322,
      ],
    ];
    const result = wavedec(data, "bior3.3");

    const reconstruction = waverec(result, "bior3.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5129557525507087, 0.9433892046349666, 1.2263751211350256,
      1.3279259245506092, 1.250893281074664, 1.032121622504883,
      0.7317391165231416, 0.41742746365910977, 0.14773138896729165,
      -0.04135625963794165, -0.143207020332832, -0.1791950018789655,
      -0.189734386622855, -0.22027178624547045, -0.3060960210913593,
      -0.46012357503069934, -0.6670269535372944, -0.8854005523140859,
      -1.0575371768217574, -1.1243670578428855, -1.0417140679473524,
      -0.7936148813730849, -0.39913622939579374, 0.0892591275242943,
      0.5956164725890145, 1.036380519467485, 1.3384570786078953,
      1.455054647613573, 1.3754516369559635, 1.126345215792516,
      0.7645380107766004, 0.3628742425553565, -0.007001134382802643,
      -0.29073970206770416, -0.46227742746087186, -0.5271082168470067,
      -0.5172523865500852, -0.4794768063276163, -0.46005188114228873,
      -0.49019626427627483, -0.5761426351084507, -0.6965158931070133,
      -0.8077717139378827, -0.8563024689551677, -0.7940340407674771,
      -0.5933743034309154, -0.25748407206970947, 0.17699996972304555,
      0.6457479513312226, 1.069804987092978, 1.372841001915641,
      1.4983733413811735, 1.4227130172178128, 1.1604237100557815,
      0.7609372088095153, 0.2971685160332399, -0.1510412594204709,
      -0.5145605283128942, -0.7493618554339122, -0.8442242881790176,
      -0.8200286838668485, -0.7210890774817216, -0.6009879372422942,
      -0.5067565187566707, -0.4656135311186888, -0.47775430623840026,
      -0.5170584645803807, -0.5394789589800548, -0.4968352096341624,
      -0.3522866997804977, -0.09328660382979176, 0.261566476979868,
      0.6638035401215368, 1.0444153768707132, 1.3290695748168204,
      1.455489424864247, 1.388656533784943, 1.129990642018478,
      0.7181354737840242, 0.2210647311539492, -0.2786128071848597,
      -0.701576983450656, -0.988586151307566, -1.112082973616167,
      -1.0798992273748642, -0.9303545843387232, -0.7202192622691537,
      -0.5087924409375117, -0.34228346228412876, -0.24253548891753146,
      -0.20294440515366877, -0.19250936241466932, -0.1668026651178495,
      -0.08282190182786126, 0.08634151888610209, 0.3410494493754788,
      0.6518230498319362, 0.9642876565076435, 1.2112784134323085,
      1.3291335412736738, 1.2740606778888046, 1.034371879421804,
      0.6353728865285639, 0.13551307022071762, -0.38540874046391393,
      -0.8431886377178366, -1.1672199537923384, -1.3151949144274269,
      -1.2809807115383993, -1.0938657113221593, -0.8095395575226231,
      -0.4952331179816956, -0.2128753827865169, -0.004562025699310135,
      0.11603275976128144, 0.16425797280390447, 0.17715918159375818,
      0.20035250673643973, 0.2727341582797785, 0.41321366617808697,
      0.6131174538503426, 0.8364138856616723, 1.0278483185936922,
      1.1269806591330607, 1.0845314880215424, 0.8767785514298407,
      0.5141791387717908, 0.04181908135120091, -0.4686559940662332,
      -0.9338114455685669, -1.276368208084809, -1.4419671993280203,
      -1.410673357151373, -1.200444350209697, -0.8617937734899332,
      -0.4650723932271594, -0.08361528972541793, 0.22300572116228906,
      0.4214757423426403, 0.5099729256214182, 0.5150449239635033,
      0.481190286070981, 0.45608359622157807, 0.47548337925479944,
      0.5519068409439221, 0.6701364893784854, 0.7908060608231073,
      0.8611683617518098, 0.8302315726790568, 0.6642605538496315,
      0.358486339991545, -0.058205948825924725, -0.5270677844080885,
      -0.9710480533575612, -1.3114127084505869, -1.485386541351569,
      -1.4604747633075998, -1.241917893143291, -0.8714304598273591,
      -0.4175412650181445, 0.040060962307328474, 0.42829832518251915,
      0.6962239829373899, 0.8245432617893564, 0.8269508082693756,
      0.7432047611491263, 0.6259657125997113, 0.5249960533309036,
      0.47294395036353887, 0.4764678384960739, 0.5150166899800677,
      0.5475434860726927, 0.5253228435713624, 0.40741467784281604,
      0.17458697477819735, -0.16212703126640426, -0.5606992959336219,
      -0.9556527492418093, -1.2721818517162862, -1.4434184419193075,
      -1.426550852630832, -1.2137336137789063, -0.8349921467601213,
      -0.35231144810642023, 0.15370461436769256, 0.601365645446154,
      0.9253475823870101, 1.089841557990572, 1.0942869680543377,
      0.9704694570176514, 0.7719516911363423, 0.5587271127774097,
      0.3811540902844209, 0.2673445867523047, 0.21722267108959764,
      0.2046853568194772, 0.1871543519811056, 0.11985754038009333,
      -0.029072100588885874, -0.26682093532297424, -0.5707290851708042,
      -0.8913040421921178, -1.1628445603993836, -1.3190988909113968,
      -1.3100248209356629, -1.1153658321025293, -0.7515038337642064,
      -0.26970795627831756, 0.25395031689736347, 0.73465090448631,
      1.09697936296079, 1.2907844447692214, 1.3009229655584718,
      1.1486183912050218, 0.8842691412305044, 0.5736807984861316,
      0.28131830248432943, 0.05486814843333543, -0.08500638625961221,
      -0.14723222975394767, -0.1647566657207921, -0.18251056376207336,
      -0.24225721351824042, -0.36848180919234796, -0.5591927737971611,
      -0.7842099869087342, -0.9915419890799155, -1.1203147505641633,
      -1.1169626083224653, -0.9504825083406123, -0.622724546147716,
      -0.1709058617197079, 0.3385161424566523, 0.82328851919089,
      1.2029373002612909, 1.4162177343920366, 1.434193763770485,
      1.265781276491103, 0.9544694894240274, 0.5671347295296851,
      0.17782071393928195, -0.14941895425183033, -0.3743454966029808,
      -0.48766827953064307, -0.5098886602109907, -0.48241011453225224,
      -0.45346260138077576, -0.46270759843649334, -0.528697371221821,
      -0.6425812500489076, -0.7697869999326342, -0.8592887092514816,
      -0.8580525976585273, -0.7268527696040079,
    ]);
    const expected = [
      [
        2.1674969426618467, -0.9175785812945438, 2.1674969426618467,
        3.7051022477455833, -3.668109489257713, -0.30766551759296923,
        4.898407418842228, -7.037192478713964, 5.469978394255136,
        -1.3280246219831517, -1.746134244845814, -4.897758190959847,
        -3.828224372181892, -4.897758190959846,
      ],
      [
        1.859800738294513, 0.0, -1.859800738294513, 1.4537330908966455,
        2.722035880002421, -3.6008971166373818, 2.6584804673839693,
        -0.23695818996101892, -2.4196226921397757, 3.9574819943107045,
        -1.9629391109616101, -0.7432013296350426, 0.0, 0.7432013296350426,
      ],
      [
        -0.7846178737359164, 5.551115123125783e-17, 0.7846178737359163,
        -1.9310197969742366, 3.7294524631961283, 0.38644747248671185,
        -4.133869596087948, 2.647796110762735, 2.2944445483899254,
        -4.402222625718945, 0.8794317184316888, 3.8663668596904364,
        -3.733709900935855, -1.2252599090357301, 4.716851914618706,
        -2.1934403364203865, -3.2207449747961983, 4.6347382647322535,
        1.2901450172922773, 1.6653345369377348e-16, 0.0,
        -1.6653345369377348e-16,
      ],
      [
        1.9337153811723278, 0.0, -1.9337153811723278, -1.6577682557190005,
        0.2351540257912036, 1.1140363558353332, -1.5071359625128955,
        0.6169500272816223, 0.790871153256778, -1.5165702827870973,
        0.9488369083712135, 0.4203780650659684, -1.4222164869697036,
        1.2088717945970973, 0.02901518847489909, -1.2325149096947334,
        1.3804063652289285, -0.3557280027945404, -0.9624253136280484,
        1.4532468370622098, -0.7072779768781923, -0.6322827390333301,
        1.42428030886707, -1.0018362935759004, -0.26628657853524224,
        1.2975918344179098, -1.2200192671514511, 0.10926582698538506,
        1.084069175453056, -1.3481636401084491, 0.467872501406049,
        0.8005288256354691, -1.3789960986061518, 0.6776224489461641,
        0.22766174248174345, -0.058357994877864194, 0.05835799487786414,
        -0.22766174248174345,
      ],
      [
        -0.6394678119857642, 5.551115123125783e-17, 0.6394678119857641,
        -0.07444745218158214, -0.07187494532023231, 0.09058564899982326,
        -0.08263442438229673, -0.03178089370955545, 0.16679626941736292,
        -0.05325464725912177, -0.1085117554206605, 0.0932271205310336,
        -0.04264896982171851, -0.054970820216204946, 0.15760812414818137,
        -0.029066559326259178, -0.13801711248105702, 0.08834463075907174,
        0.0004090206544467567, -0.07341541136827671, 0.13775120144946779,
        -0.0028619608426450616, -0.1583510141877097, 0.07639962542986234,
        0.04362046901741995, -0.08570627300331177, 0.10853583480359164,
        0.02327176833216052, -0.16809615304891784, 0.05839810597762171,
        0.08404601984426197, -0.09092241000063374, 0.07191891741969217,
        0.04726630697333156, -0.16655775106722176, 0.03581074426488293,
        0.11892931241464028, -0.08869844650393671, 0.03037019406296776,
        0.06723092321662413, -0.1538133074613735, 0.010458053691665109,
        0.1458879447921002, -0.07925045664809528, -0.013297413563740257,
        0.08159701390065528, -0.1307086865177007, -0.01563065377062292,
        0.16307873874365608, -0.0633575673738788, -0.05612162461843373,
        0.08923780772145563, -0.09880074363250993, -0.04037385336250229,
        0.1693257055275028, -0.04230080281986398, -0.0951952245820894,
        0.08955426085082871, -0.06025044852001292, -0.06179811857972445,
        0.1642017250537549, -0.017763834437235726, -0.12786680541306855,
        0.08252071173192249, -0.014467486788688255, 0.11244448433505061,
        -0.039061680793873815, 0.03906168079387379, -0.11244448433505061,
      ],
      [
        -0.011477268505472649, 0.0, 0.011477268505472649,
        -0.0005041081256782487, -0.010629258777044043, -0.010349343022185431,
        -0.0011717575761038684, 0.007144285598332214, 0.0062382410414258335,
        -0.0027095438295182406, -0.010201287145500434, -0.0078093098180992415,
        0.003370553745029148, 0.013427023827771473, 0.012921349274355062,
        0.0018953271651848957, -0.010041380623951435, -0.01266515828913961,
        -0.004607513626644175, 0.00566044570210552, 0.008179529279341236,
        0.001101792463441234, -0.007697621754703621, -0.008498383601752701,
        0.000558758452104402, 0.011372021936379137, 0.013493378426626415,
        0.004187661061602982, -0.008738388286894938, -0.014114047371777017,
        -0.00778302449883142, 0.0036912489517494235, 0.009472131657531302,
        0.004811633443849106, -0.004617474374166236, -0.008517203675096244,
        -0.0022179863641342557, 0.008568190091037632, 0.013140238219368508,
        0.006190435829452751, -0.0068313098614197765, -0.014603306898759189,
        -0.010472542463187864, 0.0013844756560782712, 0.010035651487132424,
        0.00816873476004401, -0.0011674537459832601, -0.007853781204751796,
        -0.004756811868225401, 0.00521117188249599, 0.011873181278502877,
        0.007741469058861555, -0.00447346520518227, -0.014106573285847301,
        -0.01248161339052489, -0.0010841375461021208, 0.009844631183296537,
        0.010947602210662793, 0.0024172787410724345, -0.006548793115630226,
        -0.006875943471819114, 0.0015332862043955023, 0.00976773319258531,
        0.008711452882608356, -0.0018486050643383156, -0.01266527713209592,
        -0.013661137738863502, -0.003524054406849192, 0.008929626389344025,
        0.012963933145462042, 0.005889297412304859, -0.004693006359013534,
        -0.008427755458257524, -0.002212750270947833, 0.006959038009316659,
        0.009014165335815671, 0.0008430419207666184, -0.010385370667798419,
        -0.013918344675544909, -0.005744321370101363, 0.007374156576945401,
        0.014087110160947686, 0.009006214129453544, -0.0024208943569981323,
        -0.009309165456371532, -0.0057714350734360265, 0.0036329427703188782,
        0.00861351221961551, 0.0033997718980619124, -0.0074295787912757455,
        -0.013223876058216021, -0.007568105051298207, 0.005307794769378205,
        0.014248885380375026, 0.01154777193487274, 9.910175828770074e-5,
        -0.00946863113198218, -0.008902185936306595, 1.3422847419189421e-5,
        0.007526849744212263, 0.005633346945112798, -0.004005738463811553,
        -0.011614449142547174, -0.008846297002788328, 0.0028959397979327894,
        0.01344766545197798, 0.01333151610446727, 0.0026769620862145127,
        -0.00890926605120776, -0.011395898969504187, -0.0036527858940492014,
        0.00582431192638164, 0.007382776327354835, -0.0003520643982321964,
        -0.009190878384716564, -0.009469160893409767, 0.00032705377361946786,
        0.011748119989607814, 0.014225922159641191, 0.005115220675031257,
        -0.007687880039341566, -0.01308920362193347, -0.007113278275515333,
        0.003624162170699944, 0.008525932746221251, 0.0032796081893184115,
        -0.006111565449688119, -0.009375136428816738, 0.0461676283315095,
        -0.04616762833150953, 0.009375136428816738,
      ],
    ];
    const result = wavedec(data, "bior3.3");

    const reconstruction = waverec(result, "bior3.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49544401523561465, 0.9117829065410801, 1.1872081065387747,
      1.2902441834220262, 1.2253504181041877, 1.029803565010526,
      0.7627897979264475, 0.48959866686209075, 0.265026256949647,
      0.12024883139645642, 0.0564855141566572, 0.04697496572418492,
      0.04661140224319468, 0.00658357964932349, -0.10994602076210364,
      -0.315357966030081, -0.5916944011649485, -0.893065358764966,
      -1.155863923125284, -1.314260796107914, -1.3170433991831016,
      -1.1414692685890029, -0.8005231210933506, -0.3416193544175039,
      0.1630457839240491, 0.6321700118668053, 0.9931962438950299,
      1.197937094133526, 1.2321424617370933, 1.1167262617329474,
      0.9004914893105617, 0.646347501228796, 0.4146468564212328,
      0.24796322555549716, 0.16121097532226608, 0.13958263774382104,
      0.14472258550712522, 0.12739675957922741, 0.04321759886776916,
      -0.13281976112602356, -0.3969315279779619, -0.7148807677843604,
      -1.0286507523815271, -1.2698733497166352, -1.3766495994264951,
      -1.309479707295266, -1.062199840189973, -0.6650600293070863,
      -0.17905569254061418, 0.3171618838966722, 0.7445907807440586,
      1.041129210136906, 1.1745248473606849, 1.1478805168134212,
      0.996475915942642, 0.7768751651006562, 0.5512406648587731,
      0.3709648410140863, 0.2638588115721891, 0.2281710513974778,
      0.23490174643012435, 0.23769835061160288, 0.18762924481095739,
      0.04884988359994258, -0.1890685750854469, -0.5055205553975219,
      -0.8515908420779325, -1.160584975467259, -1.3637840741897889,
      -1.4074561549242923, -1.266785672406999, -0.9531274172150408,
      -0.5126614621746876, -0.016695321516420503, 0.45402808171971587,
      0.8271443273501957, 1.0542039786756983, 1.1201265548536419,
      1.0443288255752123, 0.8734118063775131, 0.6674370510876471,
      0.4834366530444166, 0.3604694448890813, 0.31008895710719087,
      0.31464497547707615, 0.3337750835638635, 0.3172904687218278,
      0.22097858402683931, 0.021069390312663583, -0.27655672872944,
      -0.6349872218542011, -0.9932616586031883, -1.2800831844674194,
      -1.4308515434825861, -1.403714590749036, -1.1905408424489494,
      -0.8199743678516049, -0.3517241080121533, 0.1365472183113295,
      0.5665013267339537, 0.8762920166415735, 1.0333911290745548,
      1.0399660345553245, 0.9296140107524041, 0.7564666460096486,
      0.5796132800296121, 0.44695966394947606, 0.3827382781916282,
      0.3818971338266371, 0.41277243488475857, 0.4272695483422033,
      0.37580111019475765, 0.22297234510942993, -0.04021183563082864,
      -0.3909586891073749, -0.7777014429855262, -1.1309201388798593,
      -1.3791384370902071, -1.4660969688337366, -1.3647580346201056,
      -1.0845649936777666, -0.670067619858347, -0.1912003550464275,
      0.27239360138985147, 0.6491027717534538, 0.8907587285074767,
      0.9819410651643167, 0.9409760878649414, 0.8125607815855804,
      0.6540807228415246, 0.5192841306831468, 0.4436156407283623,
      0.43503994819664815, 0.47272206787841375, 0.5138576990479817,
      0.5068012718011694, 0.4069764262087695, 0.19130485675190417,
      -0.13275042575461682, -0.5260537029961043, -0.9250623902804764,
      -1.2557972019445518, -1.451070206560178, -1.4666489463953232,
      -1.2922653375345572, -0.9546579181256559, -0.5118385378832415,
      -0.03998708450007149, 0.3837665677495587, 0.698390769294183,
      0.8716179229989802, 0.9051592437553138, 0.8313217996543809,
      0.7020861087680941, 0.5736230144994316, 0.49037120518585364,
      0.47286927883826974, 0.512522577174596, 0.5746492016057588,
      0.6089677221392512, 0.5647262814025701, 0.40643761163972614,
      0.12599761933659231, -0.25212325930454277, -0.6741503115165631,
      -1.0680865996837297, -1.3599279735704484, -1.490982079127874,
      -1.4319407399403234, -1.1901471197794649, -0.8082035841113111,
      -0.35424716207027673, 0.09368170233209239, 0.46527245483820523,
      0.7131942693805515, 0.8222157883714514, 0.8100406197753507,
      0.7198394541973321, 0.6065871520326415, 0.5208858012896556,
      0.49456891716056584, 0.5318815574525417, 0.6085477062716954,
      0.6789549513417329, 0.6895465472971951, 0.5948667732689837,
      0.3719834691470949, 0.029400212046778396, -0.39202845437683764,
      -0.8266117105770461, -1.1980223733573938, -1.4366969625967907,
      -1.496097268932147, -1.3637497053105436, -1.0642789473074572,
      -0.6536657949187791, -0.20617026265465999, 0.20279680229628846,
      0.5135683452037318, 0.6946906268890845, 0.7479396726141232,
      0.7047883615131375, 0.615429519829095, 0.5333648868377048,
      0.49968741234542047, 0.5312286914152823, 0.615705222007119,
      0.7151467013969873, 0.7767064611930086, 0.7480039048101433,
      0.5929369239088783, 0.30374373698403556, -0.09396836859011076,
      -0.5447151547571714, -0.9744459560858425, -1.3069483709821643,
      -1.4812908441318087, -1.465948957403662, -1.2660761541961247,
      -0.9220999226153507, -0.5000099063191127, -0.07579514488683942,
      0.28205176821005107, 0.5275886721226988, 0.6463224889961496,
      0.6558466703640006, 0.5982498205655425, 0.5264453027543243,
      0.48812293006317103, 0.5116103290349645, 0.5974038106875279,
      0.7176248204262224, 0.8235683819646911, 0.8593757495188141,
      0.7782376650944809, 0.5568390578202063, 0.20417267022105592,
      -0.2377270682590643, -0.7015126614603836, -1.108920568993507,
      -1.3883153703914148, -1.4910278210102366, -1.40241241318864,
      -1.1448699579805908, -0.7721041973374414, -0.35609023073458346,
      0.029939255492434425, 0.32820415447278173, 0.5086157566307915,
      0.5735594611281013, 0.5541778206208031, 0.4993084115673849,
      0.46011916713847756, 0.4745759111465846, 0.5558925936694248,
    ]);
    const expected = [
      [
        3.9928084570852826, 3.6983128927871647, 2.1558614464450656,
        3.6983128927871647, 3.9928084570852835, -1.8577924359954854,
        3.0373914267575683, -3.660921598620429, 2.118201164498245,
        1.180013159802806, -4.046360371539803, 4.000623683943296,
        -0.5661824257151722, -3.7016300772922506, 5.089495537591468,
        -2.1630665255802914, -2.648028549346381, 5.157324650000105,
        -3.45839854537895, -0.11897077172878602, 1.6027963936486265,
        2.2119594668203395, 1.9427276003835674, 1.9427276003835676,
        2.21195946682034, 1.6027963936486265,
      ],
      [
        0.11276520805082851, -0.2313772115324767, 0.0, 0.23137721153247665,
        -0.11276520805082862, -2.3336414847007427, 1.678613002836525,
        0.02301394207978613, -2.2254500161371022, 3.4453504542228144,
        -2.042578506371804, -1.6210678364636668, 4.542369180498449,
        -3.6471255225518058, -0.7602899579529798, 4.740188712075211,
        -4.483077616723553, 0.22899930583707762, 3.974030960997011,
        -4.524383554497346, -1.3281979719054666, 0.40577739329010454,
        0.1382225898504204, -0.1382225898504204, -0.40577739329010454,
        1.3281979719054666,
      ],
      [
        -1.8219251345214433, -2.7704040879950522, 0.0, 2.7704040879950522,
        1.8219251345214436, -0.7795130576120324, -0.984701647365619,
        1.7462470581169556, -0.9105304664005547, -0.7415129502273194,
        1.6890446111699553, -1.092687677208583, -0.4557037259401555,
        1.5313173018921793, -1.2072956747187593, -0.1458008639899002,
        1.2824480313992819, -1.2460410593494302, 0.16830092471912972,
        0.9572969389718872, -1.205371021251304, 0.46667996484924656,
        0.5753059680406998, -1.0867695824770218, 0.7306465515454317,
        0.15932599169129721, -0.8967155419985846, 0.9439129463025718,
        -0.265762226819408, -0.6463223225659029, 1.093601223269852,
        -0.6745494088743165, -0.35068008213573176, 1.1710264654607814,
        -1.0443130807532808, -0.10590543182504197, 0.08950431192272654,
        -0.0895043119227262, 5.551115123125783e-17, 0.0895043119227262,
        -0.08950431192272654,
      ],
      [
        -0.07006120316330156, 0.6181270442804505, 5.551115123125783e-17,
        -0.6181270442804505, 0.07006120316330154, -0.13032003944598086,
        0.0534807148612622, 0.024734213901304376, -0.13159156443444178,
        0.09479359564954692, 0.09634025058832796, -0.1257516442505714,
        0.029587277195010447, 0.04996839734135783, -0.13667016913606006,
        0.06048017186186194, 0.12415582219111315, -0.11306422580601125,
        0.003491425847640367, 0.07163593117871256, -0.13332789074944867,
        0.02270624201514143, 0.1446708372378515, -0.0931450707156504,
        -0.023101924136698815, 0.08836342869351688, -0.12186871151084117,
        -0.01624954725159858, 0.15661193923708305, -0.06714820909812558,
        -0.04844338330512088, 0.09910841135940862, -0.10309353221553247,
        -0.05404605792118741, 0.15921918005174962, -0.036619776712344926,
        -0.07085260100813406, 0.10322431623195405, -0.07824606041794796,
        -0.08842148712764558, 0.15229416665354872, -0.003405157383999824,
        -0.08882790502304383, 0.10049970562431484, -0.048931717102793315,
        -0.11732990587378957, 0.13621415811845827, 0.030463344236257378,
        -0.10114499428655851, 0.0911692861508897, -0.01701479091216912,
        -0.13906420797754376, 0.111911150520772, 0.06289142378445473,
        -0.10693828500447258, 0.07589615371265515, 0.01549961250062909,
        -0.15235802127206494, 0.08081712920119843, 0.09185258563228366,
        -0.1057595950229664, 0.0557265219081689, 0.04659137486551829,
        -0.1564604412135809, 0.044778742109029046, 0.11551477819205014,
        -0.09850107648018527, 0.14514279503494215, 0.08836187123689085,
        -0.08836187123689085, -0.14514279503494215, 0.09850107648018527,
      ],
      [
        0.0007882969432619902, -0.01092631428203547, 0.0, 0.010926314282035443,
        -0.0007882969432619624, -0.010462736209036538, -0.009686670844861911,
        -0.00021551270376948817, 0.007973651408800662, 0.006512014819540493,
        -0.003174530259688317, -0.011244220356314984, -0.009053190390109433,
        0.0022953953195625765, 0.012762614048429155, 0.012826401797827028,
        0.0025190857350582685, -0.00862723221017278, -0.010668925920974154,
        -0.002636512456020104, 0.006780381042428084, 0.007846686362184704,
        -0.0006688863204365354, -0.010256005476700775, -0.010942293655302165,
        -0.0010896220516071475, 0.010782568403540221, 0.013965698209000746,
        0.0057014593786685955, -0.006236628325838961, -0.010988863744701788,
        -0.004916357533533561, 0.005126491293713328, 0.008649969925484086,
        0.00184357623584544, -0.008647070103094717, -0.012147896754080095,
        -0.0043868100837133606, 0.008163560662785896, 0.014273467103609688,
        0.008564731308689497, -0.003432432379343653, -0.010617482999936256,
        -0.006904691356466236, 0.003120146541384372, 0.008872212440373332,
        0.004201988970878541, -0.006525278824106626, -0.012603622325142956,
        -0.0073984838664366, 0.005063603905270997, 0.013728958769804789,
        0.0109329669612215, -0.00038314059843799764, -0.009569203298584628,
        -0.008468620371734098, 0.0008930739076200567, 0.008502010287449985,
        0.006256971414133158, -0.004029225769903541, -0.012289508500534802,
        -0.009945345292903945, 0.0016693658369048014, 0.01236277952377085,
        0.01265924037259085, 0.002725968499009364, -0.007901385293821284,
        -0.009501432541804605, -0.0014079724999440935, 0.007566802826768679,
        0.007880061596638732, -0.0013192863888051298, -0.011232848132472877,
        -0.011877260481685817, -0.001815157941598311, 0.010255143080596107,
        0.013634764282855039, 0.0057041591866569055, -0.005711136731885294,
        -0.009929696068803423, -0.0036307454823946844, 0.0061309514191895675,
        0.008971745626477304, 0.0014326148698023122, -0.009506116013496588,
        -0.013082209116884104, -0.0051810025719352115, 0.007531105378901282,
        0.013795731791843235, 0.008366987017874361, -0.0031295853107819738,
        -0.009718274145065514, -0.005627423615350929, 0.0042914338646901085,
        0.009467584456549327, 0.0040538714802598325, -0.007222131215205707,
        -0.013492867206769945, -0.008226870856230029, 0.004353068770984514,
        0.013127439957784703, 0.010547744753312022, -0.0003139598765402457,
        -0.008872921950830198, -0.00726427586677543, 0.0021714368973309445,
        0.00934205939575354, 0.006382011405500376, -0.004526771637535454,
        -0.01309043191946272, -0.010771278987751084, 0.0009110086933674655,
        0.01166543112962376, 0.012107894326173263, 0.002562038407875642,
        -0.007440284384747517, -0.008430447564934967, -8.773622157008665e-5,
        0.008609904752403238, 0.008274785937486595, -0.0015897073052346389,
        -0.011905467807627204, -0.012663472896344737, -0.0025889844453118593,
        0.009493570027223452, 0.012945832278093455, 0.005318982644526668,
        -0.005505277541645433, -0.009045298131063292, -0.002335918426553868,
        -1.3877787807814457e-17, 0.002335918426553868, 0.009045298131063292,
      ],
    ];
    const result = wavedec(data, "bior3.5");

    const reconstruction = waverec(result, "bior3.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5047180577118837, 0.9297352791477178, 1.2121716222282428,
      1.3187671531613143, 1.2516391178028607, 1.0457255334854958,
      0.7587021970805815, 0.45600940386336547, 0.19480145325319564,
      0.010842787372604357, -0.08842964319798122, -0.1230699961498567,
      -0.13241349931424257, -0.1617869104172222, -0.24773217225083177,
      -0.405709939031241, -0.6236046380429736, -0.8628530687999816,
      -1.067045692922129, -1.1759057078341546, -1.1411310733593083,
      -0.9400520792830123, -0.5835507441240471, -0.11608756584030736,
      0.39236429665356465, 0.8606587953439533, 1.2136980462272529,
      1.3984095568584423, 1.3946491744671417, 1.2184479188631083,
      0.9169101295472681, 0.556125810442468, 0.20516584034228208,
      -0.07984226028603558, -0.2676386861146973, -0.35689842270716793,
      -0.37335707920486744, -0.35994532273788593, -0.36265988807652744,
      -0.41597127052292543, -0.5316636714654792, -0.6940989250091021,
      -0.8632240276630295, -0.9846276334923172, -1.004107679479163,
      -0.8830104507137051, -0.610349025133948, -0.20847394862474988,
      0.2693387868108057, 0.7489977979079707, 1.1510817464724663,
      1.408010549703716, 1.4787630065741852, 1.3575842898716926,
      1.0745973701109657, 0.6882224305459682, 0.2713185058331107,
      -0.10551208462990597, -0.3893551249185079, -0.5554181934498006,
      -0.6100333139094326, -0.5856964261265244, -0.5296315022571864,
      -0.48899466760328997, -0.49665794761610343, -0.5613265998753845,
      -0.6645980652550609, -0.7657576194247377, -0.8130882419525256,
      -0.7587644471905264, -0.5734378627721587, -0.25665330343680165,
      0.15974659239518585, 0.6163177221793921, 1.0378576673355475,
      1.3496227075742866, 1.4940127846003532, 1.443659580831507,
      1.2077110427642848, 0.8297675062049745, 0.3779739457249567,
      -0.07030412690113713, -0.44547898441159495, -0.700293462667401,
      -0.8184600809554071, -0.8154322347381237, -0.7313451708952324,
      -0.6181307211489193, -0.5242541008365078, -0.481080285770068,
      -0.4944130894328533, -0.5433831361425548, -0.5869411903493764,
      -0.5762304396770292, -0.4695708634599883, -0.2460840055343892,
      0.08570139631262053, 0.4866701141579733, 0.8938975680889313,
      1.2338862520769833, 1.439100555145136, 1.4637616377906264,
      1.2949977558643813, 0.9565602322689084, 0.5041334252208648,
      0.013333099808115617, -0.43671669179640216, -0.7802631282116859,
      -0.9782099844028724, -1.0246818939674855, -0.9454386527847668,
      -0.788754033062103, -0.6112466887005319, -0.46238226085347034,
      -0.3716474643263336, -0.34166130713745063, -0.34892584201517374,
      -0.3519283881814952, -0.3043963668297193, -0.1701615185560218,
      0.06434487392326721, 0.38335806213730067, 0.7427395105675235,
      1.0785979358534883, 1.3215684430273256, 1.4132697192516095,
      1.3208533218662142, 1.045981070742056, 0.6259139320056386,
      0.12633215362896544, -0.372453776218055, -0.7926107500786665,
      -1.0751060134829376, -1.1913516592774278, -1.1474545310168498,
      -0.9802040372911196, -0.7459839411352251, -0.5055359277676486,
      -0.30849557232735775, -0.18161809233851872, -0.12361702185733942,
      -0.1078093400867372, -0.09173695320973041, -0.03113189653933457,
      0.10553035770001018, 0.3258028745132812, 0.6084299405364009,
      0.9063270984670094, 1.156791509763246, 1.2964788152117417,
      1.2774206348712736, 1.080032652975041, 0.7197630877917028,
      0.2455825406701599, -0.2694695125035725, -0.7434949028372104,
      -1.10308425828792, -1.2986491570214838, -1.3140867617545338,
      -1.1685330501646023, -0.9099225237390183, -0.6020941712135386,
      -0.30875771612630215, -0.07836674705841429, 0.06634475238631155,
      0.13164111692687286, 0.14822163553450693, 0.1601760901950548,
      0.21047995674197245, 0.326930149791456, 0.5122997632112333,
      0.7413969973788171, 0.9659276449168224, 1.1260364562375407,
      1.1656557424526897, 1.047765459300904, 0.7656309694418542,
      0.3470465229332324, -0.1496651351784989, -0.6470960155927237,
      -1.0649752747765997, -1.3373018666572647, -1.4262754619297544,
      -1.329694938953804, -1.0801038777943275, -0.7359972205069668,
      -0.3673517363711072, -0.03911657430696014, 0.20324404540941943,
      0.34263711932074675, 0.39159066095814266, 0.3857645937176995,
      0.37159441239273355, 0.39142408144093976, 0.470104612537122,
      0.6066341954156469, 0.7730980111624216, 0.9212671138808466,
      0.9952198045958404, 0.9467645428754161, 0.7496755359833892,
      0.40899901512445147, -0.03710885826953453, -0.5236936552018373,
      -0.972099960898773, -1.3067739226651294, -1.4717370881184784,
      -1.4427490019529965, -1.2322217340821358, -0.8857281595648381,
      -0.4710114297626987, -0.06223754156015743, 0.2766233311155256,
      0.5052331249317625, 0.613932852336124, 0.6228376094070387,
      0.5734411683137625, 0.51508299385552, 0.4899109154370292,
      0.5203197237426498, 0.602174215079059, 0.7056077034625959,
      0.7832112759046596, 0.7834988345892466, 0.6661405805584506,
      0.41495917062410814, 0.045207912438286424, -0.39693090597866443,
      -0.8427339688677956, -1.2153189722972118, -1.446592481327209,
      -1.4926516154711404, -1.3438715146589004, -1.0271984441636537,
      -0.6000785024387066, -0.13750545415478588, 0.2846467488910366,
      0.6059519567754498, 0.7934904333623899, 0.8468129728883795,
      0.7947889306985199, 0.6853621725530907, 0.5710098403283645,
      0.49374881002238, 0.4736008379960318, 0.5034962892847874,
      0.5519073781209846, 0.5724863154301736, 0.5181555250562634,
      0.355922390771561, 0.07847025652776302, -0.2906309534425212,
      -0.6996456333770091, -1.0788621120339679,
    ]);
    const expected = [
      [
        4.279541469035164, 3.6923828158754834, 2.3126085567393004,
        3.692382815875482, 4.2795414690351645, -2.2863478833621387,
        2.8619572496627383, -2.048475658857005, -0.5162325930223204,
        2.6860928521620937, -2.2383769968482112, -0.6447918793927402,
        3.1215001991367526, -2.371559239823615, -1.1425220968214655,
        3.6749719191345553, -2.178289625309489, -1.9262710141936474,
        4.231391977979146, -2.923540743510017, 0.8354572989963751,
        0.01104907846911108, -2.050389365943021, -2.050389365943021,
        0.011049078469110931, 0.8354572989963751,
      ],
      [
        0.046368766322469945, -0.24287469728278827, 5.551115123125783e-17,
        0.24287469728278832, -0.04636876632246989, -2.631060269560522,
        0.8232101305779526, 1.8118140520534909, -2.9735233123281755,
        1.3852344531451066, 1.903204749101154, -3.708109017289324,
        1.6262295365596922, 2.7103799463763494, -4.511397124015994,
        1.165245469554517, 3.9741708923277064, -4.841490003219517,
        -0.034815806658609505, 5.4606622084396035, -0.221073668710002,
        1.7694631668780025, 0.6877997816390317, -0.6877997816390317,
        -1.7694631668780025, 0.221073668710002,
      ],
      [
        -1.8573347569135075, -2.8309262531769024, 5.551115123125783e-17,
        2.8309262531769024, 1.8573347569135077, -0.884233998198831,
        -0.8290752313900296, 1.7507976068233726, -1.2109077174616538,
        -0.339668850759105, 1.60031967312817, -1.520052373807561,
        0.17987724306037514, 1.288170406278112, -1.6650177641432662,
        0.6636146050193406, 0.8550194770727738, -1.6287467821654,
        1.0503476995309744, 0.35747547066197005, -1.4181979122637176,
        1.2918574543304884, -0.13946207080926232, -1.063408280559069,
        1.3593210293317632, -0.5710693202282773, -0.61347824982146,
        1.2471436544015837, -0.8815272659577726, -0.13001332589582995,
        0.973691346943818, -1.031361970412215, 0.3211016137880219,
        0.5788174652060556, -0.9990623434793597, 0.6884204769313127,
        2.1120915219244303, -2.1120915219244303, 0.0, 2.1120915219244303,
        -2.1120915219244303,
      ],
      [
        -0.07364563271658497, 0.6284752468220142, -2.7755575615628914e-17,
        -0.6284752468220142, 0.07364563271658499, -0.13062596486389966,
        0.040072846078667915, 0.030893105527532723, -0.12049281259945141,
        0.08889492485465589, 0.10610725287755496, -0.13212043157837228,
        -0.0026654038684252868, 0.06889533215044646, -0.10876642944702708,
        0.04469650476402284, 0.13510779266267842, -0.11678920316292296,
        -0.04957805864233131, 0.09425523892764828, -0.08138522640917137,
        -0.0008928754783746329, 0.1494274040733939, -0.08716474346372355,
        -0.0944862753062185, 0.10380291496709632, -0.04171247381386592,
        -0.04171968365107767, 0.14693531249283442, -0.04748674156417737,
        -0.1314600498631044, 0.09649117342779154, 0.005242837671412981,
        -0.07228453793659037, 0.12773116036441187, -0.003329875667686888,
        -0.15560915065753167, 0.07353435319763824, 0.05349315135443283,
        -0.08847614608998926, 0.0941326519904164, 0.03914109396418555,
        -0.1637354011789024, 0.038245338491923825, 0.09687008719891649,
        -0.08811996909917487, 0.05036731120852059, 0.07399493071255564,
        -0.15475928528835514, -0.00440745487256991, 0.12984634242600102,
        -0.07126840600276305, 0.0020094737082230335, 0.0963263358924639,
        -0.12986395751934127, -0.04846401550001371, 0.14827209630707966,
        -0.040193783129431865, -0.0447623735894222, 0.10291144328811709,
        -0.09233744465154212, -0.08776900805476198, 0.14992767213399516,
        0.0009149167851443679, -0.083988824499488, 0.09331523607763151,
        -0.004933182900922761, 1.8388068845354155e-16, 0.028313045652233138,
        -0.02831304565223315, -1.8388068845354155e-16, 0.004933182900922761,
      ],
      [
        0.0003742797255415209, -0.011115726038884916, 0.0, 0.011115726038884888,
        -0.0003742797255414654, -0.010195736769519431, -0.010103548173346799,
        -0.0013146795466923017, 0.006953551584743454, 0.0064597638864949194,
        -0.002141750906267975, -0.009971891778049205, -0.008538675038531313,
        0.0019236872719068654, 0.012369623792396811, 0.013275555757927566,
        0.0035610167562983575, -0.008326949471104489, -0.012210121694362613,
        -0.005526005081462476, 0.004549455935466143, 0.008131150767130224,
        0.0020831721781512796, -0.00708043759380203, -0.009581661578547132,
        -0.0019422317736013384, 0.009417953804955081, 0.014039841702021182,
        0.007251592354746539, -0.005325039180111568, -0.012879779369063343,
        -0.009354000225358802, 0.0011193542216889757, 0.008348097736537607,
        0.005811008026982145, -0.003253143587308008, -0.009142363962538008,
        -0.005188108279299386, 0.005629036389476733, 0.013294035034934433,
        0.01018234795432893, -0.0016171437504082231, -0.01204644340580191,
        -0.012301488458529075, -0.0028792470151780443, 0.007094976308304815,
        0.008567520604171958, 0.0010259789676875797, -0.007256548204946214,
        -0.007368056313147048, 0.0015076820810634856, 0.011123599289902884,
        0.011938722123352133, 0.0022754243933770235, -0.00984369682525471,
        -0.013987288461610459, -0.006911301460236696, 0.004553731587048249,
        0.010008858528769454, 0.00521256399845571, -0.004153889464936486,
        -0.008179913564300832, -0.0023986330008215206, 0.007802664444203362,
        0.012262096902018293, 0.00580683913909813, -0.006586870455403265,
        -0.01419702269633602, -0.010435615249452267, 0.0010795476222957012,
        0.00996733529771382, 0.008774412942214649, -0.00022741719815526362,
        -0.0075056015135605975, -0.00557280184095052, 0.003757514764674198,
        0.011084400583148753, 0.008479691684742857, -0.0027308849737546215,
        -0.012911677173328168, -0.01297706619353349, -0.002846606359853343,
        0.008473702763621749, 0.011262394385334523, 0.004018838492410054,
        -0.005426918852291823, -0.007597062596638841, -0.0004902183696843011,
        0.008537290382144638, 0.009911460754590401, 0.0011905269330448054,
        -0.01031010212994185, -0.014190014448409241, -0.006682217295656115,
        0.005752946536997039, 0.012370262020744843, 0.00803701461463932,
        -0.0022146608306631054, -0.008208713314026617, -0.004393079718649967,
        0.004934689437437412, 0.009885653140188203, 0.004636108971437236,
        -0.006745120123129611, -0.013904444290878046, -0.009895685819985775,
        0.0021941647010909338, 0.011975410426682598, 0.011308435944412082,
        0.0017074838994297625, -0.007335131919472632, -0.007450753996092407,
        0.0007310076432840845, 0.008380790965730661, 0.007129368581756515,
        -0.0026964293190753497, -0.012148680649694238, -0.01203733240003732,
        -0.0017014509558856972, 0.010155131442260712, 0.013412746457782704,
        0.005819442164170602, -0.005103429233251314, -0.009276735719500218,
        -0.0035393799235133305, 0.005573377778027702, 0.008322218335449535,
        0.0012934142768412232, -0.009145649415825893, -0.061769008351379044,
        0.06176900835137908, 0.009145649415825893, -0.0012934142768412232,
      ],
    ];
    const result = wavedec(data, "bior3.5");

    const reconstruction = waverec(result, "bior3.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.7", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5021077125142638, 0.9254168920989156, 1.20769652517081,
      1.3159064750522034, 1.2519092138488621, 1.0500112716694538,
      0.7670889250172745, 0.46786674585165, 0.209079907109383,
      0.026473171195434797, -0.0721805462563695, -0.10642371105550144,
      -0.11516363060115423, -0.14363511695589248, -0.22877774776704562,
      -0.38692743011696545, -0.6071243314355605, -0.8518970196989897,
      -1.0654605949570033, -1.1873509420493211, -1.1680932572949299,
      -0.9829327081288637, -0.6400859151927407, -0.18129942015436065,
      0.3256049724838032, 0.8005315639358462, 1.1680107240757192,
      1.3731692547718097, 1.3929607419618766, 1.2400074526042948,
      0.9582213216732312, 0.6113877639052752, 0.26760889224770185,
      -0.016514638720995123, -0.20807462824253928, -0.30349311004300256,
      -0.3263696498828601, -0.31828847883222433, -0.32512036909264813,
      -0.38248597828860953, -0.5042418789183372, -0.6770598613756917,
      -0.8625952718139669, -1.0067800788884733, -1.0539275200966765,
      -0.9620664307377125, -0.7155578015379908, -0.3316795327734061,
      0.1406581193802532, 0.6299528418333824, 1.0568559008786642,
      1.3511362481577662, 1.4668015226484146, 1.3917471046529548,
      1.1496378231382538, 0.7936286518787735, 0.39352602099145795,
      0.019582330921608104, -0.27309321125365793, -0.45572917443630157,
      -0.530058967697364, -0.5246224459942804, -0.484355472799437,
      -0.45630685257719583, -0.47527881062705934, -0.5531752866381148,
      -0.6748668482214636, -0.8016902829409552, -0.8817236507266967,
      -0.8642149572761526, -0.7144419413506874, -0.42512240063627976,
      -0.021322162949657775, 0.44258418670942556, 0.8933589188846099,
      1.254347152626671, 1.4622421636502918, 1.4811256660695022,
      1.310380794017634, 0.9845644078919312, 0.5652901976396947,
      0.12712463330666152, -0.2590524186773726, -0.5411824108051474,
      -0.6960360984317601, -0.7317889792697732, -0.682740067481333,
      -0.5977229331083116, -0.5253263375107049, -0.4998123328118842,
      -0.5314007627707804, -0.6034387421995244, -0.6771847836972346,
      -0.7029636073150387, -0.6347896741730537, -0.4446359209411278,
      -0.13257417197278698, 0.26997461971850456, 0.7049214116279222,
      1.099164619028141, 1.380491046844947, 1.4938932457306184,
      1.414325810045196, 1.1527662781302384, 0.7540726483120986,
      0.2871340083732976, -0.17030670776358023, -0.5484878985341674,
      -0.800074441934304, -0.9087921175752638, -0.8903036370060141,
      -0.7853261447419944, -0.6469225458886787, -0.525331749588011,
      -0.4542777953127368, -0.4422732905434588, -0.47111900237713356,
      -0.5019331072049054, -0.4870943911910751, -0.38494762279584444,
      -0.17338603319232165, 0.14131760044733427, 0.5228761240055513,
      0.911180447600442, 1.2349626978634705, 1.4279133597840503,
      1.4443227094506514, 1.2703836850771515, 0.9283268150692929,
      0.4723019547678368, -0.023058249183360302, -0.4786663059193266,
      -0.8277559966055406, -1.0294007341755085, -1.075598425230923,
      -0.990360615676087, -0.8212350805779669, -0.6255607723376384,
      -0.4550342132570956, -0.3425381092748644, -0.29455631941541466,
      -0.2910358855948838, -0.2926286543641386, -0.2533408097145855,
      -0.135220583470819, 0.07882328339505834, 0.37752014523980665,
      0.721158895498638, 1.0491513905358776, 1.2935016027224313,
      1.394914157874824, 1.3175589911886345, 1.058789044243411,
      0.6513187138354242, 0.15721165132108, -0.3449616923066949,
      -0.7767563334455765, -1.0763060319436815, -1.2106838792318018,
      -1.1812805252760192, -1.0210461389106817, -0.7844545627168554,
      -0.5328333122919151, -0.31881520927600976, -0.17383048342865126,
      -0.10173508674116472, -0.08007273253302626, -0.06850051181343084,
      -0.02206897204795749, 0.09419768691481512, 0.2933123057549192,
      0.5601601139142445, 0.8529070367675129, 1.11179057082281,
      1.2732008126731693, 1.2855753228539573, 1.123117420094629,
      0.7938364872295385, 0.3397819490452697, -0.17074180600140668,
      -0.6572126445939366, -1.0438647816625943, -1.2755551772481357,
      -1.328750186077985, -1.2150666303934576, -0.9766394729666132,
      -0.6745981768192053, -0.3736132994743504, -0.12640518460323175,
      0.037942214412499176, 0.1190310417612151, 0.14244782662865021,
      0.15018157733602727, 0.18678685437434844, 0.2849959887660078,
      0.454616688776911, 0.6777036629008255, 0.9113802105705667,
      1.0977159511672911, 1.178238499494843, 1.109433451749089,
      0.8752801786500881, 0.4935617977406329, 0.014206302512891886,
      -0.49011652781920456, -0.938993478369154, -1.261313884537737,
      -1.4102938072819025, -1.3728956734459739, -1.1714350063069456,
      -0.8570846164973491, -0.4969703742788927, -0.15810623872151064,
      0.1078471504286827, 0.2752775742701957, 0.34823753277585345,
      0.3562656285594356, 0.3436801727993476, 0.35526192179528504,
      0.42214369248295996, 0.5516504566605851, 0.7238045384458363,
      0.8954879431801461, 1.011274021018123, 1.018205227843509,
      0.8807431188568625, 0.5920191044972862, 0.1783981772338864,
      -0.3039862634585069, -0.7800716849230631, -1.1715781630506032,
      -1.4138579153163677, -1.469839309601273, -1.3377169607458694,
      -1.0505657019540449, -0.6680330129909361, -0.262198470370679,
      0.0989024387238781, 0.36605954084025055, 0.5184163090159499,
      0.5655439184069861, 0.541756472238213, 0.49432141427708204,
      0.46874638676922714, 0.4950361733870842, 0.5785332929912217,
      0.6977561892663068, 0.8098346958553279, 0.8621735438448378,
      0.8073502705247309, 0.6173864869123795, 0.29364290496956014,
      -0.13034605442102493, -0.5940283916198317, -1.0219090055360605,
    ]);
    const expected = [
      [
        5.790064889477756, 3.804165214204706, 3.5074257909777855,
        3.751989564915013, 3.5074257909777855, 3.8041652142047053,
        5.790064889477756, -4.0733882909880075, 2.906028564717801,
        -0.6007239063514604, -1.726498533662226, 2.2372476188226784,
        -0.6197328709176635, -1.5177951033685548, 2.1936083601665084,
        -0.7918138776104767, -1.4181362240674993, 2.3399454848066106,
        -0.9654798275520318, -1.5181008439061214, 2.8981905406422808,
        -2.4621132560134282, 1.987062846764159, 0.7271332890763865,
        1.1056534016820452, 0.28451734082418834, 0.2845173408241883,
        1.1056534016820454, 0.7271332890763866, 1.9870628467641587,
      ],
      [
        1.2355988061696686, 3.6510925229837197, 2.6395096199788535, 0.0,
        -2.6395096199788535, -3.6510925229837197, -1.2355988061696688,
        -3.6521743488211458, -1.8188963995869885, 4.0778235966497745,
        -2.226074634717526, -1.3471484794364932, 3.272964689514443,
        -2.272089508532835, -0.5562536473372471, 2.974071291740462,
        -2.9296512089019036, 0.037893521587062606, 3.3861935974230017,
        -3.749636833053816, 0.01698835625267081, 4.8133066934561235,
        0.18615599737398392, 0.5783721892790473, -0.5783721892790474,
        0.276843576766209, -0.276843576766209, 0.5783721892790474,
        -0.5783721892790473, -0.18615599737398392,
      ],
      [
        -2.440232101023867, -0.3302966283423535, -1.5731055789253443,
        1.0408340855860843e-16, 1.573105578925344, 0.3302966283423534,
        2.440232101023867, 0.506418166971213, -1.3115065915694528,
        1.2058305202097452, -0.0923801212730313, -1.1736476354247023,
        1.539753249275829, -0.6404547959761482, -0.8383559728984438,
        1.6793445757404084, -1.1470606069822646, -0.3593845856641086,
        1.60191533955588, -1.5322014617488908, 0.18821608580125643,
        1.3191663972189043, -1.735122964265068, 0.7185150987394497,
        0.875334178906097, -1.7239424137028567, 1.1483215802752313,
        0.340178973337051, -1.5007024122143502, 1.4103709771891413,
        -0.2020725199703006, -1.1010470449033203, 1.4639868579899642,
        -0.6660776777653172, -0.5885719600275567, 1.3015236142404822,
        -0.9975103974609536, -0.4703022270475439, 2.1193243213435133,
        -2.119324321343514, 0.20358496760909744, -0.2035849676090974,
        2.119324321343514, -2.1193243213435133, 0.4703022270475439,
      ],
      [
        0.07072375189068186, -0.6253419555357158, 0.0732257905784158,
        5.551115123125783e-17, -0.07322579057841583, 0.6253419555357159,
        -0.07072375189068175, -0.07152665559817284, 0.09045705272449994,
        -0.07493671469762142, -0.04950251400317984, 0.16017893258267396,
        -0.025240700640838304, -0.11319223001569123, 0.08315662699789914,
        -0.026655046350396727, -0.08393170109354256, 0.14299387014800752,
        0.024208087953022386, -0.14049303327553864, 0.057070487973125174,
        0.023804258499712128, -0.10149156840900682, 0.10874182686545772,
        0.07183061777323849, -0.149120348635513, 0.016345849411023766,
        0.06851606391051179, -0.09933831714638067, 0.06283913876023353,
        0.11000508555823227, -0.13776675547592532, -0.0325486942060903,
        0.10046663327881394, -0.07775352312765571, 0.012547800606282827,
        0.13260691288031767, -0.10829127148568046, -0.08184849383449933,
        0.11466534835928271, -0.0400995161412597, -0.034175615285436126,
        0.13597955446432836, -0.06542467231089932, -0.12372360717420083,
        0.1089357478833699, 0.007713564826777652, -0.06994113613504317,
        0.11951410371269787, -0.016019614888365674, -0.15151990967473017,
        0.08426049987591211, 0.0581645644942862, -0.08909675503448869,
        0.08574582335458694, 0.032035574125818256, -0.16081382928699584,
        0.044625626819507574, 0.10331346320249313, -0.08862431569149125,
        0.03995230034120606, 0.07106727166693463, -0.15011352112410153,
        -0.0036113247818906347, 0.13605992230588293, -0.06861791072824559,
        -0.010683079373618926, 0.09451797755492253, -0.12628614637711663,
        0.441487483243325, -0.031342804870168564, 0.03134280487016852,
        -0.441487483243325, 0.12628614637711663, -0.09451797755492253,
      ],
      [
        0.010054400201030433, 0.0003292416639395779, -0.011000992926188558, 0.0,
        0.011000992926188558, -0.00032924166393952237, -0.010054400201030433,
        -0.010029456378851137, -0.0013740703385671793, 0.0068779052249197704,
        0.006530056462148416, -0.0019374429827452022, -0.009861470260658589,
        -0.008745992295179472, 0.0014525070435313647, 0.011989314469001755,
        0.01334127180894247, 0.004074068916360918, -0.0077626067488140715,
        -0.012038866469537474, -0.005817402978206376, 0.004171853245572458,
        0.008108883520495352, 0.00244951909437513, -0.006778441189314172,
        -0.0098441218469668, -0.002764612377098935, 0.008646193452867795,
        0.014027006920752365, 0.008130377590407356, -0.0041833902595227734,
        -0.01234015002652894, -0.009742023507510938, 0.0003064263271759034,
        0.007943613444949316, 0.006152222377415029, -0.002674531059423349,
        -0.009178588978945718, -0.0061380865949925145, 0.004431054206315704,
        0.012946723784324488, 0.011191153509213625, 0.00010904750935103458,
        -0.010891864493915493, -0.012529908550526242, -0.0041063891025629705,
        0.006063266375516796, 0.008589360661776985, 0.0018066302061517797,
        -0.006848592113604154, -0.008129171594620788, 1.2696871858092207e-5,
        0.010268788966948716, 0.01276560998203094, 0.004427444041395834,
        -0.007929848701754894, -0.013743138941499228, -0.008367746439358476,
        0.00276880238701091, 0.00938028500738472, 0.005961624250045289,
        -0.0032172002495338414, -0.00841832080788936, -0.003907961536904661,
        0.006414723186624102, 0.012598499134908937, 0.008080413936001951,
        -0.003929839346265174, -0.013193312634942583, -0.01180271152301876,
        -0.0014145836264077838, 0.008405338545046132, 0.00913874037087542,
        0.0011461951711150276, -0.006955836532762744, -0.006708988158712258,
        0.001992387490671356, 0.010710571806072497, 0.01048204029453223,
        0.00046793823982463345, -0.010971407184828058, -0.013867244963817651,
        -0.0058207100831990655, 0.005824821956002257, 0.010841275538056805,
        0.00555613214930048, -0.0039697481480168925, -0.00794601567442798,
        -0.002300366971837744, 0.007395289463049553, 0.011244748512421757,
        0.004560252064627568, -0.007433358352896741, -0.014234436625935654,
        -0.009748004372605541, 0.002053583445668389, 0.010806264458243564,
        0.009319728129094679, 7.033163558402278e-5, -0.007422678129808746,
        -0.005786313307494399, 0.0031723093286066123, 0.010240741243075502,
        0.007692332502298033, -0.003143640751286453, -0.012846323417374794,
        -0.012570708288197532, -0.0023047390971487336, 0.009046160352659455,
        0.011846506223127051, 0.004527643416619723, -0.005221736553744576,
        -0.00791619411154424, -0.0012948843076291267, 0.007622256603559571,
        0.009361659639897851, 0.0012142065639244581, -0.009923076854926383,
        -0.013838066292092152, -0.006553400615264243, 0.005846859711270663,
        0.012741989334550008, 0.008699211837904508, -0.0016919607141847141,
        -0.008355782504329695, -0.005304146500703738, 0.0037974385352531614,
        0.009297617826757185, 0.004945927144072743, -0.0059281041023306336,
        -0.013345774481917067, 0.0, 0.013345774481917067, 0.0059281041023306336,
        -0.004945927144072743,
      ],
    ];
    const result = wavedec(data, "bior3.7");

    const reconstruction = waverec(result, "bior3.7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.7_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48803164325076587, 0.899851695310123, 1.1756093587155827,
      1.2842242434121869, 1.2288792656906489, 1.0443547134639095,
      0.7869892552667613, 0.5198765161381925, 0.29706623143000344,
      0.15074683257397925, 0.08459184107746132, 0.07485857402323842,
      0.07883869836993326, 0.048379702559072424, -0.055099842728222936,
      -0.24806238950812354, -0.5181066158564158, -0.8248844851394616,
      -1.1085836359294121, -1.3039394217234324, -1.3563087593471614,
      -1.235776197301693, -0.9457154728677228, -0.5235857449815176,
      -0.033661351193929885, 0.44660434963169615, 0.8432994745856907,
      1.101813737111483, 1.1978397341585554, 1.1410102642432849,
      0.9704064369847274, 0.7431949214335529, 0.5193513205178724,
      0.3463741147964309, 0.24785339914103005, 0.21874347856137194,
      0.22845689067334643, 0.2308886744315153, 0.17870242926388355,
      0.038113850904448854, -0.1997294017415714, -0.5138152647271974,
      -0.8561905304235514, -1.1621474939198029, -1.3652215937589598,
      -1.4132988562720292, -1.2818114782237922, -0.9806910159380998,
      -0.5532797525901518, -0.06738844748886727, 0.39936589095963065,
      0.7763937279015508, 1.0150605681102665, 1.0981195165481377,
      1.0414430162896637, 0.8877766394138573, 0.6942266499940235,
      0.5167419687223538, 0.39557149558813837, 0.3453901527508803,
      0.35256654847992874, 0.3802022016776849, 0.3795740676384941,
      0.30496485443821686, 0.12798664962874046, -0.15238417711210195,
      -0.5067663869759045, -0.8802638682062013, -1.2042067485893684,
      -1.4119112439306734, -1.454579303470231, -1.3133848176600962,
      -1.004712234500736, -0.5771967369286236, -0.1012408714637471,
      0.3464575590337041, 0.6996041211056778, 0.9161834134058202,
      0.9861862516623495, 0.9314147746323711, 0.7975803294312266,
      0.64083317808168, 0.5122389744465231, 0.444199379551315,
      0.4422836269039175, 0.4845305529858275, 0.5283540283646405,
      0.523227250924897, 0.4258290133410422, 0.21368626405139313,
      -0.10629265955363126, -0.4967204575543855, -0.8965187797849925,
      -1.2340409744565912, -1.4433597246602825, -1.4797211365846445,
      -1.3303399211123415, -1.0178435749134145, -0.5954837016012425,
      -0.1352660201868557, 0.2881029316337023, 0.6135328531430777,
      0.8061698773220434, 0.8633074916139671, 0.8122731791729312,
      0.7009940661785858, 0.583775434504261, 0.5060081901513829,
      0.49175868925766764, 0.5374288750915995, 0.6131018304949309,
      0.6712067574156155, 0.6602502117624851, 0.5400455233883172,
      0.2944635425488864, -0.06166986020104365, -0.4834412318705894,
      -0.9044381882327386, -1.251060496126808, -1.4590935561984093,
      -1.4884863779902724, -1.3326940545700654, -1.020275199898875,
      -0.6083447880466422, -0.1694933587706362, 0.22460968218699653,
      0.518910591711694, 0.686151261026573, 0.7308803647223538,
      0.68545875338763, 0.5992398801763184, 0.5238154688006298,
      0.49818742360113255, 0.5377156743642257, 0.6297029135647774,
      0.7367625574727512, 0.8071105837364342, 0.7891335144565496,
      0.6464672464631398, 0.3696588642882464, -0.01868094625683686,
      -0.466702804129646, -0.9035839055861127, -1.254816537610981,
      -1.4588215568333003, -1.4808303507716531, -1.32063532233998,
      -1.0123166208043135, -0.616033869752674, -0.20392908247433988,
      0.15637010407424662, 0.41659057613267214, 0.5573902693355197,
      0.5904146275297593, 0.5524864024919811, 0.49356896782093707,
      0.4617058516971357, 0.488883965099548, 0.5815083026043053,
      0.7179788364676414, 0.8540298300960305, 0.9344918294855938,
      0.9084740301472418, 0.7440613920024379, 0.4387070446686032,
      0.022556669003961388, -0.4462968563602747, -0.8936061130996322,
      -1.2450097199148487, -1.4424397183779403, -1.4569015629223578,
      -1.2945178147781895, -0.9943889096887374, -0.6188466862678198,
      -0.23855131195458162, 0.08386029509297, 0.3075409301338322,
      0.4212669124180509, 0.4435143019601461, 0.414926163130427,
      0.38524538610134934, 0.39817969869069436, 0.4781730662587383,
      0.6225535501279766, 0.8011404160004381, 0.9634745724968787,
      1.0518723741062523, 1.0169912126493053, 0.8319199252858291,
      0.5011407247141538, 0.06197030791116992, -0.42203995419999024,
      -0.8742519057547142, -1.2214967632039857, -1.4100337490741763,
      -1.417039170633437, -1.2548547172475284, -0.9670156367766691,
      -0.6171126719965381, -0.2733059365840533, 0.007637968369542614,
      0.19283525370273624, 0.27926277032750024, 0.2918581346914052,
      0.27438346234380584, 0.2755299701998102, 0.3339414547621772,
      0.4660973923585996, 0.6602554919888838, 0.8780969891217667,
      1.0637400177258132, 1.1578879412732472, 1.1135417188391485,
      0.9092681706325345, 0.5565922396312262, 0.09952817045117095,
      -0.39378074199378693, -0.8453727427387332, -1.1842952727873879,
      -1.3618792367936137, -1.3617680615891397, -1.2023094981661595,
      -0.9308126943524988, -0.6111866364246245, -0.308103208962362,
      -0.07166112229499882, 0.07364158900220841, 0.13294381177524817,
      0.13717913136696783, 0.1324791478918137, 0.16566468952396457,
      0.2696585625313869, 0.45266745125600927, 0.6940140771512397,
      0.9477984239450966, 1.1535595105428342, 1.251305003209907,
      1.19713219551022, 0.9754715257339567, 0.6047939850779963,
      0.13523473952895032, -0.3614068888021389, -0.8069306587863914,
      -1.1335865130976241, -1.2984394169453655, -1.2917916305991024,
      -1.137685318655525, -0.8864771810582441, -0.6014404514177334,
      -0.34281518002913053, -0.1533281323780855, -0.04879011983046638,
      -0.016058020418415975, -0.01875656960067027,
    ]);
    const expected = [
      [
        5.638994155104932, 3.7331213462193644, 3.4943209773363693,
        3.370907810648815, 3.4943209773363693, 3.7331213462193653,
        5.638994155104931, -4.1552891558795295, 4.03582069470076,
        -3.0365916831179245, 0.8001994735542076, 1.8376487633197063,
        -3.5559415729100845, 3.2299768605431844, -0.7309816743683578,
        -2.507942030346134, 4.177495206760133, -2.933298292630649,
        -0.3246650663608577, 3.202592702379883, -4.030935213154737,
        3.3732901191245386, -3.377939992249046, -1.02516008117733,
        -1.441633103019699, -1.4921515682774174, -1.4921515682774174,
        -1.4416331030196987, -1.02516008117733, -3.377939992249046,
      ],
      [
        1.4186688603692474, 3.5667497301374143, 2.6313188960841263, 0.0,
        -2.6313188960841263, -3.566749730137414, -1.4186688603692472,
        -3.5703214964091234, -0.047031439245604933, 1.8803754341993164,
        -2.5190920089231277, 2.48678930483592, -1.4055601793149914,
        -1.2136191457614272, 3.932400609716371, -3.9702924103544452,
        0.5234441438886603, 3.5778371221922907, -4.613446543121631,
        1.9810728897270806, 1.4999258192218554, -3.437895867173552,
        -0.38106087424132273, 0.0812984158966224, -0.08129841589662268,
        0.12723758242364203, -0.12723758242364205, 0.08129841589662268,
        -0.0812984158966224, 0.38106087424132273,
      ],
      [
        -2.344459159184957, -0.2961077580620799, -1.5179624211232163,
        -6.938893903907228e-18, 1.517962421123216, 0.29610775806207984,
        2.344459159184957, 0.59782852884506, -1.4193750266514231,
        1.2001706318539545, 0.10129816594574526, -1.4130231724959286,
        1.5480818187389176, -0.3235447151519129, -1.203302735136204,
        1.679827845100115, -0.7045154477617448, -0.8250947477718347,
        1.5753254037330802, -0.9824781416479786, -0.3356118373570823,
        1.2479455666374162, -1.1133579782166263, 0.19275180511171475,
        0.7427806868037116, -1.0749845685498347, 0.6831014045573366,
        0.13037376401110362, -0.8706862030292934, 1.0652429889315254,
        -0.5032102243708743, -0.5290684766433938, 1.285772221764192,
        -1.0685641365476237, -0.09997881268057762, 1.3155908664823874,
        -1.4897233469273443, 0.21674222197120607, -0.7168185783328876,
        0.7168185783328879, -0.5352119659113027, 0.5352119659113028,
        -0.7168185783328879, 0.7168185783328876, -0.21674222197120607,
      ],
      [
        0.07160743888541962, -0.6071465915290473, 0.06909604850115124,
        -5.551115123125783e-17, -0.06909604850115131, 0.6071465915290473,
        -0.07160743888541968, -0.06441260056603981, 0.09629224910463877,
        -0.0806897011398734, -0.059823777303033066, 0.15489402336953417,
        -0.019261469178331818, -0.09498793218266138, 0.09219778711778334,
        -0.04202238825505504, -0.10421735049099834, 0.13561037997083236,
        0.03449306769909585, -0.1118860673691075, 0.07378724069510939,
        0.002044113501534675, -0.1333550498418445, 0.09726241153169635,
        0.08402533562954873, -0.11228772653632038, 0.04391644053435373,
        0.044938529453741244, -0.14328069373838626, 0.0452513863175642,
        0.12217118897907059, -0.09584230262468493, 0.007194922712766699,
        0.08036244759341966, -0.13281391105365256, -0.013088546185097388,
        0.14332682982086475, -0.0647123465495392, -0.030716180448003144,
        0.1032143368559871, -0.10369124459587478, -0.06953126793715014,
        0.1442712275688659, -0.023285496070414052, -0.06396581092912368,
        0.11032640800413572, -0.06028828324427132, -0.11612614147716199,
        0.12465193226515864, 0.022448001678021023, -0.08740428410453713,
        0.10090762945873587, -0.008966235981257675, -0.14632540264513422,
        0.08706152210509205, 0.06576337336515575, -0.09736973534417656,
        0.07663046555932437, 0.04285992476007763, -0.15591073498803887,
        0.036690611825309444, 0.10018898533390364, -0.09225083161851479,
        0.041352016177879064, 0.08779529476123757, -0.1435871266305368,
        -0.019390451558393904, 0.12039158196771205, -0.0756053929929686,
        0.0756053929929686, -0.20416986565571685, 0.20416986565571682,
        -0.0756053929929686, 0.0756053929929686, -0.12039158196771205,
      ],
      [
        0.009959363640993174, 0.0005626654232780692, -0.01058022618628704, 0.0,
        0.010580226186287012, -0.0005626654232781247, -0.009959363640993202,
        -0.009554733597149062, -0.0006493929921689151, 0.007549837976682846,
        0.006820297574812175, -0.002192264707072178, -0.010573431591103105,
        -0.009659623664382694, 0.0005963981272804064, 0.011362204984620289,
        0.013065898403923373, 0.004296982382513845, -0.006908629406982336,
        -0.010602288884054734, -0.00417017901317121, 0.005407150517773164,
        0.008367972460355116, 0.0015648876043742946, -0.008477009573506434,
        -0.011749385528707232, -0.0043430150666200484, 0.0076619055863227925,
        0.013720878244845719, 0.008597445343583107, -0.002805878032994036,
        -0.010095056643615957, -0.007115067529431585, 0.002409712382438367,
        0.008613098827855922, 0.005018321348947655, -0.005193918300271258,
        -0.012139233076366732, -0.008626358150250063, 0.0028963885717820936,
        0.012445529514271275, 0.011719310863277238, 0.0017693905181806469,
        -0.008080700880607555, -0.009027217533026238, -0.0009845106948550841,
        0.007528235226535299, 0.007658179867272019, -0.0012212330538724364,
        -0.010797228896494475, -0.011654413212929204, -0.002260141158574619,
        0.009413642506019504, 0.013206374850960184, 0.006161351429967366,
        -0.004830862162753177, -0.009599908266719609, -0.0042543709058573825,
        0.005288613748698254, 0.009102840875878843, 0.002851257789728834,
        -0.00793965179408919, -0.013010805991207509, -0.0070800817363934065,
        0.005048497398293383, 0.012832315728089155, 0.009732218771502224,
        -0.0008040996621273694, -0.008724540350026816, -0.006894627759601174,
        0.002244588063457925, 0.00915420834050304, 0.006428325985811056,
        -0.003997042316111088, -0.012519821197518655, -0.010885757464314472,
        -3.669832682678953e-5, 0.010634819448179789, 0.011954990171880536,
        0.0034192262187332165, -0.006509404370794031, -0.00849297614214116,
        -0.001132253774561373, 0.007825150629874905, 0.008996308238568507,
        0.00045022732958119316, -0.010269467104694396, -0.013145359243776675,
        -0.005125559946882352, 0.006912045815359369, 0.012491070888999062,
        0.007220833866219578, -0.0032661368314691897, -0.008793383739190239,
        -0.0043211234163350876, 0.005335250470821215, 0.010197124226105456,
        0.004757266433481677, -0.006596722370960706, -0.01354783992737471,
        -0.009500117044460035, 0.0021817230604568583, 0.011241361359343005,
        0.0100350121441323, 0.0005344223051704997, -0.0077361221660045,
        -0.006831322639473454, 0.002075763398225669, 0.009878611604046461,
        0.008308335136818779, -0.0020373413331013224, -0.012046146481493436,
        -0.012542758902202036, -0.0028914609510644895, 0.00836315481030303,
        0.011432482034627073, 0.00433068159347659, -0.005468336990585035,
        -0.008276831275682992, -0.0014507505373087884, 0.008114053190622798,
        0.010605246500725987, 0.0027523356662785825, -0.008862728961261501,
        -0.013823980198163485, -0.007589913562705802, 0.004250094405180593,
        0.011185233138391565, 0.007553096403267595, -0.0023233976673584303,
        -0.006740353577251975, 0.006740353577251975, 0.0023233976673584303,
        -0.007553096403267595, -0.011185233138391565,
      ],
    ];
    const result = wavedec(data, "bior3.7");

    const reconstruction = waverec(result, "bior3.7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.9", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49191363624047957, 0.9077304461311348, 1.1873483550424733,
      1.2988601106569213, 1.2440969006968017, 1.0562880313256178,
      0.7905393775049637, 0.5095809004812362, 0.26836592864227293,
      0.10134305048416065, 0.015509112732013053, -0.00913068561843694,
      -0.011950378830636765, -0.039001675226798926, -0.12857042063332613,
      -0.29877705056789466, -0.5404910204344888, -0.8174873765148492,
      -1.0739412576352612, -1.247491312086972, -1.2846725127218959,
      -1.1548816426652517, -0.859356477771515, -0.4328463200314313,
      0.06256806044665605, 0.5501236490775698, 0.9545227369194416,
      1.2177469020983953, 1.3107865940405399, 1.2385386225369672,
      1.036800151511326, 0.7622214476040067, 0.4777913405395509,
      0.23749554517240057, 0.07394612995401506, -0.00800583773968716,
      -0.030194347781749772, -0.03301251964810192, -0.06243126889410633,
      -0.15558105592695343, -0.32867605807862416, -0.5704678538691494,
      -0.8430183949190251, -1.089728901548991, -1.2487157367415656,
      -1.268248315219246, -1.1204031542613866, -0.8094849720067582,
      -0.3730245005840076, 0.12502721059266797, 0.6073750525334571,
      0.9996519660102972, 1.2460244969947285, 1.3204313841935262,
      1.2308263612432973, 1.0155117336804136, 0.7325830104458957,
      0.44517770476048946, 0.20621953871958854, 0.0464271266908059,
      -0.03150256440916832, -0.051204314666984246, -0.05401944057941452,
      -0.08575741390636382, -0.18232813683213167, -0.3580109758505379,
      -0.5994591656799255, -0.8670878390693127, -1.1036232749598276,
      -1.247767829386525, -1.249615927080011, -1.0839727836427728,
      -0.7582026786907043, -0.31255229324153455, 0.1872687297167559,
      0.6635682110337988, 1.0430396468675625, 1.272132047013628,
      1.3277778742458288, 1.2209737465532842, 0.9924600201953514,
      0.701675777323012, 0.41179677849336327, 0.17459224033609627,
      0.01883370927546857, -0.05494049470295867, -0.07212438873284448,
      -0.07493493757481445, -0.10893980139256976, -0.2087652899121265,
      -0.3867307964591533, -0.6274144232082457, -0.8896536492741215,
      -1.1155999791028917, -1.244649023895418, -1.2288076020456795,
      -1.045653825094425, -0.7055988064646365, -0.25153494734984827,
      0.24918427592634868, 0.7186053328388544, 1.0846103270464584,
      1.2960242387874996, 1.3328134577272583, 1.2089981302227333,
      0.9676853151404781, 0.6695536569623125, 0.37770666941232217,
      0.14266857918364573, -0.008786335347941487, -0.07827916530616696,
      -0.09291853024542676, -0.09572296117763873, -0.13193836309014612,
      -0.2348466682265215, -0.4147855690717485, -0.6542848843234196,
      -0.9106763732954624, -1.1256379473982858, -1.2393645311706722,
      -1.2058593828368604, -1.0055128634061692, -0.6517648675716838,
      -0.19007866307282922, 0.31066607474753594, 0.7723906402305016,
      1.124291719408883, 1.3176596169466326, 1.3355295501950046,
      1.1949205554698383, 0.9412309138531734, 0.6362726614958076,
      0.3429667063643573, 0.11050398713418291, -0.03638518462870266,
      -0.10147829201317488, -0.11355091935752314, -0.11634767865142787,
      -0.15471334059481778, -0.26052703083752166, -0.4421264863250846,
      -0.6800236824095327, -0.9301192353244124, -1.1337194825039223,
      -1.2319233304532688, -1.180811038724087, -0.9636196581711327,
      -0.5967945186558828, -0.1282904065494719, 0.3716071067272519,
      0.824830536190437, 1.1620148278245552, 1.3370006560480816,
      1.3359216038609256, 1.1787657200005222, 0.9131430272619425,
      0.6018908087893324, 0.3076373361147897, 0.07815430251851052,
      -0.06391506320910156, -0.12449783925547965, -0.13398601780404706,
      -0.1367735357388311, -0.17722535408875162, -0.28576182128458943,
      -0.4687059692373953, -0.7045859081098991, -0.9479482003144785,
      -1.1398302875130137, -1.2223381540753717, -1.153705996608862,
      -0.9200470225521342, -0.5407833978227042, -0.06627772371431809,
      0.4319012937212105, 0.875833767279466, 1.1977140671393676,
      1.3540138256610423, 1.3339891151936718, 1.16056193267998,
      0.883470701163744, 0.5664680213001192, 0.27178001816994285,
      0.04567567318997201, -0.09132832562401583, -0.14729808918672693,
      -0.15418863010720116, -0.15696531794589907, -0.19943547042819754,
      -0.31050724489128206, -0.4944777500069339, -0.7279286876865484,
      -0.9641320335602477, -1.1439594912413495, -1.210625465681772,
      -1.1245912657343706, -0.8748706967267028, -0.48382895824478955,
      -0.004148553105204539, 0.4914436835432976, 0.9253115824344713,
      1.2313273772023057, 1.3686696484958276, 1.3297356254829689,
      1.1403410639264342, 0.8522657305814131, 0.5300660216392047,
      0.23545711786002926, 0.01312445907141685, -0.1185775387571692,
      -0.16983971020573813, -0.17412396418613352, -0.17688821124600274,
      -0.22130527047290577, -0.33472034477016055, -0.5193969525529861,
      -0.7500112578579259, -0.9786423554170967, -1.146099667559545,
      -1.1968054319573604, -1.0935173561564504, -0.8281692162305352,
      -0.42603029860200275, 0.05798896201575983, 0.5501306326549925,
      0.9731778874066181, 1.2627963307527756, 1.3809427514756778,
      1.323168714365622, 1.1181384899140772, 0.8195825693508361,
      0.49274822502100796, 0.19873179786823936, -0.01944286564531672,
      -0.14561556391147368, -0.19208382479933578, -0.19375769126655773,
      -0.19650786209892362, -0.24279691554092636, -0.3583590763938286,
      -0.5434201706591388, -0.770795036984237, -0.991453691066063,
      -1.1462468487359483, -1.1809018879092312, -1.0605381911161476,
      -0.780023775428415, -0.3674879906512709, 0.12002666190100475,
      0.6078599865767554, 1.019349394572189, 1.2920662349807337,
      1.3908119096628746, 1.314299986325035, 1.0939930306827739,
    ]);
    const expected = [
      [
        2.9738379910031574, 1.5017043559874543, 3.5565214468425794,
        0.9558286156741325, 4.456376044894485, 0.9558286156741326,
        3.556521446842579, 1.5017043559874534, 2.9738379910031574,
        0.6254746781011722, -5.049557358854918, 4.639493849397498,
        0.4862065423914577, -4.89056983418847, 3.9470185166919465,
        1.095042958450011, -4.632229064647839, 2.9571513676293524,
        1.7741062295788568, -4.169629137893655, 1.7180872640578964,
        2.523433622462805, -3.5909982842606682, 0.3405247810926883,
        3.3077990013069183, -2.975282455499171, -1.0456381871065732,
        4.0594649464447885, -2.377299322736723, -2.3114973833073877,
        4.688096648412479, -1.8195372409529174, -3.349003787357693,
        5.096724715820082, -1.2922046728805117, -4.088491636325459,
        5.2234737283186705, -0.8338414786442895, -4.461095182888928,
        5.288360851831025, 0.7252275680551341, 0.5189056206918561,
        5.9311779491730094, -6.5776679543938705, 5.9311779491730094,
        0.5189056206918561, 0.7252275680551342, 5.288360851831026,
      ],
      [
        0.07331383720126383, 2.419006466874361, 2.3924524168482284,
        1.6531704361226571, 5.551115123125783e-17, -1.6531704361226571,
        -2.3924524168482284, -2.419006466874361, -0.07331383720126385,
        1.0528974619149778, -0.6706018569553261, -0.10262626568529237,
        0.8823913455771605, -1.1390723888207865, 0.5818483065858415,
        0.5131803188622208, -1.3520480708069447, 1.1894915079452408,
        -0.019265012729855924, -1.2778462020244947, 1.5999038600675175,
        -0.5968979411795136, -0.9447374482100417, 1.7317822566329268,
        -1.0899865067522136, -0.4349664651707617, 1.5597840482450362,
        -1.384744376906011, 0.13307423547539832, 1.1197466352882062,
        -1.4076921933703574, 0.6302224508656215, 0.5011708806732805,
        -1.1416105089895932, 0.9441217736854279, -0.17145289525516197,
        -0.6297099819972819, 1.0005051113094245, -0.8405679970114946,
        -1.103241046393887, -1.6339961540431522, 1.6339961540431522,
        1.1032410463938878, -5.551115123125783e-17, -1.1032410463938878,
        -1.6339961540431522, 1.6339961540431522, 1.103241046393887,
      ],
      [
        0.12481995673924559, -0.0706801272310717, 0.6114643309809632,
        -0.06877821165747042, 0.0, 0.06877821165747042, -0.6114643309809632,
        0.0706801272310717, -0.12481995673924556, 0.03999734717692453,
        0.03623956211296014, -0.12472017373793448, 0.06949772815568944,
        0.11603507011660946, -0.11329812605104439, -0.009702440188226275,
        0.074258777707851, -0.11319540261242003, 0.008609716811081441,
        0.14873171912539268, -0.07660281984421594, -0.061436376550290495,
        0.09161641656712395, -0.07916840384875855, -0.05038819087287566,
        0.1553818373734127, -0.021992437130743447, -0.10353660248843699,
        0.08443154971454053, -0.030843570666616322, -0.09598417744548864,
        0.13470483977495823, 0.04006685926484627, -0.12620460275054046,
        0.054215506522363024, 0.020674457035257235, -0.11960761659026685,
        0.09092527457504823, 0.09741794492652915, -0.12362156313794359,
        0.0075542448924384165, 0.06375636544930396, -0.11738497474441095,
        0.032890515690548405, 0.13872788168876207, -0.09521797917657165,
        -0.04528601597870424, 0.08872747457368989, -0.09090520258575982,
        -0.027772582050122507, 0.15583723522691562, -0.04584280441680866,
        -0.09253645110444064, 0.08992824429617831, -0.0468359528139227,
        -0.07907544290384153, 0.1454513517636743, 0.015205604246295329,
        -0.12342809728239346, 0.06692179990009134, 0.004526515804041585,
        -0.11115305646407658, 0.1098192586665439, 0.07608534496048744,
        -0.13049200368261882, 0.024593938752060646, 0.05146687368711386,
        -0.11829608996382929, 0.05635573353625467, 0.12690562088160628,
        -0.39108967197638606, 0.0034980292097838706, -0.2926820146320474,
        0.29268201463204735, -0.0034980292097838706, 0.39108967197638606,
        -0.12690562088160628, -0.05635573353625467,
      ],
      [
        0.00971446778795284, 0.009741434467140292, 0.00032371131401995323,
        -0.01062464613347347, 0.0, 0.01062464613347347, -0.00032371131402000874,
        -0.009741434467140292, -0.009714467787952846, -0.0012368794415626855,
        0.006960411657588792, 0.0067680453018280125, -0.0016140674999422016,
        -0.009868534473682772, -0.00945137081318359, 0.000218809925072172,
        0.010974433381223142, 0.013310880150151513, 0.0051282124824931635,
        -0.006328104339414525, -0.011134957159307068, -0.005765053687636662,
        0.0038597405748968944, 0.00812658653163778, 0.0028662886857012404,
        -0.0067065628185326714, -0.01093958484488701, -0.004936220996528545,
        0.006634558797765505, 0.013663973929812168, 0.00987005349014769,
        -0.0014060347475491342, -0.010269932082169808, -0.009355680694821289,
        -0.00047676089885682893, 0.0073081813095118055, 0.006348033836565951,
        -0.0023593970593912134, -0.010124659136128825, -0.008822142673001104,
        0.0013018330137380685, 0.011615933536537032, 0.012958881492944552,
        0.004077802999473898, -0.00720194554473691, -0.011168002174135216,
        -0.00508613889545402, 0.004489070429194424, 0.0080553003761393,
        0.0021777816401711454, -0.0072765744121789724, -0.010713443572384088,
        -0.003963667344136279, 0.007582376936330515, 0.013780367512932601,
        0.009046550875206526, -0.0024784351405654492, -0.010726570246575612,
        -0.008931505827231123, 0.0002865711316272779, 0.007604673748802726,
        0.005883469995105348, -0.003088320916872691, -0.010309986083665582,
        -0.008131152005531828, 0.002375860168978422, 0.012176321380215765,
        0.012516375859169072, 0.002998978213070963, -0.008025358101830804,
        -0.011122950175402213, -0.004371742752295918, 0.005086852704552468,
        0.007927510365668848, 0.001473917583486157, -0.0077957433268517895,
        -0.010412340657367777, -0.0029632987533219635, 0.008477288658345294,
        0.01380051200556505, 0.008159893033423488, -0.00353342120123179,
        -0.011108167255641205, -0.008444922066797589, 0.0010477692947392162,
        0.007847813453565824, 0.005377608665365671, -0.00379572972720605,
        -0.010423206209247915, -0.00738322070016878, 0.0034333863064014425,
        0.01265167934249603, 0.011986455162277707, 0.001899276024617924,
        -0.00879259405494498, -0.011000128752905597, -0.0036268723058612423,
        0.005648901527188431, 0.007744112857301911, 0.0007596286703280067,
        -0.008260425725847724, -0.010038369833052896, -0.0019421031880798023,
        0.009313038747869623, 0.013724265438377195, 0.0072162756101832315,
        -0.0045636239903161235, -0.011412066378958197, -0.007899344380587453,
        0.0018015020593687425, 0.008035899201703233, 0.004833994601464553,
        -0.0044766640338539665, -0.010463514713370037, -0.006583569385305438,
        0.0044670209462539245, 0.013038683641951432, 0.011372821833554167,
        0.0007863796756124586, -0.009498298676267586, -0.01080040924673445,
        -0.002856747035622609, 0.006171282026717827, 0.007506394255836324,
        3.992077425875318e-5, -0.008667358595540964, -0.009594134777209717,
        -0.0009072149823804998, 0.010083784873792412, 0.01355215910161929,
        0.006222291858177742, -0.0055618483927497575, 2.7755575615628914e-17,
        0.0055618483927497575, -0.006222291858177742, -0.01355215910161929,
        -0.010083784873792412,
      ],
    ];
    const result = wavedec(data, "bior3.9");

    const reconstruction = waverec(result, "bior3.9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior3.9_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5043351990595442, 0.9302795534435915, 1.2155976414366247,
      1.3265887229003637, 1.2638342133296554, 1.0600715976640647,
      0.7708619660411095, 0.4604519321303496, 0.18636260832341894,
      -0.013508021384714575, -0.12816612664711038, -0.1735295002541512,
      -0.18535133653133315, -0.20703638233837662, -0.27560590869479623,
      -0.4095239183258966, -0.6016156589315427, -0.8190116588106665,
      -1.0102605763158723, -1.1179195568919238, -1.0935106471378724,
      -0.9110827849534018, -0.5759063685559678, -0.12598419932431537,
      0.374194733531828, 0.8463331852536378, 1.214523937360087,
      1.4211769735424424, 1.4389286723455605, 1.2757459223778649,
      0.9720775374018304, 0.5908211875521978, 0.20259496802202936,
      -0.13009393280691356, -0.365974634807944, -0.49234345576051053,
      -0.5249864294109937, -0.5009402807060833, -0.4661220933155878,
      -0.46112108463663076, -0.5088761500808572, -0.607455217888633,
      -0.7298357150329164, -0.8307898708194378, -0.8591538035040116,
      -0.7723624639090569, -0.5495144335488652, -0.19954858389642705,
      0.2377069084852834, 0.698103706549904, 1.1059642134997778,
      1.390140914815391, 1.4995511622375208, 1.4144823035487986,
      1.1509587205706042, 0.7571241887293823, 0.30251188969268794,
      -0.13722132898512696, -0.4964488364386453, -0.73279276146705,
      -0.8343434889569584, -0.8193210961651105, -0.728494850078354,
      -0.6124572292291172, -0.5170939208615067, -0.47099421373778616,
      -0.4780103224522439, -0.5168362372717746, -0.5476729115872796,
      -0.524228895954715, -0.4079290891737348, -0.1806143233706925,
      0.14763962767043787, 0.5377571308585851, 0.928371752420852,
      1.2485551546223843, 1.4335836236484558, 1.4399594686274362,
      1.2560334245641447, 0.9056044964564873, 0.44355407703593647,
      -0.05551089971802381, -0.5129472823038539, -0.8624036651183891,
      -1.0629602695972808, -1.1060547707961783, -1.0147031189727758,
      -0.8354133200693432, -0.6249658912950335, -0.4354593369635742,
      -0.30139210543094774, -0.23198555842865853, -0.21059051614589985,
      -0.20120519670312031, -0.16031913870629588, -0.050939302862753055,
      0.14490937007760896, 0.41854461265067133, 0.7339681902804792,
      1.0345496262674172, 1.255552411876243, 1.3395022528234806,
      1.2506332066455224, 0.9848143486766547, 0.5724198567816204,
      0.07330037112525327, -0.43507343822567424, -0.8735643410477052,
      -1.1776911392264813, -1.3105040105047334, -1.2690382068077384,
      -1.0829361509881248, -0.8057287610381046, -0.5010353377478148,
      -0.22714251728649504, -0.02376279219170835, 0.09582803377263494,
      0.14546396627952068, 0.1595902155757689, 0.18142134533248444,
      0.24892653839724205, 0.38235125489380284, 0.5765868030610479,
      0.8004647752870535, 1.0032904682372978, 1.1270788352679468,
      1.1214811992169695, 0.9576611882319748, 0.6375795901027551,
      0.19623431540422792, -0.30389244717334774, -0.7850227976009496,
      -1.17011686073833, -1.3990035775098222, -1.4408166102962898,
      -1.2998255966261947, -1.0133447201793446, -0.642310245516013,
      -0.2568764198108846, 0.07944682734401604, 0.3232875777856601,
      0.45934863124836217, 0.5010170976085389, 0.4837201606472337,
      0.4529097038992924, 0.4498842730693713, 0.49917055417236367,
      0.6007623285468319, 0.7292606061014575, 0.8401889902233591,
      0.8819164053675058, 0.8101664687713167, 0.6013938203650319,
      0.2615400920473202, -0.17220831768238248, -0.6373245713730579,
      -1.0582770271371302, -1.362459553863356, -1.4959620821463075,
      -1.4354266880592916, -1.1931546858180133, -0.814246112194543,
      -0.3664678256870121, 0.07471050527494766, 0.44233015499747386,
      0.6915610051261667, 0.807555551964362, 0.8058209756755236,
      0.7252503658543763, 0.6157621158035242, 0.5238053404154133,
      0.4794762407124554, 0.4885377728711124, 0.531358793637746,
      0.5690098851426966, 0.5549170734915905, 0.44904142844580053,
      0.23088148887718452, -0.09214378123327477, -0.4832437294245341,
      -0.8823285337909393, -1.2183142047256732, -1.4247905874491071,
      -1.4553037162801636, -1.2945450058338437, -0.9626948386215473,
      -0.5118044214443764, -0.015015728192767669, 0.44885625284219643,
      0.8117460322079972, 1.0299110533437523, 1.0915219231238595,
      1.0166161768992683, 0.8496371635169676, 0.6465846969114661,
      0.4600939825594313, 0.3262172744419397, 0.2561990812252955,
      0.23523482597952347, 0.22841180977839837, 0.19219863066166126,
      0.08843315080696679, -0.10288619540497052, -0.37541360649818656,
      -0.6951321019040141, -1.0064254120130343, -1.24420596896061,
      -1.3492076830089639, -1.2827095418246235, -1.0370356062304893,
      -0.639163309653033, -0.1464247200879697, 0.36480144453162977,
      0.814806981364283, 1.1370088230103086, 1.2912926637100828,
      1.2711587590054272, 1.1030947823121906, 0.8384891980665785,
      0.5401982888910306, 0.2671478355550806, 0.060776055077084834,
      -0.06339347256274552, -0.11708872263960496, -0.13338151461814515,
      -0.15521222561516956, -0.22142452376418847, -0.3540084316381067,
      -0.5499367057675828, -0.779810847558793, -0.993801048679895,
      -1.1335017444072724, -1.146797070200587, -1.0020215531830097,
      -0.6978159158225473, -0.2660917548120763, 0.23281565188867778,
      0.721820168465352, 1.1229194708777683, 1.373494772186523,
      1.4392466720951382, 1.3207408900989468, 1.0520782579499095,
      0.6921028056379394, 0.3103526475381057, -0.028799408583704666,
      -0.2799788742183024, -0.4253348186920104, -0.47583472465105914,
      -0.4652285843698876, -0.43841342995130655, -0.4373150666126559,
      -0.4879998482801589, -0.5923894124750695,
    ]);
    const expected = [
      [
        3.19438770025387, 1.496184756724477, 3.5320786594540032,
        1.033029582266442, 4.48010674150758, 1.0330295822664424,
        3.5320786594540032, 1.4961847567244775, 3.194387700253869,
        -0.15989443959848185, -4.489087941510978, 5.629938773173178,
        -1.8357293296811144, -3.5679083017607405, 5.697275555130939,
        -2.6621117942991, -2.715771341538767, 5.529978173998184,
        -3.291247129278644, -1.847800018531904, 5.150913791944288,
        -3.6797488533887646, -1.0670588844733855, 4.647104783618401,
        -3.834520144320442, -0.4507993194206801, 4.122122295163936,
        -3.8092521984564893, -0.03368570354684039, 3.672378448920675,
        -3.6910340653759475, 0.19895735788008312, 3.3652032654834123,
        -3.57936467699417, 0.30654993675316466, 3.2228523317557176,
        -3.5597506810937425, 0.3954087352125939, 3.054261327922164,
        -3.0169545943908913, -0.328392175415648, -0.7428251166336772,
        -1.7234680983558275, -0.8910100864999306, -1.7234680983558273,
        -0.7428251166336773, -0.3283921754156479, -3.0169545943908918,
      ],
      [
        0.046133588731813516, 2.5032241242751434, 2.519537380870857,
        1.7030008468349802, 0.0, -1.7030008468349802, -2.5195373808708577,
        -2.503224124275144, -0.04613358873181344, 0.9949671664398,
        -0.5652715037355509, -0.17314399768416905, 0.80763099420674,
        -0.9317690438118353, 0.43676003918680373, 0.3926571980354435,
        -1.0133411402936239, 0.9606793267113065, -0.19804019111011628,
        -0.7856254322047702, 1.2680850793620493, -0.8240641092495042,
        -0.2958210934408487, 1.2782576797632514, -1.3359531385571575,
        0.3475816965655696, 0.9789908947794153, -1.6096636481522943,
        0.9997379430341301, 0.4295161719484412, -1.5752080843456953,
        1.5127679192285608, -0.2530273986131413, -1.232853099709721,
        1.7697878473087536, -0.9204627270854001, -0.6531506414010644,
        1.7114275781389425, -1.4170632255828979, -0.06594649846925671,
        0.3285737893736217, -0.3285737893736215, 0.06594649846925693,
        -2.7755575615628914e-17, -0.06594649846925693, 0.3285737893736215,
        -0.3285737893736217, 0.06594649846925671,
      ],
      [
        0.12783563389686228, -0.07444992552110147, 0.6275563645064954,
        -0.06785695038589043, 0.0, 0.06785695038589049, -0.6275563645064954,
        0.07444992552110155, -0.12783563389686226, 0.031843662460988256,
        0.03692670185961873, -0.11488324848921548, 0.07600479743095645,
        0.11517826131608459, -0.12579301757908157, -0.02540758343510377,
        0.08117630063049046, -0.09045349284075689, 0.017878121245329087,
        0.14229265543137404, -0.09628589554792438, -0.08475478705660844,
        0.10118248390495943, -0.04261085481285995, -0.03631686104887187,
        0.14185424613928965, -0.0475974032605872, -0.1327009014376339,
        0.09301376936852279, 0.018442735954566386, -0.07398384722078259,
        0.11325902777169972, 0.008261267812180645, -0.15827203597621675,
        0.059283350345590485, 0.07942384247454254, -0.08642665330761161,
        0.06233583672998972, 0.057671107915304165, -0.15555341914507786,
        0.008538871283368055, 0.12701782457352206, -0.07085222074040656,
        1.2631275456143065e-5, 0.08855045226083355, -0.12505188577652523,
        -0.04671506701776501, 0.1509368787453857, -0.03101303524072222,
        -0.06019108034094939, 0.0931454898781177, -0.07358051952576727,
        -0.09290614572485748, 0.14628163219681534, 0.023658984331360322,
        -0.10526826590753502, 0.0698233614439602, -0.012692002067906015,
        -0.11852980026460319, 0.11466249613832813, 0.08022763688062144,
        -0.1257100908738824, 0.02345480472541306, 0.04397855352693125,
        -0.11680870460407043, 0.06382260683553653, 0.12523565089555821,
        -0.11766967950585688, -0.033966931401697126, 0.11243193918525729,
        2.7755575615628914e-17, -0.11243193918525723, 0.23336209444371364,
        -0.23336209444371367, 0.11243193918525723, -2.7755575615628914e-17,
        -0.11243193918525729, 0.033966931401697126,
      ],
      [
        0.010168392158379475, 0.009821905901588934, 0.00010278070977332021,
        -0.011001772181261638, 0.0, 0.011001772181261638,
        -0.00010278070977332021, -0.009821905901588934, -0.010168392158379475,
        -0.0019434529973840348, 0.006320331539159674, 0.006544497946510956,
        -0.0012683290011898107, -0.00909539814500486, -0.00856977239696402,
        0.0009316835797790746, 0.011400150395516034, 0.01341862723223566,
        0.004837250572188423, -0.007150407625599431, -0.012483633496372853,
        -0.0072957298007793325, 0.00279060287752635, 0.008117070308807886,
        0.00405506212462578, -0.004776961158132462, -0.009044581933285,
        -0.0036948836869156454, 0.0070406934324935, 0.01337803546988111,
        0.00903022174626586, -0.0028327372625550074, -0.01229184606865108,
        -0.011601258927840669, -0.0021053424019986423, 0.007207056287601266,
        0.00811152015242822, 0.0006809817655517719, -0.007035543935513297,
        -0.006819178910930493, 0.0017811619920874155, 0.010848155364512689,
        0.011441644235492557, 0.0020593185684828486, -0.009701751240346501,
        -0.013902276430154875, -0.007233663226875631, 0.0040686836256669245,
        0.010037472189467822, 0.0060985216932323005, -0.002943186986353888,
        -0.007691635576067474, -0.0031775715719940673, 0.006363648944850413,
        0.011443906079257993, 0.006322585112886164, -0.005369446785281451,
        -0.013695009036820083, -0.011398773111423949, -0.0005240983670365962,
        0.009463018778858412, 0.010303718921955612, 0.0023468527167907066,
        -0.006089110436230697, -0.006712066666908021, 0.0009030976468197213,
        0.008961642124520136, 0.00890047276126113, -0.0003466215856574306,
        -0.011045394831564859, -0.013618854533358454, -0.0054564491602211995,
        0.006596278078608159, 0.01240163597656413, 0.007667144361536399,
        -0.002366529043525894, -0.008034833766297642, -0.004335746500291102,
        0.004489949532215265, 0.009127170909461566, 0.004162270942701607,
        -0.0065736886367140646, -0.01335223404321461, -0.00953004391270372,
        0.0021745856748577874, 0.011979601295934506, 0.011836742249434956,
        0.002624692636900877, -0.006875391848431486, -0.008211121030140378,
        -0.0010187563480142103, 0.006881813840820275, 0.007077949770797093,
        -0.0013114999350829076, -0.010622480137444983, -0.011739767696080844,
        -0.0027062011340265313, 0.00920144032450071, 0.013932653169940662,
        0.007732664592658997, -0.0035421692812303285, -0.00989946204456904,
        -0.006373198316769718, 0.0026171041849458315, 0.007695337380164126,
        0.0035358106709361195, -0.006013409408898877, -0.011505965152006067,
        -0.006844972598851584, 0.004768981528716687, 0.013501977347202238,
        0.011770334617628844, 0.0011490033455893445, -0.009084282919401249,
        -0.010416704792212267, -0.002744207168074747, 0.005846326952408122,
        0.006866655285841239, -0.0005351460963685072, -0.00880874884416788,
        -0.009212870305968152, -0.0002402885900966989, 0.010665871047524228,
        0.013788993069280053, 0.006063334635067863, -0.00602823234397834,
        -0.01229271805638435, -0.008021152129429707, 0.0019387953379238678,
        0.007936748963761925, 0.004607923905510278, -0.02794739615865205,
        0.027947396158652063, -0.004607923905510278, -0.007936748963761925,
        -0.0019387953379238678, 0.008021152129429707,
      ],
    ];
    const result = wavedec(data, "bior3.9");

    const reconstruction = waverec(result, "bior3.9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior4.4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5005017545628421, 0.9236071548980858, 1.2078833473001207,
      1.320093579153204, 1.260876019898859, 1.062638353517132,
      0.7803225639514408, 0.4774081471867668, 0.21064418685357067,
      0.017257525209865898, -0.09228392556526968, -0.13429773722308802,
      -0.14487259328540647, -0.16775248742939836, -0.240335457343067,
      -0.38146869155684826, -0.5842619099978246, -0.8158700224448934,
      -1.0244306394293616, -1.151521631662884, -1.1470824048141204,
      -0.9830753856336101, -0.6624204104542868, -0.22085469129627666,
      0.27891887467448845, 0.7595524045148949, 1.1450135689678893,
      1.3764551853100433, 1.4242694936589722, 1.2935167138488928,
      1.0215149406282436, 0.6682670495281517, 0.30211629713534893,
      -0.015854975286410222, -0.2449134857457402, -0.3721508493131765,
      -0.4126760413528445, -0.40268267759286225, -0.38732531292211014,
      -0.406621439598808, -0.4830676564283871, -0.6142040070525767,
      -0.7720942657002929, -0.9099281209975895, -0.9741331236710697,
      -0.9189635545995857, -0.7198654603400323, -0.3821710106962544,
      0.05720840678302311, 0.5357157907318476, 0.9774602193294798,
      1.3090778347305116, 1.4754180695268455, 1.4513434104431437,
      1.246849998136692, 0.9043175840765244, 0.48858818457963366,
      0.07228927705855037, -0.28006112349325657, -0.5253773672058919,
      -0.6496420102411642, -0.6681728794775241, -0.6186747967867914,
      -0.549011536591961, -0.5029220270466583, -0.5073820081991782,
      -0.5648624254335406, -0.6524730130457728, -0.7282197489066691,
      -0.7427873606084299, -0.6538364202771951, -0.439134239719734,
      -0.10508891084418231, 0.3116328208172302, 0.7500237713047474,
      1.1369427249472013, 1.402787207527148, 1.4969213945960882,
      1.3991652554822256, 1.1245737814645844, 0.7203385738833809,
      0.25553537814213745, -0.19384360494735944, -0.5610152107813846,
      -0.8018826980940006, -0.9027396085853217, -0.8805140468739137,
      -0.7757087397174836, -0.6399804111097493, -0.5215958647622686,
      -0.4524838260480701, -0.4401548946215658, -0.46650096761843574,
      -0.49372605621883026, -0.47584174987640926, -0.37273633840748766,
      -0.16315239277929267, 0.14684720306998705, 0.5222391390700204,
      0.9048465766126451, 1.225352450279891, 1.4187103445201539,
      1.4392595850668393, 1.2718721885357775, 0.9363842336976931,
      0.4841681297636544, -0.012407692862929115, -0.4751728194585578,
      -0.8364295400608641, -1.0524920968553155, -1.1113610369988822,
      -1.0328489692487606, -0.8613215721884021, -0.6530113464519137,
      -0.4611598926697828, -0.32272928763672487, -0.24997808473274535,
      -0.22893658148961082, -0.22505514699620366, -0.19447790965032602,
      -0.09796581261922876, 0.08618619002795502, 0.35365352983532256,
      0.6723241323251309, 0.9879070515989149, 1.2356802778326716,
      1.3555868488325005, 1.307007402298318, 1.079560393515453,
      0.6972065682078453, 0.2145369281474324, -0.2939894327993883,
      -0.74938327932499, -1.0844558942707576, -1.2573225603182003,
      -1.258952076254089, -1.113087494424977, -0.8687163478766693,
      -0.5870667345737595, -0.3264069998333432, -0.12841308432536958,
      -0.009422482753358774, 0.041368763542072085, 0.05647352393792063,
      0.07897871367518317, 0.14867479115801296, 0.2891012854221816,
      0.49892651026393314, 0.7499858563759481, 0.9926210985991533,
      1.1671114918142291, 1.2184272594968615, 1.1106570189687774,
      0.8374841268688251, 0.42601099314026114, -0.06716984198366249,
      -0.5668762613306647, -0.9947246427150369, -1.2854188016325416,
      -1.400122824374741, -1.333800176454424, -1.1148590296763288,
      -0.7973013244558139, -0.44737426504956673, -0.1280257944339806,
      0.11504827845903626, 0.2624247676988501, 0.32296627592662713,
      0.3285204684263606, 0.32282997035173433, 0.3476167138159546,
      0.4294955442314594, 0.5711441562236423, 0.7490678584237607,
      0.9186200077296587, 1.0250904112630357, 1.0181155548002463,
      0.8657856528331536, 0.5648455651631354, 0.14430776469247478,
      -0.3386090113532228, -0.8094243835679353, -1.1917368137200637,
      -1.4233764324264577, -1.4695626111227158, -1.329963638381989,
      -1.0380179343179374, -0.6527369077657651, -0.24501220140571472,
      0.11824734611644738, 0.3883395051937287, 0.5439940898341408,
      0.5935113323459461, 0.5694984038063539, 0.5177263673735781,
      0.4830752341022094, 0.49623152813643157, 0.5645801143175103,
      0.6696475814948953, 0.771779707421995, 0.8208884807069352,
      0.7705457032742717, 0.5918197931034415, 0.28327145581876406,
      -0.12555926698921532, -0.578251961249274, -1.002396838080449,
      -1.3247937529075644, -1.4873852980491997, -1.4601314837674058,
      -1.2477429810591596, -0.8886550736898311, -0.44648659984981176,
      0.0039694809476865656, 0.39287667526696773, 0.6697788334925551,
      0.8129446338225069, 0.8315361239252932, 0.760284817685616,
      0.6482021046686965, 0.5443019039311692, 0.48401526620025753,
      0.47975794960613916, 0.5180302207216168, 0.5637546145968523,
      0.5707100826372624, 0.4953607615666537, 0.3104940559857629,
      0.015097421510731679, -0.3621852426836938, -0.7670925343648219,
      -1.13048960571871, -1.3833431240676317, -1.472368421102788,
      -1.3725760012233392, -1.0936571009392027, -0.6786146179315898,
      -0.19490757510006212, 0.2798223732007758, 0.6740768894060793,
      0.9370380941581894, 1.047936623646287, 1.0181527429011579,
      0.8857389972815255, 0.7039020097182053, 0.5264372454962702,
      0.3938162367761253, 0.32340961008435815, 0.30624851888103277,
      0.31105306512853054, 0.294407009584584, 0.2143945492256495,
      0.0441269316229001, -0.2184039720026979, -0.546802386833616,
    ]);
    const expected = [
      [
        3.33917903451614, 2.815315758169873, 2.8554527633501148,
        2.6988685534612324, 2.8249039499937547, -1.1238085961672086,
        -0.16866387313827674, 1.2579196695594423, -0.9892753308951718,
        -0.2539611457951905, 1.1373363225087512, -0.8569979677554644,
        -0.20017112777073925, 1.0149884329954937, -0.8772501373521258,
        -0.08827851800032728, 1.0232541439572, -1.0006824047900111,
        -0.003521780363772875, 1.0948800551959306, -0.7596800763657826,
        -0.6104691212374779, -0.8909419562108614, 1.0967066204750917,
      ],
      [
        0.16836905884786643, 0.04167381905579687, -0.0985227860183607,
        0.40978780256569436, 0.06253135532706233, -3.8825446496406464,
        3.0912191099730917, 0.9510566735347189, -3.554001523179256,
        2.284193528815196, 0.9448556645590922, -2.829029907434045,
        2.054736591391504, 0.3552002771640889, -2.462794416337614,
        2.5401429938647135, -0.14102721956438635, -2.8507551500563237,
        3.1164946967343714, 0.756195316563149, -0.15652678908958081,
        -0.029232257538205967, 0.40415491088977823, -3.008379974698471,
      ],
      [
        -1.2819007834347225, -0.2590610554890669, 0.7857964860563874,
        1.715659804746121, 0.2140342537554467, -0.7276799968597608,
        0.5738535662993122, -0.012658688205471391, -0.6787401837836172,
        1.003155797104515, -0.6057337341630744, -0.35049434388279266,
        1.179098739343209, -1.1610999582537995, 0.1830878884199014,
        1.0555231572908375, -1.5399782071961963, 0.7912518907416652,
        0.6603331023349658, -1.6471843280028657, 1.3247538791036964,
        0.08859730645866093, -1.454665368572109, 1.652763051767471,
        -0.5209568248320001, -1.0084366750782336, 1.6952108870512002,
        -1.0202444342744676, -0.4172045923661266, 1.4425887827210784,
        -1.2884381968823915, 0.17451203776917223, 0.9582670859974849,
        -1.2589514669653745, 0.4896824292712458, 0.6459006938677612,
        0.16533095125456437, -0.5378879499838188, -0.2951949555679869,
      ],
      [
        0.7131642510818248, -0.3988084914789962, 0.16023639427058306,
        -0.3069181821044129, -0.05761909706284975, 0.1433653792086339,
        -0.09801946482544571, -0.028487521295883916, 0.18384402206036857,
        -0.09826881345968781, -0.1320905400100714, 0.14920432805864936,
        -0.024236731780746777, -0.0961084633539099, 0.16761639911253287,
        -0.017910143843113374, -0.18534086484116935, 0.11423642755493466,
        0.059879600644444905, -0.13173555843961843, 0.11378477891763529,
        0.06246667906005874, -0.2009895041277075, 0.047253413869469046,
        0.13366945677276793, -0.1265668978129106, 0.03551357992894551,
        0.12284940282683052, -0.17515809053990355, -0.03503529353026309,
        0.17902433944169488, -0.08189116736021917, -0.047991227846060636,
        0.14817140676336282, -0.1142214989420465, -0.11213428619237795,
        0.1848648524480117, -0.00876899788348804, -0.11623100644662428,
        0.13203718713310572, -0.03323157506535064, -0.16482999985627814,
        0.1498801810185788, 0.07470193483568902, -0.15248296307673742,
        0.07830378770220003, 0.047804635913447885, -0.17994159442472432,
        0.08285215578535299, 0.14786181825179165, -0.147935032594102,
        0.00012714494346461463, 0.10887190128441379, -0.15358015973941344,
        0.00048377097305118966, 0.19259713642367554, -0.10386472234675768,
        -0.0832908477460849, 0.13489583589913284, -0.09211036330216257,
        -0.07673091418244973, 0.1978194975269037, -0.03132316977439975,
        -0.15145022334400204, 0.11863198007071754, -0.039050963831313124,
        0.06643175466902201, -0.3699833011227711, 0.49713046942231076,
        -0.2538545383786613,
      ],
      [
        -0.041650036602843984, 0.12963806310902087, -0.07683653811907115,
        -0.01123676145528137, -0.007501817079431115, 0.0021725787688796766,
        0.008807809357599436, 0.006522317191833205, -0.0020832162942701843,
        -0.008469372775108596, -0.006234070868609276, 0.002816333400910802,
        0.010271525459523409, 0.008927290507262195, -0.0004500274837388185,
        -0.009705126459459626, -0.010716477748501638, -0.0028091892923440415,
        0.006689629948262374, 0.009249393332624714, 0.002977939455402044,
        -0.005752409059966931, -0.008369005859831542, -0.0021835198196178893,
        0.0070424363281128, 0.010451365993150177, 0.004391721225806146,
        -0.006060876339307665, -0.011667390190261667, -0.00747724844243379,
        0.002644289206647027, 0.009597836266078671, 0.007417325821757707,
        -0.0013232442669399574, -0.008047624097821282, -0.006263709189047409,
        0.0023421709959282264, 0.009478925327195444, 0.008029197074584951,
        -0.0012105258844420513, -0.010121218419460048, -0.010675030825185006,
        -0.0023221319719148176, 0.007489224111628653, 0.010144813996225476,
        0.0037283145275637045, -0.005347678604699799, -0.008417752364451817,
        -0.002672932593425298, 0.006242665381353266, 0.009555436632233658,
        0.003641301710746888, -0.006461910528451039, -0.011609363972279456,
        -0.006975696230383993, 0.0034527093723363406, 0.010493517046826786,
        0.008158447001884728, -0.0009352102392432976, -0.00811558381525071,
        -0.006768793743417309, 0.0015350118581664574, 0.008585559122556314,
        0.007289736756068333, -0.0015957615437831273, -0.010046594684915151,
        -0.010159720237147687, -0.001505824458403901, 0.008384683962890764,
        0.010876869323536549, 0.0041001395223767695, -0.005434619860489612,
        -0.008938730192280121, -0.0034878158517055204, 0.005351936522794607,
        0.008827585876718114, 0.0032726811798839198, -0.006370364075130669,
        -0.011080783085372047, -0.006152484651881049, 0.004347168956202775,
        0.011216419904822444, 0.008514556995984496, -0.0010406153333364226,
        -0.008652371842628084, -0.007591692835797616, 0.0006467393369628226,
        0.0078696501784336, 0.006938459528644091, -0.0014867480861783904,
        -0.009504913059849164, -0.009330469456068476, -0.0006133380348336478,
        0.00909802236322167, 0.01121760597789552, 0.003976954671609148,
        -0.0059867996617561925, -0.009769740036704222, -0.004373935603544921,
        0.004647972988187456, 0.008494147701792153, 0.00339978118659039,
        -0.0058154428711976874, -0.010246106503863116, -0.0052629850654176,
        0.005050236307284493, 0.011541852786400776, 0.008374283821411393,
        -0.0016074838415790077, -0.009491285930421284, -0.008475923195018846,
        -4.553415536504707e-5, 0.007554226230454632, 0.0070841767036689055,
        -0.0009182278471335861, -0.008665102452589127, -0.008444848101046697,
        7.856174577142161e-5, 0.009407898125188222, 0.011060784165485157,
        0.0033962654764132516, -0.006833079279108964, -0.010652151604436211,
        -0.0050549007428258574, 0.004350407353969729, 0.008658779794451538,
        0.003982336803157835, -0.004970478408160478, -0.031524582668121005,
        0.08744303219985246, -0.05638696571469609, -0.008213677767094781,
      ],
    ];
    const result = wavedec(data, "bior4.4");

    const reconstruction = waverec(result, "bior4.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior4.4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49477383014366905, 0.9138119196584424, 1.1969539098236626,
      1.31156557897123, 1.2581170519451426, 1.0681795952405966,
      0.795457360793455, 0.5021361347103172, 0.24393129192599677,
      0.057484936084721994, -0.046864721023594735, -0.08528309118470233,
      -0.09371332223056952, -0.11605795350287079, -0.1903671193238346,
      -0.33662430072797417, -0.5493178164906263, -0.7967882209795061,
      -1.0276441801282412, -1.1827612399080798, -1.2099585501674577,
      -1.0777397294811533, -0.7846630780076078, -0.3619326632241298,
      0.13157346372779535, 0.6207947791089182, 1.0298738822794593,
      1.2978597270134906, 1.3910660087468991, 1.3092226248490737,
      1.0840498213782073, 0.7707035418138569, 0.4342427865164091,
      0.13444071805076563, -0.08738327950410357, -0.21637725387210638,
      -0.2651892682406193, -0.26793788423142645, -0.26879377642941815,
      -0.30817645924074816, -0.4101501274571216, -0.5742898700515953,
      -0.7741620022977578, -0.9628987620433191, -1.0845591440760405,
      -1.0884963617549364, -0.9431628803415831, -0.6458733885754547,
      -0.22599572147398178, 0.2593807043229127, 0.7364254749333058,
      1.1297013125923918, 1.3779337087134582, 1.4467260872584375,
      1.3352525233954045, 1.0754005408210638, 0.7236443786023886,
      0.34766353389382787, 0.010959866485942882, -0.24083155063806938,
      -0.3887025565209321, -0.4421136183426, -0.4336514029695769,
      -0.4080130552693642, -0.4082205554786097, -0.4626351361881565,
      -0.5761196670530798, -0.7276423742453746, -0.8749895323225709,
      -0.9654598949925108, -0.9498935346331403, -0.7965190268738062,
      -0.5011021292213408, -0.09074944976320545, 0.37974910379393045,
      0.8383389428731016, 1.210522807579516, 1.4351365721272245,
      1.4773717253624208, 1.3359790367405395, 1.0429734494658363,
      0.6559523619179438, 0.2449014216606521, -0.12333540473784466,
      -0.39921786275175997, -0.5599751092561802, -0.6122291815572068,
      -0.5873279493575717, -0.5307340103821936, -0.48826693663950177,
      -0.49274776404413206, -0.5544635399936274, -0.657890414524825,
      -0.7655293456963913, -0.827911127533332, -0.7972617726078642,
      -0.6413730382921736, -0.3541315220447861, 0.040051597730942134,
      0.4891909571903525, 0.9235339919347191, 1.2700119174266407,
      1.4679633881200125, 1.4824168155975697, 1.3117767738451347,
      0.988086806612349, 0.5698126215581637, 0.12887451625178625,
      -0.26497886148516187, -0.5587531383715845, -0.7263348393615805,
      -0.771866198392352, -0.7257399859463499, -0.6343948202462604,
      -0.5465972475591545, -0.499731264398221, -0.5095759227501911,
      -0.5661495577421657, -0.6366594928186714, -0.6748001252593476,
      -0.6340343845051104, -0.48147168914517857, -0.20877347466172275,
      0.16277783242880034, 0.5844902423285188, 0.9894099787188386,
      1.3063449934422688, 1.4754807120497837, 1.4618772005064185,
      1.2636125397939724, 0.9126018689529521, 0.467868108495285,
      0.0028434287572627337, -0.41029926557303076, -0.7155938787994056,
      -0.884020914702599, -0.9176008500718431, -0.8460361745576628,
      -0.7169153367138464, -0.5820487787332085, -0.48342229855711055,
      -0.4423037785398467, -0.45421624028980295, -0.4909985210379903,
      -0.5093842197359004, -0.4638828776237074, -0.32065196526553685,
      -0.0687756521051811, 0.27401460505927205, 0.6627827216499615,
      1.0338317765506138, 1.3182467611957938, 1.4573497706955847,
      1.4163699492990354, 1.1930207433922246, 0.8188760344362541,
      0.3531535428426928, -0.1296695991818483, -0.5555108309978746,
      -0.8659362026581621, -1.0294631559170868, -1.046337997299764,
      -0.9458099588358627, -0.7767469602759859, -0.5940423214778717,
      -0.4442549201646116, -0.35406645027120875, -0.32439695817294356,
      -0.33157935461003424, -0.3352121478325042, -0.29062776491786574,
      -0.1627472220398029, 0.06227081740654872, 0.3706468706154418,
      0.7216274099603759, 1.0551833546454994, 1.3050224998379998,
      1.4138351362636519, 1.3470979613914744, 1.1020649409155685,
      0.7097038473541177, 0.22901974955346252, -0.26496806113455273,
      -0.6968065462372899, -1.006108976943951, -1.1593688286669284,
      -1.1553858925352452, -1.0231572439880938, -0.8129094556281402,
      -0.5825956676779631, -0.38324985471898987, -0.24682142566148507,
      -0.17945278761798084, -0.16177625232238377, -0.15603829155616405,
      -0.11814576998934939, -0.011493494440066976, 0.18101973977739738,
      0.4499364672003873, 0.7590676534354774, 1.0524086511645963,
      1.2665760367184202, 1.345798673993173, 1.2558202748182177,
      0.9932864605596293, 0.5882473134531621, 0.09905023935940543,
      -0.39927285959844744, -0.8304520741483594, -1.132663758317992,
      -1.2708026905061964, -1.2425210374454194, -1.076721763197541,
      -0.8250138079783936, -0.5483224249357751, -0.30198933714464954,
      -0.12301685483953534, -0.022532725656291497, 0.014776610411281255,
      0.024268100648659488, 0.049724297866270306, 0.12956174561020994,
      0.2844521880125528, 0.5095901125356581, 0.7736803199296329,
      1.0250387353817978, 1.2034131139538675, 1.2546789106591645,
      1.1448088077188334, 0.8696413686479156, 0.4579572358097642,
      -0.03302791746541531, -0.5288160383048653, -0.9528779266900136,
      -1.2424593403948756, -1.361258332109517, -1.306041598654684,
      -1.1057270219718676, -0.8132705627303354, -0.49241617795814535,
      -0.20257812446099338, 0.014468017028386682, 0.14290251802430282,
      0.1942729426354691, 0.20181648925581566, 0.20927469383451025,
      0.2571461490934628, 0.3699507522395711, 0.5478164495089728,
      0.7646118920403818, 0.9732045901861438, 1.1166300420139743,
      1.1424563284378968, 1.016792593451381,
    ]);
    const expected = [
      [
        3.2965320602976154, 2.795243065002046, 2.8271397313177884,
        2.6657980996186845, 2.8979625396832214, -1.2938878022290992,
        0.07560603829452325, 1.155443443255741, -1.2754642946450163,
        0.32941976871160716, 0.7861130687065218, -1.230660158379667,
        0.7152967280125979, 0.4183445547637896, -1.306860316765093,
        1.0923234359026597, 0.19822643906756265, -1.3959744613346763,
        1.4750502475904401, -0.42636721205144573, 4.35432462058204,
        4.1129520908842565, 4.048048425003578, 3.37568649880371,
      ],
      [
        0.16018040014597804, 0.0431919081155106, -0.1016160362977376,
        0.4252472704220241, -0.13107894098351924, -3.5808263953488533,
        3.3062413244713955, -0.05027606165153502, -2.596807713189264,
        2.7126747400108173, -1.0069048645283787, -1.1780686518674641,
        2.7716675952197116, -2.464262568117159, -0.30488255220219573,
        3.4454835799576875, -3.455900047779247, -0.2708754367054673,
        3.584259452206012, -1.0066095828123363, 0.08567147945338494,
        0.03687371814584209, 0.19645122192953252, -0.41438915986836294,
      ],
      [
        -1.274250575328603, -0.25652166304712504, 0.7780707283987214,
        1.7009971221836973, 0.21724323870566145, -0.7783797272474254,
        0.6825494463015725, -0.09581054909457515, -0.7259959105098457,
        1.1785228174216618, -0.7683779709355325, -0.3544763711893676,
        1.3561704149191587, -1.352917972117213, 0.22280263305516373,
        1.1772423383755577, -1.6806251226696078, 0.8248800182355015,
        0.7081154095052826, -1.6569272028623767, 1.2625681731932499,
        0.10009653534326621, -1.2893304832677426, 1.394316489767484,
        -0.4552925112359206, -0.6852026945666635, 1.1680468998739735,
        -0.7828723104887061, -0.02014698380965889, 0.6366333787044272,
        -0.7755392880907396, 0.513714703610169, -0.05759624180931697,
        -0.4226552961837573, 0.49796595933473653, 0.0002366151710589473,
        -0.0870109857512334, 0.2284583023972239, -0.4291072400969417,
      ],
      [
        0.704231079361622, -0.3958536105600138, 0.15970909165934413,
        -0.3024176539820175, -0.05690312917555916, 0.14215338326322463,
        -0.09631909535053608, -0.035569251903046245, 0.18379591920983632,
        -0.0848975548414109, -0.1359992041636095, 0.14137582430666812,
        -0.018151828443126142, -0.10558521188109771, 0.16352202646475875,
        0.00668038400314401, -0.1869546736041894, 0.09348968330452136,
        0.06850252036041857, -0.1358085578729668, 0.10086187402334656,
        0.09357082518745805, -0.19141745009649136, 0.011934100608953516,
        0.1372654388438599, -0.11753419664300811, 0.014918200277697372,
        0.15103048003649727, -0.1478290088349168, -0.07986890072068534,
        0.16700676722506855, -0.05643301964774475, -0.06841126234561741,
        0.16300668742620478, -0.06870409435506089, -0.15540947299633928,
        0.14807948850927907, 0.029121923667242297, -0.12407033468923322,
        0.12685836620851326, 0.023053378174130407, -0.1928955180332957,
        0.08517118593911681, 0.11347276000722567, -0.1352322516809995,
        0.05412517660780881, 0.10089473608530493, -0.18166893971404852,
        -0.004068098851011878, 0.17124139124662768, -0.09826196939559065,
        -0.032881649153427714, 0.1424440942540756, -0.12534208993712503,
        -0.09421740067846494, 0.1848124211656152, -0.023790742508204656,
        -0.10766221164513434, 0.13608566182385073, -0.040730301808576605,
        -0.1595661771337074, 0.14952952952711676, 0.06641368529289106,
        -0.1473448564973594, 0.08281267924693074, -0.01421492143311561,
        0.15207069782568805, 0.08058076873118068, -0.11730713553035899,
        -0.20795041091298255,
      ],
      [
        -0.04105988745972986, 0.12794918106173855, -0.07594011527189375,
        -0.010982812617061206, -0.007367780688836596, 0.002090667590227982,
        0.00866168698385611, 0.006525191865736676, -0.0019250111521842018,
        -0.008397882948267536, -0.006477651496983426, 0.002345864123942727,
        0.009977748625009233, 0.009169473702117459, 0.0002556529635283217,
        -0.009047841182447974, -0.01062597484149947, -0.003324950947412586,
        0.006062392014828943, 0.009074181920855504, 0.003329580224890945,
        -0.005379322994111495, -0.008555318968011212, -0.0029502324722336555,
        0.006357858676613544, 0.010622328684855811, 0.0055334246988546915,
        -0.004710888896702445, -0.011146440176487395, -0.008181241674078854,
        0.0013384221778110078, 0.008780886963602602, 0.0076480949208954895,
        -0.0005288830934130767, -0.0077274972747376665, -0.006954420914188256,
        0.00121549850023207, 0.00913334195215311, 0.009157126250716352,
        0.0007849358710433907, -0.008757837118669547, -0.011050772110523986,
        -0.004142326888146142, 0.005693399477826086, 0.009715400950380496,
        0.004688291354898936, -0.004258020835706165, -0.0084855682948251,
        -0.003911951867286108, 0.005178561349696485, 0.010101800906377592,
        0.0058573963017300515, -0.004142160607654238, -0.011087194045017748,
        -0.00878529100214108, 0.0006852181874587027, 0.008879656260002741,
        0.008696852880103054, 0.0008072095053667794, -0.0070955282293531305,
        -0.007495299078894076, -4.171640453914244e-5, 0.008131666503743792,
        0.00905095214410405, 0.001365986357985096, -0.008274626598699937,
        -0.01123886521276464, -0.004801757879321716, 0.0053448067728190385,
        0.01027581187572998, 0.005948638890489563, -0.003201155565486856,
        -0.008464296711098301, -0.004956966447795863, 0.003869155242667774,
        0.009465234033977126, 0.006172372009142668, -0.0034323878501396647,
        -0.010792483801694848, -0.009181738235921347, 0.00011092440641186085,
        0.00891870371968076, 0.009621067137353783, 0.0020385929427844535,
        -0.006523137423948416, -0.008089516399894386, -0.001388910901380297,
        0.007019922237223589, 0.008892580162073045, 0.002026319674974455,
        -0.007585860914193346, -0.011191975684377777, -0.00532004005194979,
        0.0049832365892440444, 0.010709246235815982, 0.00706425925725937,
        -0.0022377165585081987, -0.008490237961518071, -0.006053841357472868,
        0.0024779881378976867, 0.008759601975173899, 0.006510667887509544,
        -0.0025677408533421875, -0.010264548975087967, -0.009386394301084608,
        -0.00041367765703716197, 0.00885682282454723, 0.010375532993085322,
        0.0031310458993952794, -0.006018470973255793, -0.008713581570608739,
        -0.0027795452594116914, 0.005849482472790077, 0.008720758125784645,
        0.00278368698975239, -0.006693451398158426, -0.010926461573334517,
        -0.005724584994884652, 0.0045717001169423566, 0.010973512619643674,
        0.007998714338176394, -0.0013836982902531159, -0.008549153224444467,
        -0.007160953151737891, 0.0010585392035532852, 0.008030415482040074,
        0.006896329103667017, -0.0015477555814398733, -0.05095108854092819,
        0.058084272101408096, -0.02439905248312424, 0.003200991820454819,
      ],
    ];
    const result = wavedec(data, "bior4.4");

    const reconstruction = waverec(result, "bior4.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior5.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5056218393842129, 0.9340786860112558, 1.223600416344086,
      1.3397179718193613, 1.2810196011170107, 1.077551567103171,
      0.7823916793091745, 0.4585197580216906, 0.16418445154712913,
      -0.05973505488543124, -0.19741868879782629, -0.259145036498059,
      -0.2756319461928617, -0.2872790512870929, -0.3311583820362556,
      -0.4291378064794744, -0.5802239560991803, -0.7591504568810497,
      -0.9216734236715692, -1.0153517208442073, -0.9931967169336914,
      -0.826817122812922, -0.5157474997880717, -0.09052320902785052,
      0.3914581062990413, 0.8565230038775744, 1.229433942329091,
      1.4488911563279037, 1.480268419440892, 1.3226519595065955,
      1.0085758810136969, 0.5965534758063051, 0.15818319839922973,
      -0.2371410884465288, -0.5363620427039946, -0.7125051124662083,
      -0.7679045335612689, -0.7303681730400297, -0.6434475743996683,
      -0.5533870911568315, -0.4960944323109878, -0.4874208064349542,
      -0.5191788078722142, -0.5618727586845204, -0.573426004869979,
      -0.5116766587375163, -0.3474482769719049, -0.07482245441049223,
      0.2841073066269162, 0.6813929657424587, 1.0520102011075256,
      1.3273377773839679, 1.4502387322251704, 1.3882030891627561,
      1.141419971064563, 0.7438099343554896, 0.25668918067502294,
      -0.2435366569100559, -0.6808539441845594, -0.9947684013311981,
      -1.1516536680333123, -1.149812903719446, -1.0172517063468958,
      -0.8028933778682592, -0.5635093546614541, -0.3496184676406661,
      -0.1937952115343332, -0.1041788140171313, -0.0646533378181703,
      -0.041498856535302234, 0.005296663334640794, 0.10903264937601154,
      0.284988470283645, 0.5237871248597246, 0.7912504847826775,
      1.034956708423553, 1.1960368866767688, 1.2234195937056893,
      1.0870748036603666, 0.7869864268104756, 0.3555571518977547,
      -0.14731124987068578, -0.6454835813675119, -1.061710336080457,
      -1.3331802924573082, -1.4239697427640405, -1.3315744349386425,
      -1.086100031450499, -0.7424100336187481, -0.36717339351393447,
      -0.02392403313595548, 0.24033737422652846, 0.4038993841465986,
      0.47252408574947524, 0.47475417476664256, 0.45171887375171327,
      0.44414577515050263, 0.47994382241677813, 0.5655498993111147,
      0.6832722015628587, 0.7953534953520539, 0.8537863977569562,
      0.8134550458416006, 0.645310669334055, 0.3462270147683654,
      -0.057055926747251795, -0.5110864858554274, -0.9454316536020032,
      -1.2868605362612748, -1.474755159860576, -1.4741856906792947,
      -1.2836004634254585, -0.935324522390709, -0.48873702808236674,
      -0.017706571837630303, 0.4048049233394589, 0.7214226357364016,
      0.900985890159915, 0.9427858955531969, 0.8736284409065008,
      0.7386587899382022, 0.5883656126799175, 0.4650609744483795,
      0.3922043097902163, 0.36918683863547824, 0.37280556662058945,
      0.36497351817530677, 0.3046471447683666, 0.16088610762559147,
      -0.07634383848415438, -0.39048140827550887, -0.7394084171534216,
      -1.0631809752704724, -1.296760509981422, -1.3847915094623349,
      -1.2949181719294753, -1.0264217185082454, -0.6120285319713955,
      -0.11233250764680786, 0.3959883565083915, 0.8355178053344064,
      1.143527796824267, 1.2839913972261785, 1.2535040883472732,
      1.0798833568612334, 0.8139473856989937, 0.5165715906911026,
      0.244203613157913, 0.03632569537289082, -0.0921818054847987,
      -0.15206645311983624, -0.1740581921250743, -0.19814047830502973,
      -0.26057502809558847, -0.3820615053109338, -0.5601216513925444,
      -0.7677412685236248, -0.9587412257412306, -1.0786619804271023,
      -1.0785475797789057, -0.9282479918449176, -0.6259133947046268,
      -0.20122195684892666, 0.2886425501037314, 0.7695192787150058,
      1.1649967074023946, 1.4120058244346445, 1.4737157227193127,
      1.3467816897031193, 1.0613120955846667, 0.6736233741796473,
      0.25353414845147004, -0.13079246340645184, -0.426915056929368,
      -0.6078598600891035, -0.675401018989482, -0.6563172626957947,
      -0.5927722525436037, -0.5293758886362397, -0.5002580089749568,
      -0.5194389592871558, -0.5769279998177241, -0.6415311366939322,
      -0.6696602201425976, -0.617918939050566, -0.45627039041233264,
      -0.17840442575269289, 0.19343055227819572, 0.6105414966362747,
      1.0065763843760982, 1.3110726501388503, 1.4646707163019477,
      1.4324430700987931, 1.2121872077673337, 0.835686291321093,
      0.36257938529049955, -0.13178827344651725, -0.5717595113140701,
      -0.8964834560206922, -1.071329657697945, -1.0930755557785679,
      -0.9878436206045785, -0.8024943487546066, -0.5917251193909665,
      -0.4041118570396365, -0.27052535204712946, -0.197714207840877,
      -0.16853137527048637, -0.1486141723754579, -0.09771648940153557,
      0.017269781532429695, 0.21099532620790545, 0.47301701452480877,
      0.767676036349753, 1.0407127414513788, 1.2311632259331589,
      1.2857472201901434, 1.1722904854964904, 0.8888936584214995,
      0.46652716507504466, -0.035731333504515544, -0.5418626515986419,
      -0.973999405710431, -1.2680330535174615, -1.3861915356550292,
      -1.3237560038473537, -1.1084667947272258, -0.7928887248688248,
      -0.4416511249348369, -0.11665471011485595, 0.13623485056781814,
      0.2959068420622202, 0.36820083108599716, 0.3812578139647616,
      0.3753880233746124, 0.3901500558843624, 0.4519997668770924,
      0.5657012262937131, 0.7117382200953408, 0.8504573951311867,
      0.9319821426158381, 0.9094739164455203, 0.7524437314392672,
      0.45674731589091033, 0.04865372817327018, -0.41822056173093236,
      -0.8726092246342031, -1.2398158252004785, -1.4572332483360293,
      -1.4875914619577078, -1.3268646960173456, -1.005004565818194,
      -0.5793391837340487, -0.1221892756239713, 0.29440884241517196,
    ]);
    const expected = [
      [
        3.2042957084200165, 3.2760317678911157, 2.981726218507719,
        3.370516615721166, 2.992104460192141, 2.2010152364378603,
        -0.2635846877715413, -0.3777469410113127, 0.6945415229656094,
        -0.09930534396247986, -0.6086672330651831, 0.513459444727295,
        0.2202899830495309, -0.635050817056014, 0.25064342840118403,
        0.4037797552183641, -0.5389954120296313, 0.041278366799203624,
        0.47915739869550605, -0.5516262153095852, -0.32786258162451887,
        -2.412025393664847, -2.3451128812649036, -1.8127251575111678,
        -2.599687829287861, -1.903959235192811,
      ],
      [
        -0.6473323630999445, 0.3439128829664433, -0.24446741929141183,
        0.14670689950470128, 0.03520896520305686, -1.1094212082100083,
        3.782643621391997, -1.4822017969516803, -2.8458277634283897,
        3.3064235161461943, 0.5554958526959145, -3.4483696104113783,
        1.7858584473742767, 1.8801631337161655, -2.902260912818525,
        0.467664519848489, 2.2194359075528083, -2.233244301062701,
        -0.1659926566108759, 2.151397935579339, -1.0182511633439226,
        -0.760255975279799, 0.04650102952571997, 0.2635415894026678,
        1.0244307530607752, -0.23964745128221654,
      ],
      [
        -0.17066087707444222, -1.5178091352084635, 0.6828922902016138,
        1.2552289242180903, -1.0244499448045907, -0.4620965807718209,
        0.47838889974667614, 0.04743738435009172, -0.5290730488734896,
        0.7086874263510596, -0.5215404252701668, 0.05436145110270582,
        0.47779624167184226, -0.7913162155958584, 0.66169179012743,
        -0.08727591415480251, -0.6327522709050187, 1.0254681273903214,
        -0.7544631050686958, -0.08993881257620297, 0.972263787687491,
        -1.2462273593677247, 0.6378737236127539, 0.49140778976235006,
        -1.3481418911600205, 1.2731699565117471, -0.25953193523889934,
        -0.9931761943591445, 1.5677371926641397, -1.0147015256569318,
        -0.2889034695936343, 1.3991349903885228, -1.5020966139749272,
        0.5244565531319797, 0.8502431672729456, -1.7212814727311585,
        0.7478043175467642, 1.839392716789816, -0.9579545910479096,
        -1.4834022669623206, 0.7508540819470008,
      ],
      [
        -0.13170296135322096, 0.34432275819936575, 0.07348299198704583,
        -0.6234900998115552, 0.3722269933692661, -0.06217476207786128,
        -0.08246625155094645, 0.09754428080834282, -0.011638376729914862,
        -0.10410256697034184, 0.09503687138957037, 0.04191108485189832,
        -0.11389004101410832, 0.049840721311606065, 0.057595254792034686,
        -0.11076972398880651, 0.034845196375269415, 0.09901903071778649,
        -0.1022073443357622, -0.020346354194900627, 0.10166130169772591,
        -0.07391664275294729, -0.03561659610010768, 0.12023773401008427,
        -0.05167552129002444, -0.08599864312800842, 0.10392571832099247,
        -0.0071621211447906175, -0.08880901546448469, 0.09679196015866166,
        0.017405291838973255, -0.12171531732855209, 0.06408936820012104,
        0.0642102473550764, -0.10404685171100264, 0.03716741369639853,
        0.07759544472819464, -0.11357462228982326, -0.0017205811225528469,
        0.11304484306987174, -0.07553449327324037, -0.03615863995808552,
        0.10499946954950144, -0.06454326584527038, -0.06724249799733269,
        0.12083724512404913, -0.014611727228687667, -0.0954185696777929,
        0.08856931005824094, 0.006667530189900334, -0.10631038129172675,
        0.08490166517620064, 0.05466203533287753, -0.11830904107948366,
        0.03441271331328607, 0.07285535564846803, -0.10304750542431929,
        0.019399563861344706, 0.10486951296274444, -0.09662327567534565,
        -0.03656735684073624, 0.10887269009655542, -0.058063039075567875,
        -0.05016944852565905, 0.11643464410744837, -0.027041203274439558,
        -0.20471874377440277, 0.5442204645653347, -0.4834295452273114,
        0.29114677698388924, -0.1572566337157956, -0.09864876065062503,
      ],
      [
        -0.018351287559250664, 0.11036033202784068, -0.12290652761479318,
        0.03819991433237702, -0.004588529900024646, 0.000494908360855772,
        -0.001593156411954337, -0.0021626993319285425, -0.0007291384625899792,
        0.001359335553887492, 0.0021610351021883823, 0.0009194106410950094,
        -0.001240802463723923, -0.002335593619931988, -0.0013322710237554866,
        0.0009004183214197554, 0.0023701854359485753, 0.0017628633025366476,
        -0.0003683948616818658, -0.0021066094430859036, -0.001908959565142223,
        4.12521986337816e-7, 0.0018470044737831388, 0.0019312553839363512,
        0.00018056845445619737, -0.0017857901576469656, -0.002137640122161546,
        -0.0005109443569512083, 0.0016484095141972863, 0.0023905054671475683,
        0.0010314589753586331, -0.0012218188678124811, -0.0023613642789769487,
        -0.0013932146787310929, 0.0007703941949123317, 0.002150048833079392,
        0.0015033744531373332, -0.0005481812015312735, -0.0020942602758554463,
        -0.0016863674545749018, 0.0003321756852165816, 0.0021306908818416394,
        0.002055240543054804, 0.000138599700874837, -0.0019193251335768834,
        -0.002285736082697969, -0.0006513454096958998, 0.0014950737747632115,
        0.002221851155206029, 0.0009060277119513124, -0.0012107325826721485,
        -0.002164657456966713, -0.0010675542514809256, 0.0010792161234564335,
        0.0022968050761449452, 0.0014367914380960696, -0.0007622509916343501,
        -0.0023342642259133084, -0.0018647530168640234, 0.0002266417163241663,
        0.0020658309029946732, 0.0020213450772791266, 0.00017688213833201246,
        -0.0017571912334369798, -0.0020093327051429466, -0.0003621710332301336,
        0.0016531396781807725, 0.002159429324783786, 0.0006540260545856028,
        -0.0015218523881122964, -0.002395377153251621, -0.0011552662447304497,
        0.0011052975203498482, 0.0023733508182867524, 0.001535287690152806,
        -0.0006213001664508531, -0.002131432927245094, -0.001641528590724018,
        0.00036476657700029985, 0.0020174820325428405, 0.0017745725646451092,
        -0.000163995552200162, -0.0020321906568834596, -0.002105507337186103,
        -0.00027719667357301893, 0.0018331685600473623, 0.002340845893834794,
        0.0008007984756649468, -0.001392172045430018, -0.0022707601855872783,
        -0.0010772720570067333, 0.0010588321867427927, 0.0021610998907124843,
        0.001213907457685729, -0.000909765385782399, -0.00224587251103077,
        -0.0015355210888802883, 0.0006171868389213825, 0.0022827908181527815,
        0.0019538052256044876, -8.585566664183822e-5, -0.0020148179690816052,
        -0.0021217374142664946, -0.0003500117982118162, 0.0016623287354593178,
        0.0020805363622771397, 0.0005437189366694368, -0.0015123749457564128,
        -0.0021724784039068353, -0.0007972684306117865, 0.0013838415543555396,
        0.002385145772576292, 0.0012718384465164757, -0.0009825971391242555,
        -0.0023709199343009534, -0.001666020316185993, 0.00047279599541804815,
        0.002104852091182559, 0.0017724499306970114, -0.00018050733451962803,
        -0.0019332800332052232, -0.0018575449440882841, -8.629274872488935e-6,
        0.0019209558260322602, 0.002144506919865039, 0.0004157647602811461,
        -0.0017347716132281813, -0.002380380030869643, 0.012367350411293835,
        -0.0670015355518161, 0.0758713132435784, -0.02150954741749997,
        0.0024133780638090196,
      ],
    ];
    const result = wavedec(data, "bior5.5");

    const reconstruction = waverec(result, "bior5.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior5.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5059057799274839, 0.9341525332433839, 1.2227103673637223,
      1.3372357060900493, 1.2768383416651916, 1.0723407625564376,
      0.7775960191553725, 0.4560658830675919, 0.1659534779871658,
      -0.05252791097865728, -0.18475092307778687, -0.2424426625579677,
      -0.25764090092176495, -0.2715424143680913, -0.3212048206970342,
      -0.4275804545799056, -0.5880126073914281, -0.7751974707495031,
      -0.9429870131603495, -1.0376795605608895, -1.0120419308597182,
      -0.8385764093987012, -0.5186704782414892, -0.08522094458905352,
      0.40212199580885344, 0.8681674176450185, 1.2373599569405962,
      1.4494474278584724, 1.472018496978344, 1.3070088756139748,
      0.9896905408717722, 0.5804294968932524, 0.15119613413496252,
      -0.2299711937480613, -0.5129062995594743, -0.6744513719949492,
      -0.7207854543527608, -0.6826176451236833, -0.6046562184557611,
      -0.5321421472663739, -0.4979167983267655, -0.5133152135238725,
      -0.5651853731012284, -0.6197760461056062, -0.6324958022948275,
      -0.5610525469984586, -0.37860515232918696, -0.08351433181094692,
      0.2969173214196785, 0.7098700940888961, 1.0869956150259847,
      1.3587425119966046, 1.4696951751705054, 1.3913023537977947,
      1.1289482596005254, 0.7216338570157952, 0.23427407084919344,
      -0.25564149254159524, -0.6739515702151577, -0.9646284437760959,
      -1.1001121984818265, -1.0848948081036236, -0.9517071025230054,
      -0.7514352947982506, -0.5393783451172427, -0.3612941883082645,
      -0.24267171224864825, -0.1838135979004915, -0.1618351608247828,
      -0.13894165191516095, -0.07477014164466805, 0.060440168476934064,
      0.2753020325915588, 0.5521686276016706, 0.8489210072208306,
      1.1074008017849946, 1.266564766785371, 1.2772275629350278,
      1.114807761090458, 0.7869142287383852, 0.33380750634656464,
      -0.1785441049055112, -0.6713284089759814, -1.068769358628876,
      -1.313392329104988, -1.3771845039505128, -1.2661354004552838,
      -1.017216083806054, -0.6886467304853765, -0.34587791997173595,
      -0.04669149879164114, 0.17102234627179397, 0.2959661954026029,
      0.34316428876950655, 0.3470044355780244, 0.34952836814116395,
      0.38706688962017455, 0.47870452712608297, 0.6195806028022183,
      0.7808084891375263, 0.9161244139299715, 0.9736729823540289,
      0.9100187688067756, 0.7028679992799215, 0.35924364476437226,
      -0.0830780576659031, -0.5614480098862916, -1.000348750531631,
      -1.3268324637376157, -1.4858431819930278, -1.4518651201395023,
      -1.2341851313335612, -0.8745554091344845, -0.43783169864502225,
      0.0021892561453935033, 0.3783988568013927, 0.6438322335226969,
      0.7798794763468271, 0.797484730778308, 0.7312825095539147,
      0.628332553795464, 0.534404646431129, 0.4813202886370408,
      0.47854666066830964, 0.5111396587733816, 0.544519422125163,
      0.5348318115815474, 0.4422292838367264, 0.24364501257819832,
      -0.05827636125173419, -0.43250868398090103, -0.8241261336497068,
      -1.165067271164917, -1.3887466737211267, -1.4450945467742204,
      -1.3124432861922368, -1.00338559085967, -0.563133905218189,
      -0.060677715270740396, 0.4252628513344915, 0.822262677602213,
      1.0785179349634975, 1.1722206872336236, 1.1139315269692875,
      0.9415848951628248, 0.7095203385014025, 0.47433909388753587,
      0.2810998090582087, 0.15322000973123928, 0.08848167567302584,
      0.061990795739653146, 0.03519401242907236, -0.03145988128763111,
      -0.16553744176617935, -0.3727248281227248, -0.6326619002981972,
      -0.9017233584797165, -1.1222268082017177, -1.2359257183785037,
      -1.19853821771015, -0.9917450190591046, -0.6296436500592955,
      -0.1579411051785068, 0.3541086579321756, 0.8272794230510971,
      1.188389036079934, 1.3850906025795082, 1.3960525844531428,
      1.2342323282834005, 0.942584328315137, 0.5833318293364118,
      0.2234365006567562, -0.0802368433695752, -0.2925507181652096,
      -0.4058462181260159, -0.43861646280427985, -0.427657042205451,
      -0.41584959248891756, -0.43879262027922034, -0.5137508241157611,
      -0.6337894642781643, -0.7686441233969619, -0.8721732182195399,
      -0.8945705602545235, -0.7962900957869778, -0.5601581318650436,
      -0.19854045236633183, 0.24639926181057775, 0.7096497906837383,
      1.1160577422306721, 1.3959173834588174, 1.4998411714592543,
      1.409438530144223, 1.1412974269361478, 0.7433341794430914,
      0.28437308100607894, -0.16059445901967379, -0.526024254661026,
      -0.7686927866072875, -0.8749154556382579, -0.8605898607191591,
      -0.7642920492233045, -0.6353285598138703, -0.5198420264517605,
      -0.4484942622163492, -0.42880767967553296, -0.444045908639749,
      -0.4588548249485498, -0.43017535631828596, -0.3206008054947681,
      -0.11071432400242581, 0.19283507686956508, 0.5557294224645092,
      0.9214760162072719, 1.2228672651720143, 1.3967790714302366,
      1.3988140405133649, 1.2142727356500798, 0.8627669132162661,
      0.39527521088895207, -0.11577377274033411, -0.5911546175679341,
      -0.960878822118362, -1.1779368816678708, -1.226638152427686,
      -1.1237408219301623, -0.9122916535148167, -0.6498279757360577,
      -0.39391331818573133, -0.18856554810618364, -0.054853617552905465,
      0.012140243521193639, 0.0394041090970836, 0.0662775711430133,
      0.13152792196189295, 0.26061423818810175, 0.4564829752422441,
      0.6963567172728964, 0.9354797163317621, 1.1170377657816144,
      1.185905203870185, 1.1028743128595857, 0.8558399906008368,
      0.4650944933043686, -0.018728636942432958, -0.5237694712274918,
      -0.9711266013377395, -1.2908944895374004, -1.4363741349487997,
      -1.3931968336307923, -1.181299937587881, -0.8493834307272046,
      -0.4632485638331082, -0.09084690988119504,
    ]);
    const expected = [
      [
        3.1992900319625552, 3.273313791763097, 2.9775202929799187,
        3.3664034416053785, 2.9889106979281723, 2.206267214892159,
        -0.2777811325928523, -0.3679218324852503, 0.7111413775054586,
        -0.13323371135518425, -0.6032984691334717, 0.5541349127755097,
        0.18343855971656226, -0.6540984688200677, 0.30257358197700884,
        0.3850788520625472, -0.5724958488230141, 0.08452123491406122,
        0.4672608917282539, -0.6272633402350647, -0.3720065369061414,
        -3.429253434951872, -3.090515866377916, -3.150960810297383,
        -3.2333222792476635, -2.5740981678417567,
      ],
      [
        -0.6447284535105675, 0.34329193026546795, -0.24427557281644924,
        0.14688157021631376, 0.03243515388826344, -1.0732994227124157,
        3.7640655654919253, -1.597082512078128, -2.7281493874252605,
        3.4221423406482234, 0.31539364621930466, -3.4510341003701517,
        2.064153469959579, 1.722862526553392, -3.0795358744807757,
        0.7052213780013125, 2.2139986252294173, -2.382337347776303,
        -0.03103876307590082, 1.9737820114032785, -0.8277550758478024,
        0.13850593363648897, -0.12896865960913342, 0.19195725204997113,
        0.019896297457228145, 0.11920995091649886,
      ],
      [
        -0.16898857947470175, -1.514848800618128, 0.6818090903097145,
        1.2513856053765384, -1.0174590294047725, -0.4702359945374252,
        0.4640853376506235, 0.09229744450005464, -0.5773306567849491,
        0.7139523040687425, -0.45775170895314277, -0.05288838621015348,
        0.5572500898423939, -0.7724370303845857, 0.5321695964603104,
        0.08240450763149092, -0.724612737277003, 0.954457758120112,
        -0.5406594030137166, -0.3153200676494001, 1.0450281705701925,
        -1.087322510075312, 0.3276845096624533, 0.7475313445467379,
        -1.3548124166275957, 0.9927638761007088, 0.13825513751725538,
        -1.231501106688339, 1.4558046472827704, -0.5987769538967622,
        -0.735480049163802, 1.556032591973861, -1.2332295009237924,
        -0.006083606107235729, 1.277508726595675, -1.7290512788162333,
        0.25860848633526384, 1.4982129810958416, -0.6579988049569262,
        -1.328873454989684, 1.2848901842763798,
      ],
      [
        -0.13178735217482057, 0.3459255513015955, 0.0722805913426546,
        -0.6242431093395606, 0.3740024780589499, -0.06426731139888817,
        -0.08219870296850401, 0.10060754661712151, -0.015619066367726721,
        -0.10377983253855805, 0.09991530976312843, 0.03615440747913744,
        -0.11444854552147189, 0.05789095988875451, 0.05103419252724532,
        -0.11438376516846771, 0.04541512689013071, 0.09326393666456495,
        -0.10901619124579763, -0.007081745587916289, 0.09796714484569223,
        -0.08592016787859458, -0.02167499762407371, 0.12107773527961543,
        -0.0673261936629895, -0.07253097296087135, 0.10967133956921934,
        -0.027456908164193702, -0.07849050869925596, 0.10976481161602135,
        -0.00403989946911164, -0.11640770053987008, 0.08263966730783706,
        0.041749970781945145, -0.10575495437264659, 0.06266712316784809,
        0.05891675683475922, -0.12385224518139389, 0.026536267010008753,
        0.09875358423211611, -0.09430598487561956, -0.004813201801490762,
        0.09979327602935828, -0.09222396514442076, -0.039093748051543246,
        0.12466478303835445, -0.0481939424742001, -0.0704065473589025,
        0.10439283638952268, -0.03199955518711809, -0.09146040181576676,
        0.1110300950073159, 0.016695602066378372, -0.11249166458619325,
        0.07089091666308392, 0.03676427100104343, -0.11226398316686952,
        0.06268094923460361, 0.07802890694338238, -0.11739171710156994,
        0.010462894455777666, 0.09120680713196415, -0.09391037065081603,
        -0.0039097061030204, 0.11522806420256805, -0.0624222485502971,
        -0.2089080545329295, 0.45108100436010157, -0.15658123813740438,
        -0.15723456692535395, 0.141265394674016, -0.148927328647936,
      ],
      [
        -0.018309359595720602, 0.11045639266554692, -0.12308818898540023,
        0.03829265045765195, -0.0045569709699792155, 0.00047578738841433897,
        -0.0016522747659410628, -0.0021977875159507523, -0.0006945090840490796,
        0.001436922509743947, 0.002202743070325015, 0.0008741723659983474,
        -0.00133724218124025, -0.0023878949772848865, -0.001279227488828574,
        0.0010172804804091818, 0.0024374841284010487, 0.0017041681354224118,
        -0.0005097252267003312, -0.0021978786026021144, -0.0018522979437445245,
        0.00016622946014633374, 0.0019712060484411414, 0.0018891810109234308,
        -1.607498848357411e-6, -0.0019437832244080678, -0.002117865501922847,
        -0.00032046764847223387, 0.0018369030018516247, 0.002394104021120858,
        0.0008333512312413693, -0.0014443752991966999, -0.002394515660372602,
        -0.0011899071288600407, 0.001033786858985428, 0.0022275456008373287,
        0.0013093980026772194, -0.0008477349987225293, -0.0022247318459255932,
        -0.001518124676260473, 0.0006539037378415185, 0.0023095261601140797,
        0.0019164766313462915, -0.0001998812146292682, -0.0021447370654726836,
        -0.002177085555559699, -0.0002930240632589027, 0.0017779890867579626,
        0.002158407725691744, 0.0005369373891944262, -0.0015568802708209573,
        -0.0021663618819589125, -0.0007110784916214948, 0.0014751577997032597,
        0.002366323211507114, 0.0011067408992821888, -0.0011938989382951157,
        -0.0024645091925378946, -0.001559457610686172, 0.0006971906091506989,
        0.00226512878353409, 0.00174917090280087, -0.0003343909415956784,
        -0.002043144968241954, -0.001797495665729799, 0.00016829346489212645,
        0.0020233220770942166, 0.0020258085398741025, 0.0001307188927297349,
        -0.001956821696763189, -0.0023347195476640112, -0.0006434137897299366,
        0.0016009431600040903, 0.002385915834218927, 0.0010338928049308184,
        -0.0011889820903390868, -0.002240508092995804, -0.0011748610446551608,
        0.0009959456080668458, 0.0022392975958284433, 0.0013764690284672303,
        -0.0008263085425022007, -0.0023528768498343594, -0.001783557998326234,
        0.00039831129280476496, 0.0022382780496628812, 0.002088555004461912,
        0.00010674139025360942, -0.001894358834773624, -0.0021065952266822695,
        -0.0003757189582535682, 0.0016687415198869133, 0.002118700483274413,
        0.0005454312053988298, -0.0016029976426956607, -0.002330171519339945,
        -0.0009281939927906335, 0.0013619714943851145, 0.002474960430194907,
        0.001403718033388495, -0.0008815485963711844, -0.0023189650077876794,
        -0.0016347868141397982, 0.0005020225317281313, 0.002104598064314357,
        0.0016966006839436807, -0.0003330313045886088, -0.0020906868977669836,
        -0.0019224857930589768, 5.8245243003839445e-5, 0.002063195696302684,
        0.0022598094021933747, 0.0004488265343239768, -0.0017477395423827445,
        -0.00236193393233043, -0.0008700215932796306, 0.0013388095427407324,
        0.0022414100114994204, 0.0010338912904588778, -0.0011384999979765949,
        -0.0022415966385469894, -0.0012282514093147354, 0.0009920065809668134,
        0.0023808098057813256, 0.0016394660808051482, -0.0005938527349112904,
        -0.0023170633735561438, 0.002094889067043298, -0.02069016911548952,
        0.07262154852388075, -0.06379897730847148, 0.011557578945866806,
        -0.0024380813343987083,
      ],
    ];
    const result = wavedec(data, "bior5.5");

    const reconstruction = waverec(result, "bior5.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior6.8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48738540955935755, 0.9018018009697268, 1.1850236475009799,
      1.3049449240301114, 1.261018593783465, 1.0825961419949397,
      0.8206799250585978, 0.5351468194511847, 0.2805476487026015,
      0.09388435616319585, -0.012752804730773004, -0.053014918359377244,
      -0.06052301257990053, -0.07804098990302277, -0.1443699404440259,
      -0.28229385336366525, -0.490647699183074, -0.7425704867899867,
      -0.9904917479330557, -1.1767457451082934, -1.2473134911121337,
      -1.165396237033084, -0.9215197363336202, -0.5376602142508736,
      -0.06428291940133667, 0.4291418224923716, 0.8680325987954318,
      1.187838241957811, 1.346962721514132, 1.3345303689992234,
      1.1712660185580954, 0.9033883429033827, 0.5910558565746373,
      0.2941715890470559, 0.058942511768484585, -0.09163559328240889,
      -0.16118103330154493, -0.17653337340015943, -0.1785404743299797,
      -0.20941539896056266, -0.2998818574214845, -0.45937030616142527,
      -0.6717750593703493, -0.8979177219817952, -1.0842138967492672,
      -1.175507059644576, -1.128986979760568, -0.9258045309452378,
      -0.5775064998624666, -0.12562266010955683, 0.3656453257988761,
      0.8220447101588413, 1.1743459982621922, 1.3724223851561654,
      1.3951115833533534, 1.253627635047334, 0.9878085741057683,
      0.6561690540773001, 0.32217305579227534, 0.040005613031415366,
      -0.1568006996552111, -0.26125468848689337, -0.2920326364318696,
      -0.2862135489967235, -0.28754604379624216, -0.33324651595204635,
      -0.4426728056043522, -0.6107473310494391, -0.8078328253952947,
      -0.9861757691004523, -1.0914114939068913, -1.0763631877781434,
      -0.913770863739092, -0.6048019376403946, -0.18117319764073517,
      0.2997782537127226, 0.7660607903682459, 1.145572833107997,
      1.3809042609802793, 1.4409963740621876, 1.3269926825384122,
      1.0709761892282583, 0.7279593507301331, 0.36307141016279004,
      0.036997530133870415, -0.20689885646987588, -0.3507827154222823,
      -0.4040504967617486, -0.39828391845118083, -0.37684431968969706,
      -0.3817876784960438, -0.4414149201716931, -0.561599030467619,
      -0.7230926431605138, -0.8855445770202278, -0.997298308764819,
      -1.0086103190371127, -0.8850595230257465, -0.617831808357528,
      -0.22827962699098864, 0.23449426818578217, 0.7026201434969254,
      1.1030305398615183, 1.372527032712234, 1.470880308359689,
      1.3889465050388716, 1.1499469172612595, 0.8036615799008113,
      0.41494696473960707, 0.049307765200376386, -0.24108195678097605,
      -0.4276593740951171, -0.509726804964245, -0.5118216990084615,
      -0.4750123027020362, -0.44438955308083583, -0.4559295046643569,
      -0.5260305474229016, -0.6463559327311068, -0.7852986239064348,
      -0.8957504478472003, -0.9272967843943729, -0.839849702652149,
      -0.6153458292036506, -0.26456585469056104, 0.17272088852622022,
      0.6344949115790826, 1.048666790635552, 1.3479435597072555,
      1.4839630590011805, 1.4374273521186618, 1.2218934197634366,
      0.8803634961756718, 0.47550437499240716, 0.07581196536495255,
      -0.25903035342814307, -0.49019490283479383, -0.6064048873327348,
      -0.6238390733524507, -0.5794466917413202, -0.5194570051887158,
      -0.4860114258559566, -0.5052750680388034, -0.5799974469580806,
      -0.6883837730470463, -0.7895778524176883, -0.8344229134704665,
      -0.7788536339268306, -0.5965997405845123, -0.2880131392476336,
      0.1172628837374286, 0.5645986301507389, 0.9848008437683883,
      1.308319196312955, 1.479974549370095, 1.4707940638482833,
      1.2841982413105202, 0.9551016416124423, 0.5421483700714118,
      0.1149093078214492, -0.260962810428058, -0.5371704154192052,
      -0.691718191247165, -0.7313878530661062, -0.6873238320389301,
      -0.6049676005697513, -0.5309241125479333, -0.5000580578336371,
      -0.5260300922778419, -0.5976169969503888, -0.6817255917081987,
      -0.7323557539404244, -0.7032937291431065, -0.5613802875961438,
      -0.29702690194131776, 0.0707096985367216, 0.4958901516173251,
      0.914047067011398, 1.2552933043878574, 1.4591837101974992,
      1.4878799666394347, 1.334539885550181, 1.024958905138812,
      0.6120693371371516, 0.1645755295697171, -0.24762878016910045,
      -0.5678773441022128, -0.7636674123791478, -0.8316557474615496,
      -0.795691980421297, -0.6985376840829313, -0.5894235610005568,
      -0.5105734224701566, -0.48603897682945046, -0.5155941699712324,
      -0.5751775696028638, -0.6237518438161501, -0.614862986491949,
      -0.5100127759192872, -0.29048961488649216, 0.035349951645363864,
      0.4312760899504925, 0.8392287866049206, 1.1909252222811424,
      1.4223895605743873, 1.4880312111258784, 1.3709691917659916,
      1.0871605730356444, 0.6823359501106026, 0.22242986111252128,
      -0.220283260233219, -0.5821401344345003, -0.8206855728154214,
      -0.9220581795350425, -0.9015677845412254, -0.7975003260841718,
      -0.659799008004674, -0.5364771286001128, -0.46112951294048,
      -0.44460513027696, -0.4728589677363567, -0.5114704909948469,
      -0.5156699555069337, -0.44335095377811856, -0.267798030233,
      0.013095812829185594, 0.37351498873977546, 0.7632852899151308,
      1.1176264637028093, 1.3708949060366877, 1.4711282938185886,
      1.3919735051776256, 1.1391657179568768, 0.7499918025243892,
      0.28581366703150135, -0.18064505540104117, -0.5803214474197126,
      -0.8616889146238111, -1.0003226360088309, -1.002033809925571,
      -0.8989925783835728, -0.7399289368243591, -0.5768984941752635,
      -0.45189127715273847, -0.3865587986124029, -0.37754062653319276,
      -0.3984804058903513, -0.4081700688973964, -0.36274955165803746,
      -0.2288835282804496, 0.005419740948289176, 0.325126358059543,
      0.6891750339938886, 1.0380813718341146, 1.3064635169939236,
    ]);
    const expected = [
      [
        2.420722932364949, 2.2199442257822537, 2.849138991081103,
        2.0047096890921274, 3.2032538348990967, 1.7686968327112311,
        3.1733056560926656, 1.8985813142974883, 2.018899513799426,
        -1.8023102663622272, -0.9177919905848052, 2.744788775669335,
        -1.4412856675970673, -1.6646977434416004, 3.0855157076875708,
        -1.113855956775481, -2.179312164080215, 3.187511812252074,
        -0.7760488654689298, -2.4370009632277823, 2.9747733791754767,
        -0.33724487025741606, -2.501873113577588, 2.455619478752746,
        0.26088028771070143, -2.4780336477349563, 1.7221418069754957,
        1.0058706601157634, -2.4569145906233074, 0.9165892115064225,
        1.8071549933211135, -2.4728357519313073, 0.17790358301878076,
        2.5238306356244875, -2.486616136357296, -0.4091477661646549,
        3.026385383175437, -2.4568995556211366, -0.6837528945124182,
        2.4460250582857683, -0.4917661195676533, 2.3318495004439783,
        -0.1694102150154591, 1.85904102223108, 0.3215914580245684,
        1.688304486187099,
      ],
      [
        1.7390688784397121, 0.43218390290977254, 0.8774128449392462,
        -0.2953728144360842, 0.05779970960537477, -0.9307560257971133,
        -0.8470445836556442, -1.456109508263761, 0.3320522328034608,
        0.9429806318858305, -1.5232207321998152, 1.0215501042654949,
        0.0759423357788079, -0.9601937465398018, 1.1443730120879851,
        -0.6874737150463711, -0.0433441866943192, 0.6927740736093558,
        -1.0183369700080984, 0.8503442155348654, -0.15708601238010544,
        -0.7775371492078207, 1.3556602271603004, -1.0487275050853593,
        -0.08424718677064946, 1.27929549900106, -1.6015826320333142,
        0.7372786303323123, 0.6835603626454496, -1.5781298572819917,
        1.3016024787935625, -0.14254809618501318, -0.9882883374686728,
        1.3332109772643315, -0.8121014800619905, -0.08522112942900759,
        0.7837655320918461, -0.956073235662342, 0.4096779328377258,
        0.6773678753977259, -0.7463015709079244, 1.1996791184362778,
        -1.4980283762075197, 1.413428017033262, -1.7257482101951256,
        0.6048455796322891,
      ],
      [
        -0.23776323288841036, 0.6564136919423242, -0.42607607439817113,
        0.31601188985371037, -0.23938287830242366, 0.12572426070153206,
        -0.3219233238814035, -0.010778011962940162, 0.10283760572011628,
        -0.06345052225677211, -0.046404641873017155, 0.11153733638818489,
        -0.0350260247057772, -0.08671086917330392, 0.093276626939696,
        0.003645786328048281, -0.09430531667834728, 0.08224574470900738,
        0.03798910880573589, -0.1131809175710271, 0.04240203420138415,
        0.06925827060157878, -0.09842002538154535, 0.018656711537014432,
        0.09413250771854179, -0.09184806685950002, -0.029269319080179587,
        0.10419128357612173, -0.05719898956118995, -0.05093689752613125,
        0.10919404736004751, -0.03180096909474538, -0.0903454777833084,
        0.09251118773228172, 0.010821915339613325, -0.09570845609120586,
        0.07705325486874885, 0.04089529281499487, -0.11398752894631432,
        0.038868444038502876, 0.07521125242502234, -0.09589494577120036,
        0.012350998042003184, 0.09466921892152802, -0.08973710415398867,
        -0.033527079713247046, 0.10708039431994729, -0.05151077206527759,
        -0.055989010002904634, 0.1063368346744698, -0.02812877140764275,
        -0.09311577642082017, 0.09184471715701414, 0.017663519156091968,
        -0.09753162062751075, 0.07129566887574539, 0.04394614672583467,
        -0.1138831607990205, 0.035680543448114097, 0.08081239838967333,
        -0.09376326429184918, 0.0055261198818243144, 0.09508087814921715,
        -0.08681531142776151, -0.037170100046594476, 0.1096830895550339,
        -0.04630465044354552, -0.06440818289780248, 0.11991419811836083,
        -0.09888911145040813, 0.09168584147698057, -0.021954734069128373,
        0.11984094733027809, -0.27882953682468037, 0.1428528365836696,
        0.029495922459026772,
      ],
      [
        -0.0004045389517545898, 0.005181416400108647, -0.030026348108981228,
        0.09644684631466682, -0.08489958699820992, 0.01099709696292353,
        -0.0012737944102829274, 0.0005483956061811297, 0.0018255152094431432,
        0.0014139934494632102, -0.00029369641743784685, -0.001728921009072356,
        -0.0015710828505405869, 5.283034732825559e-5, 0.0016791235504663212,
        0.0018294469072688557, 0.0003492137312356598, -0.001447996474336891,
        -0.001961746622481053, -0.0007454375227018244, 0.001094428279051686,
        0.0019002225333510925, 0.0009602316300673427, -0.000852149214121899,
        -0.0018738315758672296, -0.001161567712009353, 0.0006504861608821523,
        0.001921598968783393, 0.0014882867096281983, -0.0002803471349409753,
        -0.0018106299778117025, -0.0017405891245985533, -0.00014579128396937334,
        0.0015320219625258868, 0.0017882304759349113, 0.00041243769851078034,
        -0.001326628773835325, -0.0018342408287727388, -0.0006368886035064648,
        0.0011860347217421468, 0.0019772161487173322, 0.0010019190542080968,
        -0.0008829749599186532, -0.00199737655889674, -0.0013507833532094768,
        0.0004665583026441725, 0.001818643852011543, 0.0015008891186458102,
        -0.00017538089116849852, -0.0016703628447887514, -0.0016138033754773216,
        -4.834712764041106e-5, 0.0016068965641458629, 0.0018401619199280694,
        0.0004174582085867042, -0.0014001453184370703, -0.00199023496523425,
        -0.0008304972292238651, 0.0010319025324046112, 0.0019266132846912157,
        0.0010667324158989983, -0.0007453264184078772, -0.0018494425833690603,
        -0.001233972069357838, 0.0005463884859912022, 0.001871607532883515,
        0.0015234117214941254, -0.00020838032342640998, -0.001781622134763997,
        -0.0017900534698057175, -0.00023053401289078665, 0.0014952354925367624,
        0.0018457817964590735, 0.0005286544561770266, -0.0012413045308576932,
        -0.0018461611403757378, -0.0007319081563224488, 0.0010889314776026133,
        0.0019538971883911304, 0.0010574936194899902, -0.0008147921322512828,
        -0.0019903441662958606, -0.0014164353866415857, 0.00039062984029022974,
        0.0018116115120037635, 0.0015844939852765211, -6.031876278728577e-5,
        -0.0016145372561583108, -0.0016607601563429011, -0.00015684599709357532,
        0.001525903597138471, 0.001845287316108198, 0.00048753741311475217,
        -0.0013427993557260567, -0.0020060304266601905, -0.0009058199789175967,
        0.000972548058976775, 0.001950512333220078, 0.001168737647796428,
        -0.0006422459884326257, -0.0018283541644228095, -0.0013114122296997658,
        0.0004347320495835111, 0.0018141797122377921, 0.0015559541652308308,
        -0.00013110525878593134, -0.0017409931491393056, -0.0018271534271727206,
        -0.0003079265840233922, 0.0014586926045354644, 0.0018987991074906497,
        0.0006395688998716417, -0.0011599632668920275, -0.0018617915342842972,
        -0.000832440603033972, 0.0009846379368440208, 0.001925135219741564,
        0.0011137675492238087, -0.0007382440750876504, -0.001970543548470431,
        -0.0014710880491973829, 0.00031909090062903767, 0.0018019523768628629,
        0.0016619630359259799, 4.9066653642395805e-5, -0.0015626936942149082,
        -0.0017116465539332177, -0.00027095040835076016, 0.0014386940064807802,
        -4.418990760743195e-5, 0.009007188705291175, -0.029947182060681105,
        0.022583271549926384, -0.001899469086013789, 0.001869594957039685,
        0.000661777505103588,
      ],
    ];
    const result = wavedec(data, "bior6.8");

    const reconstruction = waverec(result, "bior6.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_bior6.8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5020777213419083, 0.9269717759639085, 1.2132143438887257,
      1.327139538682237, 1.268584523837393, 1.0689861441846025,
      0.7824758591775656, 0.472240709197707, 0.19552093133331944,
      -0.009110767493827054, -0.12916047819568263, -0.17864048772549898,
      -0.1915924476837116, -0.2105075654795182, -0.2727100072053522,
      -0.3982667765050413, -0.5825948022101461, -0.7957513749845082,
      -0.9887102415698481, -1.1051587122880626, -1.0959381961837127,
      -0.932542317534202, -0.6162610949644599, -0.18057779713573008,
      0.31395921213848427, 0.7913476043499176, 1.1756039250671002,
      1.4065247146278845, 1.4520712863127456, 1.3145071024074448,
      1.0289027937487156, 0.6544412448768673, 0.2606618828604526,
      -0.0880351049183895, -0.34593307644310917, -0.4944271967459277,
      -0.5434642352818917, -0.5258592531071061, -0.48611004873260405,
      -0.46667231765779243, -0.4952584825037172, -0.5764355000522791,
      -0.6896947596833989, -0.7945241344406122, -0.8412352193296628,
      -0.784827816899248, -0.5983737523739295, -0.28247318180207515,
      0.13173546263669594, 0.5869710031555461, 1.0107591985098217,
      1.3304677592659884, 1.488930749524829, 1.4569833497303017,
      1.2399365247367142, 0.8764510101518552, 0.43007444256650285,
      -0.024553973199522905, -0.417572934046603, -0.698120802414276,
      -0.8436252439049463, -0.8621050660519475, -0.7871459470554029,
      -0.6669962552153734, -0.5506439955009703, -0.4744359709233864,
      -0.45261663520507656, -0.47414541565327656, -0.5065513689653292,
      -0.5057995101336408, -0.42961581041986874, -0.2508260077451622,
      0.03277119523394073, 0.3946425938284807, 0.7830185731750212,
      1.1310033865308744, 1.370998838187366, 1.45004241836098,
      1.3423847300156695, 1.056250181646749, 0.6330915954285005,
      0.13943258599928698, -0.34684202543478954, -0.752567526665826,
      -1.0240194244079042, -1.136887515465165, -1.0992816147712856,
      -0.9472385622081266, -0.7340076743191415, -0.515873843765841,
      -0.338073588651745, -0.22427796991149035, -0.17218148742443096,
      -0.15618131142614394, -0.13634184063373966, -0.07125800412789651,
      0.06855234680880357, 0.29023818129389284, 0.5739629117642757,
      0.8753537913617044, 1.1346213209284461, 1.2902353195137957,
      1.2938724461192188, 1.122979030970653, 0.7878181935996491,
      0.33116677672058814, -0.17941846145873364, -0.6650614464296483,
      -1.0516701567784015, -1.2849598841813874, -1.3409319003665452,
      -1.2294357765351107, -0.9901041803804114, -0.6817726155608878,
      -0.3680392790803508, -0.10250747332431487, 0.08272864025428517,
      0.18264505745866505, 0.21769339917826738, 0.22563967069146482,
      0.2490580512611888, 0.32177402835882, 0.4577998882604914,
      0.6456700248281199, 0.8497213102305363, 1.0181116442421856,
      1.0956609185662185, 1.0383560724106458, 0.8258946219315992,
      0.46906777060742844, 0.010004090462497311, -0.48498819341004384,
      -0.9384468418529495, -1.2776808320118134, -1.4499041954492498,
      -1.433055085206813, -1.2397952990554781, -0.9138080331638828,
      -0.5193436658928883, -0.12655951669101007, 0.20382750922161225,
      0.43294123259186906, 0.5503323216722912, 0.5733411284456779,
      0.5396173776171184, 0.49485718219944114, 0.4789770237693737,
      0.514298988372343, 0.5987867126318456, 0.7060812550883273,
      0.7923605245535308, 0.8083122491822101, 0.7131981726837642,
      0.4874221521893056, 0.14033933196143117, -0.288819042966166,
      -0.7373572124838478, -1.1315149018383546, -1.402022640992286,
      -1.4991745078406526, -1.4038554691202634, -1.1319000460993351,
      -0.7307363072582966, -0.2691014070573473, 0.1777431491159418,
      0.5438153422368243, 0.7855451022963407, 0.8892277935071056,
      0.8711967471691475, 0.7708955957959496, 0.6387539519258386,
      0.5220115799136233, 0.4520944045503376, 0.43671125026730057,
      0.45862343327678423, 0.4813427982638882, 0.460257802179002,
      0.3563064587825411, 0.1486514976107069, -0.15696759799486565,
      -0.5264809401857837, -0.9029842476446428, -1.2183365902749856,
      -1.4081802956126244, -1.4268174831790175, -1.2583579755674972,
      -0.9214085374471792, -0.4660979078582172, 0.035943834470508584,
      0.5063528953152426, 0.8761202369298364, 1.0992739246885554,
      1.16102634417916, 1.0786068414871535, 0.8947710381363276,
      0.6657372424219662, 0.44661913465731173, 0.27798215631821505,
      0.17681576431845375, 0.13407132717976322, 0.11925028369693333,
      0.09075150723541042, 0.009239394722963978, -0.14946751927744656,
      -0.38537535091110053, -0.6715898868658647, -0.9587467177542239,
      -1.1856614318761731, -1.2936896237816646, -1.2413198432494852,
      -1.0154056004482626, -0.636208040063686, -0.15488526203237235,
      0.3561279130069859, 0.8176949344722704, 1.1601556578637415,
      1.3373656471827116, 1.3353662889888818, 1.1737443993923076,
      0.8994922375897489, 0.5749673491963903, 0.2629413393640227,
      0.012380689646666276, -0.15163513161830705, -0.23152033703176111,
      -0.2536076543762565, -0.25847689329322565, -0.2877841300126876,
      -0.37104704726148613, -0.5158373212384142, -0.703965222144369,
      -0.894729231876491, -1.0345184067193334, -1.070438908322926,
      -0.964589096829771, -0.7053908318816426, -0.3130553573778959,
      0.16234056907605623, 0.649908625614811, 1.0721381102749936,
      1.360963831114219, 1.47197757999576, 1.3934711964586974,
      1.148222549414777, 0.7876623328234357, 0.3798696413608245,
      -0.0057019912355738, -0.31312141136891497, -0.5109953102631216,
      -0.5970896158274956, -0.5956386630404754, -0.548228696309017,
      -0.5007136624594468, -0.48957426208666516,
    ]);
    const expected = [
      [
        2.460434749277186, 2.227071661884314, 2.835508703439208,
        2.049512827438137, 3.176797473838495, 1.8264905268089866,
        3.1247740864154108, 1.967592827406561, 1.8770691747034602,
        -2.157561017660673, 0.02433604383786285, 2.203648993860815,
        -2.314401155410236, 0.13232029792706715, 2.2631761650423408,
        -2.5273068191723653, 0.3282934276010462, 2.280562020716724,
        -2.787774646848249, 0.6343205225147402, 2.200917696277481,
        -3.0355068354598354, 1.0257347367076923, 1.9957346238545304,
        -3.2084127544679166, 1.450292588662241, 1.6705385699206212,
        -3.2611062375632125, 1.843426573206936, 1.2636166026719642,
        -3.1785040828219184, 2.14721968639087, 0.8349182270276717,
        -2.9803546532123053, 2.327410368814386, 0.4487163910600552,
        -2.722451644955646, 2.435337949877532, -0.032451264223706616,
        -1.6464809305743384, -0.7109501183083766, -1.654003572747128,
        -1.6129324816540616, -1.2833793085852887, -0.7514530776242285,
        -2.0644982463623283,
      ],
      [
        1.790074750153428, 0.5073369779591489, 0.8722506304956448,
        -0.2689025456122833, 0.027998070449606755, -0.9536774371274435,
        -0.9052774446472831, -1.5156420150030279, 0.3080899709091039,
        1.0981428596246863, -1.7181764540013096, 1.0483580124196372,
        0.3661428941092146, -1.4418381170401917, 1.4104026138818642,
        -0.37214579467628445, -0.8486523577440434, 1.3738812477188882,
        -0.9092036119710412, -0.11938052561157798, 0.9596916374178392,
        -1.0909315607990626, 0.5245206770822508, 0.3020279853449554,
        -0.8706173097552832, 0.8880969110009953, -0.3920331419175096,
        -0.32292320295008664, 0.86151327924368, -0.9048492870495978,
        0.3786171375296512, 0.4530767916618045, -1.0737023134905193,
        1.0138282068565974, -0.21325927609568665, -0.8396825156975802,
        1.3844492952782623, -0.9786550698042874, 0.03447483413062462,
        0.18685803533442566, 0.6293609174267998, 0.030586674243826235,
        -0.22788050210098723, -0.6605818907361471, -0.18413973485094556,
        1.2060082907713456,
      ],
      [
        -0.24834189533528223, 0.6815483967993016, -0.4453959930249863,
        0.33657654970079987, -0.2559494094715353, 0.1322379625780963,
        -0.33363219297959323, -0.010340615846417777, 0.10617627215478678,
        -0.07074815836008018, -0.03764714894251345, 0.11666328798507564,
        -0.05345196946875382, -0.08050016929955447, 0.10603521572766861,
        -0.013932584605473051, -0.08539627287647657, 0.09989888621212671,
        0.007178050674627538, -0.11537244210251457, 0.0747230601990485,
        0.048251555128243036, -0.10510499783422948, 0.05395537441598259,
        0.0641138896526102, -0.11791319302162123, 0.020188570629903067,
        0.09754150782927618, -0.09088547115819831, -0.007544365292549655,
        0.10009222594007151, -0.08731350228230836, -0.0409828019076143,
        0.11926111521028641, -0.04706552460366374, -0.06630549903621576,
        0.10416165482772737, -0.03271124408344196, -0.09020649078192691,
        0.10701035034816062, 0.013112733287819481, -0.10485973011917443,
        0.0749758557262961, 0.029555535204640184, -0.11248708751203382,
        0.0645884109527352, 0.07147425921623425, -0.11181529043252314,
        0.021199175292804243, 0.08085965998432801, -0.10092765424196071,
        0.004850793694974131, 0.11037547021807813, -0.08528018205707447,
        -0.0410973066077515, 0.10588392680699593, -0.058804468087785576,
        -0.054156056521291185, 0.11800897174358618, -0.03342957763243011,
        -0.09326643410717472, 0.09722505685126842, 0.0014165254396802107,
        -0.0946205089108687, 0.09195389730881172, 0.027955237603950526,
        -0.11966113116189557, 0.05979055637353357, 0.04962799521335372,
        -0.05930601928523932, 0.07661566188876237, -0.24270128029877405,
        0.27883976379174247, -0.08862519389064309, -0.0605585434890397,
        0.1122113385503301,
      ],
      [
        -0.00038855849706647587, 0.005279646553746436, -0.03111275519549051,
        0.09969490112309276, -0.08756151715601107, 0.011221309299155092,
        -0.0013303915120620527, 0.0006304899916303383, 0.0019467775534239284,
        0.001424565755587184, -0.000424364919071012, -0.0018623477124295731,
        -0.0015357075760315344, 0.0002705138587940615, 0.001890726713944536,
        0.0018132906439089266, 7.800567654519044e-5, -0.001751877281732924,
        -0.002019731625839333, -0.0004933433389798236, 0.0014252111245765704,
        0.00198978802372142, 0.0007125639339294106, -0.0011955399585285233,
        -0.0019495714239896357, -0.0008419900352012932, 0.0011021257091490154,
        0.0020705018464424636, 0.001138667005325139, -0.0008696911382655211,
        -0.00213181129808204, -0.0014971328085437562, 0.0004563491671115659,
        0.0019525916613645777, 0.0016468035611241338, -0.00014520374059002984,
        -0.0017472603519638717, -0.001673586614234352, 4.482044847764488e-8,
        0.001708269089157448, 0.0018443419670033274, 0.0002490780840777619,
        -0.0016332379166348627, -0.002078111243919491, -0.0006665105527031041,
        0.0013266660948822555, 0.002099789869443751, 0.0009743477614727243,
        -0.0009893967440300806, -0.0019753812250044717, -0.0010863031389492222,
        0.0008329718509327766, 0.0019806464381483557, 0.0012667504460602513,
        -0.0006739856248104874, -0.0020604292608129987, -0.0016036590113791861,
        0.0003026975696134443, 0.0019375385243014954, 0.001827817059902895,
        9.617649616391541e-5, -0.0016579336528395744, -0.001832543849609309,
        -0.0002947753489642574, 0.0015044645828672489, 0.0018762191367955152,
        0.00045769080619495906, -0.0014480276717756023, -0.0020711147327988986,
        -0.0008089726977294921, 0.0012109083974025, 0.0021597113429961115,
        0.0011828905670435768, -0.0008181369093195855, -0.002016640220698189,
        -0.0013384519366276965, 0.0005569252003334271, 0.0018932815662522128,
        0.001421910822636068, -0.0004234622941135151, -0.0019260103796253335,
        -0.00167166121727475, 0.0001402978892433189, 0.0018711417185248904,
        0.0019436259901019501, 0.0002899210156499417, -0.0015856256803009443,
        -0.001986779378341498, -0.0005790106890419212, 0.0013120214662800268,
        0.0019293413249304048, 0.0007069656196668356, -0.0012095579565405907,
        -0.0020235738272405632, -0.0009506251557213066, 0.0010495452444974898,
        0.002149054812048856, 0.0013313527762232255, -0.0006715106519271825,
        -0.002047281186108786, -0.0015636010207483652, 0.00030659288850413274,
        0.0018281728131105401, 0.0016052784161479337, -0.00013467623853893017,
        -0.001756523657225408, -0.0017322376181928775, -5.760529957518526e-5,
        0.0017365859617668373, 0.001991158403320552, 0.0004484195022197261,
        -0.001504128778415794, -0.0021024444826507078, -0.0008211302470851724,
        0.0011497515446929167, 0.0020034126665284917, 0.0009780002264650634,
        -0.0009484710038189189, -0.0019680645139196983, -0.00111720045326182,
        0.0008291872572939009, 0.002068934439848522, 0.001434979652591083,
        -0.0005228835877908178, -0.0020349729798922536, -0.001732301396034145,
        9.914972043707608e-5, 0.0017837911192982066, 0.0017964935723256362,
        0.0012357936189048213, -0.008821855782139294, 0.006724864931743773,
        -0.0033714307579356785, 0.0017124501290068901, 0.002042291689426764,
        0.001079853865380384,
      ],
    ];
    const result = wavedec(data, "bior6.8");

    const reconstruction = waverec(result, "bior6.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48575386127094944, 0.8986020213228492, 1.1804749276485782,
      1.2995661153350917, 1.2557529531048472, 1.0788432723838217,
      0.8201821811801269, 0.5397196984960713, 0.29169446160753865,
      0.11237964473657053, 0.012796856267597911, -0.02193475572492573,
      -0.02658224497540751, -0.04471871023719909, -0.11542128134560614,
      -0.26113161113449784, -0.47977780996606967, -0.7432127835892876,
      -1.0024743669432161, -1.1986930830229527, -1.2770712713648065,
      -1.2005735899250425, -0.9599953209771486, -0.5779078205997155,
      -0.10542136931164532, 0.3875909038117866, 0.8266077321544176,
      1.147677335077788, 1.310237190138202, 1.3046044429371217,
      1.1524721745945583, 0.9004064097928759, 0.6079925035311544,
      0.3335304234789019, 0.1207270343278386, -0.010449949152771032,
      -0.06663605906443154, -0.0770826889436172, -0.08392933268454272,
      -0.1292497292924557, -0.24217210393086608, -0.4293521830724184,
      -0.6712541460718368, -0.9252688285640445, -1.1350159852839685,
      -1.2436463872721086, -1.2079519287122884, -1.00985359639369,
      -0.6624283339854802, -0.2089164120869091, 0.28518587743748536,
      0.745197082905123, 1.1025004717258235, 1.3084647762426047,
      1.3438400958693308, 1.2215068405329583, 0.9820323596829351,
      0.6831909401302505, 0.38601974975643477, 0.14077653958505737,
      -0.023854309069790858, -0.10578517712549462, -0.12768384030876112,
      -0.128857910891685, -0.1529887704353342, -0.23484889792679758,
      -0.3893794544723265, -0.6059221816988993, -0.8491326022863954,
      -1.0664574585258277, -1.2004370913699174, -1.2028869851852169,
      -1.047515815367639, -0.7378726760386922, -0.30860540639410383,
      0.1804054715927484, 0.65577676965347, 1.0455548123380916,
      1.2939185860507334, 1.3722707227756414, 1.284187549042491,
      1.0631549649477419, 0.7637239417522839, 0.4482680259445724,
      0.17254407929411608, -0.026496703559873547, -0.1377843293239159,
      -0.17649900154056666, -0.17778796634936164, -0.18551001228654934,
      -0.23889719654541636, -0.3605248764298038, -0.5486533887216926,
      -0.7759275959542453, -0.9948553740561463, -1.1488126539350354,
      -1.1859471160650332, -1.0726096882461311, -0.8030146456230537,
      -0.40270070045553574, 0.07517097874615972, 0.5599416039522518,
      0.9777270946667951, 1.2665661212309374, 1.388954649967785,
      1.3388921682402681, 1.1418637116858477, 0.8478533730346822,
      0.5191277436832253, 0.21574763010544634, -0.01772841787713736,
      -0.16121399010064574, -0.22168413155850664, -0.22889978739900807,
      -0.225460889763409, -0.25376125789412074, -0.3431662878717684,
      -0.5006698513522871, -0.7074261584424744, -0.9221046199676979,
      -1.0903322738893484, -1.1579777622284182, -1.085060355678828,
      -0.8568740779882221, -0.48954992793427654, -0.028588195171455208,
      0.4594359682835462, 0.9001590216087474, 1.2266737604207554,
      1.393220928230833, 1.3841758824237123, 1.2162892927627802,
      0.9337363508006241, 0.5972260731801389, 0.2698137480554354,
      0.0028121560687744407, -0.17486807588796927, -0.26148342170369115,
      -0.2803153898817767, -0.2712981548347372, -0.2786083269834876,
      -0.3373851241298913, -0.46294949576204597, -0.6452677610089562,
      -0.8501106643997658, -1.0267067338952254, -1.1200804529434156,
      -1.08509181199363, -0.8987403460213466, -0.5676759167669411,
      -0.1289812164360374, 0.356111620170368, 0.8142197381252856,
      1.1748005504870367, 1.3846859354078962, 1.4188065971697565,
      1.2846492685719266, 1.0194701387287273, 0.6809981556474922,
      0.3338912239037225, 0.035190243789086306, -0.17778391070737165,
      -0.2942727149244725, -0.33014490620481324, -0.32132603496317913,
      -0.3123493500871398, -0.3429646849823274, -0.4362023284013926,
      -0.5909189408509159, -0.7807428733504216, -0.9597563615217034,
      -1.073585559299415, -1.0732210297049685, -0.9281892763895149,
      -0.6358123161890036, -0.22420156426477028, 0.25188287624234434,
      0.7214727555558994, 1.1117848529096142, 1.3632629664704345,
      1.4417951569529248, 1.3452916174710177, 1.1031385181862376,
      0.7687251019877118, 0.4068715387051929, 0.07917266496029662,
      -0.1692662374148891, -0.3185997062571988, -0.3765332683090785,
      -0.3737381270918584, -0.3536659645335407, -0.3593957031440209,
      -0.420853237474201, -0.5456374861774785, -0.7157887244357264,
      -0.8913663244409004, -1.0200194632154844, -1.0502449291049558,
      -0.945093067339233, -0.6929340712831538, -0.31257070867862546,
      0.14868027160607722, 0.6236381316859042, 1.0387241715310604,
      1.329164576449009, 1.4524196364264563, 1.3967351111591793,
      1.1828585016267747, 0.8585757689025333, 0.48741561977084313,
      0.1342331126265467, -0.1489046871888347, -0.3332199413769811,
      -0.4177060428352003, -0.42666200258944487, -0.4010431037867267,
      -0.3858890768583319, -0.41703177792911417, -0.5104417384003277,
      -0.6569100360769187, -0.8234403527846574, -0.9610669449360693,
      -1.017220511810568, -0.9496229660167905, -0.7382820003516362,
      -0.3925786579907505, 0.04840382714398608, 0.5225508309132939,
      0.9569486546145902, 1.2828976187741779, 1.4502431113924406,
      1.4377055278759874, 1.2568262465684419, 0.9486512912373867,
      0.5739862431277101, 0.19956460610817617, -0.11658427979607505,
      -0.33712773272582347, -0.45201329750878155, -0.47820543228334716,
      -0.4528064203795247, -0.42139545508077314, -0.42456918958187306,
      -0.48608576192656316, -0.6056022823118073, -0.7578540202361319,
      -0.8985297088168458, -0.9754386442669144, -0.9422446401899396,
      -0.771380874590865, -0.46292038495396814, -0.047122933051980176,
      0.42011628224689324, 0.8679889188003989, 1.2252511001565907,
    ]);
    const expected = [
      [
        2.6797343688634307, 2.234392952036712, 1.9506967299709768,
        0.180329004272186, -0.2834020732003314, -0.556278838054536,
        0.7931139554137033, -0.017091202206606287, -0.473967340742167,
        -0.3335150842214135, 3.1914958565903175, 4.8411326373737325,
      ],
      [
        -0.0164901216399438, 0.38138912730481306, 2.801529751346427,
        -0.05116548641167345, -2.224126913142311, 0.7192856531904985,
        2.0575231221889125, -1.4678676240414994, -1.434014727190974,
        2.542748773601234, -0.26541367740751776, -1.7662702116895976,
      ],
      [
        -0.09396401943441736, 0.7701106537069641, -0.5847284283768268,
        -1.310109472979943, 2.324469095893795, -2.5268010190176473,
        1.4907281387912676, 1.297295643561255, -3.830851477276645,
        3.0933874329637323, 0.5605495183832113, -3.3604012056775803,
        2.975714599181451, -0.8280721959023414, -1.0040724218487007,
        2.292289048415778, -2.90565133033135, 1.984086757877887,
        0.7400687215768653, -2.921805004614397,
      ],
      [
        0.09914353095650451, 0.40061861251811454, -1.0371959516229738,
        -0.35260120798020517, 1.8220893225429362, -1.7705058306082384,
        0.06589917085486086, 1.7661188184913528, -2.0186588759206,
        0.5141189840973062, 1.264665341542617, -1.72625459898228,
        0.7120106815391815, 0.56527488052559, -0.9542106671228868,
        0.4872952307863708, -0.027779802279494566, 0.05690913059824314,
        -0.14852013663412994, -0.2799364863631488, 0.979952197846988,
        -0.9986737542137026, -0.12211430513758378, 1.528953144675092,
        -1.757125855688913, 0.3235237137390118, 1.5695870113607495,
        -2.1311057051222986, 0.7982107885291582, 1.1674133391484192,
        -1.960074174472873, 1.0188059243991792, 0.5486231909300889,
        -1.0564689159789153, -0.5497432972124716, 1.4210634557925568,
      ],
      [
        -0.2266060066568145, 0.7894540271394697, -0.5095286391086483,
        0.10148502851532301, 0.06907660771350047, -0.19067539127221847,
        0.3821299992976111, 0.23725563613814032, -0.48827585041592697,
        -0.10648128576978058, 0.20547963693712187, -0.1941297573680651,
        0.17392850139483906, 0.42951879517420655, -0.337787359158547,
        -0.33610214862130705, 0.23338251629563675, -0.07813609483975859,
        -0.03912921499877504, 0.4774681379966843, -0.08010041025434128,
        -0.49410485311457125, 0.12512301658542085, 0.09331185243494654,
        -0.17077910864100615, 0.37616652566391834, 0.1961188429800637,
        -0.5115712261198774, -0.08787118930176986, 0.23162190889887077,
        -0.1732504133848541, 0.17845963892877137, 0.3956855357497211,
        -0.37258877195714013, -0.32700647999276694, 0.2614316247853193,
        -0.05642763436357442, -0.02761922166032338, 0.4546387738819606,
        -0.12146532656486252, -0.4981625285940237, 0.15302497203958712,
        0.11705095897188267, -0.1555768088191392, 0.36516342905850385,
        0.15451189780402583, -0.5300844843350917, -0.06410602192393997,
        0.25867801171044086, -0.15617215282320604, 0.17754552335605825,
        0.3597560575613914, -0.4037597766255021, -0.3122360008231277,
        0.29179983711519225, -0.03741240382610297, -0.021546663100006788,
        0.4283271535810454, -0.16068991465911156, -0.4964914089424924,
        0.18455867073201132, 0.1393733967914369, -0.14544217286620573,
        0.3496406531795024, 0.0979337280228112, -0.2883004270580255,
        -0.4108562172486387,
      ],
      [
        0.269156220572295, -0.03225042498102791, -0.09481485945647658,
        -0.07447913492624504, -0.009481253595291454, 0.040696092377679335,
        0.0357616315870568, -0.01011251418779498, -0.0435269541913476,
        -0.02319247799036451, 0.03991750107183203, 0.09068937047277842,
        0.07934697947900902, 0.007523190303516083, -0.07109804309976214,
        -0.09667246661294168, -0.05467377374908872, 0.013055109606814025,
        0.04718238474702781, 0.024198892602645773, -0.024080623014058302,
        -0.04207130341587691, -0.0037392317805617927, 0.06139645897873671,
        0.09375599360765645, 0.057873343555996805, -0.02392813750987927,
        -0.08927963912349536, -0.08944713319741021, -0.03095737885002828,
        0.03196182288501702, 0.04686648953536067, 0.0095396671592747,
        -0.034465052612425634, -0.03402029392228487, 0.018440276716523436,
        0.07810233440600513, 0.0877478613587949, 0.030425532111991626,
        -0.05315833144142411, -0.09880011303244284, -0.07419722477920146,
        -0.006021963113197276, 0.045344939275656145, 0.04023545021244798,
        -0.006016823985030937, -0.03961249228453978, -0.020000706220266472,
        0.04085973124672955, 0.08791933150796509, 0.07294227034158011,
        -0.00037127778053033106, -0.07731692798735387, -0.09892146356525279,
        -0.05279003344888736, 0.017415762106400952, 0.05203469241605668,
        0.028545905554986224, -0.020178299462327992, -0.038532710658640945,
        -0.0014247604443850589, 0.06088926852541494, 0.08941866557015694,
        0.05056166043021568, -0.03151527889912553, -0.09408377884319888,
        -0.08988691862788466, -0.027682090072525804, 0.036918472897173316,
        0.05170147082350218, 0.01365571582968597, -0.030846992184865068,
        -0.03103167416004785, 0.019661977954949544, 0.07605955934147837,
        0.08203712744128912, 0.022657052716234076, -0.05994568963543343,
        -0.101912564527082, -0.07288040460188551, -0.0016377557158996914,
        0.050595016669081894, 0.04487199755128624, -0.002214306032765887,
        -0.03638324540948966, -0.01774943672315943, 0.040810688496897736,
        0.0843531013700218, 0.06616087092503077, -0.008101427341745935,
        -0.0828681081135421, -0.10018932651942604, -0.049883670642547714,
        0.022581694801949465, 0.05729996822781798, 0.03284492797013859,
        -0.016760028122201877, -0.03581380696394488, -9.769063012169104e-5,
        0.059451252627791475, 0.08444896388143244, 0.043103881115274995,
        -0.03870421993116391, -0.09805156843613463, -0.08928878885393765,
        -0.023447780801347337, 0.042523190508794696, 0.0567439578733816,
        0.017516714660124864, -0.02788174341299249, -0.02895996834533516,
        0.019896409450590777, 0.07319373097192682, 0.07589229577145552,
        0.01498246804872188, -0.06612147332332112, -0.10406443268528369,
        -0.07052271336986567, 0.0035947952040862458, 0.05630680881571966,
        0.04950317287853672, 0.0011389245057637177, -0.03394591153734748,
        -0.01647005904578902, 0.039822545114985036, 0.08011450243168536,
        0.05916829572985503, -0.015501082076953667, -0.2021218914374094,
        -0.054411330081230336,
      ],
    ];
    const result = wavedec(data, "coif1");

    const reconstruction = waverec(result, "coif1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5026957146335815, 0.9273028726995629, 1.2118720734769222,
      1.3229510107569824, 1.2613031015931853, 1.0597468512718575,
      0.773789495421474, 0.46746518849326857, 0.19792039967485026,
      0.0025401231551183123, -0.1082801176119012, -0.15106469551695828,
      -0.16209234743342987, -0.1851268065030151, -0.2573167952275674,
      -0.39699117139456486, -0.5965868963753109, -0.8226410727829039,
      -1.022980172858454, -1.139399280352656, -1.1227023325668242,
      -0.9463280873318349, -0.6150804886060224, -0.1666472573994295,
      0.3346589009720936, 0.8105979698007115, 1.1852139093917229,
      1.4007580328709546, 1.429575012321601, 1.2791708850690255,
      0.9893297998723038, 0.6220662920628298, 0.24691964283508744,
      -0.07480653022736472, -0.3030509926274953, -0.42617247452688917,
      -0.46070857213946315, -0.44399360754161543, -0.421696186477759,
      -0.43359278916719174, -0.5013104697019491, -0.6212476294720253,
      -0.7645494485629946, -0.8842079725083348, -0.9275284419081208,
      -0.8508113285534356, -0.632493509132369, -0.28132642545114117,
      0.16263573490400163, 0.6347030254377314, 1.058444515441794,
      1.3618294560418422, 1.492804359349215, 1.4305988205911804,
      1.1900655163571736, 0.8180336225936371, 0.38257819876852084,
      -0.04219250695265886, -0.3921721723213188, -0.6262970582322398,
      -0.733554368275664, -0.7324398630196268, -0.6632272750161007,
      -0.5751872000995948, -0.5121223282899481, -0.4999656533091734,
      -0.5396270295204847, -0.6069138982643136, -0.6595356690231672,
      -0.6493832583287524, -0.5369111639261402, -0.30388166264400024,
      0.038896574153459484, 0.4509801309730933, 0.8692263947055967,
      1.2207469809913516, 1.4388522847427838, 1.4781779986360783,
      1.325337407542144, 1.0024971034189258, 0.5629707855123256,
      0.07984883541821147, -0.36964299319311594, -0.7203464818757794,
      -0.9321190742032666, -0.996536954117444, -0.9359157508939988,
      -0.795105577445375, -0.6282828929616364, -0.484162757169634,
      -0.39339605877461203, -0.3613161437888112, -0.3678109627176033,
      -0.374269281887453, -0.33574049218979907, -0.2151099157479736,
      0.004439620590602933, 0.3119997964270994, 0.6686128780305298,
      1.014343173758856, 1.2811689987822386, 1.4086325542213867,
      1.358448187940546, 1.124469960437058, 0.7355115633741456,
      0.25022844705549263, -0.25480873515888985, -0.7010715043753939,
      -1.0243121041695447, -1.1872780078230745, -1.1859706481321282,
      -1.0481023718068627, -0.8243110935749042, -0.5744464218043175,
      -0.3524116255082464, -0.19334575706846108, -0.10628913965697706,
      -0.0740566307160418, -0.060202843767483895, -0.02116228087430211,
      0.07966486754267305, 0.25960595498583805, 0.5094676824540368,
      0.7933510043281804, 1.055746706035899, 1.2342763064938291,
      1.2749872713448787, 1.1464182880758822, 0.8488957795228449,
      0.4166501508462592, -0.08792648113698237, -0.5866470436033866,
      -1.0016674976437319, -1.2716169169208642, -1.3639371008448034,
      -1.2805694654973836, -1.0557439073126553, -0.7465388909875743,
      -0.418622038433919, -0.13071776991507328, 0.0783951742812069,
      0.19723769681837103, 0.241668043918145, 0.24778947015923541,
      0.25970822753793377, 0.3154094100868552, 0.4344782070215044,
      0.6109132779834472, 0.8129782258900037, 0.9902419992260452,
      1.086118537098312, 1.052790925040731, 0.8647537297700716,
      0.5274949540249019, 0.07899859416273033, -0.4165045241620987,
      -0.8812073047497546, -1.2399002733431115, -1.4358516862294668,
      -1.4426452587489864, -1.2691926682752186, -0.9567838177443444,
      -0.568958508082537, -0.17670569320779034, 0.15740264465115045,
      0.39232597212851794, 0.5158302382445128, 0.5443198579923348,
      0.5154912921208463, 0.475859909312289, 0.46647361215975336,
      0.5105507403629799, 0.6062625707561059, 0.7265534694084892,
      0.8260874340223011, 0.8535803492537559, 0.7663811624115142,
      0.5435531099278312, 0.19403379281031155, -0.24235793237666173,
      -0.7015425961490374, -1.1080115789635698, -1.3908975793868221,
      -1.4994801539931937, -1.4144218072596098, -1.152039210232544,
      -0.76058591009065, -0.3094462718224132, 0.1261580095257605,
      0.4812860958340935, 0.7143968375822738, 0.8144199729943595,
      0.8002495179401428, 0.7130115141382061, 0.6032374643382395,
      0.5163100484976, 0.4799344387398957, 0.4968336316621353,
      0.5445110841329687, 0.5821090770776897, 0.5625714343915234,
      0.44695036250648645, 0.21712273065048215, -0.11645336177597782,
      -0.5140940985361392, -0.9137429598002242, -1.2438283349357477,
      -1.439110678412931, -1.4557182712617032, -1.281719203585066,
      -0.9406269760318162, -0.4869315494290703, 0.005329780637483378,
      0.4582699979568952, 0.8064076352810483, 1.0096580973280793,
      1.0600626215680287, 0.9808083247276786, 0.8179882209571301,
      0.627319785304188, 0.4592474656053289, 0.3462019965342668,
      0.2951949140947958, 0.28754200391976936, 0.2856825129549711,
      0.24524936821100035, 0.12920263921204322, -0.07969976334338191,
      -0.37141819514694924, -0.708215107498178, -1.0316122254222544,
      -1.2751614610928708, -1.379980276714134, -1.3092611900034683,
      -1.058160533525171, -0.6565590393108245, -0.16390047711064495,
      0.3427671479211879, 0.7847733397651303, 1.0980806445926463,
      1.2460058148742723, 1.2254691208119235, 1.0654189748739817,
      0.8179857545423719, 0.5446765862523981, 0.30109872156929673,
      0.12400489181613472, 0.02381789705928672, -0.01562424023106207,
      -0.03020152811551173, -0.06342708073877429, -0.15236547519208515,
      -0.31527867251275266, -0.5442860540183838,
    ]);
    const expected = [
      [
        2.711720303963564, 2.349398928061936, 2.05008271510284,
        -0.015669647604717424, -0.6015975800297789, 0.44853584262897733,
        0.1867957398537877, -0.7154624868136159, 0.6315671228873533,
        0.08475550923353874, -1.3507313935178573, -2.5268803218472162,
      ],
      [
        -0.03766852458734148, 0.3558188709138905, 2.339199356899516,
        -1.2473448822393651, -0.25387882901740505, 1.413584094404378,
        -1.2117509278021852, -0.20976842591728842, 1.6337925738459502,
        -2.016726077037952, 0.21003752152393848, 1.1133011583204842,
      ],
      [
        -0.09561845625830585, 0.7618795969115222, -0.2522182270570299,
        -2.5338928877851474, 2.795030824712562, -0.33567155886467026,
        -2.139303284864477, 2.451741497920668, -0.5289817180066213,
        -1.9381621423878603, 2.7124596889746755, -0.7527398162643805,
        -2.3336820628503956, 3.22161748004199, -0.4538675523841989,
        -3.190110473294693, 3.3685487968082035, 0.6158064679829399,
        -0.0649949271023827, 0.646344358253964,
      ],
      [
        0.10352817491490462, 0.40383887719612266, -1.0766950117355982,
        -0.20753544620538336, 1.5798117751727954, -1.692105496623525,
        0.3095357160021394, 1.4642700478898176, -2.0802819906893615,
        0.9185531490637949, 1.0950679306685274, -2.2384198975249414,
        1.4916476687499363, 0.5404818970430042, -2.1267099460923595,
        1.910236325240856, -0.08954294728673355, -1.7653929405110134,
        2.0899221773013905, -0.6681939942161063, -1.2302028926430977,
        1.999539008001829, -1.0804062215971746, -0.6352637559822225,
        1.6681606700274718, -1.2488199093817138, -0.10730773962802001,
        1.1784899866963665, -1.1512106472750236, 0.242954120037251,
        0.6481225254179198, -0.8254452798745634, 0.3622498942536325,
        0.379955623276227, 0.011098967592459801, 0.09107378550390476,
      ],
      [
        -0.2340469978938416, 0.8130435625878686, -0.5386035358549499,
        0.11407112250714625, 0.07691688565027384, -0.1457174330632342,
        0.4199102395446976, 0.11574349469969508, -0.5667175904244084,
        -0.006335479423729879, 0.2496159746944705, -0.1474214147444147,
        0.25883094239725346, 0.23955228224506797, -0.5379194386270145,
        -0.16423414913472284, 0.37316282136296214, -0.06969466699210751,
        0.07714424980826028, 0.30031703780417623, -0.43409668116636974,
        -0.32188520661181846, 0.42273842275190004, 0.07091905447947282,
        -0.08616623661823261, 0.2811927540065645, -0.2796677914863662,
        -0.4414522004768346, 0.3902099821273435, 0.24345832479990376,
        -0.196421215980419, 0.18345171997735307, -0.11029937830565831,
        -0.4935680495709224, 0.2859574753930144, 0.4095428204433714,
        -0.23107943490784044, 0.026208420740641357, 0.03516325636695113,
        -0.46398634362539515, 0.13651359317685563, 0.5320507730909079,
        -0.18482571330437217, -0.15789101891424387, 0.12348362545885072,
        -0.35681350239036314, -0.021449138010695395, 0.5835126214970301,
        -0.07076258016381999, -0.33004002032123897, 0.1345522357397927,
        -0.19359076467752623, -0.14942412986039924, 0.5523225573228382,
        0.08256393810403588, -0.45403634630032197, 0.06593511732788253,
        -0.008433580734514712, -0.2157909152044548, 0.4453631633682621,
        0.2376316826715861, -0.5044583049658142, -0.06657599572534535,
        0.1593754271463313, -0.11544090687879857, -0.11563605978216845,
        0.35397874467595203,
      ],
      [
        0.2785047126703123, -0.03497826492685419, -0.10099963502166484,
        -0.07820364572151703, -0.008475182887538638, 0.0438409566306759,
        0.03753715542276213, -0.009128594604303274, -0.038825789892364945,
        -0.01234420373544373, 0.051725065203139894, 0.09264641975472473,
        0.06440394392026991, -0.01927557486669819, -0.09427035051793173,
        -0.1020145197583261, -0.040966292433328694, 0.03350622156331815,
        0.06029138066269041, 0.027202421675940995, -0.021159276606528665,
        -0.028717173511483254, 0.016830301020288405, 0.07111256258197528,
        0.07494962503629762, 0.01183394326167261, -0.07315744172468468,
        -0.11160365938354244, -0.07253666225800895, 0.010035974401064567,
        0.06815796832291784, 0.060777078663650265, 0.008408058881031294,
        -0.02970525631113696, -0.013635866301365497, 0.03882463172751974,
        0.06951071580957521, 0.03660635669355977, -0.042786118795360185,
        -0.10487375715435882, -0.09581926121721043, -0.020798305570661646,
        0.059930946760884146, 0.08452829734149445, 0.0435246503396918,
        -0.015032053320008364, -0.03302719186154361, 0.002610646877381077,
        0.0487424398801442, 0.048920799532956215, -0.010345306030245329,
        -0.08338128670556652, -0.10528781349978943, -0.05153859292066529,
        0.03804689266907385, 0.09359443205033946, 0.07655305848582217,
        0.011999841511685698, -0.03723520890410546, -0.02983355526149671,
        0.01676529660916006, 0.04549120935069994, 0.016539533606567642,
        -0.051984347476794875, -0.09850770267804349, -0.07472903228647514,
        0.00803148913916547, 0.0864166706955654, 0.10029599623019878,
        0.04525569155532478, -0.025617253961649853, -0.05168276754346476,
        -0.019764445744805657, 0.026611578900306417, 0.03153217130310996,
        -0.017743966004308616, -0.07668779956380369, -0.08460424283893267,
        -0.02275255154863995, 0.0650895408096201, 0.10962294189818277,
        0.07715613968467835, -0.001140532322994374, -0.05852388229001662,
        -0.05315775050877696, -0.003908539082496543, 0.03101967614643859,
        0.011672664139585193, -0.044408407240211716, -0.07839537476609956,
        -0.046773020258681575, 0.03488525931124904, 0.10262946961292972,
        0.1003915996301601, 0.030290352780623003, -0.0493517738686734,
        -0.07642939743244054, -0.0396036959945387, 0.01493043699584412,
        0.029725880562093486, -0.008586845763075873, -0.05695853060640608,
        -0.05803405884406203, 0.003059507284077634, 0.08106710633080537,
        0.10957578809120021, 0.06117031518520687, -0.026794373810337207,
        -0.08487541499100541, -0.07281296631401014, -0.013248865472949376,
        0.03248209586947595, 0.02308538577848386, -0.02458341823677415,
        -0.05343451851410048, -0.02279127608771354, 0.04994650240812156,
        0.10246443251087015, 0.08409278145395518, 0.00348395531764787,
        -0.0771346171705268, -0.0964108399562599, -0.04726117817179741,
        0.019502800984472227, 0.04388042437046808, 0.011974498766625877,
        -0.03347161220761812, -0.017483067174077774, 0.11640697394684604,
        -0.04613179157569459,
      ],
    ];
    const result = wavedec(data, "coif1");

    const reconstruction = waverec(result, "coif1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif2", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5018978543515881, 0.9257325133433449, 1.2096359130381429,
      1.3203230532411172, 1.2587975488583227, 1.0581327892295798,
      0.7740166664685564, 0.4704972445390358, 0.20450380463126389,
      0.012963412831145826, -0.09436955821135953, -0.13472587615753467,
      -0.14500289970671054, -0.16934524457556266, -0.2449384327623702,
      -0.3897728446345014, -0.5956285441141976, -0.8282017322433077,
      -1.0344737298455418, -1.1555692968866553, -1.1419277152026415,
      -0.9669755476173163, -0.6358063028435733, -0.18656456869340748,
      0.31599271562443465, 0.79336623214263, 1.16963670446767,
      1.3873995977652882, 1.4195508700919968, 1.2741633635389544,
      0.9913692539541239, 0.6331008075876667, 0.26826117349667006,
      -0.04302482726892021, -0.262257211855818, -0.37945379737951257,
      -0.412559734679905, -0.399732612615284, -0.3866470483855133,
      -0.4121986426789441, -0.4963668640889958, -0.6334266381987436,
      -0.7923231855474107, -0.9241892454694076, -0.9751486123591309,
      -0.9011755656460221, -0.6812123501254035, -0.32513140893099646,
      0.12562672871123082, 0.6051120912981014, 1.0360883766970241,
      1.3463499780959445, 1.4842727917886638, 1.429895843570911,
      1.1988978883767643, 0.8385477656537266, 0.416646444537185,
      0.006163836263501421, -0.3307106892420182, -0.5552875318942583,
      -0.6588908763588499, -0.6617613045261475, -0.604844689835154,
      -0.5367295937816963, -0.49918188508107164, -0.515039947964149,
      -0.5816007155844264, -0.6712065597549197, -0.7388929093190986,
      -0.7351407720593357, -0.6204529675427805, -0.37797144391228105,
      -0.02080361238111228, 0.4079813836806533, 0.842910259628645,
      1.2095543564325006, 1.4407191307242269, 1.4915065773471086,
      1.3496168270936257, 1.0383855322173692, 0.611802823388317,
      0.142696361573926, -0.29309258266159477, -0.6327609361832678,
      -0.8390237306876092, -0.9061337461227074, -0.8581677118481461,
      -0.7402223889538084, -0.604905315368278, -0.4976396407429955,
      -0.4445504640099066, -0.44600295398726647, -0.47739753385629696,
      -0.49696313770276834, -0.4584939381074755, -0.3256985574329918,
      -0.08439441899571998, 0.2507054275932729, 0.6365265471423869,
      1.0095711744144218, 1.2994765728460205, 1.4449745048279339,
      1.4083873383498338, 1.1851052968301052, 0.8056795242185333,
      0.3299448755272857, -0.16548407522240047, -0.6033968431829339,
      -0.9220221919618556, -1.0871436506908507, -1.0975051235041642,
      -0.9823758953784801, -0.7920704793188774, -0.5839338793108295,
      -0.4073827879707823, -0.29177260487550527, -0.24009814933758844,
      -0.23002622769629283, -0.22188048252811454, -0.17142413015347066,
      -0.04405902198012651, 0.1733123911510095, 0.4659382820185703,
      0.7921748018458229, 1.091698507988564, 1.2990785973493946,
      1.3594308590549136, 1.2423013167075694, 0.9503091414966395,
      0.5203246860412165, 0.016763282244483292, -0.4815067012489298,
      -0.8975863352557034, -1.1724335068400413, -1.276485823651942,
      -1.2143384979630434, -1.021497914301521, -0.7541637813612102,
      -0.4746778396052897, -0.23629915481767882, -0.07107462690490246,
      0.016254473491702337, 0.04692339289638948, 0.059896003994796915,
      0.09895497431691597, 0.19856418110728447, 0.37224504958400817,
      0.6065694728185994, 0.8624463846573166, 1.0835235745364427,
      1.2097054695452163, 1.1924579392375578, 1.0080674831643754,
      0.6654738502827717, 0.20659377006643173, -0.3011205373082688,
      -0.7782425062975104, -1.149899825270977, -1.3613807099322126,
      -1.3891430319571754, -1.24466649662903, -0.9703276637306039,
      -0.6284117624034706, -0.28602617619787424, 0.00035872214490006993,
      0.19698004087352583, 0.29859720977664295, 0.3267826486699347,
      0.3213214711229152, 0.32708327538124204, 0.3798555172883358,
      0.494870715991927, 0.661059483903149, 0.8425944148406863,
      0.9874241539046065, 1.040700322767743, 0.9597234103699,
      0.7265989936116338, 0.3553148233994771, -0.10870330278488297,
      -0.5966558208908816, -1.030270564465483, -1.3383036736028928,
      -1.471739454835724, -1.4140812585217446, -1.1843040709119226,
      -0.8318135884955764, -0.42468817791161045, -0.03409262076175845,
      0.28135128619620586, 0.487491469196175, 0.5800853277953728,
      0.5826098454303086, 0.5372108679348386, 0.49126506458865193,
      0.4831020155456803, 0.5306110126904604, 0.625695634686686,
      0.7360314736978346, 0.8137073465218972, 0.8085584856885419,
      0.6827765475220567, 0.42301416012502135, 0.04678592438311879,
      -0.398639386079646, -0.8448039741303119, -1.2161726973892275,
      -1.4464813647754395, -1.493422381194355, -1.3481377609309904,
      -1.0372286422415877, -0.6167946849396865, -0.15994114605651544,
      0.25923880525628284, 0.5813706302763126, 0.7734737609783869,
      0.8339142309614427, 0.7896266522305918, 0.6865164895237573,
      0.5756306465356349, 0.4987036623924853, 0.4767970095106933,
      0.5049257815337953, 0.5540189998131989, 0.5796760805260532,
      0.535435484529192, 0.3871006421313955, 0.12436759897341604,
      -0.23335412960994745, -0.638600607098757, -1.0247983036261008,
      -1.3204665641546618, -1.4653066093356018, -1.4242906150617023,
      -1.1963080979300988, -0.8152228600760287, -0.3430236380504965,
      0.14333594783712109, 0.5682896400378651, 0.8733268078947376,
      1.0282941198404116, 1.0357430466014468, 0.9274590433689004,
      0.7542317048572484, 0.5715715448536304, 0.42504109356728725,
      0.33890955127361566, 0.3109547015896092, 0.31464756449184916,
      0.3080636100063014, 0.24714374165060937, 0.0998100784568679,
      -0.14279346748122523, -0.4609576792245321, -0.8085078439705674,
    ]);
    const expected = [
      [
        3.664808254570535, 3.646405667863615, 3.596759552900312,
        3.4140976041684015, 3.5125914135072085, 3.812845195342411,
        1.9265512547846577, -0.5007858703097603, -0.5808975483840485,
        1.0092389631064118, -0.3490481969368286, -0.7090072397878395,
        0.9974825260484961, -0.19852326465772574, -0.7980343314540758,
        0.9113705048167973, -0.06154950542139201, -0.8076651914386901,
        0.8026301125184307, 0.013208966637512094, -0.8504140604857833,
        1.2890468698541468, -1.2685123025899943, -1.5733476714618417,
        -1.145709414258198, -0.055468330421143706,
      ],
      [
        0.868518332883786, 0.36599353310614974, -0.8501250055836624,
        -0.418945786845154, 0.28281637270813087, 1.3991374524743558,
        -4.065959117325667, 2.183964875672808, 2.248108497498978,
        -4.31155360705121, 1.5515011633295952, 2.9452940103417373,
        -4.09435431770308, 0.7360450024424356, 3.217233464940547,
        -3.5059749068976505, 0.17810547462901774, 3.012480372332353,
        -2.9768181413900687, 0.18262388343741948, 1.1903293430427055,
        -1.0454733312059066, 0.4683180763709704, 0.5929118230396704,
        -2.2145660766549997, 2.7415106156259443,
      ],
      [
        -0.4594182804950193, -1.0263615636802188, 1.7969236879665118,
        -1.1176192009170254, 0.0035305146872750296, 0.6735500723856516,
        0.319563452478335, -1.1410939232402646, 1.0309832679920108,
        -0.21843554193464781, -0.5873915611501256, 0.8456031938722999,
        -0.53091492378672, -0.010664714788241608, 0.42867220410081824,
        -0.5776504248840947, 0.4635236927926669, -0.12502647071539302,
        -0.34996993571945273, 0.7295202260371358, -0.6914385424927326,
        0.10193657338647324, 0.7263205620874152, -1.1437350823557053,
        0.679744486248033, 0.4506117180727908, -1.3794233078282245,
        1.2580082691687908, -0.042514123892329794, -1.3422570110942769,
        1.71097103147003, -0.6513267410643431, -1.0342603540307287,
        1.9390562195389434, -1.2823531255985368, -0.3272088470482705,
        -0.5303680578572121, -0.5848527297304672, 0.831995686396077,
        0.7204471141951585, 0.49046410649999844,
      ],
      [
        0.1379775552305267, 0.07746761837791429, -0.47333113969011104,
        0.7825524760261658, -0.4089369089956319, 0.16548775368586716,
        0.03308361950426431, -0.1737493669469785, 0.1919882424008232,
        0.07625544334852746, -0.26694571915451143, 0.07679486132393594,
        0.13358246214050304, -0.18121318819899818, 0.10050710960203997,
        0.16068022045179864, -0.2514715050599757, -0.022195911025438077,
        0.20547092882211673, -0.1410366517802024, -0.00486879519858828,
        0.20934922568633035, -0.19124670226101997, -0.12391103204888128,
        0.23505407341674786, -0.06166998381915988, -0.10185491978311616,
        0.21149818313395774, -0.09926752945175482, -0.2063759903166988,
        0.21637309730665594, 0.040046833295533824, -0.16997032868176565,
        0.16630638213400034, 0.004697531578822389, -0.2517192601816944,
        0.15377995672321756, 0.1424843102719502, -0.1949139496770783,
        0.08307258707203002, 0.09833226192909378, -0.24999166396593114,
        0.06100685745637168, 0.22384533588492836, -0.17162021977277753,
        -0.0207715048465426, 0.1615416418415061, -0.2012928095281694,
        -0.0417687264949571, 0.26682290135671655, -0.10534116512598128,
        -0.12338575111071086, 0.18074611512797015, -0.11575020068492238,
        -0.13223632853468548, 0.26229834750786074, -0.010523684059574875,
        -0.20318810556207406, 0.15178353309777948, -0.011355483832707998,
        -0.1907205612631505, 0.21128985028742628, 0.09227805100019248,
        -0.24346601393337006, 0.08069999055311938, 0.0839572708600523,
        -0.2888431343871761, 0.5598482807096757, -0.454077664076246,
        0.17802246436887909, -0.13312305001858796, 0.1850456191001191,
      ],
      [
        -0.056206404132595665, 0.16098363620099274, -0.08781231576959268,
        -0.017003458959737074, -0.009373857951125988, 0.0039122185583230495,
        0.01205740241157243, 0.007980693871732088, -0.003841896761801698,
        -0.011623672834419395, -0.007473073320410864, 0.0050698102467682405,
        0.014247068442414084, 0.011071810184797942, -0.0021690959564212957,
        -0.013866096215873267, -0.013720407615023007, -0.0021892979286103915,
        0.010027861236996718, 0.0119594079362408, 0.0024855605087642707,
        -0.008801583804419226, -0.010754749013888306, -0.0012425846246085855,
        0.010777279404590327, 0.013640960217162731, 0.003986272837886541,
        -0.009922016032611397, -0.015704224690775946, -0.008257985528448308,
        0.005558980968063594, 0.013304952417626862, 0.00844428140679245,
        -0.003740348445874363, -0.011281148447399112, -0.006857555397463455,
        0.0052940791307969125, 0.013363937270279997, 0.009119126221844883,
        -0.004221553839244599, -0.014790574025372046, -0.012990634417950016,
        -0.0003804389472255677, 0.011747335882366376, 0.012777424316006746,
        0.002489453365757502, -0.008937316865310699, -0.010581927471178183,
        -0.0010448653111121225, 0.01028235136202477, 0.012116257253391096,
        0.0020064543968314175, -0.011176825759921934, -0.01536890577173304,
        -0.006506942032475189, 0.007637036285591979, 0.014575257411876427,
        0.008566986649598195, -0.004222318659624625, -0.011627155709218389,
        -0.006899426050281579, 0.005037049043638267, 0.012321119662364008,
        0.007420990475750262, -0.005636662199373444, -0.014876952567508994,
        -0.011496699649505946, 0.0018700808733347193, 0.013469536940731504,
        0.013203397433364867, 0.0018574058945060009, -0.009777819205263067,
        -0.011033367339413796, -0.001268804228463398, 0.009674149926765355,
        0.010855433261488023, 0.0006452537766882628, -0.011611662994174,
        -0.01426842363768788, -0.004303453338493407, 0.009712174436347159,
        0.0154172156111778, 0.008003106890987448, -0.005437643282107405,
        -0.012578497038481141, -0.007305435341461839, 0.004725518678502339,
        0.0115668699512275, 0.006326432427355239, -0.0062619683498310935,
        -0.014214450623722048, -0.009546596620328123, 0.004121382380668637,
        0.014744073273468264, 0.01290125617130475, 0.0004567857768195242,
        -0.011220169719189148, -0.011800598906401213, -0.001482413464465644,
        0.009394863559002192, 0.010193436149539914, 3.836285857168744e-5,
        -0.011330617180450113, -0.012721211848177625, -0.0020931934348814543,
        0.011335923471602756, 0.015504237690179834, 0.0066361748028213405,
        -0.007264500957342431, -0.013811419447919788, -0.007637817464895315,
        0.004795749307438263, 0.011421180114256904, 0.0059529879601476834,
        -0.006217172563675728, -0.013131230930561911, -0.0075889870587862425,
        0.005928557213729576, 0.015254215678484402, 0.01176977534860239,
        -0.001572929712901657, -0.012925850033731102, -0.012439701123929444,
        -0.0012548689432457624, 0.009749244158493446, 0.010228540738401334,
        4.946605110872366e-5, -0.010671424710088686, -0.03850036749074357,
        0.10529973512787644, -0.056501248119747084, -0.013604570783835297,
        -0.004532193272892731,
      ],
    ];
    const result = wavedec(data, "coif2");

    const reconstruction = waverec(result, "coif2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif2_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49469791494721516, 0.9141327601520648, 1.198378299560729,
      1.3146434131378135, 1.2628425097547902, 1.073741107048477,
      0.800253045505545, 0.5040904652551534, 0.24105052908710706,
      0.04850329907940526, -0.06194174155906368, -0.10492088492336642,
      -0.11499046751714152, -0.13521512356358228, -0.20364991025329293,
      -0.34121168431839, -0.5440853284308147, -0.7826813689806447,
      -1.0075299648854503, -1.1607621613058796, -1.1904182394369125,
      -1.0640821528601627, -0.7784544303090202, -0.3624192831538836,
      0.12729185725540745, 0.6169628677910763, 1.0308307138478334,
      1.306658655768026, 1.4083411159679635, 1.332638134903127,
      1.108535087707456, 0.7894786394452149, 0.44042774977206095,
      0.12287072581662306, -0.11859616849603549, -0.2649611507281587,
      -0.32478624321672267, -0.329184140299429, -0.321201847376981,
      -0.34240003091956045, -0.4200935932041879, -0.5585379765300191,
      -0.7363525449827912, -0.9109112448765636, -1.0286848372225947,
      -1.0390170400460808, -0.9079284073816707, -0.6284866908872351,
      -0.2250774118745636, 0.2496375710056043, 0.7245248206696382,
      1.124358784767732, 1.385467496089945, 1.469009567845589,
      1.3687951947135857, 1.1118541386690777, 0.7516746990197356,
      0.3557730663871603, -0.009417361754961495, -0.292742954022814,
      -0.46828519408557817, -0.5388146827212479, -0.5320919724973302,
      -0.4911175764136219, -0.4609056475649029, -0.47518733133387714,
      -0.5464390240687252, -0.6617822095837798, -0.7858245476173564,
      -0.8697695031035126, -0.8645420735369993, -0.7346495776088448,
      -0.46927302025316237, -0.08772364975911068, 0.36225241830110544,
      0.8131081713777849, 1.19116319265544, 1.4321589795150842,
      1.495070176580267, 1.3709282484776235, 1.0845849610337763,
      0.6890138848339489, 0.2535150499559087, -0.1513763590763521,
      -0.46871838734985993, -0.6662704100750135, -0.7413573864753891,
      -0.7185033875631549, -0.6406115525227107, -0.5560289410249198,
      -0.504813561461524, -0.5076801989197468, -0.5604050342588787,
      -0.635089134492978, -0.687957321710158, -0.6717252335462717,
      -0.549407575334392, -0.30605040201643263, 0.044652564296274844,
      0.4606694687223343, 0.8789912589894272, 1.2284412899375494,
      1.444980527905782, 1.4859135012511584, 1.3396255639072727,
      1.0285225424834847, 0.6044490441240363, 0.13764378770799096,
      -0.29818168358499175, -0.6411499388164688, -0.8533558641719463,
      -0.9270729700653368, -0.8837163722135897, -0.7660090421578739,
      -0.6254342278361325, -0.5081740484592222, -0.44306200149165775,
      -0.43453833908129363, -0.4623264789190725, -0.4878589638085987,
      -0.4657882259307178, -0.3576364541022281, -0.1440851856652321,
      0.16728405473338487, 0.5408860152260249, 0.9191298170185979,
      1.2342345033415252, 1.4231295824098615, 1.4419162657989442,
      1.2764251313926922, 0.9463063312028184, 0.5016131474776813,
      0.012620481247370335, -0.44477406580624373, -0.8046761033809589,
      -1.02422942534833, -1.0910837637470832, -1.023672802661038,
      -0.8644160412677718, -0.6676544824917012, -0.4853751927271082,
      -0.3542726124292, -0.2873180340824442, -0.2718580236060871,
      -0.27462163976867887, -0.25228835045770764, -0.16487764669390148,
      0.01149110951309723, 0.27577880341069194, 0.5994954785818334,
      0.9312597792208294, 1.207495891453215, 1.3667819664177694,
      1.364428915139007, 1.1837621762584747, 0.8413308072029843,
      0.3846982489841164, -0.1167678539170255, -0.5860200603948136,
      -0.9541118285415078, -1.1739871689740409, -1.229118317134609,
      -1.1350740396785597, -0.9337996103219085, -0.6821304424682825,
      -0.43742286741035263, -0.24383866577767943, -0.12260879402571523,
      -0.0685812061599913, -0.05377986198189127, -0.036954572814384024,
      0.023387258083815088, 0.15584097701474237, 0.3662606250776547,
      0.6338006491470138, 0.9139761933502416, 1.14813017438877,
      1.2770909495498337, 1.2557341042578811, 1.064889830108644,
      0.7176332759441302, 0.25831727647431935, -0.24556410939340023,
      -0.7168755660608515, -1.0846093932225627, -1.2982810392501325,
      -1.3376358111507716, -1.2154733202050951, -0.9730414467699587,
      -0.6692211474763549, -0.3661887352493731, -0.11504937739283805,
      0.05510883034007252, 0.14217251443503787, 0.16890555354743353,
      0.17448113415439853, 0.20190108495645492, 0.28457018400369605,
      0.43549324708241866, 0.6419047066898769, 0.8667857320984624,
      1.0570049338307586, 1.1561570011661413, 1.118977396830261,
      0.9237754410954808, 0.5797624057220385, 0.12735298637735143,
      -0.36880235945884504, -0.8325472742232022, -1.1918097768029208,
      -1.393450258031256, -1.4139286134387543, -1.2633421854660174,
      -0.9819631278877192, -0.6301856488093079, -0.2743491058042313,
      0.028143654385838768, 0.24087094626417438, 0.3547933417513774,
      0.38761537771704047, 0.37645206051258445, 0.36578796267613173,
      0.3938625153784468, 0.4809839331719368, 0.6227771460983046,
      0.7901311023301232, 0.9359325644273442, 1.0069691166163937,
      0.9580722967084743, 0.7649757450601176, 0.4326316179120233,
      -0.003201188485761758, -0.48166965136456635, -0.9286470238409141,
      -1.2719798421596054, -1.456632459211894, -1.4561998801321006,
      -1.2781089820067302, -0.9613223300883272, -0.5671365166717363,
      -0.16529824585992348, 0.1812479026600241, 0.42937846936529867,
      0.5635578226198982, 0.5966416708607287, 0.5637195374284072,
      0.5106977532308264, 0.48059586035635077, 0.5010634273857381,
      0.5762925129286058, 0.6853865186263906, 0.7876234538612491,
      0.8333194674309434, 0.7775825172156094,
    ]);
    const expected = [
      [
        3.660552389141051, 3.6290341108385418, 3.5813604322809134,
        3.396368430101666, 3.4972586987457617, 3.7737397052201014,
        2.0345062631871893, -0.6446220242591834, -0.506524288452242,
        1.1452085785671904, -0.6868603585712716, -0.4186744945279567,
        1.0831423507728355, -0.7256484655521611, -0.23790397565315236,
        0.9322054231349279, -0.8196224491380877, 0.02775570004475182,
        0.8103921039957436, -0.9907486275811227, 0.3443121620231584,
        0.6595571925946061, 3.2303907500279347, 3.029786608855605,
        2.9420887277658774, 3.1781872901726644,
      ],
      [
        0.8727984322323029, 0.36942933611821804, -0.8572957600482382,
        -0.4229495801654728, 0.3281672427306777, 1.1625622034369791,
        -4.142627072610833, 2.8818094224505635, 1.4181674137602405,
        -4.227118707665565, 2.683953346589784, 1.2192152721995229,
        -3.476839330412569, 2.5182950541731692, 0.1977982122021461,
        -2.5350946470133664, 3.0487775410423854, -1.1203837980412956,
        -2.2251507594295403, 3.7635853113493187, -0.5065752475075953,
        0.13709185841458937, 0.0020911614816706385, 0.17421107103204309,
        -1.53462288153704, -1.8050218884958278,
      ],
      [
        -0.4516630287682165, -1.0274394084036718, 1.7967773713953652,
        -1.1332556243705865, 0.026842646268435816, 0.6761791230204937,
        0.17039436619403575, -0.8798174225734026, 0.8849732382953394,
        -0.42301438456050106, -0.07158742505290415, 0.4068279233937754,
        -0.6150095478741955, 0.6583719795557471, -0.34616304059993586,
        -0.366776399806876, 1.0798491188291877, -1.1312266423755548,
        0.23344361645053793, 1.0666906684939554, -1.693599350709672,
        0.9753461452087426, 0.641998379461097, -1.8536361412734064,
        1.5986009193158952, -0.02990777874655083, -1.5682291991705384,
        1.8820270452165433, -0.6998790336883333, -0.9454872322909966,
        1.7193743813426425, -1.1193722540718545, -0.2076407585560359,
        1.1556747640094316, -1.1720207963596225, 0.38495229551066634,
        0.15779056624125704, 0.026877091925088237, -0.06542639491080812,
        -0.18712985216167932, -0.3984617055426862,
      ],
      [
        0.13830390499584658, 0.06728396294873273, -0.4590135873012132,
        0.7690118963455882, -0.3993849603078371, 0.1555025277332023,
        0.0429136985122615, -0.1760628811715556, 0.16898033443757365,
        0.10431948642804095, -0.25394864722741783, 0.03844380687153325,
        0.1532216853119109, -0.16890499910642603, 0.050688722633409296,
        0.19762987394016887, -0.20609972727555823, -0.09069557258887913,
        0.20901973496815446, -0.09216317998599309, -0.07215721677714977,
        0.22462468285238466, -0.09910558531097825, -0.20182263911908283,
        0.1913224653981332, 0.027196689037098702, -0.15704055209489173,
        0.17722196247130362, 0.031132357823036128, -0.25730147708045964,
        0.10503612991617904, 0.14753955945194513, -0.174532739134112,
        0.07279486454996606, 0.14082759515198517, -0.2384569924106228,
        -0.021428342397363326, 0.22682337200005667, -0.11837189179647137,
        -0.051784412806443754, 0.19329468250383025, -0.15196671561597327,
        -0.1458749542958968, 0.23699918706296533, -0.007608598453112528,
        -0.15277660693089076, 0.17150365785558944, -0.027573000850512532,
        -0.2267621864295622, 0.17362078404088643, 0.11991541472000032,
        -0.1945582991746983, 0.08390438128646528, 0.09210106951851027,
        -0.23741871190902336, 0.057373546219156045, 0.2205230020907036,
        -0.1618258409849794, -0.03847330221391017, 0.16614523124928618,
        -0.1751681432849227, -0.07300087458192454, 0.2596559147454755,
        -0.0648396862986355, -0.1526960592179097, 0.15644059083597747,
        -0.12980028183636844, -0.07560073829734854, 0.07892887712351171,
        0.019910353003019788, 0.08318829870807845, 0.0002541835179836624,
      ],
      [
        -0.0549977827850052, 0.15811019750787544, -0.08640260348497114,
        -0.016293029154640967, -0.009223407151207499, 0.0033612283373485206,
        0.011482219149485919, 0.008160951390315065, -0.002975691734604837,
        -0.011055751313621005, -0.008092453236249271, 0.003549704123323895,
        0.013228759905857446, 0.01176408497126714, -7.502072503943677e-5,
        -0.01212439672172577, -0.01395453607444145, -0.004262053514699384,
        0.00803418042373414, 0.011970430644309577, 0.004499151530981169,
        -0.00686607930742854, -0.011105391069012215, -0.0039422770799207195,
        0.00813786788125917, 0.013806438395254817, 0.007333649673277434,
        -0.006024592090060843, -0.014663729668730214, -0.011091760384724134,
        0.0013204905054271315, 0.01145176791814991, 0.010549052573471204,
        0.00010491276795385044, -0.00968292671857644, -0.009414051403656302,
        0.0007934407441302276, 0.011377625218310282, 0.012143676989142285,
        0.0017294483444231826, -0.01097488980125021, -0.014797940186122495,
        -0.00639492231679002, 0.006730594486946259, 0.013047017510702596,
        0.0074257147363608455, -0.004334323096935829, -0.010986082683267034,
        -0.006257074586371368, 0.005360252934722486, 0.012764078062469396,
        0.008529027428839481, -0.004126654256507463, -0.014115463186766715,
        -0.012501397974479557, -0.0006266724801216939, 0.011081757148238818,
        0.012542408573369817, 0.003082742075176702, -0.008118661351486249,
        -0.010570731332803873, -0.0021365180211477077, 0.009038534890322398,
        0.012094716712414438, 0.0035647168124160185, -0.009277152020369715,
        -0.014935172401409064, -0.008148798581536358, 0.005270078258551546,
        0.01365340509106721, 0.009998390028312742, -0.0017967006714467069,
        -0.010645699007284992, -0.008499444897114626, 0.0022985310092650904,
        0.011256456013744792, 0.009498188963781271, -0.0019340734924630692,
        -0.012885785878526219, -0.013305508318161203, -0.0024539154989879335,
        0.010326613607139894, 0.014010625956558003, 0.005807500186963908,
        -0.0064356316787555195, -0.011506244627728538, -0.005092905492185342,
        0.006353812032435497, 0.011678276079574551, 0.005409717312765742,
        -0.007073412634859502, -0.014373493528157349, -0.009500642110019858,
        0.0036477352974737275, 0.013707969751385003, 0.012078062671678557,
        0.0006343225649966549, -0.010086759952527636, -0.010550636133505733,
        -0.0008806424337944477, 0.009398009762408843, 0.010254448183618132,
        0.0004978395247415592, -0.011026151678892303, -0.01351128791795561,
        -0.004151094968248774, 0.009152977983944094, 0.014851239624896831,
        0.00815535325949122, -0.0046896390254755095, -0.012152886161805713,
        -0.007914897501733471, 0.0034807216764745747, 0.010960403580909876,
        0.0072261932569486435, -0.004445140996355853, -0.013165051338386642,
        -0.010455174944286515, 0.0018611067813630129, 0.013156355667382772,
        0.013559636943180763, 0.0028710174042564057, -0.009299586848798908,
        -0.012284794353196777, -0.004002140922441432, 0.007309201354145032,
        0.01080306517516541, 6.773208011460726e-5, -0.03412666537447447,
        0.033748586286808206, -0.01903103714916556, 0.010492094155359096,
        0.00977100576257184,
      ],
    ];
    const result = wavedec(data, "coif2");

    const reconstruction = waverec(result, "coif2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5044381880918702, 0.9327490181247677, 1.223763395694898,
      1.3428893970573628, 1.2878334138937062, 1.0872416322183653,
      0.7927254146796279, 0.46625871805984287, 0.16597908360306046,
      -0.06625882502767333, -0.21270789177441998, -0.2812199890326902,
      -0.30024804185078924, -0.3087805875920957, -0.34385233024092327,
      -0.4288466861334509, -0.5655933555218441, -0.7323181552237235,
      -0.8880525857975539, -0.9825070996643862, -0.9690423708125779,
      -0.8175690465462129, -0.524165220397243, -0.11493630852788048,
      0.35701806289683485, 0.8210387586540151, 1.2027256675787132,
      1.4390609337438658, 1.491416017367757, 1.3534834808132177,
      1.0523324986436204, 0.6423687417044188, 0.19361096395778882,
      -0.22300697453942106, -0.5499441203876135, -0.7537434841173185,
      -0.8297739183212767, -0.8001265308814849, -0.7054022363450833,
      -0.5925668542087505, -0.5019542396733399, -0.45665280927123125,
      -0.4568830349465899, -0.4807173051817476, -0.4909138333507907,
      -0.4461152429873414, -0.3135679680117655, -0.08011599907155459,
      0.24138914042475246, 0.6120320568415604, 0.9733720767105736,
      1.259215212278361, 1.40996587007117, 1.386235172832346,
      1.1784997174988203, 0.8104844645240423, 0.3353806214724857,
      -0.17433506944715008, -0.6412308414586132, -0.998193062813236,
      -1.2012271992784511, -1.236963044505235, -1.123289646467674,
      -0.903154684522683, -0.6331504872370157, -0.36969839348008243,
      -0.1561545651587561, -0.013875990690429996, 0.06072208903416254,
      0.09257150383225927, 0.11887778822333964, 0.17696355219888893,
      0.29217183866033003, 0.4689519730831199, 0.6874665230334089,
      0.9067000003574213, 1.0734452195721913, 1.1350790054058382,
      1.0530695047609286, 0.8139190479993585, 0.4348009003197587,
      -0.037632894645589665, -0.535199770865559, -0.9812245327176168,
      -1.3057880732443623, -1.4597665225428471, -1.4245000129064382,
      -1.2149311034066235, -0.8755590095991398, -0.4702111511539086,
      -0.06804701442082861, 0.2709522243585847, 0.5076873301651577,
      0.6302323892185088, 0.6534326757180797, 0.6121420145826242,
      0.5499500755413582, 0.5063081442935373, 0.5053092613547856,
      0.5489347619793087, 0.6164538043750326, 0.6701286462588182,
      0.6658074189588414, 0.565758087193857, 0.3505100482653384,
      0.026667525271267645, -0.3714028308962762, -0.7866513605041426,
      -1.1502061257419065, -1.3956212660734826, -1.4732686963471493,
      -1.3615419322960227, -1.0722421696542377, -0.648843148065805,
      -0.15797044864732815, 0.3240044716656109, 0.7262348134683304,
      0.9971010502658846, 1.1133059064954716, 1.082424115625737,
      0.9385174026351023, 0.7320502547423479, 0.51665819999968,
      0.33601628729065486, 0.21396901253273803, 0.15023927836362844,
      0.12263941914785394, 0.09509962802681907, 0.029396443512265114,
      -0.1024482129735198, -0.3082985710136978, -0.5711574573996456,
      -0.8508832323814672, -1.0921316948034037, -1.2367451397745097,
      -1.237688598662801, -1.0711997950146892, -0.7441827595836025,
      -0.29495313306156834, 0.21301744528804484, 0.703074114118323,
      1.1004400582052043, 1.3470039735816983, 1.4125241244100515,
      1.2997667226432081, 1.0425027279440107, 0.6969395920907575,
      0.32867198725333824, -0.0017576577829321316, -0.2513278852130048,
      -0.40220187653400846, -0.46294514298275624, -0.46322801861782076,
      -0.4435158234310282, -0.442445215583805, -0.48511887115903213,
      -0.5752960917400074, -0.6934776335790488, -0.8014165436704308,
      -0.8519877869682514, -0.802004723732328, -0.6248060997352232,
      -0.31944021533679023, 0.08595359936946051, 0.537604116744211,
      0.9658191069210132, 1.2988558028581858, 1.4778387745248813,
      1.4693221231089506, 1.2726035061516936, 0.9200914153094637,
      0.4706234011501741, -0.0027452784969790867, -0.4276988450327737,
      -0.7469715201512022, -0.928807664690849, -0.9713065310321984,
      -0.8998495658154263, -0.7584456225078614, -0.5972511530669384,
      -0.4593909758461857, -0.3703163073137208, -0.3322679312668363,
      -0.3251280552351883, -0.31335620293592803, -0.2571964641345513,
      -0.12527992135446991, 0.09461561686991316, 0.389457822013546,
      0.7211958825529956, 1.0334936345204266, 1.2635225166642636,
      1.3561175370949172, 1.2769755762358184, 1.0217405807607394,
      0.6187396707589605, 0.12459276199321109, -0.38642832158996804,
      -0.8369586328602623, -1.1617696995851805, -1.3202675100048382,
      -1.3034970142391593, -1.134175520525243, -0.859900462660843,
      -0.5412541656248082, -0.23768644224503177, 0.005477226733651197,
      0.1658854643399862, 0.2468980359426771, 0.27374573104488265,
      0.284252105247369, 0.31657119763612157, 0.3971066618934088,
      0.5317154241952453, 0.702479284899104, 0.8709492510577906,
      0.9871628080131483, 1.0022915051481271, 0.8818445809744975,
      0.6161612152445524, 0.22551991917483802, -0.2415600739274771,
      -0.7166487334933787, -1.1246134936308096, -1.398778220758971,
      -1.4946136251968312, -1.3988505994623577, -1.1319497474737712,
      -0.7433879959154285, -0.30087593212582886, 0.12399296211028948,
      0.4703647462488781, 0.6997055679364779, 0.8017883916150522,
      0.793889806980965, 0.7136254184720902, 0.6073572779982137,
      0.5171335749232355, 0.4694262395653276, 0.4684465506083534,
      0.49566238358183085, 0.515594331371168, 0.4864058415887159,
      0.3726025677821939, 0.15660905928617214, -0.15376940020620783,
      -0.5240207526858844, -0.8982853127706796, -1.2103296931733463,
      -1.3976858075565153, -1.4156988372456953, -1.2481908901732843,
      -0.9121923487889452, -0.45554710814473887, 0.05215797933550427,
    ]);
    const expected = [
      [
        2.2475517430297516, 2.245506456325798, 1.8151842907169202,
        2.2603597346334023, 2.224921015053726, 1.949891730171132,
        2.282688320420486, 1.9664640423036432, 2.1158050094150305,
        2.4190552215923358, 0.7815911295896553, -2.584843098044396,
        2.033010608646067, 0.2647937326749872, -2.2367196334633737,
        2.152159087181474, -0.14309360806286495, -1.9463876409398297,
        2.2296490396969504, -0.46698738933151757, -1.729413726510667,
        2.351657595229105, -0.8091331613469287, -1.5252149010766238,
        2.532377481563961, -1.2516617084722084, -1.2280233474549336,
        2.7025293341009236, -1.8052550566738543, -0.7477808712949323,
        2.742269991847612, -2.393634021315051, -0.06472535758818646,
        2.5412804865933527, -2.8819228223815347, 0.7494293442043553,
        2.0570325502787545, -3.1410222366621987, 1.5964259123288331,
        1.150632974473683, -2.4990689606847996, -2.4092705600296016,
        -2.2644640951748367, -2.4813892258342367, -2.5364314423220184,
        -2.340680438602228,
      ],
      [
        -0.2096913311144101, 1.697145415931524, 0.6951842288064074,
        -1.6252191582441753, -1.0444944573752377, 1.4117856731502687,
        1.0870082279317914, -1.145520458676308, -0.3949078626189581,
        1.4620216807476278, -1.5795990113524878, 0.5887884431302639,
        0.8889095985716959, -1.815728801775871, 1.495088863646432,
        -0.11085868645964711, -1.373591453514381, 1.9050701984341656,
        -1.1102651604123863, -0.4343224507788553, 1.6333859397833108,
        -1.6728687854379898, 0.5867217942031022, 0.8155368028116546,
        -1.5703514286765041, 1.2402454584623754, -0.15817419808841457,
        -0.8917121886875669, 1.2597827032033804, -0.8324834762006059,
        0.0018848195797951258, 0.6891937267209667, -0.9081670527043508,
        0.6545137673281448, -0.14108341829817694, -0.38701132974468994,
        0.6949034949118599, -0.47800855763135647, -1.4387110104240968,
        1.7585043029370864, 0.8693587076077699, -1.997487564221066,
        -0.3197066487321032, 1.8381141722750995, -0.42740331441768653,
        -1.082479924563874,
      ],
      [
        0.14921262853214354, -0.20539442879797457, 0.27337575728568747,
        -0.07864036508426388, -0.3800273027080616, 0.7143815877448546,
        -0.33643897757246255, 0.14838761821342333, 0.026666598624392274,
        -0.1188635002954223, 0.0800886519527636, 0.0710111563807154,
        -0.14196763609898244, 0.02097623304134841, 0.11275495116221791,
        -0.10185832662497606, -0.012415941428365626, 0.12258134176037079,
        -0.09398146095426796, -0.06875125162794035, 0.13905584966813642,
        -0.029084243006773813, -0.09612606830492676, 0.1118854082382361,
        -0.005362031232100377, -0.1272952502679052, 0.10057747359984168,
        0.06299253630425376, -0.13117082596448928, 0.04323647101243745,
        0.08084270505096373, -0.125090583712564, 0.016899548139727282,
        0.12923948761815235, -0.10153922823532895, -0.05065269665865862,
        0.12299056511340152, -0.06211993820194515, -0.07054349042926651,
        0.13689081406896372, -0.022775197913559468, -0.12457838553976755,
        0.1011230827208254, 0.03202798492195268, -0.1186858109274396,
        0.08153809607090302, 0.06564816023647267, -0.142851297043117,
        0.026665976676782145, 0.11252876582674158, -0.10383931450069157,
        -0.010690273808928804, 0.11961573553740831, -0.09667471529301236,
        -0.0631742985550673, 0.14111974948127992, -0.03324858310677867,
        -0.0958244547500322, 0.11191694013462904, -0.00842674089918146,
        -0.12358541680959918, 0.10470363949681373, 0.05844026502650448,
        -0.1334378366640415, 0.045545555435319046, 0.07922804159059785,
        -0.12621954317601627, -0.0004184870874899842, 0.37159753526745626,
        -0.683265855306773, 0.2018165705044389, 0.2449293828486505,
        -0.15023363892346, 0.18313358712758337, -0.14191143257547717,
        -0.0052874313680152185,
      ],
      [
        0.006909705780340156, -0.04238936294059492, 0.1198767329984559,
        -0.10109169479074841, 0.013883740593741044, -0.0018012817413909214,
        0.0009713115939606809, 0.002317484852000081, 0.001709263151257032,
        -0.00046057067560230104, -0.002178533540906663, -0.0018620776756651245,
        0.00022083574297798058, 0.00218788600822025, 0.0022372615135425604,
        0.00027692105150257365, -0.001979038843894876, -0.0025374338782325244,
        -0.0009077330965602726, 0.001460268426853781, 0.0024753336019185577,
        0.0012739024538944276, -0.0010176390941625047, -0.002308741083804087,
        -0.001432653750918389, 0.0008030182083553877, 0.002348014959826194,
        0.0017640097664110234, -0.0004683172101908118, -0.0023686942078767746,
        -0.0022297749407110103, -0.00015160772367408827, 0.002041196367762693,
        0.0024271703855947, 0.0007009908672902357, -0.0015639753513199347,
        -0.0023361729736808274, -0.0009507507355042733, 0.0013011806011391984,
        0.002346210518770233, 0.0012064684086145123, -0.0011103616394335237,
        -0.0025120303279826933, -0.0017051988346145689, 0.0006324360829100358,
        0.0024477161148734232, 0.002143827533208402, 5.6766140081272785e-6,
        -0.0020595698816844353, -0.0022325916570574015, -0.00040667470772753217,
        0.001730326837659987, 0.0022265080153659423, 0.0006293273001266738,
        -0.0016057392983052587, -0.00242917530314997, -0.001051286826266341,
        0.0013337835764817684, 0.00260875536481078, 0.0016288001725352677,
        -0.000749731947567431, -0.0024320654673187373, -0.0019556037131313836,
        0.00020955094685181294, 0.0020951298679439865, 0.002010263579999939,
        6.0231844874292285e-5, -0.001956465143050363, -0.0021778200377572795,
        -0.0003661424833193475, 0.0018672081263043322, 0.0025053599827639054,
        0.0009415513683437917, -0.0014659779059747805, -0.002601325728813916,
        -0.001479109900176827, 0.0008798387813770463, 0.00236955032446578,
        0.0016878198421782429, -0.0005037991261098485, -0.00218860583440493,
        -0.0018209021307917842, 0.00027565352664644504, 0.002197016277573273,
        0.0021758574910469295, 0.00018171315153674446, -0.00203747798237777,
        -0.0025138335320063574, -0.0008207414519032555, 0.0015441130415034048,
        0.0024980790206370973, 0.0012332941065777085, -0.00107133494277372,
        -0.0023218583460257033, -0.0013979110485658447, 0.0008412622903069158,
        0.0023373908451300393, 0.0016963580811490593, -0.0005445456608863425,
        -0.0023884548996660174, -0.0021689032965804497, -5.0371685566445365e-5,
        0.0021101599260402956, 0.002418895831669461, 0.0006337332644785589,
        -0.001628243737426144, -0.00234790249363201, -0.0009150027834885017,
        0.0013337468843880398, 0.0023301744892339662, 0.0011470949587745992,
        -0.0011592374624148246, -0.002496528241963559, -0.001622670980780762,
        0.0007262817240686173, 0.0024836065102672913, 0.0020968790532396937,
        -8.434761771503534e-5, -0.0021233053077259418, -0.0022301177491215697,
        -0.00035843055921648775, 0.001767125391300707, 0.002213260879496316,
        0.0005823270660422229, -0.0016312069030780512, -0.0023922566818930582,
        -0.0009674211094887096, 0.0014016664004050195, -0.006351418859634659,
        0.039912198560856524, -0.1144785393314345, 0.09580827445317909,
        -0.013267738444884719, 0.002301200686867065, -0.0003092278310865475,
        -0.0021074127038817306,
      ],
    ];
    const result = wavedec(data, "coif3");

    const reconstruction = waverec(result, "coif3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5100986932690826, 0.9394813396900057, 1.2243118950805394,
      1.3305086823815042, 1.2595996772513824, 1.0462806859668827,
      0.7484417643055208, 0.4322666755950044, 0.1561860492119651,
      -0.04231460061992309, -0.15381634230627583, -0.19639072777085587,
      -0.20768584197682408, -0.23191466759373475, -0.30528353394592056,
      -0.44378496991999333, -0.6366577657355764, -0.8473460834757159,
      -1.021843136310467, -1.10237826087718, -1.0429898369523956,
      -0.8229827529133203, -0.4547400925007642, 0.016269838283172328,
      0.5195202692941177, 0.9737115653031372, 1.303966285769548,
      1.4578363967858639, 1.4162936078093225, 1.1970928926868445,
      0.8497649728485004, 0.44353943863442874, 0.05121490422423047,
      -0.2670514720459554, -0.4761019522156669, -0.5713706114587407,
      -0.5765372552232207, -0.5340887364983681, -0.49142048377189307,
      -0.48621549887649823, -0.5349829125820786, -0.6277895759788568,
      -0.7305939486674236, -0.7946059743620648, -0.7702555511299025,
      -0.6221250614666389, -0.34090249726595223, 0.05087954253130078,
      0.5010129773219894, 0.937399520398429, 1.28322928859333,
      1.4739420180176261, 1.4718673059620306, 1.2749699778474248,
      0.91754931418017, 0.46270224296422163, -0.011629139362981988,
      -0.4296484626014177, -0.7336419112465384, -0.8950716602980561,
      -0.9182789437402761, -0.8361164182391523, -0.6988493255755913,
      -0.5593296079005431, -0.4583390580039546, -0.41389528290380073,
      -0.4172478648439817, -0.43653549325453034, -0.42707617502623785,
      -0.3455309289311731, -0.164157747331386, 0.11868132144644356,
      0.47466548552618126, 0.8495352856611208, 1.174200127292925,
      1.3803184346350406, 1.41655414139723, 1.2614797723660698,
      0.9298743616096128, 0.4707625600591161, -0.04243871349567417,
      -0.5273628287643761, -0.9100528799751243, -1.1401068337351847,
      -1.2000425798584062, -1.1067635141202834, -0.904968740104356,
      -0.6543392434388134, -0.41384437436558036, -0.22717412727992403,
      -0.11294997473364671, -0.062094376340314644, -0.04287247829993946,
      -0.0121342623363625, 0.07031404809531483, 0.22808808980667516,
      0.4590423775726075, 0.7330771474261405, 0.9976868768048016,
      1.1899991761913804, 1.2523544931537756, 1.147516580114379,
      0.8696281482579262, 0.44803437508526284, -0.05716068026127199,
      -0.5668986150542001, -0.9995979513596966, -1.2883219227822558,
      -1.3945994949362128, -1.3156354150902723, -1.0832715115545262,
      -0.7550879183329797, -0.3999521038946611, -0.08165597880221326,
      0.15530423618060518, 0.2943538973763409, 0.3478841745363892,
      0.35067899371981137, 0.3476332590725718, 0.3791154623914691,
      0.4679078992071005, 0.611228069475576, 0.7800061388118303,
      0.9257041823275625, 0.9929941851749262, 0.9350649152390249,
      0.7275980580110288, 0.37773033912168225, -0.07446464666906599,
      -0.5625870765549988, -1.0072003339363753, -1.332697905625216,
      -1.4837229241978582, -1.4371907191136786, -1.2070223594452552,
      -0.840474158623137, -0.4070006558603533, 0.017596223217319795,
      0.3678542636726608, 0.6021413318369442, 0.7097652298928612,
      0.7101557153110113, 0.6445803113704767, 0.5627294840215649,
      0.5077736450485418, 0.5038366421745746, 0.5491647278226293,
      0.6167684662176789, 0.6623611519163438, 0.6375089878096936,
      0.5045318524210844, 0.2492006955282391, -0.11220352480603801,
      -0.5335021291925764, -0.9470015442047578, -1.2777690534516923,
      -1.460403391273728, -1.4542241442707924, -1.2531430456291903,
      -0.8877552269634135, -0.419082516670942, 0.07455889871678736,
      0.514417641839325, 0.8378503092444418, 1.010616442567466,
      1.032078260650633, 0.9322430194069307, 0.7616206094045118,
      0.5766419269901715, 0.42445026164027166, 0.330973181804268,
      0.29528671633052017, 0.2916279290224304, 0.27841893404826557,
      0.21184242583509152, 0.06031973588371936, -0.18400977552614,
      -0.49995912531917586, -0.8397014804402506, -1.138521139000567,
      -1.329615786989887, -1.3603263388345437, -1.2057450772668226,
      -0.8762455033794188, -0.4169437529386607, 0.1009234663130439,
      0.5947296086651946, 0.9878166979311235, 1.2253553360843827,
      1.2849577285984655, 1.1795999966334894, 0.9523144428942729,
      0.6641385290810179, 0.37844760249728143, 0.1456434849657901,
      -0.007987408233719018, -0.08454975873457138, -0.11104122158790977,
      -0.12917846059393143, -0.18135826475035038, -0.296550733085455,
      -0.479931126862816, -0.7090882682165969, -0.9379465587514467,
      -1.1075379122644893, -1.1609678849665905, -1.0587937806552925,
      -0.7908606726540732, -0.3814724009129095, 0.1135964689256474,
      0.6177221357689049, 1.0492573368047198, 1.33882331703375,
      1.4439455685168814, 1.3575491696675814, 1.1083316976495987,
      0.753022159429751, 0.3625152843210173, 0.005346894210076447,
      -0.26741955581554916, -0.4322404457705107, -0.4957444983744801,
      -0.4895598245514271, -0.45887475148616963, -0.44786959283909245,
      -0.4859247346745791, -0.5782766539831719, -0.7036194849718981,
      -0.8193354501012815, -0.8730451036368039, -0.8175054578793156,
      -0.6249751683753514, -0.29724501173738593, 0.13141702442428516,
      0.5993956933086427, 1.0298945249476041, 1.3473139570074475,
      1.493927176926034, 1.4428206407952848, 1.203952421749205,
      0.8218530736917353, 0.3655335724050862, -0.08693653467733914,
      -0.46543445849070336, -0.7222781410764372, -0.8407843905420729,
      -0.8359841448234159, -0.7475680922020067, -0.6270792436954032,
      -0.5227864622398337, -0.46620928310584275, -0.463787839576314,
      -0.49582690781469063, -0.5229391720060436,
    ]);
    const expected = [
      [
        2.2176412436779054, 2.2445358115147367, 1.7314885481913764,
        2.240980986722786, 2.1906213193989137, 1.8581826712969383,
        2.28965168194242, 1.894580877211179, 2.0790671737690647,
        2.3734902890808094, 0.871729543268859, -2.69245159701688,
        2.080587998036347, 0.3476924954496946, -2.437192844681052,
        2.3544285523289235, -0.1991306169522961, -2.1035775399806735,
        2.520839415644378, -0.7071242493116474, -1.7087070755045497,
        2.583610349501894, -1.160872508800229, -1.2740712382911705,
        2.5519630413239276, -1.5507667087540973, -0.8183705205498634,
        2.437242358690628, -1.8721145934940278, -0.3566381276861093,
        2.2510064967772268, -2.1236937353085628, 0.0998348926472776,
        2.0035707595319456, -2.3060703194730685, 0.5428481272725649,
        1.7034379827027941, -2.4232220276137806, 0.9872078801764121,
        1.2559722204173218, -2.0693594367921957, -1.4019501572751571,
        -1.4783834818114114, -1.298216867092351, -1.6120952097660464,
        -1.369266083665522,
      ],
      [
        -0.17738095500042425, 1.6726073012143825, 0.7074206226272359,
        -1.6234482141631215, -1.0522572743713718, 1.3875846960588651,
        1.0481868313028155, -1.0267693537905416, -0.6061999887267768,
        1.4749643570439783, -1.1599610160213336, -0.11247926889185911,
        1.3406260773117427, -1.510798500384143, 0.44417841989856727,
        1.02245932444888, -1.6928676952548336, 0.9897888627650426,
        0.5468422429660945, -1.6728518587217067, 1.4496414146918013,
        -0.02916280893108911, -1.444613485930424, 1.7588780267322834,
        -0.6331677447617597, -1.0305865178659925, 1.8718855881311758,
        -1.1874341328260507, -0.4789831902532805, 1.7688944356443437,
        -1.6196621646221527, 0.1426630784922124, 1.4589630590993967,
        -1.873068946383927, 0.7567251171558725, 0.978868407444246,
        -1.9403081524572605, 1.4510261652024106, -0.38541778204745697,
        0.23244208800419902, -0.03208178769347453, -0.04873727023593041,
        -0.024905644059573392, -0.37774400667682084, 0.06613289261488928,
        0.5800588403884271,
      ],
      [
        0.14918454170186435, -0.1978393492395269, 0.24772459636328456,
        -0.04587560538321411, -0.4002041665490993, 0.7307100338911281,
        -0.3508916110347621, 0.17243366591343787, 0.006072000084402322,
        -0.12747870282321172, 0.121243920111501, 0.03589091251307284,
        -0.15916075282836026, 0.08466775695002889, 0.07041450853617669,
        -0.13917368537175173, 0.07428082848926093, 0.0850417657236151,
        -0.15977786007921246, 0.03562664676367443, 0.1181621195415988,
        -0.12872595444628632, 0.017255480648660407, 0.12142620341734982,
        -0.13864370568008494, -0.019086651033403502, 0.1496080411651738,
        -0.09861902305697957, -0.04179854526835156, 0.13962120373281697,
        -0.09876772026619549, -0.07139445580120864, 0.1604234681996713,
        -0.05322371499312027, -0.0946350019106686, 0.13684592269324813,
        -0.045801828348410206, -0.11355058005066633, 0.1492062293056632,
        0.0008476384687450907, -0.13390919144506874, 0.11336825439667525,
        0.012767923385167754, -0.13926214675086251, 0.11767585719825917,
        0.055694392031076276, -0.15422240859846756, 0.07247176936874176,
        0.06869117661198372, -0.14460294103602217, 0.07042222248597878,
        0.10326749579864852, -0.15288706342924638, 0.019987925489921662,
        0.11413113342836495, -0.12858676656826562, 0.014244003134926434,
        0.13653224270955241, -0.13030305464329078, -0.03653944271404355,
        0.14278166829544628, -0.09331809551619046, -0.04282793489510829,
        0.15048663731307663, -0.0898921891100398, -0.08893466111162868,
        0.15013918739612914, -0.055163230507770084, -0.022070354505674156,
        0.006423720075712297, 0.09314745186715374, -0.13788645856725534,
        0.11183023641255249, -0.13604459311166286, 0.11863817945034147,
        0.027050125203005045,
      ],
      [
        0.006661725556542428, -0.04341363026155801, 0.12218483723939176,
        -0.1025394578207316, 0.01357672080841932, -0.0018550063399606354,
        0.0013893333692746397, 0.0027732521390067297, 0.0016594529290591777,
        -0.0010497619299366934, -0.002726508815817243, -0.0017444278902283296,
        0.0009858571078750849, 0.0028726152252346285, 0.0020963999265658823,
        -0.0006595443058472164, -0.0028408377419493367, -0.0024224717255465324,
        0.00018722157782854234, 0.0025362861496946287, 0.0024430325038342065,
        4.759327210355846e-5, -0.0023353893575995726, -0.002419435595538014,
        -0.00011760016771077738, 0.0023731883843925087, 0.0026551717774114894,
        0.0004090131726085675, -0.002289236717430204, -0.0029174355875147356,
        -0.0008837384022430092, 0.0019144195613762475, 0.002877088437125007,
        0.0011470096662295536, -0.0015949482822102308, -0.00273189845793165,
        -0.001192138319218941, 0.001538496920867896, 0.002830037442168874,
        0.0014087352637847442, -0.001423614005244899, -0.003008522756073598,
        -0.0018388387083205545, 0.0010137911058584123, 0.002902379398513701,
        0.002093004700160285, -0.0006105282441287068, -0.0026376728746531045,
        -0.00208567465862219, 0.0004853502090615303, 0.002592896110301819,
        0.002193980824905789, -0.00036888086194036574, -0.0026816394238893208,
        -0.0025385778971427613, -3.322637580108191e-5, 0.002518168810437698,
        0.0027516557567653015, 0.00047688257131192423, -0.002151597814461749,
        -0.0026725182680263785, -0.0006381811789257416, 0.001975030453454786,
        0.0026504044347632374, 0.0007235343031185421, -0.0019821185351070344,
        -0.0028797570364930457, -0.0010732096864190792, 0.001782210929036182,
        0.0030297478424042602, 0.0015108765065307596, -0.0013453103296061223,
        -0.0028713069939113427, -0.0016738931567392996, 0.0010627299299113733,
        0.002711438335630756, 0.0016974250675751824, -0.0010082778214827984,
        -0.002810408155151589, -0.001953839050096634, 0.0008023524134501584,
        0.0028880998594593144, 0.002342092289184702, -0.00033688477638723014,
        -0.0026565683118271012, -0.002476031752227744, -1.4997020155554477e-5,
        0.002367891883128544, 0.002414205941420981, 0.00010260739692328561,
        -0.0023373781875155194, -0.0025458896154749943, -0.0002790405249813974,
        0.00234715867810146, 0.002849695050526808, 0.0007262137221780659,
        -0.002062249352394123, -0.00293209592938248, -0.001104862012682861,
        0.0016692886536005306, 0.0027727566575320847, 0.001193906545637116,
        -0.0015254745776177381, -0.0027618984924893527, -0.0013055900566838476,
        0.0014840592082296501, 0.002958785326795321, 0.001688410452717539,
        -0.0011767145698876281, -0.0029788782302636913, -0.002051243294024431,
        0.0007167485255294199, 0.0027238651204183487, 0.0021120015390521025,
        -0.0004882898826214375, -0.0025688227528980743, -0.002129402795150729,
        0.0004215727094410743, 0.0026512352894318054, 0.002408477261026536,
        -0.00012993450420901856, -0.002611445030328424, -0.0027184917161381973,
        -0.00035156309064908394, 0.0022771986736368393, 0.0027282137598853952,
        0.0006279827340970829, -0.002086506350503838, -0.004107240794306276,
        0.0034360124147932037, 0.004149604242878804, -0.003351707843916746,
        -0.002983308263674327, -0.00032755199972223206, 0.002215333834660621,
        0.0027582744779517045,
      ],
    ];
    const result = wavedec(data, "coif3");

    const reconstruction = waverec(result, "coif3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4919312815635518, 0.9052088210705647, 1.1785204951481911,
      1.280940106672104, 1.2174761194313384, 1.0258413804742537,
      0.7653975832074129, 0.501211659249208, 0.28738085301957655,
      0.1539264911642984, 0.1005892058591602, 0.09903330353351,
      0.10275922299941727, 0.062003506929104835, -0.06040106433275577,
      -0.27648780112220767, -0.5673608921296003, -0.88580526138529,
      -1.1667669683738784, -1.3431019977704188, -1.3625894915757848,
      -1.2018342044392185, -0.8734408832004641, -0.4245373740544663,
      0.07308144936409361, 0.5387851198435523, 0.9009911414635372,
      1.1126614275413944, 1.1605921701525967, 1.0662730257720368,
      0.8782506513607273, 0.6580978999051375, 0.46370543861851043,
      0.3342620466600563, 0.28080817178900574, 0.2847617224320148,
      0.304712195730699, 0.2896050775456544, 0.19475707988382845,
      -0.0036095037952377784, -0.2992525871291132, -0.6547538936779462,
      -1.0087895307044301, -1.2900964754740463, -1.4346418938250851,
      -1.4016356155831042, -1.1842812348287068, -0.8124749537594387,
      -0.3466968442892705, 0.13542651480160575, 0.5565507984242323,
      0.8566925777511432, 1.0057238453505744, 1.0082389158569953,
      0.8997156938206275, 0.735126290117065, 0.5730764994347715,
      0.4596740906852247, 0.41635485388819066, 0.43482792751042215,
      0.48041665488828095, 0.5028580195935664, 0.45165713535767715,
      0.2918838628655996, 0.01616087488207779, -0.35043656870835854,
      -0.7540193067155506, -1.123296002945369, -1.385963919222723,
      -1.4859685669911733, -1.3972601918364507, -1.1305374276875086,
      -0.7312349096053226, -0.2692285431035527, 0.17717051028885764,
      0.5389235478388003, 0.7712538696182643, 0.8622204296399265,
      0.8328446502666474, 0.72893964731264, 0.6069215443342234,
      0.5174135981282488, 0.4909913926265479, 0.5298245129340999,
      0.6074025023111642, 0.6763982808060967, 0.682574924450932,
      0.5810393311171902, 0.35050536781953495, 0.0017173325578543341,
      -0.4223225746592994, -0.8545663315977278, -1.218628239903048,
      -1.4463497908721819, -1.493816469959674, -1.3517861650644862,
      -1.0478911914297215, -0.6400564170564504, -0.20279978985999597,
      0.19012303989635915, 0.4823625465187572, 0.6467556577589771,
      0.6893697857580913, 0.6449486574930741, 0.5651203785542396,
      0.5025876901318855, 0.4955372831280869, 0.5564178743399615,
      0.6680699277507698, 0.7882472401286844, 0.8613567016541331,
      0.8343322224173145, 0.6724484564262732, 0.37085904395307084,
      -0.041279723015175795, -0.505341937422393, -0.9454351644059852,
      -1.2853017240760654, -1.4657178285559704, -1.458036774090278,
      -1.2704851366819416, -0.9456531836725153, -0.5498515501366554,
      -0.15706196909929826, 0.16843784992204947, 0.3863928988978895,
      0.48827431321045056, 0.49654313711406217, 0.4558455098548978,
      0.41859889611869744, 0.42887063760124083, 0.508872856686385,
      0.6516935044833199, 0.8222358105748316, 0.9661754781663838,
      1.0246281121995344, 0.9506983025483946, 0.7235523293126671,
      0.35625807459823955, -0.10478467812076389, -0.5888490371338243,
      -1.0161778222845712, -1.3158032271642408, -1.4414566264745314,
      -1.381607078786918, -1.1611526896084479, -0.8344070630344209,
      -0.47122869904936276, -0.13986717937957188, 0.10909681619232431,
      0.2536649627512425, 0.3035010248357782, 0.29454135006601867,
      0.27670661262654483, 0.298074581702795, 0.38978351479459816,
      0.5557313433786136, 0.7698709126839844, 0.981904568371384,
      1.1299704350597546, 1.157061572117175, 1.026908867754668,
      0.7351529086446926, 0.31280747246977614, -0.17902403259806607,
      -0.6619819636278464, -1.057699565170552, -1.3051954215479458,
      -1.3740911044158353, -1.2703950453013793, -1.0334852655845241,
      -0.7251606801851205, -0.4136375148971901, -0.1566280350504436,
      0.012169657513287802, 0.08976623360605826, 0.10215420893925103,
      0.09475944323695573, 0.11771245938957986, 0.20992920528975767,
      0.3862969554785462, 0.6314459809677777, 0.9018627851536465,
      1.1359131982603186, 1.2692606286986672, 1.2517269027154843,
      1.06122459663372, 0.7111015344668699, 0.24889904423793902,
      -0.25329097005140666, -0.7145410812573003, -1.0629942377660475,
      -1.2515188259660306, -1.2672470752800749, -1.1326946703473986,
      -0.8983079524006825, -0.628464954412029, -0.38460665023692725,
      -0.20987138550129325, -0.11917127682440881, -0.09719941632378803,
      -0.10476833422544284, -0.09169536074151266, -0.012735777728058895,
      0.15773555901091046, 0.4162715747930284, 0.728745877047412,
      1.0371601090666245, 1.2732305545235827, 1.3753295740469647,
      1.3044477388283588, 1.0550500005566072, 0.6579730978196365,
      0.17452530223661397, -0.31681418301029246, -0.7378158606551894,
      -1.0277152490795738, -1.1559592156745429, -1.1273716888481349,
      -0.9785719081962208, -0.7667143354610231, -0.5535702346723383,
      -0.38913470396192834, -0.29902136094306514, -0.27888240528212993,
      -0.2972319286777729, -0.3058384064529811, -0.2548623076580161,
      -0.10866298329832663, 0.14198954924715784, 0.4746379376824388,
      0.8383372314647113, 1.1646644090465026, 1.3838255643442585,
      1.441795708941123, 1.3141176037558868, 1.0128041490239117,
      0.5845250271263221, 0.10046673473806036, -0.3596320770907817,
      -0.7252944340910809, -0.950536914747603, -1.0227671897017527,
      -0.9632318507747571, -0.8190714370839156, -0.6491865235592809,
      -0.507686970786452, -0.4292826452277892, -0.42042899470265976,
      -0.4585082654177938, -0.4992056736318999, -0.4900804228887524,
      -0.38669461977670194, -0.16697403930907767, 0.1600868910869191,
    ]);
    const expected = [
      [
        1.4878998453425765, 2.1010239539744635, 2.4014799649623737,
        0.0869506812886457, 2.038397545975085, 2.151735336569897,
        1.730171100146636, 0.3684305957986863, 2.321175872723054,
        2.3795696704198344, 0.5763260151818816, 1.4083466651000756,
        2.179313031162823, 2.2632926362052994, -0.5943093559534487,
        -2.273836429811429, 2.6298321453266325, 0.0995538958857751,
        -2.756031609158854, 2.2055546155262618, 0.9374938504080585,
        -3.003367096573396, 1.5699498212129, 1.6883426097904972,
        -2.964575934869961, 0.7853884500068674, 2.276232950908781,
        -2.6431672731758495, -0.06937682627499894, 2.6412431362172306,
        -2.0699679979302488, -0.9090644241262, 2.745320293669458,
        -1.3001339125990008, -1.650316744861572, 2.576138241015895,
        -0.40779003403770847, -2.219934331932044, 2.148336860074388,
        0.5217931325565253, -2.564178550939168, 1.5075124780697065,
        1.3730343820181405, -2.4904987253259163, -0.3793033681652709,
        -1.3162661765417958, -0.5653930386192798, -1.3937056745756373,
        -0.7886750743413921, -1.0612673627297382, -0.7834099081647201,
        -1.2021665836366464,
      ],
      [
        0.468008791350378, -0.7519085358335732, -1.4147293985855458,
        0.32100763606726307, 0.03833561582275465, 1.8741649080670597,
        -0.5541319455582642, 0.17073276581418967, -1.5030718036905586,
        0.19342758577587044, 0.7870874507907303, 0.11567842273824029,
        -1.0875310003145937, 1.1881630573275033, -0.3409672381062757,
        -0.7245970678870327, 1.15926143901309, -0.6588931062887315,
        -0.35495160400800857, 1.0848390025789343, -0.9509697069202393,
        0.030255325540197, 0.9636946418128073, -1.197893062476856,
        0.40720498105414615, 0.8021163598950382, -1.3831653472043086,
        0.7532582867484029, 0.6074629985147001, -1.4933521329430695,
        1.0483260383244712, 0.38789892165468964, -1.5191478498318884,
        1.2760997659353304, 0.15217770858136737, -1.456204686438384,
        1.4249583068418943, -0.0879095020821174, -1.3227637428406789,
        1.5339173397611616, -0.14289653707559152, 0.11929768339215162,
        0.3646256255776026, 0.3206689992350222, 0.0116667450194367,
        -0.7419872786431485, 0.19675737094048593, -0.37175611640998657,
        -0.34658862075922475, -0.554152116669929, 1.186559475208971,
        -0.9251329130016983,
      ],
      [
        0.10175237667355491, -0.10002210030455058, 0.14863852744103143,
        -0.1015814631232843, 0.025192453768851594, 0.10323467949731754,
        -0.4022639002728328, 0.65993969496738, -0.2972792712618873,
        0.16944093339267507, -0.020039856004766578, -0.08994225671248324,
        0.09082393676017496, 0.010941527296535775, -0.10083246959537315,
        0.08104286040823636, 0.02228823777607037, -0.10298007078465081,
        0.07544843366182563, 0.035658992386559736, -0.10711670131458693,
        0.06291130764085053, 0.04545547454614101, -0.10725987420682832,
        0.05541472255394461, 0.05849479866033474, -0.10765268598075345,
        0.04148583187224217, 0.06623822798544408, -0.10582911324858914,
        0.0323562734668936, 0.07815469274728572, -0.10242920715232436,
        0.017904981220746095, 0.08354001931567621, -0.09874328570415024,
        0.007513936144652216, 0.09357744093537579, -0.0917464017805902,
        -0.006583550910095211, 0.09644467108407698, -0.08636015321180633,
        -0.01777069186227359, 0.10393427230533302, -0.07619482547016702,
        -0.03068838218967974, 0.10426445585628538, -0.06932267158575098,
        -0.042128362812240465, 0.10867363322523876, -0.056621949000532565,
        -0.053141776255099415, 0.10657667405200767, -0.0485264682135821,
        -0.06423714919661375, 0.10755048384148118, -0.0340852424479809,
        -0.07276540470901093, 0.10324672348836854, -0.025073424487517565,
        -0.08289510245169336, 0.10063858799553861, -0.009794514904003694,
        -0.08853121598681439, 0.09443641988647057, -0.00021321224969098447,
        -0.09708536254214045, 0.08874360419798022, 0.017887386526606302,
        -0.14005658575952276, 0.31278975197094705, -0.44433908011879236,
        0.14462641105363913, -0.15311083426128896, 0.29679223080854905,
        -0.03174530094039568, 0.0008185491015967528, -0.09220184236442845,
        0.11526446276689643, -0.03782684918670307, -0.0746765906721038,
      ],
      [
        -0.002148594780694902, 0.011951629107862696, -0.032328787017876726,
        0.10032345206729704, -0.10177578407963829, 0.026954881980486962,
        -0.0046283648761685815, 0.0007725537131480003, 0.0005502462430941014,
        0.00036503241581983115, -0.00031356184662974256, -0.0006722510661645065,
        -0.0003797836075660744, 0.00028313297409855454, 0.0006759700769654427,
        0.00041841734203535547, -0.0002418216173353838, -0.0006681858755753113,
        -0.0004502362032845184, 0.00019997534209041437, 0.0006532342411309912,
        0.0004716091981288738, -0.00016823879797993454, -0.0006461044385137095,
        -0.0004982187698216275, 0.00013396661381804163, 0.0006401607364720776,
        0.0005310218679912746, -8.877522151021607e-5, -0.000621531499426921,
        -0.0005539898490461464, 4.690473527215154e-5, 0.0005991239904389817,
        0.0005685035801987634, -1.4777844006381478e-5, -0.0005855135939889281,
        -0.0005902037393186561, -2.2574559770368192e-5, 0.0005699348228260827,
        0.0006150917371976366, 6.893794121309739e-5, -0.0005416402590046272,
        -0.0006280123346039857, -0.00010846487756894194, 0.0005132346902476516,
        0.000635218869580989, 0.00013958052762689532, -0.0004936451665176486,
        -0.0006507685015669384, -0.0001780994287951868, 0.00046903818046024746,
        0.0006660974216160488, 0.00022283069043928472, -0.00043285078611047053,
        -0.0006684118180995101, -0.0002578724973104405, 0.00040014883595961074,
        0.0006682200135720088, 0.0002866469071958943, -0.0003753366139393067,
        -0.0006766108696459033, -0.00032425251526192647, 0.0003428772260345137,
        0.0006812959743627148, 0.0003646334850296819, -0.0003010419240090281,
        -0.0006730999666208721, -0.0003933921251272463, 0.00026588010580926545,
        0.000665751435932728, 0.0004186052595974533, -0.00023684469677994797,
        -0.0006662794624226997, -0.00045316499504589284, 0.00019822850777383798,
        0.0006598793530149551, 0.0004867409692947794, -0.00015331205333169766,
        -0.000641896650600744, -0.0005078507320253515, 0.00011755479639220734,
        0.0006279300989932528, 0.0005284265052846108, -8.551746066688703e-5,
        -0.0006202582107450202, -0.0005578810900679525, 4.2873053453708535e-5,
        0.000603017205903399, 0.000582621233834461, 2.4057316378762835e-6,
        -0.0005765326505609247, -0.0005952049147991928, -3.696431293841759e-5,
        0.0005567407218839442, 0.0006102420398211366, 7.05933662964236e-5,
        -0.0005409471912752294, -0.0006327364664904168, -0.00011482460051968453,
        0.0005137918730585141, 0.0006471656344910621, 0.00015777148509565203,
        -0.00048055091202528656, -0.0006508567591502526, -0.0001894920209731485,
        0.0004559332661314366, 0.0006596574325041843, 0.00022315933994188306,
        -0.00043254015431175145, -0.0006736677533793384, -0.0002663696881508287,
        0.0003970293216059576, 0.0006769603948013637, 0.0003044860525611068,
        -0.00035911224174525476, -0.00067189272239102, -0.00033195115833095445,
        0.0003308278197962929, 0.0006739895264310684, 0.0003640191318974864,
        -0.0003008047235240111, -0.0006784359657465958, -0.0004035979525188782,
        0.00025903548060834665, 0.0006704656106750326, 0.0004347343719463143,
        -0.00021871632115486142, -0.0006572334370908051, 0.0011811469308463498,
        -0.0098965681267428, 0.02619726988927704, -0.08001238814704324,
        0.08194689938218734, -0.021719295135115457, 0.003176913144136533,
        -0.0010081360436082812, -0.00032467131426382054, 0.0002200301608260211,
        0.0006660530571583986,
      ],
    ];
    const result = wavedec(data, "coif4");

    const reconstruction = waverec(result, "coif4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4985402736587253, 0.9165325475127984, 1.191243217337498,
      1.291128782143694, 1.2214779903606454, 1.021015877335412,
      0.7504848219770566, 0.4762644503621596, 0.25333530914127744,
      0.11200991712512198, 0.05182151502838217, 0.0440482144965228,
      0.04205986847337084, -0.003393593408539841, -0.12813929485053244,
      -0.34217223130239305, -0.6243121438163218, -0.9254955280989465,
      -1.1799882125302663, -1.3216973108770127, -1.3013835749665246,
      -1.1002885054753417, -0.7365730958056129, -0.2627900943897283,
      0.24509340223902265, 0.7044368510651312, 1.0442640272958728,
      1.2206239624670694, 1.2251732211835207, 1.0849275181824518,
      0.8534034772091466, 0.5955765276707008, 0.3706462250824854,
      0.21712065353586057, 0.1440746744742077, 0.13077722912605347,
      0.13465650645213514, 0.1053617876103437, 0.0010655991452786506,
      -0.1974478555399008, -0.47878549189246483, -0.8013164066262131,
      -1.101981842405329, -1.3113790962123288, -1.3712746793044694,
      -1.2500188666023297, -0.9518284619491485, -0.5174515760676526,
      -0.015927533671101307, 0.4705635578751836, 0.8649956573957815,
      1.112368587716893, 1.1909653774738547, 1.1152590600931571,
      0.9298885919294445, 0.6964191518469346, 0.4764412384331336,
      0.3154689715017146, 0.23183778587275, 0.21344644948741048,
      0.2230946669446877, 0.21088434119108523, 0.1302777521591409,
      -0.04656966855065198, -0.31840489462121657, -0.6523158923286502,
      -0.989866899226999, -1.2604885201900082, -1.3987509424566091,
      -1.3610899904997917, -1.1376473264640388, -0.7561072666569069,
      -0.2764484893583942, 0.22214806320445563, 0.6589861600412272,
      0.969715917050503, 1.1199185374545069, 1.1110784665558628,
      0.9775794066865782, 0.7756757645197604, 0.567447333802476,
      0.40400865060130414, 0.31238894783849475, 0.2894895244177568,
      0.3046290406246634, 0.3099013701715778, 0.25549407601079627,
      0.105792201667607, -0.14813120788885703, -0.483100225107984,
      -0.8471071324110276, -1.170595222614898, -1.3829587104327417,
      -1.4300638501260543, -1.2882810064580648, -0.9713750790682756,
      -0.5284111114225618, -0.03312482768397318, 0.43261028451113537,
      0.7970828643623562, 1.0142362867508259, 1.072521693947665,
      0.9950067863581872, 0.8308988782531106, 0.6408505431583941,
      0.4799984339974228, 0.38323059848695895, 0.35654579914472967,
      0.37672795985735275, 0.39934086424761095, 0.3728340333808106,
      0.2549203990077623, 0.026767333257011805, -0.2989021066208785,
      -0.6781150101631513, -1.0444756881774269, -1.3243827845589582,
      -1.4548044504156745, -1.3990690291789456, -1.1565963602593143,
      -0.7640219966737272, -0.2873586315641588, 0.19287221676074895,
      0.5998132386755604, 0.877193372634387, 1.0007882808535558,
      0.9816384769412649, 0.8603856563217671, 0.6943829557201967,
      0.5410868998590614, 0.4421669541262996, 0.4125335975645312,
      0.43715200648142755, 0.47642680834721396, 0.47865989780633234,
      0.3961963957790563, 0.2008781130027263, -0.1054188877431072,
      -0.4881153371489305, -0.8860274906337462, -1.224831539428155,
      -1.4345439761115943, -1.4665833231145713, -1.3060418566888257,
      -0.9759937486591468, -0.5326894534756982, -0.052811133975446595,
      0.38401232792183176, 0.7130342306303942, 0.8981040306264423,
      0.9378953588137571, 0.8632304203914127, 0.7263927888231715,
      0.5853852236545591, 0.48737206871814537, 0.45571484426584563,
      0.4840235676009458, 0.5387653432102083, 0.5696895284085502,
      0.525243529214446, 0.3688116400975167, 0.09136365397601531,
      -0.28298371658479343, -0.7001488427416209, -1.0873810942039752,
      -1.3699066203305967, -1.4887342916292712, -1.4150889315329427,
      -1.157770375725486, -0.7615292311092903, -0.29683959653781633,
      0.1563579465283756, 0.5268415277978643, 0.7676519480852231,
      0.8651382002234949, 0.8393524670154199, 0.7358953547963487,
      0.6115255797601684, 0.5174464045785843, 0.48474902025008076,
      0.515885179042606, 0.5844191039983627, 0.6430981631927446,
      0.6380625881016386, 0.525368376289377, 0.28535649618865067,
      -0.06906485110831562, -0.4925871743300928, -0.9162802608382525,
      -1.2628893543696706, -1.4648354869322229, -1.4803645519725177,
      -1.3037300590769607, -0.9668004333516846, -0.5316648481596219,
      -0.07610620529992151, 0.3243787940952652, 0.6134735732570211,
      0.7656253277872601, 0.7894983386442381, 0.7226033512392753,
      0.6187033766290966, 0.5314601616734566, 0.498734777404624,
      0.5317448436016255, 0.611967428474236, 0.6966060738976843,
      0.7311557491464296, 0.6656997237926562, 0.4705557839769551,
      0.14702369863745196, -0.26976141952480204, -0.716819206297121,
      -1.1168002311921548, -1.3956248826877111, -1.4998496236655225,
      -1.4093590194736492, -1.1421549537584603, -0.7500239006300171,
      -0.3061884762301062, 0.11191201425075814, 0.44034377058944363,
      0.6424425307001933, 0.7152184858634946, 0.6869355429519063,
      0.6067020214003718, 0.528982024045171, 0.4972379198868953,
      0.5311069149979049, 0.6205505636833468, 0.7285493624185261,
      0.8016350222694946, 0.785458187313718, 0.6412286424004178,
      0.35859622795538937, -0.038563508087764486, -0.49516588867012523,
      -0.936156128712704, -1.2832420860439715, -1.4729414451306408,
      -1.4713911053632964, -1.2821704290185345, -0.9451637400519849,
      -0.5267717493964763, -0.1039842972973844, 0.2536228527740122,
      0.4994073743169308, 0.6188190503389113, 0.6300035733000224,
      0.5758994517289975, 0.5100924346222301, 0.48030488377982666,
      0.5139875860730613, 0.609896495616218,
    ]);
    const expected = [
      [
        1.3622243965906744, 2.1299897069145968, 2.3962150283701527,
        -0.07748335104752072, 1.9919490771787591, 2.1881965573442357,
        1.6606392231741631, 0.21725004447724444, 2.328288199601912,
        2.4014595943006176, 0.4376327000622793, 1.3162802785569212,
        2.2071669430772722, 2.2549003612361873, -0.806590338251969,
        -1.9992772855097052, 2.7617091306636663, -0.5063346157726629,
        -2.3368082837025, 2.639783505558175, -0.040802833935384475,
        -2.629530815766835, 2.4381823325859955, 0.4260869049827041,
        -2.840858381351191, 2.161102426930902, 0.8797935575773667,
        -2.964249776059843, 1.8171246558491716, 1.30626779598484,
        -2.995884440166634, 1.4169007402389997, 1.6923032227963553,
        -2.9347820946265646, 0.97282340990804, 2.0259453288077585,
        -2.782833164948266, 0.4986445367691278, 2.296818299713915,
        -2.544235390024237, 0.005373066682705227, 2.515688955666862,
        -2.3029789246872956, -0.2420798403687955, 1.8150134355436944,
        1.496167515166378, 1.5234035795929266, 1.6624235905909286,
        1.5373958894992243, 1.6112201493868166, 1.3683277395524074,
        1.862989061213502,
      ],
      [
        0.4768319274771253, -0.7649451902140998, -1.439402770056508,
        0.3342030053745926, 0.03200615872243331, 1.9058433841549216,
        -0.5689290433052414, 0.18763124370830017, -1.5311868390223127,
        0.20310692458900304, 0.7616980015423761, 0.2130524979803777,
        -1.197922122767015, 1.1801608590552302, -0.16142896475717727,
        -0.9398174407686272, 1.177428860641096, -0.39761992789719497,
        -0.6852068331704108, 1.1445500730566252, -0.6225205460185189,
        -0.4093505342323962, 1.0763497246440021, -0.828221238371204,
        -0.1208566283949484, 0.9749382207436399, -1.0083681963997984,
        0.17136314837070307, 0.843448058267932, -1.157396181115227,
        0.4582821938477808, 0.6859397141828278, -1.2707003060703554,
        0.7310378713566706, 0.5072761858354088, -1.3447776298090213,
        0.9811906691416756, 0.3137407391053994, -1.3912961583664123,
        1.2929383558929222, -0.2845235725486213, 0.09839419928292421,
        -0.09096021197350909, 0.12261818057314167, -0.07047940300837574,
        -0.02110340478843044, -0.03391663862793387, 0.40870258953633026,
        -1.1958696010129501, 0.6770006627517893, 0.5488426256338591,
        -1.33394421126301,
      ],
      [
        0.10360498493578067, -0.10135800164428987, 0.14999325262410057,
        -0.10007732064648209, 0.022069937843794494, 0.10654166614604822,
        -0.4094857143343262, 0.6707752953205641, -0.3027989394996396,
        0.17381266625325792, -0.02330944018519024, -0.0900356614753611,
        0.09610543678196301, 0.004900259283430994, -0.10093786670490076,
        0.08808704353194415, 0.014046492312128718, -0.1020562372608599,
        0.08542137663676487, 0.024422825065687576, -0.1076462707373778,
        0.07529220611751176, 0.032722523564148266, -0.10758386184287413,
        0.07153141353042305, 0.043250381083401145, -0.11103374902165647,
        0.060172776147194296, 0.050388265696140556, -0.10978981882511676,
        0.05543269831081773, 0.06074247408722472, -0.11099286875482078,
        0.04319560084553956, 0.06649829578233403, -0.10860597501049407,
        0.03762229437515753, 0.07635899565386536, -0.10752491539461266,
        0.024884865627575227, 0.08055522190388548, -0.1040688585349981,
        0.01865011982592287, 0.0896177501912773, -0.1007369904809013,
        0.005805926339111131, 0.0921250407640125, -0.0963185317749953,
        -0.0008980319265187156, 0.1001093438250322, -0.09083870399424278,
        -0.013452146471760767, 0.10085053740550595, -0.08559426757491446,
        -0.020418579385910608, 0.10750982535649967, -0.07813570163277545,
        -0.03229475536312687, 0.10646231412248804, -0.07222716227133455,
        -0.0393087895475453, 0.11159068897500887, -0.06302022688435287,
        -0.05014013453513841, 0.10878711252128062, -0.056629406337110985,
        -0.05698945269115757, 0.11266790956225398, -0.049453001201267756,
        -0.059039829506744364, 0.14018337522203939, 0.020487437857778276,
        -0.15635399661733212, 0.08222792063898574, 0.0952274443087148,
        -0.15713595100363173, 0.08557599053774542, -0.12496554377772137,
        0.09036212856412072, 0.024042000291581173, -0.10662065644971055,
      ],
      [
        -0.0021702234165018133, 0.012110278397991727, -0.03283297887307701,
        0.10180026435661023, -0.10321562467095463, 0.027302994655868038,
        -0.004686402631008579, 0.0007986276733903338, 0.0005711608507518875,
        0.00036162034060879827, -0.00034244970165400203, -0.000695353691870967,
        -0.00036853035667971213, 0.0003215969893365693, 0.0007025496792130626,
        0.0004021183178993794, -0.0002886142670420334, -0.0006985513690499408,
        -0.0004301593996031344, 0.00025356727042845514, 0.0006858025036472102,
        0.00044595119740160677, -0.0002305711184668048, -0.0006822138720368674,
        -0.00046665477419810655, 0.00020753049305173823, 0.0006837813105118909,
        0.0004973643046344022, -0.00017151170311705246, -0.0006729688878088623,
        -0.000520376639711925, 0.0001358671253383403, 0.00065535261700885,
        0.0005320667925841309, -0.00011247426443665623, -0.0006480102786439457,
        -0.0005503711986849746, 8.705577987005872e-5, 0.0006439000668375029,
        0.0005772534012944639, -4.911357261370114e-5, -0.0006266075993605333,
        -0.0005945263169284984, 1.3972450527987075e-5, 0.0006046685286161597,
        0.000601754602070335, 9.09541745948419e-6, -0.0005937989017196993,
        -0.0006170947510724721, -3.6107364319499134e-5, 0.0005841372860006773,
        0.0006393188816209993, 7.480087196375659e-5, -0.0005608990379093433,
        -0.0006503190431423233, -0.00010835315095248244, 0.0005353151883227612,
        0.0006528630108646215, 0.0001303844286088047, -0.0005212534859951156,
        -0.0006647652121688083, -0.00015815613025772502, 0.0005063381829919338,
        0.000681644351858376, 0.00019640556401888458, -0.0004778721082910106,
        -0.0006860322304797989, -0.00022733278582719226, 0.0004494339625291384,
        0.0006838140499548169, 0.0002476479314506857, -0.00043261385499788715,
        -0.0006919106359195711, -0.0002753221015938424, 0.0004129048777179101,
        0.0007029229232076112, 0.00031194575908231664, -0.0003800904388047317,
        -0.0007005632758477578, -0.00033929288496551264, 0.00034967651694501386,
        0.0006936521160057367, 0.0003572653725625193, -0.0003306167570248653,
        -0.0006976927995056125, -0.00038398760969841325, 0.0003067222273587142,
        0.0007024975647755023, 0.00041785396873491475, -0.0002705732238863722,
        -0.0006934636024874688, -0.00044077662706973553, 0.0002391229438675228,
        0.0006820734753018319, 0.0004558522685283854, -0.00021841136805605176,
        -0.0006819330867476373, -0.00048079743442619926, 0.00019106875315774442,
        0.0006803813911255, 0.0005108601125104311, -0.00015270200073408557,
        -0.000664952507632294, -0.0005286506696846648, 0.0001211866618242956,
        0.0006494356410082728, 0.0005403647032757515, -9.946206044832385e-5,
        -0.0006451180057906866, -0.0005627624018588088, 6.951541201891425e-5,
        0.0006372572579129648, 0.000588092486719592, -3.0116238392938353e-5,
        -0.0006159103888113952, -0.0006002018921060561, -4.909761061100663e-7,
        0.0005967463342535497, 0.0006081933103754622, 2.255856047847038e-5,
        -0.0005883841703875033, -0.000627351680327064, -5.418466161002017e-5,
        0.0005744566781601363, 0.0006471664326058106, 9.33990368954215e-5,
        -0.0005478515578827645, -0.0005389735701546374, -0.00016208667599854252,
        -0.003912808988147403, 0.025353894689089666, -0.02791383474335028,
        0.011433880660047645, -0.004817893183784862, 0.0007696321578050911,
        -0.0008995624649548854, -0.00010904528653701036, 0.0005084486836433083,
        0.0006798479774174848,
      ],
    ];
    const result = wavedec(data, "coif4");

    const reconstruction = waverec(result, "coif4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49081298730658296, 0.9028486451580446, 1.1748266630736606,
      1.2760982414051856, 1.212177019681456, 1.0213779462936112,
      0.7635536538822082, 0.5039319990752587, 0.2962880184173031,
      0.16981203236839193, 0.12303233473565867, 0.1262789206006857,
      0.13192241333371202, 0.08957651177120157, -0.03785440013785979,
      -0.2616280767577907, -0.5615515994918447, -0.8889231210395193,
      -1.1774041577604792, -1.3591077251825965, -1.3817950408593713,
      -1.2227428873786939, -0.8956634595093118, -0.4488185373075591,
      0.04528407888100225, 0.5060723724064385, 0.8629300662668977,
      1.0705530023518095, 1.1178364065422837, 1.0281605269254337,
      0.8511581038415066, 0.6482318740689248, 0.47567833868363624,
      0.3698552169794157, 0.33825594591306996, 0.358776918255299,
      0.387294084957765, 0.37147067292853064, 0.26706911068417727,
      0.05236764379575942, -0.2632384821616392, -0.6388636634091177,
      -1.010253980161401, -1.3044475871668477, -1.457290582007059,
      -1.4293481747727694, -1.2161261434727164, -0.8499503185384768,
      -0.3929729788357851, 0.07696333374088787, 0.48405648269029744,
      0.7714178076770087, 0.9128780247661203, 0.9168412264256598,
      0.8213649655946857, 0.6819096645822496, 0.5550811441488652,
      0.4826991438371726, 0.4804022602554281, 0.533779843697698,
      0.603023277829487, 0.6348340567065067, 0.5784021408524567,
      0.401177052353433, 0.10018134410624141, -0.2942439874969921,
      -0.7234147327475416, -1.1128839632663297, -1.3895232786537226,
      -1.498807213785628, -1.4179173809183208, -1.1613286192635175,
      -0.7774476176827564, -0.3371524861257026, 0.08285901540799362,
      0.41769632073090623, 0.6284411099093831, 0.709336363913101,
      0.6863101731597037, 0.6073977506985699, 0.5277206061629998,
      0.49307667970318747, 0.5265284513892992, 0.6215627984152013,
      0.7436498880050841, 0.8398044640095204, 0.8536314246297303,
      0.7418719443518265, 0.4880395510391196, 0.10946058953616541,
      -0.3442759634122295, -0.80123582281705, -1.1830289622809678,
      -1.422715892962467, -1.48023095833009, -1.351437755894008,
      -1.0685477966909045, -0.69183348602855, -0.2947819574049153,
      0.053505152380284304, 0.304187069824981, 0.43883878633631157,
      0.4714027270870178, 0.4416024069401486, 0.40170775111262425,
      0.40026479176397123, 0.4671769818925485, 0.6041511677757327,
      0.7830968781890878, 0.9529646792191828, 1.0532760864796518,
      1.0308161932614512, 0.8550958325412352, 0.5284697300709621,
      0.08815055264235064, -0.40056325395526504, -0.858263231764147,
      -1.209163121168313, -1.3981596087912365, -1.4029516850639467,
      -1.2382053702112872, -0.9507813432938733, -0.607322817328406,
      -0.2774405103244943, -0.016829979516707283, 0.1453685006275432,
      0.21179682721900622, 0.21347783575741117, 0.19883359170543782,
      0.21815145446735756, 0.30770994533295126, 0.47785601634914737,
      0.7082805418571125, 0.9518420867417154, 1.146034301170906,
      1.2291670702525916, 1.1570639859955276, 0.9159004953325762,
      0.5277671519818942, 0.04739408898072487, -0.44926227850534245,
      -0.8817773200890014, -1.1831907149549694, -1.314637384403383,
      -1.2730460302158964, -1.0900520266169706, -0.8225212015172985,
      -0.5372209631891318, -0.2936521148556244, -0.12948776845143561,
      -0.05234530228079193, -0.039932968927165025, -0.048404203048515615,
      -0.02659527927301264, 0.06772264948368273, 0.25397595137735596,
      0.5210812935979008, 0.8280610546326709, 1.1129588796772356,
      1.3078456493852562, 1.3560861238267397, 1.2274066191631487,
      0.9268303918334989, 0.4950960285709828, 0.0003457178442393405,
      -0.47689648104226745, -0.861719031994582, -1.1012956815147312,
      -1.1757411828089244, -1.1007055584566, -0.9211893304378298,
      -0.6983138885185897, -0.4925749617122221, -0.34797950897695407,
      -0.28119328121812115, -0.27848136073306795, -0.3011589491515822,
      -0.29802312590041014, -0.22139364305467923, -0.04243220790736185,
      0.23841472028053262, 0.5887396909225193, 0.9501286949023519,
      1.2513498489877493, 1.4254727864726036, 1.426558299505221,
      1.2416276452380672, 0.8948019651474437, 0.44249060096245935,
      -0.03921070821256811, -0.47176457451230286, -0.7917556759208183,
      -0.9643857702324876, -0.989577145943699, -0.8992780282974877,
      -0.7468341244425872, -0.5913268459075991, -0.4810536186955646,
      -0.4405100869821955, -0.4642823967295709, -0.5194197062364934,
      -0.5556123986849826, -0.5204354457045783, -0.37556768298271836,
      -0.1096185418713499, 0.25594191805777894, 0.6694693654907884,
      1.059925844008907, 1.353115707638893, 1.489296267552666,
      1.4376920565320408, 1.2042055719038018, 0.8303398986239547,
      0.38358526548580907, -0.05830551057795991, -0.4251799986086718,
      -0.6699916803414709, -0.7780874196576517, -0.7680436419997962,
      -0.6840142665334626, -0.5817483726345541, -0.5120599594124349,
      -0.5061654781292626, -0.5667843954403928, -0.6673611251273331,
      -0.7596146689344452, -0.787416485339804, -0.703312697830283,
      -0.4832835129352596, -0.13576060835130266, 0.29760699174361727,
      0.7498166564701394, 1.1431432002908413, 1.406907073639197,
      1.4939137460166358, 1.3914129024402666, 1.1238111716208319,
      0.7464704771642933, 0.3321936435134364, -0.046146807324365546,
      -0.33242031662479454, -0.4992543504851188, -0.5522908844017735,
      -0.5257513521770696, -0.47064153133235137, -0.4388347225803035,
      -0.46732717414993447, -0.5668908730266061, -0.7181749038632637,
      -0.876334244993963, -0.9830084414864101, -0.9825203678096455,
      -0.8380266955968239, -0.543324877609712, -0.1271157924208774,
    ]);
    const expected = [
      [
        -0.5690217911216325, 2.284152776447911, 2.13169769855136,
        1.6198079612464875, -1.1247781204812901, 0.8484706963968388,
        2.2475128801382778, 2.3284335967667, 0.4270691067282752,
        -0.8474881240163847, 1.9112643082173477, 2.079969597192021,
        2.14749836746767, -0.7164095706341319, -0.033398768933099475,
        2.373417993797665, 2.068899046252272, 1.589455005708285,
        -2.717370880762024, 0.49544579820550066, 2.28850467202701,
        -2.2517386058116005, -0.5248299573200282, 2.6320553853102076,
        -1.502024786768688, -1.4679338236568582, 2.63334309729328,
        -0.5592614923664623, -2.220739808809278, 2.292673902022711,
        0.46074743482895064, -2.6913162858909856, 1.6530097431001944,
        1.4322567761074378, -2.823218906694783, 0.795221726624715,
        2.235215215545327, -2.602459608373278, -0.17206331247073467,
        2.77022619764728, -2.059173294255301, -1.1258916672393178,
        2.969418845370308, -1.2558982136961752, -1.9760990042887232,
        2.907060485946289, -0.5516184234702147, -2.027653759639149,
        -1.8198910025198758, -1.9283077821769572, -1.8397513546572504,
        -1.9222998250931025, -1.8750485126245455, -1.8594155925996751,
        -1.9583806818149265, -1.7102737214885682, -2.14414095000611,
      ],
      [
        -0.3022139435618113, -0.26924790689668976, 1.7603992726437527,
        0.27564027017334186, 0.054274873976594425, 0.00900975500572487,
        -1.3224876470673304, -0.7648768105658551, 0.35290327766370944,
        0.4434046583814836, 0.6716950982536477, 1.1162174036130394,
        -0.8169712337719537, -0.9541339048851609, 1.4260843125322171,
        -0.5277016702036341, -0.895460822635635, 1.5297443727579614,
        -0.7646560083902146, -0.7179614939911751, 1.552259537863636,
        -0.961681194714886, -0.5075376524037072, 1.4982762918351575,
        -1.112341322902555, -0.2688142346923715, 1.3700009041496215,
        -1.2147664173222545, -0.008260708000161616, 1.1744098578140778,
        -1.2694312507887968, 0.2654099580312622, 0.9226393625317819,
        -1.2785182712270031, 0.5413486602315098, 0.6291383224810885,
        -1.2452745298800159, 0.8069678992555577, 0.31054086123737057,
        -1.175356103970109, 1.0705527964163575, -0.1376305954348741,
        -0.7357165879780285, -0.5367198657903909, 0.3478866422583393,
        0.901467576606431, 0.6642765538464264, -0.2327924078866913,
        -0.9259157640019354, -0.6876899930330697, 0.18888127570710522,
        0.4359271829675114, 1.2151809577397494, -1.4636722502728479,
        0.39654234895114904, 1.039822756064409, -1.5293799658150278,
      ],
      [
        0.08311152309076084, -0.07253220589553948, 0.14587150328965787,
        -0.14879868921831604, 0.2681955760937648, -0.28626786199179466,
        0.09664703117459238, 0.08539977836740664, -0.38477489249627195,
        0.6238492092321875, -0.2605582739421653, 0.1565155747145143,
        -0.03284028011763177, -0.056909673281146295, 0.06282691019763514,
        0.004632894997168762, -0.06840960617670568, 0.05961517391093777,
        0.011678892457969808, -0.07086320023370854, 0.05530705351814134,
        0.019426377742540274, -0.0732311949609981, 0.04926610226404886,
        0.026286841960560525, -0.07443546844807343, 0.043860671666932936,
        0.033721625658680386, -0.07508770851913411, 0.03692767227471006,
        0.039836183915550986, -0.07496424144849598, 0.03059535851868405,
        0.04661531507408953, -0.07386940500001705, 0.023097954554445264,
        0.051777133283300456, -0.07241906493860133, 0.016059118956306316,
        0.05757596816743809, -0.06963484253317351, 0.008337210546214113,
        0.06162274956221599, -0.06689589413165983, 0.0008542648037107218,
        0.06615429232995962, -0.06256501822939468, -0.006758025622410816,
        0.0689687830591467, -0.058614199611465814, -0.014388134359839704,
        0.07200163711117702, -0.0529550057817516, -0.02157838659435934,
        0.07351036447171558, -0.04790881795690703, -0.029035150675111508,
        0.0748839433984552, -0.04120117489318539, -0.03552552867017792,
        0.07505499704389207, -0.03521677685789303, -0.04247901372295871,
        0.07469065460883238, -0.02778460396752519, -0.04803559062924336,
        0.07353128814391904, -0.02106046448949337, -0.05428070810392464,
        0.07093572261588507, -0.0003631085335592627, -0.12978349107547713,
        0.3730402441692438, -0.5660792331254982, 0.20151782736829849,
        -0.09485504140876957, -0.05706889250023256, 0.3173254074432326,
        -0.05085058477902878, 0.02083876174387353, -0.09653316124858641,
        0.08323645541914926, -0.00887916848831416, -0.06342427325740771,
        0.06464672244706009,
      ],
      [
        0.0005915933524660361, -0.0038338572696751914, 0.012852254069722848,
        -0.025339902851277102, 0.0905128927773901, -0.1017530729430502,
        0.03431560577439523, -0.008855460105347875, 0.001647502628659274,
        -0.00015079706028397246, 0.00015446133397657556, -8.593394484449812e-5,
        -0.00015298581687714697, -8.450211837842148e-5, 6.740919962076064e-5,
        0.00015401241549636545, 9.125476404981276e-5, -5.999833566793117e-5,
        -0.00015298696330947424, -9.752246347325513e-5, 5.247179296075744e-5,
        0.00015133147926056894, 0.0001030836497994077, -4.53764894692697e-5,
        -0.00014982793853425216, -0.00010876596208520627, 3.8025818001635086e-5,
        0.00014808097959478184, 0.0001145566376240535, -3.00362129896468e-5,
        -0.0001453882525886243, -0.00011959856714739044, 2.2204472803787583e-5,
        0.00014228140521275318, 0.00012402653521597257, -1.4815299360551801e-5,
        -0.0001393820727557938, -0.00012864518250345062, 7.064395487041102e-6,
        0.0001360639981815466, 0.00013315002267869547, 1.1467450455590146e-6,
        -0.000131834568050426, -0.0001367654418658658, -8.952745904085486e-6,
        0.00012742732826010296, 0.0001399104569204667, 1.6365079350759545e-5,
        -0.00012322639993652722, -0.00014326498788373417,
        -2.4203412548078502e-5, 0.00011845368325677825, 0.00014626995577714211,
        3.2267179354468534e-5, -0.00011288870852596105, -0.00014832739643274806,
        -3.972901859701943e-5, 0.0001073759740716238, 0.00015008730372273647,
        4.6893450932694146e-5, -0.0001020149375560629, -0.00015201905102590828,
        -5.449126370979602e-5, 9.597400581334335e-5, 0.00015337825355412775,
        6.204623892265984e-5, -8.933349479538988e-5, -0.0001538188288505355,
        -6.88708949883555e-5, 8.294430404806427e-5, 0.00015413990473594664,
        7.552305156553833e-5, -7.660996571593347e-5, -0.00015454114808406623,
        -8.255155038237728e-5, 6.955069269104658e-5, 0.00015418566862036918,
        8.926251357976907e-5, -6.213883587427684e-5, -0.00015302231092597813,
        -9.519279678436827e-5, 5.512657597954477e-5, 0.00015189916769676217,
        0.00010108218685059995, -4.804750558629825e-5, -0.00015072112584313483,
        -0.00010722740966746069, 4.027266602930198e-5, 0.00014866350540042233,
        0.00011280230011874645, -3.242134171436841e-5, -0.0001459765610517922,
        -0.00011762459773354743, 2.5054403770495863e-5, 0.00014345139660567273,
        0.00012252213080386794, -1.7495430195073613e-5, -0.00014071027289053458,
        -0.0001275010764231161, 9.346586227566677e-6, 0.0001370442487785179,
        0.00013170511194155566, -1.3982200499969214e-6, -0.00013297409521575548,
        -0.00013525447874525412, -6.048645024697257e-6, 0.0001291354396760883,
        0.00013896033521457998, 1.3794144028420596e-5, -0.00012491576711666852,
        -0.00014253647630257506, -2.1953531768117172e-5, 0.000119811248133819,
        0.00014520258061856783, 2.9662607274147006e-5, -0.00011454874780068424,
        -0.0001473654239831881, -3.691617180731588e-5, 0.00010952969918907895,
        0.00014971714655458935, 4.453626216315761e-5, -0.00010398434647784167,
        -0.00015171420030909424, -5.2339443982396856e-5, 9.767797897796877e-5,
        0.00015274920987424386, 5.949412057271109e-5, -9.145363608353745e-5,
        -0.0006133056482464893, 0.0036522201614742054, -0.012591886163885322,
        0.024759023609569733, -0.08821287978445247, 0.09931172438923222,
        -0.03349686069125967, 0.008550328109767764, -0.00166744799330264,
        0.0001696220725012349, -6.627825899473127e-5, 0.00014801327752365318,
        0.0001309634212698542, -5.440959602843733e-7,
      ],
    ];
    const result = wavedec(data, "coif5");

    const reconstruction = waverec(result, "coif5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49007584538685767, 0.9060288003399077, 1.1888573414008103,
      1.3063149603819197, 1.2584035882849471, 1.0755426251652977,
      0.8099757188522817, 0.5225796826974434, 0.26831155570546694,
      0.08381341395987518, -0.01987571457651971, -0.05783413476860785,
      -0.06501208929176262, -0.08490927271385562, -0.1561070207583904,
      -0.3001124032398651, -0.5136452922990242, -0.7674013994078352,
      -1.0117221880256875, -1.187887454414842, -1.2423371962118541,
      -1.1403712034215618, -0.8759547513428002, -0.4751604424458138,
      0.007716529838745656, 0.5005832403043525, 0.9281593095617711,
      1.2274101704362277, 1.3602378777614306, 1.3205152177942132,
      1.1338970869816671, 0.8505625357194022, 0.5327161400667311,
      0.2399042699988555, 0.015685329946479976, -0.12118124668969199,
      -0.1790007404142258, -0.18846029606264839, -0.19230585860094912,
      -0.23207023547123595, -0.3352611198723079, -0.5062955896708141,
      -0.7235358528263517, -0.9432675383450027, -1.109736244031604,
      -1.168841977782298, -1.082155649057832, -0.8377971051419308,
      -0.45543361989570225, 0.01595074697401401, 0.5071365150502375,
      0.9425759036854162, 1.255934394731177, 1.4036722082762139,
      1.373529405594027, 1.1859878841126608, 0.8884524302102035,
      0.543618278201357, 0.21485802595948128, -0.04786235440708142,
      -0.21820167897867346, -0.2974371826933093, -0.31141791405681474,
      -0.30139340662177705, -0.31113073806399444, -0.3736326944304889,
      -0.5008530003993014, -0.6790521136306518, -0.871033241174222,
      -1.0247861487112926, -1.0864644542974977, -1.0145224065807046,
      -0.7915097577033373, -0.4305507049760789, 0.0252104319387407,
      0.5102311197960455, 0.9495922400625727, 1.274442702292697,
      1.436292483615835, 1.416838549639027, 1.2310623838591441,
      0.9229332954703212, 0.5548032820588004, 0.19306441489597181,
      -0.10649920980678934, -0.310202088874757, -0.4121317709481463,
      -0.43278982652856246, -0.4112087353614597, -0.392645605200476,
      -0.4150229334916359, -0.49757432569355675, -0.6345903812099982,
      -0.795885259523472, -0.9339296454195605, -0.9959304340855227,
      -0.9378889063560396, -0.7371437246925452, -0.400233248902439,
      0.03598370076313498, 0.5103946365142484, 0.9495994126053081,
      1.283053794944247, 1.4578847923017844, 1.4499282270400968,
      1.2684235539408732, 0.9533010082654121, 0.5657500439605387,
      0.17434264236660457, -0.15998140401527078, -0.39652575811173835,
      -0.5221228905397759, -0.5514908382973072, -0.520757025819168,
      -0.47590821026379193, -0.45914984445661694, -0.49664639317187265,
      -0.590749061804704, -0.7186895726811116, -0.8381044066333931,
      -0.8980481759414178, -0.8527747945514993, -0.6748490330333219,
      -0.36427561917978096, 0.04872954317189648, 0.5081769735867426,
      0.9430583952459171, 1.281989096445791, 1.4683486904759262,
      1.4723839310252618, 1.2974399204510099, 0.978870161930559,
      0.575907980548552, 0.15844415214037216, -0.2081525721799803,
      -0.4766005354413946, -0.6265095398744154, -0.6664580583786118,
      -0.6290232611013298, -0.5601561349528914, -0.5056562527421289,
      -0.4981828512235862, -0.5480765709543916, -0.6403009718413415,
      -0.7382817466680236, -0.7936991747480961, -0.7597971322709751,
      -0.60487530013126, -0.3225505958872201, 0.0638687994340057,
      0.5041403321138777, 0.9304916388721578, 1.2715681914899406,
      1.4676977166184757, 1.4838966095641635, 1.3175548009837694,
      0.9989847088737581, 0.5847064015462745, 0.1450582980734097,
      -0.2509434070122805, -0.549944003891272, -0.7244610492785821,
      -0.7766630388608091, -0.7349840505592479, -0.6445799913149497,
      -0.554113622573822, -0.5022221539901877, -0.507064009358484,
      -0.5615521844873714, -0.6354547576529537, -0.6838280600667401,
      -0.6596643359512029, -0.5275709810590649, -0.2750138824590956,
      0.08177571236105813, 0.4988490932982286, 0.9124739468098935,
      1.252203065215161, 1.4560585069358365, 1.4842669299646667,
      1.328294683125738, 1.0130283604216037, 0.5915642931116355,
      0.13381897566494397, -0.2883699858187131, -0.6161673932518854,
      -0.815225859488548, -0.8811235135491533, -0.8376196847118641,
      -0.7283330398792387, -0.6040270335067786, -0.5087267667679937,
      -0.4681388122243758, -0.48324347366634346, -0.5306262922072836,
      -0.5694317380929835, -0.5531689318616335, -0.44338128221044465,
      -0.22170745649494866, 0.10277018279151262, 0.492859776966198,
      0.8896227633285347, 1.224391228757633, 1.433668526717778,
      1.4734082105449664, 1.3292766295206202, 1.0204345944283462,
      0.59590037223787, 0.12431211134830206, -0.3205308691043256,
      -0.6749781958826129, -0.8981392503736905, -0.9789145850951386,
      -0.9359262635980006, -0.8105414779101235, -0.6548412480830346,
      -0.5175836039722909, -0.4316594579275005, -0.4061328509810607,
      -0.42479695133162365, -0.4515479173188252, -0.4411792135964925,
      -0.3528447582119383, -0.1627617022198053, 0.12711084691583846,
      0.4867112198615726, 0.8625880171526491, 1.1887078310362635,
      1.4008724512975308, 1.4513479780932121, 1.320214603391397,
      1.0206961257963623, 0.5971432643468483, 0.11608389531841654,
      -0.3476030226544194, -0.726181461853068, -0.972629924826556,
      -1.0691792165668563, -1.0289277396395602, -0.8903152618583082,
      -0.7059477901931077, -0.5286056939676884, -0.39791130637927,
      -0.33092703291540043, -0.31895323534347714, -0.33124316628731904,
      -0.3246299063173582, -0.25658862698663576, -0.09839628316572163,
      0.1549890821290003, 0.48091511881774685, 0.832041667475605,
      1.1457968702312389, 1.3581172481078139,
    ]);
    const expected = [
      [
        -0.7978460674321762, 2.265566537032131, 2.227518472775715,
        1.451553451472422, -1.3253972666912932, 0.617013607990578,
        2.315652247797137, 2.382361527037663, 0.1750928920257276,
        -1.089275136323964, 1.8035802040355626, 2.1753633961611065,
        2.077428998314913, -0.9422846470486599, -0.28607294907553527,
        2.3869039493482065, 2.169475689420035, 1.3569980281599248,
        -2.722031959824538, 0.9811347581037994, 1.800230177210544,
        -2.4841503237844633, 0.3300032379815778, 2.2004457180504304,
        -2.2216408978691287, -0.3218953731771539, 2.572671177958189,
        -1.9550518477129546, -0.9139841868335842, 2.863909484693127,
        -1.680718589488883, -1.4022468174132532, 3.019934430900338,
        -1.3728986105107033, -1.7726493177805438, 3.0040261873228484,
        -0.9976776549919291, -2.040503886752946, 2.809730090333603,
        -0.5305724501925433, -2.2395386211612083, 2.4636309970727788,
        0.028933635215962743, -2.405406223524284, 2.019062585685784,
        0.6415501063328225, -2.51150405431929, 1.3477921798720325,
        1.7940813691822273, -1.5582043315955099, 2.8632217883007165,
        -0.42891639616859145, 2.079645933645151, 0.5541393577304478,
        -0.7007049727412781, 2.734253427882384, -0.8436639275728293,
      ],
      [
        -0.25437905087926355, -0.47840507390991477, 1.8796092052612074,
        0.11666278011091537, -0.10300264033497404, 0.31301433696557485,
        -1.3849317899272469, -0.7469613131006797, 0.5754712182535134,
        0.09675079957670868, 0.6108171350495697, 1.2215830289745295,
        -1.0175324612340602, -0.6744757838997901, 1.4841529584169222,
        -1.1808315944280228, -0.00582354304259791, 1.2183196529213034,
        -1.5595054135693143, 0.7771762047874436, 0.5399741874299128,
        -1.4285526645270443, 1.2867583561273597, -0.2855182385052369,
        -0.8302928633387685, 1.3238260883034503, -0.9489867311884244,
        0.022010119606167684, 0.8628726054114004, -1.2026074578879495,
        0.8235757605238755, 0.06164188104661303, -0.9511678005593073,
        1.2897452518893693, -0.7963817246968832, -0.2870925504301306,
        1.2601431255885442, -1.4056671794499846, 0.5434770900425856,
        0.7575296043304073, -1.5528836584035064, 1.2390368733813661,
        -0.03406556526009306, -1.1714656882632823, 0.4467771225150164,
        0.8383270034873918, -0.6422007357067125, 0.8516644605629533,
        -1.004932695725037, -0.12009924414838033, 0.02832087183342486,
        1.0449906361651295, -1.0130494457168553, 0.2978767274557966,
        0.6174050149494366, -1.188530217485123, 1.0522021754829436,
      ],
      [
        0.07838973214747524, -0.06356921128843485, 0.12178002552615805,
        -0.1099561127822587, 0.20197977457018737, -0.2265224769019415,
        0.08230803313533601, 0.07612418199905821, -0.3678615509235043,
        0.6062887971455807, -0.24365534307742584, 0.13647846127841695,
        -0.019765288666933598, -0.04907062584322335, 0.03569185858893315,
        0.02698042096153147, -0.05909020327775412, 0.021029653889724286,
        0.04119034830711194, -0.05483281292685414, 0.004152052995991285,
        0.0521314064089725, -0.04655716309439605, -0.014554071366120089,
        0.05774615784546192, -0.0329134541696185, -0.03041996929174479,
        0.0584926498398573, -0.01705994508914845, -0.044916708601214175,
        0.0530556084179676, 0.0011636873727749956, -0.05369791284061025,
        0.04343973632029122, 0.018634643186449865, -0.05891773994972212,
        0.028819578967494514, 0.03486844717370921, -0.0571368394484812,
        0.012518643221547178, 0.047444657492653496, -0.05141478179169062,
        -0.006083664016924689, 0.05580544047348159, -0.039479141355525674,
        -0.02290220609205148, 0.05881701329369801, -0.02515518040939966,
        -0.0388568548546831, 0.056265185480842965, -0.007216039164810079,
        -0.049805891213942445, 0.04860070866086847, 0.010232292322532335,
        -0.05748104737806607, 0.036055074894742745, 0.027795660447739845,
        -0.058305988125432355, 0.020569820652888777, 0.041771766020416795,
        -0.055127339984199844, 0.00257091788696133, 0.05268664925922872,
        -0.04527622409410244, -0.014962786672264819, 0.057903179920068396,
        -0.032663499307688824, -0.031916741529580454, 0.05825024467381846,
        -0.01498085143488917, -0.04676181189780324, 0.05394921735923607,
        0.027756560148607244, -0.055177940742625595, 0.08951973769721835,
        -0.08281381339103329, 0.018453947877174207, 0.08642289935609791,
        -0.16642851473030676, 0.10029334956758472, -0.026353263374482246,
        -0.04384962996813737, 0.04908751483498819, 0.008066348433499662,
        -0.056855120077684146,
      ],
      [
        0.0005489517311177435, -0.003826021034503023, 0.012776150261916076,
        -0.02494064103225168, 0.08971576695598213, -0.10115374601795182,
        0.03423990099349681, -0.008846703155806964, 0.001618183703217928,
        -0.00019480655118438804, 0.00015112242529865207, -4.232586564791622e-5,
        -0.00010619231996006595, -8.624111347615007e-5, 1.3844240800662635e-5,
        0.00010146815019535325, 9.66819418020661e-5, 3.7617203858273857e-6,
        -9.261603304335569e-5, -0.00010461352089961154, -2.1356999299683685e-5,
        8.115956240859173e-5, 0.00010942495944967848, 3.7731248205290985e-5,
        -6.838891627143722e-5, -0.00011198942889376187, -5.3202617064711316e-5,
        5.4360577708518584e-5, 0.00011252272649117176, 6.813380692228407e-5,
        -3.840971294263565e-5, -0.00010999944485980229, -8.139847221832616e-5,
        2.1252087212794125e-5, 0.00010429775409891034, 9.202722640338942e-5,
        -4.257872236738335e-6, -9.6582229764998e-5, -0.0001006037766741366,
        -1.2600452689232611e-5, 8.712016482211134e-5, 0.00010750301695027113,
        2.98488456065566e-5, -7.509742380786847e-5, -0.00011167281339373442,
        -4.656379220372477e-5, 6.0810517870172014e-5, 0.000112520348577825,
        6.147417122780533e-5, -4.563374191694201e-5, -0.00011096099053153818,
        -7.482553290453981e-5, 2.9816283653257445e-5, 0.00010743817280633188,
        8.712231499705738e-5, -1.2705644257080996e-5, -0.00010106164594626192,
        -9.739904681221421e-5, -5.0880262906021825e-6, 9.16668021965855e-5,
        0.00010465608969558823, 2.2137101393540463e-5, -8.047876373152098e-5,
        -0.00010946768908248918, -3.833875471926397e-5, 6.798325565923327e-5,
        0.00011240695560878955, 5.4288983993060385e-5, -5.345179960344393e-5,
        -0.00011259426534109308, -6.921889729533469e-5, 3.710253478265006e-5,
        0.00010941430063910056, 8.183342623431115e-5, -2.0357445433006572e-5,
        -0.00010380963975807592, -9.231464440782983e-5, 3.6405524181936727e-6,
        9.644232930234593e-5, 0.00010131200085928532, 1.3691243404929706e-5,
        -8.6569437323375e-5, -0.00010804851385302971, -3.1159218632938994e-5,
        7.398070175647672e-5, 0.00011152068622244793, 4.7318775815343774e-5,
        -5.993230867946982e-5, -0.00011228992022323935, -6.195377146804463e-5,
        4.511004575268479e-5, 0.00011112199227633785, 7.573449401548498e-5,
        -2.8872436890888515e-5, -0.00010732754960450994, -8.807417706937212e-5,
        1.1342489626384375e-5, 0.00010027952594976362, 9.768944550149956e-5,
        6.049216433581188e-6, -9.092865022176903e-5, -0.00010470705621590866,
        -2.272610990788861e-5, 8.013917745844696e-5, 0.00010991968058187115,
        3.932579223064137e-5, -6.732167749649116e-5, -0.00011276024432489751,
        -5.5524715384477255e-5, 5.221501304927882e-5, 0.00011224468279894105,
        6.990179532482e-5, -3.6073558165521485e-5, -0.00010891500655238407,
        -8.214575422910486e-5, 1.9758791770911956e-5, 0.00010371717444870933,
        9.300274206466853e-5, -2.714006039202776e-6, -9.616291679335345e-5,
        -0.00010209054634708837, -1.5049573789204395e-5, 8.562080820559287e-5,
        0.00010817060594962749, 3.2133071563839434e-5, -7.30270660598262e-5,
        -0.0001113207876960373, -6.05812779635071e-5, 9.628151492786995e-5,
        0.0005126826173296419, -0.0031337192219334205, 0.012182815614257528,
        -0.012026299035760057, 0.004119385918443763, -0.002337311178717421,
        0.0010275429301899767, -0.00026031489561993205, -4.631214553603072e-5,
        -0.0001072419782646748, -3.140564119087177e-6, 9.18639701230465e-5,
        0.00010479707386159064,
      ],
    ];
    const result = wavedec(data, "coif5");

    const reconstruction = waverec(result, "coif5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif6", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4999212598632982, 0.9240468039694085, 1.2117578387617487,
      1.329341180191688, 1.2756393391510001, 1.0804308371963607,
      0.7960644513731555, 0.4844502003862733, 0.20257526520226837,
      -0.009988778775419316, -0.13865803927685405, -0.19479686130728208,
      -0.21001341864261602, -0.22537475807009438, -0.27836639570197413,
      -0.39096440552985345, -0.5619019317745302, -0.7651674994925892,
      -0.9552239320965044, -1.0777612398015912, -1.083402915624942,
      -0.9410134072325297, -0.6472956109101351, -0.23021498653298372,
      0.25476011260294523, 0.7349024262652195, 1.134699181024776,
      1.3912739943538424, 1.4672280268154159, 1.3579617211345312,
      1.0918276381780216, 0.7231442649226134, 0.31976816079684467,
      -0.051821447999542414, -0.3404251122612949, -0.5198042694633557,
      -0.5919894488441201, -0.5836275645272592, -0.5364711915781547,
      -0.49452179973699084, -0.491126174925386, -0.5393019616570957,
      -0.6277424508207778, -0.7235251152803706, -0.7808711223910418,
      -0.7537833771194096, -0.6093997531680496, -0.3386792068931307,
      0.03835244028442075, 0.47427781865289337, 0.9027001191790802,
      1.251571776757478, 1.4584085793442636, 1.483866275897705,
      1.320505470748717, 0.9946788194754791, 0.5610783158786189,
      0.09119634135613558, -0.34162841873205074, -0.6771288616967824,
      -0.8795821855606856, -0.9432808325448612, -0.8909000974217445,
      -0.7653666749062886, -0.6173776326859767, -0.4917323013216759,
      -0.41587826420840146, -0.39348269481909437, -0.4045680878966549,
      -0.4121083791798321, -0.3733684874413324, -0.2530807698338929,
      -0.03507618588613132, 0.2706567311789154, 0.6274102792312319,
      0.9780363916855063, 1.2567293789141931, 1.4036069683011183,
      1.3786586819684423, 1.1717277932873316, 0.8060932246178956,
      0.3347073730051277, -0.17013097022076754, -0.6313454630341182,
      -0.9825749939867168, -1.1810654040971418, -1.2150644258840637,
      -1.104137741776423, -0.8925056718366134, -0.6371453088258938,
      -0.39361726991328744, -0.2030697470421347, -0.08352989730566307,
      -0.027500659880711237, -0.006307547164866572, 0.020031501089580905,
      0.0900028298556445, 0.22817274348717415, 0.43636175495078794,
      0.6907511880974813, 0.9457921914911414, 1.1441013757388019,
      1.2300295697576085, 1.1636460340047918, 0.9317219341064251,
      0.552966322388972, 0.07610742973483829, -0.4288984841799859,
      -0.884614582843975, -1.22172563433399, -1.3929419393211768,
      -1.3820439275452854, -1.206048161656027, -0.9100935963190047,
      -0.5563534543116104, -0.2096643475014076, 0.07670065156944023,
      0.27177794295157975, 0.37173020555487746, 0.3977560075052098,
      0.3878075762009558, 0.38433801855361494, 0.42125319540222084,
      0.5134152539386521, 0.6513944198847769, 0.8028525493466335,
      0.920286530694601, 0.9532655647784136, 0.8621527738378214,
      0.6298888179918093, 0.2688367339917224, -0.1791555357986226,
      -0.6497025732329055, -1.0683808248681137, -1.3659730088242061,
      -1.4929652390252255, -1.4299494773592756, -1.1915268058202557,
      -0.8228232463036587, -0.38945688243496335, 0.03668036882428005,
      0.39250515893387267, 0.6362047353229962, 0.7542614401385626,
      0.7615570479222803, 0.6947520885813709, 0.6007505746400956,
      0.5232237280429238, 0.49059804293537324, 0.5085116107966807,
      0.5586083737007234, 0.6039507135781076, 0.5996745403192463,
      0.5061919508138232, 0.3015869478877426, -0.009987938321940282,
      -0.39615894614502356, -0.8011623573140508, -1.1567009240624868,
      -1.3963848603163915, -1.4704119890837133, -1.3570350686897203,
      -1.0680851492851549, -0.6471977454853924, -0.16109479194217727,
      0.3140984790974459, 0.708365727812145, 0.9715937094612582,
      1.0825333751576254, 1.0509821481367339, 0.9128658502598239,
      0.7195862938321258, 0.5243456702301831, 0.3688393863306575,
      0.2735639849966259, 0.2340551756132559, 0.22388192992680847,
      0.20353975648128603, 0.13291975555291458, -0.0158629369544519,
      -0.24859940819149445, -0.544678820350164, -0.8595854648084018,
      -1.1337707558687375, -1.3058879223979696, -1.3272721898848716,
      -1.1741918043719444, -0.8548756316889519, -0.40952926480671575,
      0.09680394250532437, 0.5869915863940858, 0.9872972739088388,
      1.2420803845531645, 1.324376160218499, 1.239999486301616,
      1.0243489224413393, 0.7328079698145258, 0.4271355760595894,
      0.1611498983270893, -0.03087800382622774, -0.14041375832353123,
      -0.1840828318838829, -0.1966505278063787, -0.219464196714744,
      -0.28737017903878836, -0.41748197744030763, -0.6027093415092728,
      -0.811774482364405, -0.9958297637683402, -1.1001434762106044,
      -1.0780384688727969, -0.9036661830285565, -0.5804255374815921,
      -0.1428411368786866, 0.3487411183301255, 0.8195711310849182,
      1.1954864511358, 1.4180706354153696, 1.456508165865737,
      1.3134291763442862, 1.023443434492099, 0.6447756605342377,
      0.2460233065643752, -0.10882135955405048, -0.3735773682907941,
      -0.5282758773544229, -0.5809181889661558, -0.5623799443686002,
      -0.5159130838669864, -0.48399369013047655, -0.4958816517459596,
      -0.5590495592499132, -0.6566563043204087, -0.7517260180098995,
      -0.7970150357862933, -0.7481179482481146, -0.5765283707926371,
      -0.27933636752907876, 0.11697625297955921, 0.5597752444325187,
      0.9799853687343143, 1.306137127816827, 1.4795392071020756,
      1.4670569398559663, 1.2685071727048443, 0.9169254727854149,
      0.47162557911828595, 0.005655397676682272, -0.4094443084600092,
      -0.7180639841590319, -0.8908465819387583, -0.9286294973915601,
      -0.8592743655770798, -0.7283575014737463, -0.5861498818273827,
    ]);
    const expected = [
      [
        -2.158953959092129, -0.7886208278326321, -0.3683332335240372,
        0.9373524101634557, 2.6676088748581472, 0.4178402331615969,
        2.2409676040109434, 1.6494001027442506, -0.28647873181002226,
        -0.5843122847879949, -1.8179933151476986, -2.221785791198379,
        -1.1551162013073413, -0.37915793480280846, 0.34058691327061513,
        2.665426433215495, 0.8597542341204197, 1.5633301559166513,
        2.2701658761332184, -0.05406631892700369, -0.44761913895146094,
        -1.5269050497368668, -1.8808188421161174, 1.4642143897150008,
        2.7192898492258286, -0.10076835459711471, -1.172911486973905,
        -1.076882587091243, -1.5033048627481798, 0.9433604115366586,
        2.9676394187196076, 0.1876686354998902, -1.8906970892431867,
        -0.9853745399122869, -0.8185455669974574, 0.5386104933047048,
        2.8037003255141486, 0.6749632820055268, -2.3630651320803153,
        -1.279060057344328, -0.050224253381866146, 0.45722344771411677,
        2.282692989764638, 1.1095147445181077, -2.440800726652616,
        -1.8258871747549834, 0.5454972542354347, 0.7727741788939961,
        1.6004322256369319, 1.2599505631204504, -2.131594280049592,
        -2.387378953855114, 0.7833223887493784, 1.3951584125825074,
        1.0141248871647015, 1.0090852843110336, -1.5967279692472156,
        -2.7152727198917526, 0.6235554488449648, 2.1068809623242966,
        0.7383317538834985, 0.4016525572935632, -1.0855932635448193,
        -2.652140889931548, 0.1878842911678522, 2.650936835304019,
        0.8582148949754649, -0.37351603617331575, -0.8345522922016405,
        -2.1952545445310476, -0.29017835743368037, 2.834705681157743,
        1.295194634766807, -1.0596658771224114, -0.9709893386461166,
        -1.498364014634356, -0.558070751843662, 2.601704041390205,
        1.8530615740999838, -1.4621053545579548, -1.4340474406314696,
        -1.6372567582498596, -0.8572798717121953, 2.5058242035995444,
        1.0054522683743503, -1.8032549625637706, -1.2678901999312988,
        -1.8080752117312848, -0.006705120738398453, 2.9361939974383424,
      ],
      [
        0.06245813698642873, -0.02652748232209159, 0.0774107033396132,
        -0.046363493410482105, 0.00502167239189865, -0.07332857522579132,
        0.12587155374329562, -0.07939792690237855, 0.023600304127879876,
        0.09500261663253001, -0.3655372526012639, 0.5882981607975092,
        -0.21639463174198395, 0.1284313497075903, -0.032949751210376924,
        -0.02410444002481594, 0.020105177300641715, 0.01884698569541552,
        -0.038324251028184125, 0.012603251572104816, 0.02780880773906537,
        -0.034989068755145875, 0.0006747273327250704, 0.034621168520868204,
        -0.028691134081488455, -0.011681313776724994, 0.037954296988662546,
        -0.01890688240874263, -0.022451147462287078, 0.03720338690714889,
        -0.007667256655056981, -0.03124681364868769, 0.032744323097894476,
        0.004882661513040587, -0.03645041204160572, 0.024706881566495153,
        0.016408149583399072, -0.038196842556047314, 0.014295204643409332,
        0.026748433897120255, -0.03565807923649553, 0.0021874807644133233,
        0.03378703590872815, -0.029714559062706886, -0.009919996750274702,
        0.037838166806049234, -0.020398012018373383, -0.0212409213921698,
        0.03743284246791296, -0.009231028422116675, -0.03009381880102159,
        0.03366220819967092, 0.0031482250608938895, -0.03609628466584244,
        0.02586938851074293, 0.014963894914121497, -0.038055158356051534,
        0.015911243756621375, 0.025444109139150118, -0.03636739394922904,
        0.003778533448957233, 0.033077859449947754, -0.030577518665997436,
        -0.008228209980609916, 0.037459223242476386, -0.021947599922606614,
        -0.019895365245643736, 0.037780617095832546, -0.010685252492972582,
        -0.02897705791263148, 0.03432811687116872, 0.0006980109183795344,
        -0.03033771376926298, 0.005960331150786784, 0.09182959473252636,
        -0.1723545423428861, 0.0651099481304326, 0.03919355550716346,
        -0.08690703466344468, 0.044732487488587186, 0.04701993553607356,
        -0.03270699549766032, 0.04179416535033675, -0.027570670764619824,
        -0.01855456561287695, 0.03550508900216964, -0.006488277073370909,
        -0.031428426928361314, 0.03246028642727276, 0.005140483670660807,
      ],
      [
        -8.986557707988211e-5, 0.0011485882353172439, -0.004971734819586265,
        0.012307318899261356, -0.020305291778286053, 0.0855082622037347,
        -0.10261546926086824, 0.03922164086369226, -0.012891787770058817,
        0.0032722150108660665, -0.0007088172621920166, 0.0002025021741266341,
        -5.18612139230613e-5, -1.404487187617948e-5, -1.9248679422928585e-5,
        2.3688549758012527e-6, 2.072963751791371e-5, 2.0368233211399762e-5,
        1.5115614067877532e-6, -1.8725564694050158e-5, -2.1975982623919395e-5,
        -5.292469676721938e-6, 1.617724463929068e-5, 2.2944745381421136e-5,
        8.875228243390807e-6, -1.3244709364789794e-5, -2.332075908159878e-5,
        -1.2199607496664552e-5, 1.0018461586995476e-5, 2.3151498984608772e-5,
        1.526377541473888e-5, -6.49328624606021e-6, -2.2371867887976306e-5,
        -1.7957183592088442e-5, 2.7443504942061176e-6, 2.0942461207847796e-5,
        2.0123210702690925e-5, 1.0413360003362018e-6, -1.8968045309827466e-5,
        -2.173255495052283e-5, -4.744580756351151e-6, 1.6562451411503207e-5,
        2.2830296576960507e-5, 8.356795670628369e-6, -1.3723421607221757e-5,
        -2.3363503430898754e-5, -1.1806869652974457e-5, 1.0460669085666578e-5,
        2.323020150289518e-5, 1.4917164167108374e-5, -6.9223747244750154e-6,
        -2.245495738335538e-5, -1.7579871803292686e-5, 3.267839704118508e-6,
        2.1146827592572984e-5, 1.9811834654325432e-5, 4.678424741929416e-7,
        -1.9322111484599478e-5, -2.1584248496940522e-5, -4.255917538096548e-6,
        1.6939102206514893e-5, 2.2765348059233707e-5, 7.939316066559872e-6,
        -1.407482949911595e-5, -2.329163336288086e-5, -1.1350709040129932e-5,
        1.089414399977488e-5, 2.323359292257025e-5, 1.4456361168958549e-5,
        -7.468721657426377e-6, -2.2628368678756223e-5, -1.7248048292386754e-5,
        3.7977778817298586e-6, 2.1408809218903467e-5, 1.9599901626671252e-5,
        1.4420157071270214e-8, -1.9568217378153448e-5, -2.1375541505921698e-5,
        -3.7775269196104505e-6, 1.7236324455883834e-5, 2.2578724759339277e-5,
        7.398168490126738e-6, -1.451561436807951e-5, -2.3254659312129483e-5,
        -1.087249975850851e-5, 1.139711779761952e-5, 2.3338218513995783e-5,
        1.410787950915745e-5, -7.918017230855648e-6, -2.2748850472205545e-5,
        -1.692880253971028e-5, 4.247823211037937e-6, 2.1546618111848787e-5,
        1.9260039991843823e-5, -5.296849044623851e-7, -1.9842922221138272e-5,
        -2.1131476592573418e-5, -3.2160134154520825e-6, 1.7640520990406473e-5,
        2.249888084831767e-5, 6.94123929256593e-6, -1.4915552294244965e-5,
        -2.323581588487861e-5, -1.047351492442179e-5, 1.1778158182237692e-5,
        2.331506383584172e-5, 1.3667870209566105e-5, -8.39322687762282e-6,
        -2.282494734317643e-5, -1.6513954994555406e-5, 4.813351568780689e-6,
        2.178945966030337e-5, 1.8992558599725453e-5, -1.0480185863959096e-6,
        -2.0145683365662134e-5, -2.0967654838785198e-5, -2.7713900689876402e-6,
        1.7922211493022082e-5, 2.2329835134600403e-5, 6.459691690690511e-6,
        -1.526666977835759e-5, -2.3112624645348817e-5, -9.950306214786654e-6,
        1.2266090400230947e-5, 2.3355783150730642e-5, 1.323832484088178e-5,
        -8.91008617445328e-6, -2.2985957497827713e-5, 8.806141992645027e-6,
        -0.00025035891570553354, 0.0011630104874346579, -0.0028664742126214664,
        0.004824905568037935, -0.019711394564824007, 0.023453061101832418,
        -0.008931210895507484, 0.0029264192097484174, -0.0007138356491552547,
        0.00015190994819910011, -6.453600178342313e-5, -5.227304344253346e-6,
        4.6081061433072865e-6, 2.254189053805057e-5, 1.7958635206277917e-5,
        -2.677990009734921e-6,
      ],
    ];
    const result = wavedec(data, "coif6");

    const reconstruction = waverec(result, "coif6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif6_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.504142951251755, 0.9300010162912498, 1.2154055087115128,
      1.3266571592520773, 1.264269744684697, 1.0608642925687617,
      0.7718751558346018, 0.46145665794488594, 0.1871083611931828,
      -0.013207369456243123, -0.12835893852286806, -0.17409147997426844,
      -0.18600491472658787, -0.20742427026933663, -0.275401562781393,
      -0.4085483889012816, -0.5999251850076319, -0.8169255390911694,
      -1.0083135310092417, -1.1167434044712112, -1.0936711157942738,
      -0.9129126498443705, -0.5793810577195557, -0.13067839069630233,
      0.36904994725037754, 0.841698768133569, 1.2113391743217803,
      1.4201346929312353, 1.440297036039118, 1.2792857562433753,
      0.9770819101761611, 0.5962732776434958, 0.2074089587141697,
      -0.12680777121722758, -0.36468868293541024, -0.4929948886322505,
      -0.5269977184464241, -0.5033779298785971, -0.46795678340504554,
      -0.4615237357465908, -0.5074717614138458, -0.6044638011719035,
      -0.7260561673763926, -0.8274221170521101, -0.8574971759292982,
      -0.7734630182445124, -0.5538512571152847, -0.20684381195461402,
      0.2284973094621966, 0.6886050897450333, 1.0980402427917968,
      1.3854704524244663, 1.4992270410269521, 1.4187328016320226,
      1.1590656206314216, 0.7675645565563891, 0.31329540830560854,
      -0.12809763128885354, -0.49053836732818096, -0.7308443457346167,
      -0.8361440097599654, -0.8237783194688486, -0.7339428634795301,
      -0.6171096969462568, -0.5195307230456974, -0.4705556604444656,
      -0.4749937425995288, -0.5124379843849328, -0.5436831374871582,
      -0.5225508038350095, -0.4100422915892419, -0.18712062914948202,
      0.1372658608692658, 0.5251399365093116, 0.9159201629620543,
      1.2389320512538358, 1.4290810269086272, 1.4419324598115129,
      1.2645353000914938, 0.9193199656436024, 0.46005590716004563,
      -0.039236059990967354, -0.49982623251554514, -0.8546184918037967,
      -1.0614655342264763, -1.1103900739374768, -1.0231493666272886,
      -0.8454558503186714, -0.6339501882489758, -0.4412750655185248,
      -0.303011823285589, -0.22971888066848956, -0.20598488392607014,
      -0.1966136287152602, -0.15824118277542026, -0.053302004908095835,
      0.13734422261643842, 0.4064882731305714, 0.7195376789652506,
      1.0208285401142392, 1.2458777475490215, 1.3366475986626172,
      1.2560899218988557, 0.9983536303550244, 0.5920534908642737,
      0.09566182637634568, -0.41400961601418385, -0.8575922965496704,
      -1.169525485911309, -1.3111797107365515, -1.277706495202921,
      -1.0971085660116806, -0.8219111157268875, -0.5155962382872907,
      -0.23720138528515344, -0.027875785514934914, 0.09735684335546396,
      0.15072580005175323, 0.16563453117874732, 0.1850967584391044,
      0.24778515502256615, 0.3753822588207633, 0.5645846022011396,
      0.7859265621553504, 0.989855966043865, 1.1186420385694837,
      1.1211905485526106, 0.9670584519401897, 0.6560992609799655,
      0.2212005522468556, -0.27675516354846896, -0.7606764417852936,
      -1.1531072560248992, -1.3924324117702216, -1.4456381726251877,
      -1.3146421537470299, -1.0347540737431271, -0.6657238213695331,
      -0.2776097435498959, 0.06507792569322757, 0.31713453015048154,
      0.4610666589292292, 0.5082597321970282, 0.49284127364213454,
      0.4599943880614181, 0.45184539510697713, 0.49462869217388117,
      0.5904787502725298, 0.7160038001619647, 0.8280579327933129,
      0.8752827647895951, 0.812498270657738, 0.6142588842514004,
      0.2840487989175706, -0.1433661137502057, -0.6072391980297583,
      -1.0327164265918247, -1.346563618585958, -1.493048394769631,
      -1.446200269429668, -1.2155195475677336, -0.8437713153044318,
      -0.39740082581253405, 0.04812559163640551, 0.42454820751593353,
      0.6847624809104587, 0.8112404961484578, 0.8170671123449975,
      0.7395670321801677, 0.6283228214356147, 0.5307460558181275,
      0.47892859715193226, 0.4811314442936233, 0.5200599442306353,
      0.5583301317996326, 0.5496882256116915, 0.45306483311911394,
      0.2457979964175681, -0.06746674650018075, -0.45263648914024895,
      -0.8515534859332184, -1.1937820563154005, -1.412063487884785,
      -1.4577494097818338, -1.3124754958512617, -0.9932091359112996,
      -0.5493850373525595, -0.05274425861313148, 0.4177521880458777,
      0.7923857187824002, 1.024657178908642, 1.099546822607199,
      1.0342399586582305, 0.871349511907166, 0.6664926977471654,
      0.4734321406907081, 0.330539960236631, 0.25195463163656745,
      0.22557543523561047, 0.21828601717787746, 0.18695568719701341,
      0.09229495258649312, -0.08809186789299772, -0.35092560186691835,
      -0.6651467226356106, -0.9772128084874031, -1.222655054431542,
      -1.341150217820815, -1.2914361909933676, -1.0623767923655114,
      -0.6773742763584514, -0.19091950192342683, 0.32203074018725086,
      0.7814194170322659, 1.118615758151523, 1.2902399335758614,
      1.2860837578371178, 1.1293636386395323, 0.869403475341852,
      0.5686711838009149, 0.28743394336611, 0.06982573814760212,
      -0.06529034012292056, -0.12652704998493997, -0.14487270951525644,
      -0.16275868887201211, -0.22023344326806282, -0.3419030405414631,
      -0.52809576787007, -0.752633497434217, -0.967913442356333,
      -1.116139831726937, -1.1439615841875592, -1.0168659000036193,
      -0.7296777847816999, -0.3104260955377553, 0.1835640866215681,
      0.6765983155701679, 1.090081706344322, 1.3589277451463415,
      1.4450562764550063, 1.3448206272742351, 1.0886646678229126,
      0.733182629104365, 0.34757749821844386, -0.002159824692872847,
      -0.2675230815485443, -0.4268241316008809, -0.4874633864627502,
      -0.4807931749845777, -0.45107980361038036, -0.4415302728754913,
      -0.4810584594410627, -0.5752486987075782,
    ]);
    const expected = [
      [
        -2.236766522743333, -0.8246170356053726, -0.326335328435655,
        0.891505885366829, 2.661139413445063, 0.4238612248979744,
        2.245281419675435, 1.601294428649628, -0.2634248287005098,
        -0.5862714050912011, -1.9023161122855183, -2.2567740903166738,
        -1.2339520844993588, -0.329565150480982, 0.3090703034587714,
        2.643542527694211, 0.8673213988534683, 1.571333950328096,
        2.2328926883085183, -0.0612296250019182, -0.4118667633662661,
        -1.629648957836644, -1.825282900637905, 1.6775383189477246,
        2.5630976711795395, -0.25162195790674996, -1.0129517379116983,
        -1.2055942047675121, -1.5435873916269496, 1.3709863738103267,
        2.8394213197670974, -0.25163500710415715, -1.6533757070694546,
        -0.940669470186007, -1.0396710478536384, 1.0451577723577739,
        2.882789469128078, -0.07241784717980142, -2.224844732148997,
        -0.8851055084268489, -0.3869919705007435, 0.8101629084753073,
        2.6694441456157176, 0.19744651230041332, -2.623706613666952,
        -1.03614328996353, 0.30701427393360664, 0.7509212333317843,
        2.2315690231431473, 0.44715097453082836, -2.7831739473022266,
        -1.3376267475864239, 0.9257048777775181, 0.9067785768429625,
        1.6498891038064432, 0.5703571990390262, -2.6887956176866763,
        -1.6934931795822865, 1.3702572213765478, 1.2619333481985684,
        1.0348549764166, 0.49083618794848666, -2.3816132529461416,
        -1.9907377863370064, 1.5824869132898307, 1.748936340944495,
        0.5008529427548359, 0.18099462822922208, -1.9482599415115385,
        -2.1264251830743, 1.5580727805511565, 2.2644393581938402,
        0.13953397636306022, -0.3311154682028145, -1.5002943910076973,
        -2.0323200202522327, 1.346280452523266, 2.6965423291108226,
        -0.007662476593433588, -0.9671152690303803, -1.0286486310869083,
        -0.9453799445309112, -0.5371872942088203, 2.1107542745979724,
        0.7852098355617142, -0.979999016712168, -0.9892877659283014,
        -0.9704447441560384, -0.8160575872703419, 1.4505200890131105,
      ],
      [
        0.06494526668942589, -0.029965098075025506, 0.0846283436164471,
        -0.05646515908595468, 0.016714397373627444, -0.1027340768860237,
        0.16031809579600104, -0.0950234658029027, 0.02798803756457768,
        0.0978741692585339, -0.37383209089677877, 0.5995594943626743,
        -0.22395368555957265, 0.1350518415306305, -0.036043609980002576,
        -0.02702516602756997, 0.0270328775566221, 0.01485766902467371,
        -0.04273971421807995, 0.02216533153866996, 0.02344200336602905,
        -0.042120616012499244, 0.012824185724984201, 0.03133488769950589,
        -0.03969617211039357, 0.0023540675214163737, 0.037513412530971776,
        -0.034341166007095095, -0.007890763165515841, 0.0412477148153357,
        -0.027483349821005334, -0.018006046771182595, 0.0427321822340405,
        -0.01841845020969909, -0.02672232075020766, 0.0414052794777693,
        -0.008811080776507624, -0.03413149019750341, 0.03787208483840808,
        0.0018867343541020896, -0.03922533142949173, 0.03176733559234733,
        0.011910176017501313, -0.0422106279547101, 0.024083999623526836,
        0.02177837402221825, -0.042449610429104556, 0.014607465703285348,
        0.029786355766817544, -0.04033215521344527, 0.0046273648645880966,
        0.03655777746770277, -0.035636720275096075, -0.006023897319402291,
        0.04059574121745827, -0.028936572245724514, -0.01589971695049316,
        0.04273338910270247, -0.020399075683588095, -0.025256134535937922,
        0.04178610667477262, -0.010712175543995749, -0.03264655777248085,
        0.03884548646917769, -0.0003390627752526926, -0.03854883216451486,
        0.03307752763108254, 0.0100398953077576, -0.04165553795520811,
        0.025784859750018783, 0.020078451839651106, -0.04387673136209852,
        0.017091574021524978, 0.03744241315632873, -0.116037520888182,
        0.018618679172596263, -0.02872165366951549, 0.15590228263263212,
        -0.18072948853428164, 0.13041391535075825, -0.16661432357917136,
        0.19159248484576877, -0.07721944040651542, 0.07499182063220591,
        -0.046955237418681, -0.005147445672807178, 0.04060315337979502,
        -0.02615918411149792, -0.018846778133890615, 0.042581830345742505,
      ],
      [
        -8.746552817764721e-5, 0.0011621928570900123, -0.005023525794534843,
        0.01245408446858623, -0.020590535157835668, 0.08644144057040966,
        -0.10366154714620789, 0.03960251012671546, -0.013006513800730632,
        0.003300229622337838, -0.000710341162733791, 0.0002048131819970368,
        -5.533677508027511e-5, -1.8171977522359058e-5, -2.009037453312566e-5,
        6.0597101684389505e-6, 2.5464965688752778e-5, 2.1290065056515277e-5,
        -2.685235292257213e-6, -2.417269293987692e-5, -2.3198483853148578e-5,
        -6.728781617922952e-7, 2.2457488403670326e-5, 2.468936973718259e-5,
        3.958701768368139e-6, -2.0443025970255867e-5, -2.58131560263762e-5,
        -7.153825147943682e-6, 1.8179017924266445e-5, 2.6617400767335428e-5,
        1.0301859520671532e-5, -1.5606007546638427e-5, -2.702053551042772e-5,
        -1.3329251310069516e-5, 1.273837389007625e-5, 2.6948377339313326e-5,
        1.6097403370601662e-5, -9.711491095597969e-6, -2.6467897937261028e-5,
        -1.8585974158352915e-5, 6.60007397769219e-6, 2.5657910011160158e-5,
        2.0851702664985192e-5, -3.3602287730850177e-6, -2.4468478401952588e-5,
        -2.2844158353997304e-5, 6.741799010363534e-9, 2.2842643402679292e-5,
        2.4438332419639198e-5, 3.321025298925935e-6, -2.0863045217799943e-5,
        -2.56215895618709e-5, -6.5343819245944246e-6, 1.863737746527058e-5,
        2.6471762034582318e-5, 9.671869821175376e-6, -1.614503863983475e-5,
        -2.696974507618591e-5, -1.2729491036214918e-5, 1.3342762914814323e-5,
        2.7012082634145462e-5, 1.5576639821275616e-5, -1.0322540415775054e-5,
        -2.6599404405885526e-5, -1.8122833635674783e-5, 7.21318635763124e-6,
        2.5833949803429084e-5, 2.0411870890257043e-5, -4.016028241437436e-6,
        -2.4731019454618527e-5, -2.2461287825233676e-5, 6.933903475789045e-7,
        2.321137300453593e-5, 2.4160886641833455e-5, 2.6638082850401228e-6,
        -2.1289043779865694e-5, -2.5428952971864237e-5, -5.9171385863728635e-6,
        1.908831790030384e-5, 2.6322824542399615e-5, 9.053968973780944e-6,
        -1.6656146343155257e-5, -2.6889221247493253e-5, -1.211694653385838e-5,
        1.3934477809751648e-5, 2.7046374172340588e-5, 1.50284103918036e-5,
        -1.094543187389756e-5, -2.6727898866859186e-5, -1.7653065001127e-5,
        7.827623032315754e-6, 2.600846656252767e-5, 1.9978196300951135e-5,
        -4.6517041207127515e-6, -2.4966596693841917e-5, -2.2061732032160344e-5,
        1.3730521396926406e-6, 2.3551643748279234e-5, 2.385044684425848e-5,
        1.987622411483901e-6, -2.1713707662524036e-5, -2.5223375596728404e-5,
        -5.28886923927377e-6, 1.954301093482245e-5, 2.617679837083412e-5,
        8.447632901331846e-6, -1.7146685950636785e-5, -2.6791320131773007e-5,
        -1.15055324048529e-5, 1.450212612691807e-5, 2.704575798294864e-5,
        1.4454649565948556e-5, -1.1571551021517842e-5, -2.6840708555509886e-5,
        -1.716348566892005e-5, 8.45362125217455e-6, 2.6186166674599256e-5,
        1.954862353472072e-5, -5.275675830607048e-6, -2.5187918169806666e-5,
        -2.165907186711341e-5, 2.0351786665360473e-6, 2.385911725049917e-5,
        2.3510215477530865e-5, 1.3022054852866564e-6, -2.212371628953741e-5,
        -2.4991797279490453e-5, -1.1172033611997365e-5, 4.9629579322563556e-5,
        0.00018496888614342568, -0.0018397906750899698, 0.008183894402213994,
        -0.02564496453831788, 0.022495781700428066, -0.006311503927146921,
        0.004557328385994956, -0.0022803225198310298, 0.0008408742437090768,
        -0.00022117936354996672, 3.426304911114964e-5, -3.7488715274348923e-5,
        -5.615659873555227e-6, 1.7696951641727786e-5, 2.6707694231685594e-5,
        1.0644990614573149e-5,
      ],
    ];
    const result = wavedec(data, "coif6");

    const reconstruction = waverec(result, "coif6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif7", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5080825322953694, 0.937370568970928, 1.2251037011270092,
      1.3368846125588592, 1.272493155741761, 1.0639467624771262,
      0.7664307230093464, 0.44441983261506995, 0.15643237967251417,
      -0.05787270383312865, -0.1851860968280062, -0.2389461891288736,
      -0.2527571717825361, -0.2686879858032914, -0.3235856396940377,
      -0.43701848581079483, -0.6040382721290684, -0.7947211782735405,
      -0.9607234192247178, -1.047295373307204, -1.0077857459723103,
      -0.816987055097542, -0.47989823300597184, -0.03355850265665533,
      0.45872316364546406, 0.9195656778861361, 1.2733825418030316,
      1.462240596859375, 1.4580040644939496, 1.267926314261126,
      0.9324090501388621, 0.5155142908552078, 0.09053350698970658,
      -0.2759282303787334, -0.5375868285042162, -0.6766747127714824,
      -0.7049115999535751, -0.6572598802129745, -0.580248635812112,
      -0.5179673771235778, -0.4993669749583953, -0.5301315676915632,
      -0.5911972912384332, -0.6442887979262358, -0.6430477827005155,
      -0.5468868828325579, -0.33397707208801514, -0.009949697421406112,
      0.3900740849931725, 0.8068760063054344, 1.1688643979113782,
      1.4074487335405643, 1.4724410895661313, 1.3437980509352583,
      1.036854690982866, 0.5997390986757105, 0.10351761011341024,
      -0.37264666678474345, -0.7578589584694116, -1.0035773703767408,
      -1.0921925003887873, -1.038234303666946, -0.8821373238352381,
      -0.6782946419010638, -0.4804894998082162, -0.3283802356535889,
      -0.23838866695438754, -0.20118941426259915, -0.18630688872059348,
      -0.15251917652580765, -0.061293417334429945, 0.11029786803883085,
      0.3606125929838465, 0.6608782952118778, 0.9598822434960681,
      1.1949316228509708, 1.3065035633319133, 1.2530325287169877,
      1.0221817053806146, 0.6357452822823759, 0.14683748159001955,
      -0.3701256116126013, -0.8344062898936817, -1.1754403629454748,
      -1.347029778741189, -1.33596788906011, -1.163172814767987,
      -0.8772043391331964, -0.5418591442527811, -0.22093377846231083,
      0.03612449961110864, 0.20424247237743384, 0.2861081421200673,
      0.30828918625741214, 0.3112742630933537, 0.3361406285349487,
      0.4113788925683071, 0.543344964662458, 0.7128768994355572,
      0.8790430606469963, 0.9891688511229818, 0.9926750908301402,
      0.8552546943451421, 0.5697685565192494, 0.16099697374305158,
      -0.31714280896890035, -0.7914696784788656, -1.1843180169382868,
      -1.4298181383999564, -1.4878737266216366, -1.352555763094051,
      -1.0529525840752956, -0.6463111361170921, -0.20513733035328996,
      0.1986532355450603, 0.5087750677070655, 0.6952919241429394,
      0.7586032941977272, 0.725963061051131, 0.6416352299207169,
      0.5533412932117329, 0.49853253393085883, 0.4940143213103609,
      0.5315633711646572, 0.580635803084647, 0.5974488039130013,
      0.5380840879378096, 0.3722146829797099, 0.09385989449657478,
      -0.2737217751189158, -0.6804571906194847, -1.0588443443715256,
      -1.3382015160315301, -1.4604418730985038, -1.393605446561595,
      -1.1398703253992237, -0.7360586695226542, -0.24643673840104557,
      0.25055322457308676, 0.678546493384264, 0.9787132428344909,
      1.1208552641284222, 1.1076551266048813, 0.9712634373935486,
      0.7632661175766228, 0.5406584174206778, 0.35137852312107615,
      0.22299702581216302, 0.1573132798612223, 0.13208902827701763,
      0.10933315836329696, 0.04789099747190406, -0.08300021867342627,
      -0.29277981986450663, -0.5641949047589425, -0.855039535697597,
      -1.1067565842336755, -1.257913382467875, -1.259299472286676,
      -1.0869282920979468, -0.7496744338912296, -0.2895381510266314,
      0.22570694909854006, 0.7158896321690167, 1.1047861152340297,
      1.335654828283765, 1.3823690574619212, 1.2536115587839691,
      0.9892610099403863, 0.6499684758174809, 0.30253649238451713,
      0.004680665375282167, -0.2071596810734393, -0.32410585764527905,
      -0.36386692290544065, -0.3629799777856891, -0.3644239502327185,
      -0.40390651060734645, -0.4984317793807484, -0.6401586638444294,
      -0.7972059464085726, -0.9212879392863238, -0.9603148502158538,
      -0.8728010604449423, -0.6404154041971384, -0.27541037939658636,
      0.1791132610345957, 0.6564113673525529, 1.0792441938129946,
      1.3759673709704874, 1.4958148417094548, 1.419780059974994,
      1.1645324169616058, 0.778459599095155, 0.33080036326908646,
      -0.10353093416067405, -0.4598254269404734, -0.6964404710669279,
      -0.8016953524582436, -0.7933479992401855, -0.7110298845937472,
      -0.6037363852007108, -0.5156560233411633, -0.47398427100250584,
      -0.48182008426543405, -0.5179252763216011, -0.5433678723596853,
      -0.5133091971903274, -0.3908695000035923, -0.15944916762040057,
      0.16976718918922618, 0.5572223797308112, 0.941703058524633,
      1.252926731850271, 1.4270792642183159, 1.421603377037889,
      1.225661585693708, 0.8636965472024639, 0.3911463807910335,
      -0.11675585519811976, -0.580517498527038, -0.9326466314659515,
      -1.1308726390335662, -1.1653174100228236, -1.0580864987406013,
      -0.8555884618121987, -0.6156383771988897, -0.3926306865445728,
      -0.22447813169920705, -0.12451090740575815, -0.08024203318846188,
      -0.05915364172514482, -0.01988035891920853, 0.07419790470178506,
      0.24255199980507697, 0.4795922361022982, 0.7534267879800773,
      1.0117869255231255, 1.1937997778426597, 1.244787814601831,
      1.1304620972774757, 0.8469586063853001, 0.424128220002894,
      -0.07890111695663546, -0.5850091714696447, -1.0146735493580044,
      -1.3022718020105937, -1.4093179050019142, -1.3315848414212084,
      -1.0985300880579858, -0.7652835302810534, -0.3992274873783509,
      -0.06446439574735296, 0.1920778525841207, 0.3496170703114467,
    ]);
    const expected = [
      [
        -0.06325237059207253, -2.095684525690511, -0.883955636615943,
        -0.45286959641774543, 0.854148933594212, 2.682915859187053,
        0.42910279095296755, 2.2568043053701587, 1.6046631657906978,
        -0.4071228950470867, -0.6121282652308805, -1.9932834176423062,
        -0.7591610492353187, 0.7860422365108808, -2.041858855714681,
        -1.207874318022627, -0.4735918737202759, 0.24438239905189776,
        2.666092069359027, 0.8729058113495658, 1.579590783325813,
        2.247484366833436, -0.15828251258563983, -0.5291376219708184,
        -1.5876954373976482, -1.6334340388298936, 1.8346318712116334,
        2.5394301143137046, -0.5503983309852782, -1.319316826464416,
        -1.057660814744272, -1.0911797304479371, 1.608946029540503,
        2.689055303642385, -0.7417142738416622, -2.0809391043766543,
        -0.6565571621285046, -0.3007465681620866, 1.317915375369578,
        2.5050138527083243, -0.7355139299697494, -2.674874649888463,
        -0.4441188965854165, 0.621410183373253, 1.084847745748435,
        1.982072762794647, -0.6296648225537202, -2.976362571792982,
        -0.41437525917727347, 1.5212752931242308, 0.9977179642566522,
        1.1902781354435408, -0.5441827090108309, -2.919009331154497,
        -0.497719954895665, 2.2439187181271536, 1.0842890208164762,
        0.25946240884592986, -0.5845360135646608, -2.511968047844496,
        -0.5833644780572051, 2.6710613494363336, 1.3044281509738298,
        -0.6517516477817742, -0.8093013997765687, -1.8377729812297523,
        -0.5533969246242892, 2.7492959917299205, 1.5617202222351412,
        -1.39428997434168, -1.21107149042254, -1.031398250986111,
        -0.3190700042040034, 2.501534801765992, 1.731209806429095,
        -1.8641796230589225, -1.71596424642546, -0.24595862871233182,
        0.15028407677384012, 2.0193270989433763, 1.695396059148799,
        -2.0264586795876904, -2.202354510605871, 0.39358901674574076,
        -0.09502474682264574, -2.720459744601512, -1.0069213744540988,
        0.7405314593985115, -2.6250693455673573, -1.5290593026380541,
        0.6807486902696541, -0.8035258304985431, -2.8104003667440742,
        -0.1647495616420095,
      ],
      [
        0.05204821794775648, -0.0009191290203816804, 0.05156016593934219,
        -0.013035480178197466, -0.053174081353607294, 0.10774989600134652,
        -0.28968340840344614, 0.31818213278515367, -0.11445131569366102,
        0.019944034796585866, -0.0223967635063498, 0.11476591289051659,
        -0.37021710742812386, 0.5803005362119981, -0.19951425125641495,
        0.12649244384400754, -0.04473809646718647, -0.008226103058089834,
        0.013754885170324966, 0.011625775127414407, -0.028514989123867962,
        0.013807703444803865, 0.016431722371117626, -0.027573514461256762,
        0.006924430675607579, 0.021766639408842985, -0.02535254993540016,
        -0.00042638631372848704, 0.025679583359918795, -0.02122118649847822,
        -0.007675225327407832, 0.02773052130642758, -0.015804515157264734,
        -0.014453835877166914, 0.02799795567026925, -0.009139906806901372,
        -0.020204283596097394, 0.026217238264375765, -0.0020080872618968397,
        -0.024589567207586937, 0.022781032180445682, 0.005412656013706977,
        -0.027289230748367137, 0.017633074202434398, 0.01232075813226204,
        -0.02810092435431022, 0.011435440772340594, 0.018515071363689146,
        -0.027023498300787686, 0.004289601259527073, 0.02332302000641695,
        -0.02403985106162175, -0.0029815386443254573, 0.026636194934098193,
        -0.01948073679069508, -0.010219026318608172, 0.02803622841616931,
        -0.013498396538613615, -0.01658564054496882, 0.027586521367449345,
        -0.0066948760256575306, -0.02198430759580923, 0.025192458667742473,
        0.000685386366094991, -0.025712048337215895, 0.021108115516198286,
        0.007887905422763155, -0.027836336661318496, 0.015559821789309813,
        0.014691921519238142, -0.027903632775399662, 0.00892454715843538,
        0.020647191914908655, -0.027889138236141992, 0.006450959432555573,
        0.019954785906908648, -0.025061528875379394, 0.021769887749894794,
        -0.06909109839659042, 0.09603409487906475, -0.24134146258223454,
        0.26112261025154276, -0.09693556114837805, 0.04086906226378892,
        0.004546306666668398, -0.01967828347791488, 0.03209730335177133,
        -0.031015194018804038, 0.004677405221791435, 0.023428397957758692,
        -0.023671749871273517, -0.003568805261748945, 0.02681165909170843,
        -0.019065507362785502,
      ],
      [
        2.914046638795118e-5, -0.00032165689674438575, 0.0017718412709379623,
        -0.005591805593136568, 0.011318909374223307, -0.016755249807922507,
        0.08286454144891259, -0.103690614847577, 0.04263851182900455,
        -0.016300009895918753, 0.005138904104087206, -0.0013882798596426902,
        0.00038243936618861235, -0.00010884620765791168, 2.095571735384155e-5,
        -9.265750863728907e-6, 1.8848721954614493e-6, 5.254650867155374e-6,
        4.626483103203322e-6, -3.719615668638741e-7, -5.021164618511693e-6,
        -5.026670765602107e-6, -3.8340884096532866e-7, 4.61300787810536e-6,
        5.340679189268222e-6, 1.1273663968829955e-6, -4.127841000543164e-6,
        -5.562222563129167e-6, -1.8485791368642227e-6, 3.576813722384316e-6,
        5.693559501183372e-6, 2.5422377231240003e-6, -2.9624554401974812e-6,
        -5.728118710751668e-6, -3.1959706589945095e-6, 2.2917735648846883e-6,
        5.658763874421219e-6, 3.7908836426814005e-6, -1.5828685500782643e-6,
        -5.490284540283678e-6, -4.316342209847942e-6, 8.522171148110085e-7,
        5.232514374789553e-6, 4.7709091190856995e-6, -1.062966824887963e-7,
        -4.887050332095419e-6, -5.147994038177035e-6, -6.47005636883867e-7,
        4.452590773625558e-6, 5.433640563219937e-6, 1.3891768305827885e-6,
        -3.938656218725433e-6, -5.620887007773714e-6, -2.1018943480989995e-6,
        3.361557900585117e-6, 5.713756634085454e-6, 2.77784114870162e-6,
        -2.729995803510539e-6, -5.71349102099764e-6, -3.4114819382912965e-6,
        2.047232508487969e-6, 5.613160393835754e-6, 3.987636178430037e-6,
        -1.3254124014785146e-6, -5.410893277982769e-6, -4.489828967830541e-6,
        5.846012237150043e-7, 5.116710588062182e-6, 4.91298134169219e-6,
        1.6201674502669481e-7, -4.73998664195879e-6, -5.256764620097225e-6,
        -9.091948997246333e-7, 4.281133626946438e-6, 5.512462980827692e-6,
        1.6453477219844545e-6, -3.7430694631038302e-6, -5.668419235427131e-6,
        -2.350349700501857e-6, 3.140576647159698e-6, 5.72395755632945e-6,
        3.009985923801931e-6, -2.4896017872673893e-6, -5.685599851110256e-6,
        -3.620139445333137e-6, 1.7964299936131207e-6, 5.552816324380099e-6,
        4.173188822508875e-6, -1.0668690169190154e-6, -5.320283981114351e-6,
        -4.652701378306177e-6, 3.177167345653206e-7, 4.992361355407745e-6,
        5.0467944919210816e-6, 4.3155525385625303e-7, -4.582337002719536e-6,
        -5.355208083623069e-6, -1.1715817991920138e-6, 4.097743685357184e-6,
        5.576981581568971e-6, 1.8965988904482714e-6, -3.539324425757101e-6,
        -5.702254299970033e-6, -2.5913685813054445e-6, 2.9153780195703827e-6,
        5.723864262624641e-6, 3.236667085371437e-6, -2.24409067569011e-6,
        -5.646937254183026e-6, -3.8233611517413816e-6, 1.5391353852029639e-6,
        5.4784046504215315e-6, 4.348842396722309e-6, -8.05421838566822e-7,
        -5.216281674848081e-6, -4.802919456949154e-6, 5.2660541443502924e-8,
        4.8589361671880385e-6, 5.170168524718985e-6, 6.992968087372229e-7,
        -4.416728977683891e-6, -5.44458928712478e-6, -1.4338452892994115e-6,
        3.903870882842202e-6, 5.6291065900384295e-6, 2.1448465186647305e-6,
        -3.3256948017511296e-6, -5.721063775278575e-6, -6.846433474139027e-6,
        4.282140903792733e-5, -0.0001659530748356174, 0.00040139583640280186,
        -0.0004929640245481212, 0.00027033742022888044, -0.007005806018562028,
        0.009747301085385898, -0.004062193951132284, 0.0017626058453597089,
        -0.0006374931364273957, 0.00019727778723858242, -5.4811176399427916e-5,
        9.98552015868085e-6, -8.58624822205325e-6, 1.1311696954130714e-6,
        4.874174770328656e-6, 5.052833963369171e-6, 4.1393350833694036e-7,
        -4.592378688333347e-6,
      ],
    ];
    const result = wavedec(data, "coif7");

    const reconstruction = waverec(result, "coif7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif7_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5097000899822919, 0.9366749925174911, 1.2162134808676983,
      1.3151913985400703, 1.2379014641396555, 1.022819044464623,
      0.7312947990949725, 0.4312083184152158, 0.1798639695550775,
      0.010541081410030018, -0.07390406252839837, -0.09887862917043871,
      -0.10810260988160383, -0.14869217707329868, -0.2554086348743581,
      -0.43841826219782665, -0.6779737501459123, -0.9275897742603146,
      -1.125024526110802, -1.2082876835601843, -1.132521853348362,
      -0.8833110401995614, -0.48283722761625425, 0.012886703636198385,
      0.525199272198026, 0.9697166608126073, 1.2748473132825175,
      1.397318853190994, 1.3308948576312818, 1.1061920477052893,
      0.7817726860179697, 0.4288967458603664, 0.11390288752136257,
      -0.11726132561720759, -0.24846009805448482, -0.29446777813607505,
      -0.29367750989628183, -0.2945606477429303, -0.339651122184751,
      -0.45146271205225874, -0.6242167918734249, -0.8237035521257379,
      -0.9954285285393453, -1.0789774450912655, -1.0248477759061778,
      -0.8092881827323741, -0.44314576100805125, 0.02776937294494322,
      0.5311215878470722, 0.9833387803770266, 1.3080227981864145,
      1.452924803032635, 1.401272207015607, 1.174659094160961,
      0.8268517192385348, 0.4301618022863867, 0.05790845202474598,
      -0.23255690120197908, -0.41199284557752186, -0.4836133944775344,
      -0.4787354602408574, -0.44510891073940545, -0.4312144797191541,
      -0.47084702003756734, -0.5721938232226755, -0.7144003875702907,
      -0.8526092829230335, -0.93018801920253, -0.8949243735332248,
      -0.7148714122452998, -0.38955925760610277, 0.04654859634118347,
      0.5294888542058729, 0.9789567430209637, 1.3160100991555037,
      1.4809364729912802, 1.446821613048558, 1.2254267628751752,
      0.8639244908394931, 0.43335693784134277, 0.01176867676677984,
      -0.3337100478920355, -0.5613351845529262, -0.6622205074348593,
      -0.6591033453753685, -0.5969755081632548, -0.5282610430766708,
      -0.49661789753244573, -0.5237594006986853, -0.602853491981509,
      -0.7002845877366098, -0.7653206659738833, -0.745104811801176,
      -0.6009433929130964, -0.3214731773906503, 0.07093777483986596,
      0.5224639841559952, 0.9584292620942383, 1.2997252659319567,
      1.4809811051232926, 1.4659253664846856, 1.256058580048892,
      0.890432991502478, 0.436584964093, -0.025097161574408333,
      -0.41963814086915185, -0.6938070925906519, -0.826488518302829,
      -0.8306391240863623, -0.7465704093146016, -0.628541023770296,
      -0.528353946154939, -0.4803883886001523, -0.49206686875341044,
      -0.5422798396113813, -0.5881527955598129, -0.5783048850543351,
      -0.4690002508996189, -0.23879260286639986, 0.10237832059455265,
      0.5122535465118664, 0.9239757668048239, 1.260685674823057,
      1.4533922349397597, 1.4576160150694482, 1.2645662269560332,
      0.9039705221019725, 0.4377828541588186, -0.05369469723159784,
      -0.4898222487996456, -0.8072805113193536, -0.9730157708483055,
      -0.9893512119490705, -0.8901801758324777, -0.7294577025694725,
      -0.5651749890771223, -0.4431274622357808, -0.3847814256288117,
      -0.3824123712611995, -0.40272923836075686, -0.39792764245615997,
      -0.3211269515811231, -0.14196236341318236, 0.1419650589232666,
      0.5010103920682165, 0.8780835659830593, 1.2009474120866965,
      1.3991945531513672, 1.4216129794745473, 1.249488066449465,
      0.9023807518455473, 0.43481404889536035, -0.07539490233703301,
      -0.5442980727870672, -0.9002255861221704, -1.0988914730716823,
      -1.131514392115928, -1.0240795832275351, -0.8281471252153654,
      -0.6057699394978255, -0.41256410346602124, -0.28339272654702985,
      -0.22437830911477552, -0.21324605617672215, -0.20777236328699095,
      -0.15995281296505504, -0.03197822425909225, 0.19038466918719588,
      0.49073992313609055, 0.8234081484589401, 1.1230268636674245,
      1.3200679126580876, 1.35833842503722, 1.209952181996113,
      0.883850344734151, 0.4255648666957306, -0.0918610864642497,
      -0.5836277110237724, -0.9717369904468236, -1.2017720929546511,
      -1.2537785132212402, -1.144646046572908, -0.9215696721709632,
      -0.6484422766150602, -0.3888140972598093, -0.1898830723710756,
      -0.07164563243766042, -0.023930627966346152, -0.011930717652892997,
      0.011411618537481183, 0.08962153589071453, 0.24786954019257662,
      0.48321343952512796, 0.7626701967903575, 1.0298092863739496,
      1.2182917239741902, 1.2689117761421265, 1.145721625587405,
      0.8469917727563099, 0.4080414562871548, -0.10496525837678351,
      -0.6088535156937629, -1.0215397214238537, -1.2799398685750178,
      -1.3532664591806611, -1.2484730754571538, -1.0066104370877755,
      -0.6911715645968943, -0.37152787333061155, -0.10577008121628906,
      0.07264311945988872, 0.16107814462228753, 0.18532662053316443,
      0.18945446530359267, 0.22078415436528154, 0.3141688717317101,
      0.47989172902769783, 0.6985529763044278, 0.9244475512399191,
      1.0966716229334548, 1.1551229618415482, 1.057220153811368,
      0.7909132490501602, 0.38046369862700125, -0.11669701105083893,
      -0.6214359209209808, -1.049974447378201, -1.3323416687119292,
      -1.4276582197980932, -1.3324789883877681, -1.0801850159344777,
      -0.7316888688891612, -0.35991536143357283, -0.03207334779535026,
      0.205755396220284, 0.3378456840897729, 0.3796693194630392,
      0.3703567460475644, 0.358989333799895, 0.3885382442863266,
      0.4818616947918041, 0.633603719674204, 0.810254555476537,
      0.9584508708541549, 1.019385181130391, 0.9455373751640754,
      0.7152731367192797, 0.34135255686777144, -0.12906835086030935,
      -0.6231776651217977, -1.0579631758192902, -1.3586070935863632,
      -1.4752583418382852, -1.3940072498013834,
    ]);
    const expected = [
      [
        0.031357066804975214, -2.4172774896196185, -0.8883315873078419,
        -0.17176132666519875, 0.8283604535716218, 2.637019391507107,
        0.4361792318405106, 2.2342131725078707, 1.5367096697849831,
        -0.18503865844337228, -0.47828881598559775, -2.3136570020320457,
        -0.7855593446618019, 0.9318226972087875, -2.2875235793151116,
        -1.358973611244705, -0.1829502361135645, 0.2911130899743714,
        2.5971176111347325, 0.8765172294851982, 1.5737078965692173,
        2.168002608052825, -0.022791523802331168, -0.28936936855206385,
        -1.8518472618064916, -1.7677217126329257, 1.934873201438033,
        2.2181128155143006, -0.23540300692891925, -0.5940072675638682,
        -1.6418965543820998, -1.6189053600975818, 1.9614683708456373,
        2.3545674850118172, -0.464868081583035, -0.8956895403519191,
        -1.4238628853868578, -1.4289453904256684, 1.9522110471512142,
        2.4554437963366835, -0.6660566283904521, -1.1998208780407509,
        -1.201511013104567, -1.1999903744806728, 1.9108581770195026,
        2.515891137065773, -0.8368416697697795, -1.4992075831440435,
        -0.9808235310602673, -0.9350702290018138, 1.8418588386582342,
        2.5319608565918648, -0.9762220499892935, -1.7864160418426656,
        -0.7672519113158706, -0.6383903162296175, 1.7501908257146277,
        2.5007620973453166, -1.0843030245651821, -2.053996196239735,
        -0.5655530479104821, -0.31524125648830864, 1.6411611390641205,
        2.4205867618055983, -1.1622386294037619, -2.294710382211937,
        -0.37965459139262714, 0.02812841637326048, 1.5202001504205962,
        2.2909987835422005, -1.2121383717471403, -2.5017599895989524,
        -0.21255327876572844, 0.3846722531476881, 1.392660406123131,
        2.112873300642978, -1.236937920407712, -2.668835436976488,
        -0.06731395515294682, 0.7506046464160538, 1.254136341355745,
        1.903340832877266, -1.2421594912521727, -3.0207296558943355,
        -2.0090733138360863, 1.391887817974466, 1.6309720216239152,
        0.9477587232833771, 2.0806800529939844, -0.324893473241534,
        -2.8750097270968635, -2.5606791069086694, 0.6151949456448287,
        1.9451570617667404,
      ],
      [
        0.056771441918863706, -0.007756891468532426, 0.06299566206085536,
        -0.025091489488100662, -0.04659928071677712, 0.10780103873103246,
        -0.2749727140801282, 0.29121739480525827, -0.09423324703953073,
        0.0058159808502950975, -0.018118394812017453, 0.12016594116251705,
        -0.3829480076826468, 0.5964537894066813, -0.21305321424893625,
        0.13871602155279714, -0.050983629799005226, -0.012656819948307533,
        0.026205145280075396, 0.002458225559257427, -0.0333329005569004,
        0.0304000674925885, 0.004161717548504854, -0.03423802390410315,
        0.028277204613453136, 0.0075355440175470505, -0.035426125062373776,
        0.02591280753994856, 0.010868888413444631, -0.036171665750999414,
        0.02341593145774966, 0.014060481528599464, -0.0367438688904244,
        0.020633413758460582, 0.017186573344879337, -0.03686246096067447,
        0.01775242644159134, 0.02010325910124997, -0.036803194790467876,
        0.014646449613562769, 0.022915629583831906, -0.03628916322585498,
        0.011480963189477878, 0.025456695326777037, -0.0356020726881446,
        0.008157162346172793, 0.0278597947773807, -0.034471420328996534,
        0.004816391793692631, 0.029937254880777857, -0.03318166017692741,
        0.0013880182230798486, 0.03184970019883291, -0.031471536438438384,
        -0.0020129695782199076, 0.03339132134480678, -0.029624891381813588,
        -0.005428922303282259, 0.03474867429435027, -0.027392336821273577,
        -0.00877315833966326, 0.035700462417338936, -0.025053634940223404,
        -0.012059958254708493, 0.03645742575022292, -0.022373643795869473,
        -0.0152325847915437, 0.03678548864143566, -0.019624498695945382,
        -0.01827781262221441, 0.03690492912514128, -0.016448723631299806,
        -0.021746598830118476, 0.037094042459231404, -0.005839632906283751,
        -0.05896760519242469, 0.1996930415258316, -0.0247995175605437,
        -0.009355035459214596, -0.033427946766434194, 0.04594423268096531,
        -0.006351882213933878, -0.07771244068040666, 0.21023740983514752,
        -0.30881697729742036, 0.10737853663671665, -0.09563191974429668,
        0.05740568280847332, -0.006627713869546899, -0.030769687103245784,
        0.027901559912311424, 0.006989121064921438, -0.03522530353841003,
        0.026484353069651634,
      ],
      [
        2.8710438708836797e-5, -0.00032073695613020736, 0.0017848125601431842,
        -0.005640749723362716, 0.011453530759015073, -0.01701615624959146,
        0.08352107892584272, -0.10439045918133631, 0.04291052884197166,
        -0.016381556447073058, 0.00515718483279602, -0.0013884848271489708,
        0.0003835314689154965, -0.00011119439839548719, 1.834013582408029e-5,
        -9.519314064449345e-6, 4.4662539318614e-6, 8.102760736867151e-6,
        4.711656924948493e-6, -3.3549129209928722e-6, -8.15054324031161e-6,
        -5.014264934850975e-6, 3.001090351473414e-6, 8.09383151563432e-6,
        5.307434960405022e-6, -2.645117919935148e-6, -8.022277599375997e-6,
        -5.589488111960503e-6, 2.2855198917005003e-6, 7.937317816927397e-6,
        5.864069974186862e-6, -1.917025250995194e-6, -7.832972053222756e-6,
        -6.1260147112436024e-6, 1.5421484704588645e-6, 7.707857504713364e-6,
        6.370267640490123e-6, -1.1678286235245612e-6, -7.568320901191306e-6,
        -6.6006439645825645e-6, 7.934692933816591e-7, 7.416588626239548e-6,
        6.821369373903572e-6, -4.1366682294528325e-7, -7.247009893870592e-6,
        -7.027878422963986e-6, 3.0310598937737375e-8, 7.057707729750495e-6,
        7.214791878531337e-6, 3.495119186441646e-7, -6.854947410905312e-6,
        -7.385540008371033e-6, -7.257291090084635e-7, 6.641713843387025e-6,
        7.544893449195499e-6, 1.1038362871955225e-6, -6.412740385364781e-6,
        -7.688948570445985e-6, -1.4826089556455975e-6, 6.16566815044209e-6,
        7.812071265628941e-6, 1.8549086460512923e-6, -5.906602359596174e-6,
        -7.917278338359374e-6, -2.220015443866582e-6, 5.639243354377264e-6,
        8.00984120628964e-6, 2.583474412389394e-6, -5.358756158673361e-6,
        -8.08656910929303e-6, -2.9447583356685423e-6, 5.0623145912520566e-6,
        8.141642462464716e-6, 3.2967754428793998e-6, -4.7557840723477766e-6,
        -8.177637425804292e-6, -3.6381840380565543e-6, 4.443526619049352e-6,
        8.200273257491781e-6, 3.97453594289127e-6, -4.121178956028672e-6,
        -8.207111908569718e-6, -4.306025168322846e-6, 3.7854648122275866e-6,
        8.192216393182973e-6, 4.625702947739537e-6, -3.4419302767224066e-6,
        -8.157696543070287e-6, -4.931638206685134e-6, 3.0955355716127036e-6,
        8.109658109015375e-6, 5.2293452378663975e-6, -2.7424217195051144e-6,
        -8.046443797139102e-6, -5.519753927012456e-6, 2.3788824582215e-6,
        7.962065108077473e-6, 5.79615179787698e-6, -2.010066549491858e-6,
        -7.858141494930176e-6, -6.056055625350384e-6, 1.6414605449631843e-6,
        7.741096085645809e-6, 6.304896579148839e-6, -1.269735061393166e-6,
        -7.610068227489067e-6, -6.544344982080453e-6, 8.907771704953837e-7,
        7.459080881992259e-6, 6.768013246405695e-6, -5.092633081409618e-7,
        -7.289241052253826e-6, -6.972907217885922e-6, 1.311273701818604e-7,
        7.107213101883932e-6, 7.164327941825467e-6, 2.4641202153490466e-7,
        -6.912936714017564e-6, -7.344680166468965e-6, -6.27847641120644e-7,
        6.700505753556288e-6, 7.507983637536201e-6, 1.0090458696868908e-6,
        -6.470495012558412e-6, -7.65077749879639e-6, -1.3837100420067157e-6,
        6.2297280565970625e-6, 4.66566408873296e-6, 2.0810307840097342e-5,
        4.365139272575912e-5, -0.0009801950047337938, 0.00520192314924495,
        -0.017515963707139173, 0.048992643804841904, -0.04026434749411647,
        0.00882237577534426, -0.007384464464029292, 0.004543742949553573,
        -0.00202132719527304, 0.0006873407007636509, -0.00019206128597260323,
        5.8971921351844965e-5, -1.0223589999405719e-5, -4.120584069050093e-6,
        -8.077327697924639e-6, -1.6898158004230384e-6, 5.999573625260164e-6,
        7.88598582477357e-6,
      ],
    ];
    const result = wavedec(data, "coif7");

    const reconstruction = waverec(result, "coif7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4923021898350377, 0.9078079780475794, 1.186050274612756,
      1.2953047439821161, 1.2381437732664282, 1.0488882799287536,
      0.7837182180370326, 0.5060073341327536, 0.2706025462136639,
      0.11098590877818931, 0.032485814265331814, 0.013140686771986806,
      0.011858602335013874, -0.01834510241194709, -0.11554352115962585,
      -0.29643764195013217, -0.5495544079302757, -0.8359778355303623,
      -1.0975657341998837, -1.2706859517164046, -1.3020753135373622,
      -1.1628438833688364, -0.8570657320316359, -0.4227128784755315,
      0.07542630387077312, 0.5592202880501644, 0.953850911969112,
      1.2036556371081055, 1.2833614482842974, 1.2020614720013565,
      0.9990852742507402, 0.732917547648793, 0.46602603697221323,
      0.24944187287198705, 0.11094999913607251, 0.04979346236221016,
      0.039115683282241034, 0.03538428657254275, -0.007741333625321367,
      -0.12476937907996616, -0.3268311666251828, -0.5963161195739446,
      -0.8891971974507885, -1.1445953303217198, -1.2992740604464856,
      -1.3034724847349728, -1.1341010077417684, -0.801939753772025,
      -0.35094210014151067, 0.1503090877530894, 0.623003707478217,
      0.9949249268820964, 1.2156495703229901, 1.2664948521126733,
      1.1628841622696124, 0.9486848368505063, 0.68405409248911,
      0.42991930148724034, 0.2330185486277751, 0.11523885908524772,
      0.06986303007956213, 0.06555768391224859, 0.056954590215886614,
      -0.001005526719176364, -0.13875799589517845, -0.3616151733531052,
      -0.6459025635111695, -0.9428613264047548, -1.1894660106573702,
      -1.3235296660903408, -1.2993465020031272, -1.0999397716310708,
      -0.7427884448655144, -0.27750093396872827, 0.22411033373657563,
      0.6832199384250714, 1.0308090641068555, 1.2220758217997343,
      1.2450004679074995, 1.121083459350503, 0.8982154073405603,
      0.6375802472511177, 0.39795041517603674, 0.22134187412017048,
      0.12360732977780103, 0.09225883418544562, 0.09195260814837661,
      0.07610900723047304, 0.0015738593211853669, -0.15755075907438226,
      -0.4005714176457888, -0.6978890603923573, -0.9964447974962842,
      -1.231683289506062, -1.3431138293186209, -1.2896001635898424,
      -1.060530759910664, -0.6800094342322248, -0.20291662367273397,
      0.29630297099362257, 0.7394717819383485, 1.0613331848855818,
      1.2230317313552348, 1.219216752454823, 1.0771525410287812,
      0.8482002524657417, 0.5939178665763447, 0.37033450003240564,
      0.21436752438257806, 0.135764694308188, 0.11651918780851225,
      0.11778648301355671, 0.09241322767769469, -0.0002459464202397288,
      -0.18113538786828803, -0.44343353859421974, -0.7518205145623784,
      -1.049417177584311, -1.270774407294734, -1.357730678358808,
      -1.2741899156692325, -1.0160953571641456, -0.6140355777252072,
      -0.12772724194672921, 0.36637620723027536, 0.7914013388143581,
      1.08637961597246, 1.2186671210761058, 1.1895215214070616,
      1.0316009885845163, 0.7991520305922506, 0.5534539191488551,
      0.3472363480824642, 0.2119981090050831, 0.15137782056280047,
      0.14216133466097075, 0.1425509269464498, 0.10546379131249145,
      -0.006659374705265619, -0.2094459507911166, -0.48988974279633596,
      -0.8072160908420284, -1.1012485200881819, -1.306293262574281,
      -1.367130538380096, -1.2531263919602253, -0.9669035609068732,
      -0.5453305932532947, -0.05247624298862595, 0.4338406912822428,
      0.8386935914602549, 1.1058842521041177, 1.2091826426996792,
      1.1563279580406347, 0.9849494608158393, 0.751567469949578,
      0.5165365076316633, 0.3287687828660343, 0.21408428612207475,
      0.17007474655234928, 0.16868660317117365, 0.16574857573494142,
      0.11489241994199062, -0.01781036784299611, -0.24236344280067873,
      -0.5395859631982041, -0.8635741620439277, -1.1514148582660697,
      -1.3378250705701697, -1.3711125841991318, -1.226474393199219,
      -0.913271291944938, -0.4743843766836552, 0.022293040335050834,
      0.4982334533093321, 0.8810795414820571, 1.1198371039691803,
      1.1948275996075615, 1.1200802577548794, 0.9377242564446437,
      0.7059222159098526, 0.48347129576975756, 0.31499156384080645,
      0.2204264185904416, 0.19144867090478904, 0.19558572689661172,
      0.1868983940477296, 0.12036998345200645, -0.03379075757325273,
      -0.27971691624518624, -0.5921294600803231, -0.9203774758525656,
      -1.1994036399047574, -1.3649906998759864, -1.3695269887125516,
      -1.1943523066258648, -0.8555572297439475, -0.4017080471066139,
      0.0960428976067923, 0.5591225713517133, 0.9183388704837586,
      1.1282822860552288, 1.1758972661150624, 1.081248953598933,
      0.8904518214128705, 0.6626659008307998, 0.45451837975170406,
      0.3059108450452439, 0.2307767550896475, 0.21506230698595125,
      0.22234427586030822, 0.20554081729652493, 0.12161005821489729,
      -0.054639186060197964, -0.3212851538910009, -0.6470928268253037,
      -0.9770984874172547, -1.2447190469657854, -1.3874506422199613,
      -1.362276544699237, -1.1569309714570066, -0.7941592056137532,
      -0.3278287728552253, 0.168246683192735, 0.6161115158539194,
      0.9503020965154397, 1.1313174445690795, 1.1527297319604617,
      1.0403259714249, 0.8436532581473007, 0.6222174876742784,
      0.429889636304736, 0.30147919359622904, 0.24484211341995743,
      0.24045255533673376, 0.2484481423003766, 0.22124267032352862,
      0.11837204082694092, -0.08034058128098809, -0.3667988667123822,
      -0.7040183588963946, -1.0332048022830953, -1.2868871449261479,
      -1.4049085740445477, -1.3493177431043162, -1.1144320020779162,
      -0.7295101911080233, -0.2532844319498546, 0.23839414334169717,
      0.6688431271077627, 0.976852203847032, 1.1290926314422534,
      1.1257023048294055, 0.9978194660727419, 0.7978388938484022,
    ]);
    const expected = [
      [
        2.4070979063137092, -0.8427598524016056, -2.5400852504220657,
        -0.6054669305296076, 0.05331449576040584, 0.9767974478259914,
        2.599124544563391, 0.4181391316055286, 2.182679481649208,
        1.6364118765059608, 0.03569912522351788, -0.21671040711641618,
        -2.2111421377061453, -1.676924723430124, 1.8127359204352056,
        2.629718266496852, 0.16002037150716739, -2.6041193423555797,
        -1.1169748692762944, 0.06432998856085563, 0.4685941000425283,
        2.597667050575753, 0.8454043630475768, 1.5254560036178133,
        2.2201624125399326, 0.17431695238749872, -0.024215243321612363,
        -1.6721558108442924, -2.325317229285598, 1.1148613882534417,
        2.4075881096826195, 0.49932293507103664, 0.06692282451388655,
        -1.1896823326089823, -2.605697524894442, 0.29656861920645666,
        2.5353085890018217, 0.8618447033760086, 0.12702974536557848,
        -0.7216359389711211, -2.6443776268828616, -0.5589592244021958,
        2.4449550602112513, 1.2784092533740874, 0.18085251674146038,
        -0.3151202392397313, -2.4596840262326456, -1.3632445475061388,
        2.121824432916421, 1.7003669115617046, 0.2688770946302677,
        -0.0021206659311587737, -2.094746099238394, -2.0341634795814856,
        1.580451395836156, 2.067245027194476, 0.42278547541290834,
        0.207952042089105, -1.6105989167716297, -2.5066538735206945,
        0.8642006808825562, 2.316122203442225, 0.6579640913654071,
        0.32765578350288777, -1.0762131226134992, -2.740989806948199,
        0.040538404617084633, 2.391984513133372, 0.968937493153221,
        0.3870851262176832, -0.5578276249627758, -2.727309264327867,
        -0.807376671351712, 2.257380432909293, 1.3285727073482134,
        0.4264538822421298, -0.10928547038688834, -2.4857521386164114,
        -1.5916030412182414, 1.90001267642227, 1.6903516998971568,
        0.4899737018729031, 0.2272071767591354, -2.044497548266692,
        -2.2648853290733393, 1.3909593212765012, 1.9469971457768007,
        2.0914620200211536, 0.5707123481647844, -2.7597742782832246,
        -1.5034744112218386, -2.4030384851597715, -1.5364880493918238,
        1.9775918292143968, 1.7877211577391174, 2.1620040735154773,
        -0.46866152165046093, -2.823606745737522, -0.7325304255522822,
      ],
      [
        0.04280245411892101, 0.015562805244905413, 0.042075280636909025,
        -0.024949388786311647, -0.012553003248606904, 0.042510564048693966,
        -0.05638898840621443, 0.1316408638173672, -0.15322890802697273,
        0.07204470393423207, -0.01891046600740435, -0.0040775060494944075,
        -0.026332539029448567, 0.11708502977512014, -0.3563996974105707,
        0.5492579519601978, -0.17853924328778584, 0.11955759987494168,
        -0.05061235227409558, 0.0029736121993145133, 0.008117174044059813,
        0.0076794202144475935, -0.021614390386217902, 0.013590368044343262,
        0.008962715755676314, -0.02130560135297517, 0.00976883401974202,
        0.012715591116163289, -0.020969574517548144, 0.0057535947366709715,
        0.015893284018303547, -0.019758570786279486, 0.0015172189807983432,
        0.018429505430960266, -0.017748808367341253, -0.00279641179898657,
        0.020204879200915533, -0.015008370626016588, -0.00698072648386319,
        0.021165479991175323, -0.011659865087013749, -0.010894914428888075,
        0.021250905548540658, -0.007832555166693105, -0.014350110579223323,
        0.02048123443358325, -0.0036866619698022137, -0.01723309812121893,
        0.01886224964685811, 0.0006091035565205829, -0.019400009673248408,
        0.016487406659256118, 0.004882356121065835, -0.02078660960203105,
        0.013424891501728691, 0.008952260165035773, -0.02131436937347253,
        0.009829473837669434, 0.0126624543547658, -0.02098110560342792,
        0.005817529220241672, 0.015848491494665665, -0.01978388345494716,
        0.001583435472564641, 0.018396388642095585, -0.01778507521764916,
        -0.0027304250969507216, 0.020183218802660746, -0.015055976665990496,
        -0.006918080038193982, 0.02115758183755478, -0.011715633575433187,
        -0.010833494592180653, 0.021300245619485444, -0.008583664089736008,
        -0.00996440284623279, 0.0017544221738131568, 0.05021971268141252,
        -0.18208770385538683, 0.28169911978027357, -0.09219037149305065,
        -0.003176625185220213, 0.18068436745715521, -0.18437640095539667,
        0.06380476772196865, -0.012118681388001573, -0.12961111336473,
        0.02572527547480131, -0.012749768505429113, 0.03499507421698825,
        -0.01220530501760172, -0.012904623868044713, 0.015478431096217675,
        0.003659961956091155, -0.020463110718939755, 0.01494465784392788,
        0.007133773142913991, -0.021178332804853487, 0.011517513986391503,
      ],
      [
        -7.2515675932413136e-6, 8.872000451296516e-5, -0.0005653757249847134,
        0.002185720838903519, -0.005563302335464643, 0.009692520817956353,
        -0.013251510614506813, 0.0773433887993284, -0.0997930300230393,
        0.04307243316071067, -0.018248877902026044, 0.006681640508892794,
        -0.0021226204933397466, 0.000639183350554057, -0.00019541949548656715,
        5.564699465338679e-5, -1.5374161575919154e-5, 3.4056738036059706e-6,
        9.109040584419998e-7, 1.1350384103201523e-6, -2.850945249595495e-7,
        -1.3645358052508164e-6, -1.165008232580952e-6, 1.3249433472657863e-7,
        1.3051088922190265e-6, 1.2480655734541675e-6, 1.5124128206391864e-8,
        -1.2320687039944223e-6, -1.3184386257112828e-6, -1.6259418075729507e-7,
        1.146485343844049e-6, 1.375437703728205e-6, 3.085397711670521e-7,
        -1.0490438628222917e-6, -1.4182787662519367e-6, -4.513065854913398e-7,
        9.408224226991144e-7, 1.4465046081723217e-6, 5.893196454372464e-7,
        -8.231095229352697e-7, -1.4600294940065288e-6, -7.213411322987106e-7,
        6.970075731706759e-7, 1.458710849672887e-6, 8.461148850605124e-7,
        -5.636370167267671e-7, -1.4423595976684371e-6, -9.621794167222313e-7,
        4.24483543206827e-7, 1.411170298102631e-6, 1.0682738101773751e-6,
        -2.811267272424426e-7, -1.3656614965389554e-6, -1.1635059285273605e-6,
        1.3489427147885514e-7, 1.3062488196493419e-6, 1.2469529436037756e-6,
        1.2857809038525233e-8, -1.2333463419312966e-6, -1.3175619543934739e-6,
        -1.6046300570556846e-7, 1.147771945260079e-6, 1.3745817638360312e-6,
        3.0628871766037836e-7, -1.0505866986248297e-6, -1.4176314538371034e-6,
        -4.490118704401651e-7, 9.42691745682925e-7, 1.4462763464685026e-6,
        5.872754998791339e-7, -8.250159736890642e-7, -1.4600202873772477e-6,
        -7.194844835359268e-7, 6.988763766872812e-7, 1.4587400186013542e-6,
        8.442035125561857e-7, -5.657255657070829e-7, -1.442649758981563e-6,
        -9.60346612473248e-7, 4.2679428461580587e-7, 1.4118738695855422e-6,
        1.0667865853163184e-6, -2.8335678932076864e-7, -1.3665306828536122e-6,
        -1.1622375096483996e-6, 1.3702880689830884e-7, 1.307146728213104e-6,
        1.2456842029530854e-6, 1.0562310898077328e-8, -1.2345189523979404e-6,
        -1.3164742868555671e-6, -1.58069681111527e-7, 1.1493062197345761e-6,
        1.3738992290560877e-6, 3.04095876182272e-7, -1.0522005135076962e-6,
        -1.4171683799712922e-6, -4.469711068655064e-7, 9.442999488730186e-7,
        1.4458464754025284e-6, 5.851419530078274e-7, -8.268763601851701e-7,
        -1.4598424061893297e-6, -7.173810572205547e-7, 7.010073322923249e-7,
        1.4589825369907402e-6, 8.424059660314969e-7, -5.678267861631706e-7,
        -1.4430768536689193e-6, -9.587433215982644e-7, 4.28838544520334e-7,
        1.4123411339794386e-6, 1.0651545098616305e-6, -2.8560233277445774e-7,
        -1.367282628446243e-6, -1.1607506176728968e-6, 1.3942661658637892e-7,
        1.308287314871776e-6, 1.2445792518918197e-6, 8.312972055250362e-9,
        -1.2357745109775933e-6, -1.3155800875422197e-6, -1.559343258751246e-7,
        1.150582074933518e-6, 1.3730241585964878e-6, 3.0182670292887544e-7,
        -1.0537549197439753e-6, -1.4165267395970992e-6, -3.1119520311862848e-6,
        3.925385494713078e-5, -0.0002498518715978328, 0.0009899399082372497,
        -0.0025746582868625134, 0.004593960660946596, -0.00643941731980261,
        0.034923453413705056, -0.04471262632175454, 0.019330181287512654,
        -0.008120726227445346, 0.0029336507081733796, -0.0009194064210147384,
        0.0002760382110392935, -8.372229716995742e-5, 2.3241543428728012e-5,
        -7.466275952777902e-6, 1.091066676537863e-6, 9.297445755768588e-7,
        1.4059599976542142e-6, 3.159042877041291e-7, -1.0417595722336888e-6,
        -1.4206954593017328e-6,
      ],
    ];
    const result = wavedec(data, "coif8");

    const reconstruction = waverec(result, "coif8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5023555374860469, 0.923995961220115, 1.2017825390079158,
      1.303405915618631, 1.2330951833935089, 1.0284840904198995,
      0.749580985680157, 0.4627808124495437, 0.22408381007375267,
      0.06583326361437086, -0.009680684104918291, -0.028229217486978275,
      -0.03395278127110182, -0.07467685809362573, -0.1862504403380021,
      -0.3801763290899988, -0.6379383641787368, -0.9136725718306734,
      -1.1446332791209552, -1.2668417380589523, -1.2319103787048102,
      -1.0206745847201162, -0.6500330669074287, -0.17110242244651122,
      0.3410058818078103, 0.8033435965559683, 1.1432600600382572,
      1.3140465170956093, 1.3042562199980003, 1.1384753806523968,
      0.8694920823735104, 0.563986175048063, 0.285483698855727,
      0.07896924517653858, -0.03893528680090702, -0.08180771389953767,
      -0.08696808611787707, -0.102593142686558, -0.17195022483253947,
      -0.3190477266808248, -0.5396231313838562, -0.7999859099877737,
      -1.0441655293985295, -1.2076212860563986, -1.2340207922286117,
      -1.0907436203080847, -0.7790394798896443, -0.3360996193988428,
      0.1716542016185277, 0.6625226276000695, 1.0573319969663322,
      1.2967078072932332, 1.3535668789872999, 1.2377901509332745,
      0.9920239873446725, 0.6798053649660462, 0.3691374422702718,
      0.11576115471737192, -0.049609851111158676, -0.12690123028090902,
      -0.14384194572026482, -0.14560439343995302, -0.17981218860650694,
      -0.28101283534999216, -0.45884423617187775, -0.693148170645657,
      -0.9374541370723533, -1.1300485539117253, -1.2098311080077429,
      -1.1328659244235433, -0.8852985291242756, -0.48919528741732066,
      0.0003552292082107805, 0.5063173754761202, 0.9463089754495759,
      1.2506577920842605, 1.3774631479705577, 1.3209666279442593,
      1.1112327113696203, 0.8053428522496715, 0.47244849398150224,
      0.17655955015992736, -0.03852698930466386, -0.15836114411651706,
      -0.1988219602743045, -0.19887782737747953, -0.2072062708957354,
      -0.2663531931205801, -0.3987442812464336, -0.5983646509685621,
      -0.8304263260650813, -1.039235787820717, -1.1623031512240887,
      -1.1470650566359326, -0.9658604028751174, -0.6251948926794575,
      -0.16675809797973487, 0.3402504305235754, 0.813709950584875,
      1.1765318289893794, 1.373555630050527, 1.3832232529514108,
      1.2211863545999952, 0.9350460529059176, 0.591665920320827,
      0.2603633639158073, -0.003707483172535997, -0.17177299285959463,
      -0.24623579933667555, -0.2569861868869935, -0.25038783731873215,
      -0.2740050338059642, -0.36123924223565784, -0.5200517148679804,
      -0.7288641128781002, -0.9408334014197496, -1.0954831649619128,
      -1.1347166597704934, -1.0190468888880515, -0.7397672075018158,
      -0.3237850623308305, 0.17030345989155057, 0.6640863023846559,
      1.076305381919763, 1.3407579236979434, 1.4207094516697607,
      1.3162734246672299, 1.0629915093521598, 0.722074510503412,
      0.36486487180394106, 0.055518013829244706, -0.16369586154655608,
      -0.2807962740044841, -0.31419951514803424, -0.3047006211541794,
      -0.30162083430122033, -0.34692263184451927, -0.4616082939623407,
      -0.6381021870055397, -0.840732340392475, -1.0142856356835723,
      -1.0984696942312573, -1.0445304700862752, -0.8296609314717127,
      -0.46535543759235454, 0.002614264444584097, 0.5027924134281071,
      0.9531973209417665, 1.2793475587712455, 1.430708398812244,
      1.3914949901195324, 1.1831909182510163, 0.8582356091721828,
      0.4865631419718759, 0.13846580581157225, -0.13185090572866087,
      -0.29788636071029695, -0.3647928814441759, -0.36482748762791295,
      -0.3456981922180916, -0.35503909198297484, -0.42524096117707433,
      -0.5627496535651966, -0.7447544235740631, -0.9242323107259757,
      -1.0421016564501409, -1.0433432563483251, -0.8928651342016283,
      -0.5869000876935688, -0.15683415070089768, 0.3357146634761601,
      0.8115087876000586, 1.1909562974631847, 1.4117811994461615,
      1.4427254390562818, 1.289901060209552, 0.9942661320543276,
      0.6209400719982768, 0.24312679332927983, -0.07524915063531623,
      -0.29380928564039605, -0.4033539830933205, -0.4250759208933396,
      -0.4017692931932405, -0.38352877554730586, -0.41185168922268006,
      -0.5064501455896213, -0.6583468131166212, -0.8311600300592431,
      -0.9703153519135448, -1.0178153138275123, -0.9287051851774693,
      -0.6848798163638453, -0.302516311831876, 0.16897294284061914,
      0.6564060043359425, 1.078490289951549, 1.363844961778155,
      1.4669282477965362, 1.3779214806619278, 1.1241412332786171,
      0.7626898580423672, 0.36626350760530013, 0.005748126207111737,
      -0.2659906003561658, -0.4250745566996402, -0.4796833222216703,
      -0.46464106708040576, -0.42914018734765463, -0.42099413636490673,
      -0.47169281120839895, -0.5862965492609652, -0.7409126188453194,
      -0.8884878389793838, -0.9714456332052678, -0.9378691990519922,
      -0.7569605676093525, -0.42964306590478807, 0.008610218190625935,
      0.4936583277964391, 0.9459842300454855, 1.2881806808518665,
      1.4623155081782087, 1.4428644080887867, 1.2420048582155614,
      0.9059899528784624, 0.5035715068808786, 0.10943960633984656,
      -0.21312168225097855, -0.42601037517463336, -0.5231261742557699,
      -0.528673488373228, -0.4876055830473998, -0.4509007275133253,
      -0.4596840267827823, -0.5324800374172081, -0.659032916701789,
      -0.8023846519107258, -0.9087124891272466, -0.9223636467137504,
      -0.8021258739614556, -0.5344019196010048, -0.13971369338687462,
      0.3293451780486356, 0.7983970955748012, 1.1873705102777534,
      1.4284428924463783, 1.4813828413582255, 1.3424720029409574,
      1.0447994052171024, 0.6498967450698546, 0.23286423206663714,
      -0.1352371475110895, -0.40329624450403306,
    ]);
    const expected = [
      [
        2.626820224417921, -0.33875104243176535, -2.5322392818471777,
        -0.7738370465836732, -0.028446943526700956, 0.8898485498806361,
        2.614383939568314, 0.42977903875673923, 2.2077394298031923,
        1.5714256909150628, -0.05127099226016904, -0.35492883167576145,
        -2.3109706654372264, -1.249500298120729, 2.1547821830782263,
        2.695198577404868, 0.6970722991458725, -2.4666400863270095,
        -1.2935845517423639, -0.026345338426630064, 0.37396346244203343,
        2.5902207053580555, 0.8630127700388006, 1.54984524695382,
        2.183245155176529, 0.08231823758632627, -0.136625661101014,
        -1.8269028574132502, -2.041714909486427, 1.6030916572702074,
        2.28136404246276, 0.15732687698004832, -0.20902163435093882,
        -1.5957793318845122, -2.1815642611425914, 1.320923149976657,
        2.4795024917049417, 0.23198386413918462, -0.29556025046667017,
        -1.382695245981383, -2.2647407463254368, 1.0081072978999068,
        2.6451655667232634, 0.35462971366415247, -0.402396321991858,
        -1.1939073350839937, -2.2921225948120907, 0.6758040560873163,
        2.76882041190547, 0.5232076786130019, -0.518660258394078,
        -1.038207705153615, -2.266514081533277, 0.33598558719650023,
        2.8428106291664084, 0.733051720062988, -0.6328896835831713,
        -0.9223459270023503, -2.193260658091186, 0.0009235575024087115,
        2.861753771506177, 0.9771161253325977, -0.7336450182085444,
        -0.850681702025669, -2.0799569116425656, -0.3174325168518523,
        2.82282703622326, 1.246329868267991, -0.8101241474633564,
        -0.8249631655042828, -1.9360380467022917, -0.6080598812515661,
        2.7259205439993432, 1.530057359819851, -0.8527440520152423,
        -0.8442424060050336, -1.772276639607114, -0.8614136209771953,
        2.5736174026789698, 1.8167974811381542, -0.8542350362647945,
        -0.9032561594927399, -1.6040683473068427, -1.0628518652036052,
        2.360987089431051, 2.1024742681209587, -0.7129636672612784,
        1.2586097049450042, 2.880535826743838, -0.29504879176331783,
        -1.8836174278698128, -1.4973772655676594, 1.5377080051871928,
        2.730541346280746, -0.31623020471795116, 0.4035608037063751,
        2.9829452969753523, 0.6544199122468322, -1.8442519759385223,
      ],
      [
        0.04583686383855117, 0.013020034209701624, 0.047087826567539987,
        -0.028475009901191638, -0.015066868949877434, 0.053724452815729795,
        -0.07503871484287462, 0.18294759938371247, -0.2109981107884411,
        0.09441813417582419, -0.02359107931819956, -0.005514829656750503,
        -0.026475369973901566, 0.1221072744851686, -0.3693128090321685,
        0.5675941930904141, -0.18813874090463756, 0.1271051443532656,
        -0.05433270309984268, 0.0016458576237651842, 0.012849179548281858,
        0.004230662333378064, -0.023562720752273142, 0.01999642773929915,
        0.0042146258554960885, -0.023745290673184025, 0.017911358510045453,
        0.007048519163068144, -0.024490419818484762, 0.015797212543866793,
        0.009737849028250244, -0.024885468625492693, 0.013495546214227468,
        0.012301252672103677, -0.024974538772166495, 0.010996453403665524,
        0.014701916479195493, -0.024717988807218656, 0.008374802495515027,
        0.0169128810192766, -0.024156856990679636, 0.005622133147623146,
        0.018899465351397624, -0.023261603511372655, 0.0028177001067528026,
        0.020642792394376174, -0.02207997597138373, -4.556448189078216e-5,
        0.022111639348706438, -0.020592251916071846, -0.0028860344403715465,
        0.023296543364612475, -0.01885216370226505, -0.005711158396875011,
        0.0241709550053264, -0.01684911216156473, -0.008439030834188958,
        0.02473579614602741, -0.014641691490004194, -0.011079276281784156,
        0.024970033563578155, -0.012227345234263373, -0.01355177843928781,
        0.02488553081759525, -0.009668061140024439, -0.01587005387215816,
        0.024467199236002563, -0.006967920199721272, -0.017957719777636747,
        0.02373795737527976, -0.0041905708553363, -0.01983560899091511,
        0.022705010192418645, -0.0013566413228836569, -0.021911396365837763,
        0.024629645951767806, -0.011701613562967225, 0.006796394612022328,
        -0.06737792100138418, 0.0011358316295468438, 0.018126552814848783,
        -0.04636074336284629, 0.13506510358617663, -0.13317529817775636,
        0.06593106486975212, -0.03946526237958781, -0.03221779477561076,
        0.09736658666284465, -0.006916225720207767, -0.006627846563417582,
        0.01851820236422118, -0.0045970183211005355, -0.018479680026317127,
        0.024759693819586225, -0.005928116852817738, -0.018776314922741802,
        0.023297976343562916, -0.002924089483300545, -0.02056912847998538,
      ],
      [
        -7.73156499840066e-6, 9.048408947562764e-5, -0.0005774716792811708,
        0.0022367354879464993, -0.005700486886544898, 0.009948324981787927,
        -0.013626371412773966, 0.07913500089145267, -0.10205103116876164,
        0.04404954573545189, -0.018652287851964797, 0.006823858599880328,
        -0.0021657394819112547, 0.0006520589807280948, -0.00019959698728015695,
        5.641477194897554e-5, -1.5702117887110345e-5, 3.7995431420119387e-6,
        1.2862162316297334e-6, 1.1614580929106915e-6, -6.705655550200577e-7,
        -1.7808165405038904e-6, -1.1755136559345326e-6, 5.67024993136555e-7,
        1.7610806374916363e-6, 1.251845555428796e-6, -4.681396085805839e-7,
        -1.735345572664166e-6, -1.3241548428965611e-6, 3.677675350504707e-7,
        1.7040724171520237e-6, 1.3923292936707733e-6, -2.6598871809252546e-7,
        -1.6670680007859278e-6, -1.4558810813640738e-6, 1.633005329186088e-7,
        1.6244741079034185e-6, 1.5144738905662826e-6, -6.028266157058568e-8,
        -1.5767249954922407e-6, -1.5681844872924744e-6, -4.289924378058818e-8,
        1.5239476631047955e-6, 1.616957783406491e-6, 1.4614635067624616e-7,
        -1.4660207338615487e-6, -1.6603622468446033e-6, -2.4894256183012413e-7,
        1.4031714553677483e-6, 1.6981430750805617e-6, 3.5071793133549166e-7,
        -1.3358984079710062e-6, -1.730451861637096e-6, -4.513245051907943e-7,
        1.2643755394319144e-6, 1.7572877541539325e-6, 5.506613900690588e-7,
        -1.1885452263506791e-6, -1.7782847132131083e-6, -6.482119605176156e-7,
        1.1087101508063386e-6, 1.7932772144344042e-6, 7.434342919598494e-7,
        -1.0254215769366574e-6, -1.8024972403000157e-6, -8.362148913051099e-7,
        9.388890582861899e-7, 1.8060033346207131e-6, 9.264672264351695e-7,
        -8.49107469739645e-7, -1.8035004396332823e-6, -1.0136916976298357e-6,
        7.564418336231563e-7, 1.7949162122960104e-6, 1.0973917831902148e-6,
        -6.614815173286536e-7, -1.7805646480665355e-6, -1.1775040448348143e-6,
        5.644576795389814e-7, 1.7605649940295246e-6, 1.2539714274048654e-6,
        -4.654038861741187e-7, -1.734694667190769e-6, -1.3263274282294558e-6,
        3.6473193346475415e-7, 1.7029743617477923e-6, 1.3941364786148488e-6,
        -2.630525644456196e-7, -1.6657976936098802e-6, -1.4573987863981032e-6,
        1.6060260709936197e-7, 1.623341903994098e-6, 1.5160997878261129e-6,
        -5.743867831661536e-8, -1.5754544560156195e-6, -1.5698198063634852e-6,
        -4.59978188507296e-8, 1.5222448239730288e-6, 1.6181972404890552e-6,
        1.4909286393457606e-7, -1.464179923612439e-6, -1.661306772147149e-6,
        -2.5162097504496873e-7, 1.401488467073948e-6, 1.6991864895677543e-6,
        3.535190698392312e-7, -1.334081650903266e-6, -1.7314743027532266e-6,
        -4.543340647642727e-7, 1.2621497383073334e-6, 1.7578923298669293e-6,
        5.534672031171518e-7, -1.1862228969707273e-6, -1.7785972483723449e-6,
        -6.507215887908351e-7, 1.1065712917999047e-6, 1.7936865430233928e-6,
        7.460442589652568e-7, -1.0231600977279374e-6, -1.8028629799613366e-6,
        -8.389882242134652e-7, 9.362489915420506e-7, 1.8059384338845598e-6,
        9.289880654707356e-7, -8.464181362477781e-7, -1.8031552990378398e-6,
        -1.0158919565801986e-6, 3.1932215557299927e-7, 4.597639211572411e-6,
        9.15576139527973e-6, -0.00016710580096158703, 0.0009590222641418354,
        -0.003460539491808247, 0.00952309159357317, -0.024873022870178334,
        0.019000504230731942, -0.0022836976868991048, 0.002514771372441789,
        -0.001980081982654754, 0.0010917813992908899, -0.00045848780448880315,
        0.00015884386541293823, -4.577243166938128e-5, 1.2285348205857709e-5,
        -4.796360269250285e-6, -6.988602640685903e-7, 2.714205732636695e-7,
        1.719926180254364e-6, 1.386299370248482e-6, -2.7315740689266616e-7,
        -1.6698851784272522e-6,
      ],
    ];
    const result = wavedec(data, "coif8");

    const reconstruction = waverec(result, "coif8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif9", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49636956333693083, 0.9165624392389196, 1.2000751517430894,
      1.3141000427225427, 1.2591309355974598, 1.0669374689974602,
      0.7915333863900437, 0.4954414682990867, 0.23466340378774503,
      0.0460281991653656, -0.06004398745958983, -0.09970436339159333,
      -0.10888455872480428, -0.13141057521955318, -0.20514851307424659,
      -0.3497948361983921, -0.5595075260477208, -0.8023589945789242,
      -1.0268776938487258, -1.1741569383114396, -1.1925894215750596,
      -1.0515869186946354, -0.7508421899338412, -0.32273903384137836,
      0.1728380493390499, 0.6602031060552385, 1.0634015024414532,
      1.3219614760399296, 1.4031857214174832, 1.3081320466172062,
      1.0699496484431263, 0.7450738643112172, 0.39948863669284346,
      0.09342601780424126, -0.13179594951811457, -0.26166987735504665,
      -0.3093391311361104, -0.3093567769846045, -0.3060991499541104,
      -0.33988986740505206, -0.434444806032022, -0.5889020279609243,
      -0.7765395574085897, -0.9505960817380679, -1.0558130793183662,
      -1.0428567518781926, -0.8820171222347633, -0.5727104455905758,
      -0.14630126690420336, 0.3386287034100787, 0.8076002782480711,
      1.1855669614405469, 1.4126843952995092, 1.4568198441458842,
      1.3198723216196973, 1.0364544980980146, 0.66531736790328,
      0.2756310048647902, -0.06855298754624345, -0.32193416022499055,
      -0.46647948430040825, -0.512903736056722, -0.4949470497473182,
      -0.45806310694694197, -0.4455012584949462, -0.4853885159755784,
      -0.5821408832730696, -0.7144279623917646, -0.8402547945842475,
      -0.9079219867612065, -0.8701262620757261, -0.6976408773014929,
      -0.38907457343407886, 0.025862753620079226, 0.4905859479970213,
      0.9325182592099669, 1.278158263741943, 1.4688099355614197,
      1.4732635780180894, 1.2944257708298457, 0.9683374453945918,
      0.5558394192264977, 0.1288999640306402, -0.24511891978858247,
      -0.5175179313224438, -0.6673498771903762, -0.7034991635393475,
      -0.6594449148352678, -0.5821993982856026, -0.5183310892722688,
      -0.500671202803042, -0.5390960912683936, -0.6177288987623556,
      -0.6992733849922917, -0.7353853627468985, -0.6804508500404236,
      -0.5052561257502268, -0.2070238721814547, 0.18684329531797306,
      0.6224368689413793, 1.029734954410952, 1.3373483787776612,
      1.4881586779011735, 1.4521298047750228, 1.2332249316407928,
      0.8687585038855052, 0.4213211076262904, -0.03481026297463463,
      -0.4295544398228827, -0.7114536778664704, -0.857285458254732,
      -0.8746975267528556, -0.79742334092072, -0.6744484645572952,
      -0.5559617887388799, -0.4796804852679223, -0.4610009910776308,
      -0.4894366624872406, -0.5322033118579408, -0.5440035883527656,
      -0.4804888191356529, -0.3119324032077695, -0.033567132597386584,
      0.33015801537133177, 0.7286544041720615, 1.095042837978502,
      1.3605258030470386, 1.4698864552217865, 1.3943971259844394,
      1.1390072456670204, 0.7420345953071676, 0.2673752024036291,
      -0.20896112235369046, -0.614828101602658, -0.8966847290808151,
      -1.0296759360866232, -1.0207787987090111, -0.9044384175533026,
      -0.7319435529496314, -0.557298790340458, -0.42316906333445903,
      -0.35040516768563157, -0.33372528120162903, -0.34456062080641114,
      -0.3402621297048191, -0.277258266797709, -0.12474960116027284,
      0.12462679623466338, 0.4499922828531319, 0.8046625248643627,
      1.1254053088513243, 1.3463916647192682, 1.4145157303254736,
      1.3023734222024268, 1.0157132285225732, 0.5934791197663467,
      0.1003378215487017, -0.3866120678940866, -0.793854533307246,
      -1.0664519944121298, -1.1785400833918378, -1.1369413938375885,
      -0.9771927043925912, -0.7531159289450913, -0.5226105810466254,
      -0.3332269296804391, -0.21108068017750486, -0.15579501902500786,
      -0.1426229724563276, -0.13109263860312523, -0.07787820292351749,
      0.049463620288988264, 0.26147584556798903, 0.54141480170171,
      0.8470062608745301, 1.1190697804279426, 1.2950083378528596,
      1.323916495269538, 1.1796103133481317, 0.8683401969278275,
      0.42920470483349216, -0.07296664220267012, -0.5606777795055615,
      -0.9597566431484034, -1.2145436639939593, -1.2987462707959367,
      -1.21947881699775, -1.013656203394225, -0.7377520939435395,
      -0.45351834146076425, -0.21320412050792126, -0.04788307744987785,
      0.03831906653647321, 0.06680148077338657, 0.07638242354683933,
      0.11069403421561258, 0.20438210069074803, 0.37170984678093333,
      0.6005605638406698, 0.8534802849801654, 1.0756333226733665,
      1.2077977685873447, 1.201237397689759, 1.0307716822167072,
      0.7027569603442674, 0.2558964252438888, -0.24547864829543253,
      -0.724190753842751, -1.1061201580760165, -1.3355247146017009,
      -1.3862016263802817, -1.2659158519965783, -1.013140483983584,
      -0.687000895063028, -0.3529355604666792, -0.06758686084172177,
      0.13342766226325425, 0.2419694407927226, 0.2766248280987232,
      0.27511220076953113, 0.28191936000517787, 0.33441780472895816,
      0.4510656112896475, 0.6247743694384995, 0.8232113021572177,
      0.9960584293232622, 1.0874895743049846, 1.0507896393718894,
      0.8614611208654468, 0.5254863270777964, 0.08056387631775222,
      -0.41016533131133576, -0.8705595605244265, -1.2272310869861056,
      -1.4249377385363453, -1.438002830193105, -1.275099257109754,
      -0.9763232227472542, -0.6033302654087883, -0.22495985693081677,
      0.09816831789026625, 0.3263996504191689, 0.4481410652549716,
      0.47974047802186615, 0.4583771986478564, 0.42991804081097784,
      0.4349261701817931, 0.49644475991214376, 0.6127096087952286,
      0.7566911975284832, 0.8826383262193593, 0.9380208331498465,
      0.8778879378741967, 0.678014677798765, 0.34346346435336245,
    ]);
    const expected = [
      [
        1.487462391827531, 2.6446975798728887, -0.6452068536898159,
        -2.3443356759145666, -0.7144655155853885, -0.1705643889086972,
        0.9543121539123002, 2.6374472327153082, 0.4203512661082115,
        2.2101758938272416, 1.650876612455312, -0.1451288451577675,
        -0.4065048070735824, -2.0451556938665574, -1.5213059272803726,
        2.170065688729341, 2.0209291353443537, 0.8732893709331662,
        2.8309986399599256, 0.32918695157372146, -2.3706563768642974,
        -1.1434471558400945, -0.17283363616419634, 0.3923300936005375,
        2.6435919772704515, 0.8513244045612532, 1.5397917035396163,
        2.2607324297841775, 0.03928436928484443, -0.2457291148698849,
        -1.6080389180427748, -2.101806155988255, 1.3176801899610735,
        2.618383540877898, 0.1875843833148559, -0.6214242330534843,
        -1.176258240256164, -2.0843025036061875, 0.6745248618703287,
        2.914525855304395, 0.5532493886667467, -1.028364325002411,
        -0.9706141697735313, -1.813423979759241, 0.04952755638570798,
        2.9370475404164074, 1.11435792164932, -1.3363797233534818,
        -1.0379283085985704, -1.3958021146957085, -0.41508966376655965,
        2.672827749087769, 1.7401302976709654, -1.42323534705484,
        -1.351234021451201, -0.9765801392026243, -0.6234561405944787,
        2.187448457460555, 2.2798230912566777, -1.2285394107159975,
        -1.8116240276732638, -0.699617088387735, -0.5527729008639852,
        1.606665305909949, 2.605239390653228, -0.7709782832832929,
        -2.276263253436946, -0.666697995660083, -0.25959977516062416,
        1.080899384337555, 2.6468702467192005, -0.14319335105348277,
        -2.598833146224024, -0.9086492053724163, 0.136299185743028,
        0.7427647626563249, 2.413449784605544, 0.5142519402638113,
        -2.6709691580399055, -1.3765384876444806, 0.48604185908170977,
        0.6693949227535413, 1.990284546785297, 1.0496804424164146,
        -2.4455009858938297, -1.9729041732251924, 0.689708264759117,
        0.795193116978967, 1.6237228765669427, 1.2237036707832365,
        1.5208998762374484, 1.302242896618085, 0.9384064941024396,
        0.03989149501016229, -1.1105173429196031, 0.9500934853141914,
        0.8213688751396272, 1.7806306327106338, 1.045183707719064,
        1.71739114613771, 1.0488589319773873, 0.9359706400160819,
        -0.44105134117638706,
      ],
      [
        0.033784486870336264, 0.03462909490864567, 0.026610392431503947,
        -0.02241182109438068, 0.006985843347998129, -0.0037412003622500647,
        0.019431070527324464, -0.04046476968500951, 0.15087141299267787,
        -0.17680625952739215, 0.0673086518141725, -0.02094521334265914,
        0.008544108093215654, -0.0008818372927226842, -0.037561219731379714,
        0.12113131957629901, -0.3505465113784093, 0.5336848172914073,
        -0.15904975593259965, 0.11065280970172015, -0.05348788018547244,
        0.014424388021870483, -0.0020733179020382526, 0.008623824168840614,
        -0.014165541246501708, 0.006622893684595604, 0.007472032237182051,
        -0.012559350176588633, 0.0029937346367612996, 0.010068037376183515,
        -0.011463985836531345, -0.0004301585373763676, 0.011823300652163209,
        -0.009511214142206015, -0.003824080662129068, 0.012728832060851505,
        -0.006878242872995597, -0.006947508461678513, 0.012717502170739031,
        -0.0037459021979075304, -0.009565939298518, 0.011791423118786728,
        -0.0003480324354690454, -0.011500692635176455, 0.010015617053441513,
        0.003078902953475836, -0.012602558656547696, 0.007519905775537154,
        0.006280304153763271, -0.012802265922066978, 0.004481614031104024,
        0.009033385826059306, -0.01207528850216522, 0.0011221294755230852,
        0.011132538383883764, -0.010484199392149743, -0.0023197223036671858,
        0.01243382432606732, -0.008133214639161383, -0.0055928303434107695,
        0.012836658142435713, -0.005201961070511715, -0.008465252525541206,
        0.012318683293136038, -0.0018910030551087921, -0.010726211123370185,
        0.010910821267371076, 0.0015508258927346154, -0.012217274073882584,
        0.00872050069219191, 0.004886286676610878, -0.012826465871478027,
        0.00589996939029915, 0.007863037780897376, -0.012547745133449813,
        0.003123403236019693, 0.0072075411830937125, 0.0016109988965593127,
        -0.04346406279726525, 0.11414856475140714, -0.29988840590717586,
        0.45123956993024317, -0.14101548076114478, 0.13265464399250637,
        -0.12135209227981984, 0.2513345251915702, -0.27423053478898746,
        0.08944072688229472, 0.053754819177476605, -0.2822274090798184,
        0.013984078591178353, 0.04640180225496303, 0.01627451803956462,
        -0.025290997968152294, 0.012544299025164239, 0.005439808730633621,
        -0.010049884313921007, -0.0004411857031798718, 0.011765211373720885,
        -0.009899395530806546, -0.003308772942680719, 0.012648138485244924,
        -0.007315487352565258,
      ],
      [
        1.2495781582464894e-6, -2.4598936338165874e-5, 0.0001816136903088516,
        -0.0008238725317310218, 0.0025341487619649763, -0.005493769496592676,
        0.00846456511107542, -0.010842187419867921, 0.07550220477581703,
        -0.09978407483989132, 0.044555591886567374, -0.020336606587757784,
        0.008307590122534696, -0.0029928784453928537, 0.0009975294644903783,
        -0.0003274043797401963, 0.00010550725278961246, -3.1653171795444756e-5,
        8.158500506507965e-6, -1.5145531243530263e-6, 5.45760090499308e-7,
        -6.229977113776964e-8, -2.3326848227153695e-7, -2.4307025475609384e-7,
        -2.2382382449972245e-8, 2.184722362958132e-7, 2.576249182721506e-7,
        5.8898861781892417e-8, -1.942103343904699e-7, -2.679935688657435e-7,
        -9.432225178994339e-8, 1.664451702231172e-7, 2.7352939534301993e-7,
        1.2805295070148237e-7, -1.3566130064113447e-7, -2.741159748177054e-7,
        -1.5947084680803696e-7, 1.0241681979470664e-7, 2.6973513856285686e-7,
        1.8799323150650617e-7, -6.733076807659293e-8, -2.604826749488753e-7,
        -2.1311527761915717e-7, 3.103525210390091e-8, 2.4653287225567474e-7,
        2.3439719158869463e-7, 5.831524593394235e-9, -2.2812108354554347e-7,
        -2.5144295164676825e-7, -4.260029980045206e-8, 2.055737171544194e-7,
        2.63930402322845e-7, 7.85884895064099e-8, -1.7931542076999197e-7,
        -2.716455437530244e-7, -1.1314886657104998e-7, 1.498267924257013e-7,
        2.74462504132787e-7, 1.4567438464467207e-7, -1.1762369201632834e-7,
        -2.7231815703742666e-7, -1.755730923373631e-7, 8.328299124473803e-8,
        2.652380656377868e-7, 2.0228684022690736e-7, -4.744290836587802e-8,
        -2.533628741834016e-7, -2.253372451919428e-7, 1.0756116687099243e-8,
        2.3692003288591149e-7, 2.4432506156433506e-7, 2.613173016409605e-8,
        -2.1619374283683343e-7, -2.589019004459048e-7, -6.255790480943249e-8,
        1.915463626797179e-7, 2.6878693077414713e-7, 9.784619425525636e-8,
        -1.6343691127700932e-7, -2.738071591865487e-7, -1.3135507785910784e-7,
        1.3238550081028158e-7, 2.738889321679206e-7, 1.6249658594065294e-7,
        -9.8939592107357e-8, -2.6902450548589907e-7, -1.907107378535178e-7,
        6.369240094936586e-8, 2.5928491797826993e-7, 2.1546951045830748e-7,
        -2.7295370873193496e-8, -2.448530772705481e-7, -2.363229620271976e-7,
        -9.582533429474673e-9, 2.2600655971333362e-7, 2.5291208489896766e-7,
        4.628922278887483e-8, -2.030786775362564e-7, -2.649387601653514e-7,
        -8.21716026268029e-8, 1.7646750799219984e-7, 2.721675082643591e-7,
        1.1656601963973846e-7, -1.466620810257317e-7, -2.744664643846015e-7,
        -1.4884069423879868e-7, 1.1421737075708782e-7, 2.7181216894217727e-7,
        1.7842745352541532e-7, -7.971145971778053e-8, -2.6425318377058537e-7,
        -2.0480089988554334e-7, 4.375225904317668e-8, 2.519080379942341e-7,
        2.2746862384233442e-7, -6.998875137665727e-9, -2.3499994267815507e-7,
        -2.4601189171726564e-7, -2.9868708967185134e-8, 2.1385267910022478e-7,
        2.6011137836247704e-7, 6.619348331905416e-8, -1.8884793667436158e-7,
        -2.695206175040126e-7, -1.0133404432970337e-7, 1.6041963820369158e-7,
        2.740533127330359e-7, 1.3464506229442684e-7, 1.2040294092848969e-6,
        -2.1596473662726142e-5, 0.00015778818235797227, -0.0007150437418963106,
        0.002192846521038413, -0.004738780530165951, 0.007272496547777296,
        -0.009272441072442272, 0.06547167073015803, -0.08661802664381499,
        0.038656532985816304, -0.017659822802814522, 0.007225760599837686,
        -0.002607581931707749, 0.0008699160092908005, -0.00028592920704255474,
        9.213711580165527e-5, -2.7419030544725504e-5, 7.341125577069775e-6,
        -1.3251197297841485e-6, 2.6684207736066905e-7, -2.8121097023646485e-7,
        -2.37245775551418e-7, -2.1742792417654157e-8, 2.1914537967916194e-7,
        2.5724709217445495e-7,
      ],
    ];
    const result = wavedec(data, "coif9");

    const reconstruction = waverec(result, "coif9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif9_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5035898576232589, 0.9255855643239491, 1.2023393619742375,
      1.3016391525879523, 1.22843099721612, 1.0214618981484602,
      0.7418570072946741, 0.4566987111893094, 0.22192241478154467,
      0.06896372169976106, -0.0014432668567392892, -0.01683291610418964,
      -0.022750740631126365, -0.06755317368429559, -0.18645139698465768,
      -0.38918489103076465, -0.6547502089282252, -0.9347427991694908,
      -1.1645834623543256, -1.279795168667155, -1.2331230298287439,
      -1.0080120213370205, -0.6248500517170662, -0.1382190880521963,
      0.3743008743775661, 0.8290586802402624, 1.1547966593071988,
      1.3080619802482047, 1.2817579711763396, 1.104791570358166,
      0.8330565324513202, 0.5342030835197255, 0.2702099855946805,
      0.08228990784309703, -0.018006791916410192, -0.04929381287638858,
      -0.052493595079536215, -0.07687479097934113, -0.1638445527255631,
      -0.33294781305011206, -0.5739396351341538, -0.8471879164701133,
      -1.0924535080868432, -1.2438621194872614, -1.247212730030395,
      -1.0750997502515616, -0.7358388495295307, -0.27374933496537235,
      0.23944484777691719, 0.7200511704442322, 1.0908749453880955,
      1.298125187905195, 1.3225670081765872, 1.1822046944508329,
      0.9259521134446775, 0.6200507530699821, 0.33083298350359214,
      0.10832337810979781, -0.02510539470298434, -0.07817758350924206,
      -0.08552195996002679, -0.09539174683932705, -0.15371734751494354,
      -0.2888764232715888, -0.5013712988602435, -0.7613017228665914,
      -1.0144527092805111, -1.1955243306875796, -1.245114000131433,
      -1.1260253606488435, -0.8345955755114172, -0.4039777719536347,
      0.10163342182963672, 0.6005197118018863, 1.0113908961350833,
      1.271313831852184, 1.349161884454762, 1.2512757796315537,
      1.0180241448978646, 0.7122804664809902, 0.4028884316353196,
      0.14743720625937595, -0.021209936157302045, -0.1012239548483776,
      -0.11946172871029273, -0.12126291056072533, -0.15526739942241585,
      -0.2574381998812301, -0.43867724829441557, -0.6794654908625868,
      -0.9330937966203057, -1.1367667029909732, -1.2277553135012123,
      -1.160401586610092, -0.9194959788255872, -0.5264409351840084,
      -0.03644550591150316, 0.47270333151820776, 0.9175765852658743,
      1.227553989052749, 1.3601991759350749, 1.3097532632272832,
      1.1067041718460124, 0.8086735349318213, 0.48507582296196394,
      0.19957167814793514, -0.005145560168736241, -0.11635547311402453,
      -0.15190227791351496, -0.1524010101375362, -0.16730131147348326,
      -0.23866759715216285, -0.3871285904997355, -0.6038671195071158,
      -0.8509155794318485, -1.0698143226539527, -1.1964581575769158,
      -1.1782856838253437, -0.9892968204657647, -0.638894085272833,
      -0.17210365937787847, 0.33906058921893023, 0.8110460358035823,
      1.1672173404256192, 1.3547296305763534, 1.3556268515980108,
      1.1894506250347803, 0.9068182202209514, 0.5757333928497316,
      0.26423303611838567, 0.023869910083116175, -0.12174295655671302,
      -0.18047182967903994, -0.186538172683126, -0.18827322466307111,
      -0.2321674935600358, -0.3475994080247449, -0.5364368983176718,
      -0.7704072972275662, -0.9970651372872937, -1.1528956189938204,
      -1.180174769354004, -1.0431692417496794, -0.7393739711658174,
      -0.3027282494581723, 0.20220031962300797, 0.6937505612375743,
      1.0911126942609084, 1.3322280343500998, 1.387187905476908,
      1.2638239615492597, 1.0041800381580217, 0.6728852738203905,
      0.34050522901576413, 0.06619931023252956, -0.11586354702616686,
      -0.20291167730231785, -0.22129688865808989, -0.21633393939568177,
      -0.23712359434253777, -0.3205426342958041, -0.4787911117440357,
      -0.6939346447129964, -0.9210176975779824, -1.099040710091425,
      -1.1669882504100924, -1.0807199340994322, -0.8262532872791349,
      -0.4258555903397131, 0.06480797994498125, 0.5679242121107743,
      1.0004646941815674, 1.2926106802977575, 1.4030810765814707,
      1.3275589827211458, 1.098175897402974, 0.7742981397526144,
      0.4270743272773857, 0.12177200761038709, -0.0975496281601127,
      -0.2171470619549285, -0.25426428488529645, -0.24938913938111273,
      -0.2523313540965251, -0.3059785983896586, -0.43218515454329276,
      -0.623669664794904, -0.844196111261215, -1.0371059751021028,
      -1.1400378711207955, -1.1019994915910634, -0.8982852190459129,
      -0.5392402938802059, -0.07043022363735268, 0.43602093698313366,
      0.8968803357663202, 1.2362399173218839, 1.402345661285022,
      1.3786321844264597, 1.1862498775914236, 0.8775456648115314,
      0.5222648865085769, 0.19008273718158952, -0.06602714893325218,
      -0.22135258747560388, -0.2830674930361047, -0.2851649817403699,
      -0.2762346132506277, -0.30349657351262604, -0.3974775457934275,
      -0.5615265888452667, -0.7690744378379799, -0.9694761724961779,
      -1.100986273071924, -1.107497707644158, -0.9546367658523582,
      -0.6409180003293143, -0.20090319038215615, 0.30064531220205026,
      0.7823042771619224, 1.163915638108402, 1.3844454415981047,
      1.4153221416686368, 1.2659484014199198, 0.9800788901142767,
      0.6240871881498529, 0.2702034440284486, -0.02094220571024208,
      -0.2140102223526386, -0.30544786765089343, -0.32127909832573887,
      -0.3069747944278117, -0.3122692773398321, -0.3751059054772509,
      -0.5091055265159959, -0.6980027685748866, -0.8986360348263326,
      -1.0517953057284952, -1.0981259641638021, -0.9949098630444181,
      -0.729259795405143, -0.3241485208635404, 0.1644788854129421,
      0.6589642610194937, 1.0768539525053686, 1.3492861246537373,
      1.4362611353915917, 1.3349925727899503, 1.0793004154072134,
      0.7302939627944811, 0.3608077897712565, 0.03762491560504172,
      -0.1939581579029515, -0.3193318417818629,
    ]);
    const expected = [
      [
        1.0658048679968126, 2.615298289768004, -0.27473505170023715,
        -2.5556469113422735, -0.7944285856601816, -0.003512156584493973,
        0.8764772178129128, 2.610606808450184, 0.4326491658203889,
        2.206695599074952, 1.55624504071624, -0.031665040135084435,
        -0.365251343618021, -2.3263311187202103, -1.2571792069447385,
        2.3241184676794973, 1.6196638443150313, 0.5680616896297247,
        2.5774442674188918, 0.73909325372198, -2.4533430114835046,
        -1.3350759670037577, 0.0012347419556444207, 0.36495742808185844,
        2.5845553127201697, 0.8645757650594654, 1.5491551761500446,
        2.174686418534233, 0.08288240325048692, -0.11782172268486857,
        -1.871643163521181, -2.015837548809589, 1.6552450722517449,
        2.213316154578423, 0.16369437324548064, -0.1566168557921861,
        -1.6907680040873703, -2.150758940121643, 1.4370254959113213,
        2.367890834010942, 0.21641681423688872, -0.19404616218683646,
        -1.5192741345527792, -2.251950217627206, 1.1976142859689727,
        2.505703865897818, 0.29530535973381083, -0.24608708959898015,
        -1.355978936043594, -2.3200457125515443, 0.9417348186893212,
        2.6222361939079444, 0.40022241542516834, -0.3085562529357102,
        -1.2052470173086165, -2.355179421596783, 0.6743115307130307,
        2.7134797662032906, 0.5301612423202048, -0.3769121828686121,
        -1.0709251700500706, -2.3583643979296447, 0.40056617872803535,
        2.776032241182361, 0.6832714635903364, -0.4463974397765225,
        -0.9562299877354989, -2.33145705030371, 0.1258704130509631,
        2.807199817663569, 0.8569084367850887, -0.5121872315708276,
        -0.8636545701913856, -2.27709671471295, -0.14440599126989154,
        2.805079440407033, 1.0477064907847573, -0.5695402393079697,
        -0.7948962671203245, -2.198626624906396, -0.4050281764828982,
        2.7685520630148748, 1.251865866837366, -0.6143975456091395,
        -0.74998914352905, -2.1010960146707585, -0.6498915608001988,
        2.6954945853079324, 1.4720456135808961, -0.6518483150066334,
        0.7344810519956771, 2.8791355069799245, 0.29095930357712424,
        -2.0851972354535757, -1.8692909464823593, -1.4769452712022566,
        2.166457902509075, 2.1537130750819165, -0.398328210158573,
        0.08875870244123112, 2.6561452887988017, 1.3259029103959938,
        -1.9914207509149098,
      ],
      [
        0.038898820664638636, 0.0289802373889796, 0.035206334622362084,
        -0.02874877145438555, 0.004976504544934173, 0.010361863076668625,
        -0.005351525740025602, -0.008032322462875368, 0.058461746055164604,
        -0.06566669920647898, 0.014447423448891307, -0.0012217342344219009,
        0.00740581620618398, -0.005601389871034161, -0.036210663410556496,
        0.12724381299891696, -0.3666929779879122, 0.5560606910588303,
        -0.17354108836739252, 0.1219069965989597, -0.05866023973614423,
        0.01193628167338759, 0.00503436235671641, 0.00407097596700281,
        -0.017693707007959917, 0.01600689478448207, 0.0013832711349950585,
        -0.016979053728421213, 0.014650551883191433, 0.0030896171493638223,
        -0.017590067260471607, 0.013616250259093514, 0.00465459388270424,
        -0.018037345852003082, 0.012479869220169507, 0.0061862155091273185,
        -0.01835545897894193, 0.01124582115647543, 0.007671521930561338,
        -0.018532601219739594, 0.009933263064317749, 0.009100339112070203,
        -0.01857659028293126, 0.008541815422355959, 0.010460902548647486,
        -0.018478136123520242, 0.007092063742461114, 0.0117445446713252,
        -0.018246756873915644, 0.005584418744922749, 0.012940000154563164,
        -0.01787556730017851, 0.004040543959168909, 0.014040405154016817,
        -0.0173757406102128, 0.0024613488736183, 0.015035281041860466,
        -0.016742768632218165, 0.0008692145723011317, 0.015919825667940115,
        -0.015989375132404286, -0.0007347623621102048, 0.016684595795869138,
        -0.015113341066505758, -0.002327860022163282, 0.017327063198257154,
        -0.014128779623059286, -0.003909116575676456, 0.017839022692617782,
        -0.013035615990362884, -0.005455851798844999, 0.01822037941282699,
        -0.011848987483252815, -0.006967527853987528, 0.0184417898864891,
        -0.010345975106731527, -0.009569590859496433, 0.02215427992683588,
        -0.016522818107770832, -0.0027929393023124194, 0.015525720610988721,
        -0.025779808997647622, 0.03646522745010881, -0.05889667110654635,
        0.07954322528077372, -0.17372479339660704, 0.18732202188339966,
        -0.07181916023246702, 0.001814464100029458, 0.0389926231236459,
        -0.051244525346021426, 0.05279449095197415, -0.04194404779811588,
        0.024230284414726605, 0.0005974467565224672, -0.016905736951052814,
        0.012858083198629341, 0.005430205539864367, -0.01821852519165096,
        0.011928216087287651, 0.0068744841732180555, -0.0184524422937788,
        0.01065394715529139,
      ],
      [
        1.1136864091830478e-6, -2.512654843791174e-5, 0.00018458431345634178,
        -0.0008390741789058674, 0.002587494754425975, -0.0056239138328882075,
        0.008695321106537824, -0.011181157104511598, 0.07698259059943535,
        -0.1016492941428576, 0.045403306031861886, -0.020706569463129782,
        0.008447693360357047, -0.0030390569554240455, 0.0010120906957434312,
        -0.0003321835508396835, 0.00010679965987717973, -3.211750694073142e-5,
        8.421406442626498e-6, -1.3411854417159247e-6, 5.795833974984996e-7,
        -2.3909278769469704e-7, -4.430912613501107e-7, -2.695125606939783e-7,
        1.7298883385325397e-7, 4.462850352913589e-7, 2.8438062542250305e-7,
        -1.548580954606208e-7, -4.430758200434986e-7, -2.9919616588214e-7,
        1.364685479110239e-7, 4.390516441893898e-7, 3.1346844137647795e-7,
        -1.178124396211213e-7, -4.342017867614945e-7, -3.271540932140817e-7,
        9.893477968933705e-8, 4.2853637694670107e-7, 3.402192959286669e-7,
        -7.988634383535361e-8, -4.2208480933919154e-7, -3.526568286403631e-7,
        6.069177419174297e-8, 4.148574562303988e-7, 3.644515341045778e-7,
        -4.137131363330424e-8, -4.0684892100820777e-7, -3.755642277802348e-7,
        2.197202401832935e-8, 3.980761992421916e-7, 3.85966765843164e-7,
        -2.5450781133453634e-9, -3.885743554139247e-7, -3.9565727895220946e-7,
        -1.6884986858091483e-8, 3.783584426599644e-7, 4.046248049904084e-7,
        3.629688548655601e-8, -3.6742874647357565e-7, -4.128350302150015e-7,
        -5.564261101764886e-8, 3.558086641332313e-7, 4.202661229277364e-7,
        7.48717011681919e-8, -3.435384073174609e-7, -4.269220973383903e-7,
        -9.396075018991863e-8, 3.3063719868007095e-7, 4.3279669265050815e-7,
        1.1288847876894596e-7, -3.171104774493622e-7, -4.3786101605995486e-7,
        -1.316070224546079e-7, 3.029874538544292e-7, 4.421000160860248e-7,
        1.500677407554429e-7, -2.8831277381596274e-7, -4.455239490337064e-7,
        -1.6824939742942807e-7, 2.73109172295887e-7, 4.4813161109757703e-7,
        1.8613171522641616e-7, -2.573865854766328e-7, -4.498998925287557e-7,
        -2.0366806128724457e-7, 2.411792666939928e-7, 4.5082083270552213e-7,
        2.2081267366316326e-7, -2.245354962633595e-7, -4.5091109470055655e-7,
        -2.3754747174855522e-7, 2.0748068698185174e-7, 4.50174721201297e-7,
        2.5385415337449507e-7, -1.9002851327108537e-7, -4.485945813158603e-7,
        -2.696883269958607e-7, 1.722173805473327e-7, 4.4616989113182274e-7,
        2.850081438561192e-7, -1.5409824973237964e-7, -4.42923758018362e-7,
        -2.997995468583994e-7, 1.3569834191094277e-7, 4.388654293066677e-7,
        3.1404711478968855e-7, -1.1703414376329305e-7, -4.339837850902335e-7,
        -3.2770963461778947e-7, 9.814725393580067e-8, 4.2828514096011516e-7,
        3.407500518945762e-7, -7.909026909991194e-8, -4.21798844166218e-7,
        -3.531591853263919e-7, 5.989124567718859e-8, 4.145391972825367e-7,
        3.649252366795083e-7, -4.056852941118128e-8, -4.065008653526069e-7,
        -3.7601101701480505e-7, 2.1165840246126457e-8, 3.9769704855429657e-7,
        3.8638505600017853e-7, -1.7363544618364755e-9, -3.8816294758819847e-7,
        -3.9604369484542856e-7, 8.089468308178268e-9, 3.214395513850028e-7,
        -1.661824033139043e-6, 1.993971597802372e-5, -9.261600692529406e-5,
        0.00027388057277528705, -0.0006003217769349698, 0.0011713559972883,
        -0.0031225446340834365, 0.0017530770862216674, 0.0009386776242606829,
        -0.00045980151653050367, 0.0001300962823536245, 6.9736379392004894e-6,
        -2.9495518547531826e-5, 1.713146770390307e-5, -5.829758439704591e-6,
        2.10532074330598e-6, -9.016502531113817e-7, -2.7353787221012945e-7,
        -1.895260056269124e-7, 2.984904327249093e-7, 4.437409006095009e-7,
        1.6657040839219498e-7, -2.747324475318236e-7, -4.4790164540538326e-7,
        -1.842944788527305e-7,
      ],
    ];
    const result = wavedec(data, "coif9");

    const reconstruction = waverec(result, "coif9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif10", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48541841303068795, 0.897548453911744, 1.1781573885827845,
      1.2956343351072015, 1.2504153285466346, 1.0730879301419007,
      0.8157465540326908, 0.5387745071887353, 0.2963000119455385,
      0.12385329365149217, 0.031174775443404412, 0.0018333877579805868,
      -0.00037480215618984625, -0.019951429931406306, -0.09609860940685871,
      -0.25047642601790054, -0.4794585205598777, -0.7529212981677464,
      -1.0199902172058573, -1.2204436289520428, -1.2990615409076849,
      -1.2194492971559086, -0.9739511754106301, -0.5871782600929778,
      -0.11219015350329525, 0.37987489679512465, 0.814356762412118,
      1.1284474650214071, 1.2838165837805904, 1.2735821137413905,
      1.1220771230905247, 0.8775865816701067, 0.5999031099273764,
      0.34577024369777026, 0.15575304786334498, 0.04568660100318317,
      0.004700261326718608, 0.0001823464144822748, -0.011664916830640137,
      -0.07240805233768871, -0.2085351186081031, -0.4224708309573268,
      -0.6897952163996957, -0.9634771773753357, -1.1841989432280666,
      -1.294330117157829, -1.2521819648562023, -1.0430618579939916,
      -0.6843839281691205, -0.22349863542657747, 0.27135846263995833,
      0.7249503178188677, 1.070546378659577, 1.263456893879164,
      1.2894694245429332, 1.1662865896798662, 0.9377400474558875,
      0.6622787005663054, 0.3985823208947658, 0.19180866037902206,
      0.06378556477774638, 0.009460039059953296, 0.00035910945870307534,
      -0.005916579077523354, -0.05263290254812791, -0.1706406686650887,
      -0.36827141538759844, -0.6270275075488694, -0.9042551931372851,
      -1.1422633888429188, -1.281748716890828, -1.2763003726938407,
      -1.1044534594851998, -0.7763132280311668, -0.33305318792812044,
      0.1607115412926109, 0.6299687565910391, 1.0047650146348444,
      1.2344872476072624, 1.2976666161012782, 1.205075724949462,
      0.9954972642882932, 0.7252921741539666, 0.4543651050033881,
      0.23195932691472682, 0.08571205854678982, 0.01656736215335347,
      0.0006825172528697049, -0.0022673532245516548, -0.03655994538180335,
      -0.1368856791225212, -0.31725957434991703, -0.5652443033091035,
      -0.8430349672873387, -1.0952615529949923, -1.2616980611395934,
      -1.2918352728820905, -1.157778936724507, -0.8622997908549421,
      -0.4400002675582463, 0.048799300664699605, 0.5301106239196529,
      0.9314957009731564, 1.1969248823377936, 1.2978327892062842,
      1.2378428485252047, 1.0501489679271407, 0.7882980541466498,
      0.5126848599378349, 0.2760721737898672, 0.11164370507585869,
      0.026439552980172254, 0.0016772780865361436, -0.00024490742505899055,
      -0.02391561301795525, -0.10729082638409726, -0.2697698032215555,
      -0.5050313107440105, -0.7805226935694985, -1.04385233109016,
      -1.234625447894163, -1.2989017459065266, -1.2027742658499845,
      -0.9417398994065881, -0.543514121149243, -0.063499569534283,
      0.4261261575539953, 0.851208650217423, 1.1508731712382145,
      1.2897018289893056, 1.2640331307710213, 1.1009951819577675,
      0.8506221445647205, 0.5730498596200331, 0.3239427524601115,
      0.14169169107864493, 0.039449765204030984, 0.003857508213443356,
      0.0006487805108831568, -0.01437092862277628, -0.08180587710439641,
      -0.22606855671977177, -0.4469270517888028, -0.7174113777273102,
      -0.9887204267647883, -1.2010385103470431, -1.297696771839294,
      -1.2392604768504205, -1.0140985695922566, -0.6428055280551663,
      -0.1753022356607324, 0.3188094520577765, 0.7644474731433407,
      1.0965214900633606, 1.2730865860921752, 1.283146021109532,
      1.1473540600758474, 0.9115696344006622, 0.6349158072379644,
      0.3752965028608432, 0.17589798641295867, 0.05592071902634199,
      0.007718601792301272, 0.0009295054624527486, -0.007547186128780414,
      -0.06031165544225631, -0.1863519440569245, -0.3914167828570724,
      -0.6543724174650687, -0.9305676210174223, -1.161498304865893,
      -1.2884958495422165, -1.2671446808710125, -1.078914810672333,
      -0.7371301040007407, -0.28573114783949605, 0.2089900969731351,
      0.6718238164654937, 1.0341440681010714, 1.2478821450867805,
      1.2947420836753072, 1.1885705943769056, 0.9704335535492656,
      0.6976920004724942, 0.4297911706620245, 0.21423348885016014,
      0.07611910531785515, 0.013729348315555057, 0.001122682541635285,
      -0.0030222893417283236, -0.04262293182604604, -0.15074438046483885,
      -0.3389271688252293, -0.5920475462678059, -0.8701039206193756,
      -1.116611817281803, -1.271648709129144, -1.28642008122166,
      -1.1358060026334291, -0.8257960672447398, -0.3939234042472211,
      0.0975243889059185, 0.5740111873035749, 0.9640978338231011,
      1.2140681361525028, 1.2984491526326547, 1.2240250797218777,
      1.0265034748183999, 0.7607481673144626, 0.4870201513118632,
      0.2565971219444456, 0.10025073386285571, 0.02232440187432977,
      0.0017550676182959413, -0.00033766567650275747, -0.028492192509606162,
      -0.11929820851122863, -0.2898217759141226, -0.5310412411619324,
      -0.8080386971950998, -1.0670239831110095, -1.2475741742049342,
      -1.2971649716079936, -1.184471340162555, -0.9081713744420532,
      -0.49903993950635805, -0.014713777160930232, 0.47173803727143926,
      0.8868192782396851, 1.1717100578047677, 1.2939677277662878,
      1.2531412270217814, 1.0790743531894764, 0.8234218883860465,
      0.5465167218535363, 0.30281590135583075, 0.1284564914628492,
      0.03389720212861519, 0.0033464602272689215, 0.0009943374944912098,
      -0.017614237963656743, -0.09199429022055794, -0.2443974374300386,
      -0.4719136883770261, -0.7450719281830395, -1.0134093231507584,
      -1.2167542408267789, -1.2995407376199832, -1.224694304240305,
      -0.9836901414158392, -0.6002744269049775, -0.1268422280327292,
      0.36578018824263675, 0.8028203711264589, 1.1209595906694436,
    ]);
    const expected = [
      [
        0.09259900752644022, 1.7530851017777551, 2.2582368590566912,
        -1.1759404391275485, -2.434552251771606, -0.5176882818092233,
        0.033265397767861485, 1.041332952039358, 2.6000916787041857,
        0.41102322666310187, 2.1700261907961154, 1.6990455334152517,
        0.035616986110389576, -0.18466353399780025, -2.038084372708731,
        -1.9539275753560135, 1.6379345766348248, 2.2276236349981042,
        0.343390948861132, -0.013540211683059305, 1.2020999797270564,
        2.5669009561542784, -0.22567365941269932, -2.5890912059980846,
        -0.9826733947053155, 0.04515780208633898, 0.5147456149141585,
        2.625367314074218, 0.8319499907153559, 1.5074429008702324,
        2.2731917823406946, 0.19205017211135425, -0.019356595977525908,
        -1.511640541146366, -2.4367425586136933, 0.7575623179184214,
        2.5485633456316807, 0.6921935527659233, -0.0015071102533280511,
        -0.8440682209417208, -2.5875033626858213, -0.4488181410591172,
        2.527248044030331, 1.3261045042623327, 0.017318856559933694,
        -0.3415170912083938, -2.282732450709007, -1.553860151689737,
        2.008745975540825, 1.9928702727411804, 0.17067205384509482,
        -0.0743796994914816, -1.6842861205918223, -2.31575888932613,
        1.0586020152867128, 2.4772127143297134, 0.5525130334222326,
        -0.0023187303195763946, -1.0089334896012827, -2.596899242527119,
        -0.12886882074185557, 2.580030510410545, 1.1474560190716934,
        0.0059774584989410896, -0.45207041215097343, -2.4003940520572806,
        -1.2870560153807618, 2.1925432949498638, 1.8249933989080003,
        0.1108227108823194, -0.12164312241719315, -1.8592813086559217,
        -2.158328061866106, 1.3422018505983884, 2.378823587048053,
        0.42853496992350865, -0.007782622851738947, -1.1827396862610735,
        -2.572212084625171, 0.1931789174269834, 2.5978019145254323,
        0.9751678317194241, 0.0016934029926444388, -0.5793224853435466,
        -2.493462454331577, -1.0001736593010309, 2.344478235025024,
        1.6456678750230784, 0.07274498963777468, -0.1965661146464736,
        -2.0040188259904497, -2.0033676792881563, 1.647022060847818,
        0.8233812500143092, -2.4977706533756154, -1.4547392715409158,
        -0.06574077231405458, 0.19828119402856778, 0.10929249778024475,
        -0.5362319232961442, -2.403874433396578, -1.214902392011065,
        2.1248301957446647, -0.20443556706067087, -2.614945855096639,
        -0.9393689170214727, 0.001759733771760567, 0.6059179140637806,
      ],
      [
        0.026570723142157276, 0.04755839182530304, 0.014303013852831887,
        -0.015909010275831883, 0.005724862123536136, -0.000713224430576088,
        0.009969754559839434, -0.027237709549519363, 0.04334400048355766,
        -0.0667290413260991, 0.06392714055229147, -0.027980121603517285,
        0.002183319379045103, 0.007625245073996517, -0.0066009624661801285,
        0.011810250414182917, -0.047708312340797046, 0.12206383591166352,
        -0.3376318874528534, 0.5079777372453437, -0.14089894825212856,
        0.10188083450467068, -0.05411246784815317, 0.02135603801882236,
        -0.007975192657026807, 0.008756919734482655, -0.01005416345090667,
        0.0039076167856812866, 0.005215632618954658, -0.007621165575805689,
        0.0008509471788534284, 0.00697425290649883, -0.00657482606219771,
        -0.0015872405464337045, 0.007873855622817963, -0.004861053233224258,
        -0.0038928748510887877, 0.008049360128136037, -0.0026988317869199156,
        -0.005839235476237307, 0.007480530290616907, -0.0002870949334727417,
        -0.007245412287567286, 0.0062208840566637235, 0.0021511631990443953,
        -0.007982512664092856, 0.00438579253933334, 0.0043905409255118955,
        -0.007981454387192772, 0.0021459624271680275, 0.006224336602890263,
        -0.00724317964566812, -0.00029278051486521445, 0.007482654728904412,
        -0.005835210050898702, -0.0027038672033282813, 0.008049797828664676,
        -0.0038882144862536676, -0.004865666211454294, 0.007872612234296158,
        -0.0015817408377707292, -0.006577236617381605, 0.006968347529886092,
        0.0008708507855413168, -0.007681503833162949, 0.005419582893746379,
        0.0032429300219115552, -0.008075400278792987, 0.0033705264356140327,
        0.005315437044789505, -0.007723433488066207, 0.0010093974028502956,
        0.006896506426338877, -0.006657314591835031, -0.0014445469131635805,
        0.007836399276687942, -0.00491813784603067, -0.004159495166858561,
        0.009837071797809682, -0.008566745365124837, 0.009803350286256734,
        -0.024280488790217422, 0.0872174718989197, -0.1403913537926266,
        0.023649796628048586, 0.003025897565364828, -0.04697842958564569,
        0.12247640964854216, -0.09052546264131044, 0.007965803422743776,
        -0.004390988856357187, -0.013780455672195956, 0.08714894304721499,
        -0.0007406480126734882, -0.017755796523197854, 0.0033368248195326093,
        -0.006369186240307024, 0.005059101564511423, 0.0023819922218710136,
        -0.00832887049659797, 0.005350789295195254, 0.0035041293160555467,
        -0.008049758271893486, 0.0030314440386907037, 0.005584495990408744,
        -0.007609956786856069, 0.0006485863568779935, 0.00707853809801157,
      ],
      [
        -3.8794784967838483e-7, 6.430136862451818e-6, -5.474439489570063e-5,
        0.00028582294528118544, -0.00102886401230411, 0.0026795176383535703,
        -0.005117988239273521, 0.0070922128521505486, -0.008592908091389783,
        0.07190902537334207, -0.09685182612840963, 0.04432586748508786,
        -0.02138917507045427, 0.009491997539086505, -0.0037749923663552326,
        0.0013805368337669694, -0.00048682741062084603, 0.00016898154187945037,
        -5.598634424956123e-5, 1.6778977702697188e-5, -4.362161387651103e-6,
        1.0508214325009884e-6, -1.9431236757790706e-7, -1.3234853401724472e-8,
        -5.44842048551042e-8, -9.045340896583915e-9, 3.990641746746402e-8,
        5.289220940364711e-8, 1.753967374969753e-8, -3.3828985590175384e-8,
        -5.430389812044551e-8, -2.518660658881378e-8, 2.693204511389627e-8,
        5.445558457196853e-8, 3.2248580228322044e-8, -1.9408856245956493e-8,
        -5.334150288560327e-8, -3.8561009311862764e-8, 1.1434556576236691e-8,
        5.098758630726794e-8, 4.397696737482402e-8, -3.1949239482031693e-9,
        -4.7449103061414395e-8, -4.8371130947700846e-8, -5.118944977346228e-9,
        4.28081568649346e-8, 5.164154730443909e-8, 1.331424194709092e-8,
        -3.717204886101076e-8, -5.371164932579649e-8, -2.1200091014991746e-8,
        3.067196833168006e-8, 5.4533252987388785e-8, 2.859288896204199e-8,
        -2.3459481129865946e-8, -5.4087848935983674e-8, -3.532133320569766e-8,
        1.5701911923650577e-8, 5.238577039028669e-8, 4.122931159744069e-8,
        -7.57905685583863e-9, -4.946599445002406e-8, -4.617901830243935e-8,
        -7.199454980148197e-10, 4.539648182347641e-8, 5.005523429622811e-8,
        9.001829091970376e-9, -4.027235539401325e-8, -5.2768447178543315e-8,
        -1.707455310955047e-8, 3.42125070855691e-8, 5.4255694512029744e-8,
        2.4750878033564874e-8, -2.7357231173049052e-8, -5.448184396153551e-8,
        -3.1851925512368965e-8, 1.9866106258241348e-8, 5.344163167159555e-8,
        3.821239324674541e-8, -1.1913703484600016e-8, -5.115979969161445e-8,
        -4.368501620827012e-8, 3.6844869407712036e-9, 4.7689313745690135e-8,
        4.814279386480728e-8, 4.630752478734232e-9, -4.311023553063385e-8,
        -5.14815934382975e-8, -1.2838355122189436e-8, 3.752916704623179e-8,
        5.362370511399375e-8, 2.0747224968013246e-8, -3.1076329564461746e-8,
        -5.4519916959990125e-8, -2.8174030306148344e-8, 2.3901424299881086e-8,
        5.414943665048799e-8, 3.494648087086171e-8, -1.6170705208716206e-8,
        -5.2520290684034105e-8, -4.090669328956864e-8, 8.064142945268435e-9,
        4.967040818596202e-8, 4.5915913079206456e-8, 2.2943714261732505e-10,
        -4.566656849717635e-8, -4.9858302537324296e-8, -8.517677774456314e-9,
        4.0601694886103775e-8, 5.264237132574319e-8, 1.6608375899268605e-8,
        -3.459291166267737e-8, -5.420285631719528e-8, -2.431305646325364e-8,
        2.7780110123355466e-8, 5.450344655149987e-8, 3.145233939822344e-8,
        -2.0322116051236598e-8, -5.353771988969115e-8, -3.786084351163716e-8,
        1.2391923556077546e-8, 5.1328102440541466e-8, 4.33898569229857e-8,
        -4.17337938563157e-9, -4.792535352761038e-8, -4.7910377965562676e-8,
        -4.14216927985573e-9, 4.3408675798561494e-8, 1.727694037354787e-7,
        -2.131914260171794e-6, 1.7669812344798176e-5, -9.058067749748997e-5,
        0.0003188705833577169, -0.0008116348674088666, 0.0015089078663423202,
        -0.0020053088216757647, 0.0023025049732558556, -0.022472099676479125,
        0.03051542103498706, -0.013880016728826657, 0.006734242270007936,
        -0.0030211435425688713, 0.0012168818876189616, -0.00044983084829050785,
        0.00015950939156365618, -5.5547983799861294e-5, 1.8475906949604534e-5,
        -5.4985979608612576e-6, 1.4808965275322462e-6, -3.735776682985102e-7,
        1.222026071666319e-8, -3.179919372347339e-8, 3.232045037399679e-8,
        5.4375877579824453e-8, 2.839833164150565e-8, -2.3678214943766205e-8,
        -5.411863814194146e-8,
      ],
    ];
    const result = wavedec(data, "coif10");

    const reconstruction = waverec(result, "coif10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif10_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49673965525591535, 0.9142818745802435, 1.190667551157033,
      1.2941840620665204, 1.228987428634162, 1.0320560681377948,
      0.7623862802047321, 0.48529006414402126, 0.25586570729784,
      0.10587301244162606, 0.03731984543268452, 0.024295898013111633,
      0.022431251228717308, -0.0166312950053934, -0.12966711690998056,
      -0.32940739848165057, -0.5985801587961668, -0.8921590219573718,
      -1.1473826027181666, -1.2990692003298654, -1.2963430954176487,
      -1.1164751646204474, -0.7722313285890539, -0.3107432522103035,
      0.19594681577417625, 0.666407849156519, 1.027611626686359,
      1.2306230577541224, 1.2603545274267725, 1.1370587165870043,
      0.9093295732535979, 0.64052566798445, 0.39217530902916065,
      0.20864860772759947, 0.1070048330405739, 0.07454402824696438,
      0.07456767267367707, 0.05870724728604332, -0.017534231157706526,
      -0.18022217323388218, -0.4273549503705775, -0.7268183128903367,
      -1.0226200664306746, -1.2479324146432151, -1.3416765472520846,
      -1.2644249276357125, -1.0095209592617536, -0.6064946455438724,
      -0.11578672642942867, 0.38401149503527393, 0.8133014040897264,
      1.1087937623471606, 1.2367501100008262, 1.198940097403814,
      1.0299581146412848, 0.7867322010375094, 0.5330245216755107,
      0.3229629141636384, 0.1878414005145096, 0.12953639183285548,
      0.12213691383629874, 0.12123401247067497, 0.07831267047634044,
      -0.04364427211864014, -0.2575522844159714, -0.5460595170829307,
      -0.863587085092979, -1.1462064455533398, -1.326933324912812,
      -1.3525804528215681, -1.197860981459813, -0.873089863814178,
      -0.4234264767377137, 0.08026862419328637, 0.5567712329139063,
      0.932268117161047, 1.1561997369581813, 1.2113003399676454,
      1.1154449186233095, 0.9149949108900433, 0.671485404175028,
      0.44516533422639276, 0.2796626007757153, 0.191705816179792,
      0.16848428674347637, 0.17321805124996473, 0.15735991732867174,
      0.076116563104555, -0.09689624333720676, -0.3598330665464048,
      -0.6803523937473716, -1.0016631419136972, -1.2554757089342197,
      -1.3786346853059188, -1.3292173766151554, -1.0979690813775818,
      -0.7120935631490102, -0.23033370336919645, 0.26952656286177845,
      0.7076939571692868, 1.0197440705010186, 1.1700808033160595,
      1.1582169489908656, 1.0164461220681624, 0.799662146786461,
      0.5700634538998672, 0.3807500842811598, 0.2624560052902376,
      0.21680236684748821, 0.21773164044893073, 0.22063502623254294,
      0.17667093494514877, 0.04841093688406306, -0.1774070204663169,
      -0.4834974486905857, -0.8238494416409131, -1.1334522733215802,
      -1.3435598351963305, -1.3986635312710676, -1.270856017118661,
      -0.9678877742421093, -0.5327889819614646, -0.035050095555162905,
      0.4445161467990615, 0.8315155728047441, 1.0739513311908184,
      1.1525357253885438, 1.08288104935364, 0.9091842279668579,
      0.6911765081129664, 0.4878011220831661, 0.3418764866904656,
      0.26969884960256885, 0.2582176312669808, 0.2704217615800596,
      0.2574219441960887, 0.1739582210036384, -0.006842106921021496,
      -0.28345025000454116, -0.623439069817747, -0.969331153084559,
      -1.2514486233917794, -1.4045856806301285, -1.3842981649273913,
      -1.1786535905085542, -0.8124006223816083, -0.34241545523859757,
      0.15452074394390475, 0.5986259345975711, 0.9245401303905436,
      1.0949873278057947, 1.1073667492180903, 0.9917715438065701,
      0.8011145667467886, 0.5960367014771895, 0.42857253713858345,
      0.32881978233545356, 0.2980358629955527, 0.3098825009547945,
      0.319397579815776, 0.27724672388358523, 0.14541831902535862,
      -0.08986584646374673, -0.4115445889865418, -0.7733109300276819,
      -1.1091752001131632, -1.3486901173447083, -1.4340362847929875,
      -1.334642426562634, -1.0555981262078662, -0.6376611128539993,
      -0.14877263802964397, 0.33086635592014263, 0.726485771634083,
      0.9848447029357197, 1.0848005491617245, 1.039832711556048,
      0.8920593744461691, 0.6994471432027876, 0.5196272891237429,
      0.39456079950993644, 0.340027232524627, 0.34262135982503544,
      0.3649618556905495, 0.35765990910913886, 0.2748197696720117,
      0.08890679432238141, -0.19903593135989317, -0.5566501678887237,
      -0.9259011298555493, -1.2358150980868035, -1.4191822900354318,
      -1.4290309555873222, -1.2506899692701097, -0.9063402331369783,
      -0.4508348896176819, 0.0402351781380946, 0.4873022879555554,
      0.824272957989041, 1.0123765726072513, 1.0470541480544961,
      0.9563144418581317, 0.7911609726335277, 0.6107030683414456,
      0.4658921702405841, 0.3861323918426616, 0.3722255932960602,
      0.3974319189057506, 0.41629177015045604, 0.3788164409322446,
      0.2462389484336327, 0.004090118770993079, -0.33096101777915315,
      -0.7124613665837638, -1.07356281689557, -1.3421970125327745,
      -1.458264641859568, -1.3885070074927601, -1.13527456035751,
      -0.7369245332174069, -0.2596810588031295, 0.21706062682913463,
      0.6183582855046006, 0.889924219915427, 1.0089369015749299,
      0.9868858728047996, 0.8639129624005735, 0.6962782251597871,
      0.5403146631105677, 0.4370976352975901, 0.4018240114005925,
      0.4206349385440701, 0.4556519804704166, 0.45683744690806394,
      0.37749393349887317, 0.18924968663062586, -0.10751358118630822,
      -0.4806722225327657, -0.871778105672277, -1.2086721413160972,
      -1.422206842526197, -1.4628971489110674, -1.3132920237138708,
      -0.992909385245778, -0.5544370790842031, -0.0720980330303268,
      0.37495263470272694, 0.720090346513815, 0.9232406563994993,
      0.9780519894005235, 0.9105790745956213, 0.770005087890586,
      0.6139530871337858, 0.49229366275696507,
    ]);
    const expected = [
      [
        0.15165700817932457, 1.278759212726402, 2.461621241053505,
        -0.6220261748694383, -2.591880154830937, -0.6765739412392944,
        0.07963098374311846, 0.9335047590735386, 2.595765471512863,
        0.4262121852898901, 2.1859792968726524, 1.5969254371115875,
        0.045333195319992865, -0.25066421717529547, -2.2930528316108907,
        -1.5500408586795635, 2.061635172197338, 1.8103365283114734,
        0.22513944825327994, 0.1388406822825191, 0.7913535264958864,
        2.515919461589107, 0.3924968600327641, -2.583371755374802,
        -1.2226355543518648, 0.09314387098923974, 0.43101391854687615,
        2.5861983705543783, 0.8520736523836665, 1.5299878466084937,
        2.197006929540277, 0.15337334681945744, -0.012196853049722131,
        -1.7894015287965823, -2.2315102718910054, 1.3303614931255903,
        2.276712117779271, 0.4169655475429642, 0.11518876911033146,
        -1.451257957289926, -2.5288183326965763, 0.7656151871106892,
        2.4000700442907545, 0.6463132353621739, 0.23992079674197697,
        -1.0901562789120836, -2.7044244870605594, 0.15789503121045262,
        2.424301904810981, 0.8914032845219279, 0.34374530969434736,
        -0.7182561339973506, -2.7558794003428813, -0.4633598246732455,
        2.3412555970211177, 1.1418099509290824, 0.4328165264971973,
        -0.35405510193885403, -2.685173057383821, -1.0681328691926995,
        2.148313144464869, 1.384529145334682, 0.5140170791437165,
        -0.013629246918238698, -2.5005297087485783, -1.627040511220809,
        1.8487786146332967, 1.6047466293798724, 0.5940507101878659,
        0.2901838018872896, -2.2157270014258708, -2.1129637600671582,
        1.4519787982724972, 1.7868020920634564, 0.6785715228181896,
        0.5483244170751422, -1.8491059026209766, -2.5025524587318873,
        0.972989947132045, 1.915290987372279, 0.7714232710671066,
        0.7557475722652708, -1.4223439467908547, -2.7774977972522765,
        0.4319507242546104, 1.976379077418386, 0.87363469875895,
        0.9123255563183964, -0.960974498714632, -2.922404988554027,
        -0.1509624949114058, 1.9611023095613522, 1.0261894164715406,
        1.8023290363134359, 0.757809841505909, -2.6292099495440224,
        -1.7476793150548005, 0.7716419787458223, -0.23853937726470478,
        -2.8245577543333806, -1.1253411829365205, 1.862492458497875,
        1.2120054476020912, 1.5096762031519766, 1.4515829290960836,
        -1.9884266220017452, -2.4176707358989082, 0.3776657623559174,
      ],
      [
        0.031106958774475175, 0.04379114340669311, 0.020880727188567455,
        -0.020910288658155647, 0.005906575882533407, 0.004195464673323347,
        0.003619743691057012, -0.02413980761659145, 0.04425369055897934,
        -0.05146635421971043, 0.037873929513500305, -0.010914709427460773,
        -0.009477964767918456, 0.012245472519262555, -0.004941062329262634,
        0.008152807376753547, -0.04735841869778976, 0.12844074352098137,
        -0.3549599485110213, 0.5325477062976649, -0.15434526525621875,
        0.11187246144164029, -0.05867899545990362, 0.02010315742270384,
        -0.0037271392633096887, 0.006566568380387519, -0.013050919489208947,
        0.009858578690488446, 0.0023299261932317283, -0.011453375800264162,
        0.008062899332427384, 0.0040646318259097815, -0.011825418909125678,
        0.0068480428253148455, 0.005506413531488707, -0.011928355997242703,
        0.005499002311015876, 0.006855395504009591, -0.011823627495681313,
        0.004052897929109895, 0.008083960371798362, -0.011511425676563306,
        0.0025367371291150145, 0.009171464318894738, -0.010998108892576675,
        0.0009752733683473362, 0.010097878381022619, -0.010291915897558318,
        -0.0006023806286625584, 0.010848105355992474, -0.009405807408907585,
        -0.002170355309817651, 0.011407768733548289, -0.008354853297847683,
        -0.0036994924389065677, 0.011768424655789759, -0.007157736550904884,
        -0.005164675095505259, 0.011922305088005975, -0.00583529098676669,
        -0.006538668781361827, 0.011868258670406695, -0.004410629883449878,
        -0.007798921949172342, 0.011605613244279564, -0.002908893872079122,
        -0.008921963593669306, 0.011140647698859165, -0.0013560136451717948,
        -0.009889435810316153, 0.010479772318160158, 0.00022030865785478297,
        -0.01068321486973068, 0.009636277643310749, 0.0017937516741883936,
        -0.011293576775101805, 0.008625235898282386, 0.003400376473525501,
        -0.012175100296649952, 0.009270489370446687, -0.0011804963423849687,
        -0.0001348838171190106, -0.02969428603316221, 0.0062925490268573615,
        -0.003290372258516679, 0.0015740591903197264, 0.01545400181520336,
        -0.03374392377407905, 0.038015432223327976, -0.032570524769270526,
        0.026307843259275078, -0.011399237678816529, -0.023963320040836122,
        0.0531652159246569, -0.01306809804074072, 0.0029557141083671593,
        0.008113836046133945, -0.005514280774959279, -0.005542490126957526,
        0.012358021266733894, -0.0067383344479851285, -0.0057571345189540895,
        0.011902914811397393, -0.005172993779989152, -0.0071463404490590505,
        0.011770992621133344, -0.0037152837100025266, -0.00834334436310537,
      ],
      [
        -3.936768047167128e-7, 6.544569568868981e-6, -5.6135383392402675e-5,
        0.0002934329732797953, -0.0010582201627422649, 0.0027616912540704562,
        -0.005287658003635304, 0.0073535933441542505, -0.008947444783973161,
        0.07393242334521818, -0.09950192147400891, 0.04556087616209251,
        -0.021973260501142587, 0.009741375225592234, -0.003869723170768628,
        0.0014138884692959646, -0.0004983559262545622, 0.00017289651691992347,
        -5.729297629410992e-5, 1.718997032786719e-5, -4.418371027301201e-6,
        1.0845249141669984e-6, -2.304510641622855e-7, -5.7715710671619073e-8,
        -6.721965380070833e-8, 2.5420265622722023e-8, 8.87851237882942e-8,
        6.72219978152674e-8, -1.9046269426053176e-8, -8.698984050798298e-8,
        -7.124709173999031e-8, 1.3037194463888435e-8, 8.477959040027148e-8,
        7.496221271794423e-8, -6.970459825964203e-9, -8.219737598276373e-8,
        -7.834857767932428e-8, 8.732225539981627e-10, 7.925476796570394e-8,
        8.139119365458197e-8, 5.227266714333727e-9, -7.596544157208479e-8,
        -8.407755099686637e-8, -1.1304941289059038e-8, 7.234347972357037e-8,
        8.639596815379002e-8, 1.7333651180837136e-8, -6.840399512976479e-8,
        -8.833545144345919e-8, -2.3286274133229305e-8, 6.41646551358461e-8,
        8.98874938030027e-8, 2.9136315905673602e-8, -5.964474295902242e-8,
        -9.104613090622626e-8, -3.485888965903323e-8, 5.486360274390951e-8,
        9.180622034264738e-8, 4.042926583293607e-8, -4.984150760354691e-8,
        -9.216360343532497e-8, -4.5822265724659596e-8, 4.460098683722589e-8,
        9.211684948356899e-8, 5.101398263239349e-8, -3.916562555106247e-8,
        -9.166698668986495e-8, -5.598246995430182e-8, 3.3558659696421883e-8,
        9.081576752846685e-8, 6.070616275628787e-8, -2.7804076373430674e-8,
        -8.95661252374209e-8, -6.516354568864838e-8, 2.1927735378796857e-8,
        8.792382921014278e-8, 6.93349570229721e-8, -1.5955890099855217e-8,
        -8.589683337808002e-8, -7.320295341628448e-8, 9.914022210983312e-9,
        8.349367103922859e-8, 7.675064386734551e-8, -3.8281591997048685e-9,
        -8.072412976235614e-8, -7.996164355078194e-8, -2.274322502472017e-9,
        7.760076510955036e-8, 8.282191152850248e-8, 8.366293472332861e-9,
        -7.413796881083371e-8, -8.531974139376992e-8, -1.4421810103991682e-8,
        7.035041735152603e-8, 8.744409177829776e-8, 2.041467668352905e-8,
        -6.625405124079171e-8, -8.918484237733747e-8, -2.6317834236509666e-8,
        6.186737729275461e-8, 9.053452423411967e-8, 3.2105175043509344e-8,
        -5.721020553342387e-8, -9.148803868157104e-8, -3.7752152387524053e-8,
        5.2302354037740196e-8, 9.204096633304312e-8, 4.3234195105689186e-8,
        -4.716476667532688e-8, -9.219009092684526e-8, -4.85264695413166e-8,
        4.182060032564488e-8, 9.193508252569021e-8, 5.360567917787681e-8,
        -3.6293772471629415e-8, -9.127780826484437e-8, -5.8450398985853685e-8,
        3.060779669134965e-8, 9.022077031367148e-8, 6.303944541947958e-8,
        -2.4787159760585784e-8, -8.876787766266727e-8, -6.735185963312969e-8,
        1.8858094798066604e-8, 8.69259334780899e-8, 7.13688001726217e-8,
        -1.284694164044868e-8, -9.491296729138697e-8, 3.947778723379721e-8,
        -2.5641438453433297e-7, -3.1746581776062135e-6, 3.43982103917814e-5,
        -0.00017783724473462593, 0.0006353976111632811, -0.0017657773474193696,
        0.0042088417968267145, -0.010256398877094052, 0.007587384444549256,
        -0.0006393945853800993, 0.0008188508357613712, -0.0007760348949320213,
        0.0005234218790658989, -0.00027630054177248104, 0.000120787957711601,
        -4.5633886361874e-5, 1.5520837708703726e-5, -4.971710390771961e-6,
        1.3531442976363634e-6, -3.0758610592065856e-7, 1.7214926138845615e-7,
        3.137810391744462e-8, -4.103253664135668e-8, -9.239797520430496e-8,
        -5.1965675898067294e-8, 3.80826240916876e-8, 9.153291221383097e-8,
        5.692372006903771e-8,
      ],
    ];
    const result = wavedec(data, "coif10");

    const reconstruction = waverec(result, "coif10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif11", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5015827037228677, 0.9227034896167223, 1.2004070026574163,
      1.302449236642583, 1.2329947419964784, 1.0295104572272245,
      0.7517932189032163, 0.4660499655566371, 0.22817234079578708,
      0.07049882108763417, -0.004597678601527544, -0.022770311895490905,
      -0.028077496555667908, -0.06836394553665137, -0.1796333401099317,
      -0.3736648078456189, -0.6322755602404178, -0.9098902686197823,
      -1.143895369903723, -1.2701993868048638, -1.2400226986786071,
      -1.0335663744486951, -0.6669599347038617, -0.19057226492465898,
      0.3210430680731811, 0.7851688637994656, 1.128990748545781,
      1.305264225014667, 1.3017464173598279, 1.142141858576669,
      0.8784656299531329, 0.5768962664936697, 0.30081825238009935,
      0.09542308998923543, -0.022220150231277325, -0.06517724545016514,
      -0.07038410700503149, -0.08591464322430509, -0.15528073266366743,
      -0.3030361383034289, -0.5256111884544665, -0.7899323623168675,
      -1.0403363816009707, -1.212102121561513, -1.2481629830869228,
      -1.1146852922601598, -0.8114349540615577, -0.3741476246600595,
      0.13186321524519296, 0.6253989121438832, 1.0270453260324737,
      1.276477467859979, 1.3451448716527126, 1.2412553540936155,
      1.0059295509627344, 0.7016338548632277, 0.39594104064420355,
      0.1448181739734744, -0.020292867426888683, -0.09836899156575812,
      -0.11630025256637562, -0.11881618805157984, -0.15365307312457743,
      -0.2560097801621212, -0.4365192586627647, -0.6760365466334497,
      -0.9287529930753033, -1.1329544982943374, -1.2267177014427226,
      -1.1645079731509507, -0.9303538341413469, -0.5441024393532252,
      -0.05899936107295968, 0.44896256177436134, 0.8973818342562656,
      1.2154750433921802, 1.3593543722746944, 1.3208115790712456,
      1.1275104369053863, 0.8346662253702434, 0.5104386316601555,
      0.21883225409818446, 0.0044857479321512295, -0.11681120974384146,
      -0.1595610399170038, -0.16176424348332663, -0.17184513350722436,
      -0.23288965080227464, -0.36848125457399283, -0.5739937074411727,
      -0.815762814623261, -1.0384855834724778, -1.179022757962203,
      -1.1830733006376477, -1.0203915036320885, -0.6945387395564491,
      -0.24452311920131195, 0.2622665840485188, 0.7442087054647455,
      1.1232423484992036, 1.3419318631319137, 1.3756026519607771,
      1.2365947508785609, 0.9696770602809105, 0.6398992199391014,
      0.31605639156232285, 0.0540182106957256, -0.11584709995820958,
      -0.1940300839275879, -0.20880119011564588, -0.2056870324800724,
      -0.2324331331985111, -0.32355354737334413, -0.48866377729240645,
      -0.7077922932867845, -0.9350278344792405, -1.1096614019537032,
      -1.1719940253454686, -1.0797206535846737, -0.8205960818668631,
      -0.4179971629103978, 0.07221439041735421, 0.5729116933532978,
      1.0023217443503518, 1.2919729401645248, 1.401548622685631,
      1.3270002822687057, 1.0999788479376136, 0.7788383196384051,
      0.43358903566236934, 0.12868357866189412, -0.09197823602045185,
      -0.21406390088499283, -0.2536696200773373, -0.24999520285254978,
      -0.2519343967000105, -0.30226129044762023, -0.4237074052810537,
      -0.6107153305165762, -0.8291559594525408, -1.0241966627027768,
      -1.1343520464218422, -1.1080971804496818, -0.9187054424103469,
      -0.5733784293838322, -0.11416264285746347, 0.38976849643393574,
      0.8566838009842717, 1.2101726719835164, 1.3959319683369378,
      1.393323678697516, 1.2188837345200785, 0.9209973015167827,
      0.5671853735174553, 0.22729933569210958, -0.04307997230977678,
      -0.21484862161427098, -0.2901830430017741, -0.2988810118910006,
      -0.2873909152468769, -0.30357955958369814, -0.3813863743193484,
      -0.529524375191982, -0.7273135684764598, -0.9288500151631055,
      -1.0745122176656943, -1.1068574585410735, -0.9867709893541627,
      -0.7056114145254236, -0.29008071515312633, 0.20161395409996896,
      0.6915192979748762, 1.0987977961385906, 1.3575569368642701,
      1.4312456702632863, 1.3200758046978032, 1.059686698259954,
      0.7114832055063773, 0.34717178220704714, 0.03146077559391591,
      -0.19269000720201318, -0.3125928795918765, -0.34609960709451565,
      -0.33374375275977974, -0.32500274132712675, -0.3624439437726885,
      -0.4680524604075918, -0.6354486077471352, -0.8301443721599716,
      -0.9978652060602179, -1.078827682621332, -1.02426962426461,
      -0.8108925823561463, -0.4493650172435005, 0.015474525678596446,
      0.512963583998749, 0.961571792867959, 1.2868247531567436,
      1.4377768332417835, 1.3979638990584058, 1.1881550394322913,
      0.8602927263793566, 0.484232188081411, 0.13069321331517975,
      -0.14524037342214258, -0.31593102587486865, -0.3854192973865125,
      -0.3851780371607699, -0.36269820922454005, -0.3660717989936299,
      -0.42876178342614646, -0.5586780674643292, -0.7345314955245562,
      -0.9105139094085876, -1.0281504556070555, -1.0322627980894241,
      -0.8868647113780584, -0.5867768270180855, -0.1618075150117945,
      0.32776869258185204, 0.8034792254731637, 1.1857204205777296,
      1.4114300725388877, 1.4479951617942517, 1.2999625362980243,
      1.0069339965049096, 0.633251141214244, 0.2521388468474897,
      -0.0716495747210183, -0.29630864248264877, -0.41099062345201304,
      -0.4354666593119252, -0.4117355874826114, -0.38996541782035676,
      -0.41261068308057863, -0.501000802344097, -0.6480247865384465,
      -0.8189211036422415, -0.960038439589975, -1.0133200315886126,
      -0.9327303646657105, -0.6982880180882304, -0.32393916197680145,
      0.14294154138313675, 0.6305002652449612, 1.0577118095746454,
      1.3523101106761823, 1.466911710150693, 1.3893386570734818,
      1.1446032026691653, 0.7881191278825537, 0.3919142180734435,
      0.027368534373875708, -0.2511542816833219, -0.41769428612988285,
    ]);
    const expected = [
      [
        -0.7433264737012069, -0.21960011656367306, -0.09953815465776464,
        -0.03142403508246175, 0.4254212501284774, 1.2423380108298758,
        1.8409473917817434, 1.5966342601150465, 0.45402242583223673,
        -0.9432197358223676, -1.7536706865508067, -1.6176711608119398,
        -0.8942814214039473, -0.25378484006039254, -0.04025007610281603,
        -0.00540651652609125, 0.3204395096782024, 1.0680813685733055,
        1.7324938029316808, 1.7245869253179544, 0.6353629713350557,
        0.04490758011938295, 1.3228846614596586, 1.829569829726775,
        1.462241410830601, 0.656462671963937, 0.10059743727061218,
        -0.032444860078280555, -0.09663112113610274, -0.528449234417835,
        -1.2867784588660711, -1.7963332282716686, -1.4616835855930403,
        -0.2695098856548168, 1.1103964530510877, 1.8459223704967405,
        1.6152325104750285, 0.8158545272127466, 0.13494862726357615,
        -0.0921745483174887, -0.1215016568662849, -0.428557816155656,
        -1.117133056393878, -1.714171255935757, -1.5764030583719844,
        -0.5291246487710631, 0.8844476199556488, 1.805211747147739,
        1.755400159656752, 0.9922601169808607, 0.2048038259183925,
        -0.13911476538837042, -0.16803146829400048, -0.3620525036551789,
        -0.9560600496519959, -1.602239613221778, -1.6468629684307539,
        -0.7694770521568212, 0.6349289399591551, 1.7189412901615866,
        1.8679096514005409, 1.1803962999417565, 0.3094755427954471,
        -0.16519599982050887, -0.22876919106402993, -0.329355704097377,
        -0.811749683201305, -1.468640392412521, -1.6731183054203727,
        -0.9822261074592259, 0.3709009560295021, 1.5885045612357844,
        1.9453959290220562, 1.3713304538720736, 0.4469712374799374,
        -0.16383254189527785, -0.2952894789990252, -0.32871009157895087,
        -0.6910749395314991, -1.3223290406363954, -1.657449843200094,
        -1.1604981097391414, 0.10212656627797034, 1.4174970020677418,
        1.9820890718316482, 1.5556050090796514, 0.6131874975648914,
        -0.13007686989448575, -0.3587430210180216, -0.35628904364725345,
        -0.5992127581920418, -1.1726035993116628, -1.6042160453893084,
        -1.299245697077212, -0.1614503616263137, 1.2115338467019918,
        1.9741459221248798, 1.7237619119941914, 0.8021212510608029,
        -0.06092428121659766, -0.41038079854976134, -0.4064321336230129,
        -0.5393617832008042, -1.0285767091979718, -1.519589747467681,
        -1.3955049157238304, -0.41023608485318114, 0.9779559660483739,
        1.9198754311882436, 1.866869109514636, 1.0061892025045078,
        0.04449225638612915, -0.4420730928090994, -0.47198494545951447,
        -0.5125731419782897, -0.8986600364500514, -1.411194503822544,
        -1.4485359928341772, -0.6354981044769368, 0.7254400534419213,
        1.819845016756063, 1.9770195082003403, 1.216637645339513,
        0.18482811655856823, -0.4467939438108551, -0.5447240081798005,
        -0.5177037049334511, -0.7900900979719906, -1.2876611153147535,
        -1.4598400467876793, -0.829827748677611, 0.46353492629381027,
        1.676861897460347, 2.0477743983800085, 1.4240197140731268,
        0.3565782003618247, -0.4190437895963273, -0.6158425464264243,
        -0.5514953571643597, -0.7085195201517908, -1.158135349097448,
        -1.4330389117240454, -0.9875502836706229, 0.2021923319404133,
        1.4957286964317855, 2.0748061955755914, 1.6179444706966295,
        0.556334106321315, -0.36172344152218044, -0.586866328066937,
        0.04070442858621496, 1.1132931725228639, 1.9654806928156732,
        1.9121649264819356, 0.8917683276973577, -0.4581503470244394,
        -1.3190729249920436, -1.3577005123990769, -0.916445329691702,
        -0.5835196286553994,
      ],
      [
        1.0507774410794229e-7, -1.8073370013700862e-6, 1.7028360029198864e-5,
        -0.00010089780920860176, 0.0004166235435257792, -0.0012669991449649354,
        0.0029047345212351457, -0.005008488013152318, 0.006326263895247045,
        -0.0073295230864830075, 0.07311694596637153, -0.09991993041258919,
        0.046622469426174276, -0.02347509380158733, 0.011102656476261054,
        -0.004773916214457927, 0.0018897669370651655, -0.0007129677686708179,
        0.00026307521005117685, -9.402586759515416e-5, 3.1379375666431765e-5,
        -9.437239629984332e-6, 2.5467478506057957e-6, -6.048207402283343e-7,
        1.0028847837605442e-7, -3.6198441123957385e-8, 1.0001974163799596e-8,
        2.1399578601458724e-8, 1.572334098092151e-8, -5.560527693971403e-9,
        -2.1434894052832587e-8, -1.6607667143359723e-8, 4.26120668862153e-9,
        2.1014150544470598e-8, 1.746932562852835e-8, -2.9492900491997336e-9,
        -2.0519162561130444e-8, -1.8269377664638117e-8, 1.6269685230729845e-9,
        1.995178997095564e-8, 1.9004963791952666e-8, -2.989585940330795e-10,
        -1.9314108705250592e-8, -1.967355907513739e-8, -1.0300991581534013e-9,
        1.8608357409162228e-8, 2.0272829870617747e-8, 2.3555766375625392e-9,
        -1.783695649453491e-8, -2.080059893580969e-8, -3.6727510068219633e-9,
        1.7002625733012604e-8, 2.125498314600768e-8, 4.976924031666081e-9,
        -1.6108391749102945e-8, -2.1634440790287707e-8, -6.263547194986146e-9,
        1.5157385889832958e-8, 2.1937662351169238e-8, 7.528137400101449e-9,
        -1.4152894532310105e-8, -2.2163508867242966e-8, -8.766181164742586e-9,
        1.309847107082038e-8, 2.2311164879773232e-8, 9.973268174236418e-9,
        -1.1997908387751837e-8, -2.238017377021508e-8, -1.11451898907628e-8,
        1.0855064035624448e-8, 2.237031881252087e-8, 1.2277864070093282e-8,
        -9.673904833212435e-9, -2.2281552340514577e-8, -1.336723996554089e-8,
        8.458609608032398e-9, 2.211419154899994e-8, 1.4409441977659705e-8,
        -7.2135355270973095e-9, -2.186887665495664e-8, -1.5400834267447394e-8,
        5.943048855298645e-9, 2.1546496929309485e-8, 1.6337973302242394e-8,
        -4.651557522274541e-9, -2.1148112803659356e-8, -1.721749892477675e-8,
        3.343652014337807e-9, 2.067511659403448e-8, 1.803626841592354e-8,
        -2.0239951813892826e-9, -2.0129256226514864e-8, -1.8791451710227787e-8,
        6.972295730568306e-10, 1.951246564755513e-8, 1.948042337446505e-8,
        6.32060650110637e-10, -1.8826827623546826e-8, -2.0100701983051873e-8,
        -1.95911361110218e-9, 1.8074784151342945e-8, 2.0650055625970868e-8,
        3.2792297520255213e-9, -1.7259032028236422e-8, -2.112660888239649e-8,
        -4.587755299741054e-9, 1.638247098811882e-8, 2.152871541180774e-8,
        5.880163757302433e-9, -1.5448105137024878e-8, -2.1854903545088954e-8,
        -7.151842867966203e-9, 1.4459232268315772e-8, 2.2103978638613394e-8,
        8.398267690960686e-9, -1.3419417631766925e-8, -2.22751381158196e-8,
        -9.615052247248613e-9, 1.2332320838161053e-8, 2.236779831373699e-8,
        1.0798008747858743e-8, -1.1201699396516149e-8, -2.2381574999521838e-8,
        -1.1942873574059476e-8, 1.0031552570113084e-8, 2.231639252205935e-8,
        1.304559395170655e-8, -8.826066380807832e-9, -9.497309579585163e-9,
        -2.3949479844658216e-7, 1.8690057851455672e-6, -9.408337198600004e-6,
        3.251364859811236e-5, -7.914487014988526e-5, 0.0001331348458544299,
        -0.00012519454325351888, -6.50757481185386e-5, 0.00040678924208497854,
        0.0056561123738119844, -0.00833277961386819, 0.003619844784743404,
        -0.0018924710713385253, 0.0009740752892827415, -0.00046141752197869355,
        0.00019852102896657293, -7.897905226571192e-5, 2.992279937330921e-5,
        -1.087329089124494e-5, 3.6858938677365456e-6, -1.1672337695926025e-6,
        3.258706196275378e-7, -5.634403664408151e-8, 3.254873578836924e-8,
        -8.274478324223733e-9, -2.08712349110309e-8, -1.6886238350340863e-8,
        3.941350108555626e-9, 2.0897297666828452e-8, 1.767449748109247e-8,
        -2.6207089379778523e-9,
      ],
    ];
    const result = wavedec(data, "coif11");

    const reconstruction = waverec(result, "coif11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif11_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4949534242324024, 0.9104140483006202, 1.1844340063415266,
      1.2857980589324534, 1.2196147193803708, 1.0240181578970036,
      0.7589602528733264, 0.49008239123259256, 0.2718862948128204,
      0.1345562664584969, 0.07779034359701015, 0.07313595821728874,
      0.07408248428320618, 0.0311226463264917, -0.09231185331484792,
      -0.30736795808050726, -0.5941678717628482, -0.9047083672355277,
      -1.173652635209074, -1.3343199945280562, -1.3357865778319788,
      -1.1566740584164021, -0.812013761224939, -0.3513230171545665,
      0.15173144652183373, 0.6155597561240972, 0.9687374545193355,
      1.165458160435713, 1.1945356974848491, 1.0798018484449363,
      0.8719539055560439, 0.6340902660951833, 0.4247681240197973,
      0.28301355162167496, 0.21915923049193264, 0.21382578631705756,
      0.22520652315638312, 0.2026243118562189, 0.10267407044542032,
      -0.09642421257943823, -0.38617893344145776, -0.7273176937837416,
      -1.0577179488044517, -1.3068623667674935, -1.4131739857464716,
      -1.3397952220646356, -1.084730449103635, -0.6826849952835558,
      -0.19804057020270235, 0.28933525911097696, 0.7019227793299014,
      0.9815828527844639, 1.1015642812196664, 1.07056470575356,
      0.9279726595725708, 0.7316820012508117, 0.5417628703338512,
      0.4043066976190566, 0.3396712511808838, 0.33816186618490385,
      0.36420853451644697, 0.3678510271420339, 0.30041134916295786,
      0.13011823394287225, -0.1465570638649818, -0.5009881795157843,
      -0.8771073590420757, -1.2036933336302023, -1.4111881005728875,
      -1.448785157565593, -1.2974171659878415, -0.9752865727665049,
      -0.5344680278584636, -0.04938060023193974, 0.40000477455154654,
      0.7460250898289817, 0.9478014103896486, 0.9987700567951034,
      0.9255086063759135, 0.7783419515803404, 0.6163219146620837,
      0.4905996742281986, 0.4305858471182839, 0.43652367132238035,
      0.48038881264937466, 0.5148219162948214, 0.4876726434126202,
      0.3582410790384719, 0.1108336003327588, -0.2380710679550027,
      -0.6410986930639844, -1.0295564659463528, -1.3289965361732066,
      -1.4768712760174039, -1.4378052551026193, -1.212582829710388,
      -0.8385321708442924, -0.38116921430213246, 0.08081459901473387,
      0.4734517568426192, 0.7438007613113411, 0.870604007861771,
      0.8667304332428156, 0.7729624025668164, 0.6449189233582011,
      0.5366637573398751, 0.48537328865951795, 0.5011229070386396,
      0.5644767490366407, 0.6324931528452715, 0.6515276809536256,
      0.5734085402193065, 0.37064710195127387, 0.0465679120037108,
      -0.36245761714088964, -0.7934477067657012, -1.1704359136883722,
      -1.421922436634702, -1.49776647483876, -1.3812423746625657,
      -1.0931923745404053, -0.6872105643815122, -0.2370700576056992,
      0.1804292475696525, 0.5028683741616963, 0.6955155199037848,
      0.7572610132083921, 0.7178348518819271, 0.627221409730563,
      0.5401972771068788, 0.5001593790370799, 0.5265610751500289,
      0.6092969470636751, 0.7115283991764139, 0.7802043852688283,
      0.7614879624551902, 0.6169829850905652, 0.33641025868777297,
      -0.05672522824508541, -0.5081344122878997, -0.9438280921306391,
      -1.2865983603924158, -1.4737932402827556, -1.471916033810309,
      -1.2843667041033675, -0.9503770172434238, -0.5354271201819902,
      -0.11559185051954857, 0.2402069363477597, 0.4855637489301642,
      0.6057418980582145, 0.6184224834630956, 0.566048804068943,
      0.5019446060504076, 0.47398702448182795, 0.5102256002565428,
      0.6103005113160165, 0.7449678463595981, 0.8638907408398768,
      0.9096627532051176, 0.8343656535132329, 0.6142624469744953,
      0.2586726249530783, -0.18944303462210177, -0.6615284380924995,
      -1.0782167631733408, -1.3672075339735386, -1.4797698739627405,
      -1.401733091377023, -1.1562177464880117, -0.7974582321603162,
      -0.3973303621203192, -0.028040749582413038, 0.25461612559421976,
      0.42321556188397724, 0.48293169077873455, 0.4671223564631713,
      0.42560802119411956, 0.4088774822734608, 0.4524972248257491,
      0.5659247305916386, 0.7287503468225691, 0.8954244214176931,
      1.0072793003298175, 1.0087151682679991, 0.863290952196283,
      0.5654420922326376, 0.14464371909460075, -0.3392314239205083,
      -0.8083450755108124, -1.184085871632286, -1.4047514519230195,
      -1.4393044520954403, -1.2937759528979538, -1.0087591029016678,
      -0.6487021585106838, -0.2857890471543425, 0.017449380078973453,
      0.2223673583025224, 0.3217131845104682, 0.3386256906491134,
      0.31755974353409044, 0.30968739652764093, 0.35675380757795666,
      0.47775542186511083, 0.6620522452315759, 0.8708237808130612,
      1.0465729549847314, 1.1282486468386936, 1.0680515559854105,
      0.8455037064073994, 0.47502753609862075, 0.004926393295247744,
      -0.49214015460281496, -0.934904686024876, -1.2515741935490408,
      -1.395744811319545, -1.3561915054079292, -1.1581348719353328,
      -0.8557598444521451, -0.5179856790580266, -0.21118890289306802,
      0.01667750240218241, 0.14653382779526672, 0.19060700737907135,
      0.18637459350339303, 0.18377127540397364, 0.22916909820587783,
      0.3504789992881409, 0.5474180630587577, 0.7896234216486491,
      1.0232251068051823, 1.1842549955162134, 1.2154495754278927,
      1.0820753721442873, 0.7826114953504275, 0.3514135558877895,
      -0.14747456082660096, -0.6339272108664007, -1.029421693620703,
      -1.274409179497274, -1.3410548737623014, -1.2382131823768334,
      -1.0074885851446131, -0.7115070680988479, -0.4174988952723144,
      -0.18046153490629185, -0.03023178176744118, 0.03426402608316867,
      0.0422154536078325, 0.04047197288327159, 0.07831864047901393,
      0.19162505801722185, 0.3906714535053421,
    ]);
    const expected = [
      [
        -0.5461394879279544, 0.1452030643583167, 0.31849012360131795,
        0.3099379590889136, 0.600712839766726, 1.2331290416135288,
        1.6893285380211909, 1.3700018751729104, 0.2145796481503494,
        -1.148356877175041, -1.8891010840238214, -1.6597548228446248,
        -0.8403876096436507, -0.13029687951457417, 0.1042328735722851,
        0.11109380298313412, 0.38228902561090106, 1.0781542879789516,
        1.7137168882710194, 1.7016470019130452, 0.6269552311291513,
        0.04432119990880164, 1.3052667984385604, 1.806184811456424,
        1.45439089428267, 0.6904845733295873, 0.19117639667904576,
        0.10319033216876287, 0.044063495151927194, -0.43469123101965196,
        -1.2794501527345463, -1.887013460865049, -1.635784142067552,
        -0.4968457798544985, 0.8705329526250014, 1.6482067380627858,
        1.5270704229150607, 0.8967390571775561, 0.4002416020595248,
        0.30239532288922305, 0.2865540466447547, -0.13636442841138155,
        -1.028582542671773, -1.8481824798456998, -1.8947565743844115,
        -0.9654623831045066, 0.40918184398168345, 1.3881677833154646,
        1.5140071301246434, 1.0347546131633534, 0.5717760150403226,
        0.47823309369238315, 0.5202199077524594, 0.18401497102064696,
        -0.7085042744325307, -1.7022794334889, -2.048891618436841,
        -1.3792635019078519, -0.06983471852903782, 1.0550387993265902,
        1.412474163377198, 1.1007417481349357, 0.6938127137908308,
        0.6173376930603537, 0.728068132112721, 0.5066293915547267,
        -0.33668333004342194, -1.456012713190808, -2.0886113871860115,
        -1.71485108618261, -0.5390546766544343, 0.6695618942060757,
        1.2312199981103193, 1.0931339171821366, 0.7589571657234256,
        0.7086948089910432, 0.8944803905673829, 0.8109221324947687,
        0.06585697510197058, -1.1221045036321082, -2.010901992467836,
        -1.9533717013568153, -0.9718625046678007, 0.25516548670416206,
        0.9836074830772699, 1.0151717873808592, 0.7639543180871259,
        0.7446698121081657, 1.006253107843222, 1.0769066014610862,
        0.4757559519380231, -0.718610573111604, -1.8195248477927939,
        -2.081603619058583, -1.3440360713650112, -0.1634715656723689,
        0.6866908402889916, 0.874581467547508, 0.7098568725629811,
        0.7215679628150508, 1.0535436277614394, 1.2864573994916486,
        0.8686982840854598, -0.2679129048439338, -1.52482876623972,
        -2.092710625444881, -1.635138822068293, -0.5619099904033282,
        0.3600815782865481, 0.6829685506296583, 0.6019006395001838,
        0.6399277122365179, 1.030608620338209, 1.4245080438388256,
        1.2208777726940085, 0.2045571128597427, -1.143172564977231,
        -1.9866185546731434, -1.8296755027364988, -0.9174033944860381,
        0.024677149340357866, 0.4549711520675576, 0.4490973002302797,
        0.5045260739482824, 0.9362832610138879, 1.4800776628215093,
        1.5104529947262746, 0.6717903870884361, -0.6959912770379526,
        -1.7699931975548389, -1.9179444230030454, -1.2102271823544974,
        -0.29866621233014684, 0.20723012895650975, 0.26357349184747175,
        0.32409396311861893, 0.7741665705522315, 1.447056238730757,
        1.718916030138982, 1.106740778181794, -0.20843604755956915,
        -1.4561720875228308, -1.8956722817526523, -1.4266876206351067,
        -0.5868140796088526, -0.04893886929685797, 0.06912378420939778,
        0.09913943815959064, 0.529526957478275, 0.31045760460436994,
        0.04225555590790161, 0.05493873089347737, -0.2579399843302505,
        -1.0051894917319033, -1.7514317746890262, -1.8021988550139811,
        -0.8965263768281514, 0.4969764493411392, 1.5302854181584835,
        1.674789490754016,
      ],
      [
        1.0506225852334771e-7, -1.7832313804703128e-6, 1.6801623325034844e-5,
        -9.956912161508826e-5, 0.00041117023436794815, -0.001250566150091941,
        0.0028674984626182224, -0.0049452623616318015, 0.006248355240309449,
        -0.007241682217783794, 0.0721673071673581, -0.0986171969755833,
        0.04601580280007979, -0.023168769098405952, 0.010957065561847563,
        -0.004710990129697436, 0.0018647597061305632, -0.0007035134500832958,
        0.00025958141053769156, -9.277690722996476e-5, 3.0963021701581634e-5,
        -9.31006390050607e-6, 2.5130997021285124e-6, -5.97928429686112e-7,
        9.743589857946472e-8, -3.599293983847825e-8, 1.1154029135953777e-8,
        2.2687977715759834e-8, 1.5757968825614278e-8, -6.873944350533923e-9,
        -2.2799189005076998e-8, -1.6608657882052697e-8, 5.6946672390528756e-9,
        2.2473390628823513e-8, 1.7449858963361536e-8, -4.502418499146235e-9,
        -2.2086733294626996e-8, -1.8243893277930985e-8, 3.2980115233939287e-9,
        2.1640386113091916e-8, 1.898861372905706e-8, -2.0847198099961735e-9,
        -2.11355914531258e-8, -1.9682046349583036e-8, 8.657863391696091e-10,
        2.057369845389126e-8, 2.032231147972196e-8, 3.5551343297952103e-10,
        -1.9956177443468927e-8, -2.0907646357737398e-8, -1.5758387320854101e-9,
        1.9284741764639575e-8, 2.1436470461773056e-8, 2.7918835497846758e-9,
        -1.8561219425750814e-8, -2.190739995706992e-8, -4.00039903761047e-9,
        1.7787544927930106e-8, 2.231914237334114e-8, 5.198125889424623e-9,
        -1.6965777443694585e-8, -2.267055509598218e-8, -6.381789929408212e-9,
        1.6098176547564557e-8, 2.296069824258891e-8, 7.548192361843855e-9,
        -1.5187100532521105e-8, -2.3188830681419105e-8, -8.694217845296362e-9,
        1.4234986456530413e-8, 2.3354308392642954e-8, 9.816769539141676e-9,
        -1.3244370440638864e-8, -2.345665494675304e-8, -1.0912772622017467e-8,
        1.2217986460161203e-8, 2.3495622229841228e-8, 1.1979274738118048e-8,
        -1.1158617756440823e-8, -2.3471129884111487e-8, -1.3013429714104248e-8,
        1.0069078226621106e-8, 2.3383209991985102e-8, 1.4012433470486235e-8,
        -8.952313891938874e-9, -2.3232087071300177e-8, -1.4973557602506374e-8,
        7.811371248444085e-9, 2.301819219253827e-8, 1.589420558827238e-8,
        -6.649349696086038e-9, -2.2742127777425438e-8, -1.6771929354312125e-8,
        5.469333305410218e-9, 2.2404602889586374e-8, 1.7604349046905113e-8,
        -4.2745202227328e-9, -2.200651448927016e-8, -1.8389171106202822e-8,
        3.0681822919267523e-9, 2.1548977704322112e-8, 1.9124305573315843e-8,
        -1.8535725929545597e-9, -2.10332371376865e-8, -1.9807790086999446e-8,
        6.339240688840163e-10, 2.046064739024463e-8, 2.0437748956730573e-8,
        5.874431304279456e-10, -1.9832757762000264e-8, -2.1012463698983597e-8,
        -1.807205357156042e-9, 1.915128738588982e-8, 2.1530399965374587e-8,
        3.0220630268530615e-9, -1.8418097240783827e-8, -2.1990186761415456e-8,
        -4.228788995331709e-9, 1.7635109088177348e-8, 2.2390549378068832e-8,
        5.424098214787799e-9, -1.6804462554740066e-8, -2.273038499612974e-8,
        -6.604718499642971e-9, 1.592843228517336e-8, 2.300881560054858e-8,
        7.767489787181892e-9, -2.6234063568672376e-8, 1.3828780196162226e-7,
        -7.808985757029548e-7, -1.2147037270889061e-6, 3.751757359144358e-5,
        -0.0002564117824582071, 0.0011067035285256745, -0.003557222361351279,
        0.009251369329897483, -0.02113696084123745, 0.04981274231069189,
        -0.03679515101557301, 0.0034170541291740847, -0.004090051507133073,
        0.003959280313123684, -0.002804528988872847, 0.0015820581951181195,
        -0.0007479833169849261, 0.00030856110959018215, -0.00011488868000827593,
        3.942306664645301e-5, -1.2533473962169391e-5, 3.625987984097424e-6,
        -9.251182726220447e-7, 2.3948055788042154e-7, -4.3346819534603617e-8,
        -1.188056339659807e-8, -2.232663208521625e-8, -2.0792000346304962e-9,
        1.889831472789965e-8, 2.1692028772841082e-8, 3.427748670322414e-9,
        -1.8160986604442084e-8,
      ],
    ];
    const result = wavedec(data, "coif11");

    const reconstruction = waverec(result, "coif11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif12", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4851138676578577, 0.89674637970963, 1.1765930082101363,
      1.29316836246468, 1.2472315971942614, 1.0698095017162539,
      0.8134095897713157, 0.5386419654005428, 0.2995491914076872,
      0.1312166279172658, 0.042637641226723644, 0.01648719995148354,
      0.015738367437306708, -0.004639420611457112, -0.08391828509610444,
      -0.24331443454802132, -0.4783226538831871, -0.7577059484960134,
      -1.0295163147336392, -1.2327756966195988, -1.312027789093043,
      -1.2312298619482647, -0.9835726561855571, -0.5947692239559471,
      -0.11891034004643489, 0.3722328081906899, 0.8040017627301688,
      1.1142968150147126, 1.2660768044821675, 1.2540252755002719,
      1.103901858875729, 0.8648565301753339, 0.5966681068352395,
      0.3550681726869474, 0.17873715654660854, 0.08110925594837287,
      0.04890968256728906, 0.04766980177713566, 0.032734741790031774,
      -0.0370819086994606, -0.18669754548956174, -0.4161064619409577,
      -0.698141901025823, -0.9833377278786538, -1.2108118033607154,
      -1.3225881220555615, -1.2778955852934937, -1.0639449109570862,
      -0.7005030925687425, -0.23705996830340098, 0.2568437674966679,
      0.7059144459284045, 1.0447040913203307, 1.2308736706201313,
      1.2530504937966223, 1.1315141718215371, 0.9116719080529003,
      0.6520119773424032, 0.4095342772930717, 0.22623143694155173,
      0.11989544272307112, 0.08142852333818654, 0.07921312188067739,
      0.0693426989506038, 0.009062517249117497, -0.13002670367928593,
      -0.3523942042414419, -0.6351323109415297, -0.9316229315282302,
      -1.1815407108367708, -1.3248360663008303, -1.3163311896883148,
      -1.1373707935682758, -0.8016461406857867, -0.3536931509213168,
      0.13968173828439592, 0.6030963824888127, 0.9682265322127654,
      1.1877326784142284, 1.2442501271044932, 1.1524056832895517,
      0.9535050579573512, 0.7042943323868344, 0.4626090297742975,
      0.27344363047052206, 0.1588296688556749, 0.11393975928064443,
      0.11027745021124113, 0.10505109363872202, 0.05429583798425286,
      -0.0736227077934109, -0.28758857865601406, -0.569107666654441,
      -0.8747522268143645, -1.1452080535406128, -1.3188117130482562,
      -1.3463319155183011, -1.2034043581768161, -0.8975598191338512,
      -0.4680640766003439, 0.0214941960366042, 0.4961919390330668,
      0.8853222521380892, 1.1368799198690747, 1.227616966708476,
      1.1663761033840836, 0.9900321523508527, 0.7531484362688338,
      0.513954727663881, 0.320111842557818, 0.19773822741304947,
      0.1463359960424826, 0.14077485537951487, 0.1397355472477164,
      0.09841064637999591, -0.01779715959341782, -0.22209156426498544,
      -0.5005110786078093, -0.8131342015745181, -1.1021023037706166,
      -1.3046079080328579, -1.367748293113264, -1.261648820426701,
      -0.9876404832740013, -0.5794417347683047, -0.09696377840009736,
      0.3858737698723966, 0.7964929982733042, 1.0785927203344166,
      1.2031941980115706, 1.1732673721536229, 1.0209587018294297,
      0.798222680786432, 0.5632366388864438, 0.3659695642642368,
      0.23644086280462118, 0.17850642850002957, 0.17062017616245181,
      0.17328076800835326, 0.14121208431697593, 0.03714924124256036,
      -0.15630187637567927, -0.4297952390906084, -0.7472027530559721,
      -1.0525525038930108, -1.282369275663344, -1.3804868329296138,
      -1.3117589799354583, -1.071323275654662, -0.6871146946795874,
      -0.21493443307871807, 0.2728384916003537, 0.7022810612925733,
      1.0131981492465676, 1.171075546689206, 1.1729651597027326,
      1.0460218946052544, 0.8391831510499107, 0.6101252345963334,
      0.41074719895591294, 0.27475148473979155, 0.21033691179412894,
      0.1997308332041481, 0.20558058253874995, 0.182518525355214,
      0.09092828210957393, -0.09061249502679086, -0.35741936595128315,
      -0.6774139793214583, -0.9969257518379748, -1.252290908068956,
      -1.384510342201656, -1.3534432933295868, -1.148085744871585,
      -0.7903957534660564, -0.33166230307623107, 0.15780218648082972,
      0.6032659029264936, 0.9410711905485458, 1.131405089321051,
      1.165400090707836, 1.064992756848045, 0.8757161195123842,
      0.6542984422165821, 0.45417366528025216, 0.31247896886862764,
      0.24171008666574084, 0.2280266346025541, 0.23653789531309788,
      0.22216213806938181, 0.1432656942119344, -0.025408282614723,
      -0.28384615129787255, -0.6042429619549452, -0.9356244590610441,
      -1.2146167302294801, -1.3798378678982508, -1.3864655851804955,
      -1.2174511769178147, -0.8886264220677222, -0.44639915928453133,
      0.04149576432842078, 0.5000605217264855, 0.8626325829791109,
      1.0843767269579054, 1.1505486819798942, 1.0776781164998337,
      0.9075304494692281, 0.6954439029523518, 0.4959780667849265,
      0.34942804151038104, 0.2725055623729309, 0.25542958155519363,
      0.2660645811955512, 0.2599893304195739, 0.1939024741378349,
      0.03893629466134202, -0.20953873592154726, -0.5281804631517819,
      -0.8690834015821929, -1.1696375545099418, -1.3665442683585538,
      -1.410646386690352, -1.2789916172984916, -0.9811812190803441,
      -0.5584089146986224, -0.07533978638092499, 0.3933075803224403,
      0.7783463427412189, 1.0302333223879105, 1.128433983590425,
      1.0839223543286673, 0.9343598896096408, 0.7332612176694002,
      0.5358914176922539, 0.3854002449723006, 0.3026001598434161,
      0.2818636801328447, 0.29408131668358883, 0.2958610765175632,
      0.24259606456102323, 0.10205932786981275, -0.13495772968684733,
      -0.4497295605947348, -0.7977665859402994, -1.117688839941334,
      -1.344759418488632, -1.4258638945357751, -1.3323305643213463,
      -1.067471743870748, -0.6669724552852152, -0.19195822659819609,
      0.2836753191848968, 0.6887169833080161, 0.969265504186055,
    ]);
    const expected = [
      [
        -1.7123464742497225, -0.9873217453332697, -0.26403020091646295,
        0.04629391622359094, 0.06916873682055229, 0.2527725116044005,
        0.843816124222216, 1.5611530052074538, 1.7905028610273974,
        1.1370307461403704, -0.16816669952589078, -1.390974785334799,
        -1.8555084380185152, -1.4559000396714505, -0.6765839271295929,
        -0.11839000104010605, 0.021679416244206638, 0.06143018402426205,
        0.42132938748217386, 1.1553026756548501, 1.7526056572826463,
        1.6904612005163597, 0.6142902788673461, 0.04339931242969849,
        1.2858482877313973, 1.8163158438828237, 1.5196081417395366,
        0.7587677336584996, 0.18668721154940784, 0.02297273890556538,
        -0.006476969603538725, -0.344114351822708, -1.0715559035190598,
        -1.7434082919261265, -1.7412219616088138, -0.8411307034262843,
        0.5264166852350277, 1.5758536682210467, 1.7734595525508705,
        1.2230918349742195, 0.5021422255356811, 0.11470580947053877,
        0.06741527968127574, -0.05244173842576709, -0.5884634016034297,
        -1.3906495506481915, -1.8704220593555048, -1.5046453228911378,
        -0.3352534227737349, 0.998313782959493, 1.740718238685721,
        1.6002026882922842, 0.9220841815859232, 0.3199395663048553,
        0.1151573216128131, 0.09806538486641266, -0.18388552783574952,
        -0.8982127276174492, -1.670950897287205, -1.8615734209356856,
        -1.133698844751717, 0.1975398082007053, 1.3692790931361791,
        1.7596354050499101, 1.3484597852637266, 0.6542279642203704,
        0.2246190715509335, 0.1559558652023393, 0.07678591015682125,
        -0.40671166813465026, -1.237086462376351, -1.8650814104512587,
        -1.701870764465165, -0.6619425656679501, 0.7017213693132123,
        1.6077910015070225, 1.6495049046829593, 1.0651127334997386,
        0.45270650925788053, 0.2069503498577972, 0.19761590558399653,
        -0.025168984579229666, -0.7078295551255216, -1.5586080246148952,
        -1.9342881858511725, -1.3967345664974886, -0.13712749098255428,
        1.1264112002432178, 1.7015735532358047, 1.443853643259291,
        0.7965368938512148, 0.33437787470685987, 0.24129336664598314,
        0.19970404444371354, -0.2210442332964698, -1.056704266739359,
        -1.813544021197495, -1.8551073400134237, -0.9717269205639029,
        0.3858518947035573, 1.4328785639849386, 1.6588232374426808,
        1.186784194013984, 0.5808842595948828, 0.29746131297779393,
        0.2907348474839122, 0.12859200956686215, -0.5054673144922722,
        -1.4098659184173807, -1.9579933029247023, -1.6236384313908705,
        -0.4690413276461376, 0.853146821311936, 1.6000484220126119,
        1.506127201057511, 0.9253177312005506, 0.4419119956463238,
        0.32247835876789166, 0.3141847082790643, -0.03593273786089694,
        -0.8545285913304721, -1.7177274525142694, -1.9607584342604645,
        -1.2567075383619764, 0.058683872205611755, 1.2199466980552471,
        1.6271215505648158, 1.2834418704112769, 0.7014189088959869,
        0.38538106185116977, 0.3762721386828374, 0.2742195084265949,
        -0.296332521950673, -1.22906953300568, -1.9325854364523531,
        -1.8087672978819926, -0.7897094295202572, 0.5562207795113192,
        1.4569704398503194, 1.5328960303611685, 1.0369928550440248,
        0.54502542103294, 0.398645490074727, 0.41834713484155744,
        0.14445945757762643, -0.6362605353836003, -1.580137682116853,
        -2.017621462706167, -1.506970318005427, -0.27787602234298897,
        0.9918050540690112, 1.3600458290124051, 0.3965651985800283,
        -0.9400420538017407, -1.8859089257895272, -1.9010039744058718,
        -1.1285063020234691, -0.19076703926856553, 0.34305962457104733,
        0.4158982046161056, 0.4279406406050181, 0.75786496442291,
        1.321384425233164,
      ],
      [
        -1.8348539226640466e-8, 4.667210822878875e-7, -4.8701086719361755e-6,
        3.206843198440986e-5, -0.00014883999639874224, 0.0005150817193642916,
        -0.0013685788325769376, 0.002816513667558382, -0.004421099859043211,
        0.005056210666113015, -0.005544148767723231, 0.0691163154522812,
        -0.0957295118414367, 0.045288828759770534, -0.02360348206837455,
        0.01176686598849946, -0.005402941029840972, 0.0022929389923251504,
        -0.0009215880801011183, 0.000359570020272554, -0.00013655694009020276,
        4.9371692697035134e-5, -1.651290144924702e-5, 5.013519316247901e-6,
        -1.3647964816581995e-6, 3.2878483669485694e-7, -7.342420927486952e-8,
        1.2834876125616256e-8, -2.230683136073219e-11, 2.9517435762493193e-9,
        7.622245155573699e-10, -1.8043306923648766e-9, -2.7515569381868527e-9,
        -1.1739750111992698e-9, 1.4794228878266325e-9, 2.7768771637898572e-9,
        1.5292116736382058e-9, -1.1200417630992007e-9, -2.7427285550848567e-9,
        -1.8515959114035235e-9, 7.365996683006602e-10, 2.6496716501389015e-9,
        2.1342099097703747e-9, -3.373418415941722e-10, -2.4997068219000783e-9,
        -2.3709858525177746e-9, -6.916290526879671e-11, 2.2960532239186846e-9,
        2.5568442749701588e-9, 4.741798310138509e-10, -2.043082390279045e-9,
        -2.687784157128718e-9, -8.690196371767047e-10, 1.7462383134282195e-9,
        2.7609931723183795e-9, 1.2451860214406223e-9, -1.4118851904743023e-9,
        -2.77490765300919e-9, -1.5946149697803084e-9, 1.0472080936565212e-9,
        2.729222202536601e-9, 1.909792755113812e-9, -6.600339410792239e-10,
        -2.6249154552453813e-9, -2.1839546867456458e-9, 2.5869316958239044e-10,
        2.464234199400955e-9, 2.4112055230313414e-9, 1.4820648411298616e-10,
        -2.250631477331184e-9, -2.586673425651346e-9, -5.519242181904387e-10,
        1.9886854217806907e-9, 2.706584392351022e-9, 9.437923330210091e-10,
        -1.6840252555160185e-9, -2.7683641009590433e-9, -1.3153805757219902e-9,
        1.3432024251296664e-9, 2.770684556956495e-9, 1.6587262397457842e-9,
        -9.735224705216836e-10, -2.7135001293809092e-9, -1.966444458602449e-9,
        5.829438038652801e-10, 2.5980333162136526e-9, 2.2319195909993172e-9,
        -1.798318538905942e-10, -2.4267691385155448e-9, -2.4494695398647066e-9,
        -2.2712979258204634e-10, 2.2033804013165e-9, 2.61440402229849e-9,
        6.292212778578116e-10, -1.9326669017648034e-9, -2.723193107406485e-9,
        -1.0177961731792495e-9, 1.620450748159711e-9, 2.7734860009638963e-9,
        1.3845082187647157e-9, -1.273426727988234e-9, -2.7642146753586165e-9,
        -1.7214919670726054e-9, 8.990484641546859e-10, 2.6955769378396093e-9,
        2.021493898960429e-9, -5.053665407409924e-10, -2.5690379816212506e-9,
        -2.278083502111813e-9, 1.0082960175789875e-10, 2.3873317473152174e-9,
        2.485743794741536e-9, 3.0586846066253756e-10, -2.154340032830188e-9,
        -2.6400098320229717e-9, -7.060075052896847e-10, 1.875084085435573e-9,
        2.7375854518722907e-9, 1.0909754772531235e-9, -1.5555575902573894e-9,
        -2.776357400934234e-9, -1.4525155221435124e-9, 1.20261837059939e-9,
        2.7555030905086596e-9, 1.782857717857926e-9, -8.238526098172082e-10,
        -2.6754677624469694e-9, -2.0749075626440006e-9, 6.337433986254459e-9,
        -1.2365471479817516e-7, 1.2798672335180441e-6, -8.14203996915337e-6,
        3.654187205317976e-5, -0.00012222384761098465, 0.0003132059262133519,
        -0.0006179329691239414, 0.0009122059203650429, -0.0009136872514400082,
        0.0008076161888038349, -0.016732340282896063, 0.02349238600587247,
        -0.010940862669719689, 0.005727908889675738, -0.0028954010061862786,
        0.0013538417549679256, -0.0005850475422694558, 0.00023844730703694999,
        -9.379624258183664e-5, 3.5784277146776755e-5, -1.2993042723297457e-5,
        4.375649007314414e-6, -1.3390226147618092e-6, 3.647321829508623e-7,
        -9.162684040663157e-8, 2.0502340175313105e-8, -9.470167642491833e-10,
        2.5172271415012477e-9, -7.237383555651612e-10, -2.610082196605898e-9,
        -2.1956355568594464e-9, 2.411022776550135e-10, 2.4560167329898957e-9,
        2.4199455871490047e-9,
      ],
    ];
    const result = wavedec(data, "coif12");

    const reconstruction = waverec(result, "coif12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif12_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5010684321335969, 0.9207621365366853, 1.195753573222078,
      1.2942972158125685, 1.2219072859942872, 1.0178640910129921,
      0.7435979583660756, 0.4660795935079071, 0.24060050951762513,
      0.09743186052715141, 0.03578074282096955, 0.026503319004370862,
      0.022700332601037487, -0.024773497815371193, -0.15115876753881308,
      -0.3654433350157328, -0.6452545723495863, -0.9405096805763583,
      -1.1850127189558681, -1.3130608844933722, -1.276759165740626,
      -1.0595021885905647, -0.6820313849256581, -0.19936951797072291,
      0.3107195514443628, 0.7649116437852246, 1.0928529211684386,
      1.252403233304536, 1.2378086265536121, 1.0788502977885184,
      0.8313471557779067, 0.5616101713692049, 0.3289800821288907,
      0.1710275349790581, 0.09524277372779599, 0.07929100509870687,
      0.07962149383411915, 0.045995350270406576, -0.06207665310891214,
      -0.2615054426597957, -0.538236477859229, -0.8484321042904941,
      -1.1280772988750003, -1.3086160740829955, -1.3345977347657314,
      -1.1787321671604178, -0.8503767819647454, -0.395144979464462,
      0.11439607750597591, 0.5946754252278017, 0.9697391251030385,
      1.1878794757412992, 1.2321314602745943, 1.1220870393152795,
      0.9067242047697992, 0.6502621228574638, 0.4148326829352398,
      0.24453957671282323, 0.15505765711372577, 0.13142092479186998,
      0.13445451395959396, 0.11400193618647547, 0.025289601232759196,
      -0.15606801366487494, -0.42456650225676756, -0.7435050746491723,
      -1.0523974534318274, -1.2813034636769745, -1.3684271086254916,
      -1.2764198025701865, -1.003111668350654, -0.583798557741654,
      -0.08437342669630972, 0.41305468862597905, 0.8284763656571738,
      1.101644498040182, 1.204674091019303, 1.1464876689758623,
      0.9681291761296257, 0.7303272450837275, 0.4966750428899455,
      0.3168912708047048, 0.214551239883205, 0.1824516412213397,
      0.18672211843393927, 0.17846135000814511, 0.10966954911750809,
      -0.05089935555293329, -0.3063317559107208, -0.6277923653876911,
      -0.9595846147399003, -1.2318713204593252, -1.3778465963279223,
      -1.3509354005691214, -1.137536115855633, -0.7619336375838133,
      -0.2820079904982066, 0.22327312241042385, 0.6714760162510147,
      0.9950226185335771, 1.1556279329329935, 1.1512860493205832,
      1.014174260748484, 0.8001956590502587, 0.5730315287887735,
      0.38696522510308207, 0.2730080199973944, 0.2319377084253334,
      0.23599701244981822, 0.23868255620154627, 0.1898961232080547,
      0.05229606922536395, -0.18564444634078064, -0.5035064900947077,
      -0.8515308023856873, -1.1614568214638308, -1.362900374988765,
      -1.401079364280419, -1.2512919549565562, -0.9263473251987311,
      -0.47494018079444994, 0.028718454091291673, 0.5014547903421073,
      0.8697239143812627, 1.0855797833399394, 1.1360569040773838,
      1.0437147098841348, 0.8583886578284988, 0.6424613404209392,
      0.4536203899467976, 0.32967751030849474, 0.2794288137144876,
      0.2818999159709169, 0.29407212866075366, 0.26492037638408134,
      0.1519053948347961, -0.0646033226626489, -0.3729655130026402,
      -0.7303695760957434, -1.071560396711537, -1.324072587163808,
      -1.4261015540975508, -1.34240498602051, -1.0740893099082063,
      -0.659681930074172, -0.16711933752021824, 0.32138684858346367,
      0.7278167598351422, 0.9955066912292828, 1.100730127961193,
      1.0558759428803741, 0.9035901434476058, 0.7035862898587165,
      0.5157107504155585, 0.38378227266869425, 0.3244696347611425,
      0.3240968273743931, 0.3441357818407488, 0.33382321993810893,
      0.24643234522502722, 0.05474353003764337, -0.23854885095825856,
      -0.5984331719619835, -0.9640136650501999, -1.2622743168889632,
      -1.4257121720569021, -1.4093198975223662, -1.2025159714876845,
      -0.8328890052073183, -0.36071200398368675, 0.13445072777281844,
      0.5716933490949707, 0.886763411820954, 1.045598663653659,
      1.0500761991672147, 0.934675981854915, 0.7551186164768343,
      0.5721053825346589, 0.43452757925813573, 0.3666005718783269,
      0.3622957490502858, 0.3884778449184084, 0.3958240794975588,
      0.33451908635974326, 0.17043387280422023, -0.10265292708453932,
      -0.45820669620694143, -0.8409416493965884, -1.1788227665171183,
      -1.4000840205277199, -1.4509272606552495, -1.3093387184785894,
      -0.9914228986176443, -0.5485580033722708, -0.05602794083969814,
      0.40402878540048043, 0.7610625815601626, 0.9713196744411734,
      1.026044185552381, 0.9507406274440163, 0.7958882683851751,
      0.6217095153708976, 0.48111260628214547, 0.40535948483610323,
      0.3962431129064443, 0.42679886897290126, 0.45028646035171693,
      0.4149646326748891, 0.2806238562924002, 0.03235247892139126,
      -0.3122802924817466, -0.7047200587262434, -1.0754131021230526,
      -1.3498461502597507, -1.466582122820566, -1.3926656536947304,
      -1.1324089706844795, -0.7272472473185376, -0.24663686866933776,
      0.22773444795647568, 0.6204478910260468, 0.878908867593949,
      0.983831256804073, 0.9511204050112334, 0.8248690698391266,
      0.6634861980029332, 0.5227430136266029, 0.44028452733145024,
      0.42572014052353196, 0.45889159328593987, 0.4967204821560782,
      0.48673958458573896, 0.3836173800061216, 0.16416637091462577,
      -0.16330022209738787, -0.557928508262081, -0.9540835705449998,
      -1.276069076685837, -1.4561138842349999, -1.4510357913171696,
      -1.2532897420632343, -0.8935243947959386, -0.43393957935265126,
      0.04590646561981962, 0.46726067279022576, 0.7697279551994289,
      0.9238177657769648, 0.9354128871714629, 0.8412031954620296,
      0.6964781351927125, 0.5586447141384239, 0.4709181319026636,
      0.4505393619205325, 0.4846355253090464,
    ]);
    const expected = [
      [
        -1.8874062171357764, -1.5953422166025484, -0.7611813275874123,
        -0.0877896444504104, 0.11260179747875182, 0.13469362382806238,
        0.46524808917916066, 1.1757024479110298, 1.750525614990842,
        1.5455279926425647, 0.43942163936079526, -0.9645307505734212,
        -1.8056319257175029, -1.675802827841016, -0.9126670471921434,
        -0.21346968217892476, 0.031499154571160946, 0.05178379918782695,
        0.3378632528148233, 1.0567815394292903, 1.7163397984091733,
        1.7185909693252794, 0.6341706280562365, 0.045038836592264396,
        1.3204154695866237, 1.8174697217777587, 1.4463815179399184,
        0.6560456102319505, 0.13894600048888459, 0.037126502055975445,
        -0.03494823033722712, -0.516831168774189, -1.330079359787347,
        -1.8569486981147478, -1.4983623571700952, -0.2819510773930775,
        1.0817484199214042, 1.7711656385019556, 1.5257247240508096,
        0.7942367218865406, 0.24186945914438496, 0.1121344136453589,
        0.06504724735723984, -0.36982454332264, -1.1998641875110807,
        -1.8506625990756815, -1.666979017483468, -0.5588193901798942,
        0.840998050705687, 1.6799152652959357, 1.5868707102671749,
        0.9196095141323732, 0.34583118572844984, 0.1858572531305098,
        0.16122308337470773, -0.2207135014241065, -1.051474959188451,
        -1.8120367349046693, -1.8051301961871178, -0.825615839108141,
        0.584147541689065, 1.5579605901101268, 1.6213784115962098,
        1.0328386959589309, 0.4481519329445167, 0.2580255844758316,
        0.2523824605279698, -0.07198255895675998, -0.8878324764907222,
        -1.7421291274584174, -1.910511165314161, -1.0775368848710056,
        0.31575587677334294, 1.4071744818947676, 1.6281643460673805,
        1.1316475546516522, 0.5472514696535942, 0.32800945195928716,
        0.3375481069950142, 0.07395781016880273, -0.712065706140212,
        -1.6425479879228841, -1.9814254386957386, -1.3100529516305164,
        0.04061402615084438, 1.2299753549656054, 1.6066270822109237,
        1.2139448828156783, 0.6415161079458412, 0.3951720172662245,
        0.41588079153017604, 0.21482666921780186, -0.527452886010693,
        -1.5154152447846854, -2.016812158730288, -1.51899167001462,
        -0.23634243480988745, 1.0292883322453994, 1.5566674761842711,
        1.277869436850016, 0.7293251379746787, 0.45886935738313395,
        0.4866814888130967, 0.34850796431040154, -0.3373590196748342,
        -1.3633211982603883, -2.0162614892108754, -1.7006143964506597,
        -0.510123809312159, 0.8084964872187945, 1.4786998115035686,
        1.321831451130751, 0.8090791917135886, 0.5184515001965874,
        0.5493906358000407, 0.4730814281404125, -0.14517316121139742,
        -1.189271084579672, -1.9800178095950776, -1.851684573862209,
        -0.7757781692735222, 0.5713829871714816, 1.3736534574042207,
        1.3445502907797948, 0.8792300292578874, 0.5732648807225287,
        0.6035847477659517, 0.5868486106381227, 0.04575331479534405,
        -0.9966246635958704, -1.9089707319878744, -1.9695266555918063,
        -1.0284829214863151, 0.32206514411600534, 1.2429648407169265,
        1.345087377285989, 0.9383111855199956, 0.6226563079007844,
        0.6489709509315206, 0.6883526396414238, 0.2321705096319003,
        -0.7890443452059674, -1.8045912741339396, -2.052188595887104,
        -1.2633666099982237, 0.06436793494221356, 1.0895709076154785,
        1.3212346452474648, 0.9873113058730014, 0.6634070920513264,
        0.6794327241315129, 0.6472005667703404, 0.7858393256259335,
        1.1915869681555298, 1.3056036244345564, 0.6611589106113595,
        -0.6138059265349408, -1.7723839659943825, -2.059264145209607,
        -1.3492764996731585, -0.23094156742396446, 0.5425169159957155,
        0.7024688432070212,
      ],
      [
        -1.5862601676356112e-8, 4.849121025414524e-7, -5.034942699834205e-6,
        3.321355449869636e-5, -0.0001544628885204627, 0.0005355700767863741,
        -0.0014259491233175059, 0.0029415383321999863, -0.004632468481742709,
        0.00533122746732744, -0.005893881495281224, 0.07180744520060009,
        -0.09937604242823309, 0.047054448046736204, -0.02451607433398577,
        0.01221135234005395, -0.005600870518312605, 0.002374373186517531,
        -0.0009535350673942947, 0.0003718528315185327, -0.00014118539476224324,
        5.103303584867675e-5, -1.7057734668511085e-5, 5.17851013015453e-6,
        -1.4114747101610816e-6, 3.3545556390319326e-7, -7.660064226266686e-8,
        1.61875230613553e-8, 3.932831107255439e-9, 3.9809839469962665e-9,
        -2.3802728459271022e-9, -6.082708052369884e-9, -3.8661986637664924e-9,
        2.1377621068682466e-9, 6.0489581622250735e-9, 4.0390464946103e-9,
        -1.9245494088255173e-9, -6.004270605664055e-9, -4.206616246512016e-9,
        1.708749328575315e-9, 5.9514774641072955e-9, 4.368508534858268e-9,
        -1.4906443655878953e-9, -5.890656065679969e-9, -4.524506493302112e-9,
        1.27052791988727e-9, 5.821887860624741e-9, 4.674401526598574e-9,
        -1.0486954867804874e-9, -5.745258692220322e-9, -4.817986698018488e-9,
        8.254470435062578e-10, 5.660878970801835e-9, 4.9550681735507715e-9,
        -6.010879514385628e-10, -5.568860989841059e-9, -5.085466576900421e-9,
        3.7591443251326265e-10, 5.4693288640776675e-9, 5.209004909293471e-9,
        -1.5023516927097807e-10, -5.362415394975917e-9, -5.325510790646124e-9,
        -7.564467332810186e-11, 5.248264203032917e-9, 5.434827495116502e-9,
        3.014243898301087e-10, -5.127031832184732e-9, -5.536814059161748e-9,
        -5.267965472676346e-10, 4.99888591158317e-9, 5.6313300593708035e-9,
        7.514597068614586e-10, -4.863985586110134e-9, -5.718245818643099e-9,
        -9.751091726364508e-10, 4.72252937213834e-9, 5.797441744081002e-9,
        1.197437192946041e-9, -4.5746933385135875e-9, -5.8688170407058846e-9,
        -1.4181588841937724e-9, 4.420691892079452e-9, 5.932277059109833e-9,
        1.6369573904397603e-9, -4.2607184581124685e-9, -5.987727633396063e-9,
        -1.853558835799385e-9, 4.0949983830453716e-9, 6.0350979773775844e-9,
        2.067642777415657e-9, -3.9237566025606834e-9, -6.074325640914899e-9,
        -2.2789497734019923e-9, 3.7472135956022734e-9, 6.105355942316299e-9,
        2.4871704684593323e-9, -3.5656176885384635e-9, -6.128150087472759e-9,
        -2.692049398650442e-9, 3.3792042472282648e-9, 6.1426711604497654e-9,
        2.8932837741167458e-9, -3.188242849329046e-9, -6.14890502799686e-9,
        -3.090615707447933e-9, 2.992966572068991e-9, 6.146842725605892e-9,
        3.283782641338349e-9, -2.7936610976331794e-9, -6.136483979631331e-9,
        -3.4725133095869454e-9, 2.5905774108346457e-9, 6.117841770409609e-9,
        3.656563017330761e-9, -2.384004041589058e-9, -6.090950457751869e-9,
        -3.835670491686832e-9, 2.1742150022553257e-9, 6.055837149858167e-9,
        4.009612061302622e-9, -1.9614825337018426e-9, -6.0125493333690764e-9,
        -4.178134858484311e-9, 1.746113980183985e-9, 5.961150469963821e-9,
        4.341023555534884e-9, -1.0083513053761691e-9, -1.71460997643365e-8,
        9.676734636940768e-8, -4.339280968886269e-7, 1.4404800369349227e-7,
        1.0187085234051997e-5, -7.337562630704344e-5, 0.0003156741174652637,
        -0.0010032806833397507, 0.0025726136497730306, -0.005745683019294199,
        0.012765511435861743, -0.009699951680261302, 0.001615202141972635,
        -0.001512187566693237, 0.001332223731756141, -0.0009292404821682207,
        0.0005333547237952677, -0.0002619392539999607, 0.00011403645775986958,
        -4.534443914033886e-5, 1.67718137459055e-5, -5.789641178002867e-6,
        1.8382198955750645e-6, -5.324606362314745e-7, 1.4654535348628366e-7,
        -2.936897891300415e-8, 4.3158153157601194e-9, -7.3374604317848974e-9,
        -3.544149361917604e-9, 2.2693274302085967e-9, 6.079434357089983e-9,
        3.911044549485559e-9, -2.0828926124488693e-9, -6.038186100373031e-9,
        -4.082892176660893e-9,
      ],
    ];
    const result = wavedec(data, "coif12");

    const reconstruction = waverec(result, "coif12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif13", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5046666407994466, 0.9284196829308946, 1.2078257686204634,
      1.31014068397807, 1.2390596386909638, 1.0317117060213055,
      0.74781273200296, 0.45385753682898766, 0.20645100615365153,
      0.03903890750887273, -0.044634410839222094, -0.06879849194355281,
      -0.07628826023170615, -0.1141606753909149, -0.2182292091293494,
      -0.4007270968677963, -0.6444887605633376, -0.9053300120454056,
      -1.1221536758938386, -1.2322656382349788, -1.1879862830242547,
      -0.9702482889062354, -0.595589401948295, -0.11459728791450766,
      0.39797796750141345, 0.8591125393439084, 1.1955374803516274,
      1.3594944012069339, 1.3383742295544685, 1.1559391143200555,
      0.8649513228712359, 0.533192645230434, 0.22650093566451684,
      -0.006842053004326332, -0.14644348278357747, -0.20233601333359633,
      -0.20925065909882534, -0.21431548165699876, -0.26157702393483984,
      -0.37755843640138903, -0.5617846926680636, -0.7848952864852929,
      -0.994967757257593, -1.1305084566736365, -1.1367916783768994,
      -0.9813057190181753, -0.6642362845351566, -0.22114362804032447,
      0.28304220377099787, 0.7673774603884524, 1.1524032190814213,
      1.37750959122231, 1.4139064630768854, 1.2700413785391413,
      0.988206039868332, 0.6332884718497915, 0.27659135761225273,
      -0.021153097830263035, -0.22329254968929688, -0.32395538439689353,
      -0.34640492077660245, -0.33368661169592995, -0.33420628472528197,
      -0.3861808911274358, -0.5051762485766449, -0.6781197530711813,
      -0.8654649673944002, -1.0110329186607803, -1.0570195853570363,
      -0.9602684861229136, -0.705523657677246, -0.31210435835494643,
      0.16790486209646188, 0.6596991106683538, 1.0816769967524782,
      1.3633716370778168, 1.460982709207252, 1.366689102402196,
      1.1094788057758451, 0.7473633189804064, 0.3530031496056542,
      -0.0035930402303288034, -0.2709374414645207, -0.42656194323449365,
      -0.47963228461165425, -0.46522128118699535, -0.4319458309549587,
      -0.42637868874870305, -0.4784584782708575, -0.5918321234233972,
      -0.7417495152807708, -0.8811322321316271, -0.9532745787625265,
      -0.9078671861411496, -0.7161202544455636, -0.3809442857796469,
      0.06062221174323809, 0.543580368539958, 0.9883763406419949,
      1.3183206930668407, 1.4767463308935218, 1.4396642906455293,
      1.2207912056529922, 0.8677326059711088, 0.45032422634601277,
      0.044092148286906885, -0.2870082638185918, -0.5042798557810888,
      -0.6010635614835702, -0.6010827653013046, -0.5490088900841248,
      -0.49590474288142855, -0.483502415097695, -0.5315397641860199,
      -0.6315471425620758, -0.7487614609691505, -0.8316930086462514,
      -0.8268397292824972, -0.6946608445854165, -0.4225467866110313,
      -0.03125534466839225, 0.42706119340708903, 0.8789605273767401,
      1.2455721297235254, 1.4603408229010666, 1.4842590293893259,
      1.3147960615690373, 0.9863016245050966, 0.5617966070259073,
      0.11822135892845786, -0.2711612655058173, -0.5528287704234984,
      -0.7035835995506826, -0.7331527921299555, -0.6783640487957369,
      -0.590624689094061, -0.5201350920628774, -0.5010755854724891,
      -0.5417097988559021, -0.6220275171081643, -0.6995496196014744,
      -0.7217558691918453, -0.6418338515178833, -0.4335419528282827,
      -0.10116745977599545, 0.3182030576052985, 0.7609163773118497,
      1.1501103351527049, 1.4129647095391829, 1.4975773458935713,
      1.3852485353468957, 1.0950845907331244, 0.6797497778429197,
      0.2134144417778693, -0.22510079560415186, -0.5697981754655623,
      -0.7812874038337745, -0.8535519885014108, -0.8121860272509992,
      -0.7047819279549203, -0.5861506137455247, -0.5023522909969298,
      -0.47777634267341956, -0.5086694174202382, -0.5647911804920451,
      -0.5987242806338047, -0.560337295892657, -0.4125227445827935,
      -0.14396455065596758, 0.22457199944899675, 0.6422781668090057,
      1.0383690934873426, 1.3377946814326622, 1.4787208934241607,
      1.4274065537262324, 1.1867167143065698, 0.796092563813912,
      0.32293723942085373, -0.15246994300881242, -0.5548018685337042,
      -0.8298586647308167, -0.9551450088892113, -0.9423573541990601,
      -0.8313666813880354, -0.677451573940756, -0.5352397465797635,
      -0.44361743439580265, -0.41556212962641803, -0.43552702677756305,
      -0.4650009669403973, -0.45470589043958853, -0.36013528985934296,
      -0.15623805404698288, 0.15275344242155464, 0.5311124400973098,
      0.9178190335805619, 1.2397818995629355, 1.428846555713876,
      1.4383348819727273, 1.2549264520898555, 0.9028319726477397,
      0.4391334355830364, -0.058616869993971615, -0.5095026338535263,
      -0.8468464254448169, -1.0319979601821294, -1.0609887771575681,
      -0.962565399638349, -0.7883117517890967, -0.5975733297629711,
      -0.4411873896197139, -0.3482758190319967, -0.319509180208933,
      -0.3285241048643454, -0.33102037222932384, -0.279037541575661,
      -0.1365390527063715, 0.10792988874585324, 0.43500075292579005,
      0.7964885993965564, 1.1253345269087442, 1.3510922776053111,
      1.4170933497110378, 1.294937667161369, 0.9925857440727739,
      0.553915530028673, 0.049748178209009467, -0.4375055451798892,
      -0.8318221493112445, -1.079758793724135, -1.1609250406483052,
      -1.0902617043255827, -0.9117432431660192, -0.6852927251838883,
      -0.4703989032316948, -0.31071875575568403, -0.22363537893516383,
      -0.197405151076705, -0.19651770901107973, -0.1737289428834028,
      -0.08547125527283922, 0.09354856427011199, 0.36055351282305464,
      0.6824492559380909, 1.0019068427356885, 1.2503758773749714,
      1.3647971605446576, 1.3037759079589477, 1.059055741601573,
      0.6592834599838767, 0.1649831963669738, -0.3441267354632598,
      -0.78640711638421, -1.0959362751217734, -1.2362036036252015,
    ]);
    const expected = [
      [
        0.400282123526832, -0.9393719620897588, -1.6076662092588823,
        -1.407096896666492, -0.7944835316433198, -0.3699257747035748,
        -0.29592512025039863, -0.20710235646778022, 0.32032067929242736,
        1.2232259665228873, 1.8927466713457515, 1.6907464941177734,
        0.5628219271336568, -0.8422789045059921, -1.6800978760586738,
        -1.58688811469534, -0.9116142705687869, -0.30827915716930615,
        -0.10854802279589014, -0.061854986860536074, 0.2894077400027067,
        1.0630503831067781, 1.7400886012411243, 1.7363570826765686,
        0.6383595935357974, 0.04545263540359368, 1.3316084768439083,
        1.8392886118715626, 1.4665688878068899, 0.6382956125982563,
        0.05664550421294062, -0.0977829898573539, -0.161311611300332,
        -0.5667440365117927, -1.2803247810051306, -1.7426874200958102,
        -1.3721382382604792, -0.1620650409400433, 1.2149686045802255,
        1.922615420208968, 1.634744772967405, 0.7540482704170285,
        -0.009676124190712, -0.2861463344263217, -0.3030878609695524,
        -0.5339482613241694, -1.1100095589826209, -1.5987803916132322,
        -1.3877758566782823, -0.3127443182079268, 1.0852356117410435,
        1.9480927461995168, 1.7961097424984882, 0.8956051459910582,
        -0.029914997817102947, -0.4581420984030154, -0.47190413205524906,
        -0.5461422537968892, -0.9590061515302416, -1.4298164653580554,
        -1.3580247165450186, -0.44138221662770794, 0.9329554291707225,
        1.9280986596466319, 1.9327902643206867, 1.0569313419475563,
        -0.005081326146368497, -0.603249685459405, -0.6579222455869912,
        -0.6029905244263609, -0.8369770154600895, -1.2461091526953323,
        -1.283918087370016, -0.5387365755793067, 0.7687387291990669,
        1.8643870035751435, 2.03599276520371, 1.227159220107289,
        0.06235571423090795, -0.7131594113726514, -0.8500593990261912,
        -0.7013152131692524, -0.7517107433704393, -1.0589086128586587,
        -1.1693279589077852, -0.5975713964307288, 0.6039557314564019,
        1.761504998605918, 2.099059249491284, 1.3948411341849016,
        0.1671902493317899, -0.781817944842845, -1.0368346221362161,
        -0.835269445771458, -0.7086278887237859, -0.8796797506550056,
        -1.0207169387427208, -0.6131209095583765, 0.45000707945193097,
        1.6265016339998934, 2.117894193261706, 1.548683480355276,
        0.30181359817403036, -0.8058163075405753, -1.207104798515775,
        -0.9967121612409194, -0.7104334230498183, -0.7193671887024654,
        -0.8467239975775139, -0.5833952601292213, 0.31759276718197427,
        1.4684756545375566, 2.091227142383597, 1.6782708722249322,
        0.4567022240091042, -0.7846083268350544, -1.3507790257509136,
        -1.1757300363514827, -0.7569433088231148, -0.5876935995910264,
        -0.6576106737346108, -0.509308211106102, 0.21602598984850097,
        1.2979921248639286, 2.0206941775256433, 1.774734008436898,
        0.6210284605227385, -0.7205455347330607, -1.4594655117286068,
        -1.3612730430682611, -0.8450963076025292, -0.4925363866374071,
        -0.4646032444386325, -0.3946186755607361, 0.15263591241013164,
        1.126404979109248, 1.9107330240546547, 1.8313184053337408,
        0.7833548817379087, -0.6187263785379582, -1.5270091727055999,
        -1.5418640028050556, -0.9691471347560613, -0.4394306456098497,
        -0.27915465618569674, -0.24572856343492785, 0.13237349189238337,
        0.964986065604899, 1.7685703126767625, 1.8432776406971474,
        0.933492592917236, -0.4891273293693553, -1.5438590735092195,
        -1.7519696141083843, -1.113379932352207, 0.2342994443860858,
        1.4971870751697265, 1.9303645990140381, 1.4168144341735536,
        0.5099299226560889, -0.12088231194974515, -0.27791647551699755,
        -0.3162684144817286, -0.6652444849110567, -1.2893996611589427,
        -1.6417959371933182,
      ],
      [
        5.737917479643796e-9, -1.272790600829281e-7, 1.4758906341449856e-6,
        -1.0732006662608853e-5, 5.540401392633196e-5, -0.0002152915066310732,
        0.000650616420805608, -0.0015533554946260248, 0.002927185520469612,
        -0.004240573876782593, 0.0044184569277575724, -0.004629871115202965,
        0.07110542701100216, -0.09949384718772096, 0.0476435855037209,
        -0.0255232164665199, 0.013268177914250407, -0.006423569252210173,
        0.0028891028693955796, -0.0012279282812891416, 0.0005038969611477917,
        -0.00020140619603415985, 7.750802286809879e-5, -2.8080564896726332e-5,
        9.392656107211908e-6, -2.8652890883593657e-6, 7.902249123247677e-7,
        -1.975000697788338e-7, 4.397605258659464e-8, -7.401991434804558e-9,
        2.315145437567338e-9, -4.817191543553576e-10, -1.1026655117494332e-9,
        -9.061102571480662e-10, 1.9309432174528382e-10, 1.1033196212066715e-9,
        9.506334024087366e-10, -1.1807495256686982e-10, -1.0730117282688593e-9,
        -9.940140233600183e-10, 4.2795752010238144e-11, 1.0383666084776915e-9,
        1.0333909436798785e-9, 3.265846515517254e-11, -9.99543058399623e-10,
        -1.0686045913158071e-9, -1.0797906731327817e-10, 9.566898012761456e-10,
        1.0995145126831054e-9, 1.828688588636333e-10, -9.099878449738466e-10,
        -1.1259967767175843e-9, -2.5701769045863676e-10, 8.596171537274033e-10,
        1.147942693601897e-9, 3.301358460987182e-10, -8.057853521753333e-10,
        -1.1652648569259246e-9, -4.0191799867156446e-10, 7.48707297396769e-10,
        1.177894630824257e-9, 4.720849551649979e-10, -6.886180257714844e-10,
        -1.1857824188926263e-9, -5.403502395059494e-10, 6.257508533192428e-10,
        1.188892791169846e-9, 6.064400251517182e-10, -5.603649455239807e-10,
        -1.1872135908910662e-9, -6.700861335570651e-10, 4.927223274014128e-10,
        1.1807532492234475e-9, 7.310364975106734e-10, -4.2309501890513486e-10,
        -1.1695378684323057e-9, -7.890397120791955e-10, 3.517639671113224e-10,
        1.1536128281980405e-9, 8.438658516132131e-10, -2.790177705883695e-10,
        -1.133041000766955e-9, -8.952937999355482e-10, 2.0514296194017485e-10,
        1.1079094090866621e-9, 9.431118882658014e-10, -1.3044410953233108e-10,
        -1.078311483000179e-9, -9.871344114924796e-10, 5.522538803331694e-11,
        1.044364662767909e-9, 1.0271806905249143e-9, 2.022330829907489e-11,
        -1.0062213857678504e-9, -1.0630938962522917e-9, -9.558657579767367e-11,
        9.640236220348514e-10, 1.0947159718159052e-9, 1.7057393691542386e-10,
        -9.179408699478748e-10, -1.1219398020670463e-9, -2.4485667682328396e-10,
        8.681614779196513e-10, 1.1446433280847392e-9, 3.1816406824852855e-10,
        -8.148870020904915e-10, -1.162732703718181e-9, -3.901890105636188e-10,
        7.58329990718829e-10, 1.1761405307933352e-9, 4.606457596023429e-10,
        -6.987226183179158e-10, -1.1848088188863325e-9, -5.292420442626507e-10,
        6.362870607591969e-10, 1.1887065194147709e-9, 5.95708200715109e-10,
        -5.713053316640079e-10, -1.1878200369596128e-9, -6.597749786292978e-10,
        5.040166762700861e-10, 1.182144902846696e-9, 7.211887874872756e-10,
        -4.3469515120955365e-10, -1.171713824987171e-9, -7.796885330963629e-10,
        3.636274889289978e-10, 1.1565628970720564e-9, 5.933226418077089e-10,
        6.652757114769572e-9, -9.35902527757894e-8, 7.626164233497396e-7,
        -4.401783689656867e-6, 1.8867097091498054e-5, -6.234807764314821e-5,
        0.00016228775636794847, -0.0003358773749177982, 0.0005526463895308804,
        -0.000729342981581403, 0.0009908149026643534, -0.0061415682824180005,
        0.00825344497366697, -0.004164749694176015, 0.002213443174606293,
        -0.0011100819291526545, 0.0005100070744822739, -0.00021622799541588152,
        8.712194456035502e-5, -3.443528048188953e-5, 1.346117987217828e-5,
        -5.092804925917141e-6, 1.804712553070264e-6, -5.862295257210158e-7,
        1.7401140391943697e-7, -4.514250353202536e-8, 1.0431711810101797e-8,
        -3.4680251463233097e-9, -3.406278558539153e-10, 3.141035979738312e-10,
        1.170220426855709e-9, 8.200098965208975e-10, -3.0985054403808864e-10,
        -1.1423141444733127e-9, -8.739604594279361e-10, 2.3651679016827935e-10,
        1.1190901505842862e-9,
      ],
    ];
    const result = wavedec(data, "coif13");

    const reconstruction = waverec(result, "coif13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif13_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49847141013754326, 0.9159491526799864, 1.1895017857391936,
      1.2877879052463155, 1.2166915819286452, 1.0157525872485174,
      0.7464574992702939, 0.4755487482879731, 0.25776598304982185,
      0.12253115846241552, 0.06800333460068109, 0.06394932031566605,
      0.06252434001115928, 0.01395234272655066, -0.1172076214693537,
      -0.3396813562220594, -0.6304306673802402, -0.9384367363236579,
      -1.1964678605009216, -1.3378479756765917, -1.3138827001071225,
      -1.1073757579997965, -0.7386425669847061, -0.262347332258444,
      0.24414525816726254, 0.6980203128341815, 1.0295346113511687,
      1.1971562414939445, 1.1955524177505648, 1.0545160864685674,
      0.8292710889762758, 0.5848193351645969, 0.37851073654497885,
      0.24543245488919074, 0.1904224890009436, 0.18872471144350528,
      0.19499040360998743, 0.15810452511923961, 0.037759928352954775,
      -0.18177085617106026, -0.48448358644747697, -0.824179826074816,
      -1.1344609357415008, -1.3446928364749327, -1.3978465770140138,
      -1.2655787348364531, -0.956587989241078, -0.515996773443803,
      -0.015813771333930915, 0.4611679346927088, 0.8399915285619155,
      1.069989503048625, 1.1349584311577179, 1.0545857869531798,
      0.876935204495202, 0.6641118597819636, 0.47497876375841735,
      0.34952138554416456, 0.2989745771941977, 0.304262331413871,
      0.3230709182664837, 0.3035675526938309, 0.20099828352835714,
      -0.007380948152137912, -0.3131610474797338, -0.6760260846428756,
      -1.031776275545742, -1.3071863453196082, -1.4379284291930419,
      -1.3849401673405448, -1.1449766565700874, -0.752558708330695,
      -0.2727361415152265, 0.21355190899045534, 0.6278344454404183,
      0.9115521572461076, 1.038212191605342, 1.0172708348243584,
      0.8889218281098736, 0.7113322217779412, 0.5438161906947386,
      0.4304610373288915, 0.3885528005799302, 0.4048383098600779,
      0.4405532689039249, 0.44379810708006895, 0.36587388670770143,
      0.17711882265964196, -0.12210479674219082, -0.4983605624140146,
      -0.8910261148850587, -1.2257593916393437, -1.4321663210302815,
      -1.4611526415003238, -1.2974793308502441, -0.9642487249827831,
      -0.5181132455412886, -0.036382405687793995, 0.40071569855060163,
      0.728127791341797, 0.9098662772487945, 0.9452567456724575,
      0.866107546091964, 0.7257363520112637, 0.5829005580181512,
      0.4849802527595678, 0.45491509704478833, 0.48536246569063235,
      0.5415980702501542, 0.5723358048283355, 0.5255190329389633,
      0.3647912901223993, 0.08214560981708763, -0.29676489229854264,
      -0.7162536785374153, -1.1024118651650274, -1.3801843357419714,
      -1.491379338716536, -1.408994649827213, -1.1441622715259532,
      -0.743898773763388, -0.28020851263214425, 0.1666937129299904,
      0.5267745374897177, 0.7555333830338508, 0.8424794939513429,
      0.8107154509258949, 0.7079391556186136, 0.5914126565132275,
      0.5110020365350534, 0.49486148141839625, 0.5415959650842666,
      0.6209873818299427, 0.6830705962299886, 0.6731050114009542,
      0.5483949407226015, 0.2923889401862323, -0.0778260117898617,
      -0.5128031010855358, -0.9406566206455167, -1.2832179274632505,
      -1.4743611583654024, -1.4758308931517448, -1.2865169561183225,
      -0.9427920086752446, -0.5098204073463029, -0.06606382231908642,
      0.3150541889128543, 0.5816585911865928, 0.7139531603940077,
      0.7262052312094773, 0.659869540294359, 0.5698554503836897,
      0.5077228865532515, 0.506368673279505, 0.5703348477059005,
      0.6743492748821239, 0.7704985394533802, 0.802116716902773,
      0.7206621994400956, 0.5010266288568551, 0.15109524176207098,
      -0.2871395703381329, -0.7454072068884119, -1.144080486250814,
      -1.4104667953440242, -1.4958367104775823, -1.3868536183824385,
      -1.1084926563094548, -0.7177203457204687, -0.2895781134409787,
      0.10074539049803238, 0.39526275899062674, 0.5655581341583985,
      0.6171161128732301, 0.5846736453099703, 0.520019592453097,
      0.4756400155428746, 0.4886766351454865, 0.5695520043817276,
      0.6983496978304254, 0.8299557559744069, 0.9066179753347223,
      0.8745820542508935, 0.7003454163836955, 0.3821271848280583,
      -0.0466261255453429, -0.522813250306883, -0.9670721413626212,
      -1.3016838209212385, -1.4684760014938214, -1.4421888471924111,
      -1.2359179109888658, -0.8972821472367635, -0.49634760827342117,
      -0.10844816490533488, 0.20366702969428974, 0.40379834299044753,
      0.48886911692110335, 0.48657039739905095, 0.44489713134772996,
      0.41652548615237506, 0.4423235410790435, 0.5384918156277566,
      0.6908438446737175, 0.857821183163294, 0.9814971328012765,
      1.0036761181451754, 0.882807616781438, 0.6071722636664105,
      0.20073479088696278, -0.2800493637320297, -0.7578339909608285,
      -1.1515510129005895, -1.394844218547884, -1.4511134399334682,
      -1.321373886457891, -1.042980388708305, -0.6796158042940199,
      -0.3051834727662351, 0.014209136929018151, 0.2355371301616559,
      0.3475366446213015, 0.3706653645308722, 0.34854704035658185,
      0.3333483752293953, 0.3691277290463753, 0.477713514803305,
      0.6509807951298194, 0.8516799169008757, 1.0226831691801872,
      1.1022574188931455, 1.0413379920951853, 0.8182033431577571,
      0.44658556400680166, -0.0250652149912646, -0.523152992679167,
      -0.9650343711212641, -1.2776255452672733, -1.4138333231943574,
      -1.3626752755787113, -1.150577163593227, -0.8336086214076937,
      -0.4827471150682673, -0.16603757323299267, 0.06772216818696164,
      0.1995886320050212, 0.2427304867835613, 0.2359180823224087,
      0.23014813089301134, 0.27211728103063587, 0.3890813504910983,
      0.5792570064134936, 0.8104404364983118,
    ]);
    const expected = [
      [
        -0.022364049610437167, -1.3528197077829034, -1.9768535874032944,
        -1.6043700415872968, -0.6851632589192046, 0.053400602912001535,
        0.275758073154721, 0.26929806957277086, 0.5352950015182285,
        1.1727664949343117, 1.6907661315630818, 1.4559829723861106,
        0.345269665759874, -1.044586755206148, -1.85814196753546,
        -1.6919850241068075, -0.8917314463802717, -0.16541637028474146,
        0.08776890774880489, 0.09742668543365697, 0.36200349650233266,
        1.061076944303394, 1.7085861868937533, 1.7101328973815093,
        0.6304522595822175, 0.04494143536972038, 1.3137481303713692,
        1.8078362537420491, 1.4439108069741284, 0.6690139759595184,
        0.17470399596598885, 0.08995677452387606, 0.019865846339429394,
        -0.48041193288879636, -1.3271448274026774, -1.892003385091945,
        -1.5660657655604118, -0.37101515753181663, 0.9871497930411248,
        1.6930345931043331, 1.491310951511357, 0.827059435516303,
        0.34709390625609826, 0.2668970461932748, 0.22359356350026252,
        -0.2570628099559503, -1.165566287586382, -1.9016828463656865,
        -1.7897986111325428, -0.7297296354254226, 0.6521899475639552,
        1.513193666874489, 1.4914095228727227, 0.9391959992532471,
        0.49429788371936645, 0.43029191533024735, 0.42930934989278835,
        -0.010438236933012695, -0.9560452571488716, -1.8486406578704677,
        -1.9586011677654096, -1.0642787320705602, 0.30200800572958364,
        1.2891294236152324, 1.4386382114784633, 1.0059756756324048,
        0.6087638370462146, 0.5725278281134327, 0.6276253017416915,
        0.25048384116445394, -0.7047882660635535, -1.7334855556109938,
        -2.0663818823047952, -1.3636536246208935, -0.05145249181181701,
        1.0297281976442325, 1.3367949098986849, 1.0263461919824082,
        0.685865650957671, 0.6864061814080198, 0.8094050571548205,
        0.5158927898948886, -0.419688935292067, -1.5590458107683494,
        -2.109128887414367, -1.6180898021742718, -0.3962746791294358,
        0.7449716951794485, 1.191445926587554, 1.0011771554867606,
        0.7226660105291539, 0.7659323589349508, 0.9660077009677801,
        0.7755475626360657, -0.11006260117168605, -1.3302893501713307,
        -2.085061545916303, -1.819409727765363, -0.7209949347276602,
        0.4455539067534127, 1.0096822425209342, 0.9331964535671304,
        0.7180285921897609, 0.8065752765345989, 1.089649483996001,
        1.0191702562296432, 0.2136809402873242, -1.0541649811832596,
        -1.9947012711351753, -1.96130719631207, -1.015009847198995,
        0.1424754974626599, 0.7998199837985389, 0.8268533990501585,
        0.6726565609231304, 0.8054681689204216, 1.1737346859775875,
        1.2368458023860192, 0.5404094474798098, -0.7393695888813051,
        -1.840858913316235, -2.0395630273385907, -1.2689485821882163,
        -0.15336886578414002, 0.5710570932479341, 0.6881144553410798,
        0.5890559917594124, 0.7615424287695804, 1.2131423510313748,
        1.4194123783342623, 0.8586712500827962, -0.3960496080356741,
        -1.6285390600264975, -2.0521843073851618, -1.4749970112967261,
        -0.4315946066914856, 0.33309980741176776, 0.5241999620328152,
        0.47142592432638164, 0.6755883287059515, 1.2044597046998589,
        1.558818786482774, 1.1571418498588275, -0.035527629059888675,
        -1.3645542296336404, -1.999962208274062, -1.6260911142727894,
        -0.6847751144299891, 0.09938650014189584, 0.33752541484464654,
        0.33378545156616846, 0.5404442586922342, 1.126215310272567,
        0.853378495871991, 0.37132167686906226, 0.3398190058323198,
        0.27943744972466245, -0.2336116800441482, -1.1793556444487625,
        -1.9269653763991943, -1.8068758179325743, -0.7398411710098988,
        0.63156585398389, 1.4726744961962521, 1.4462923936202052,
        0.920625870075956,
      ],
      [
        5.605710884576562e-9, -1.2541220418907764e-7, 1.4581745209037477e-6,
        -1.060451539806723e-5, 5.476668566076857e-5, -0.00021290469057627664,
        0.0006436928290683037, -0.0015375993970139351, 0.002899273290878415,
        -0.004203992195911391, 0.004388932421474996, -0.004610707056280467,
        0.07032435506433907, -0.09838213878674401, 0.04712131224079761,
        -0.025241976261432184, 0.013119541560470217, -0.0063500653469330945,
        0.0028553454015186725, -0.0012133421627807581, 0.0004978486682125505,
        -0.0001989746748889683, 7.656804706969655e-5, -2.7737614607239474e-5,
        9.277287371715238e-6, -2.8300707559144057e-6, 7.800122667783285e-7,
        -1.9505496891969992e-7, 4.3721655946443154e-8, -6.956123242040376e-9,
        2.3184985133702217e-9, -8.066263609920986e-10, -1.4549193441534018e-9,
        -9.180403332060784e-10, 5.480682236151547e-10, 1.4739286954068483e-9,
        9.548484992464678e-10, -5.004599753664487e-10, -1.465073473283283e-9,
        -9.93203587778137e-10, 4.5248794118731316e-10, 1.4545212193856413e-9,
        1.030418205402958e-9, -4.0399509898027396e-10, -1.4422972182193092e-9,
        -1.066447525962537e-9, 3.5503739194536724e-10, 1.4284135802346482e-9,
        1.1012522865751422e-9, -3.0567326300839626e-10, -1.4128867784819153e-9,
        -1.1347891392042316e-9, 2.55953779616668e-10, 1.3957388452633074e-9,
        1.1670206972905461e-9, -2.0594168398047937e-10, -1.376983201385887e-9,
        -1.1979100891803943e-9, 1.5569339928314037e-10, 1.3566435406376301e-9,
        1.227424871591598e-9, -1.0526899321709041e-10, -1.3347458910982312e-9,
        -1.2555276697190835e-9, 5.471918965212401e-11, 1.3113128799863014e-9,
        1.2821831680694763e-9, -4.106584039012034e-12, -1.2863716341906115e-9,
        -1.3073655125600765e-9, -4.650763947737488e-11, 1.2599525218444333e-9,
        1.331047050906971e-9, 9.706851507094526e-11, -1.2320793910756697e-9,
        -1.3531977753438232e-9, -1.4752166758527447e-10, 1.2027978427860116e-9,
        1.3737878393098658e-9, 1.9780499409526834e-10, -1.1721236481074623e-9,
        -1.3928016357558176e-9, -2.4785934974489224e-10, 1.140112911891939e-9,
        1.410213117904987e-9, 2.9762329084996114e-10, -1.1067773194508408e-9,
        -1.42600690574622e-9, -3.4705166726393784e-10, 1.0721829608456816e-9,
        1.4401557568913565e-9, 3.960763673553659e-10, -1.0363447293663606e-9,
        -1.4526520215312412e-9, -4.4465314525620323e-10, 9.99325435767509e-10,
        1.4634727711516129e-9, 4.92707041308134e-10, -9.611425357806328e-10,
        -1.4726180438115453e-9, -5.40204722689297e-10, 9.21870443201799e-10,
        1.4800649367969177e-9, 5.870762920697117e-10, -8.815261933420536e-10,
        -1.4858112111273647e-9, -6.332787938082979e-10, 8.40178868736161e-10,
        1.4898470772142462e-9, 6.787445519758367e-10, -7.978518349405495e-10,
        -1.4921731965196649e-9, -7.234345006061417e-10, 7.54622156830121e-10,
        1.4927821565972786e-9, 7.67290164591284e-10, -7.10511355630287e-10,
        -1.491673557841411e-9, -8.102696441460535e-10, 6.65596263935242e-10,
        1.488848891331085e-9, 8.523087037794412e-10, -6.199018415657102e-10,
        -1.4843147059525074e-9, -8.933731849996582e-10, 5.735086573857421e-10,
        1.4780743917711396e-9, 3.832914687016351e-10, 1.0055074945955153e-8,
        -8.423595873056371e-8, 2.4005664495309947e-7, 1.1921513211724008e-6,
        -1.7371165230663756e-5, 0.0001066944645456817, -0.0004496172730555181,
        0.0014629559270293144, -0.0039016151852967634, 0.00895618901719413,
        -0.018915877982610328, 0.042651150927371005, -0.03089559598838248,
        0.002176077956313833, -0.0028158652028056302, 0.003120762288477149,
        -0.00250396014670378, 0.0016123839292579514, -0.0008787938432520241,
        0.00041986628443036465, -0.00018094580810695698, 7.194137193109719e-5,
        -2.672295244970803e-5, 9.281375016720702e-6, -2.9947135519474458e-6,
        8.909907312959826e-7, -2.3997756200631453e-7, 5.8558199205155795e-8,
        -1.4401884935827805e-8, 1.4909630186984396e-9, -1.4253388501791955e-11,
        1.5069759283783827e-9, 1.0523835903965228e-9, -3.631083059453192e-10,
        -1.4310906495475354e-9, -1.0950807079516987e-9, 3.14582456464403e-10,
        1.4158033211763773e-9,
      ],
    ];
    const result = wavedec(data, "coif13");

    const reconstruction = waverec(result, "coif13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif14", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49059708184780415, 0.9023725618931018, 1.1740426820646996,
      1.2750201270070853, 1.2109413602132217, 1.020272858523239,
      0.7629949025313678, 0.5043834963369729, 0.29814313050586544,
      0.1732677995264187, 0.12799519738242693, 0.13233509333492474,
      0.13838955985754298, 0.09563027621714981, -0.03300840483835932,
      -0.25858192914147565, -0.560570644684823, -0.889906563849572,
      -1.179944757781624, -1.362635998988324, -1.3857673027134434,
      -1.226816967680646, -0.8998063264880338, -0.45330721220316883,
      0.03997698743630379, 0.4994824954858709, 0.8548388909613898,
      1.061188301452813, 1.1079687087363763, 1.0190527964389513,
      0.8443639521548141, 0.6452800740512238, 0.47771642818871013,
      0.3773422575581413, 0.3507881362370186, 0.3751001308202959,
      0.405511373795191, 0.38940215946104073, 0.2826800187281613,
      0.06415940795188546, -0.2559725666367117, -0.635983480009432,
      -1.0109314953034332, -1.3074954631913347, -1.4615692060807048,
      -1.434136160826461, -1.2213465798446574, -0.8561823216519416,
      -0.4012364052095696, 0.06559805038925398, 0.46892884609504126,
      0.7526775204904556, 0.8917030739429892, 0.8953944672777174,
      0.8024762921681668, 0.6685441249247299, 0.5497140145073389,
      0.48675020024209636, 0.493873754487103, 0.5551965892682145,
      0.6296996627791167, 0.6634103197906223, 0.6055224443818327,
      0.4241436103056392, 0.11742312046328557, -0.28300273432274675,
      -0.7173228865110215, -1.1104167520293133, -1.389091342039119,
      -1.4993491285659624, -1.4193054003261503, -1.1644657982157176,
      -0.7840173672491895, -0.3490775598095279, 0.06410752890282034,
      0.39175111962843795, 0.5964640994335898, 0.6740812907091904,
      0.65177661139188, 0.5781364927830752, 0.5079445039759934,
      0.4857878276253856, 0.5328762322984351, 0.6405953126451752,
      0.7725258710682721, 0.8744179394376365, 0.889496682802908,
      0.7750496007291727, 0.5158736449891781, 0.1309457514424043,
      -0.328581240369391, -0.7897136400261701, -1.1737762048223899,
      -1.4143664493787864, -1.4725889924479496, -1.3457333903277016,
      -1.0672269120541364, -0.6979200102365298, -0.3109707795363337,
      0.025785799196959447, 0.2654857538447799, 0.3919546389154204,
      0.42112002945973714, 0.39391981230025563, 0.3627278440374776,
      0.3750021454259614, 0.4585708062574814, 0.612523390294285,
      0.806188434919138, 0.9865389518247124, 1.0921356863350966,
      1.06997488302598, 0.8908090485657905, 0.5588657691076617,
      0.11331080565088555, -0.379079761830081, -0.8383065548055918,
      -1.1890338723322484, -1.3775040445365052, -1.3832448540127866,
      -1.2226645817810855, -0.9437048384476242, -0.6130062743207063,
      -0.2989451006249905, -0.05492720686949182, 0.0927831624342792,
      0.14964057129147224, 0.14874798991977728, 0.13935712578074214,
      0.17110318372008998, 0.27825040361582404, 0.4682152402189766,
      0.7175052987282087, 0.9762584812330998, 1.1802975282627348,
      1.2676220405442564, 1.1950635026019276, 0.9507423743258869,
      0.5590151044130278, 0.0765129556419797, -0.4198413009631742,
      -0.8498901814093032, -1.1481167864666832, -1.277872251349498,
      -1.2384274601802714, -1.0631661285486307, -0.8095096208517927,
      -0.5432764058971742, -0.32158407459796073, -0.1787367265764796,
      -0.1187209076141238, -0.11617479141723955, -0.12545740723791007,
      -0.09531114720744915, 0.014862283062615167, 0.221520896227817,
      0.5099770321636992, 0.8358531175214053, 1.1347631547940689,
      1.3378160565706692, 1.388986385177536, 1.259870624281193,
      0.9579824100982264, 0.5263757623530184, 0.03459886622733445,
      -0.43680042471549096, -0.8143469357524646, -1.0477650259708824,
      -1.120148682252416, -1.0497071805428102, -0.882792899951478,
      -0.6801586847424321, -0.5001186951748856, -0.38305229009724073,
      -0.341298553611711, -0.3570440615603525, -0.38868656353998243,
      -0.3839159129410709, -0.2959756025501866, -0.09871765042236302,
      0.20363716804107623, 0.574749529214916, 0.953049185263298,
      1.2656248099104943, 1.4456342760936702, 1.448804046446363,
      1.26478274469165, 0.9204076853452227, 0.47400061392397697,
      0.0020981511549544862, -0.4180489122439073, -0.7258041906980492,
      -0.8899652473118123, -0.9139205339176502, -0.8319822297559808,
      -0.6980165787994986, -0.5694747542313243, -0.49109335523159614,
      -0.4825831085537715, -0.5335465523272114, -0.6069430085859561,
      -0.6501542442828251, -0.6106880963157051, -0.4523163937393467,
      -0.16730238752289694, 0.21863002177336915, 0.6500556342530941,
      1.053535986708163, 1.3543630650352252, 1.4941492180221716,
      1.4448026559757625, 1.2153292538679934, 0.84972326190317,
      0.41648107345264074, -0.007594213449413356, -0.35518590405525424,
      -0.5833617152881367, -0.6818622668746758, -0.6727997316047013,
      -0.6020245284603336, -0.524578267823299, -0.4881725027405141,
      -0.5191207939881061, -0.6144808744844994, -0.7425106062505172,
      -0.8513379198709723, -0.8835662300408431, -0.7929517710047705,
      -0.5587123709701859, -0.1936106375544152, 0.25645132224414,
      0.7213965063569935, 1.1223467122132997, 1.3895819115095094,
      1.4785719002906732, 1.380040404601683, 1.1215375748142018,
      0.7601629495024886, 0.3683370589721663, 0.016282228883903127,
      -0.24431348339268844, -0.3913197708870838, -0.4351561085473662,
      -0.41314176358409155, -0.3768500751316573, -0.3759315665230381,
      -0.44277761286552575, -0.582157327118199, -0.768638421026953,
      -0.9525433480067228, -1.0729324409000245, -1.074235723569255,
      -0.9221632182336221, -0.6146702833817359, -0.18500414230007434,
    ]);
    const expected = [
      [
        1.2610585807438612, 0.6631655339607834, -0.5674339659031903,
        -1.7272448975357306, -2.0669709936090825, -1.4296730313448431,
        -0.3619998754151719, 0.3997699166049718, 0.573479682850174,
        0.49608934885000505, 0.6755930102339819, 1.1941111221028828,
        1.5669037540139237, 1.2089268022278323, 0.056529868573402954,
        -1.2725016513399743, -1.9598121101904373, -1.6686010435586176,
        -0.7929583794266859, -0.046311424944279, 0.19502359385128026,
        0.18232097973840736, 0.4190047711005804, 1.0846370521167719,
        1.7002557941245553, 1.6882724420378625, 0.6201645372627737,
        0.04432566714258994, 1.294440218865441, 1.789576079786283,
        1.4506717282253623, 0.7094394541443447, 0.24670104586600894,
        0.18653749446005782, 0.13543161757799513, -0.3657386613206614,
        -1.2585079661698015, -1.9270598845776166, -1.7349810145568603,
        -0.6410732206689225, 0.7063749197092642, 1.5007468881644443,
        1.4411582855588354, 0.9125638322964923, 0.5336425382799379,
        0.5304716921941529, 0.5506978150809304, 0.09073510489167419,
        -0.8994164628156981, -1.8490778167382358, -2.0281748089397458,
        -1.2108246512020446, 0.0927696524755932, 1.0644467575772099,
        1.2662789993545336, 0.9454641685652928, 0.6883687346669841,
        0.785166546271206, 0.9382038716126431, 0.5998296460882819,
        -0.40022630501421175, -1.5703664305510971, -2.12039987234737,
        -1.6468033248083427, -0.49367021945915707, 0.5540197464474418,
        0.9532949035132097, 0.8176084690543035, 0.6870077342725541,
        0.9059385790869995, 1.2366137090762683, 1.0960856568510706,
        0.18518525767144028, -1.1168237400562928, -2.0002162148619966,
        -1.9031544119841226, -0.9870079439886339, 0.03646662692306513,
        0.5543075662313931, 0.5570867411037295, 0.5303331200012097,
        0.8662388857850746, 1.3951767654180647, 1.513172990950247,
        0.7903555502555801, -0.5360997403390964, -1.6815478283468048,
        -1.956203632662642, -1.3346001814721447, -0.4227722157380396,
        0.13121520670681813, 0.21036142478278058, 0.24197644301402096,
        0.662156342797707, 1.3806379844791765, 1.7926882816663041,
        1.3445527601214948, 0.10820565962837475, -1.2019262210398214,
        -1.807184268862947, -1.5035439581110437, -0.7683088613764592,
        -0.2527719027972228, -0.1642959655667587, -0.13479031698442645,
        0.31327785577591427, 1.1820748148898867, 1.8919576111188199,
        1.7817261237094983, 0.7444077420840297, -0.6177290846369498,
        -1.4817635099208162, -1.4845101313030515, -0.9618896365766348,
        -0.5417177437439992, -0.5049365541655196, -0.5429390908421753,
        -0.13960784007947766, 0.8128185791266045, 1.7898637709995797,
        2.04891833170899, 1.301653031582978, 0.0029672338726102654,
        -1.0264421301128819, -1.2924788140514543, -0.9871445125544076,
        -0.6945108833624087, -0.754548770406314, -0.9194569498429209,
        -0.6396719785042453, 0.30918954188332415, 1.489924880793228,
        2.113046088327937, 1.7187351136126008, 0.5889931826481594,
        -0.502308722954402, -0.9642988638077467, -0.8513912620849131,
        -0.6903801328212769, -0.8690073554499105, -1.2039730135529587,
        -1.121405192305281, -0.273800676469795, 1.0201921076743787,
        1.9652066753916988, 1.9515792564157495, 1.075224046314937,
        0.022657946711307508, -0.5527226120531188, -0.5855758773915519,
        -0.5290209483686921, -0.8288793968085331, -1.3348587723485767,
        -1.5470477613145546, -0.795837015852908, -0.3058374899594972,
        -1.3223746668724812, -1.503819955760227, -1.0947845524176207,
        -0.6223267329456134, -0.5346050129772726, -0.6147928907598521,
        -0.3457008555071057, 0.520955706008686, 1.586083714375518,
        2.0910180035921964, 1.5872377630191632, 0.3626769512103415,
        -0.790138612942951,
      ],
      [
        -1.4760217488351764e-9, 3.306527723487977e-8, -4.11636383536051e-7,
        3.276169945424563e-6, -1.859394444777925e-5, 7.999829539281367e-5,
        -0.00027018833288669096, 0.0007305838752353148, -0.0015927840064258827,
        0.0027755525580967547, -0.0037213681910616974, 0.0034839537734965265,
        -0.003439896227863667, 0.06820400969648437, -0.09631816455774152,
        0.04655128825942388, -0.02551408118964785, 0.013740446196473225,
        -0.006959751629515948, 0.0032929161779328463, -0.0014720370364089011,
        0.0006329414608435751, -0.00026471534847339993, 0.00010724675140632052,
        -4.141766791647651e-5, 1.4978376089478548e-5, -5.007562126799589e-6,
        1.5354064886090357e-6, -4.2991388409981825e-7, 1.0919822514440108e-7,
        -2.4638109049310146e-8, 5.303199215537016e-9, -1.0192130119283185e-9,
        -1.6154812190051529e-10, -2.370387586462991e-10, 8.573892853038208e-11,
        3.029315631172267e-10, 2.281831680566503e-10, -6.857118240798306e-11,
        -2.9866391415578407e-10, -2.384761649356517e-10, 5.3492805849902726e-11,
        2.934704056250352e-10, 2.4821512085170856e-10, -3.8285757209304015e-11,
        -2.875787466604438e-10, -2.573607984103713e-10, 2.299124947405953e-11,
        2.809965837091974e-10, 2.6589610061201747e-10, -7.639554781948703e-12,
        -2.737499029922735e-10, -2.7379284505031155e-10, -7.730108415085475e-12,
        2.6584759787595557e-10, 2.810385131510876e-10, 2.3080908724170276e-11,
        -2.5730993596227506e-10, -2.876159348164196e-10, -3.837708940918273e-11,
        2.4815679124169904e-10, 2.935034515617995e-10, 5.358351396655369e-11,
        -2.384191713233331e-10, -2.986916331026432e-10, -6.865843216904874e-11,
        2.2810736414442284e-10, 3.0316656586144233e-10, 8.357162469109071e-11,
        -2.1724919463233787e-10, -3.069207867539186e-10, -9.828327152826804e-11,
        2.0587317826537667e-10, 3.0993910370621514e-10, 1.1276360609696167e-10,
        -1.940133849989932e-10, -3.1222088290150797e-10, -1.269721462086179e-10,
        1.816816068627321e-10, 3.137564028285768e-10, 1.4087835971374988e-10,
        -1.6892341624315913e-10, -3.145420514205675e-10,
        -1.5445539866653686e-10, 1.5575041721267435e-10, 3.1458402843134784e-10,
        1.6765328947664876e-10, -1.4221683043151088e-10,
        -3.1386888211185326e-10, -1.8045838719123118e-10,
        1.2834560697784713e-10, 3.124021207788168e-10, 1.9282700845996014e-10,
        -1.1416021892497997e-10, -3.101969522387339e-10,
        -2.0474074544519498e-10, 9.971849712706803e-11, 3.072434990628063e-10,
        2.1616425439091263e-10, -8.501264740908866e-11, -3.035640613441001e-10,
        -2.2706855400916077e-10, 7.011687175551155e-11, 2.991607523897739e-10,
        2.374309691457312e-10, -5.50599447560983e-11, -2.9403821700160457e-10,
        -2.4723751638553555e-10, 3.986342010641089e-11, 2.8821545223135735e-10,
        2.564470264970329e-10, -2.4572489949762483e-11, -2.817116246663348e-10,
        -2.650432665719379e-10, 9.230408634904946e-12, 2.745277114862186e-10,
        2.7300752578588745e-10, 6.1445049380114286e-12, -2.666976629581309e-10,
        -2.803189450650478e-10, -2.1497832023789888e-11, 2.58222742819207e-10,
        2.8696846477072066e-10, 3.679761561120396e-11, -2.4913160523125474e-10,
        -2.929267756565643e-10, -5.201685535727734e-11, 2.394526469993524e-10,
        1.5579437754670018e-9, -3.2806747301635175e-8, 4.10479410034235e-7,
        -3.2667041193635654e-6, 1.854104133606149e-5, -7.977747713642011e-5,
        0.00026946249173802355, -0.0007286763399496766, 0.0015887576116308392,
        -0.0027688269766270837, 0.00371300425202866, -0.003477702297706718,
        0.003436040056693395, -0.0680169236320843, 0.09605083835172559,
        -0.04642428244205727, 0.02544440161784718, -0.013702575803381854,
        0.006940312528809104, -0.0032835831742044283, 0.0014678097355825723,
        -0.0006311061733171324, 0.0002639430466797869, -0.00010693280914823054,
        4.1295926553826736e-5, -1.4933973232320144e-5, 4.9928004534639e-6,
        -1.5308299715585208e-6, 4.284738444380876e-7, -1.0899475754172986e-7,
        2.4574042454064984e-8, -5.146517795123234e-9, 1.1487881592183025e-9,
        1.5725424988633092e-10, 9.964794328706399e-11, -2.221706022848436e-10,
        -3.058673983036781e-10, -9.476444125067753e-11, 2.0866752432794168e-10,
        3.092801128971153e-10, 1.0928793667138912e-10,
      ],
    ];
    const result = wavedec(data, "coif14");

    const reconstruction = waverec(result, "coif14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif14_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4870198709742103, 0.8986074361300718, 1.175364014449574,
      1.2861222735624722, 1.2334205189186602, 1.051026327535765,
      0.794240779866126, 0.5254833884120838, 0.29879706488110214,
      0.14713979968485913, 0.07559092045849852, 0.06208210015324181,
      0.06534846533354766, 0.03796391752414974, -0.058963514790781435,
      -0.24328273674197498, -0.5047737333649909, -0.8055172953600214,
      -1.0877010562553162, -1.2870125151805283, -1.3483357202014234,
      -1.2398510798900526, -0.9619941577634918, -0.5489728074701347,
      -0.06236432571182509, 0.4217377776379323, 0.8289692440663614,
      1.1024410743561908, 1.2142233314360624, 1.1698629373239622,
      1.004956308105531, 0.7747579222317874, 0.5395133486318279,
      0.3492351039683495, 0.23173690704714717, 0.18688472059634886,
      0.18842828356721697, 0.19284573943572753, 0.1528513753992635,
      0.03202979282523727, -0.1832330510038661, -0.4776766563501357,
      -0.8086314624792666, -1.1147998329673188, -1.330272463274297,
      -1.4003561621892442, -1.295296039727433, -1.0184589220313796,
      -0.6068869703686841, -0.12399809304800304, 0.35386162240607466,
      0.7537985629835771, 1.0217554548359669, 1.1332258807997024,
      1.09679169031982, 0.9497568042154385, 0.7471041672266413,
      0.5466409562226204, 0.39411294422718873, 0.31203548834431394,
      0.29501681736269514, 0.3126846637508709, 0.3193884627666301,
      0.26812329960251147, 0.12504194971272475, -0.11924085393477468,
      -0.44455090576345985, -0.8037056515743752, -1.132228104399529,
      -1.3629221627292445, -1.4417599447447764, -1.3411652576328383,
      -1.0673862885283947, -0.6600853657168342, -0.18417815711329463,
      0.28414462251117956, 0.6738559110765879, 0.9340411168655969,
      1.0437913221404647, 1.0147405917984895, 0.885777027063495,
      0.7113947123400453, 0.5467156317076372, 0.43300823432263463,
      0.38736535149988116, 0.39912202842251093, 0.43386661545962857,
      0.4439605025728328, 0.3828200324601359, 0.2192459274752908,
      -0.05194527718454689, -0.4058179206260459, -0.7909388125504322,
      -1.1399776056970987, -1.384773699605547, -1.47221091737327,
      -1.3770027020720548, -1.1082219478584503, -0.7079304872797216,
      -0.24219612874425792, 0.21335062054753454, 0.5899360454778426,
      0.8400860774694128, 0.9466497624728143, 0.9243210587664469,
      0.8134470887072305, 0.6678240684611525, 0.5396606364572579,
      0.46556410594918757, 0.45711131643770403, 0.49837803075847514,
      0.5510186548243109, 0.5655595344391526, 0.4959787849009175,
      0.3137933174715938, 0.0179743616924391, -0.3619574372317392,
      -0.7706039622638157, -1.1381257595479843, -1.3957306733260424,
      -1.4914633246567055, -1.4024342898030713, -1.1404782807284368,
      -0.7498308358145452, -0.29736557497084815, 0.14224651795874754,
      0.5028603926822555, 0.7407252503266188, 0.8425937164573687,
      0.8262171294369817, 0.7332747537596035, 0.6166648683315124,
      0.5254741165865762, 0.49149244999189323, 0.5207185235429551,
      0.5920123169500539, 0.6632225131222855, 0.6832056162980099,
      0.6066420754424889, 0.4078220484084831, 0.08980507171316054,
      -0.3135025300361123, -0.7430449824793945, -1.1268343025772545,
      -1.3957886171300533, -1.4993639122554223, -1.4171715221119743,
      -1.1637393385101815, -0.7852470298648765, -0.34902900845769813,
      0.07159471089288877, 0.4134692779728756, 0.6368329020984512,
      0.7324712716614752, 0.7211798332033021, 0.6458414735738437,
      0.5582659310619826, 0.5042294171281189, 0.5105765141760088,
      0.577697147806215, 0.6793086703717313, 0.769604867829645,
      0.795949578808821, 0.7138661597409918, 0.5004642762738606,
      0.1628070529056917, -0.2610341348007793, -0.708672760894689,
      -1.1063471545803056, -1.3850346103602558, -1.4958532294515159,
      -1.4210143794950534, -1.1776651972865864, -0.8136974489248152,
      -0.396564598674416, 0.0021456002216779235, 0.3226140262274823,
      0.5293147932074702, 0.617178778757808, 0.6100209612940801,
      0.5517977362319166, 0.49304959795658176, 0.47607466226944756,
      0.5226727985624007, 0.6276264770547698, 0.7596131026001322,
      0.8693446630790755, 0.90288115776192, 0.8167293749044744,
      0.5908543742649079, 0.23622084825516768, -0.20517510688698676,
      -0.6679607137988292, -1.076987553042759, -1.3636460880551264,
      -1.480966116738504, -1.4138534471077602, -1.1819956430109781,
      -0.8347633540689419, -0.4393925401557831, -0.0653697533074018,
      0.23114900746723593, 0.4191000744949547, 0.49765313166314257,
      0.49360629234692005, 0.4518577719687791, 0.42150836170792744,
      0.44123160437922243, 0.5277122319034848, 0.6701583186881119,
      0.8323392013521468, 0.9616799554091215, 1.0031367964210958,
      0.9143403233708834, 0.6781369492396966, 0.3092747158734873,
      -0.1465838719741982, -0.6214397346264933, -1.0391544820534415,
      -1.331888860522246, -1.4548313742393497, -1.3956712501728437,
      -1.1765531514212848, -0.848093435906969, -0.47698101643047874,
      -0.13024675930563928, 0.13992370081175398, 0.30713301322318876,
      0.37486370623754905, 0.37284833208384455, 0.3467936596315576,
      0.3442008176590259, 0.39999375145941396, 0.5257006186864304,
      0.7050197056658807, 0.8969728427700973, 1.0459142250271374,
      1.0959070486288325, 1.005845822436059, 0.7614748107671339,
      0.3811921519106724, -0.08594773032400918, -0.5696926179396302,
      -0.9933184310955454, -1.2901143626462122, -1.4176706140500275,
      -1.3665427856088042, -1.1612451327087816, -0.8534077449612898,
      -0.5088517019933343, -0.19181414602038804, 0.04977485012957472,
      0.19436462326025208, 0.24980402916253192,
    ]);
    const expected = [
      [
        1.4449804216548128, 0.5004359056396326, -0.8582677842885419,
        -1.8318252266637496, -1.8812893592414885, -1.1435775812304965,
        -0.2591306658563511, 0.2161644884269015, 0.26647783247877976,
        0.32772548580033745, 0.7629870536335208, 1.4212230082237414,
        1.7171704890003863, 1.1723415745520875, -0.08820253559475656,
        -1.3604487204032059, -1.9068753570863497, -1.538149930201404,
        -0.7140470840750771, -0.08302257398766634, 0.09173745893322904,
        0.10819248196502519, 0.4199628480004119, 1.128759786963547,
        1.73218120500443, 1.6898498642532012, 0.6158141626629928,
        0.04389061299095906, 1.2889684749784036, 1.8053956841218133,
        1.494095197032498, 0.7393124071391434, 0.20973678757926809,
        0.08718951857334896, 0.053877695240950735, -0.34410201212142943,
        -1.1391635785295475, -1.8201121196064698, -1.7534140336622541,
        -0.7763648028650986, 0.5964272853350883, 1.5590871190721325,
        1.6544360321126599, 1.0956731612092103, 0.4938930204924151,
        0.26429490643846903, 0.27272506012125464, 0.04529696740585763,
        -0.6755368058128443, -1.5765650430778362, -1.980402676709268,
        -1.4403184202802486, -0.17535978493344948, 1.0660321510534605,
        1.602623409879479, 1.3431589535144839, 0.7730670540574748,
        0.4412848195413873, 0.442202892185796, 0.3791836066638903,
        -0.16863203281034703, -1.136611432576199, -1.9274630069652736,
        -1.8966940967372763, -0.9335016765559421, 0.4018411788026102,
        1.320933615290792, 1.435059907245691, 1.006064050422329,
        0.6123661175969732, 0.5644437856050385, 0.6278549638638621,
        0.31006056412790745, -0.5739132071736742, -1.6121717907441404,
        -2.0820206460162867, -1.5672625088081065, -0.34251705005997274,
        0.8342955564368593, 1.3387649329305813, 1.150387905159111,
        0.7631953911712082, 0.6464530231993477, 0.7792580547362703,
        0.7014199242381233, 0.025419586098080853, -1.0897985746151104,
        -1.9738612476163269, -1.9833415929905653, -1.0604209375308369,
        0.20116695487296218, 1.047543695014274, 1.1684474699501903,
        0.872095820260946, 0.6950752885762927, 0.8372318476885752,
        0.9661986484280896, 0.576747471896259, -0.4433595297829759,
        -1.59358435321979, -2.1204207796425627, -1.6457759556184353,
        -0.49360155745648376, 0.5847338605279903, 1.03587080646007,
        0.9133577711064961, 0.7130880802598735, 0.8169871413468872,
        1.0883856417167497, 1.009559204811267, 0.2302439422910191,
        -1.0022146297048622, -1.958734730310301, -2.0096178078274978,
        -1.1507419679747266, 0.003034336912156498, 0.7485641593335113,
        0.8626999168304539, 0.6972774283767816, 0.7391709603994403,
        1.0742551518177308, 1.276866778491124, 0.8355942694799898,
        -0.290161418786488, -1.5230904039905784, -2.0944023677096943,
        -1.6715942690448162, -0.6213948895256218, 0.3268940612882927,
        0.7037878081861982, 0.6390233894155557, 0.6239957190657172,
        0.9477469831976078, 1.360020835566417, 1.2930724859299418,
        0.43738049769380916, -0.8788485007748705, -1.8835752905056358,
        -1.9737772093079335, -1.1993852425861669, -0.18419672929564573,
        0.4343516872770848, 0.5272870314429017, 0.486774123848435,
        0.7434504735111631, 1.268518999361351, 1.5498249606133296,
        1.0769404943284229, -0.12166038517997207, -1.404554239464075,
        -2.0052366966651953, -1.6417435362675954, -0.7202445489927435,
        0.07083685112162405, 0.35505089201652085, 0.2720040225788175,
        -0.2697736463774231, -1.2076814112774046, -1.9321925489268659,
        -1.824675460138157, -0.8055956844588573, 0.539062789980334,
        1.4224876688666164, 1.4791445274372856, 0.99704870059127,
        0.5656765539756845, 0.4904402995638816, 0.530137337254302,
        0.1978819953845995,
      ],
      [
        -1.343403962312578e-9, 3.2851126618801383e-8, -4.0868166581534326e-7,
        3.24897323126454e-6, -1.8424762097976785e-5, 7.920218132916176e-5,
        -0.0002672611155890007, 0.000721991045775453, -0.001572400117309088,
        0.0027363690879543766, -0.003660699713118609, 0.003407937441950647,
        -0.003337666653495466, 0.06749774917877673, -0.09535860432461699,
        0.04606271310170056, -0.02524763951660363, 0.01360136768863997,
        -0.006892482628153343, 0.003262714805952588, -0.0014591815158940527,
        0.0006276144559079347, -0.00026253858085552377, 0.0001063788652000373,
        -4.1088257606717225e-5, 1.4861691661942054e-5, -4.969484239797352e-6,
        1.5242461701194225e-6, -4.2681911995715113e-7, 1.0834789861914015e-7,
        -2.4619044504826483e-8, 5.231002697282253e-9, -9.042553197701136e-10,
        -9.350697280978066e-12, -1.9435926129302997e-10,
        -2.9568558342292264e-11, 1.4072840216510777e-10, 1.815917629008263e-10,
        5.200595070857681e-11, -1.2631466632513197e-10, -1.8622878864349778e-10,
        -7.157765349331866e-11, 1.1017019189273391e-10, 1.8864628111037237e-10,
        9.028740830680501e-11, -9.270330670501759e-11, -1.8879622749118647e-10,
        -1.0791267025874788e-10, 7.412700936246305e-11, 1.8668066001249008e-10,
        1.2424481923620494e-10, -5.465306939782981e-11, -1.8232447620251751e-10,
        -1.3908605255677362e-10, 3.453083823326002e-11, 1.7577733163021534e-10,
        1.5225298234748634e-10, -1.3991005824868082e-11,
        -1.6711883641905555e-10, -1.6359735640870576e-10,
        -6.7194494937217025e-12, 1.564551555127453e-10, 1.7297087760202906e-10,
        2.734658698692504e-11, -1.4391294413167895e-10, -1.8026685428849826e-10,
        -4.764446204290571e-11, 1.2964046423835673e-10, 1.854019763752281e-10,
        6.737161582747655e-11, -1.1381376362829964e-10, -1.883122061390866e-10,
        -8.629028568033882e-11, 9.66169254685352e-11, 1.889580667907037e-10,
        1.0417334121905355e-10, -7.826097551590968e-11, -1.8733575850266077e-10,
        -1.2080331498601906e-10, 5.896875523720294e-11, 1.8346301611482706e-10,
        1.3598546066988e-10, -3.8969344423458375e-11, -1.7738774756292142e-10,
        -1.4953338604347444e-10, 1.849438529174871e-11, 1.691832128049903e-10,
        1.612827300940625e-10, 2.202057880027329e-12, -1.5894457428414702e-10,
        -1.7109378421320548e-10, -2.2864428266703065e-11,
        1.4680207516801927e-10, 1.7885914120509455e-10, 4.3254228492405856e-11,
        -1.3289015603042614e-10, -1.8447460964720147e-10,
        -6.312828777304918e-11, 1.1739386219382112e-10, 1.8786825719371597e-10,
        8.224296454948918e-11, -1.0047806563444705e-10, -1.8900894326094583e-10,
        -1.0037286188664485e-10, 8.235697486046398e-11, 1.8788125348828474e-10,
        1.1729207345273548e-10, -6.32456771132221e-11, -1.8449888965477767e-10,
        -1.328023257711965e-10, 4.3377753745620124e-11, 1.789006231599349e-10,
        1.4672164847316466e-10, -2.2990273805949548e-11,
        -1.7115543056172883e-10, -1.5888086966057333e-10, 2.321171691461927e-12,
        1.613465441619384e-10, 1.6912848026924666e-10, 1.8369318541937974e-11,
        -1.4960565778785477e-10, -1.7735222531331079e-10,
        -3.884343336721883e-11, 1.360665805744749e-10, 1.8343321880865703e-10,
        5.884989703150182e-11, -1.209001000321941e-10, -1.8800284709552056e-10,
        1.0803390821857973e-10, -3.8447982603924665e-9, 3.9893571659141894e-8,
        -2.4021080580906587e-7, 9.232161424553486e-7, -1.9628421939374433e-6,
        -8.327138713248568e-7, 2.569910862398378e-5, -0.00012110508905484196,
        0.00037870183063560723, -0.0009313980017848845, 0.0019556896667399497,
        -0.0037447425250952938, 0.0030293999543177263, -0.00100702487456332,
        0.0007764337944406371, -0.0006303430703334092, 0.0004433315456764784,
        -0.0002674381130980866, 0.00014117051850802791, -6.698805244814393e-5,
        2.9376395423772754e-5, -1.215121308530995e-5, 4.770951243895128e-6,
        -1.7661813643051422e-6, 6.096742299938069e-7, -1.944091941170199e-7,
        5.6514005096497e-8, -1.5038172125273973e-8, 3.760060427980648e-9,
        -6.004181882604817e-10, 1.6722925589385648e-10, -1.7204023517637917e-10,
        -1.7485580242310117e-10, -4.2022077383302265e-11, 1.341315536114041e-10,
        1.8409239371704104e-10, 6.153317981129245e-11, -1.1870862827079218e-10,
        -1.8767249708162137e-10, -8.071258159591139e-11,
      ],
    ];
    const result = wavedec(data, "coif14");

    const reconstruction = waverec(result, "coif14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif15", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49746374981035524, 0.9201167150968721, 1.2080235885221722,
      1.327644352969012, 1.277432764418228, 1.0863394365598988,
      0.8057069583160215, 0.49658026749412076, 0.21550072647412816,
      0.0021601272278072847, -0.1282087584537592, -0.186011996764405,
      -0.20193199272100987, -0.21650569279867432, -0.26735308098034805,
      -0.3773280006762826, -0.5466268635163571, -0.7509131712497484,
      -0.9460333394886993, -1.0782702419818895, -1.0976991121074893,
      -0.97141094426648, -0.6933468406659489, -0.28825173046476954,
      0.1913725793922741, 0.6747831573720959, 1.0869105740887908,
      1.3635461050265287, 1.4643539219691184, 1.3807526153933483,
      1.1368996338811475, 0.7836164802577297, 0.3867305510158785,
      0.012592377234327545, -0.28584900368271243, -0.4792106757101737,
      -0.5658176933468647, -0.5690289653519828, -0.5285999856677458,
      -0.4883621947447776, -0.48336477290307844, -0.5297232850179159,
      -0.619729252801225, -0.7234637814340599, -0.7965445217235088,
      -0.7921091698004075, -0.6740700912217178, -0.42832334181001025,
      -0.06904877452181452, 0.3616100863785927, 0.8006216244248845,
      1.1764092768701873, 1.4236936166419913, 1.4974346381852202,
      1.3826492527492642, 1.0978178128798148, 0.69107574948621,
      0.23006052247308237, -0.2122474729450239, -0.5724370614412492,
      -0.8089343159842117, -0.9088872719363496, -0.8882289371706173,
      -0.7851112452877091, -0.6484731494173159, -0.5246408784197779,
      -0.44528759373400817, -0.4197033215796254, -0.4332377953551639,
      -0.45224340237452243, -0.43423472080530934, -0.34068491639256243,
      -0.1492114400373547, 0.13797341169349597, 0.4915853547644872,
      0.8595652929943134, 1.1773080658357153, 1.3815255182799766,
      1.4245322155477766, 1.2855899726364919, 0.9765974667289277,
      0.5407114805845525, 0.04412887108068131, -0.43714703710883057,
      -0.8325644606508444, -1.0908515446523073, -1.1893122873301056,
      -1.136567608476597, -0.9682702727044099, -0.7369736776194715,
      -0.49869240667116554, -0.29943438882045914, -0.16493615016253926,
      -0.09600937667662884, -0.07051001428780693, -0.051308891677051716,
      0.0018302536847997763, 0.11951790878210217, 0.31241614953203417,
      0.5660064158480114, 0.8418862915578551, 1.0854347259853885,
      1.2381141224916603, 1.2515145365345717, 1.0997722834055408,
      0.7873297437425621, 0.3500686842377082, -0.1506059342878031,
      -0.6394982004286114, -1.0425625831904854, -1.301684720877397,
      -1.3859625937231546, -1.2969660029827126, -1.0668613634947655,
      -0.7499545504596463, -0.40973065740373954, -0.10449371523185647,
      0.12501003823930762, 0.2631283266952836, 0.3203453689687542,
      0.3277673786044424, 0.32657966253501686, 0.35521528648817213,
      0.437515102340261, 0.5748984398844883, 0.7445669745202914,
      0.9042725939833094, 1.0025542396815679, 0.9919820682693987,
      0.8421713256089163, 0.5493328613542466, 0.13991463865269163,
      -0.33272691764163254, -0.7980350473724459, -1.1822250669995824,
      -1.4233738659741233, -1.4841878486332443, -1.359531315214811,
      -1.0770076347861468, -0.6904986255897516, -0.26820021679663997,
      0.12204287373528455, 0.42670346841734996, 0.6166491859136438,
      0.6911043478854404, 0.6747547413259386, 0.6089014419042702,
      0.538986048765051, 0.5016551862828296, 0.5146059707258108,
      0.571741136816668, 0.6448367942492212, 0.6913088029071093,
      0.6661470064221728, 0.535037438261146, 0.2853660686588968,
      -0.06772514553147785, -0.4818905037629301, -0.8948205691986663,
      -1.2366346517168365, -1.4446299936003237, -1.4769896051746194,
      -1.3222535802766844, -1.0023213464839182, -0.568247541745903,
      -0.08976741754902956, 0.359058541454998, 0.7148018479025742,
      0.9368318190119186, 1.0139826020096634, 0.964334635844658,
      0.8283622505311082, 0.6572635257667572, 0.4994056190875089,
      0.3882233276714183, 0.33450693045668917, 0.3249073472866184,
      0.326941821647223, 0.29917578101962466, 0.20397503279869492,
      0.019577034489152045, -0.25162262093813414, -0.5807663880025266,
      -0.916964059172838, -1.1975646081365534, -1.3619407475769254,
      -1.3655665029258808, -1.1910442885567123, -0.8534135740867166,
      -0.3983901117363363, 0.10616913077694191, 0.583696031405734,
      0.9642119715534033, 1.1980412258237907, 1.2648602702269773,
      1.1761103750628756, 0.9703644015813377, 0.7028886934815487,
      0.4319844752287147, 0.20541145484076895, 0.050120878998323015,
      -0.03232197142972876, -0.06365809641751026, -0.0808654771901163,
      -0.12423138238361531, -0.22463666384596725, -0.39331097632419504,
      -0.6167106143201728, -0.8579142312941513, -1.0643292599877305,
      -1.1799403046943229, -1.1591878422779316, -0.9791189779119676,
      -0.6468126573855679, -0.20016686573258402, 0.2983119203424104,
      0.7734260065515075, 1.15226459907685, 1.3788618148012248,
      1.4252146701881887, 1.2961847286278338, 1.0272329904488835,
      0.6756067588628865, 0.3071128172680707, -0.018386312587134135,
      -0.2593634872820317, -0.40006970153302523, -0.4514171291531295,
      -0.4452898579565002, -0.423857817850778, -0.4266652120022922,
      -0.4787817559385694, -0.583020402276542, -0.7182092698569189,
      -0.844004599812352, -0.9111089600739907, -0.8744073681066789,
      -0.7057813569396647, -0.40339136775083545, 0.004972839714333155,
      0.46547726214306245, 0.9081165429192242, 1.2607165274301648,
      1.4639008812123326, 1.4835944715523235, 1.3181851150777124,
      0.9986960659544915, 0.5819426239279619, 0.13827261412780661,
      -0.26326385031928445, -0.5688999683486236, -0.7501170795069304,
      -0.8074010916898099, -0.767101991082854, -0.6723574996278374,
    ]);
    const expected = [
      [
        0.9773286975458798, 1.955361325240778, 2.0134068213212957,
        1.132249959595513, -0.09764971339109842, -0.9532790649968363,
        -1.126484065663741, -0.8764295142852427, -0.6835810176012748,
        -0.7475532677278167, -0.8001870610967223, -0.4042515140599252,
        0.5469194954707777, 1.6078192230362336, 2.0709080569439746,
        1.5371270208145167, 0.27063255092425426, -0.980517601642253,
        -1.5524335481933451, -1.3377822956238221, -0.7732638134702957,
        -0.37769326367921074, -0.2863072999019776, -0.17992899835189197,
        0.30197514094090705, 1.1453319656186947, 1.7938235044703204,
        1.7369859524093425, 0.6288193684605017, 0.04485968895035038,
        1.3199206620017634, 1.8634753278227905, 1.5446365405645577,
        0.6979687670606631, 0.005008200822940337, -0.2638318293081489,
        -0.3059241381115589, -0.5336970108019854, -1.0619339589964625,
        -1.5249077486575122, -1.3737820409807338, -0.40764955876575015,
        0.9542874963827159, 1.9283453945299716, 1.9526790749744212,
        1.1082010540841998, 0.017808310669384465, -0.6777062368256672,
        -0.8047284801885792, -0.6906484391611278, -0.7491418539755359,
        -1.0231322915852088, -1.1202115308084444, -0.6057406790695307,
        0.511393888443199, 1.6636939542474538, 2.1176923740888256,
        1.552548839993338, 0.32535471105235664, -0.8095482558944447,
        -1.285360706644104, -1.110314971062053, -0.7419542456381403,
        -0.5935501295481066, -0.6395687531271291, -0.4818012292560089,
        0.1951238700616798, 1.2156088950931054, 1.9537721247130937,
        1.818098774954781, 0.7646815091780096, -0.618219268626977,
        -1.5426970489835365, -1.607349326465771, -1.0422381700054542,
        -0.4234641737109988, -0.13577776260728092, -0.07256173047564006,
        0.16902384754713215, 0.8004539496791804, 1.5350365105546615,
        1.7699088310724862, 1.1134524016631, -0.21298895483899935,
        -1.4744061447682044, -1.9600470969870065, -1.508769809430772,
        -0.5794466526235664, 0.17679089151196825, 0.4530367654434517,
        0.4618533879559536, 0.6187397914722881, 1.052976713457598,
        1.4178258027681787, 1.191010110517408, 0.1978691795608058,
        -1.128591987238714, -2.0129546255867794, -1.9226676244508045,
        -0.9765125211136509, 0.17259468722541577, 0.8720736419478333,
        0.9542473064633727, 0.7622413800961323, 0.7277627430769101,
        0.9119369399398592, 0.9420741310131475, 0.40356856453943085,
        -0.681496085995996, -1.7488654961546297, -2.088778731122147,
        -1.4174964420575895, -0.12695029936129484, 1.0108824677124741,
        1.433987947775914, 1.1714811292635228, 0.7062661996403695,
        0.47306423775674794, 0.4623655582758003, 0.28846425776718104,
        -0.3558481231283559, -1.2967830086862466, -1.9260750763689354,
        -1.6843909862653905, -0.5634086991373831, 0.8254708439138435,
        1.6942861498427768, 1.6632712432658694, 0.9940347231642939,
        0.29049566530273296, -0.04571017036239846, -0.11436105457438257,
        -0.3176842166181422, -0.8721605148277997, -1.5051888742997774,
        -1.6393391678919618, -0.9147312323510616, 0.4218767633268914,
        1.629548224637625, 2.0155579105532224, 1.45272684829911,
        0.4343230330107393, -0.3667951017664633, -0.6384010106022825,
        -0.5994233057124327, -0.6771051516055354, -1.0156884940221491,
        -1.2885300320145725, -0.9980712945139391, 0.006931220849326397,
        1.2844557886622916, 2.069923724047453, 1.8648717975759912,
        0.8215975086052086, -0.36935465783656674, -1.0673501132259087,
        -1.0682248584362986, -0.9608976274852888, -1.1457908022795749,
        -0.8014848545762682, 0.19373371270824874, 1.413302849219084,
        2.0976995315894653, 1.7830860587694428, 0.6582297108192939,
        -0.5704662408996105, -1.2366022989320813, -1.1936020949565826,
        -0.8245154539412083, -0.6033957196998797, -0.6297349569497865,
        -0.5657839977786222,
      ],
      [
        2.9147424704069155e-10, -8.810317864192095e-9, 1.1873549480178415e-7,
        -1.0228754411120914e-6, 6.319217738065133e-6, -2.9755551592499058e-5,
        0.00011075591154649319, -0.0003331622989567593, 0.0008192946119516502,
        -0.0016482155025046214, 0.0026694324580941705, -0.003300722357383554,
        0.002681697672610901, -0.0023892837881465782, 0.06793341332118072,
        -0.09678458273456512, 0.0470770369070165, -0.02630092982148441,
        0.014601621369718204, -0.007693009882706503, 0.0038069055419796237,
        -0.0017817730333146244, 0.000800134808174161, -0.00034878387145469646,
        0.00014769499617191004, -6.012408933480591e-5, 2.3180670402633386e-5,
        -8.357506628356176e-6, 2.7942438965007734e-6, -8.617246723890758e-7,
        2.439836507834547e-7, -6.309736020140055e-8, 1.4848322822634095e-8,
        -3.1291172551240373e-9, 5.82363670188174e-10, -1.235997873962525e-10,
        4.955482209136584e-13, 6.596121174032551e-12, 2.3574925905400455e-11,
        1.7228154960011126e-11, -4.437512110600347e-12, -2.2118486649076415e-11,
        -1.9859862720423915e-11, 3.002403423507823e-13, 2.0192754425078995e-11,
        2.1877863769813644e-11, 3.8412016022916194e-12, -1.7658386971017947e-11,
        -2.324118453052996e-11, -7.871817592418954e-12, 1.4591471507471697e-11,
        2.3903110625165214e-11, 1.1661488284952213e-11, -1.1089783861746834e-11,
        -2.3845664215681598e-11, -1.510353752499554e-11, 7.257914758312413e-12,
        2.307149188447255e-11, 1.8092103847669112e-11, -3.1989044013107438e-12,
        -2.1607967171796052e-11, -2.0532490497543386e-11, -9.54007271370214e-13,
        1.9487227685125206e-11, 2.2358851123644105e-11, 5.075079650589789e-12,
        -1.6786140781952476e-11, -2.3516057979234283e-11,
        -9.043068400758831e-12, 1.3575932502793362e-11, 2.3962879828769625e-11,
        1.2741656238038029e-11, -9.964643005480103e-12, -2.3684753403898218e-11,
        -1.6055743985350683e-11, 6.050297808084808e-12, 2.2699266311674956e-11,
        1.8892323700199625e-11, -1.9528083733623176e-12,
        -2.1033672899628765e-11, -2.1151557123588554e-11,
        -2.1941376658483347e-12, 1.8729218958265123e-11, 2.278328500568361e-11,
        6.29572649300527e-12, -1.5864207792402824e-11, -2.3725666703389222e-11,
        -1.0193365174305671e-11, 1.252471027008573e-11, 2.395658336947144e-11,
        1.3786299095004756e-11, -8.810386471328233e-12, -2.346889135474787e-11,
        -1.696716726046565e-11, 4.825915639532914e-12, 2.2268292157171468e-11,
        1.9633294240333417e-11, -7.046824833477916e-13, -2.0402302852531753e-11,
        -2.171155578292584e-11, -3.4530870687971068e-12, 1.792287545876518e-11,
        2.3140426748339958e-11, 7.49494670344374e-12, -1.4903080122832643e-11,
        -2.386998907692561e-11, -1.1314980888328652e-11, 1.1439164798536642e-11,
        2.3886380053818576e-11, 1.479340348137303e-11, -7.628678421387852e-12,
        -2.3179009792031567e-11, -1.782739777583499e-11, 3.5930567190885608e-12,
        2.177425364704913e-11, 2.0327121515728686e-11, 5.552828844195776e-13,
        -1.9716963413925798e-11, -2.221333784314064e-11,
        -4.6867702093849945e-12, 1.707147997802159e-11, 2.3431482644202887e-11,
        8.679678890720657e-12, -1.3904633614213116e-11, -2.3948512336634885e-11,
        -1.2403018024299745e-11, 1.0323079058135502e-11, 2.3746930096062065e-11,
        -4.5000255759062934e-11, 1.753632557167065e-9, -2.4480630620213257e-8,
        2.1686714202925627e-7, -1.3770476823687703e-6, 6.655402402062714e-6,
        -2.539884491089947e-5, 7.828389926830236e-5, -0.00019732887481206744,
        0.0004080072315427411, -0.0006851190321507146, 0.0009034055878393652,
        -0.0008757807810143551, 0.000991676086533029, -0.015437970981427926,
        0.021749480445733042, -0.010769287740211917, 0.006018091704980088,
        -0.003316441376129967, 0.0017271196165437026, -0.0008431464331401247,
        0.0003894420160499526, -0.00017302427071166676, 7.487849955084126e-5,
        -3.155976934704091e-5, 1.2796542404145088e-5, -4.910879829923025e-6,
        1.760381581567549e-6, -5.845842714705348e-7, 1.789316986221701e-7,
        -5.021924908918208e-8, 1.2871934020767062e-8, -3.018113686618531e-9,
        6.086986757573071e-10, -1.162351005664068e-10, 4.024875898440188e-11,
        1.8590052066121763e-11, 3.113044483756932e-12, -1.841170519561143e-11,
        -2.294916742659934e-11, -6.835342704477616e-12, 1.5441888350441068e-11,
        2.3798036956099272e-11, 1.0701137433532464e-11,
      ],
    ];
    const result = wavedec(data, "coif15");

    const reconstruction = waverec(result, "coif15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif15_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4930041021488125, 0.9076375610979732, 1.1826339934333976,
      1.2867340455613907, 1.2242516504500212, 1.0320287325682267,
      0.7686809305708826, 0.4989753315297587, 0.27738549679040586,
      0.13503296765984796, 0.07330885595697273, 0.06571191699442137,
      0.06729429409336943, 0.02912571580769302, -0.08611870556046064,
      -0.2916366160444904, -0.5704397718684768, -0.8774802925598015,
      -1.1495556767727186, -1.3205541224149235, -1.3381886796974072,
      -1.1779403310523957, -0.8505990782082268, -0.4013897990829445,
      0.09921116276709875, 0.5707633121587372, 0.9405049508856727,
      1.1590115613839007, 1.2100395870113723, 1.1122068492782267,
      0.9122337876853784, 0.6716037250720084, 0.450149789880222,
      0.29082014565282954, 0.20952364514021815, 0.19260758540639006,
      0.20251736256477076, 0.19005094422757884, 0.10989989298317243,
      -0.06469331911138221, -0.332112398005848, -0.6600841781831315,
      -0.9916898444759831, -1.2582696544954217, -1.3960158220337258,
      -1.3620595775431972, -1.145942046245554, -0.7734959023870493,
      -0.3020668618215931, 0.19181431992054834, 0.6292948736089049,
      0.9464440578298803, 1.107639851985248, 1.11185157283921,
      0.9903847279357868, 0.7968242230352037, 0.5918831076819304,
      0.42713248841919826, 0.3318309807331759, 0.3062295874068292,
      0.32301932395530475, 0.3364556445498006, 0.2966859275473102,
      0.16544156377254798, -0.07111338655932009, -0.39586338757503703,
      -0.762410763430903, -1.1046748757690439, -1.3521019122379188,
      -1.4466912900669602, -1.3575367214395935, -1.089171801343328,
      -0.681552562608222, -0.20160988946647077, 0.2715731790530889,
      0.6643024068299821, 0.9242021636935398, 1.030632377043882,
      0.997108286506911, 0.8652817497922687, 0.6921879511730384,
      0.5341592670202429, 0.43162491963544536, 0.3987436706262803,
      0.4205295634203662, 0.4581608918765443, 0.46101858608558727,
      0.3822350118937979, 0.19360315850592003, -0.10415985453624704,
      -0.4786177656661612, -0.8711920111077094, -1.209850866994592,
      -1.425800950072174, -1.4700096793736581, -1.325389328158771,
      -1.011540866076108, -0.5808178010318983, -0.10665179911358008,
      0.33297398430246467, 0.6728075024321217, 0.8741017367131738,
      0.9315308310781218, 0.871662699822687, 0.7435608601746557,
      0.6040884582726773, 0.5018173221113345, 0.46376496617945556,
      0.4884130140199456, 0.5468016902539177, 0.5913754806418756,
      0.5702216335031528, 0.44292047007171176, 0.19378200721763456,
      -0.16110684037205236, -0.5750216547603392, -0.9798208156740394,
      -1.3010536106041126, -1.4752276409503993, -1.4649191381548874,
      -1.267922444038653, -0.9181190635236745, -0.4778243411357339,
      -0.023510728068548314, 0.3715357339350802, 0.6533174490997871,
      0.7980226262752982, 0.8151063217668846, 0.741953747811139,
      0.6316771640606389, 0.5373409444509315, 0.4967970353454051,
      0.5221190186730527, 0.5963994852680505, 0.6787391009095509,
      0.7161064354794873, 0.6589398325625757, 0.476363030723951,
      0.16695387397225148, -0.23787511962085345, -0.6789402394021896,
      -1.0816819610947628, -1.3728857171481401, -1.4975878427814229,
      -1.431945834143907, -1.1888472343885716, -0.8148496117450443,
      -0.3792214602382725, 0.04216537180180857, 0.38406235827246993,
      0.6059094685576124, 0.6992967378252597, 0.6870915133312886,
      0.6146446785872626, 0.5355152901731395, 0.4955417628766216,
      0.5194837588707275, 0.6037624151696404, 0.7172185244019247,
      0.8097041114111386, 0.8262654122158678, 0.7231954976680781,
      0.4817152376061477, 0.11561778347296747, -0.3292616729213468,
      -0.7838027790186106, -1.1705240608758016, -1.4210200337131536,
      -1.4915894308100337, -1.3731643026986107, -1.093072256773077,
      -0.7082148866612824, -0.2914010154116636, 0.08571647418138051,
      0.3688226858038688, 0.532226723705059, 0.5825211070178301,
      0.5538587359123469, 0.4962488023793994, 0.46005882104689466,
      0.48086636278077133, 0.5686867430872502, 0.7044436817266351,
      0.8446485619101491, 0.9331009835846404, 0.9165742186259993,
      0.7603814075862696, 0.45970872278189134, 0.043655240732516504,
      -0.42923239188562323, -0.8829721237525593, -1.2408110570434994,
      -1.4424429228809428, -1.4575149253036117, -1.292080785218843,
      -0.9864274483712002, -0.6048718899171776, -0.2201379396898036,
      0.10373269622887349, 0.3256480835281119, 0.4353863241379523,
      0.4532998779630699, 0.4220621506398336, 0.39276367199448403,
      0.4091103665746888, 0.49394709166199113, 0.6417060262850076,
      0.8188233440478437, 0.9720804678056989, 1.0427463348849688,
      0.98286112940755, 0.7694069845073763, 0.41261273717372515,
      -0.04388824442537004, -0.5312614942626719, -0.970117966967988,
      -1.28803352426822, -1.4356237302492516, -1.3972056329704883,
      -1.1934361141274183, -0.8753363389784612, -0.5112779079823584,
      -0.17026541226677228, 0.09424625793150354, 0.2559422841583262,
      0.3198044988951747, 0.31792968590759096, 0.29826408010460587,
      0.3093342531818373, 0.38507801244781875, 0.533837724006917,
      0.734484146335778, 0.9407738893644056, 1.0928887865122314,
      1.1332163788593885, 1.022295022410543, 0.7507592415134521,
      0.34410626911374276, -0.14108704990960524, -0.6286985736283606,
      -1.0395728580860508, -1.3089622842252269, -1.4006009166468965,
      -1.3139581933330853, -1.0829392220189868, -0.7664549108616663,
      -0.43332739998952063, -0.14540295775115158, 0.05684239493600307,
      0.1626028477949122, 0.19094876135072897, 0.1830461252798839,
      0.18856650382644707, 0.24996401415984865,
    ]);
    const expected = [
      [
        0.8370491182156808, 1.4006155142014562, 1.566439300897092,
        0.8899573449965131, -0.42718705271903307, -1.6206067834874731,
        -1.9742645088175372, -1.4024612277092887, -0.4696778576866918,
        0.15542192022825546, 0.2864027954599062, 0.2963112042161232,
        0.6366078436349206, 1.2900937349158956, 1.7112532793367734,
        1.330078192920747, 0.1402966469843875, -1.2029058861818924,
        -1.892537111370001, -1.6256063444111397, -0.8069405392427985,
        -0.12138855356863909, 0.09443506893747079, 0.105060811765088,
        0.3894957355728681, 1.0929560981107573, 1.7186559160103634,
        1.7009608296425884, 0.6229164215831566, 0.04463034820524268,
        1.3021263705995652, 1.805713555564528, 1.467775105079709,
        0.7013851718814997, 0.19290455439694218, 0.09216563642064698,
        0.041448878936599876, -0.41251038959128117, -1.2409270792847713,
        -1.8675488611021858, -1.6658587066834114, -0.5676509491663241,
        0.8071812204726153, 1.639089868942346, 1.572898010425373,
        0.9497910965469062, 0.41128179419185995, 0.2723882594861137,
        0.2687726228581531, -0.0914901692814159, -0.9334999970833192,
        -1.7794620104991612, -1.9262431273217244, -1.093888395606522,
        0.2712664126778172, 1.3384740226095466, 1.5723955736653312,
        1.1268796230553544, 0.604056558054354, 0.4330740357009157,
        0.47582013564743075, 0.23396970326474337, -0.5598353715464034,
        -1.562246191313261, -2.045930442976281, -1.540321533222625,
        -0.28511944000436207, 0.9394654732517819, 1.4575342854441835,
        1.2236931858426299, 0.7554152798923676, 0.5639087069029041,
        0.6479373470281975, 0.5405619378282029, -0.14730427893348255,
        -1.2320515575270217, -2.0163870408299154, -1.8743835633124297,
        -0.8214004114995836, 0.47089632451063446, 1.236166530958597,
        1.2327172119164538, 0.8543100905702786, 0.6558627049203417,
        0.7732943662733117, 0.8064151676500478, 0.2740491427543788,
        -0.813203422808192, -1.839967661481561, -2.0717085129610253,
        -1.2984164315203004, -0.03324919050563153, 0.9239303970535387,
        1.1527344150302892, 0.8933264124662701, 0.7025771051314511,
        0.8434362406472741, 1.0127274331469345, 0.6736790586628625,
        -0.3364062203082309, -1.529729299543314, -2.1179090381055925,
        -1.6812838824722907, -0.536300132223486, 0.5431461958640991,
        0.9889549307654385, 0.8692388405104542, 0.7008018817850619,
        0.8538489959749154, 1.145094535854733, 1.0227528810458453,
        0.16350823744749085, -1.1084645203014925, -2.0096258040766872,
        -1.9419475802508224, -1.0015670978034006, 0.12122140030097939,
        0.7526822509282477, 0.7832745359786263, 0.6506214242198003,
        0.804244504809342, 1.1945134516796714, 1.2962316908957563,
        0.6501263105050341, -0.6070262700019424, -1.754771825206043,
        -2.0612373747304655, -1.3950190757960863, -0.31132205991024625,
        0.46053593629034234, 0.6410628352497377, 0.555451711750756,
        0.6985466761198654, 1.157991078328139, 1.474666008899636,
        1.088105792476638, -0.06206735046615679, -1.3719539861365184,
        -2.030278548719371, -1.6877735443090356, -0.7230561237863644,
        0.13328421979059857, 0.4522722961441096, 0.4218076208640317,
        0.5445871854660086, 1.0387041022205257, 1.545613613900331,
        1.4456562810903613, 0.48683761845660684, -0.8895275231378601,
        -1.8503571653412183, -1.8596263049591717, -1.0816205305948818,
        -0.2091587775009228, 0.2349639294183767, 0.25286987482887474,
        0.341899467113084, 0.28673598737585737, 0.26222404385953535,
        0.08402436824107706, -0.6145539455508053, -1.530711566004983,
        -1.9810853433047304, -1.4700503606698558, -0.1995696521009908,
        1.0617459753129186, 1.6026071038616585, 1.3304557449845527,
        0.7549604671368413, 0.43746470506731294, 0.44962047305477876,
        0.36195704945583973,
      ],
      [
        2.481822808090815e-10, -8.755309062474661e-9, 1.1767747683314224e-7,
        -1.0148142071422554e-6, 6.277042340330274e-6, -2.959276942252891e-5,
        0.00011028876139720685, -0.0003321941698816788, 0.0008180723638795982,
        -0.0016484610747158064, 0.0026757804977566853, -0.0033220679258360477,
        0.0027322126351037625, -0.0024816056279314386, 0.06764106553414248,
        -0.09631108762625762, 0.04688756039928687, -0.026194530679884177,
        0.014536339139725529, -0.007653739723498354, 0.003784777941469586,
        -0.0017702445576987143, 0.0007945503766962768, -0.0003462334009161045,
        0.00014658319042740257, -5.966016941754106e-5, 2.299677298746917e-5,
        -8.289006152995593e-6, 2.770441498495798e-6, -8.541308365910053e-7,
        2.417640706336015e-7, -6.24493208811042e-8, 1.4723104333049443e-8,
        -3.119281392775699e-9, 5.294962152765759e-10, -1.4741221674125e-10,
        2.2310089603192266e-11, 5.522679206893959e-11, 5.1613302878948267e-11,
        -3.6198800799629065e-12, -5.5165138467003245e-11,
        -5.3731959684853026e-11, -6.836818110633452e-13, 5.302286566575246e-11,
        5.57934241623761e-11, 4.9659187619325355e-12, -5.063016302202628e-11,
        -5.759087075191454e-11, -9.226797157842925e-12, 4.8003453072944843e-11,
        5.911569887203739e-11, 1.3441761222450573e-11, -4.514373519084324e-11,
        -6.036461489645536e-11, -1.7595860272091796e-11, 4.207817489804727e-11,
        6.132830917429624e-11, 2.166536534470305e-11, -3.8811252780742866e-11,
        -6.200303895820301e-11, -2.5634695969737248e-11, 3.535880790886269e-11,
        6.238686166225616e-11, 2.947897696773634e-11, -3.17448014530546e-11,
        -6.247751233630929e-11, -3.318734180468563e-11, 2.7978982419068126e-11,
        6.227034728438967e-11, 3.674214655389873e-11, -2.4082240256108556e-11,
        -6.17716573175813e-11, -4.012081261084413e-11, 2.0073730275182407e-11,
        6.09818343948812e-11, 4.331122980689584e-11, -1.5964550358471765e-11,
        -5.990433062383056e-11, -4.629920761578681e-11, 1.178444000214691e-11,
        5.854805915622026e-11, 4.906754578339494e-11, -7.548416646972557e-12,
        -5.69106599984369e-11, -5.160145791739123e-11, 3.280898481414377e-12,
        5.5008456075758486e-11, 5.389905084459496e-11, 1.0088048586441562e-12,
        -5.2847623487111e-11, -5.5936381689556235e-11, -5.284213075213464e-12,
        5.04413199593873e-11, 5.771544449312967e-11, 9.548623761952079e-12,
        -4.7790941117075135e-11, -5.921716610978065e-11,
        -1.3757017402978658e-11, 4.492132424359428e-11, 6.044856274103171e-11,
        1.790739121005126e-11, -4.183434670423688e-11, -6.138624152672954e-11,
        -2.196763677285743e-11, 3.855723789950345e-11, 6.204179242511735e-11,
        2.5931917260488212e-11, -3.509202896130186e-11, -6.240140899286263e-11,
        -2.9763929884568784e-11, 3.146589946342185e-11, 6.247118389617044e-11,
        3.346104274380832e-11, -2.7690543620264413e-11, -6.223999080707506e-11,
        -3.7002822847464524e-11, 2.3784395588575888e-11, 6.172352874714382e-11,
        4.0370904328545725e-11, -1.9765478723876967e-11, -6.091104188908252e-11,
        -4.3540645680086784e-11, 1.5649473576113682e-11, 5.981349234783823e-11,
        4.6516440533392514e-11, -1.1468623808529614e-11, -5.843504425653987e-11,
        -7.043003923984006e-11, 4.704568324271381e-10, -4.205848533678053e-9,
        1.7194732365524287e-8, 3.595031533656435e-8, -9.749625475748924e-7,
        7.378124038629838e-6, -3.69793579779253e-5, 0.00014176528784943835,
        -0.0004418390810526696, 0.0011622444275942168, -0.002662145120710212,
        0.005509157806797914, -0.010974204409528203, 0.024593233497028407,
        -0.01721466121756556, 5.414610911321162e-5, -0.0007078250203620467,
        0.001230491532453823, -0.001196873593976145, 0.0008925413109233855,
        -0.0005577095091919751, 0.00030426809630761, -0.00014893061483830462,
        6.683896692339048e-5, -2.7971845892285054e-5, 1.1025916023419552e-5,
        -4.103148537489789e-6, 1.4366405159441928e-6, -4.70371771388508e-7,
        1.429959228690722e-7, -4.0202139536566606e-8, 1.0378795629843084e-8,
        -2.3658697060742885e-9, 5.491805338060516e-10, -1.2499512787865404e-10,
        -4.567844902566266e-11, -3.998474020335826e-11, 2.3460485621198744e-11,
        6.157725006994288e-11, 4.0889036127885916e-11, -1.9117718998305387e-11,
        -6.07569812974372e-11, -4.4032831609174404e-11, 1.4995007962614642e-11,
      ],
    ];
    const result = wavedec(data, "coif15");

    const reconstruction = waverec(result, "coif15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif16", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4956324449137782, 0.9124550319900291, 1.1887810275164319,
      1.2929766797559086, 1.2290670736731328, 1.0337406871546297,
      0.7656460604390798, 0.4898076261213307, 0.2611912683586067,
      0.11161807503407672, 0.04331716955425585, 0.030661290964816443,
      0.029492775813999728, -0.008527136352597386, -0.1204180714170191,
      -0.31940188740202724, -0.5888358267928179, -0.8842839109503837,
      -1.1433357365916652, -1.300755787048822, -1.3051335647907856,
      -1.132770460283675, -0.7951978367941386, -0.3383066702148627,
      0.16682135563773154, 0.6391963747310054, 1.0055861336074883,
      1.216233692782556, 1.2547925311409525, 1.1401120556702051,
      0.9195693833524559, 0.6557742885972355, 0.4101293526502337,
      0.2274850549304222, 0.12579864693265108, 0.0933741905355181,
      0.09427359625573879, 0.08035724695185986, 0.006686585951981239,
      -0.15385584449172812, -0.4006752293097265, -0.703025855045428,
      -1.0058157740750584, -1.2422992490400837, -1.350494275781744,
      -1.2891603281211688, -1.0492342990474894, -0.6577375097984561,
      -0.17305094002694554, 0.32737066861868874, 0.7638671987210407,
      1.071890157808804, 1.2155268601446638, 1.1939575786117032,
      1.0393658066520082, 0.8069843193866322, 0.5599378550385077,
      0.3528322190226445, 0.21831184425227446, 0.1599966660834617,
      0.15352576499698295, 0.1553142554765876, 0.11661786391008128,
      -0.0008853945445139733, -0.21218840748894208, -0.5022290129365373,
      -0.8272534428608876, -1.1240791681585998, -1.3250071359775473,
      -1.3746422765146713, -1.2443439739493283, -0.9405857338053223,
      -0.5050157911815265, -0.0060932359624297355, 0.47570376118293206,
      0.8654814905918022, 1.1100262082388808, 1.1884633121998727,
      1.114937910456219, 0.9328001473692806, 0.7019258637663055,
      0.48252338506342995, 0.31963196048501574, 0.23229042155192814,
      0.21010734793630229, 0.21801939880211268, 0.20788406929327646,
      0.13376836092877864, -0.03317461731664234, -0.2942533140658414,
      -0.6200847473090394, -0.9557292191820672, -1.2329494671356207,
      -1.3865678240789223, -1.3708002887408104, -1.1714036968294765,
      -0.8104954903450818, -0.342735746496557, 0.15626798678112416,
      0.6065146921649489, 0.9410592809682377, 1.1200791352796682,
      1.138149133375601, 1.023047395077583, 0.8265630665970122,
      0.6097951589813388, 0.42680254708511006, 0.3108408345781024,
      0.2667086069181067, 0.2711096706587116, 0.2808366833838865,
      0.2465367739923383, 0.1283581253735926, -0.09072526809179698,
      -0.3975254560689643, -0.7492763206119308, -1.0823056505321682,
      -1.3266665202010353, -1.423084817639126, -1.3379407486747736,
      -1.0724570045233432, -0.6637015411204308, -0.17706379412941597,
      0.3079931269547304, 0.7154120766219212, 0.9889565967929043,
      1.1035492540537288, 1.0688233018838351, 0.9241608839275439,
      0.7266490971111075, 0.5351661951765299, 0.39475963925047985,
      0.32535490151314195, 0.31767344986615276, 0.3373409208705899,
      0.3360217368038117, 0.2665770974678426, 0.09818337684425898,
      -0.17265896348696508, -0.518246904001965, -0.8841116586409987,
      -1.2008034681810422, -1.4001421753151488, -1.431866474335383,
      -1.27646625613347, -0.9509114329029502, -0.5057620216876666,
      -0.014307111121094007, 0.44361690222593825, 0.79914661327485,
      1.0089467880978387, 1.063266685960385, 0.9856270647017061,
      0.8243977928851954, 0.6385782566400808, 0.4815424355771296,
      0.3869882882049333, 0.36071725391023574, 0.3803247347765233,
      0.40280567707492426, 0.3780063782161774, 0.2643186810882959,
      0.042411634793655284, -0.2767157192536973, -0.6516228685456846,
      -1.0184734862581153, -1.3053401513286476, -1.4492322808876443,
      -1.41157178490041, -1.1881917352442193, -0.811287623780419,
      -0.34276453419158454, 0.13941636997081167, 0.5585331206688798,
      0.8557776856733793, 1.0022263157313964, 1.0032349140650254,
      0.8943254255749848, 0.7297929703615261, 0.5671007051881922,
      0.4511709907257086, 0.40266277044810844, 0.41325380699159403,
      0.44910037794084934, 0.4615027090897736, 0.4019146477740777,
      0.2372880714887689, -0.03836719196003374, -0.39936892997623713,
      -0.7920733289536062, -1.1461431358519418, -1.3906429249776655,
      -1.4709586363389286, -1.362284364589597, -1.076251471916022,
      -0.6589832019977675, -0.18100734840077395, 0.2784977650511548,
      0.6492335673713887, 0.8847701571025641, 0.9713447080163959,
      0.9284119229718172, 0.8009956330444302, 0.6459724385291695,
      0.5159428955077865, 0.44492426368176907, 0.43958547991277525,
      0.478274383784408, 0.5180395245996918, 0.5077523144292407,
      0.40383038710959124, 0.18436386706268348, -0.1421658406710638,
      -0.5360082342386188, -0.9335268999856451, -1.2611301148661171,
      -1.4523295573097523, -1.4636690346604464, -1.285510697859522,
      -0.9449359827895754, -0.4999900495670491, -0.026669511372925392,
      0.3981297802113481, 0.7134882656418599, 0.8870162076212578,
      0.9200624442605967, 0.84444062697171, 0.7116993172955763,
      0.5778513328191517, 0.48760877617599957, 0.4622553834553302,
      0.49430799722245927, 0.5503283414599697, 0.5811071400784096,
      0.5365065888986846, 0.3810135685081369, 0.10584356773466175,
      -0.2656995353543677, -0.6811805126188619, -1.069741252111907,
      -1.3579898359122413, -1.4871419603390466, -1.4271268458465176,
      -1.1841027226704515, -0.799467417539343, -0.3405800632507183,
      0.11451253117112425, 0.4945563844828352, 0.7504575036561896,
      0.8647810651109846, 0.8531443722146215, 0.7573429982366195,
      0.6321557971281034, 0.529370178148952, 0.4832466651421806,
    ]);
    const expected = [
      [
        0.21711821903534814, 0.3087395709692887, 0.7918717086797269,
        1.46988522003118, 1.719014571044135, 1.0802713522849374,
        -0.2447309863649025, -1.4838413758157643, -1.9098873207388958,
        -1.4224383088288104, -0.5666403440450892, 0.009456263652601913,
        0.13332298493681488, 0.17790620534812313, 0.5800103049508788,
        1.3004681056087208, 1.7745427855564995, 1.4221185818206696,
        0.23590826421732614, -1.1245497419937622, -1.8458019077161518,
        -1.6167924661618627, -0.8329797999773405, -0.16986521021909137,
        0.0409311853548194, 0.06272824203134005, 0.3664332930627677,
        1.0889466126952225, 1.7250425580432651, 1.710200872747835,
        0.625922348145406, 0.044985476149292464, 1.3091667829467093,
        1.8141430701818757, 1.4706440555168083, 0.6880297245069711,
        0.16006722843663274, 0.04243493232223412, -0.011721767816654759,
        -0.4518080325644725, -1.250538384317379, -1.8395525907729453,
        -1.6019782686939292, -0.4784380286672956, 0.9039601967774038,
        1.7200141824129696, 1.6123619317857005, 0.927404892792095,
        0.32171244991941805, 0.1320510466282331, 0.11364230847184363,
        -0.21758502193039997, -0.9942286989015717, -1.7568764465158466,
        -1.823148020102265, -0.9301813068409945, 0.4629720394810463,
        1.5158815985472012, 1.6885110005732038, 1.1412481691017347,
        0.498980109384472, 0.22626945510744556, 0.21964752652206082,
        -0.0012521369735607004, -0.71025908150998, -1.5896880047880901,
        -1.944037750857614, -1.3301891013241147, -0.00861713693972113,
        1.2239756619767541, 1.6807409344977247, 1.319178619396205,
        0.6823911153201245, 0.32850826456645243, 0.3083259906434144,
        0.18917703024046534, -0.4161370275236737, -1.3516052237205658,
        -1.9609030219609525, -1.6566149950715143, -0.48470154100844376,
        0.8577413034364324, 1.584031104044732, 1.4468075010721066,
        0.8623805841028082, 0.4395953239988224, 0.38340697313317146,
        0.348655649401581, -0.1283049045846535, -1.0596367345715798,
        -1.876189785612387, -1.892133952427978, -0.9386157208231897,
        0.4355680572547125, 1.3985958317831568, 1.511544409307185,
        1.0276370082231778, 0.5582744357054504, 0.44925810120399035,
        0.4752064974375207, 0.13885226313262122, -0.7329118002949756,
        -1.6981925504435946, -2.024964987512117, -1.3447918450293301,
        -0.02023331058859262, 1.130163978817291, 1.5036861677068818,
        1.1658745394915262, 0.6810038432520864, 0.5101312326597635,
        0.5696532515173498, 0.3738030635827041, -0.39133512308849194,
        -1.4403390171807076, -2.0495239466590722, -1.6803568666837498,
        -0.48474225295719076, 0.789885114283181, 1.4173620482761426,
        1.2647671460262002, 0.802001508509989, 0.5694511510290395,
        0.6351238453478726, 0.5683931457968325, -0.054259403218833525,
        -1.1201608441972555, -1.96666608491976, -1.9265610242124482,
        -0.9319429816441916, 0.39385531642394034, 1.251253955758244,
        1.3129727329384926, 0.9135429834893213, 0.6292179279270098,
        0.6763821200806294, 0.7180702093907406, 0.2607298812064853,
        -0.7580301143700898, -1.7835073125139729, -2.069940598943969,
        -1.3363412852720726, -0.03771637423957743, 1.0090247466859352,
        1.3011648955332211, 1.0064945181562492, 0.6895837538480505,
        0.6990551121187532, 0.8218139959816347, 0.5388254200001541,
        -0.3757381916945012, -1.512875000539417, -2.103078626942683,
        -1.6746776834196335, -0.4814599386264519, 0.6990325714555509,
        1.223741792607591, 1.0694561018040967, 0.7524108959174249,
        0.681108033262571, 0.8932197264092767, 1.2071946279396117,
        1.0608971375778957, 0.1621620427819999, -1.1307177737289413,
        -2.018222005096485, -1.9205014764617925, -0.9633306753104524,
        0.14968442305240962, 0.7587350903446655, 0.7782817734314941,
        0.653727836229174, 0.8172051915995252, 1.1942193872951956,
        1.2544303508609,
      ],
      [
        -8.252531252305018e-11, 2.282307635019236e-9, -3.331853271271643e-8,
        3.097930555761494e-7, -2.0737293514720244e-6, 1.0629039718683106e-5,
        -4.330388247682476e-5, 0.00014359246130860184, -0.00039310170438744386,
        0.0008938415917704884, -0.0016810867175963337, 0.0025571271253467566,
        -0.0029384864940136123, 0.002053978322344644, -0.0016460958194564022,
        0.06726255088608528, -0.09645554391377253, 0.04724552759689158,
        -0.026824569699636293, 0.015270835716488018, -0.00831228341443722,
        0.004271452607082074, -0.002079990633937203, 0.0009708542088741153,
        -0.00043921980823840385, 0.00019328618123435823, -8.223212710403436e-5,
        3.3422827431250855e-5, -1.2825021096658834e-5, 4.605755762796856e-6,
        -1.5392915605987137e-6, 4.76779760689793e-7, -1.3630908688559928e-7,
        3.583096076973835e-8, -8.607136025942564e-9, 1.864641781101952e-9,
        -3.813068761147671e-10, 6.68733916639899e-11, 2.950017699496168e-12,
        1.3373445825075155e-11, -8.278357103833329e-13, -1.2660839978953843e-11,
        -1.2519559435953483e-11, -3.455155101613488e-13, 1.2158463046366048e-11,
        1.2994132218589518e-11, 1.356031855758538e-12, -1.1583067913995457e-11,
        -1.340325769104553e-11, -2.3583793130551e-12, 1.094789361951421e-11,
        1.3749140495588044e-11, 3.355140669066809e-12, -1.0263674016956585e-11,
        -1.40249198570644e-11, -4.32911149477304e-12, 9.523121244207561e-12,
        1.4236029769638321e-11, 5.2834953293500184e-12, -8.738341426067633e-12,
        -1.4373296356514976e-11, -6.209589850745427e-12, 7.911177523427391e-12,
        1.4443121815521945e-11, 7.107975815774515e-12, -7.048533178423368e-12,
        -1.4437815527599975e-11, -7.973587696672945e-12, 6.146329885258883e-12,
        1.4366475323056327e-11, 8.798249104935666e-12, -5.213806912712661e-12,
        -1.4222089842563297e-11, -9.576956910759127e-12, 4.2577920347274785e-12,
        1.4008823865253432e-11, 1.031241273204681e-11, -3.284512196283899e-12,
        -1.3724008832318009e-11, -1.0995589790371053e-11, 2.287615165409287e-12,
        1.3377948091504579e-11, 1.1626519359244398e-11, -1.2866513963588876e-12,
        -1.295994424154527e-11, -1.2204879574440962e-11, 2.728198213647123e-13,
        1.2482969658058381e-11, 1.2709664681771751e-11, 7.38981076230887e-13,
        -1.1949155999956683e-11, -1.316018905066274e-11,
        -1.7489202891643312e-12, 1.1340723331946032e-11, 1.354748337892657e-11,
        2.7486437876046037e-12, -1.0692494873955347e-11,
        -1.3864595816976095e-11, -3.732896487867447e-12, 9.980856842078163e-12,
        1.411700069475028e-11, 4.705058646769075e-12, -9.22335640423842e-12,
        -1.4300757253584814e-11, -5.649054166878394e-12, 8.420706342328731e-12,
        1.4411304032925433e-11, 6.56277645311158e-12, -7.579113556557941e-12,
        -1.445691542784349e-11, -7.4496491520007e-12, 6.6982002104969866e-12,
        1.4422373537115717e-11, 8.297699361101975e-12, -5.795943423754999e-12,
        -1.4317877990796666e-11, -9.109073461716423e-12, 4.844342067574517e-12,
        1.4148593735145012e-11, 9.869954403129087e-12, -3.8836392177213625e-12,
        -1.3906789411864841e-11, -1.0585577401540825e-11,
        2.8978468218425825e-12, 1.3597755190357384e-11, 1.1250001929062189e-11,
        -1.8978225125997943e-12, -1.32258126953604e-11, -9.765880574437994e-12,
        -7.250717105353681e-11, 1.2273216517515332e-9, -1.2653587431160914e-8,
        9.37728337278012e-8, -5.256926349894681e-7, 2.321541541742712e-6,
        -8.288118101098221e-6, 2.432594208406919e-5, -5.9285257003145354e-5,
        0.00012038393595440377, -0.00020278066668646713, 0.0002795473430875731,
        -0.0003164492475890218, 0.0004347454809417334, -0.0036223694159741703,
        0.0050091700685750565, -0.002608489439578098, 0.0014866566273346294,
        -0.0008293730012361437, 0.000436314251018613, -0.0002149708268208085,
        0.00010019014357832226, -4.4988717455933554e-5, 1.9775318179050123e-5,
        -8.535777774976469e-6, 3.5781373878768916e-6, -1.4319626833174712e-6,
        5.39155160341627e-7, -1.8919165580005664e-7, 6.154321213148679e-8,
        -1.8507952864352413e-8, 5.105295641360608e-9, -1.2860081314445075e-9,
        3.1271290658176487e-10, -5.500347477619928e-11, 4.745563028087132e-12,
        -1.638321870922715e-11, -7.804358130161686e-12, 5.983884184736135e-12,
        1.435383998965869e-11, 8.910631260282416e-12, -5.081057576813324e-12,
        -1.4198065464965411e-11, -9.681923957922855e-12, 4.132146412438323e-12,
        1.3970875979897821e-11,
      ],
    ];
    const result = wavedec(data, "coif16");

    const reconstruction = waverec(result, "coif16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif16_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4846618224127236, 0.8958522584458347, 1.175305792210057,
      1.291621338898392, 1.2456825664490156, 1.0686532219240548,
      0.8131464126753561, 0.5397995082041169, 0.3025693120916887,
      0.13633323901651584, 0.049777730438726187, 0.025225245382631795,
      0.0253230968067628, 0.004815348005857034, -0.07563968171535268,
      -0.2371505057483692, -0.474946970002775, -0.7574278951702779,
      -1.0322638119954362, -1.2381626416309242, -1.3194861468414423,
      -1.2401681700222404, -0.993514547445921, -0.605430207990266,
      -0.13018790046123513, 0.3603557968757407, 0.7916137547145486,
      1.1017271288383332, 1.2540218419279174, 1.2435817300604786,
      1.0964782274191234, 0.861965130590322, 0.5996329273700386,
      0.36471051466888704, 0.19511365593100471, 0.10337121211966888,
      0.07532897025773852, 0.07583998959283773, 0.05991501987095213,
      -0.013547588472023864, -0.16897391607035928, -0.4055602423814656,
      -0.6952002819402833, -0.9875387979730055, -1.2210276699686746,
      -1.3373594766101067, -1.2957892679762877, -1.0838410075226064,
      -0.7217371666549524, -0.259384968714203, 0.23346208071907126,
      0.681607551744958, 1.0200226226272848, 1.2070186418156041,
      1.231929362557938, 1.1155788542671083, 0.9035513001186499,
      0.6540071671963221, 0.42308621179413397, 0.2514870707717785,
      0.15548405648904134, 0.12451717040033267, 0.12584849702683673,
      0.1150206439282481, 0.0494120134797989, -0.09858713397489494,
      -0.3321654549754314, -0.6269094573980476, -0.9347743786774497,
      -1.194358621250751, -1.345061018432828, -1.3417137930568204,
      -1.166126879333542, -0.8326922093152082, -0.38660799157467407,
      0.10494945426542852, 0.5666847446685297, 0.9308434147170539,
      1.151014067266821, 1.2108687393621353, 1.1258648276804215,
      0.9376324189155751, 0.7025303150088444, 0.47724427530561275,
      0.304984482485799, 0.20565138871358807, 0.17232833585634866,
      0.1748751183181635, 0.16962835076250105, 0.11269616017965517,
      -0.026561112344766713, -0.2553259052433103, -0.5530532488079836,
      -0.8743321782363886, -1.1583114386733737, -1.3424886334543327,
      -1.3775598747785638, -1.2397277968555929, -0.937445028699033,
      -0.5108889347824292, -0.024201941436271565, 0.44773236824964424,
      0.8348961358165956, 1.0864783888579308, 1.1806157034170686,
      1.1273158869078022, 0.9639980233743881, 0.7448614683894739,
      0.5267718812465687, 0.35516563229977366, 0.2534285445526022,
      0.2183145033010112, 0.22245406879920646, 0.2232354992200487,
      0.17575456553867574, 0.04651446719325231, -0.17563769456387596,
      -0.47417774923865214, -0.806636740617665, -1.1131161636991365,
      -1.3296194389741922, -1.4030222244395538, -1.3040648669827317,
      -1.0351920781250303, -0.6312823851155459, -0.15300815560956701,
      0.3256664907144179, 0.7329372803007389, 1.013945899544006,
      1.1414566227394354, 1.119981541301981, 0.9825009699745438,
      0.7807131609244513, 0.5712986886823442, 0.40162261713645836,
      0.2983949225995105, 0.2620452799128736, 0.26813149988145807,
      0.275345141057434, 0.23803432566793498, 0.12003601458118768,
      -0.09372506671114916, -0.3908732286679148, -0.7321725094356748,
      -1.0590754723745734, -1.3065102769170869, -1.417874706345168,
      -1.3586292499839727, -1.1251827937602026, -0.7468728169787656,
      -0.2804890007981382, 0.2014250955878303, 0.6257672082235762,
      0.9340105091068349, 1.093745801781549, 1.1039802724631136,
      0.9930581980462231, 0.8098533335851403, 0.610499641955498,
      0.4439832052063414, 0.34015761104127173, 0.30311170678167454,
      0.31146962090363217, 0.3254704550558539, 0.298984673206495,
      0.19339099937831444, -0.010235485411925538, -0.30376966421866103,
      -0.6514803148015627, -0.9965626323837217, -1.2732975599049103,
      -1.4219722995248139, -1.4029862043968548, -1.2067254117836292,
      -0.8567816270983665, -0.4056755891478865, 0.07596080728136834,
      0.5142238230265028, 0.8473208887562818, 1.0379023693317053,
      1.0794981914937218, 0.9956509705461768, 0.8321068380734781,
      0.6440973749436628, 0.4819138268249334, 0.37835475811515473,
      0.34112992809290155, 0.35205068657685124, 0.3731391120139913,
      0.3580617413271001, 0.2659630257649978, 0.0741655099818061,
      -0.2135319237395838, -0.5651533930340776, -0.9260188947513255,
      -1.2301964941944816, -1.4152524331988003, -1.4367785640667028,
      -1.2791923350031307, -0.9601738827699997, -0.5276177734475108,
      -0.04976648269767994, 0.3991759751470941, 0.7545752055305578,
      0.9744066697454967, 1.0467871647284228, 0.9903245936897311,
      0.8473564623825658, 0.6718641993123424, 0.5151222163702991,
      0.41265865772729937, 0.37574463403992914, 0.3894808148495643,
      0.4178975325084886, 0.414733296844624, 0.3371369726313908,
      0.15879962965591515, -0.12085463991686352, -0.47383296890171533,
      -0.8479503386500404, -1.1774996836570502, -1.3977356841297817,
      -1.4597296194353528, -1.3420250069570643, -1.0562647313454483,
      -0.6453914352476614, -0.17479703136328917, 0.28151664376251884,
      0.6565154892495803, 0.9037961881432512, 1.0061624255044956,
      0.9771876205086522, 0.855543472804411, 0.6936236623195278,
      0.5433596843543276, 0.4427785242213666, 0.40663224739677045,
      0.4233936014358912, 0.4593150001145136, 0.468483401940623,
      0.40630415613403964, 0.2429812965942879, -0.026456814785430882,
      -0.3782034336966574, -0.7629241921745723, -1.1155751238680833,
      -1.3695258289730659, -1.4716453798009344, -1.3947382553495793,
      -1.144325421294025, -0.7581055636255574, -0.2981786439129337,
      0.16215595051338344, 0.5539216775377683,
    ]);
    const expected = [
      [
        0.21988766142040347, 0.598334258771802, 1.2778145029262586,
        1.7422112124141045, 1.4425298268472018, 0.3301652408541111,
        -1.020690489551393, -1.832522756746953, -1.7267938909229337,
        -0.9831616671697626, -0.23896520442497737, 0.08473263672711065,
        0.10653123825509098, 0.27593242979394744, 0.848008835339848,
        1.5506549759722326, 1.7734529156806376, 1.119515803908509,
        -0.18412589879474428, -1.405012769535558, -1.8660976622970924,
        -1.4597168422596363, -0.6719093906615227, -0.10655216838653465,
        0.03505794888784403, 0.07182152671524288, 0.4250343260884067,
        1.155953618870997, 1.7488898730250606, 1.6903899097541408,
        0.6122844902261076, 0.04384977993886293, 1.2852519948720595,
        1.8125738267149738, 1.51980623362441, 0.7588415259009653,
        0.19496691247482234, 0.03476891951504973, 0.007139615803131624,
        -0.33548465212837, -1.071137493480989, -1.7510323866328419,
        -1.753861588393708, -0.8562077557137998, 0.5096200695581855,
        1.5580774467185836, 1.7586901486005126, 1.2190027779748815,
        0.5157785561852234, 0.1461889701376757, 0.10725394185103294,
        -0.019159183355186942, -0.5735487951344475, -1.3965907614616446,
        -1.8913119095894173, -1.532782652295151, -0.36682574063273166,
        0.9639386438927018, 1.7069821332931494, 1.5776667456025226,
        0.924905805739327, 0.35565642624676136, 0.17609387112720853,
        0.16266375459501708, -0.13942326194282367, -0.8865838570311152,
        -1.689078160508753, -1.8974698429637677, -1.1776046156970215,
        0.1484209415844654, 1.3164113815381098, 1.7124269934604341,
        1.3260124833524936, 0.674925326702738, 0.2908349830388957,
        0.24731076404574434, 0.1593764381526427, -0.36108535801973624,
        -1.2364924244797297, -1.8985656327618836, -1.7532398639644464,
        -0.7225060604369861, 0.633189187490977, 1.536512472748303,
        1.5942654163449237, 1.0533931906867438, 0.5022800540872103,
        0.308743331429885, 0.3157026705988225, 0.0657813903509986,
        -0.6705886039478286, -1.5741839751986655, -1.984173058112832,
        -1.4639826765464787, -0.21638620881813878, 1.0365298421695133,
        1.6142634367394009, 1.3894661967841206, 0.8079383537013507,
        0.42199414648297706, 0.37919520363041703, 0.33663137166895807,
        -0.13254726047690663, -1.0354482928393518, -1.8476845529948662,
        -1.9213919115642468, -1.056237667140414, 0.2848581019813815,
        1.3208903293778052, 1.5612638739108224, 1.1453055678904778,
        0.6278870702689606, 0.42866468664369733, 0.46028473169036277,
        0.2734961741612252, -0.42959517897469784, -1.409352390469891,
        -2.0109725113061883, -1.7065674434053482, -0.573711920098036,
        0.7272223046185935, 1.4678156071285664, 1.4080631059377084,
        0.9108912431352257, 0.5350744303145397, 0.49787485559841943,
        0.5063757707505904, 0.1048858700766901, -0.7992475932487344,
        -1.739760566472439, -2.031911731429974, -1.35789092725089,
        -0.07038043478398255, 1.0671304894914955, 1.480380605277931,
        1.1983430012674248, 0.7284928246727818, 0.531383157422796,
        0.5909963583533833, 0.47678367782244635, -0.1709142642476891,
        -1.1991828995272096, -1.9766966363911824, -1.8979104283224306,
        -0.9127197551829436, 0.3981197765086308, 1.2781749102553956,
        1.3819141931967132, 0.9810263962380046, 0.6259640631291401,
        0.5992419399388424, 0.6615907224660962, 0.3453751548445504,
        -0.5378586697042596, -1.5728707013551364, -2.088391068070271,
        -1.60829273927507, -0.43353805838235504, 0.7601908001551,
        0.26936129265566267, -1.0879217423408254, -1.9649855211339957,
        -1.9404531418476711, -1.0772108105119953, -0.03817703936178585,
        0.5749057049843946, 0.6494610198869447, 0.5750984820206261,
        0.768417725686745, 1.209923150212746, 1.4229281962814837,
        0.928453157638834, -0.2472003373466744, -1.4937839082020052,
        -2.064369425213609,
      ],
      [
        -7.985278988331499e-11, 2.2411354157899152e-9, -3.257602087311943e-8,
        3.026759738578721e-7, -2.0242757011754155e-6, 1.036612236499247e-5,
        -4.2194229542551866e-5, 0.000139783437534736, -0.0003823070995849588,
        0.0008683916209950778, -0.0016311839115577807, 0.0024767258985016914,
        -0.0028355845536886153, 0.0019550374018912292, -0.0015272514145681624,
        0.06552532204634043, -0.09400557319168817, 0.04601234520739895,
        -0.026123489395557083, 0.014875686072523922, -0.008100645973843162,
        0.0041647701637972006, -0.0020290318516916813, 0.0009474541177116665,
        -0.0004287572069630344, 0.0001887175210098518, -8.029995781096079e-5,
        3.264236807040313e-5, -1.2527778789665935e-5, 4.499967091341349e-6,
        -1.5042864988792245e-6, 4.660541519405246e-7, -1.3328891505266084e-7,
        3.50412954690788e-8, -8.416382601759096e-9, 1.8334885956482866e-9,
        -3.690700143328844e-10, 6.097701912971239e-11, -6.160795868990241e-12,
        8.363165877510524e-12, 3.6037470251372625e-12, -2.9099097439102413e-12,
        -6.9312710653538915e-12, -4.577852498427429e-12, 1.975389894306984e-12,
        6.7165428792818164e-12, 5.294752465584622e-12, -9.854583200646343e-13,
        -6.36015818191398e-12, -5.8997497478883085e-12, -2.5694657701565128e-14,
        5.872242360141506e-12, 6.383044120873124e-12, 1.038860426891509e-12,
        -5.260259329610343e-12, -6.732278589173272e-12, -2.0269059151179915e-12,
        4.53706711582106e-12, 6.938385635080509e-12, 2.971490047331638e-12,
        -3.720530051717427e-12, -6.999907604146619e-12, -3.8566804354556065e-12,
        2.82415986773877e-12, 6.9147990079800155e-12, 4.661160796728726e-12,
        -1.870894362551807e-12, -6.6823348582787235e-12, -5.367256471547725e-12,
        8.742029783064025e-13, 6.313564304086343e-12, 5.960549459917043e-12,
        1.3653578926511014e-13, -5.812041599051749e-12, -6.426842736658501e-12,
        -1.146860043445464e-12, 5.18606879543823e-12, 6.761256067835901e-12,
        2.1305818294673022e-12, -4.452960792854883e-12, -6.950063152676492e-12,
        -3.070448006118926e-12, 3.6281598311601837e-12, 6.995837150755299e-12,
        3.951638948943868e-12, -2.7234437148862865e-12, -6.8959944112611315e-12,
        -4.73824462711337e-12, 1.7647622203314933e-12, 6.6517187663311984e-12,
        5.4359403118684215e-12, -7.638485954103848e-13, -6.260535117090454e-12,
        -6.017130994398543e-12, -2.5124849569744903e-13, 5.75125485289305e-12,
        6.469939027136682e-12, 1.2526266268078654e-12, -5.110539281266853e-12,
        -6.789735774502267e-12, -2.235008664745834e-12, 4.3644532013295485e-12,
        6.964090577062693e-12, 3.1667524940133617e-12, -3.5328648110440833e-12,
        -6.9977354870891815e-12, -4.0343868236507855e-12,
        2.6217137847759403e-12, 6.874269692172184e-12, 4.8246791741732596e-12,
        -1.6514405201843338e-12, -6.6170631542339965e-12,
        -5.500593196688981e-12, 6.575564148539943e-13, 6.217102187072499e-12,
        6.071355187249772e-12, 3.54758108881315e-13, -5.684888503862164e-12,
        -6.512241052556008e-12, -1.3620957852376905e-12, 5.037464545028183e-12,
        6.814229956535606e-12, 2.3359072973409685e-12, -4.283774249154606e-12,
        -6.9713100562946366e-12, -3.271751285444678e-12, 3.4349200805500007e-12,
        1.7190387957898328e-11, -2.4204252084680323e-10, 2.576077012017004e-9,
        -1.3480158318740425e-8, 8.552602949604406e-9, 4.528663665883698e-7,
        -4.316901299505715e-6, 2.4699158888026097e-5, -0.00010541880755805635,
        0.00036184518654736194, -0.0010398810386234238, 0.002574380549059286,
        -0.005638069509475565, 0.011303106952622531, -0.02205873414500275,
        0.04885810390427259, -0.03400421934917458, -0.00016617511410474742,
        -0.0011068310989181358, 0.0022513397311510214, -0.0023203054420658205,
        0.001812890971834898, -0.001186674889024381, 0.0006794679657420402,
        -0.0003495360858235019, 0.0001649210297090556, -7.255846940047605e-5,
        3.0101562345423074e-5, -1.1831504097582876e-5, 4.4016668497464885e-6,
        -1.5432191544416035e-6, 5.071081413290282e-7, -1.5532173479686158e-7,
        4.411150583404744e-8, -1.1558414023232353e-8, 2.767230341846202e-9,
        -6.060020321546826e-10, 1.2576800560988453e-10, -1.4918025744770065e-11,
        4.1599928474609586e-12, -5.852382058163972e-12, -6.616551776370221e-12,
        -1.830473429343889e-12, 4.696759964651719e-12, 6.9059621075800196e-12,
        2.782397919799598e-12, -3.8980135613071966e-12, -7.000447911612575e-12,
      ],
    ];
    const result = wavedec(data, "coif16");

    const reconstruction = waverec(result, "coif16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif17", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48687300122882005, 0.8979710641499274, 1.173742064968849,
      1.2831731740268215, 1.229266075158068, 1.0464353064778567,
      0.7905954474484727, 0.5245050009280984, 0.3020869469145121,
      0.15566094044823903, 0.08924851104130788, 0.07954735733897865,
      0.08420966686809338, 0.05519725714670409, -0.04630716790799244,
      -0.23735207096990807, -0.5063551337430898, -0.8138079529431084,
      -1.1005038756942362, -1.3013241649818268, -1.3611839442386091,
      -1.2491557543856007, -0.9672042147592931, -0.5512783111918429,
      -0.06439074635170419, 0.416704352527725, 0.8180394173017791,
      1.0841805052817075, 1.189407983089802, 1.141687459401262,
      0.9785839472982483, 0.7562723201015655, 0.5344997730617366,
      0.36133526397836185, 0.26155297406551214, 0.2315411844095498,
      0.2419473432811573, 0.24728934572284517, 0.1999821782948445,
      0.06509749589168184, -0.16802288504633056, -0.48039001624035516,
      -0.8257421345727401, -1.140218763966909, -1.3570215121576206,
      -1.4224610592058136, -1.309402220920608, -1.0247309484307565,
      -0.6089274305060582, -0.12777363913331014, 0.3418345089386698,
      0.7285466226928907, 0.9816634803807259, 1.081063596509295,
      1.039626419153804, 0.8977026470060699, 0.7111602521680693,
      0.5361203129550145, 0.41429298199872805, 0.36263289176022734,
      0.3699054749669388, 0.4009770591713823, 0.40766171964807707,
      0.34327667713837046, 0.17710005000441076, -0.09506765297094832,
      -0.4470646595056813, -0.8263850392105443, -1.1651970969330745,
      -1.3957257378729402, -1.4662336976762764, -1.3536488944507172,
      -1.0696870835377967, -0.6589114192494229, -0.18915580185218145,
      0.26337944067110297, 0.6307435567697326, 0.8675405721977247,
      0.9594963402690837, 0.9243064433938061, 0.8047177469820693,
      0.6557320217936418, 0.5292719994800554, 0.46025513201496804,
      0.45762815060380013, 0.5026271510293434, 0.5546696873802013,
      0.5633268176305213, 0.4832588887009441, 0.2882243725079344,
      -0.019517293935778002, -0.4069420514063431, -0.8158771244073003,
      -1.1752476042988165, -1.4170195906267686, -1.4919492483819377,
      -1.3812613874149633, -1.1013647005301372, -0.7004188148504175,
      -0.2475740966321067, 0.18249285279998023, 0.5259773551484718,
      0.7433007298100621, 0.8262264750419384, 0.7971215201086701,
      0.7007183057840389, 0.5906065327700025, 0.513986743481359,
      0.49862520112738534, 0.5453602263655859, 0.6280745361365123,
      0.7011294528365595, 0.7123398851683911, 0.6181380249283068,
      0.3969907175790256, 0.05754896009434174, -0.36068442607790063,
      -0.7945088457962745, -1.1703717038625023, -1.4207054865191042,
      -1.4992803551574752, -1.3918124098751674, -1.1192226993850585,
      -0.7327479470007003, -0.3021094577119915, 0.1003496948693729,
      0.4156730111080899, 0.6105527610291275, 0.6829189727433209,
      0.6596190401583875, 0.5869431411175144, 0.5165418069290348,
      0.49042317641497707, 0.5289229148127217, 0.6247594117230774,
      0.7447188319186605, 0.8385553057235092, 0.8528359542446291,
      0.7461774623667938, 0.5019354193661733, 0.13501869266091907,
      -0.30904312148974944, -0.7627152315142219, -1.150762082817056,
      -1.406807250477871, -1.488129119894816, -1.3850880760145112,
      -1.1228952392238145, -0.755317822515008, -0.3519005904336562,
      0.0181295028442528, 0.3013140911952067, 0.4710043817778219,
      0.5313624812634392, 0.5134807059990951, 0.4647658456954562,
      0.4344260207066755, 0.45886500285345766, 0.5507903147347406,
      0.6948780402713921, 0.8511530088380254, 0.9652633592797211,
      0.9830534418893864, 0.8657172513099642, 0.6016305402951441,
      0.21176200749877433, -0.25284717384675615, -0.7210685320072541,
      -1.1167988097098065, -1.3755690444470137, -1.4586284089843897,
      -1.361091511716356, -1.1121979349394093, -0.767677419246469,
      -0.39615683819035036, -0.06300019429885328, 0.18442282792416065,
      0.3264400973395144, 0.373446745722953, 0.3605016838115764,
      0.3356779608614893, 0.3452666935310227, 0.41971753398293976,
      0.5639960544064528, 0.7549019708053331, 0.946109028444073,
      1.0797077999242677, 1.1013564758880925, 0.9751957530628994,
      0.6947032005416323, 0.2866475912836425, -0.19299081519735606,
      -0.670269059212179, -1.0690430425162978, -1.3274515046171431,
      -1.4111402458177749, -1.320043707325811, -1.0871317146094515,
      -0.7695132491840011, -0.4341700315359302, -0.14190017321381876,
      0.06653985622479403, 0.17869820357407545, 0.21113877407983245,
      0.2025682606394314, 0.20127051687400654, 0.2501781614892185,
      0.37350244502903235, 0.5684378603784757, 0.8041601906990969,
      1.028473183484436, 1.1805000069273777, 1.206255662065696,
      1.0731701220403271, 0.779854328026384, 0.35855891002892276,
      -0.13042005586632702, -0.6111343530416762, -1.0082284293488852,
      -1.263125145462915, -1.346251309082466, -1.2623815949821413,
      -1.0478842718181287, -0.7606550739070219, -0.4653251480074523,
      -0.2174752952515901, -0.050796136607696274, 0.029647206439747886,
      0.046458050697327065, 0.04163428788374551, 0.06321417114695838,
      0.15036749385971815, 0.32085082482000826, 0.5641431325921507,
      0.8421324233191037, 1.0972993676001146, 1.266425642193491,
      1.2964270271333367, 1.1583353632029167, 0.8558765744138743,
      0.42641031175220867, -0.06611854600343152, -0.5445868350373806,
      -0.935250327968276, -1.1834611231994165, -1.2647655934901305,
      -1.1887533655664013, -0.9948290783897913, -0.741079680342961,
      -0.4891096279902729, -0.2886895495389735, -0.16606857819555382,
      -0.11883803548740896, -0.11854888663475989, -0.12030329133533507,
    ]);
    const expected = [
      [
        0.2504572926132176, 0.5765207327870931, 0.5231253394947517,
        0.5858987539386201, 1.0057324736363356, 1.4702537817682213,
        1.3882818076406902, 0.4834269986288592, -0.8611534307241203,
        -1.8517743794145403, -1.9191182269993214, -1.1677757253552428,
        -0.23762024459653716, 0.2828175162721959, 0.3421651854060184,
        0.36989186484859543, 0.7558964988273731, 1.3839276743407143,
        1.6820741811734705, 1.1568894001930048, -0.0910787839487301,
        -1.3677969896739635, -1.9250789447983876, -1.5562063265030945,
        -0.7163487213672768, -0.06504114921646645, 0.11829051220431684,
        0.12772840871729094, 0.424186158583338, 1.124345583604299,
        1.7252541691591456, 1.688727285190798, 0.614673484173613,
        0.04423833297840862, 1.288447325623114, 1.8002662785568913,
        1.488793953129207, 0.7368474333724218, 0.2225677511094445,
        0.11142786566951657, 0.07847520894571454, -0.33580658765845955,
        -1.1508575161472658, -1.8403603136824513, -1.766570959186363,
        -0.7796256025975079, 0.5893089901197391, 1.533262770602887,
        1.6145898893194481, 1.0695305719283588, 0.5110052308818873,
        0.3274486832394964, 0.349719946551149, 0.09206176156646742,
        -0.6793740761953547, -1.6125128400738042, -2.011663721876332,
        -1.4491884050545727, -0.1806992133765932, 1.0303205146332235,
        1.5288547999715916, 1.2695432583747182, 0.7581886176449139,
        0.5128403536896178, 0.5670671952801394, 0.485466532455185,
        -0.13444596417427185, -1.1686849301932678, -1.9738542678527953,
        -1.9143486252237283, -0.931841465505536, 0.3724747770469627,
        1.2268876431110656, 1.3071667080368465, 0.9273451185032842,
        0.6508990498473091, 0.7108221338021797, 0.7966644255411421,
        0.40761081660722015, -0.575502968198335, -1.662051101145428,
        -2.1099348614340587, -1.5575648966091191, -0.35012264514986247,
        0.7438443091520216, 1.1684606865964142, 0.9909653314433712,
        0.7268870235114452, 0.7712558285047215, 0.9915467811801936,
        0.8741791782719511, 0.08138651986619799, -1.1236051851499766,
        -2.0091809671729615, -1.9683199863249128, -1.0362620844499426,
        0.14191589946399935, 0.8634519951919589, 0.932842192592022,
        0.7305004288920577, 0.7480099595778817, 1.053191472253521,
        1.206092172971806, 0.7098438775032, -0.4370529737684311,
        -1.6274233445842057, -2.104532383917666, -1.5880136764349642,
        -0.49766258759879356, 0.42612247430240946, 0.7514600275394223,
        0.6572781623107615, 0.6489331103337541, 0.9827059487466231,
        1.3650885339547278, 1.2243090779828303, 0.2994767030005044,
        -1.0197448973646306, -1.9453483986374411, -1.924874075500522,
        -1.085659817826432, -0.08909572920975574, 0.46165601296024755,
        0.5098263705051792, 0.4882808406275117, 0.7976108692662485,
        1.338000219508731, 1.557553265208109, 0.9824586880301964,
        -0.27293022826503366, -1.5118551694868363, -1.9956536740461783,
        -1.5374364148871023, -0.6140091469744182, 0.09410156711159161,
        0.2985953178469965, 0.2846394946695914, 0.5282122233386142,
        1.1372542480114827, 1.6694791201548196, 1.517691741422775,
        0.5070788730827918, -0.8642744891187294, -1.7863287161555454,
        -1.785277159375176, -1.0757287570341008, -0.30755642619490564,
        0.04192729299356605, 0.058880140550333186, 0.2126511435967643,
        0.7978196542239455, 1.5518150430900857, 1.833424415374267,
        1.2103936433482934, -0.0935051220693638, -1.3226596463873508,
        -1.7885809495267628, -1.4071034397500248, -0.6911828203385277,
        -0.236187107216667, -0.1634640767444409, -0.17254011915254652,
        -0.16947407744438656, -0.4073256689084431, -1.048608125125006,
        -1.6808364831756084, -1.6738285339367374, -0.7700868925995553,
        0.6030041320538089, 1.6381448699911525, 1.7909927823991498,
        1.1909560339784626, 0.4537513807902312, 0.08939837500271529,
        0.06570160030844328, -0.07183658480072609, -0.6580691352577238,
        -1.4819321490011281,
      ],
      [
        1.9365422292527177e-11, -5.910440465352956e-10, 9.139121975331091e-9,
        -9.114132455277252e-8, 6.561423376710243e-7, -3.630348561703764e-6,
        1.6036577438844225e-5, -5.797158593860396e-5, 0.00017425634263812395,
        -0.0004394942084877897, 0.0009317822629852722, -0.001646487350417046,
        0.002353765364233968, -0.002488409354381472, 0.0013720814346502136,
        -0.000838495125443434, 0.0653201353017869, -0.09427902104340702,
        0.04639921348061287, -0.026709679515305097, 0.015545418422302452,
        -0.00871123006296478, 0.004631124251921681, -0.0023383268112302513,
        0.0011313544048844088, -0.0005298486959192289, 0.00024143680542286933,
        -0.00010674076051776692, 4.537988802699775e-5, -1.8358925434627262e-5,
        7.006808120840928e-6, -2.5077925944895554e-6, 8.382636317712174e-7,
        -2.6079567097302436e-7, 7.525484271711463e-8, -2.0058284226891865e-8,
        4.914184289522528e-9, -1.104492847850762e-9, 2.244607848436202e-10,
        -3.943087661847446e-11, 9.139898826717874e-12, -4.831952423594555e-13,
        -1.6493137387960968e-12, -2.4068723698211126e-12, -7.5137394047667e-13,
        1.5947183702121445e-12, 2.4418265585590853e-12, 9.869405215434165e-13,
        -1.39782742113125e-12, -2.46384945609498e-12, -1.2081090621921754e-12,
        1.1835994986199687e-12, 2.4635356988117835e-12, 1.42222146626926e-12,
        -9.604646481204819e-13, -2.435048431788194e-12, -1.6187444422478054e-12,
        7.24450093315221e-13, 2.3854262890935777e-12, 1.7981336777069375e-12,
        -4.836365318784444e-13, -2.3090064502492985e-12, -1.956667243702105e-12,
        2.337315846693758e-13, 2.2085942453473373e-12, 2.1014287091702793e-12,
        1.2769148414237436e-14, -2.08305448502495e-12, -2.223209230279399e-12,
        -2.6369379405841435e-13, 1.943390360099463e-12, 2.3192194941134762e-12,
        5.075071293879957e-13, -1.7791888325752735e-12, -2.3886506391851195e-12,
        -7.531346958844818e-13, 1.596044750113624e-12, 2.441039738237544e-12,
        9.847360442369697e-13, -1.3968622115433895e-12, -2.4660796454393503e-12,
        -1.209700240190246e-12, 1.1865620453512562e-12, 2.4628976379235453e-12,
        1.4205685110299581e-12, -9.635274336421041e-13, -2.4380048239481933e-12,
        -1.6195420302501995e-12, 7.267213148663317e-13, 2.385828213292233e-12,
        1.7960594933922238e-12, -4.898204301315019e-13, -2.3061899121605282e-12,
        -1.9583616107214917e-12, 2.3748280199883607e-13, 2.2085159968466672e-12,
        2.0993371202697194e-12, 9.019179052528317e-15, -2.087081399298545e-12,
        -2.2173622842039472e-12, -2.58571049023283e-13, 1.9437394582358674e-12,
        2.320586081093297e-12, 5.059748542768007e-13, -1.7785121366785748e-12,
        -2.3911789050405738e-12, -7.492994106554896e-13, 1.5944241904621968e-12,
        2.4422920903069595e-12, 9.809984333904196e-13, -1.400722725404386e-12,
        -2.46430499588821e-12, -1.2037156080050896e-12, 1.1883458611078269e-12,
        2.465598605067054e-12, 1.4156878149775295e-12, -9.620926908157068e-13,
        -2.437606952141134e-12, -1.614883598722471e-12, 7.273273514070555e-13,
        2.3870083460402906e-12, 1.7947546497232451e-12, -4.872593751462709e-13,
        -2.3107764207915247e-12, -1.954722729619019e-12, 2.4121960387307943e-13,
        2.2114999520927564e-12, 2.0973143100501343e-12, -2.0203329529712895e-12,
        5.704193642568386e-11, -8.282957450688767e-10, 7.348198540302436e-9,
        -4.664864736279963e-8, 2.243134624033143e-7, -8.449067012581282e-7,
        2.535849903355229e-6, -6.069004051607794e-6, 1.1272948515435793e-5,
        -1.449250797252341e-5, 4.842930675127707e-6, 3.95750159639786e-5,
        -0.0001548683578253677, 0.00039260292768062403, -0.0007330305501038744,
        -0.003173949421002218, 0.004988023702912104, -0.002090486324883749,
        0.0011813293167273603, -0.0007207290922989147, 0.0004363049771480987,
        -0.0002530083929583581, 0.00013870650737178098, -7.181976251588904e-5,
        3.532061376879732e-5, -1.6618443323502558e-5, 7.511394203536696e-6,
        -3.257009531175992e-6, 1.3469671161791016e-6, -5.274328560531075e-7,
        1.9429030850209234e-7, -6.700038211212176e-8, 2.1541012488477473e-8,
        -6.427487977683494e-9, 1.7756161686359854e-9, -4.5202675609098346e-10,
        1.0225069667378397e-10, -2.335181693959028e-11, 5.396029238196372e-12,
        1.7412656745859192e-12, 1.5417886383306944e-12, -9.602062683490606e-13,
        -2.4333808513776374e-12, -1.6290341387691188e-12, 7.122208991073757e-13,
        2.38274307568587e-12, 1.8048198890876503e-12, -4.702842424727885e-13,
        -2.307400107742454e-12,
      ],
    ];
    const result = wavedec(data, "coif17");

    const reconstruction = waverec(result, "coif17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_coif17_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5000484858840457, 0.923294239986586, 1.2086252078747692,
      1.322676840494605, 1.265498203492451, 1.068610228996297,
      0.7860655064222669, 0.48078682776630566, 0.20956487039070115,
      0.01036697025045541, -0.10501378722250068, -0.15130028552391772,
      -0.16315569917255465, -0.1835082618881798, -0.2498601483268641,
      -0.3821580646526333, -0.5754039973368117, -0.7989914107303467,
      -1.0030599201815023, -1.1303883269739268, -1.130930579925262,
      -0.9753929706410889, -0.6644309889819341, -0.23107035036695675,
      0.2644197226525984, 0.7461476150027271, 1.138080654961342,
      1.3798032221368761, 1.4388835807929756, 1.316983382281693,
      1.0483375992231174, 0.6910545310688084, 0.3133917651381484,
      -0.021660356581863827, -0.2697957424903727, -0.4136574258302976,
      -0.46410126872857194, -0.4543545153445185, -0.42872160659555936,
      -0.4288254268120128, -0.4809595889034315, -0.5878234944914441,
      -0.7267934595961147, -0.8552276393355152, -0.9215197079432054,
      -0.8791477186726255, -0.7001746950123389, -0.3847439317929804,
      0.0359431886425674, 0.504105111577584, 0.94643349065132,
      1.2892242620374568, 1.4740694068937077, 1.470422875347578,
      1.2820781400434842, 0.9460376267925826, 0.5240652501017858,
      0.08895183391104289, -0.2912334629393921, -0.5671859110819594,
      -0.7174386886197542, -0.7504483432335861, -0.6993994226986694,
      -0.6112181705311946, -0.532687421777458, -0.4972337311335492,
      -0.5157489280390051, -0.5737659976625309, -0.635692849465401,
      -0.6550177916210908, -0.587880627835958, -0.4065300244377393,
      -0.10917875329960885, 0.2763716371755662, 0.6964456473298978,
      1.0818502721115986, 1.36252496711136, 1.4830498174996634,
      1.4153215413826898, 1.1653497324233568, 0.7725121778792017,
      0.3014017783644323, -0.17183778504700717, -0.5754843743823146,
      -0.8567842165251327, -0.9917130375999808, -0.9877749277483008,
      -0.8793651177384155, -0.7170272448148501, -0.5534002485884215,
      -0.42941762812865003, -0.36420709330333684, -0.35117344015213536,
      -0.3611726026231588, -0.35189077718761935, -0.28097332352093773,
      -0.11949215408807345, 0.13776536032225428, 0.4679308269307371,
      0.8228965158861116, 1.1388574955041686, 1.3503679880291644,
      1.4055721757271427, 1.2789283112505327, 0.9783032212373834,
      0.5446390417978635, 0.04416404910639196, -0.4450960558581559,
      -0.8493859585093146, -1.114135924066483, -1.2142827612531533,
      -1.1576747103069187, -0.9809135315796723, -0.7388079280272084,
      -0.49013452882676867, -0.2832555543464045, -0.145120304704684,
      -0.07629009278274168, -0.05309494282486114, -0.036234797208983066,
      0.01647804957680188, 0.1365760256765537, 0.3341363960940372,
      0.5925858706618121, 0.8705722356924135, 1.1105947416362272,
      1.252379447677127, 1.2477672942313152, 1.0734541146094019,
      0.7383922394379738, 0.2839212285038435, -0.22356455913012216,
      -0.705805447833412, -1.0886993747526015, -1.317444608732735,
      -1.3672949999391089, -1.2474733513543224, -0.9974310345801481,
      -0.6764735523523544, -0.3493460474183479, -0.07130707292162702,
      0.12371211394858905, 0.22907491987362139, 0.2642312024307404,
      0.26682526824144137, 0.2802717619391251, 0.34006810941245863,
      0.4624117758776089, 0.6380999961695271, 0.8333555094121814,
      0.9974742322251827, 1.075461964335622, 1.0225452311354424,
      0.8169248503024471, 0.46752043379375025, 0.014640179715858986,
      -0.47678519065532443, -0.9299588119473199, -1.2720521525824176,
      -1.449438451476476, -1.438767835259412, -1.2513093385001515,
      -0.9295896566138989, -0.5371946232018973, -0.14422018531543668,
      0.18812882353893928, 0.42013595032775924, 0.5404412854725417,
      0.5656929020215352, 0.5332829803217922, 0.4891702211848399,
      0.4739839952546163, 0.5110009797658179, 0.5990865871381945,
      0.7124263114547218, 0.8071505846180396, 0.8332071819054937,
      0.7484910401681202, 0.5316363489460701, 0.19016194948651838,
      -0.23822891173988728, -0.6917299362503916, -1.0966198781219718,
      -1.3827710005512834, -1.4988492546663688, -1.4236137377842335,
      -1.1706314270169174, -0.7852842663419799, -0.33478003183563704,
      0.10646027997808044, 0.47258143214170006, 0.7195374683706465,
      0.8327500808811363, 0.8275189958025567, 0.7423016331956994,
      0.6267156035746595, 0.5273849027141004, 0.47523982338436627,
      0.4774743110356324, 0.5161658807232244, 0.5538703028288346,
      0.5447355487626926, 0.44827469420361693, 0.24224386517273389,
      -0.06873804967498981, -0.451161103975173, -0.8479028526911803,
      -1.1897208760337863, -1.4103123560415967, -1.4613774965283648,
      -1.324072719479899, -1.0140700707117474, -0.5789511034856816,
      -0.08848955326691907, 0.3799270232265292, 0.7573336389646976,
      0.9969496798946511, 1.0825060713652126, 1.0293109862319818,
      0.8779939630780634, 0.6826358904009071, 0.49632896650417013,
      0.3577912229875854, 0.2823454852794377, 0.2594438290835709,
      0.2572567096542689, 0.23306271109980334, 0.14671137166168557,
      -0.02635025875196756, -0.28590299175375095, -0.6041013783146283,
      -0.9298407466528169, -1.1994432977868947, -1.3511681394760369,
      -1.3400607655008807, -1.1495180968424505, -0.7966938667230201,
      -0.3303260467202391, 0.17862064614821233, 0.651379603124016,
      1.0175398902123243, 1.229189120645752, 1.2697862490420608,
      1.1557851092071503, 0.9307778507348479, 0.653720887919689,
      0.3842072738704841, 0.16841811864523754, 0.029161517026669637,
      -0.03765058609934363, -0.059365619650833874, -0.07686756718786572,
      -0.13136175812066075, -0.251129829762706,
    ]);
    const expected = [
      [
        -0.7533337763830895, -0.9891001490960287, -1.014611523617004,
        -0.411866313105874, 0.7411401842620589, 1.813132293671315,
        2.084648947108374, 1.3384590783637897, 0.05083134485154581,
        -0.990196549703859, -1.3032256690432378, -1.0278411672142334,
        -0.6801795754019091, -0.6063039028400363, -0.6563383381395608,
        -0.38154869383932116, 0.4432025468526341, 1.4825742599173537,
        2.0348858863139188, 1.6094962333400769, 0.37392903055371496,
        -0.9396100936436861, -1.5994533192687868, -1.4183963650657951,
        -0.8140046228690098, -0.35289793106511314, -0.23155602678758447,
        -0.14696330768423244, 0.29326526867490255, 1.1180970127600163,
        1.7761586569902055, 1.738799445431013, 0.631381222189239,
        0.04538741394664891, 1.3247558671241781, 1.855751983599182,
        1.5203889627300482, 0.6748907818907076, 0.017155507273277186,
        -0.2150685254033416, -0.25909423972811335, -0.5405969778205117,
        -1.129902650829606, -1.5986208088049332, -1.3794118608155348,
        -0.32678317104191756, 1.0552121211573022, 1.9513364260115211,
        1.8624957608923434, 0.9772986901699283, -0.030632370043822257,
        -0.5849999417857834, -0.6425543177260129, -0.6064507344881129,
        -0.8313079581911499, -1.209474526464266, -1.2433026270760184,
        -0.5441100863825391, 0.7129122856542791, 1.8232384363136018,
        2.0794919727403003, 1.337899242325664, 0.1257968899152051,
        -0.8021220078391141, -1.0612942248616775, -0.8643930263343669,
        -0.7031946862384227, -0.8114276555225808, -0.9263350445059182,
        -0.5749202740716888, 0.39084851754866734, 1.529967327276918,
        2.0973491655828926, 1.648053396501212, 0.42624648268668985,
        -0.813857807185144, -1.4024940277563211, -1.2436100757838242,
        -0.7826261369745523, -0.5150666108618954, -0.5107751929869119,
        -0.3973562847881482, 0.19482964099282257, 1.1637514131953703,
        1.9097087228650742, 1.8086777630735025, 0.770235919508755,
        -0.6294608787531021, -1.5756261341419346, -1.6371992761326957,
        -1.0448321918051422, -0.40058384657420903, -0.10789048388777506,
        -0.05124374164246352, 0.1931476678068621, 0.8380429751603491,
        1.5706181459218602, 1.7646094301873987, 1.044244319364443,
        -0.3161680315874371, -1.539653421122084, -1.9336471326789835,
        -1.4105804966354183, -0.49404991822065736, 0.17495534937607757,
        0.3736793500800431, 0.3963641268847476, 0.653949004847051,
        1.1785426636887195, 1.520932895779582, 1.1553062027373724,
        0.020704340710063725, -1.3151603643039786, -2.0498155159030866,
        -1.7696186372313114, -0.7597079217663453, 0.26605433372201687,
        0.7642993955818732, 0.7541760233541542, 0.6703145944369604,
        0.8472363765664167, 1.1414833036438599, 1.058526180320361,
        0.2689296080113323, -0.9782538573444387, -1.955533502635653,
        -2.0132938555552684, -1.1105596597793774, 0.1505575717988145,
        1.0175796464054743, 1.1702885869856765, 0.8863097063263782,
        0.6720906036099056, 0.7299687889527197, 0.7703724009666751,
        0.34258455952894407, -0.638038152056611, -1.6825193983239735,
        -2.066699875349122, -1.434111647110071, -0.12514312687715848,
        1.071031506102488, 1.530894755629837, 1.2416710180767816,
        0.7019149803717613, 0.3992974054247197, 0.36381408855785846,
        0.20748653443871248, -0.4043422706597535, -1.3149570333546678,
        -1.9109263441884796, -1.6254738205655197, -0.4675440062983677,
        0.9219435754675052, 1.7369883164091786, 1.6367742685978481,
        0.9209908413530798, 0.24334149270789218, -0.060371504976617585,
        -0.10038242644071584, -0.33871522911739227, -0.21415263361843784,
        -0.07263479082476722, 0.03580805076793494, 0.5460600338537566,
        1.3150015255684664, 1.7963511963415033, 1.4387660902794077,
        0.2527030626226644, -1.1267270705217967, -1.8951228900804042,
        -1.6962712584676125, -0.8543278922619871, -0.037264971784215575,
        0.32960045710571667, 0.3669089808016245, 0.5059932001060655,
        0.9653929343655767,
      ],
      [
        1.9250627419637118e-11, -6.070034386206166e-10, 9.388617058790903e-9,
        -9.359855679538803e-8, 6.736625643877763e-7, -3.726225881220158e-6,
        1.645502474994161e-5, -5.946463104007846e-5, 0.00017868123267004123,
        -0.0004504818848114542, 0.0009546632209845931, -0.0016860010774044387,
        0.0024082434436972543, -0.0025412871232585823, 0.0013888232713126368,
        -0.000829998108343702, 0.06700133495857423, -0.09672179170082477,
        0.04758849942633974, -0.027393771225814247, 0.015945124262640394,
        -0.008936633887235881, 0.004751838095580048, -0.002399716527327955,
        0.0011612365818833847, -0.000543904926913816, 0.0002478604179548706,
        -0.0001095866278111482, 4.6592185244888186e-5, -1.885048609106008e-5,
        7.1949114181549605e-6, -2.57531362120833e-6, 8.609046550848949e-7,
        -2.678640576793407e-7, 7.730064056404447e-8, -2.0605247722407727e-8,
        5.0497177787079855e-9, -1.1342184908693198e-9, 2.303100733175569e-10,
        -4.151856551460953e-11, 8.700981006253218e-12, -2.0139198025618215e-13,
        -6.71201161660522e-13, -1.701958699714585e-12, -1.0180112693456043e-12,
        5.877656100442878e-13, 1.6553006646690754e-12, 1.1939924712318664e-12,
        -3.6562286956850163e-13, -1.5891067895251117e-12,
        -1.3481271700165129e-12, 1.3719200888162778e-13, 1.496158082165556e-12,
        1.4752143312341222e-12, 1.0002640611201934e-13, -1.3688281211854811e-12,
        -1.5765037493733498e-12, -3.2923943564702157e-13, 1.219143071489328e-12,
        1.6475752414456095e-12, 5.532419814579926e-13, -1.0493732321043902e-12,
        -1.6838625841839944e-12, -7.692388639486571e-13, 8.531576154866742e-13,
        1.692713441025825e-12, 9.670168185506018e-13, -6.505550367478332e-13,
        -1.666589345306667e-12, -1.1514512415900996e-12, 4.230782295343504e-13,
        1.6098198593726902e-12, 1.3094763234024316e-12, -1.9792855659962855e-13,
        -1.5238346353215502e-12, -1.4434278503215697e-12,
        -3.1993789764839375e-14, 1.4053902299912624e-12, 1.5524232458672235e-12,
        2.6869373589461654e-13, -1.2634922401751223e-12,
        -1.6312709194244346e-12, -4.936298639091448e-13, 1.097288963870305e-12,
        1.6744611289193164e-12, 7.085372082998668e-13, -9.082109403092004e-13,
        -1.6929230235157378e-12, -9.148025676099833e-13, 7.060810827642173e-13,
        1.6741567428748493e-12, 1.1020716207002228e-12, -4.911275004950338e-13,
        -1.623321142814464e-12, -1.2682490488226827e-12, 2.573128206775877e-13,
        1.5505675870824187e-12, 1.4087971735145454e-12, -2.3637335231787527e-14,
        -1.4432155677310892e-12, -1.5249291127577606e-12,
        -1.9913690837032009e-13, 1.3021366611639773e-12, 1.6133818649567163e-12,
        4.3402008180230093e-13, -1.1425414689450088e-12,
        -1.6708795621280668e-12, -6.499162967517905e-13, 9.628600015289325e-13,
        1.6891540992153227e-12, 8.635708167818934e-13, -7.62193329005656e-13,
        -1.6809614735936588e-12, -1.056560216699275e-12, 5.473163794030479e-13,
        1.6461024755826575e-12, 1.2265471404467336e-12, -3.2588585515986185e-13,
        -1.575099281346816e-12, -1.3742835909988148e-12, 9.176291737760465e-14,
        1.4715527631707937e-12, 1.4976552351230347e-12, 1.4333972708900454e-13,
        -1.346783567862796e-12, -1.5887900278625792e-12,
        -3.7379400104341857e-13, 2.9420597574559366e-12, -4.449927996750636e-11,
        5.407958124417786e-10, -3.398814324885179e-9, 7.942859356934827e-9,
        6.345300829052548e-8, -8.506975504136089e-7, 5.625980814862016e-6,
        -2.675399495669915e-5, 0.00010096811505733432, -0.00031673046765601367,
        0.000850160257185142, -0.0019979175036523972, 0.004208299826486462,
        -0.008205488417039112, 0.015728212281138236, -0.03448376831815402,
        0.023873223963767592, 0.0003022370400744184, 0.0005768024056835687,
        -0.0014491144936092247, 0.0015852720475242475, -0.0012944769340780748,
        0.0008841798017486151, -0.0005289233184233217, 0.000284622036075257,
        -0.00014054059273067466, 6.470586126483084e-5, -2.810586303508197e-5,
        1.159183839346177e-5, -4.544667998311096e-6, 1.6892653932378405e-6,
        -5.926883404637923e-7, 1.9535464664702023e-7, -6.020817259425105e-8,
        1.72703386642825e-8, -4.591251365046453e-9, 1.1236240851756683e-9,
        -2.510946378686774e-10, 5.322192318662039e-11, -8.917420026249053e-12,
        5.781653585859864e-13, -1.921368444748341e-12, -7.883243253463111e-13,
        8.011492498955611e-13, 1.6868813639522797e-12, 1.0156033584716978e-12,
        -5.882184117737571e-13, -1.6549146787819551e-12,
        -1.1956547980172337e-12, 3.676246419435561e-13,
      ],
    ];
    const result = wavedec(data, "coif17");

    const reconstruction = waverec(result, "coif17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5008735542028219, 0.9214623451834287, 1.1989537966699813,
      1.3011864619608606, 1.2323359516033894, 1.0298138384642996,
      0.7533137015837363, 0.4689167375098293, 0.23239049067920087,
      0.07596671889128981, 0.0019325694136386184, -0.015437730812564256,
      -0.020276104436102893, -0.060514090454243774, -0.1722584656110881,
      -0.36739603589091574, -0.627829648593107, -0.9080112384351023,
      -1.1452598548663353, -1.2752974935299946, -1.2490364960228586,
      -1.0462737577352867, -0.6826903398699624, -0.20823215002603485,
      0.30287123843536734, 0.7680668323471354, 1.1145110454604477,
      1.2947388396557964, 1.2961333995170503, 1.1419370008062077,
      0.8836909232717061, 0.5871585365478917, 0.3154151221174956,
      0.11346361713816572, -0.0017133710944686742, -0.04320877189802924,
      -0.04797731700137865, -0.06414389529825498, -0.13531767436353637,
      -0.2861756410193335, -0.5132447810221914, -0.7834500234481432,
      -1.0409581294837125, -1.2206636656448286, -1.2648984595225798,
      -1.1390591918213893, -0.8420714669818244, -0.4088887847013275,
      0.09576551188385778, 0.5909815101284583, 0.9972730049481412,
      1.2538874431420024, 1.3315612500228877, 1.2376229183202465,
      1.0122893109905748, 0.717230848753003, 0.41942598500468986,
      0.1744861657310341, 0.013713451416540068, -0.0618630661503306,
      -0.07907332838696834, -0.08261515597714494, -0.12026695956226574,
      -0.22733517071019177, -0.41456274150348654, -0.6628159645384548,
      -0.9260888018937333, -1.1421775726610868, -1.2483510025083486,
      -1.19799772294713, -0.9739253887814507, -0.5947957970246882,
      -0.11290325317836081, 0.3963023868615123, 0.8504445829532006,
      1.1782281555924852, 1.334795263109644, 1.3106686103908765,
      1.1321486978384094, 0.8531982711026801, 0.5409959427022537,
      0.25892096343079274, 0.05133820515860732, -0.06596636639954973,
      -0.10735665169109064, -0.11068421314200756, -0.12430763106542381,
      -0.19135547778065243, -0.33550915285330873, -0.5521783920956476,
      -0.807526054435976, -1.045736845168396, -1.2027513878440608,
      -1.2229662908170464, -1.0745800294542582, -0.7595590428234753,
      -0.3155360512151081, 0.19100853713252602, 0.6787143626621618,
      1.0690651427264295, 1.3035124701460385, 1.3557888784480547,
      1.2364182869823854, 0.9884102372425081, 0.6753541998243087,
      0.3650393095565023, 0.11282404356218584, -0.05101033509783831,
      -0.12676803156384472, -0.14244014120425044, -0.14333389783827777,
      -0.17711407075745628, -0.27833249934333987, -0.45664743384337,
      -0.691962040590651, -0.9378933399647329, -1.1327902381869601,
      -1.2155207697959638, -1.1419631951956728, -0.8978985023549261,
      -0.5048779922414243, -0.017406400843947845, 0.4880143891901566,
      0.9293599856561501, 1.2370420318545232, 1.3689294451653728,
      1.3187510168557626, 1.1158748725332186, 0.8166434780465737,
      0.4895718919255874, 0.1982458003194617, -0.013706319808261425,
      -0.13178085145927182, -0.17167952632887076, -0.1722002732715194,
      -0.1819752088061692, -0.24369288639631065, -0.3800895775984531,
      -0.5855223295661376, -0.8254676511358943, -1.0442048158008244,
      -1.1787824970854877, -1.175692357987713, -1.0059190639905422,
      -0.6744012487405727, -0.22133161013818659, 0.2852098178753922,
      0.7635874690914772, 1.1364235623922638, 1.3475121629296891,
      1.3736720332700467, 1.228655578051893, 0.9582425847592123,
      0.6278745743107728, 0.3060569151027559, 0.0477921267375368,
      -0.11775467486397856, -0.19229873674688264, -0.20505029846132566,
      -0.2019692767022261, -0.2306449437738889, -0.3249178711515677,
      -0.4934171335643303, -0.7151512210587816, -0.9434348241459677,
      -1.1172369873113475, -1.1770688733692904, -1.081302590864861,
      -0.8186464106290323, -0.41344273478484905, 0.07773605958834391,
      0.5775061255583881, 1.0043694019782994, 1.2905980681635871,
      1.3969000117630814, 1.3202675386896294, 1.093135903847309,
      0.7741759088044597, 0.43315172467672053, 0.1337510682667677,
      -0.08123726713865381, -0.1986808022248814, -0.23568738304413533,
      -0.23205088393034135, -0.23671569106498563, -0.291968746647247,
      -0.41964838399054166, -0.6131190202311659, -0.8372406754139083,
      -1.036456603862077, -1.1489771866332406, -1.123410459178193,
      -0.9335028527323725, -0.5870887902002306, -0.12679592599292436,
      0.37785653335983416, 0.8451328359668882, 1.198958769506317,
      1.385602766010133, 1.3850513301437153, 1.2143086106953875,
      0.921892268798075, 0.575019742855287, 0.24281056410861668,
      -0.020197417272656004, -0.18605432734898478, -0.2579661268213846,
      -0.2664205803469479, -0.25807269215755146, -0.2804724418585537,
      -0.36678947964600356, -0.5246751308950475, -0.7323063078559544,
      -0.9427633192784134, -1.0956950413207358, -1.1332909056674123,
      -1.0164122293305213, -0.7366403261796626, -0.32100371057887267,
      0.17200451580559506, 0.6642896599891521, 1.0750519183810012,
      1.3385723408652859, 1.4185020944864744, 1.3151449072126173,
      1.0639925801700396, 0.7259832343841939, 0.3720344757693005,
      0.06582512734678497, -0.15080347435310576, -0.26618129810092184,
      -0.2988914017014972, -0.2897726040563785, -0.2881185749486639,
      -0.3358503176521066, -0.45395164819779926, -0.6348495030571666,
      -0.8428511280460386, -1.0226258151073635, -1.1135909949543312,
      -1.0664836337513726, -0.8577790568880416, -0.49812383808388433,
      -0.03245044728298993, 0.46844546761175265, 0.9229020171052996,
      1.2563094049190293, 1.4175352896781015, 1.389806374260711,
      1.193391747702162, 0.8795045689937608, 0.5170530576306687,
      0.17566151532145619, -0.09071087270538714, -0.25543177490318436,
    ]);
    const expected = [
      [0.4971639416570967],
      [0.1725378779591304],
      [0.8461345374250153, -0.6844996963074642],
      [
        0.7519871308256642, -1.3452511479372151, 0.8651545799200273,
        -0.524578960872407,
      ],
      [
        1.4419211014772593, -2.37912709516375, 0.6784865266232898,
        1.511051408776146, -1.6162214971015123, -0.2815739331716184,
        1.6504298750157727, -0.6944587923328419,
      ],
      [
        1.6068048811221403, -3.4738779986028105, 1.9535494012729726,
        1.2823635559765711, -3.0720357530217415, 1.9321855376364028,
        0.77033429989443, -2.488534390239954, 1.9365990990834776,
        0.08780876344989585, -1.8093897654625901, 2.0137634709126813,
        -0.7095279421046512, -1.1274415641609434, 2.1778521599206,
        -1.536895246825707,
      ],
      [
        -0.5994003673360291, 0.3704153798560297, 0.4259615879199137,
        -0.9331275230471713, 0.46137712082201376, 0.6515508894939663,
        -1.2587312747313795, 0.5899656902532768, 0.8243624125409919,
        -1.5615720725758824, 0.7469763764487998, 0.9402630362473369,
        -1.8279265275433785, 0.9210702913632585, 0.9984741957464912,
        -2.0457486548468817, 1.0994460442291987, 1.0015698459606086,
        -2.2053378282592746, 1.2685994997595238, 0.9552809959478221,
        -2.299875159321097, 1.4151276605785612, 0.8681184531942336,
        -2.325797569749019, 1.526530141806048, 0.7508358927690826,
        -2.282988149244591, 1.5919618172928263, 0.615764564273866,
        -2.174771947353143, 1.6028930056658304,
      ],
      [
        -0.8097712938252942, 0.375197436758107, 0.31170396994205096,
        0.09852936040833238, 0.5290227044087075, -0.397684945973802,
        -0.8939693946991255, 0.28262215754746656, 0.3954117063108452,
        0.05413774038119173, 0.5124938654451654, -0.2522157331820972,
        -0.9506888939470347, 0.16776823192703438, 0.47422860830505953,
        0.03097286050105587, 0.4735034271092549, -0.10930273172042715,
        -0.977223010008881, 0.03510305523642154, 0.541967522607767,
        0.030834413058395488, 0.4164199079488313, 0.024529043629424097,
        -0.9724089969166357, -0.10981477627898606, 0.5929505419740644,
        0.05399783619042259, 0.3465814521666125, 0.143400193419972,
        -0.9366922414712797, -0.26063922225523095, 0.6223503291673717,
        0.09919631416642848, 0.26997190598105547, 0.242401194068241,
        -0.8720992602341604, -0.4105865823579974, 0.6264833366987885,
        0.1636932435408833, 0.19286039211989148, 0.31785990773794437,
        -0.7821211631486942, -0.5528112761949907, 0.6030379045278792,
        0.24344099319856535, 0.12142527782123086, 0.3675370474251216,
        -0.6715142978587055, -0.680786083094864, 0.5512239645928706,
        0.3333168005031651, 0.06138432450002895, 0.3907384609240737,
        -0.5460295491196993, -0.7886650417257699, 0.4718355935724291,
        0.4274221877850566, 0.017652443421447395, 0.38833789594921797,
        -0.4120858668668891, -0.8716082008477832, 0.3672226736214448,
        0.5194286102803483,
      ],
      [
        -0.35417108669382313, -0.1962160870674392, 0.048684662761922626,
        0.19551512178725494, 0.16724931306254057, 0.05235004913502565,
        0.0034212467991182986, 0.0790152054328582, 0.18415437359063042,
        0.167760105505651, -0.01856932941801881, -0.25709230029955293,
        -0.36140467186847974, -0.24497305239526057, -0.0009861027346631523,
        0.18260755263947304, 0.1921516110865194, 0.08144242941593897,
        0.003371870578972279, 0.05032746181973361, 0.16056212869421835,
        0.18208572798825562, 0.03127872271534704, -0.21000203416322083,
        -0.35684447527031166, -0.2872914711254168, -0.05492367556604838,
        0.15933492177203756, 0.21057983862676816, 0.11368347652154624,
        0.012169493133525305, 0.026623845638942878, 0.13238988493302312,
        0.1861620085961404, 0.07507595222683305, -0.15844306696484978,
        -0.3407494855569738, -0.3211270264793836, -0.11070966343614641,
        0.12623264074267881, 0.22076038351417104, 0.1467831760316702,
        0.029267351404894407, 0.009633211196585986, 0.10193204117683746,
        0.18055806360097915, 0.11102604787086723, -0.10492493164454697,
        -0.313971668369014, -0.3448600964561887, -0.16577929504946842,
        0.0844077546996238, 0.2213640469497984, 0.17834312490335003,
        0.053568780898185286, 0.0006319813766511861, 0.07157223723412459,
        0.16639255414324816, 0.1378129183651613, -0.05201305980750104,
        -0.27790746784665327, -0.3573864679857775, -0.2175640613162223,
        0.035481506927008466, 0.21158854818541362, 0.20599865491126484,
        0.08349130201585508, 0.00036822369442901515, 0.04364098834307403,
        0.1452628919941638, 0.1546705324320905, -0.002185058310846144,
        -0.2344184952474025, -0.35817887870031895, -0.26363492984408654,
        -0.018497821712627704, 0.19121086127820697, 0.2275594491315701,
        0.11705926601617553, 0.009016715759001426, 0.02027675864142056,
        0.11914697107699596, 0.16142088377664754, 0.04230753236275242,
        -0.18572596616531056, -0.3473158562763176, -0.30183791739602694,
        -0.07516682517251239, 0.1606063192189915, 0.24114051314533425,
        0.1520197098411815, 0.026167604245822484, 0.00329851675783438,
        0.0902831373848828, 0.15847794219047034, 0.07956406710055197,
        -0.13428495631674575, -0.32547620561276497, -0.3304142422612251,
        -0.1319772355956066, 0.1207333347601447, 0.24527591530145204,
        0.18597472714088317, 0.0508493210542611, -0.0059028483473093085,
        0.06103536275144128, 0.14681741321480135, 0.10813905771466237,
        -0.08264570461392329, -0.29389946940074496, -0.3480981637295905,
        -0.18633707771978159, 0.07308456800571228, 0.2390087005096001,
        0.216522706732275, 0.08158444157062703, -0.006447963651131372,
        0.033751438943455864, 0.1279140998731585, 0.12711990030675235,
        -0.0333099345504162, -0.25431464410555105, -0.3541868980907123,
        -0.23575462482078136, 0.019607304126584957, 0.22195175259222422,
        0.24140027460657829, 0.1164752669472285,
      ],
    ];
    const result = wavedec(data, "db1");

    const reconstruction = waverec(result, "db1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4891245152916047, 0.9026639708872506, 1.1809827904833778,
      1.2925506940468223, 1.2394449536892829, 1.054974881808289,
      0.7941358398531817, 0.5193481931792943, 0.2850683461496335,
      0.1250950451514093, 0.045678532339727074, 0.026053865557075423,
      0.026135531431142625, -0.0007001439115520425, -0.09310267875679112,
      -0.2693002961212746, -0.5199937378952824, -0.8085206650086689,
      -1.0783835698850823, -1.2663659467319537, -1.3180292534992768,
      -1.2017461963225977, -0.9177454738402601, -0.4998425253109581,
      -0.009313970356974878, 0.4777014303834945, 0.8863028641654752,
      1.1585966320202599, 1.2653862493187404, 1.2110415746927914,
      1.0304836791531604, 0.7791563258401554, 0.5185647172831327,
      0.3010240188699739, 0.15741222865476096, 0.09092914456903195,
      0.07832572304974156, 0.07817155488596988, 0.04394712908947185,
      -0.06147262157966832, -0.2537312332898781, -0.5204874011060957,
      -0.822277460669561, -1.1006664206172183, -1.291761728731495,
      -1.3417885607488889, -1.2208682562326119, -0.9315440861740256,
      -0.5098633525099749, -0.018639559599390232, 0.46556650406823163,
      0.8686674552055962, 1.1346088013631082, 1.2365717473506714,
      1.1812006063148068, 1.0049544439657785, 0.7636156990022489,
      0.5176566880603153, 0.3171548733908417, 0.1900155629969847,
      0.13639221561789183, 0.1306088406080112, 0.1299836867860566,
      0.0882053546887957, -0.030241142911610952, -0.23837144238336438,
      -0.5208146991836341, -0.8353731911780815, -1.1217813521095696,
      -1.3155915196612273, -1.3637977588806391, -1.2383328789993027,
      -0.9440585170143279, -0.5191959716121866, -0.02798833555822193,
      0.4527141363338686, 0.8497650754854292, 1.1090428469373956,
      1.2061454244140073, 1.1499687400985252, 0.9784327346506078,
      0.74754770161538, 0.5166368736394465, 0.3334473985892373,
      0.22286525919384104, 0.18200719546351024, 0.18283183865840003,
      0.18150191085903195, 0.13201764470126448, 0.0005567565677746522,
      -0.22323012771489814, -0.5209606561927795, -0.8477751957317757,
      -1.1416876034446088, -1.3378166550713422, -1.3840285458474448,
      -1.2541264862955201, -0.9552894493826285, -0.5278503952722058,
      -0.03737176408154397, 0.4391399325869735, 0.8296050982058255,
      1.0819247618888377, 1.1741478682603017, 1.1173944832509684,
      0.9509651018759697, 0.7309861736150574, 0.5155173971685373,
      0.3498870220353041, 0.25592045970750366, 0.2277128392308188,
      0.23492326726544321, 0.2326568182895852, 0.17532823657591542,
      0.03088738765964888, -0.20831541528065262, -0.5209098466236084,
      -0.8594512584113617, -1.1603458131506768, -1.358400653409995,
      -1.4024552152057972, -1.2682380193048566, -0.9652395148051162,
      -0.5358376276352622, -0.04680115835787019, 0.4248407404181649,
      0.8081989465277224, 1.0532829566849564, 1.1406219575755139,
      1.0835280766832254, 0.9225990034645019, 0.7139649847167264,
      0.514309703635249, 0.36645812168631237, 0.28913929523912857,
      0.27344729910834914, 0.2868117152204792, 0.2833797122192652,
      0.21808257281719237, 0.06071841253011834, -0.19363435756979575,
      -0.520646439764112, -0.8703696782190138, -1.177718095881264,
      -1.377309280028713, -1.4190546926663354, -1.280658941179679,
      -0.9739132646836228, -0.5431696162959863, -0.05628762861654368,
      0.40981468412298416, 0.7855600982289415, 1.0231482276242043,
      1.1056127977433357, 1.0484214105444152, 0.8933827184278424,
      0.6965179673733426, 0.5130245288363376, 0.38314404034323174,
      0.3224789440652234, 0.31914821783949143, 0.33842591926448334,
      0.3336027108654826, 0.26022737785706707, 0.09001888155748727,
      -0.17919294105751088, -0.5201542456137789, -0.8804993389844272,
      -1.1937681171570085, -1.3945106077551581, -1.4338065684016663,
      -1.2913832353469465, -0.9813171385063433, -0.5498592027747806,
      -0.06584203232943206, 0.3940611968840137, 0.7617040867458746,
      0.9915537212906222, 1.0691676530233563, 1.012127937399868,
      0.8633652603056152, 0.6786788507007727, 0.5116718705648182,
      0.39992710285741906, 0.3558956938244762, 0.3647528236343309,
      0.38969487326256047, 0.3832588490896657, 0.3017107322576219,
      0.11875926709628931, -0.16499609634624518, -0.5194167622349029,
      -0.8898097789958516, -1.2084611660249303, -1.4099750739219623,
      -1.4466931250610935, -1.3004073996827739, -0.9874594289818714,
      -0.5559200716330105, -0.07547492503758857, 0.3775810505246484,
      0.7366484985719144, 0.9585348949994003, 1.0313358752559316,
      0.974702583207746, 0.8325962899690362, 0.6604811954989798,
      0.5102609620780235, 0.4167886360686857, 0.38934500565629154,
      0.41019802634405267, 0.4405479371472088, 0.4322821782477041,
      0.3424821441290332, 0.14691149411847293, -0.15104771091453117,
      -0.5184172244346665, -0.8982712602125622, -1.2217642254927517,
      -1.4236755337463318, -1.4576993614493556, -1.3077304365837106,
      -0.992350244185269, -0.5613666983499507, -0.08519651192442204,
      0.3603763827494847, 0.7104129669909041, 0.9241294732856191,
      0.992168829211657, 0.9362016562516707, 0.8011260280500705,
      0.6419583304940472, 0.5088002479047414, 0.4337089914501193,
      0.42278158058717796, 0.45542051473693856, 0.4909149454481489,
      0.4806078641590071, 0.3824926176533572, 0.17444896769812346,
      -0.13735064442737488, -0.5171386536681889, -0.9058548369156375,
      -1.2336460405991048, -1.4355873099611858, -1.4668130118340152,
      -1.3133538389702475, -0.996001466810534, -0.5662142960870483,
      -0.09501660025630543, 0.3424507217910369, 0.6830191621311482,
      0.888377400495969, 0.9517198147092751,
    ]);
    const expected = [
      [0.1132429418291333, 0.24505936141189638],
      [1.3149629233653437, 1.0378286919059088],
      [
        0.497037230780921, -0.12358819090613676, 0.5059132304759182,
        -1.3653966696849746,
      ],
      [
        1.7230748950819839, -1.9768006163821172, -0.8849472810729575,
        1.7560455306563498, 0.9883900372079297, -2.69721730950343,
        0.36423110421631805, 2.2220438219389056,
      ],
      [
        1.5050752387299677, -3.225110268342597, 2.1651461313044145,
        0.059046526397723786, -1.5564643829014988, 2.0177829169840713,
        -1.7826320483355425, 0.5671764695243258, 1.6365287158357833,
        -3.216777156087704, 2.1888852765084277, 1.0333318328097056,
        -3.4536370673816172, 2.7649430952021636, 0.06529175845787394,
        -2.2488374798401125,
      ],
      [
        -0.6393430033653827, 0.35949434001819397, 0.7168961801219238,
        -1.3472718822995544, 0.517879257428367, 1.1657066292563152,
        -1.9146786767346207, 0.7128984801371474, 1.3913463980065748,
        -2.2440893494557734, 0.8737839969346025, 1.3926773153850147,
        -2.2749721387908495, 0.9278852850400524, 1.2101489245773094,
        -1.9957149520637034, 0.8188861819583286, 0.914166513171208,
        -1.44645239344816, 0.5220828446455558, 0.5878732758372287,
        -0.7121212371775361, 0.05326025113208832, 0.3081351235307726,
        0.09291992778660862, -0.5309758245965367, 0.12882385171487537,
        0.845683855165545, -1.1417652656059836, 0.0699375305476132,
        1.4366659824817356, -1.693385624647592,
      ],
      [
        -0.7972611230395119, 0.3414424630373173, 0.3168214809188958,
        0.07299610982828061, 0.5488051004385972, -0.23245176503418663,
        -0.9365803951084515, 0.09122881374652447, 0.41964239779927676,
        0.023568091821665894, 0.5137805034530551, 0.08511433381639333,
        -0.9441671915764211, -0.2072480485483872, 0.4668792907584352,
        0.03290762561040436, 0.4085751766720917, 0.3611173676271078,
        -0.8176035444216111, -0.5063545297660526, 0.43210844974715346,
        0.09573681183058405, 0.26809646335371, 0.5553842032956978,
        -0.5775075937440655, -0.754880845794617, 0.3047955380101215,
        0.19088556013275945, 0.1306822306597321, 0.645285904828889,
        -0.26368916725291003, -0.90783923646951, 0.09388891705637126,
        0.28633863571326723, 0.029398364646185393, 0.6290500864717243,
        0.07234312896801876, -0.9353049682430249, -0.17266294121730252,
        0.3468660583108079, -0.015200734112625569, 0.5247967230429221,
        0.3770248600076944, -0.8284995693745386, -0.4524780453420453,
        0.3425712382199462, 0.0006875498925018597, 0.3656032052986218,
        0.6046048493580691, -0.6018605120644928, -0.6965386340421275,
        0.25648048649783073, 0.06375328307318245, 0.19171823857370343,
        0.7252852751780583, -0.2906471072133541, -0.8586762800073808,
        0.08948530909776753, 0.1471340031807457, 0.0416174891863616,
        0.7300459069272875, 0.0554667501219861, -0.9048249422161571,
        -0.16602153339571657,
      ],
      [
        -0.3458632616072769, -0.19680112466825694, 0.03755142912674825,
        0.1844410553646587, 0.16566086853002018, 0.056155954747328825,
        -5.774649334444604e-5, 0.06533845898789481, 0.1772670326773958,
        0.1908218900288121, 0.03653147455369499, -0.2008188367291398,
        -0.34685606757359955, -0.2889248446297847, -0.07551166255207187,
        0.1276737123328454, 0.1842660935309811, 0.10154887071951695,
        0.008911964822442699, 0.02420032356291957, 0.13594736808180072,
        0.21339779761201844, 0.13512478822053786, -0.08550356730660169,
        -0.2981733062695688, -0.3423853911110206, -0.1880489292658558,
        0.03915330930849659, 0.17065226312676252, 0.1417761927929932,
        0.03791743256167844, 0.0004420505067887909, 0.08375432166104368,
        0.19971754218388418, 0.20252115278182337, 0.03408695864754707,
        -0.2080833968889204, -0.34733625042437205, -0.28075741155055584,
        -0.06866189100440412, 0.12129427266987503, 0.16327861231118285,
        0.07819338064460074, -0.0005831107951659031, 0.03499066016219737,
        0.15824122341688715, 0.23109277709838333, 0.13868418239294966,
        -0.09185462719926463, -0.3022450537054436, -0.33694465202901586,
        -0.17841694521696694, 0.0401307033953906, 0.1555485918914402,
        0.1171183614271809, 0.019945799720200358, 0.001602621440042501,
        0.10213510374903366, 0.2210376421637567, 0.21276458007827648,
        0.031151279388013542, -0.21425229722114902, -0.34580100367357064,
        -0.27107518716357826, -0.0617579997917711, 0.11379403896302587,
        0.1411776031524189, 0.05467266649418945, -0.00945006925948591,
        0.04617205006328903, 0.1798545685512322, 0.2472916734499811,
        0.14113227977571408, -0.09786057436362294, -0.30458175472793175,
        -0.32958410606485306, -0.16800017742481732, 0.04044041771382212,
        0.13920440044723842, 0.09183937415729654, 0.0023551791004909617,
        0.0034105233660093326, 0.12035558194899826, 0.24109605057394878,
        0.22151447737985652, 0.027786440246385657, -0.21924983969203538,
        -0.34225182343263094, -0.25996278047634086, -0.05488133744276602,
        0.10519109776081081, 0.11809176815962047, 0.031134907912392484,
        -0.01763669242881255, 0.05766322640493099, 0.20064534168826953,
        0.2619074138558094, 0.14249185077739268, -0.10343962840580279,
        -0.3051444059302644, -0.3203589525771446, -0.15689737556692174,
        0.04004578484819021, 0.12170375044434023, 0.06609491557448244,
        -0.014745312336539251, 0.005844774169492861, 0.13828933282352812,
        0.2597694742112908, 0.22874406941576642, 0.024058479290730794,
        -0.22300747269685606, -0.33670316782035387, -0.24751324238048383,
        -0.048111089962866505, 0.09551289267438434, 0.09415698316869642,
        0.007726846321997383, -0.025098352650252898, 0.06937795614193476,
        0.22047562010527516, 0.2748638491312235, 0.1427940409673467,
        -0.10851202176724883, -0.30390542288555716, -0.309336109967195,
        -0.14521020292028824, 0.0,
      ],
    ];
    const result = wavedec(data, "db1");

    const reconstruction = waverec(result, "db1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db2", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4963547669217874, 0.9143173110329952, 1.1923360711744289,
      1.2984581606138372, 1.2359474511093411, 1.040496243338381,
      0.7698664304303773, 0.48867765219833864, 0.25224501762874024,
      0.09355932377528992, 0.016653233602332618, -0.0020731098579088586,
      -0.00505636474693999, -0.0397220051735222, -0.14330377986974352,
      -0.33039336118432483, -0.5865796193247201, -0.8699667499292939,
      -1.1203241198620273, -1.2736381919066253, -1.2784151433485236,
      -1.1095864959085093, -0.7764287526500686, -0.32238290004626324,
      0.18332134426863164, 0.6602793153260171, 1.0342402364070353,
      1.2529458307443713, 1.2966475955989853, 1.1808073974686857,
      0.9504448418503345, 0.66768039775123, 0.3957076237614852,
      0.18328565054937118, 0.05365941810344682, 0.000640077435136388,
      -0.007286523067254409, -0.016032228084234934, -0.07112759142061892,
      -0.2030510616050002, -0.4165976454747696, -0.6871773201380273,
      -0.9651452762431783, -1.1871871957793083, -1.291944257898142,
      -1.235934876885237, -1.0057033107819129, -0.6230348298744534,
      -0.14179501553910046, 0.3629569929453616, 0.810994536706638,
      1.1342111543496953, 1.2909748909872996, 1.2740905157683453,
      1.110514586283572, 0.8530327175290415, 0.566110725940238,
      0.3095649905326884, 0.12420088933223195, 0.023016779448126634,
      -0.009891780062527472, -0.012591924427752366, -0.032626159167634006,
      -0.11179913958408083, -0.2725098001699956, -0.5093014813625476,
      -0.7879573167811584, -1.0525193308544203, -1.2385550280176685,
      -1.2893598478641937, -1.1709866584004611, -0.882240485022605,
      -0.45700841993271357, 0.04179899048691342, 0.535319682324074,
      0.9456902667944598, 1.2127646178568896, 1.3065484488922925,
      1.2323726570800289, 1.0276486056518206, 0.7511528375125773,
      0.4676441466885075, 0.23175346729293822, 0.0752205733352519,
      0.0006504826765672544, -0.016740867709910158, -0.01999152862697473,
      -0.05637565137049427, -0.16226682499025008, -0.3509338758484341,
      -0.6065641881556614, -0.8862030174141079, -1.1292503504269051,
      -1.2721923873600103, -1.2648650524903184, -1.0841061021204146,
      -0.7412658231413669, -0.28156127489645266, 0.22470673895087104,
      0.6970160390553803, 1.0619801190611264, 1.268987531588304,
      1.3003418346514632, 1.1735000364163362, 0.9349866633095445,
      0.6476378358515313, 0.3744793387941612, 0.16334810057476606,
      0.03612618489419622, -0.014765220221486686, -0.02185341814752777,
      -0.031398370707408196, -0.08851644667953495, -0.22262859893400494,
      -0.4371331318144926, -0.7061137110580697, -0.9790770064102686,
      -1.192635020097919, -1.2862359867853463, -1.2179682757794106,
      -0.9763917446706332, -0.5853116116625496, -0.10016003518142864,
      0.4032519952026913, 0.8449361852835964, 1.1579606599135437,
      1.302534100121163, 1.2735484745521988, 1.0998288432881975,
      0.8354136771770834, 0.5451732537135561, 0.2884651070887514,
      0.10497348989446675, 0.0062737297513033585, -0.024840344843700443,
      -0.027241871499613435, -0.048556009786731524, -0.12992526517637387,
      -0.29253181240590653, -0.5294996831991587, -0.8054117840968157,
      -1.0637090345714861, -1.2401939100011234, -1.2792610574266385,
      -1.148733303342706, -0.849484889025611, -0.4173112689495271,
      0.08356549170504823, 0.5738728320136643, 0.9763347945474921,
      1.2322560866624768, 1.313623949295553, 1.2278328812593489,
      1.0139859049568414, 0.7318307534312296, 0.44621725718981287,
      0.2110513513876171, 0.056797740696279575, -0.015368808022244163,
      -0.03139898007591369, -0.034901167580108305, -0.0729640183080249,
      -0.18107481855770863, -0.3711704388368314, -0.6260490850801953,
      -0.9017293222736433, -1.1372868811313457, -1.2697547621835816,
      -1.2503355817266795, -1.0577900512466658, -0.7055331980142867,
      -0.24052386617451416, 0.26591902564322484, 0.7332163630394444,
      1.0889011712265728, 1.2840471242868796, 1.303023595915108,
      1.165270252973324, 0.9187823046693258, 0.6270649711529657,
      0.3529293491470452, 0.14325430291833297, 0.018542218280172384,
      -0.03017078405002596, -0.036401865220518845, -0.04672567479023909,
      -0.1058118056448934, -0.2420026966827462, -0.4572981098031071,
      -0.7244751347057191, -0.9922296844188846, -1.197147191292203,
      -1.2795277299659467, -1.1990603729567515, -0.9463285379267136,
      -0.5471390579438534, -0.05844876896949771, 0.4432365632854771,
      0.8782271892531083, 1.1808162711189345, 1.3130833517539147,
      1.2720119606193108, 1.0882746761055744, 0.8171229354724963,
      0.5237833345876822, 0.26711028872200043, 0.08563703615088519,
      -0.010493343821157575, -0.03977676216600856, -0.041864383466250765,
      -0.064429582817017, -0.14792305373314857, -0.3122952641814059,
      -0.5492566604517928, -0.8222166332492434, -1.0740571808801966,
      -1.2408633775152575, -1.2681701132318288, -1.1255936284135848,
      -0.8160761461501864, -0.37729421116733713, 0.1252670396645806,
      0.6119841989696487, 1.006226898273706, 1.2507949906946358,
      1.3196786874213453, 1.2223311151751832, 0.9995182749457344,
      0.7119148857148336, 0.424413604799998, 0.19015505903736063,
      0.038305763128075876, -0.03139132788417304, -0.04603508285655379,
      -0.049772765038177014, -0.08947347331293554, -0.19971269700195082,
      -0.39108721459055606, -0.6450193729041855, -0.9165340352225005,
      -1.1444280164451783, -1.2663277503964223, -1.2348384535430448,
      -1.0306590664501172, -0.6692587654610803, -0.19930258812945073,
      0.30692616391790484, 0.7688520625395433, 1.1149822374765253,
      1.2981125146433177, 1.304690289359419, 1.156123913000832,
      0.9018439252932564, 0.6059775733800181, 0.3310744869211176,
    ]);
    const expected = [
      [
        2.4168937612948267, 2.416721389026645, -0.015442534812027287,
        0.3892636662664517, -0.730500921273533, 1.790900526947836,
      ],
      [
        -0.007225197415207885, -0.024554378168351987, -1.0882077054357384,
        0.46207754179160004, -0.3918387337155317, 0.8152171511907068,
      ],
      [
        -0.49646910944080175, -1.5989820650657236, -1.3285222007882267,
        2.129333347944042, -0.05420570117154952, -2.20197939818969,
        1.6548316017470834, 0.8729251008902904, -2.3234796046212467,
        2.046878848544634,
      ],
      [
        -0.3123923435363293, 1.9918564592492989, -2.2725961234008785,
        -0.07678452729675961, 2.7961025230214194, -3.3894629371421376,
        0.8691531072439616, 2.7311704381726742, -3.9769454747550457,
        1.524858962163781, 2.3243736100987182, -3.918867811245046,
        1.944400542772145, 1.4889865460097869, -3.2657484197347904,
        2.239803693440633, 0.15137188812091854, 0.568396341225366,
      ],
      [
        -0.14898830396810825, 1.4107860460663524, -0.10529573484935714,
        -1.697448013103927, 1.82439605766871, -0.2823731137826426,
        -1.3625067539421682, 1.5996593454055776, -0.39103383165630995,
        -0.9678244331903854, 1.243382639501927, -0.4072628250821001,
        -0.555434398943219, 0.7812742084954356, -0.31835661022723294,
        -0.16704283961447627, 0.24977122830539047, -0.12458269227572143,
        0.16041603466635998, -0.30755908255732733, 0.1606079888404861,
        0.3986514711291001, -0.844381301635044, 0.5118448327935543,
        0.530897950400748, -1.3162529758986246, 0.894445554058166,
        0.5534995651125896, -1.6850890540273444, 1.268089249306229,
        0.4760312170788089, -1.9229546157411983, 1.2973968692209534,
        -0.8008927440750238,
      ],
      [
        -0.17780841217803234, 0.31955697264735256, 0.1929970145390521,
        -0.21525582788023423, 0.21476447555770203, -0.1759700650190994,
        -0.47560001702964183, 0.36368105961267944, 0.31402740284157515,
        -0.2309642307901028, 0.16314905854499206, -0.051691210310362445,
        -0.5266313005467624, 0.23354773500468667, 0.41866458636962833,
        -0.21023450932248253, 0.08810248049376221, 0.06079474604048726,
        -0.5330160769368465, 0.0824560503302042, 0.4949297428941886,
        -0.1532652784748695, 0.000538424836605482, 0.15014506013425155,
        -0.4959441398440097, -0.07603379692491305, 0.5334819660238669,
        -0.06453105678843332, -0.08719574229664347, 0.20795185314777212,
        -0.42094806578622024, -0.22759914005432955, 0.5286587338106766,
        0.047659057723529324, -0.16273133068347115, 0.22962082139649143,
        -0.3172643246226783, -0.35863415845395485, 0.4791281013781622,
        0.17202856270468886, -0.2150930710210119, 0.2148262953770338,
        -0.1968032808398832, -0.45765233824121687, 0.38808091391173555,
        0.2955334171706574, -0.235960944552439, 0.16749441456772998,
        -0.07284050576949784, -0.5164618805812745, 0.2629409665646655,
        0.40476508088260443, -0.22064042370128295, 0.0953175855415844,
        0.041428249552668266, -0.5309884094783055, 0.11462309327751818,
        0.48740488289349254, -0.16863416288603872, 0.00885441365173105,
        0.13431158859650216, -0.5016574581941682, -0.04358199186071554,
        0.533572004832957, -0.3559918420436157, 0.07735521404108744,
      ],
      [
        -0.30395397758911336, 0.07773235770816059, 0.10368845391336506,
        0.05351224455151912, -0.020249126863108785, -0.04955771010723424,
        -0.015132341162489984, 0.0373839393552242, 0.0441778377121865,
        -0.012432097515971782, -0.08429624732288411, -0.10183107649440848,
        -0.04059315986165746, 0.053463796799261866, 0.10461187700586451,
        0.07595630064937778, 0.0015693269353675987, -0.04769371285257702,
        -0.03169178244127918, 0.022491165929345525, 0.04936322539113908,
        0.010948890977516407, -0.06388159809658008, -0.10494756269361763,
        -0.0673330867088669, 0.024348281281173917, 0.0965435847650591,
        0.09331829962920468, 0.02637081025300042, -0.03830906622835717,
        -0.04386825118952662, 0.004462466203054592, 0.047032792387978264,
        0.030064442433266954, -0.039749173464595514, -0.0992068674842203,
        -0.08796551036833439, -0.006968061303101888, 0.07996718202376595,
        0.10354371220052357, 0.0515572653309431, -0.022090194541326047,
        -0.049854647375020086, -0.014228902058728723, 0.03785711325070436,
        0.043052758575275754, -0.014565404907294972, -0.08552911213280343,
        -0.10072297318858489, -0.03761177628244272, 0.05623834114295248,
        0.10527503437182768, 0.07440531105393919, -0.0005336304776124845,
        -0.048552008804721145, -0.03103321947767897, 0.023293981714753678,
        0.04879030499273905, 0.008973223324375303, -0.06562241400867588,
        -0.10464908092681255, -0.06478020812493243, 0.027449180953804803,
        0.09800539465490721, 0.09236135285814312, 0.024209507385724804,
        -0.03970026427985225, -0.043614253316429916, 0.005418412888550097,
        0.0470063031539638, 0.0284316822000551, -0.0417918723660729,
        -0.09969121025855573, -0.08603200468900499, -0.00378620257950113,
        0.08214173747580804, 0.10332044008309987, 0.04956196924594802,
        -0.023916772501158534, -0.05011582806068889, -0.013315133615800619,
        0.038303040687670695, 0.041897415358468595, -0.016685841659035812,
        -0.08669660368018514, -0.09953884399618265, -0.03460211725196144,
        0.05897051975794528, 0.1058585825524864, 0.07279711223840923,
        -0.002638201463529888, -0.049375771773867844, -0.03035219735507511,
        0.024080030767537473, 0.04818264062961136, 0.006992897674849154,
        -0.0673125228420034, -0.10427142256507543, -0.06217858534665199,
        0.030529387293376696, 0.09939323049432053, 0.09133398434422038,
        0.022028176654104392, -0.04106371261603607, -0.04332878371852844,
        0.006370515638481852, 0.046946130189040924, 0.026779709268193664,
        -0.043801492601684394, -0.10009985371748983, -0.08403369142502845,
        -0.0006015422127380737, 0.08425435988095464, 0.1030187716853464,
        0.047527832716457996, -0.02572748026131902, -0.050341009875648976,
        -0.012391654617764031, 0.03872144492957123, 0.04071270004960895,
        -0.018791827766795673, -0.08779787809439324, -0.0982796127097452,
        -0.03156647247958841, 0.06165825114990184, 0.10636204985288773,
        0.07113288421333275, -0.004742808216351424, -0.1683430726351285,
      ],
    ];
    const result = wavedec(data, "db2");

    const reconstruction = waverec(result, "db2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db2_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5101324579998668, 0.9372886715062987, 1.216604682440659,
      1.3149653935628216, 1.2368397174416068, 1.0209898237960464,
      0.7290628154099352, 0.42913235599508637, 0.17851029394230056,
      0.010272005619377356, -0.07309353519669942, -0.09741315626695374,
      -0.1067366258510124, -0.14829111063042816, -0.2566585615388489,
      -0.44155069639982947, -0.6825966672650132, -0.9326920904282373,
      -1.1291743783590373, -1.2099875535980464, -1.1306324698803214,
      -0.8774269208874171, -0.473499987980661, 0.02421415691254726,
      0.5364122964598996, 0.9785457009104465, 1.2794155288460334,
      1.3966332121858795, 1.325132258307986, 1.0966905752408436,
      0.7707148405263806, 0.4187562839688873, 0.10679631553259139,
      -0.12014394743109619, -0.24718385893276462, -0.29033917193786807,
      -0.2888769922676362, -0.2915086482775186, -0.3402736730031235,
      -0.4565594942189024, -0.6331164103948459, -0.8343205762145522,
      -1.004731232878177, -1.0837617689162073, -1.0226226904236877,
      -0.7990363489314518, -0.4257446567640713, 0.049599774206777664,
      0.5533574345440407, 1.00156008335633, 1.3184690730841717,
      1.453428555895953, 1.3918219526359628, 1.1574327395217692,
      0.8056961215787198, 0.4096403899497513, 0.04215703115881975,
      -0.24086839133499494, -0.4123153055624318, -0.47760844587100765,
      -0.4697656151058972, -0.4372542537348484, -0.42807364511029444,
      -0.4744461485647688, -0.5823076340863524, -0.7284871206822944,
      -0.8664010703672237, -0.9388015773337156, -0.8942108047605453,
      -0.702648615871085, -0.36638841655595505, 0.07727166382945105,
      0.5621824508437814, 1.007102562140509, 1.3336998190697087,
      1.4843243445540821, 1.4351045952403267, 1.2010870168603507,
      0.8321552592196035, 0.4008044795991911, -0.015095491123867766,
      -0.35016968898226136, -0.5655510441711169, -0.6555958273106217,
      -0.6457911398323957, -0.5826517455809194, -0.5184854891206769,
      -0.4952202034762923, -0.5316894442499898, -0.6178191166388195,
      -0.7172950236031364, -0.7780126655274826, -0.7475143820419365,
      -0.589256651451584, -0.29528174708735266, 0.10823326206156547,
      0.5642426880778056, 0.9963128047039607, 1.3255617643407533,
      1.4888512854049365, 1.4536527510664714, 1.2258227908554025,
      0.8483100193652242, 0.39111376131781117, -0.06496778049138474,
      -0.44670199177611825, -0.7042995892633748, -0.8208911795720568,
      -0.8133781873758728, -0.7246865384700931, -0.6096792527063756,
      -0.5186067078397223, -0.4825697177881906, -0.5048883914904798,
      -0.5606649007286775, -0.6046239682623565, -0.5850908402549433,
      -0.46030747469368444, -0.21263053848167174, 0.14332568544841556,
      0.5609754153339799, 0.9706505837329594, 1.2950044039510675,
      1.4671063872868055, 1.4466552447031924, 1.2301681877913344,
      0.8525114081070695, 0.37932861489649294, -0.10776469756111634,
      -0.5295224275960781, -0.8263678856101779, -0.9703774968470542,
      -0.9690729538223781, -0.8602788709788043, -0.699611720429911,
      -0.5440502702033638, -0.43600897981957576, -0.39214406299483184,
      -0.3998214939902798, -0.42211099867981433, -0.40988347876979647,
      -0.31768227282733424, -0.11901245763976903, 0.1831823151191686,
      0.5538399828751908, 0.9318394944780797, 1.2434365131241727,
      1.4197473887621475, 1.4138440515639772, 1.2130619860515535,
      0.8433058645811324, 0.3641589711176701, -0.14405947377817022,
      -0.5980961712963356, -0.9300030627845894, -1.1013013954303696,
      -1.1096267562142628, -0.9863608891552379, -0.7860786142151692,
      -0.5707297377162455, -0.39279393294199016, -0.2818512333001809,
      -0.2380530900338469, -0.2341134358403, -0.2251571298864537,
      -0.1636640534826601, -0.015382052957983228, 0.22819048399573172,
      0.5442589293777091, 0.8818050137473266, 1.172678866918651,
      1.3479732954979748, 1.355507767829815, 1.1738957543126622,
      0.8194935892997774, 0.3443214982436612, -0.17465518199897606,
      -0.6522895184791155, -1.0139219077021044, -1.2113341682476277,
      -1.2320752939381248, -1.0999554904525506, -0.866773860071757,
      -0.5975830893240976, -0.3534213570522594, -0.17603718781432187,
      -0.07854637764206063, -0.04434914582883104, -0.03442504847485278,
      -0.0008935437824292292, 0.09693581438376425, 0.2784616217539889,
      0.5335619545777481, 0.822608846650291, 1.084907349839307,
      1.2534915978033396, 1.2724911986501737, 1.1125448557256497,
      0.780181116167771, 0.3185976934813962, -0.2005390230557694,
      -0.6923514342744674, -1.07732745498411, -1.2986218527600515,
      -1.333811499791869, -1.1982547561484154, -0.9393542529019634,
      -0.6233418059926426, -0.31809276726318947, -0.07644652098794175,
      0.07568814196716056, 0.14347309789260854, 0.15863109305946968,
      0.16768564687515058, 0.21626427574897017, 0.33381095040975367,
      0.5229345652838753, 0.7563815893698022, 0.9825881597588748,
      1.1384730981216185, 1.166180980741423, 1.0293872551639622,
      0.7248263845700793, 0.2858909379316229, -0.22283102833849938,
      -0.7188843828628111, -1.1199124608603712, -1.3618230659520918,
      -1.412650019196036, -1.2786957855852377, -1.0015076647117565,
      -0.646573674997976, -0.28671987616183275, 0.015493673067837666,
      0.221884286899035, 0.32573990300177064, 0.35024604039281065,
      0.3388912668344314, 0.3406042067004807, 0.3937475268812626,
      0.5133730428891204, 0.6852557579293141, 0.8684070117014716,
      1.0054956103663957, 1.0384775357583693, 0.9253093993896415,
      0.653274769450999, 0.24528059352638992, -0.24272894382958363,
      -0.7328055507812065, -1.1418498960678582, -1.4001336975200143,
      -1.466881575636756, -1.3390317933546396,
    ]);
    const expected = [
      [
        2.5092343357817386, 2.5794422121556924, -0.2232415652310632,
        0.27464064493443546, 0.5564045944157275, -3.6411874792169114,
      ],
      [
        -0.021091297350124022, 0.19221979955837515, -0.2045968012419172,
        -0.8744675768496817, 2.4006949972217426, -2.692403776109844,
      ],
      [
        -0.5168762580170861, -1.5820117586166467, -0.13618838277257428,
        1.2275349109394358, -1.3758686893841257, 0.4426137630349767,
        0.8662843690267553, -1.5345735960467781, 2.4346037923355,
        -2.759039912234618,
      ],
      [
        -0.3275909528337303, 2.0659277660032167, -1.385136128364779,
        -1.5220969109692093, 2.759845580651514, -0.9188839074482038,
        -1.9788637855103508, 2.6950546999073746, -0.39104582398973176,
        -2.3890971881036256, 2.5220607051786628, 0.18710921170175512,
        -2.730942376640275, 2.2333831294510977, 0.7982455734770256,
        -2.980816944875327, 2.773276983849211, -3.039954944601291,
      ],
      [
        -0.15530607876594538, 1.4825046042475991, -0.1340317443307968,
        -1.8320406596314136, 2.107678984304691, -0.44774722772098663,
        -1.614755899939222, 2.184944479616986, -0.7475450240761836,
        -1.3674423459562057, 2.215759907674286, -1.0268295050372462,
        -1.096151594650898, 2.2001405422515266, -1.2795878048643248,
        -0.8074439827855397, 2.1392379444068466, -1.5005396257804242,
        -0.5082134679529109, 2.0352980457311745, -1.685266172413653,
        -0.2055048686726973, 1.891590028533647, -1.830314755608873,
        0.09367142610089418, 1.712308144190748, -1.9332763058736544,
        0.38252211629925126, 1.50244936674039, -1.9928338137099673,
        0.6546459533406528, 1.2699998938445038, -1.1506311503879412,
        -0.13710779931925499,
      ],
      [
        -0.18311303574630308, 0.340504977390981, 0.19378167470433202,
        -0.2226074834360412, 0.19962524568023327, -0.2387149779133384,
        -0.4176603602242205, 0.4764872047053458, 0.25570083901622276,
        -0.27877801722714224, 0.1450713696864396, -0.16821627693709315,
        -0.42040659893939913, 0.45549266672963995, 0.31411051919068267,
        -0.32560297272239624, 0.08351892288545165, -0.09670974348735913,
        -0.41189912512787297, 0.4241406452512612, 0.3671972578405739,
        -0.36214359504579025, 0.01645994627869722, -0.026146964912538567,
        -0.3919540166840294, 0.38363012873440083, 0.4132568571356866,
        -0.38777047381563545, -0.054416166047341674, 0.041593073951396387,
        -0.36071399831145673, 0.3353887187230127, 0.45074594299685555,
        -0.40217667255535483, -0.1272687418951214, 0.10475664122583137,
        -0.31864953663144596, 0.28102805148359583, 0.4783293678536824,
        -0.40538140430731423, -0.2001567958750508, 0.16176374177470948,
        -0.26655039791589985, 0.22229434917898944, 0.4949220410076317,
        -0.397724209451237, -0.2710934306137246, 0.21125105237498523,
        -0.20550785141321257, 0.1610155718586041, 0.49972393214708133,
        -0.37984986852631336, -0.338102114272372, 0.2521080938903541,
        -0.13688797452699702, 0.09904673437652511, 0.49224718705962284,
        -0.3526845521100062, -0.3992732132466552, 0.2835056285993631,
        -0.06229677684535508, 0.03821499928895765, 0.47233451950574257,
        -0.3354045252156621, -0.03635321506997985, -0.3292566484910312,
      ],
      [
        -0.3123910558328611, 0.0821392510970778, 0.10865371866523275,
        0.05456525019229888, -0.022778404456078927, -0.051651634206839624,
        -0.014883689290636711, 0.036439185045264916, 0.03702324303451729,
        -0.024722070673423586, -0.09232401358640514, -0.09529074435478505,
        -0.019132190576715905, 0.07729211235143904, 0.11491043914299595,
        0.06741495454760671, -0.0159554100714408, -0.05925052425891861,
        -0.0324040600805295, 0.022810487468883152, 0.03784653763644619,
        -0.011682534079362955, -0.07952218314885566, -0.09332435501994421,
        -0.026929132230252534, 0.07059931558560686, 0.11848012837308664,
        0.07903415953248832, -0.008064081079320246, -0.06481794260852598,
        -0.04905927084525617, 0.008075545544546321, 0.036885999615806804,
        0.0009667664389050867, -0.0649805125218642, -0.08890327345557314,
        -0.033821128774142395, 0.062320724688035026, 0.11928992029007718,
        0.08907314386825507, 0.000615448156999765, -0.0682668286544834,
        -0.06444333715259701, -0.007397955302681489, 0.034142535999349244,
        0.012872269075091286, -0.049069597634873965, -0.08207965066082151,
        -0.03952838915446677, 0.052756780110851664, 0.1173391011702132,
        0.09721958743356432, 0.009773435348852721, -0.0695746331736589,
        -0.07818543076697523, -0.023214767844304846, 0.029677515271913993,
        0.02371067230247685, -0.032193665209227465, -0.0729734198784716,
        -0.043808046284143434, 0.042239031065387345, 0.11269885614759609,
        0.10320791289697662, 0.0190802407005653, -0.06878304130962135,
        -0.08995976122345166, -0.03896293791992303, 0.02361120107175743,
        0.033198076314895866, -0.014779501273445794, -0.06176974620558502,
        -0.04646215454155111, 0.031119836931604642, 0.10551002222216481,
        0.10682736549786634, 0.028196688744545673, -0.06599580096112095,
        -0.09949417817168972, -0.054225226677242805, 0.01611936439562975,
        0.04109787629831313, 0.0027352112921381275, -0.04871459000241458,
        -0.04734433794850835, 0.0197615457355639, 0.09597891533148445,
        0.10792859135503113, 0.036784770470427386, -0.061374731345207025,
        -0.10657725440359174, -0.06859077418644119, 0.007428171673131728,
        0.04722718198461508, 0.019913815485592068, -0.03410850193497366,
        -0.04636488467699524, 0.008525471792467869, 0.08437135395833154,
        0.10642851730077765, 0.04451836395712519, -0.05513403969540824,
        -0.1110636532436851, -0.0816666703507011, -0.002192502391473755,
        0.05146158204490274, 0.03633252559195644, -0.018298818998246015,
        -0.043494129435990375, -0.002239000614023018, 0.07100505306545189,
        0.10231338366279535, 0.05109365054848383, -0.04753312337113748,
        -0.11287763334900587, -0.09308910062072853, -0.012437141112807498,
        0.053738121207416195, 0.05159186049593549, -0.0016704775793823304,
        -0.03876401593004928, -0.01220486546951198, 0.056240608406560796,
        0.09563983424887307, 0.05623891198553464, -0.038868078662951416,
        -0.11201459750309042, 0.03656391297405684, -0.07743847367393186,
      ],
    ];
    const result = wavedec(data, "db2");

    const reconstruction = waverec(result, "db2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48864825708752546, 0.902218896058288, 1.1813582811481704,
      1.2944469416096531, 1.2430902920804883, 1.059876410957179,
      0.7990708675963125, 0.5226290547278978, 0.28502291975311994,
      0.12062770927373373, 0.03673657027764454, 0.01383710151655651,
      0.012951643027991108, -0.011932063916730906, -0.09959016430010909,
      -0.26916385585048763, -0.512875999928183, -0.7958246408247786,
      -1.063037401114257, -1.2521394069995453, -1.3085576814282698,
      -1.1995132185547226, -0.9233072232035511, -0.5115298712153642,
      -0.02353340865378471, 0.465605267827469, 0.8808184259446854,
      1.1627608505855966, 1.2797920758425314, 1.2334303643492424,
      1.0560766624743272, 0.8016903470361647, 0.5318060192258625,
      0.30039158106200553, 0.14128998846901936, 0.06130325644233919,
      0.040539517182943505, 0.039810649787860725, 0.013095201303122694,
      -0.07819046785466, -0.25282473796296284, -0.5025537934430501,
      -0.7919547653968319, -1.065558702246697, -1.2605728110046361,
      -1.3221157383264273, -1.2172139820274055, -0.9440693306216335,
      -0.5342345127535514, -0.047050667864338945, 0.4424166022358911,
      0.8591200859844776, 1.1437328867759544, 1.264601985585548,
      1.2231649102648068, 1.0516394943772047, 0.8036803827033205,
      0.5404003261949052, 0.3152598085738922, 0.16156413123087066,
      0.08561721579690179, 0.06713959346906546, 0.0667238062011914,
      0.03833001894330751, -0.05644196951274877, -0.2360162254844202,
      -0.4916697408320518, -0.7874647402277882, -1.0674397922500531,
      -1.268385997472667, -1.3351129052853858, -1.2344491773903292,
      -0.964491346926081, -0.5567466955744984, -0.07053563852968527,
      0.41909805040535947, 0.8371383365272618, 1.1242866211100053,
      1.2488859110972403, 1.2122996012736125, 1.046566652547247,
      0.8050386821279835, 0.5484057840054138, 0.3296178949086841,
      0.1814375187823033, 0.10966370597383668, 0.09362138625932885,
      0.09367496409816126, 0.06375704717873637, -0.034358245585531244,
      -0.21874928177437752, -0.4802315099173222, -0.7823584622228343,
      -1.0686805579347889, -1.2755748541303535, -1.3475413304824044,
      -1.2512077043571677, -0.9845596149810218, -0.5790510547958931,
      -0.09397220222375478, 0.39566548361058496, 0.8148878158957764,
      1.104434548637426, 1.232653425532625, 1.2008404901935559,
      1.0408602889327305, 0.8057633582901595, 0.5558165805935015,
      0.34345646271985725, 0.20089779229002752, 0.13342815827003457,
      0.11996902800796375, 0.12064795001484337, 0.08936081859930911,
      -0.011953090441836178, -0.20103516714416775, -0.4682471258712216,
      -0.7766402237723075, -1.069281295085255, -1.2821356656732021,
      -1.3593935223064035, -1.2674787636308662, -1.0042607006423836,
      -0.6011323566186094, -0.1173442715177826, 0.3721348441467939,
      0.7923833310173842, 1.0841894200753925, 1.2159144288269377,
      1.1887940073541683, 1.034522960186021, 0.8058529308389647,
      0.562627287186377, 0.3567664706937717, 0.21993286076374619,
      0.15689618695368807, 0.14616673787335774, 0.14762657552327285,
      0.11512575009174048, 0.010759492309436847, -0.18288543165319726,
      -0.4557249660754371, -0.77031470999403, -1.069242708257163,
      -1.2880651161306238, -1.370662354143317, -1.283251863810917,
      -1.0235814013565765, -0.6229755080807722, -0.14063580028191164,
      0.3485221351226548, 0.7696398479478181, 1.0635642336536688,
      1.1986791413704205, 1.1761669564953958, 1.0275576260419788,
      0.8053063270518006, 0.5688328617826186, 0.36953921933403533,
      0.23853090878410615, 0.180053598454114, 0.17219883179693002,
      0.1745946475710097, 0.1410361527954013, 0.03376529877079382,
      -0.16431190771979903, -0.44267375475477105, -0.7633869957244974,
      -1.0685659103135965, -1.2933602909757456, -1.381341068928069,
      -1.298516828103772, -1.0425087546110305, -0.6445655667218588,
      -0.1638307939604138, 0.3248434102144538, 0.7466724822931394,
      1.0425722268014894, 1.1809580974782614, 1.1629665104276006,
      1.0199676474386274, 0.8041228825328806, 0.5744286523849662,
      0.38176635652724145, 0.2566804040543988, 0.20288640042866396,
      0.19804973252010144, 0.20153597882382557, 0.1670762421258158,
      0.05704993383569662, -0.14532670255155355, -0.42910255738910896,
      -0.7558625422608232, -1.067252421699993, -1.2980186789784645,
      -1.391423283460261, -1.313263800832122, -1.0610300462313687,
      -0.6658877501504832, -0.18691331981382722, 0.3011147633878355,
      0.7234964895361639, 1.0212268676814704, 1.1627621386597384,
      1.1492002064555549, 1.0117567843812465, 0.8023023416505737,
      0.5794103999837869, 0.39343988288647175, 0.2743701047711251,
      0.2253808107009881, 0.22370397953295945, 0.2284343980045466,
      0.19323014785939524, 0.08059882039054767, -0.12594219039973947,
      -0.41502077490714195, -0.7477471938554829, -1.0653041694583734,
      -1.3020381738006634, -1.4009029924808132, -1.3274832537388415,
      -1.079132818519731, -0.6869274455099044, -0.20986751712166712,
      0.2773523185938429, 0.7001272552734119, 0.9995418465760892,
      1.1441024066910508, 1.1348759415694039, 1.0029291935512483,
      0.7998448577133104, 0.5837742412890677, 0.4045521568692226,
      0.2915890668087818, 0.24752326606471942, 0.24914623894821109,
      0.2552737602218579, 0.21948192427304558, 0.10439720863298402,
      -0.10617100464304219, -0.40043813766543546, -0.7390471739661632,
      -1.0627234859816772, -1.3054170753325045, -1.4097745725069533,
      -1.3411659920816201, -1.0968048782291286, -0.7076702188351011,
      -0.23267760733902396, 0.25357221944584907, 0.6765802853689632,
      0.9775310671320792, 1.124990336496082, 1.120001967405569,
    ]);
    const expected = [
      [
        3.2813382421981787, 3.3356339357533655, 3.205885764598148,
        2.6016975144101613, 0.2505234183434082, -0.16931932664013438,
        -0.3432791426109, 0.3637342769233698, 0.2142935366688326,
        -0.33020589046716886, -0.969369653067123, 4.756801618529229,
      ],
      [
        -0.09246373809330627, -0.8938129943746134, -2.7023147157476064,
        1.517858206772434, 1.3374068436325575, -1.5146404174701693,
        -1.107401675340786, 2.1338034097218954, 0.16122284573915457,
        -3.500559297000631, 2.4325500774952418, 1.388363332334273,
      ],
      [
        0.20848936090785525, -0.3453823589780336, 0.7839353754589071,
        2.021071524711102, -3.339591644143547, 2.4543512927606446,
        -0.47711412248851903, -1.5228129481919712, 2.965072216627158,
        -2.8350806079114346, 0.40184387532483407, 2.9376877996745216,
        -4.139035788535657, 1.7860448277565086, 1.9856890088912391,
        -3.7748797671898884, 2.5143924329485996, -0.44281566731274435,
        1.036513437965993, -2.523607156093657,
      ],
      [
        -0.4477072106130254, -1.1266607351795694, 0.4674555685162728,
        0.45419897089186506, -1.1260296941347991, 1.0382588469328855,
        0.12912518325987843, -1.4730268511832771, 1.6475646200667402,
        -0.2715845260883052, -1.4985227869770161, 1.9910780704658317,
        -0.6820493047268131, -1.2309591009474894, 1.9854599067349217,
        -0.9678303824270593, -0.7648333198405517, 1.6222721861811606,
        -1.0217728449683925, -0.23542522271840058, 0.9707788846719841,
        -0.7929892985648291, 0.21585297465635453, 0.16249986471095884,
        -0.30213103802006047, 0.4769003697275035, -0.6388211331639395,
        0.3609966645140607, 0.4924420949081349, -1.2746589791002123,
        1.057093489461969, 0.2768862606522605, -1.6250746134741487,
        1.2629155618067138, -0.3650041430163203, 0.2954116099972477,
      ],
      [
        0.5511866824945562, -0.16158265609244174, 0.2694370815330242,
        -0.2865484484438214, 0.12861665175093467, 0.014558862730310797,
        -0.28818694605238615, 0.2347697764652576, 0.239098969142913,
        -0.2793210998329919, 0.01977178419706574, 0.1255217349802601,
        -0.295206623376754, 0.08147074577576334, 0.3459648239939705,
        -0.20208590205215257, -0.10586218152302584, 0.19112692111219487,
        -0.23405446184600232, -0.08121875635004573, 0.38359102585464483,
        -0.0695876640330123, -0.21449047223026851, 0.1946099853863536,
        -0.12358708599270923, -0.21706505301450546, 0.34295590955884525,
        0.08948907962968047, -0.27580300714806083, 0.13554055552986427,
        0.005889397180137711, -0.29691768675708213, 0.23298368100461203,
        0.23924683960001009, -0.2706606291048241, 0.02989569635554492,
        0.12027046795303761, -0.30552341513247416, 0.0784407936245552,
        0.34511763577927695, -0.1960827025244215, -0.09395831909412938,
        0.19016805137102052, -0.244930082644969, -0.08595359564731854,
        0.382152241094458, -0.06629458543157626, -0.20238591734311764,
        0.19819603165435173, -0.133673474775351, -0.2237770091164978,
        0.3410437284614376, 0.0904449018907871, -0.2649508045433724,
        0.14323931381597604, -0.0019693231682277428, -0.30551591994680727,
        0.23041977572115935, 0.23848411896788735, -0.2621462378427156,
        0.04066230126087844, 0.11589433302336828, -0.31545936132464003,
        0.07484254587474266, 0.3473025201935266, -0.08781571027639325,
        -0.07301249458714643,
      ],
      [
        -0.10983018206603967, 0.12748458039738134, 0.0075998523002645535,
        -0.0243373481849673, -0.03187371157103579, -0.010914862230922556,
        0.016439022212298992, 0.023066589788320383, 0.0024369833619228357,
        -0.02523211794525249, -0.03201239067258825, -0.008752271248029055,
        0.025722421392739128, 0.04141229126683508, 0.02451227552441755,
        -0.009954435038686388, -0.03192483916453024, -0.02374054418757903,
        0.004125274693146268, 0.0235003384701375, 0.015242290252117886,
        -0.012700123146287198, -0.03273836380412763, -0.023670202916646742,
        0.008991455024683348, 0.03742488833454271, 0.03672362859484468,
        0.007661173120622103, -0.024057436291666654, -0.031354660959467054,
        -0.010345657880915203, 0.016763452185364985, 0.02296193494843083,
        0.0019720190647305917, -0.025792432560507034, -0.032412045750209416,
        -0.008917093431714658, 0.02568877963120482, 0.04138764127651473,
        0.024507043175340963, -0.009803832578747633, -0.03151498997407483,
        -0.023156807094460774, 0.004615570147217286, 0.023628731878530616,
        0.014942660056701605, -0.013243185590593327, -0.033238005830610914,
        -0.02395034825935749, 0.00890325035691334, 0.03739365886958338,
        0.036685592151778024, 0.007705747135368854, -0.023783962991887876,
        -0.030831070985148666, -0.0097630638692787, 0.017106660644522695,
        0.022877664354810073, 0.0015251014846216103, -0.026341158057315513,
        -0.03281014223902408, -0.009091859771828841, 0.02563569292102983,
        0.041339437825490544, 0.024481032390260744, -0.009665572312355784,
        -0.031106518713732344, -0.022564243744736805, 0.005122054526027469,
        0.023777078478110312, 0.014662926900306442, -0.013770512153081758,
        -0.033730178313726475, -0.024234162516484057, 0.0088002690420926,
        0.037340278919322824, 0.036624452521192945, 0.007732883204627439,
        -0.02351795199282108, -0.030304051006973615, -0.009167999846102025,
        0.017468151009827824, 0.022813831485769303, 0.001096818861426289,
        -0.026877323245056862, -0.033205570158200116, -0.009275592702276316,
        0.02556377358677988, 0.041267784091423065, 0.02443381160656059,
        -0.009540521292018213, -0.030700521994001383, -0.021963911848966934,
        0.0056439747580465695, 0.023945121936299076, 0.014403395752739676,
        -0.014281316912762201, -0.03421381481789434, -0.02452056306177116,
        0.008683348955380511, 0.03726514365514838, 0.03654006864445801,
        0.007741934676722685, -0.0232604045575688, -0.029774715447556034,
        -0.008561416740484357, 0.017847376892434735, 0.02277043366509162,
        0.000687710665413831, -0.02739998636249654, -0.033597222356811896,
        -0.009467290139311975, 0.025473679821837618, 0.041172839183116525,
        0.024365001472998943, -0.00942951092064461, -0.030298086062438223,
        -0.021356886530890545, 0.006180536889235415, 0.02413255158416533,
        0.014164317076896731, -0.014774855285871078, -0.034687866916928,
        -0.024808457479071934, 0.008553363200808774, 0.037168700264074234,
        0.03643235544995439, 0.007732301070462792, -0.03012596511311771,
        0.030436459427212757,
      ],
    ];
    const result = wavedec(data, "db3");

    const reconstruction = waverec(result, "db3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5027197137491076, 0.9276294958275959, 1.2129091687241662,
      1.3249920992188033, 1.2642822585462017, 1.063091532760483,
      0.776444216893675, 0.46810609474051246, 0.195317359750458,
      -0.004031347664433027, -0.11870238309030243, -0.16423272735237485,
      -0.1760292126118171, -0.19735809336127547, -0.26542532011977577,
      -0.39921349341217494, -0.5922891839768545, -0.8125331644940167,
      -1.0089901189603512, -1.1242207583633914, -1.1091200415084153,
      -0.9364953217092832, -0.609947509338977, -0.16570913898442996,
      0.333205510237816, 0.8093091305995357, 1.186594540730026,
      1.4064123494532925, 1.4395515822934126, 1.2917058407460764,
      1.0010963326809124, 0.6289070369105899, 0.24490448855767594,
      -0.08825512640623762, -0.3282608750754817, -0.4608097851122038,
      -0.4999984662207397, -0.48156637375999356, -0.4508893939600523,
      -0.4489130946775523, -0.499701814341631, -0.6028439847418035,
      -0.7327059586213713, -0.8447779948849332, -0.8875430735626746,
      -0.8168741988181364, -0.6092852263455523, -0.27059614643519997,
      0.1623288278531169, 0.6274218266371987, 1.049615288462334,
      1.3566117997113198, 1.4945162256346216, 1.4396223917225501,
      1.2035480093870317, 0.8304991743698444, 0.3873311074449671,
      -0.05120698050537603, -0.418519244111316, -0.6697057251709224,
      -0.7894563266901895, -0.7925687226697438, -0.7171902799657575,
      -0.6126709962236114, -0.5252198231956425, -0.4850597428853918,
      -0.49835605125853377, -0.5459550474987578, -0.5892265679624562,
      -0.5814887911858471, -0.4820602453365076, -0.2692900601371542,
      0.050862151402917166, 0.44304303640810416, 0.8481870590406072,
      1.195471946113869, 1.4177774588334464, 1.4669692452398997,
      1.3253210806939422, 1.010285289251132, 0.5714050103617873,
      0.08004593448269398, -0.3856524311563918, -0.7570670895464956,
      -0.9888079118027684, -1.066696193342235, -1.0082595384394843,
      -0.8558309202956883, -0.6641370897787418, -0.48558031595029144,
      -0.3569347684509663, -0.29077050924125697, -0.2736890827391795,
      -0.2717130837503894, -0.24135238792450273, -0.1434253405038725,
      0.0439959720619687, 0.3169439299672512, 0.6435781669953593,
      0.9695682291741511, 1.2296792995771195, 1.362825903654584,
      1.326947319233825, 1.1100433175241264, 0.7345977198467972,
      0.25419456189402023, -0.2569884884822607, -0.7194035965475272,
      -1.0645273758955116, -1.2486023393160188, -1.2605516784601483,
      -1.1223135401504223, -0.8816800211729732, -0.5995323708344653,
      -0.3346941285277433, -0.13015314989806037, -0.004005032503772654,
      0.05275297492289874, 0.07119055447859494, 0.09361504093644679,
      0.15984105909924495, 0.29418157443894744, 0.49659718076814224,
      0.7403897881468087, 0.977172529908324, 1.148001173240783,
      1.1979733825814356, 1.0906850459348714, 0.8189084218495637,
      0.4087353181731111, -0.08400339742930377, -0.5843572429248257,
      -1.0135116622105451, -1.3051370980939507, -1.4190090644473319,
      -1.3487263228003865, -1.1217746757205183, -0.7920266429657712,
      -0.4265803231196731, -0.09017986246858228, 0.16900165908037468,
      0.32882739301370156, 0.3957408244533704, 0.3999643859220063,
      0.3847634819714341, 0.3926577459032572, 0.45220399707261566,
      0.5688070013138563, 0.721978264700085, 0.8698185781450501,
      0.9596569174960446, 0.9421962010859367, 0.7855906039810552,
      0.4858425893727203, 0.07077330748378072, -0.4036233194122362,
      -0.8637672222083013, -1.2336298782762414, -1.4508942159172353,
      -1.4803260772177056, -1.3211938996899075, -1.006992620531131,
      -0.5975719576168135, -0.16558638672103743, 0.21947065086593426,
      0.5058409560562439, 0.6692634343755082, 0.7157223229114227,
      0.6767293110846869, 0.5985319084130896, 0.5281252712238691,
      0.4997037063170603, 0.5250357799186625, 0.5902240640948848,
      0.6596736009923363, 0.6862508953698127, 0.625027260478278,
      0.4470632062730661, 0.14963949142523042, -0.2398090575415489,
      -0.6672571092144174, -1.0624936074445888, -1.3540017952568708,
      -1.4848091596286015, -1.425517030693951, -1.1813626215776565,
      -0.7915821666906637, -0.3211866563806954, 0.15291984812075357,
      0.5582007298258646, 0.8412987255917139, 0.9779556413495532,
      0.9758161417622402, 0.8696454792427247, 0.7103452686870024,
      0.5506494164125337, 0.4311562331932772, 0.3702145588781169,
      0.3601694095414085, 0.3708406256229464, 0.35926386261351845,
      0.2831267998407369, 0.11438266158033644, -0.1505443205473237,
      -0.48671269707075965, -0.8439978369690191, -1.157179772275388,
      -1.360452022688982, -1.4028776041426494, -1.2610282760319,
      -0.9456793841308726, -0.5008423109803122, 0.004744726641187552,
      0.4917296416247859, 0.8865756273515557, 1.1364678540636222,
      1.2192413369044055, 1.1460942971009935, 0.9566094183795846,
      0.7074680533073706, 0.4577519381794616, 0.2545136566289726,
      0.12217046220983291, 0.05827163377026645, 0.036559723641598235,
      0.016397533865574576, -0.04397446481226713, -0.17385166572553912,
      -0.37973614689781887, -0.6410336410188999, -0.9130285556939315,
      -1.1365493842422343, -1.2520322336686, -1.2145454397157809,
      -1.0060403314036697, -0.6417200017384114, -0.16881861174276827,
      0.342084206830864, 0.811275665788125, 1.16636156563484, 1.357117893376712,
      1.3652836441038088, 1.2070572805917987, 0.9278206091367595,
      0.5904830934165559, 0.2603583303520886, -0.009718765358273429,
      -0.19044332685007295, -0.2806689518708012, -0.30465170782407897,
      -0.3028032082673857, -0.31846551159539566, -0.3842028849518471,
      -0.511208056667585,
    ]);
    const expected = [
      [
        3.295174777723364, 3.428185972916588, 3.282130215134054,
        2.8168934260459237, 0.014611368627875432, -0.4394068647373183,
        0.43395454194094274, -0.027180564909309868, -0.41404095355908643,
        0.3815816310254745, 0.49567109939976856, -2.7299572476183576,
      ],
      [
        -0.10093777563618665, -0.7830271400846467, -1.8783298694738957,
        1.7897507511894535, -0.8230678215717666, -0.5056598065208008,
        1.311933628982264, -0.9125574705205666, -0.3655541369999271,
        2.484960990296297, -1.614065864136649, -1.067012865972467,
      ],
      [
        0.21555862930226333, -0.37406836384830433, 0.3573829251159702,
        3.2107040366825728, -3.575146202925487, 0.21382017894391717,
        3.0086218854495286, -2.7751782121324355, -0.17723662321758607,
        2.648501337963948, -2.4329463847518684, -0.07397863038623026,
        2.5686543399055934, -2.6491522881623775, -0.08547059716034451,
        3.0869101897695366, -2.9391820320544753, -0.8813493257997551,
        -0.09283326700605951, 3.20734371741511,
      ],
      [
        -0.4599625612788565, -1.1592837482444922, 0.5214691412552623,
        0.29389381290907535, -0.8678337356936471, 0.9369881043619945,
        -0.1820012274560945, -0.9183064711807395, 1.4312586716735103,
        -0.7757643403073348, -0.6566855435080053, 1.706380282102121,
        -1.402487805341496, -0.1325169331939902, 1.6785389477524761,
        -1.905481316613367, 0.5378676074390459, 1.3395546282199324,
        -2.157877916877817, 1.2005903818307542, 0.7590349743027593,
        -2.0946254946229583, 1.7029393688515295, 0.06691781396099256,
        -1.7288990284103085, 1.9317904900464957, -0.579196026855009,
        -1.1487949459411573, 1.8420523167954377, -1.0336826619690451,
        -0.49514106296746174, 1.4678893780696427, -1.165823565061197,
        0.027980827998184632, -0.011747226964931507, 1.4167816148823904,
      ],
      [
        0.5665526516716114, -0.16519169287202, 0.28356348465253695,
        -0.2997123129666154, 0.10709057050382838, 0.017749644668165053,
        -0.25802491940949224, 0.2597184595740238, 0.22991744611855044,
        -0.32494314672608293, -0.019063891987841225, 0.14702310183520614,
        -0.23031720073324813, 0.12127693717513913, 0.3225127532087334,
        -0.27704007681399395, -0.1665590425216228, 0.2224662501654348,
        -0.13476431365053415, -0.021441634048911615, 0.349729182736942,
        -0.16999238746555914, -0.29847596168705937, 0.22669691588330715,
        0.006417878486258223, -0.13225360150728102, 0.30301530667580506,
        -0.032639357414851695, -0.3816657747132148, 0.1603806845148485,
        0.15943768465286193, -0.1831797140241785, 0.19237689087649196,
        0.09861302956748572, -0.39510792047628024, 0.042052689387143946,
        0.2874378085571977, -0.16150070832782676, 0.04386442061293609,
        0.18898297657009874, -0.33521104448247113, -0.0965671418284042,
        0.3597790898207661, -0.07296391968920674, -0.10698483159464757,
        0.21409368954060415, -0.2167198183046789, -0.21858398994258066,
        0.35975679782606645, 0.05966767162925876, -0.22409658578398273,
        0.1661298486394679, -0.06899901074859789, -0.2912433174046221,
        0.28880376311994715, 0.2023580693607714, -0.27994443558715393,
        0.05581723567271888, 0.07136817753352107, -0.2942022880865949,
        0.16612052180415643, 0.3183844639508347, -0.2624790182696722,
        -0.09230588959692065, 0.05832144889300059, -0.029840496506832792,
        0.06308064532598291,
      ],
      [
        -0.11312860826197038, 0.1315166652806869, 0.008458566243952886,
        -0.024494645557175787, -0.0331673548177372, -0.01299645800474622,
        0.014352379989739674, 0.021893628565289033, 0.0027983726539933104,
        -0.023316590536005155, -0.029108573547031356, -0.0057289343703019295,
        0.02801460922574109, 0.04231449628430079, 0.02360416259942687,
        -0.012774238012527167, -0.03624915442135357, -0.028508077408088695,
        0.0004654834605063267, 0.022422322503448656, 0.017429444036238837,
        -0.007758521175405295, -0.02654788223416055, -0.01806146023838109,
        0.012548625782684026, 0.038133777280597615, 0.034391168611213,
        0.0025643828857797243, -0.031098687784430742, -0.0387956185861848,
        -0.01602042984594462, 0.01497932134795449, 0.026147926739982525,
        0.00945500328019833, -0.016294595548864036, -0.023816161848335866,
        -0.003588387210985488, 0.02661603762314068, 0.03794515020181485,
        0.017460834620138956, -0.019192605215949288, -0.04137935560064719,
        -0.030967761814259302, 0.0015221557369203302, 0.02691409514526297,
        0.024176633347910106, -0.0007594618719149078, -0.021433628384354312,
        -0.016315170656861097, 0.010578205242834498, 0.03320696514031887,
        0.027965009435447483, -0.00370457647422498, -0.03570973634782572,
        -0.040611911094916145, -0.014461690267965285, 0.01970165028175842,
        0.032888031199137226, 0.016307853013391764, -0.011419134690197619,
        -0.0224254070874208, -0.006036109913208062, 0.02120081676511378,
        0.03123431080802655, 0.01129602177140318, -0.023305349305393186,
        -0.042510543734027434, -0.028834761489860777, 0.006503351995407792,
        0.03358590849384213, 0.0307632932557255, 0.003784199013614979,
        -0.020396221966693558, -0.019150451329618474, 0.00477700809535817,
        0.026251615502832313, 0.021871238680624606, -0.007369457271224511,
        -0.036159525032487365, -0.03785359030554909, -0.009172526183770086,
        0.026286025911752907, 0.03911243944622496, 0.020410982710549218,
        -0.010772091035632128, -0.025582775545556668, -0.012105741556841111,
        0.014082909867284877, 0.02520849009792796, 0.008018202214892082,
        -0.02312019623345115, -0.039113378732163265, -0.023187937124702546,
        0.013018070626991333, 0.03939077381678986, 0.03432264422757289,
        0.0039726533831533455, -0.02384710180221461, -0.025377449698969254,
        -0.0023903732258108955, 0.020330665551424654, 0.01893054798327344,
        -0.006625900491504737, -0.03215518456232795, -0.03181963663935157,
        -0.0026872896793855537, 0.03165821807255882, 0.042050705362533414,
        0.020058044943879888, -0.014527408771736118, -0.031882053631827306,
        -0.019196828549318645, 0.008343332527264092, 0.022583705554401416,
        0.009233023212683981, -0.01858249619713932, -0.032699184933387505,
        -0.016689822827353, 0.017983244122273333, 0.041671171443911505,
        0.03335202635123728, -0.0001294998379929007, -0.030172115451007314,
        -0.03227543182812939, -0.007843302935526736, 0.018039193556818277,
        0.020540264733594882, -0.05934659876862089, 0.056000714462360386,
        -0.00634017007141157,
      ],
    ];
    const result = wavedec(data, "db3");

    const reconstruction = waverec(result, "db3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4999041844683345, 0.9215315632059573, 1.2030853507127932,
      1.311802958789152, 1.2496303500559105, 1.0507631206317345,
      0.7718047158970233, 0.477098577017832, 0.22294938585328855,
      0.044671542954168086, -0.05036166016457477, -0.0820512543998005,
      -0.0896253282057698, -0.11860635662896496, -0.20618129441904093,
      -0.3688649518321436, -0.5957576150389188, -0.849265430455834,
      -1.0732384383664517, -1.2065696935011463, -1.1988730930848925,
      -1.0242791825734026, -0.6898064048017791, -0.23607861306018144,
      0.26995844519040474, 0.7486885832104274, 1.1246281325974339,
      1.3423743406833792, 1.37789547293713, 1.2425031699169677,
      0.9786481189125166, 0.648687043567414, 0.31948136427522233,
      0.04667903952866337, -0.13744417357246785, -0.229652021096296,
      -0.2536641805127797, -0.25104030743393946, -0.2675344801215231,
      -0.3385640149817741, -0.4776478046708268, -0.6708982003977885,
      -0.8790924444832694, -1.04689868641444, -1.1169809824450376,
      -1.0454259061095796, -0.8145462804357589, -0.43972604765267986,
      0.03157506142202465, 0.5286002085512909, 0.971863716258067,
      1.2900648903389347, 1.4353038086662029, 1.3929579668778076,
      1.183883692274687, 0.8584883822854812, 0.48420914080231453,
      0.12953399603089594, -0.1514847748016438, -0.33045023254084116,
      -0.40891344425921916, -0.414852092543328, -0.39243057466087194,
      -0.3878303932861327, -0.43491769596008373, -0.544532578686107,
      -0.7002393275942581, -0.8617080506662843, -0.9749284530586343,
      -0.9866842199105299, -0.8595906074037143, -0.5838049948691327,
      -0.18231222528310118, 0.29173248899551973, 0.7651454411390555,
      1.1600093999439225, 1.4104871934206515, 1.4771157193301359,
      1.3551405001280799, 1.074903234657604, 0.6942393108918588,
      0.28479390997926146, -0.08436242234246166, -0.36181116900529847,
      -0.523921453957308, -0.5776848062003254, -0.5557457502752663,
      -0.5050930297816227, -0.4724618284831562, -0.4903024702536609,
      -0.5669949088430054, -0.6838774003379903, -0.7998941635895525,
      -0.8626971261656166, -0.8233596236228278, -0.650900298222937,
      -0.34281803211533257, 0.07119406470258005, 0.5334964442843835,
      0.9698617704164753, 1.3053009773372195, 1.4805707239257981,
      1.4653720472124425, 1.2650377356933835, 0.9190905909853773,
      0.4920416562788583, 0.05869121275932343, -0.312476125520809,
      -0.573777784510006, -0.7072446912766588, -0.7259255305087535,
      -0.6674722627889902, -0.581829598755099, -0.5163132113062006,
      -0.5019853829867462, -0.5448679418011518, -0.6242662894192438,
      -0.6986365630035548, -0.717476926480204, -0.6361575950259393,
      -0.42981955207453615, -0.10266927022161537, 0.3098710196263065,
      0.7469136619080994, 1.134523850097041, 1.401879775534085,
      1.4972772607355918, 1.4000783703404749, 1.125672209620344,
      0.722216681951375, 0.2599388482803652, -0.18441221067590283,
      -0.5441952035107336, -0.7765897059756302, -0.8701512908968823,
      -0.844526249226579, -0.7426103690311875, -0.6173173719003804,
      -0.5164464961297038, -0.4695748003799233, -0.48034127364057777,
      -0.526080441927276, -0.5648606360941502, -0.5480681834494044,
      -0.43523795426267736, -0.20722811707492622, 0.12577340514309948,
      0.5236375484634944, 0.9234448894926345, 1.2527994189832898,
      1.4461283375290694, 1.4599999668933472, 1.2836892452817255,
      0.9423596934390026, 0.49202961310466814, 0.007500450288877553,
      -0.4338546703299241, -0.768543161158407, -0.9597136657628903,
      -1.003234147367749, -0.9257744726263466, -0.7755742042143333,
      -0.6083855120871244, -0.4722532824938212, -0.3950378509314375,
      -0.37784245801320515, -0.3959679297897681, -0.40707179465590576,
      -0.3643504390963459, -0.23126119285553964, 0.00611386869016689,
      0.33238292318811435, 0.7037323691473281, 1.0563652483256323,
      1.3205430772211981, 1.4368370290162935, 1.3705910928890859,
      1.1209950436535752, 0.7224631282532348, 0.23789297554860242,
      -0.2546299387052404, -0.6785107431334402, -0.9747142458380751,
      -1.1134012515347922, -1.0984238232518233, -0.963752206186167,
      -0.7629065052071056, -0.5541851739868198, -0.3854906608504751,
      -0.2826000596817958, -0.24380701507401553, -0.2422057432675875,
      -0.23491842744895217, -0.17678160116862715, -0.034856837645512506,
      0.20009286810082189, 0.5082598103624167, 0.8431273047267249,
      1.1410754183960026, 1.3359835157849997, 1.3752539433681292,
      1.2332707554550348, 0.9188957372432911, 0.4750470723319849,
      -0.029655025162083737, -0.515240298738941, -0.9073267821847679,
      -1.1526022775579454, -1.2291753513197008, -1.1494002002793813,
      -0.9546457918605132, -0.7034666618755905, -0.45624394517933425,
      -0.26019896741628423, -0.13853214409206938, -0.08634836567307216,
      -0.07427444631945324, -0.058699052865121476, 0.004130091062157115,
      0.14390487265204882, 0.3657352634516055, 0.6461571195824012,
      0.9368546394548767, 1.1753085467958797, 1.2997951616376406,
      1.265015746738206, 1.0544212764517789, 0.6860726570994681,
      0.2104494818094139, -0.2994001379683454, -0.7630846465017441,
      -1.1098545143495255, -1.293297016302433, -1.3002558590225777,
      -1.151919283917445, -0.8969525600098068, -0.5985041940601178,
      -0.3184020080719948, -0.10250544912784931, 0.029165496690820525,
      0.08515595319229832, 0.09762672084909083, 0.11116192460795865,
      0.16835520118660185, 0.2960119773999705, 0.4956427970558264,
      0.7408227478912125, 0.9822326266213762, 1.1592229008775927,
      1.2150508701359355, 1.1119629388764851, 0.842277171023643,
      0.4325742492810114, -0.06020830306430291, -0.5599840241081651,
    ]);
    const expected = [
      [
        4.4205151581536235, 4.460013199864885, 4.67489502773023,
        4.306847231908571, 5.152290404720612, 2.0389704283893204,
        -0.08017979567812314, -0.3196801516544375, 0.431259862745796,
        -0.1318389259022438, -0.2141001977641735, 0.07773102196486031,
        0.5663188787438077, -1.190513012516421,
      ],
      [
        -0.060685000414839776, -0.192875006678771, 0.8814469131872897,
        0.3951035260553741, 1.0246094436569018, -1.6102348337672918,
        0.6282033491670098, 0.9464901650692129, -1.5321268024572225,
        0.5840900312269603, 2.2733104475579773, -0.7532277780180778,
        -2.176450440886769, 0.5713839230082037,
      ],
      [
        -0.02063853303627355, -0.11244691473203398, -0.2584690460626472,
        -1.3229310978935895, 3.4879190215226763, -2.0982383316826407,
        -1.6086974843696618, 3.986078657839347, -2.3999965314528016,
        -1.804968407469641, 4.293870876325795, -2.357728801422905,
        -2.0023293470033177, 4.213241424307321, -2.108844784681978,
        -1.9208306434001845, 3.780583294819603, -1.8669452160870792,
        -0.8408708750032167, 0.17935362696985285, 1.5535446961695327,
        0.022438639975177286,
      ],
      [
        0.4994866749912133, 1.6085801438987894, -0.23461598139083367,
        -0.9354852984091518, 0.006032857312445693, 1.4013788702257348,
        -1.6985703346609493, 0.5773017808842112, 0.9078647933905043,
        -1.5073352385600396, 0.8440559822709105, 0.38369877640879513,
        -1.1317843840842283, 0.9141109110436743, -0.08366459842977533,
        -0.6293911600203466, 0.7720894563728682, -0.4179038055839719,
        -0.07828451435742781, 0.43738186578518756, -0.5646376258685806,
        0.43552007093299855, -0.03901919475312925, -0.5003166181681902,
        0.832179016928914, -0.5828510262690695, -0.23607304203125856,
        1.051069812675969, -1.10871830872576, 0.18410026808253627,
        1.0606972501224587, -1.534050961048024, 0.6930774858529652,
        1.0089149424785355, -0.39641437705070764, 0.18378073829363795,
        -1.3173534104242028, 0.29943081878543387,
      ],
      [
        -0.22875685657728864, -0.6522392040462573, 0.5803138646115354,
        -0.3839304612434422, 0.11252971833730822, 0.07964040504109626,
        -0.20197152729132384, 0.16932798330306303, 0.13696628557686366,
        -0.27610790828521387, 0.03596753042952834, 0.15978402003596867,
        -0.1920999484440433, 0.07832253749016409, 0.20840753516217214,
        -0.24459748332366846, -0.060987899484323004, 0.2124746514270245,
        -0.14490456318498493, -0.01818421801038684, 0.24724388193666005,
        -0.17891023591512414, -0.15532408626855324, 0.2288072984895103,
        -0.06829700852350001, -0.10431978052384652, 0.24741364716169534,
        -0.08958776593206934, -0.23170348931677645, 0.20582419171568822,
        0.024993607453600603, -0.16591816644834326, 0.20917496559824705,
        0.008971882490377413, -0.2777138899964894, 0.14699883365966068,
        0.11950233416591736, -0.1928363075765353, 0.13906316338518845,
        0.10086814235090426, -0.2858978002894878, 0.061668459629312534,
        0.19955735584016243, -0.18061264550983117, 0.04882175777436873,
        0.17129751104730137, -0.2549717401156362, -0.036492284121519274,
        0.2518428044555943, -0.13119672753805298, -0.04651812863969384,
        0.20897374591117038, -0.19003601966002792, -0.1317068766846847,
        0.2675763627854595, -0.052630507765476446, -0.1310959039698507,
        0.20797294273849096, -0.1017407253471275, -0.20867614171598006,
        0.24394559757332598, 0.04226653622379714, -0.19081526339838267,
        0.16870180933665246, -0.002458625589218915, -0.4758645142598628,
        0.6776120494012258, -0.28167668090455744, -0.10160965135650576,
      ],
      [
        0.02392839388818603, 0.038574993350977, -0.04673879835390953,
        -0.014747422156891132, -0.0017760918015254368, 0.011298036046946017,
        0.012414807338500535, 0.0011243436581842873, -0.011148632591997032,
        -0.01207428511843493, -0.00023424482344619772, 0.01339782193247719,
        0.01574440284387061, 0.0040039397179425906, -0.011553994379557982,
        -0.017052157114340657, -0.007870122414328936, 0.007151830608138407,
        0.014089608606818403, 0.006989982171643969, -0.006676371993858562,
        -0.013258505699213064, -0.005988357300569012, 0.008494338409003275,
        0.016340544680336907, 0.009590516754116712, -0.006178634275060064,
        -0.016898979592912984, -0.01305366780514923, 0.0015134526377804276,
        0.01327688820284765, 0.011716652824728923, -0.0009218502705897712,
        -0.011948046025285366, -0.010386881991979579, 0.002528354386057915,
        0.014454801369223582, 0.01361215467686712, 2.25994425113573e-5,
        -0.014305820448879987, -0.016479181827876697, -0.004702307912281583,
        0.010097158501016331, 0.014517164790422603, 0.005161515004027832,
        -0.008364529931215283, -0.01271087539087782, -0.003517730867379383,
        0.010407745895199175, 0.015425605012799137, 0.006048372324673262,
        -0.009689102897631575, -0.0175860279834477, -0.010485774976763498,
        0.005058245506478095, 0.014919288144035942, 0.010566278838327569,
        -0.0031017114899059665, -0.012581145695852409, -0.008648904052466176,
        0.004873053829282259, 0.014748654224033913, 0.01092628855782955,
        -0.003795664224506336, -0.016192149764474, -0.014897468670881963,
        -0.0010277281523056615, 0.012842988856719431, 0.014395714469235727,
        0.002971620940717796, -0.010020253229112406, -0.012020241595674087,
        -0.0012326665605242332, 0.011706247653276838, 0.01387186855736914,
        0.0024193477866379185, -0.01252384024303069, -0.017221710527011366,
        -0.007177116155470007, 0.008613535855861306, 0.016010455838564343,
        0.008853712133264031, -0.0054488196472514145, -0.013075071545348569,
        -0.006899765630382217, 0.006810039059628874, 0.014416800078578361,
        0.007948638590786455, -0.007178743279315218, -0.017083635722110187,
        -0.0123955676944543, 0.0029083369893786373, 0.01513305938658893,
        0.013573649433409858, 0.0003832505724287779, -0.011636002770080815,
        -0.011190656385994986, 0.0008747096270261779, 0.012485492555473036,
        0.011897456497932904, -0.0010281360135923749, -0.014510479659347451,
        -0.015840597450472834, -0.0033538032942368057, 0.011893388254874815,
        0.01635012975833991, 0.0065193904033680776, -0.007933937279536634,
        -0.013393135058377043, -0.005115260860935081, 0.008407417309378728,
        0.01362987981707488, 0.004925529590798342, -0.009927117956749176,
        -0.016959324583714755, -0.009162897122523952, 0.006807398107179412,
        0.01671922416817058, 0.01195278267529288, -0.0025703218578189274,
        -0.013136848787194599, -0.01016658642860825, 0.0028632159101945748,
        0.012872782162703758, 0.0097125328020487, -0.004086589108376228,
        -0.015578859078612381, -0.013582895932392708, 0.025978366991964486,
        0.03909326256745349, -0.037999112556432076,
      ],
    ];
    const result = wavedec(data, "db4");

    const reconstruction = waverec(result, "db4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48661435291820676, 0.9003557877981487, 1.1831053813078225,
      1.3028768233333483, 1.2592455210032891, 1.0816644091902494,
      0.8211841231505423, 0.5376449864498667, 0.28545583669338037,
      0.10137061441271922, -0.0028505511085720747, -0.041224436917103924,
      -0.04771231948801248, -0.06533028437401955, -0.13299367166937837,
      -0.27343779996551476, -0.48529248805084707, -0.741371956157203,
      -0.9937199411541309, -1.184290135432327, -1.2587459004867871,
      -1.1800691049693068, -0.9386697202775565, -0.556487822702252,
      -0.08398802919641428, 0.4093734313822694, 0.8490792550765667,
      1.1707020674285502, 1.3328049014206016, 1.324650552664077,
      1.1670069345381169, 0.9059665086417806, 0.6013414951619526,
      0.3124597085291796, 0.08476720584879355, -0.05959363602961498,
      -0.1250585838377612, -0.139109789007448, -0.14294270873942946,
      -0.17874870329502907, -0.2768500133956108, -0.445953555226493,
      -0.6690229392830285, -0.9058899401618157, -1.1020706101768463,
      -1.2017180019577625, -1.1616045239734953, -0.9627350451840094,
      -0.6167200117105821, -0.16526158812015596, 0.3272669534232705,
      0.7865273804096129, 1.1433257567745452, 1.347663776399973,
      1.3785143952384638, 1.247111275141937, 0.9930718458736646,
      0.6743607600644126, 0.35354057033455644, 0.08360571901131852,
      -0.10324718747340383, -0.20130630377017955, -0.230249814293458,
      -0.22768831085826852, -0.23731012367521287, -0.29565869746523715,
      -0.420894337688804, -0.606398462763285, -0.8208868566464043,
      -1.015097735044294, -1.1334980656683038, -1.1282004544809092,
      -0.9717068350681975, -0.665335579067539, -0.2411902750260483,
      0.24294739563133044, 0.714736417425219, 1.1019064703111565,
      1.3470534309139064, 1.4192032481983592, 1.3195030008140776,
      1.0797805189597955, 0.7543924269629485, 0.40735329474362564,
      0.0978299491023778, -0.1325649555052026, -0.2677187802704996,
      -0.3184221567087735, -0.3170476104156437, -0.30695548799787653,
      -0.3293529232732924, -0.41093836636621744, -0.555458340027734,
      -0.7413351773916477, -0.926029116867136, -1.0561372973652505,
      -1.0808081057538232, -0.9652074110587492, -0.700718849727292,
      -0.30930922162584684, 0.15913566732148354, 0.6360285510824526,
      1.0478088527216398, 1.3310525763064032, 1.4454909439228056,
      1.3819461261271422, 1.1633847895458076, 0.8389085938007665,
      0.4721581316665473, 0.12690695538835, -0.14674481805124234,
      -0.32235184217672636, -0.4010084307733394, -0.40835808467988544,
      -0.38561883505911354, -0.3769604350183609, -0.4164410480560371,
      -0.5178001121049997, -0.6696901454169042, -0.8375868740355159,
      -0.9719696457075462, -1.0208116223707884, -0.9433380408965113,
      -0.7216638533242731, -0.3673954314548092, 0.0785368426407328,
      0.552939978395421, 0.9827899083320478, 1.3002162141345806,
      1.456596921591744, 1.432512358689429, 1.241272655629441,
      0.9252421003190759, 0.5458745892432373, 0.16984356758685737,
      -0.14545362115929517, -0.36362617298104105, -0.4755631939242023,
      -0.4988966252897826, -0.47095466875747954, -0.43707775975620167,
      -0.43727865786263287, -0.4946095715904056, -0.6081617213384807,
      -0.7524733331155334, -0.8835395208244661, -0.949985218460039,
      -0.9066758040190697, -0.7274116744917078, -0.4135366274801224,
      0.003756383090837312, 0.4681423612173261, 0.9089445856816847,
      1.2555584470011425, 1.4522104006650003, 1.4696408181881977,
      1.3110087454360841, 1.0106691305419464, 0.6261458675566357,
      0.22521714554284655, -0.12883749533827105, -0.3903762206712863,
      -0.5398896802427008, -0.5859638713778609, -0.5604105967733324,
      -0.5079136719346746, -0.4728521703250112, -0.4866240384474507,
      -0.5586461411201274, -0.6732873384245625, -0.7935229948974366,
      -0.8704382315024266, -0.8562557207836846, -0.7176739579106619,
      -0.44619047674402645, -0.06278055494874657, 0.384360083688072,
      0.8286408959821472, 1.198521071055402, 1.4325000052950498,
      1.4921863767049541, 1.3704097410705427, 1.0924935698910165,
      0.7104118495969027, 0.2912196395681236, -0.0975173284802337,
      -0.401886293306305, -0.5921078326794121, -0.6669678072370446,
      -0.651306376816909, -0.5873446666117056, -0.522105810583946,
      -0.49410952498950816, -0.5226671898657438, -0.6024437664518276,
      -0.704644925179394, -0.7845497973847823, -0.7935386992856817,
      -0.6926418401396146, -0.4642323578576575, -0.1189042286560601,
      0.3042858768781414, 0.7444465748432245, 1.1309289228515722,
      1.398108541606022, 1.4994551232056719, 1.4176119960783318,
      1.1681305043941972, 0.7959883889497881, 0.3657135868978181,
      -0.05256953556840177, -0.3979127224470569, -0.6307125268221494,
      -0.7395040355153609, -0.7409169223869033, -0.6729807233535299,
      -0.5835597510600051, -0.5168524972411372, -0.5013290104019406,
      -0.5420987377586513, -0.6195945661475354, -0.6948951698140384,
      -0.7203662924576664, -0.6529800316059012, -0.4669901919884921,
      -0.1627675070552213, 0.23049742372912135, 0.6590495585480154,
      1.0549333634697773, 1.3501330895863113, 1.4912258538724705,
      1.4511292528040927, 1.23518627602224, 0.8801504386736789,
      0.44629831005628473, 0.004507279267813358, -0.37869140804314144,
      -0.6546201830200578, -0.8014302398818076, -0.8265566973553518,
      -0.762239324108606, -0.6553559410279595, -0.554166487829208,
      -0.49528190816623757, -0.49408284254187484, -0.5409422842769476,
      -0.6041659659760121, -0.6389036666199883, -0.5998062320397911,
      -0.4542652586275929, -0.19290307803096424, 0.16537752703186237,
      0.5751747377233782, 0.9729456501938301,
    ]);
    const expected = [
      [
        4.360017764499405, 4.405443927841987, 4.603358859776475,
        4.275616208613553, 5.064254780578763, 1.970614793691008,
        0.07820786446360618, -0.2855302116642535, 0.03950453146288502,
        0.23719482035876166, -0.1818406946381021, 0.300222777648422,
        -1.2379956762671334, 5.4593350256624475,
      ],
      [
        -0.05823330042106015, -0.19493807868773336, 0.7137808505462429,
        0.2017049746789851, 1.833665366359256, -1.3676152242294122,
        -0.9915644701216466, 1.5239483491476278, 0.5495785067695468,
        -2.003107938124453, -2.5238448166145924, 0.8747419075676035,
        2.691198948847134, 1.167296130929332,
      ],
      [
        -0.02043051153215903, -0.11551048913368282, -0.28650101154897967,
        -0.9104340216383029, 3.6603092638326014, -3.3597848890637954,
        -0.20621962001682845, 3.681709213387191, -3.721590964499095,
        0.8368098117596426, 1.9374612264834574, -2.9782981581169663,
        2.520360335770443, -0.6487699066367852, -2.3033200937089133,
        4.091871852574918, -2.369591531231316, -1.811953957497992,
        2.2734717553325656, -0.6408103712306528, -1.7464351949610089,
        3.4257205290064365,
      ],
      [
        0.49836244305468475, 1.6032427687003457, -0.26540728271282715,
        -0.9038459302895483, 0.17143725050697717, 1.018175013996781,
        -1.3771818300832792, 0.7379175667977341, 0.13654699404722087,
        -0.6061984870747513, 0.6540545222941841, -0.5717699993799985,
        0.4034241130580269, 0.07283500298886458, -0.8248485475983355,
        1.2743181660486091, -0.7780276087239711, -0.5528755958500243,
        1.6871729969008527, -1.5390883617263305, 0.07558983897374207,
        1.5158960287859138, -1.8747587014899634, 0.729951675113766,
        0.8791556753018531, -1.6194530844610033, 1.0647694508629029,
        0.0861039018147073, -0.8507585898151756, 0.8736219161215861,
        -0.49996659990461123, 0.14225489225505558, 0.18171437859916933,
        -0.5373847782025449, -0.016288545167182575, 0.07326703828267267,
        0.6436463375419325, -0.48681287136203694,
      ],
      [
        -0.22219822264953548, -0.6320238791990765, 0.5642922428265845,
        -0.3648683560466213, 0.09124396636713257, 0.09767880667003496,
        -0.1948502933692882, 0.11300239111829584, 0.1814261677876195,
        -0.23049924942312353, -0.04434280383425522, 0.18759074442417253,
        -0.14233628119617822, -0.03445236960789128, 0.24848598816606898,
        -0.11949410629081633, -0.1833809233317828, 0.18867197306484954,
        -0.020126373746843264, -0.15124494854842307, 0.21651279907344914,
        0.03735280674968691, -0.25820452789424553, 0.09726556102779486,
        0.11508766886839555, -0.1872585725270012, 0.1022914340552003,
        0.17560936581851216, -0.23518278824072272, -0.0494480394316368,
        0.20070219739667491, -0.12840353168411098, -0.0423710049953256,
        0.23906707137602645, -0.12233179172876812, -0.18945464512304047,
        0.19564468057501272, -0.002645335932735759, -0.15329359964009168,
        0.2039331056307479, 0.03404782330588005, -0.2627517864717509,
        0.09846050885205702, 0.1322953317281871, -0.18189560453902848,
        0.08893970302733517, 0.16932608169533053, -0.2373750152352774,
        -0.05183164050420354, 0.21421616034465235, -0.11633314682461507,
        -0.053008724680559845, 0.22842912926861417, -0.1232967851740703,
        -0.19250126724108071, 0.20368452862315772, 0.01338910187343417,
        -0.15800749059840935, 0.1895479167817654, 0.031843175104442886,
        -0.2642115564809216, 0.10140946543685186, 0.14855070412375798,
        -0.17983503865716322, 0.029724657516188017, -0.11028530530407823,
        0.08720279631866712, 0.0016403123592929358, 0.16408176421100165,
      ],
      [
        0.022976781156320826, 0.03692298598126562, -0.04448200472973558,
        -0.013802931690320576, -0.0025075639206737447, 0.009722357596769355,
        0.011990391997524587, 0.002701031409052831, -0.009109927742853751,
        -0.012106181308916143, -0.0030676573309233834, 0.010070258372920927,
        0.015335696727347118, 0.007572108928135651, -0.006799489752821025,
        -0.01544011205389453, -0.011091228144035212, 0.001997061888571447,
        0.011989111955403638, 0.010169680110452127, -0.0012520955794300798,
        -0.011280676384357764, -0.010245390636148256, 0.001302816440986278,
        0.012994287405874504, 0.014002378700551052, 0.002899681272543945,
        -0.010923016753202818, -0.015590305501958179, -0.00732937734202563,
        0.006228221567131166, 0.012989668964347906, 0.007298015052904242,
        -0.005064138705449757, -0.012262800014955822, -0.007279323559977419,
        0.005614763342204772, 0.014663352966217135, 0.011283565728574014,
        -0.0020714118608339913, -0.013981924874141516, -0.014228693757438286,
        -0.002900081385778963, 0.0097650184915692, 0.012637426964622726,
        0.0036843725399384013, -0.008331682962607202, -0.011944223187012404,
        -0.003503510463100831, 0.009427158280868056, 0.014895603035877234,
        0.007436310580798314, -0.006856780767708955, -0.015681155035381738,
        -0.011499711334125924, 0.001751231494926687, 0.012260958606291918,
        0.010985137647969045, -0.00028697594125752924, -0.01070847791709495,
        -0.010348341087661864, 0.0006998578772598012, 0.012345078607197971,
        0.013651516247478169, 0.002830973127519709, -0.010989280913590463,
        -0.01585964476643576, -0.00768144951735601, 0.0061612938913009115,
        0.013478269679061898, 0.008218461703613386, -0.004196546104161199,
        -0.011941479779816539, -0.007632224715752454, 0.004900606098034294,
        0.014060252469417672, 0.011038937221797059, -0.002085024977281408,
        -0.014065170646509289, -0.01450591947799457, -0.0031573944725723866,
        0.009895391627609938, 0.0133110007139047, 0.004635989517655604,
        -0.00763322285687894, -0.01189726447404054, -0.00407101497460622,
        0.008664410393298422, 0.014383090119145105, 0.007303333119836707,
        -0.006831265109508611, -0.0157840263042172, -0.011758827137054532,
        0.0016221854768613247, 0.012590599294638722, 0.011794626606784504,
        0.0006178254982660801, -0.010236858481363414, -0.01057608708474082,
        -3.0065968670541475e-5, 0.011597340006214549, 0.013262903202472115,
        0.0028041815308663953, -0.010941836004370018, -0.01597843709233815,
        -0.007893369611940987, 0.006185309188055377, 0.01399153327815784,
        0.009101258546705333, -0.003414007737101314, -0.011735512561665423,
        -0.008112129091092143, 0.0040723431009493495, 0.01338655923981686,
        0.010794199380958009, -0.002020200727944587, -0.014011543119478748,
        -0.014630520968093242, -0.003293071883334473, 0.010085280672503793,
        0.013975067821805486, 0.005521022403981312, -0.007039265866030208,
        -0.01197351434695082, -0.004759890698003228, 0.0078079342303518096,
        0.013833017574824122, 0.0802715982110513, -0.14414157413423762,
        0.03764311976678894, 0.016771631325851587,
      ],
    ];
    const result = wavedec(data, "db4");

    const reconstruction = waverec(result, "db4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5103691465061571, 0.9377135864892037, 1.217125626792337,
      1.31545578337957, 1.2371522283472822, 1.020973618752555,
      0.7285830860272517, 0.42809030347948035, 0.1768611809790353,
      0.00803870602278417, -0.07581384019783605, -0.10045079372018603,
      -0.10986032759992748, -0.1512272552969613, -0.25911676021355284,
      -0.44325275133248226, -0.6833054609340119, -0.932237073834604,
      -1.127470971819269, -1.2070487773044987, -1.1265722366851723,
      -0.8724553959044492, -0.4679120592293003, 0.03005601847482521,
      0.5420996199053668, 0.9836491580775075, 1.2835129873597113,
      1.3993400306873915, 1.3261327773244906, 1.0957690508811502,
      0.7677832104577604, 0.41387542573664327, 0.10018716334099165,
      -0.12810267725137575, -0.2559734248627354, -0.29933430103157277,
      -0.2973931369298938, -0.2988588328206533, -0.34582904394484776,
      -0.45980684469175487, -0.6337061826468069, -0.8321001318756471,
      -0.9997602598342193, -1.0763091340116264, -1.0131463488093184,
      -0.7881496406940702, -0.414173184082632, 0.061066532423230346,
      0.5639163535499498, 1.0104441253228635, 1.3249951500351822,
      1.4570426526512141, 1.392140479766977, 1.1542783162275005,
      0.7991248955101788, 0.39995703394246856, 0.029913198395937757,
      -0.25489574977055274, -0.4271676147679635, -0.4922103256734161,
      -0.48300678224425786, -0.44808136168269797, -0.43558264420072557,
      -0.477964850482244, -0.5814589246870228, -0.7232256128041341,
      -0.8570195009932717, -0.9259072497693406, -0.8786760769567503,
      -0.685542150545366, -0.34889520217639275, 0.0939337195795136,
      0.576842978067791, 1.0187119407340313, 1.3413929123640829,
      1.4874739611875614, 1.4333643441967014, 1.194422682915106,
      0.8208626280209287, 0.3855102743119688, -0.03345356109573566,
      -0.3703872650105963, -0.5862274130887112, -0.6752285344723813,
      -0.6628893217755971, -0.5958586996516715, -0.5266981042609942,
      -0.4976917492235728, -0.5281032832548884, -0.60832412657793,
      -0.7024983607335403, -0.7589310750464723, -0.725490494665328,
      -0.5658506215629012, -0.2721505235845525, 0.12945697670433753,
      0.5820618292872011, 1.0094609583846192, 1.3330785107735277,
      1.4901373457413727, 1.4485058839352614, 1.214455410783887,
      0.8313483896909347, 0.36957704117867063, -0.08971151737025024,
      -0.4730056165725901, -0.730333822096507, -0.8447663969326389,
      -0.8332846050693522, -0.7390417256709543, -0.6172684129105146,
      -0.5186996548147091, -0.4749996100241096, -0.49008112774561846,
      -0.5396140653819408, -0.5788132827474616, -0.5563728908964092,
      -0.43075275534116003, -0.1843636240302996, 0.16828610682088252,
      0.5808586055023202, 0.984048308286723, 1.3009533966718072,
      1.4651385552117884, 1.4368183171587006, 1.2130204453440074,
      0.8290933174746924, 0.3511123704521404, -0.13894853220848663,
      -0.5615827415408654, -0.8570758595570183, -0.997512063763104,
      -0.9905820581137822, -0.8744447964240891, -0.7052046710514361,
      -0.5404523831161803, -0.4232919035233234, -0.3710873871589648,
      -0.3718661633695624, -0.38925022187537067, -0.3745019857862246,
      -0.2823614765578045, -0.08632286575586118, 0.21087983757698975,
      0.5745656278134228, 0.9441257514825825, 1.2464131163681564,
      1.4131801611838557, 1.3981324473196244, 1.1892023187476937,
      0.8128269730455526, 0.32903510777496936, -0.18151628274441495,
      -0.6353638652468117, -0.9644970362394203, -1.1305392746027096,
      -1.1314039681953687, -0.9989255458762627, -0.7882897100692997,
      -0.5621800870292126, -0.37387980841690654, -0.2537747936678855,
      -0.20275103999725663, -0.19411476860670185, -0.1833825240398841,
      -0.12318763034027769, 0.020818865692802835, 0.2574711827934408,
      0.5645056172404576, 0.8915792913298388, 1.1713004381969299,
      1.3355413968841072, 1.332868413482868, 1.142565662467797,
      0.7815522791011221, 0.30228110229197036, -0.21799612550466915,
      -0.6940051276081465, -1.0511292556625966, -1.24137239711689,
      -1.2526879603121124, -1.1094658726724311, -0.8642381938167278,
      -0.5829035441149641, -0.3274004686919457, -0.14035920870177754,
      -0.035678460575513105, 0.0026346562373202875, 0.013233038444934411,
      0.04390907606141753, 0.13555504283292052, 0.3080409424755699,
      0.5519378621652947, 0.8284644674124602, 1.0778481779322775,
      1.234043956163756, 1.2420328764693676, 1.0731830068478503,
      0.7345942796028815, 0.2698570835689027, -0.24915778425809124,
      -0.7375594859374948, -1.1160134554287513, -1.3280399694172218,
      -1.3517624709095988, -1.2032518928769254, -0.9307615101406097,
      -0.6014673630563295, -0.2842206566120288, -0.03279185839984744,
      0.1261076683158659, 0.19704653995101712, 0.211429787093584,
      0.21577977748955585, 0.25604788166002707, 0.3623003781547573,
      0.5380085516855031, 0.7569393510086202, 0.9686134377873153,
      1.1110047096869404, 1.1272015969473603, 0.9816498541519997,
      0.6716410374001316, 0.2308933435087979, -0.2759123931750938,
      -0.7664516279592034, -1.1587066834821786, -1.3891154314849237,
      -1.4264131998889638, -1.2777506311791034, -0.9856355806220798,
      -0.6165810772866327, -0.24443926426785512, 0.06727953121058977,
      0.2796022754593752, 0.38526780831367013, 0.407220373865313,
      0.38905537402249235, 0.38016186520121176, 0.419683808214909,
      0.5237068978987762, 0.6791972928339087, 0.8464051877755698,
      0.9691766409631788, 0.9904877548165907, 0.8690863555020146,
      0.592775191822418, 0.18469336836300235, -0.29926159363686944,
      -0.7814429418863927, -1.1792756816300047, -1.4237440800851089,
      -1.4749387535448533, -1.3307812829530694, -1.0267695943020647,
    ]);
    const expected = [
      [
        3.387592203256068, 3.5937784716467895, 3.761178341891504,
        2.92660465219239, 3.6010407822565105, 3.2590262536746315,
        4.771811790228625, -0.6141373286741307, 0.2812714013549593,
        0.566505566779367, -0.764854478499674, 0.091586283132426,
        0.6820386515730187, -0.6751925511674545, -0.09951316238105756,
        0.7561743665556688, -0.549001976616039, -0.2804881922032472,
        0.7902946390817994, -0.40691642942471795, -0.5604082926045002,
        1.6487236708263626, -3.225217479574896, -2.4078900930046534,
      ],
      [
        -0.11445399591782579, -1.4047788418745095, -0.6715748540162395,
        0.06875786744212253, -2.5629202411454677, -0.10010380079037906,
        3.666220392075065, -3.412557890740581, -0.6577209132599998,
        3.9595359946865893, -2.7351127860595317, -1.5934962961458683,
        4.081410777473434, -1.9114585492079086, -2.416500739726841,
        3.9672787649164936, -0.9990535427050229, -3.090918034537454,
        3.355405692222927, -1.0471359562818185, 0.9371597093951745,
        -3.385570690155829, 3.784818938424563, 0.007925607142573813,
      ],
      [
        -0.07240793525959796, 1.2574809648640832, -0.41435412527905374,
        1.68856127640654, -0.3149206202822841, -0.767570310813352,
        0.9298442107545251, -0.27160131633717294, -0.6229644892428432,
        0.974501705187717, -0.45011732528558573, -0.4959056633221465,
        1.0143629118336015, -0.6232440604529673, -0.3440806237712339,
        1.0213940529453902, -0.7850344167452894, -0.17168324577731572,
        0.9942429426805918, -0.9297809842348047, 0.016351202338513088,
        0.9326141708923897, -1.0521959057329446, 0.2144889312740663,
        0.8372922451214727, -1.1475795185102482, 0.41675988174756723,
        0.7101322060078147, -1.2119726632889536, 0.6169346051645034,
        0.5540178099748786, -1.2422880095753888, 0.8087837921330522,
        0.3889245216474044, -0.9596747864505535, 0.25548344860155064,
        1.0708403215378879, -1.4069821916434941, -0.022093491832898396,
      ],
      [
        0.005262547523005255, -0.1966083350716285, 0.7116679413152536,
        -0.4644827357657443, 0.11657847434910021, 0.11204809112453404,
        -0.18426957399990296, 0.12748162405276056, 0.08185924049043157,
        -0.23538809009176112, 0.09396710042294477, 0.1299942557296284,
        -0.18521741612363296, 0.09329107255946947, 0.110014238651971,
        -0.2321292677207877, 0.06395667544399736, 0.1606296221196816,
        -0.18035892726189667, 0.05648523294264619, 0.1346688663641325,
        -0.22247217332186897, 0.03198778630281861, 0.18687054596106592,
        -0.16984901615931816, 0.018094607341460577, 0.15507158918684158,
        -0.20668362572137863, -0.0009593065857853487, 0.2079788604576193,
        -0.15401283662080406, -0.020804862209129565, 0.17059935778215926,
        -0.18520471656903542, -0.03387517473947701, 0.22336203246420686,
        -0.13333604426668502, -0.05912262756972448, 0.1807761748261763,
        -0.1586381892229791, -0.06575134478226592, 0.23259015616697631,
        -0.10845029772978462, -0.0957847916574914, 0.18528730293158405,
        -0.1277311549176264, -0.09561039313598597, 0.23540825607568405,
        -0.08011443212731427, -0.12976488359323562, 0.18398869436454202,
        -0.09335364696118116, -0.12253512435183729, 0.23174354322117932,
        -0.049191859938496806, -0.16011326047754829, 0.1769113638651251,
        -0.0564736345914107, -0.14569597210625282, 0.22170741508241554,
        -0.01662486542629649, -0.1859842844104447, 0.16426057459310217,
        -0.018129220899717136, -0.16205951988931316, 0.2510913579436183,
        -0.24084349599705565, 0.16047990862250908, 0.04494882138620954,
        -0.21686348376308467,
      ],
      [
        0.0824067060988913, -0.07442763175055708, -0.019197342301899255,
        0.012641268785555899, 0.007282902045316939, 0.006022623946494382,
        -0.0009293601971431626, -0.006610683079757401, -0.00539948689179667,
        0.0014797401497495932, 0.007162489043274872, 0.005882750626360263,
        -0.0013409054668003754, -0.007635067400604793, -0.006927878712568076,
        0.0001472249487374194, 0.006853719570930504, 0.006877094451169909,
        0.0004209779566763938, -0.006054349089943062, -0.0061785439213781785,
        0.00010010702665651808, 0.0064835231251467165, 0.006515236824144616,
        -5.81052343635491e-5, -0.006977866943747161, -0.007535595473502764,
        -0.001105018305984807, 0.006224251768364615, 0.007535758773269752,
        0.0017679349945051766, -0.00531088736073978, -0.006768425915898618,
        -0.0012778374008080523, 0.0056144160368521425, 0.006951583882311114,
        0.0012172031317019517, -0.006126833738795363, -0.00793130179703088,
        -0.002329046706050507, 0.005414068956170533, 0.007980336217327084,
        0.003072642372051255, -0.004402135522272291, -0.007152576930565358,
        -0.0026148914063261145, 0.004579406083086678, 0.007178105559297697,
        0.0024473029481154405, -0.0051066690363901854, -0.008102691648370425,
        -0.0034879824272790946, 0.004448007444786925, 0.008198721409441055,
        0.004297340909371702, -0.003354896497742417, -0.007320559573951099,
        -0.0038730956242888073, 0.0034076047475989123, 0.007187337069526716,
        0.0035959272419563556, -0.003946885123199131, -0.008043915576566706,
        -0.004546810515248495, 0.0033554281976435054, 0.008185326282658929,
        0.0054064794519928724, -0.002200151864066159, -0.007268349548011497,
        -0.005016827633939909, 0.002132160984712237, 0.006978264513858027,
        0.004629322967631463, -0.0026809467785228564, -0.0077557628782146115,
        -0.005473417537562718, 0.0021693436600496016, 0.0079412328196216,
        0.006367750732375507, -0.0009721513310216208, -0.006998441476648334,
        -0.006013827806899386, 0.0007893069765347325, 0.006556364427326813,
        0.005517239978879387, -0.0013452989135497651, -0.007245650898288174,
        -0.006239545753540267, 0.0009254384777172151, 0.007474152229053916,
        0.007153034197667528, 0.000292594981082331, -0.006519763086813447,
        -0.006836126637917965, -0.000582686947713908, 0.005933452156122074,
        0.006233815816876922, 2.1691262302688528e-5, -0.006527421616110579,
        -0.0068216347049132745, -0.00033898708028461426, 0.006798191871842626,
        0.007739218265462856, 0.0015563919219322812, -0.005847400422303477,
        -0.007460846661392571, -0.0019446178692188558, 0.005127343383092335,
        0.006758330444670094, 0.0013808467271537706, -0.005620951283592702,
        -0.00720152542005301, -0.0015861199306518668, 0.00593343685166038,
        0.008108877969342638, 0.002781470807802937, -0.005002142306521877,
        -0.007870855722077075, -0.003257484173133365, 0.0041613386034806505,
        0.007075808883640438, 0.002693315386654961, -0.004551584336381819,
        -0.007367006441128365, -0.002778750815451118, 0.0049053585806567695,
        0.00825078815894496, 0.003931104416666162, -0.06570685284551074,
        0.0590825516225794, 0.015402260505889609, -0.012636012824367677,
      ],
    ];
    const result = wavedec(data, "db5");

    const reconstruction = waverec(result, "db5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4908320264131175, 0.9047658092534953, 1.1814033997905509,
      1.2893598190283746, 1.231796958156284, 1.0437293407364931,
      0.7819006476713921, 0.5098689136720858, 0.2821056679833783,
      0.13111768532379975, 0.06079088170060282, 0.04754154779080874,
      0.048851169420743065, 0.016867505733295318, -0.08654332542761967,
      -0.2772821429995657, -0.542381415150281, -0.841089257450013,
      -1.1135352706499668, -1.2948896977133613, -1.33149783114435,
      -1.1949274465921746, -0.8903486040619462, -0.4570535892581977,
      0.03912810978368429, 0.5197487482479305, 0.9106465301804559,
      1.157744604498182, 1.2379350814572532, 1.1624704773678294,
      0.9721578536612691, 0.725692402820057, 0.4841632668646809,
      0.295688656133855, 0.18405894868344325, 0.14420805048152296,
      0.14556521206896827, 0.142311229417591, 0.08778940749754416,
      -0.050747140729106466, -0.28096305262264765, -0.5808471206892674,
      -0.9020238780549459, -1.1802735328562985, -1.3507076492613916,
      -1.3638307389547017, -1.198449397977776, -0.8681414456081286,
      -0.41958078982954655, 0.07696793663302803, 0.5427251731156231,
      0.9073993795090249, 1.1240007841960187, 1.177905614758493,
      1.088054933688094, 0.9001405157899933, 0.6736261392761163,
      0.46597358523830223, 0.31810646089477274, 0.24478656137386184,
      0.23229028072555025, 0.2438847434171285, 0.23159465274689306,
      0.15113134310941706, -0.023963662688837484, -0.29271886700298566,
      -0.6242843346102409, -0.9634210630039618, -1.2426844312600283,
      -1.3983331170570403, -1.3860134188148505, -1.1922814060624087,
      -0.8390313462862904, -0.3796470151787641, 0.11225625914272809,
      0.5587925378897174, 0.8945998224735563, 1.0804034463317775,
      1.1101042851244125, 1.009776953769478, 0.8289894892078529,
      0.6267684923116004, 0.45585071508652797, 0.3492530261983896,
      0.31256138329667066, 0.3238482643541307, 0.34115669154964234,
      0.31553844838757633, 0.2061996980876492, -0.006246605131864924,
      -0.31195406926510505, -0.6716022671918058, -1.0239728694752934,
      -1.2995747078425999, -1.4369891359532116, -1.397880346462316,
      -1.1769088295938013, -0.8040284643650568, -0.3385276929502285,
      0.14377950035017578, 0.5671108528061921, 0.8719987086094565,
      1.0273618306179755, 1.035499214113681, 0.9289218791382191,
      0.7599844098001347, 0.5860706991433671, 0.454176547320019,
      0.38884262485681015, 0.38649941962136214, 0.41761936217339146,
      0.4360543975776736, 0.3930823250285056, 0.25246350193549427,
      0.0025317551549119965, -0.3379188474697565, -0.7216220798992582,
      -1.0823719356486923, -1.3498403129117942, -1.4660541795539481,
      -1.39944852680313, -1.1529806470136417, -0.7642464263655195,
      -0.2975155001670674, 0.1703973625509657, 0.5669854019390703,
      0.8395274631461589, 0.9654554752017032, 0.9551755949553059,
      0.8468094257240695, 0.6943480401360982, 0.552350398051688,
      0.46115656340516564, 0.43641503682358446, 0.46558832514905224,
      0.5122912663734657, 0.527292838139483, 0.46328844204860886,
      0.2895640985383404, 0.002677728407059987, -0.36972374089228904,
      -0.7730996230550597, -1.1373365607474182, -1.3924874875011406,
      -1.4850739164251578, -1.3909169536088952, -1.121296758201634,
      -0.7208806831537606, -0.2578952476509888, 0.19106506262460524,
      0.5578804740509316, 0.7972998386172923, 0.8954235422160277,
      0.870315286355261, 0.7647687006256924, 0.6332230216529307,
      0.5262759908935841, 0.4768157607841414, 0.49134406876363435,
      0.5487063672145649, 0.6065266173334204, 0.6136526783499073,
      0.5253588237636435, 0.3173215248672291, -0.00533005280517479,
      -0.40635696085626327, -0.8247494318845208, -1.187635309118775,
      -1.426651755639516, -1.4937697901366214, -1.372662609625227,
      -1.0827924174724533, -0.6751853130773423, -0.2209189196961689,
      0.2048537431830789, 0.5394300614039524, 0.7456101928732697,
      0.8181511060481105, 0.7821745729027486, 0.6841130526321524,
      0.5776501696486901, 0.5083538674161635, 0.5009980356583424,
      0.5528492526048971, 0.6346434856160926, 0.6989881054027212,
      0.6940030750369346, 0.5786501050907731, 0.3357374766906636,
      -0.020850193030199637, -0.4467040553203638, -0.8752695228495454,
      -1.23211066876053, -1.451614464079297, -1.4920442595015377,
      -1.3452330835919004, -1.0385200951237015, -0.6284487150995262,
      -0.18778134565088256, 0.21096866966253794, 0.511445321968333,
      0.6849283259553449, 0.7346526656048273, 0.6920605161454565,
      0.6061152361811954, 0.5285487251430573, 0.4989187351576811,
      0.5333690350363594, 0.6200105000773449, 0.7221240480404937,
      0.7883635790704933, 0.7673227955756432, 0.6226853277003657,
      0.3449948051222496, -0.04309120537494221, -0.48956954168765754,
      -0.9233665169025851, -1.269701312730163, -1.4668165538550242,
      -1.4799825990928994, -1.30933594521496, -0.9896291138876941,
      -0.5819686560564865, -0.15959696799761997, 0.20876486572656888,
      0.47391866222037704, 0.615890973944654, 0.646053194817543,
      0.6013063472848872, 0.5319833624434038, 0.48669894031395466,
      0.4981272394547674, 0.5734224237399015, 0.6917854338320458,
      0.8098308670919058, 0.8733906808051428, 0.8327192497653352,
      0.6571625620023447, 0.3454535540277382, -0.07112705276865605,
      -0.5337000947431428, -0.9677806100446491, -1.2994625385199656,
      -1.4718693008499937, -1.457851225735491, -1.265825080979622,
      -0.9373434490861009, -0.5370271484791154, -0.1373781505964587,
      0.19775988822933271, 0.42702436220262063, 0.5392901216829655,
      0.553567092592441, 0.5112463707196481,
    ]);
    const expected = [
      [
        3.369696944715172, 3.5334244235208634, 3.717981822948845,
        2.8760188955789836, 3.5406540440267165, 3.2249319608584335,
        4.809275797913266, -0.8917748487248893, 1.0254748251186592,
        -0.2920946328263927, -0.5961490137996716, 1.0820654408873653,
        -0.8701775730268253, 0.07028894235369765, 0.8241968264279467,
        -1.1876641634700047, 0.7021399265038462, 0.32697331174531086,
        -1.1338925710750802, 1.1163629940707378, -0.37062495927636424,
        -0.5684118434267201, 1.4262830495561785, -0.2510678334204722,
      ],
      [
        -0.11558454068426167, -1.4290146238703192, -0.684572150527825,
        -0.06838019617029367, -2.5121626177448606, 1.3030479906011305,
        1.4118094426510113, -3.1810628605593134, 2.935930102063697,
        -1.0406237369682823, -1.4891245186036184, 3.3305718037914183,
        -3.134135877882403, 0.5613991653535266, 2.7889141098776444,
        -4.2147606489474745, 2.3293306505411944, 1.3993427036751411,
        -4.0146627813152, 2.0132048177855664, -1.6175593888824573,
        3.7889873092532085, -1.91251855396178, -1.798213548488036,
      ],
      [
        -0.08020095893091678, 1.226186693924702, -0.4648581273477344,
        1.6597018942296082, -0.32320990674734207, -0.8768832102464256,
        1.2720200339284014, -0.6194857762000466, -0.6930604083524647,
        1.5694200365736446, -1.1014684850762062, -0.43733751580797336,
        1.6945815634170758, -1.464712832273641, -0.11223575440780843,
        1.612240241604921, -1.6581526066503223, 0.22994560592343882,
        1.338553509073058, -1.6514878882063027, 0.5344489584793537,
        0.9134826222859194, -1.4396059695283727, 0.7521257319175111,
        0.3951576493691964, -1.0437412973091038, 0.8467050585085072,
        -0.14803571404262791, -0.5091810465449897, 0.8002321028994479,
        -0.6465730905154227, 0.10021818718688927, 0.6158401888623333,
        -1.0431920365511427, 0.6626144592876836, -0.32951295410960846,
        -0.4113563800621238, 1.7003346205460084, -1.6504481049691406,
      ],
      [
        -0.0034189034451520715, -0.1786256524966034, 0.6799016221476433,
        -0.44178421966959086, 0.10610043239570291, 0.11403252030693242,
        -0.17961899412287213, 0.09861172014491414, 0.1145670410148139,
        -0.212941866480842, 0.03921505111979553, 0.15129471288684934,
        -0.1668652957517126, 0.03192114544785586, 0.16842531997004864,
        -0.18412215252328623, -0.03655326623973821, 0.18395617235058231,
        -0.1305291004935291, -0.038213484689006094, 0.19943472963858755,
        -0.1313302764809872, -0.10833051701114348, 0.1916371401093962,
        -0.07567502651914713, -0.10216193675597189, 0.20369981691250788,
        -0.06152579595107042, -0.16650726002622385, 0.17300459775568075,
        -0.009939921151425345, -0.15121005637250687, 0.18092505263351005,
        0.01608878192335069, -0.20323197136630536, 0.13031575134559495,
        0.05751715858428586, -0.17874362618909673, 0.1344329012705916,
        0.09129427124695047, -0.21347182593902955, 0.06913316160459439,
        0.11727481514140789, -0.1811415666195044, 0.07069552357942267,
        0.15421552033539865, -0.19569862545351432, -0.0024112788825441126,
        0.1609469599499141, -0.15825776066571803, -0.0015550655201028996,
        0.1966341686111799, -0.15210667760454782, -0.0747052281444496,
        0.18234088416355015, -0.11342694236581097, -0.07251688480953754,
        0.21307764733988097, -0.08833228196171371, -0.13795119415650778,
        0.17831723797866414, -0.052994932708918856, -0.1326462694205272,
        0.20151301408962208, -0.014764605864585062, -0.22069334273220845,
        0.13227031893847957, 0.06147291246399696, -0.15315035464442475,
        0.19375837459635886,
      ],
      [
        0.07852080378887592, -0.07138977755908194, -0.017929914756366853,
        0.011969459160608455, 0.006619778027869704, 0.005765346561597584,
        -0.0004528284802947152, -0.006007103000323866, -0.00555621013330306,
        0.00047627012044984546, 0.006302231289404614, 0.0062692201059344225,
        0.0002468314526888841, -0.006210162009291458, -0.007086155348518043,
        -0.0015775697125452876, 0.005152476480638139, 0.006850857196414038,
        0.0020670827905248275, -0.004511691254041351, -0.00653816752550391,
        -0.0020449346847378714, 0.004680418338009276, 0.007163891622423293,
        0.0029021298693194184, -0.0042296014963713515, -0.007608171171176466,
        -0.004103097929454062, 0.0029756006843959753, 0.007009932308377676,
        0.0043206295226080535, -0.0023829680766638273, -0.006608682345041205,
        -0.004265274012767334, 0.0024409544120404846, 0.007092506264892262,
        0.0051548234365625485, -0.0016974419900300567, -0.007127130604985174,
        -0.006099032422490091, 0.0003775996062378526, 0.006213614310827278,
        0.005995942606745517, 8.626887875552713e-5, -0.005759635549145783,
        -0.005882049442781791, -0.00010773197314920728, 0.006071958076062881,
        0.006707391004934532, 0.0010492397378383431, -0.005705686349690939,
        -0.007296578578711133, -0.0022946567856151822, 0.0045627525822181806,
        0.006858894633163635, 0.0025557411473740655, -0.00410930381493397,
        -0.006676286282047644, -0.0026170117986124937, 0.004246750424989633,
        0.007357247936586922, 0.0036455204426303466, -0.00353186879410474,
        -0.007532877790556662, -0.004682448347819058, 0.002274894937547698,
        0.006785358175585091, 0.0046842115057086275, -0.0018860918232676562,
        -0.006542378657927119, -0.004745520693641364, 0.0018689444971332933,
        0.007023573992929105, 0.005747483258472647, -0.0008939792721233677,
        -0.006773107108615678, -0.00646351931831112, -0.0003446943275893207,
        0.00577857411142176, 0.00617620790086721, 0.0006027693642218514,
        -0.005502233787927632, -0.006205490703786339, -0.0007363427589106703,
        0.005757695315496017, 0.007078177205026596, 0.0018579647551508185,
        -0.005115412818417204, -0.007395616724086601, -0.0029440037273104156,
        0.003969235347672359, 0.006822584276839338, 0.0030132916637508403,
        -0.0037020129137738914, -0.006801668622407318, -0.0032151920572297847,
        0.0037356588509265083, 0.007464509525875189, 0.0043590512833727975,
        -0.0027779931378273713, -0.007349366721808124, -0.005171713927895725,
        0.0015982339730455566, 0.006529384943505668, 0.005011836021942505,
        -0.0013919328210911935, -0.006457556479389095, -0.005232878386757832,
        0.0012340413648753857, 0.006860124355518702, 0.006278268796890108,
        -7.004959309771155e-5, -0.006326032910407692, -0.0067247031535516335,
        -0.0010156272945910892, 0.0053310629693022835, 0.006320837708351129,
        0.001108106255818711, -0.005225437611962487, -0.00651910813498272,
        -0.0014077049363832117, 0.005351214296000428, 0.0073627176727324006,
        0.002649499473555989, -0.004457734116693141, -0.007389193295856265,
        -0.0035186143553023732, -0.004364056106534443, 0.02724735934247779,
        -0.020682922656098543, -0.0023689265171412035, 0.0036180436612960323,
      ],
    ];
    const result = wavedec(data, "db5");

    const reconstruction = waverec(result, "db5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db6", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5049534889593719, 0.9303419196480336, 1.2133272308935141,
      1.320540670717421, 1.2538441711783437, 1.0478433130963882,
      0.759919834203684, 0.4553835936810684, 0.19151427303121826,
      0.004480977705190681, -0.0976572980513801, -0.13425353012467212,
      -0.14404350679996084, -0.17203002681622592, -0.2548212914818927,
      -0.40835168714182696, -0.6212939043372553, -0.856002914323492,
      -1.0568873017243778, -1.16417545645992, -1.1296231391231306,
      -0.9301574780171888, -0.5759139025431212, -0.11048462817245776,
      0.39687975078202686, 0.8653722287318535, 1.219713802085399,
      1.406142433619022, 1.4034840436408604, 1.226687590445195,
      0.9220588572110497, 0.5554643049691456, 0.19648767485145352,
      -0.09751928931790182, -0.2935819827736498, -0.3885433704368897,
      -0.4066286265935521, -0.3899736618718932, -0.38474050435469787,
      -0.42654804259175727, -0.5290961842268188, -0.6790189401087579,
      -0.8383823561716792, -0.954258367551036, -0.9729599970244422,
      -0.8552865190767442, -0.5888154001755402, -0.1939736157141441,
      0.27784769085767547, 0.753887826198836, 1.1551361018323252,
      1.4133893826932196, 1.4861467589987332, 1.3657465639335342,
      1.0805522087228834, 0.6879399283023605, 0.26084676996287237,
      -0.12880026671058376, -0.4257228336051159, -0.6022288463128953,
      -0.6619008060755402, -0.6353348641213449, -0.569239421014935,
      -0.5118644469123569, -0.4986304152728004, -0.5417343340499157,
      -0.6264557505384178, -0.715137324538292, -0.7578175344421509,
      -0.7067551569073115, -0.5310487755754005, -0.22748488865969668,
      0.17533403769412442, 0.6208540761431278, 1.0356862404805185,
      1.3453913783555147, 1.4911434586829295, 1.443216836053037,
      1.207990758226823, 0.8267392615425243, 0.3664837527309275,
      -0.09487324595879237, -0.4855267549585416, -0.7547654182529442,
      -0.882420992228022, -0.8806216600084383, -0.7876397433242275,
      -0.6556010983653, -0.535339510127262, -0.46235470504803433,
      -0.44750002490486357, -0.4747729936057783, -0.5067290531992317,
      -0.496057178731083, -0.4002496844344625, -0.19547602321484808,
      0.1140578995444963, 0.4938587012074363, 0.8848015811453556,
      1.2154796987643386, 1.4183117540551946, 1.445478884387402,
      1.280749594071028, 0.9442274052908607, 0.48877842702005897,
      -0.011064901855123932, -0.47508204967330875, -0.8343923951165779,
      -1.0454629384495948, -1.0977984397142786, -1.0136044681378071,
      -0.8397166239185685, -0.6340034833645158, -0.4497964490350494,
      -0.32234070805565584, -0.26069065900124166, -0.2470386681877426,
      -0.24353386269785704, -0.20470907395261984, -0.09218130115842227,
      0.11230683619604115, 0.3990277683242686, 0.7298007504247395,
      1.0452367545489285, 1.2780360853958443, 1.3691029579314786,
      1.2824735888225014, 1.0152919235547588, 0.6002543468501939,
      0.0997865520530745, -0.4067482371002228, -0.8397902537975406,
      -1.1362806417877276, -1.2623401090857216, -1.218956912399761,
      -1.0394493168194825, -0.7795021266929614, -0.5023985695033957,
      -0.26322195720480995, -0.09599946819086708, -0.006957503020186995,
      0.024538928597295923, 0.037774857458859334, 0.07748250226287662,
      0.17920611036134598, 0.3571589364066943, 0.5978561866577539,
      0.8613236536491755, 1.0897303136917926, 1.2213692793397426,
      1.2065039057345595, 1.0210635757336581, 0.674655269406343,
      0.2107352653235549, -0.30128344492850856, -0.7802119819473988,
      -1.1502109986421356, -1.3567763211133772, -1.377773221229303,
      -1.226926271225792, -0.9490308713823057, -0.6081865331534708,
      -0.2720517167997475, 0.003938925327696352, 0.1885046022742296,
      0.27973065817302784, 0.30243562379149763, 0.29857446742118054,
      0.313330899825777, 0.38063785629655733, 0.5119925407572622,
      0.6915697659626149, 0.8790044991840705, 1.0192263484161228,
      1.0568902979291261, 0.951727075742908, 0.6908452828053114,
      0.29473341632732414, -0.18474368252842183, -0.6740695994758711,
      -1.0933044311181348, -1.37320760186322, -1.4701498886799975,
      -1.3752325540023365, -1.1154456812770133, -0.7466494396271122,
      -0.3401628749739263, 0.03370530965095769, 0.32113711811694196,
      0.49555049053189576, 0.5610973289449309, 0.5482560778045747,
      0.5028647895562068, 0.4715890330375737, 0.48769643629690884,
      0.560896361473487, 0.6739302654527384, 0.786839585430422,
      0.847840894659184, 0.8080104236523411, 0.6359617506207751,
      0.3286523180710035, -0.08460794792601989, -0.5461829778558341,
      -0.9813915446510975, -1.3144255520853028, -1.485095332193724,
      -1.4623452309561358, -1.2512476376196218, -0.8917703917307477,
      -0.44962511488934465, -0.0014393089235157364, 0.38213063481494436,
      0.6512576003956839, 0.7862332540318859, 0.7990752508474127,
      0.7272816579954168, 0.6215318620554886, 0.5306336394337596,
      0.4876706373053001, 0.5009509754130904, 0.5520887277802489,
      0.6016897070045469, 0.6011346333709, 0.507359500896192,
      0.29673037872031893, -0.025696359333741592, -0.4240937404469075,
      -0.8377226328459498, -1.1934734744618132, -1.4221226654561467,
      -1.4743568038494663, -1.3326242746208152, -1.0158666098163385,
      -0.5759153028710754, -0.08638069280812355, 0.3733022370585483,
      0.7348304361333987, 0.9549308479018903, 1.022927809212623,
      0.9603052126931771, 0.8125923518381587, 0.6358076710285925,
      0.4810234628291203, 0.38103487266022074, 0.3425261414024372,
      0.3456788886109681, 0.35123087440852846, 0.31306149319179555,
      0.19294316918041232, -0.026478771105137522, -0.33398377081989433,
      -0.6895255859019109, -1.0317118823495366, -1.2913107717976415,
    ]);
    const expected = [
      [
        3.0409916910507393, 3.4273827441159304, 3.416125716910609,
        3.3323467736031493, 3.0344132175876593, 3.2331537447046097,
        3.5573245363116244, 3.3496671789545527, 3.1267547331787116,
        0.04006833055715697, -0.5893888515519797, 0.5300405974774041,
        0.12217671785208634, -0.6556788373749499, 0.4669632481320444,
        0.24930387733847947, -0.6961844737268095, 0.36685265902221353,
        0.3737828966348955, -0.6989678631350724, 0.24657510891565065,
        0.5761498970882495, -1.2826166267875323, 2.1298512589402505,
        -4.474571602137797, -1.9373269427364206,
      ],
      [
        0.08592882294711132, 0.0103682029992558, 0.7129286988780672,
        0.6326684137299173, 0.6495392835498256, -0.20800046564643515,
        -3.0630580374638727, 3.785916946119135, -0.5934438492113111,
        -3.308531210338694, 3.612496966849702, 0.18225663646880624,
        -3.8955783504640946, 3.263124787949452, 1.0966754010810396,
        -4.25209079409848, 2.5972101915809147, 1.9730610828566222,
        -4.285077098448371, 1.2830277254136921, 0.2970224216299554,
        0.11172237870029302, -1.8645703196630299, 4.23041686516065,
        -1.3010442830152293, -3.1664577985440308,
      ],
      [
        -0.3475967468420014, 0.09360553168149557, -1.2527827866766363,
        -1.2967548281149694, -0.27698918302159986, 0.8561654882757694,
        0.04011520844360409, -1.2796087694215617, 1.5923088486424506,
        -0.636675379875329, -0.772685315367381, 1.4809337530190045,
        -0.976280619260917, -0.2531301806336534, 1.190341047138519,
        -1.1372058766758602, 0.22620974739040614, 0.7704196344367047,
        -1.1013161445337858, 0.595852006020275, 0.28733708151228793,
        -0.8794480659170413, 0.8028179624713506, -0.18379574909597451,
        -0.509791409889035, 0.8183759061125503, -0.5699383237979871,
        -0.05226849686210619, 0.6422346546792935, -0.8108292942050708,
        0.4202660545972423, 0.3025742967967093, -0.8678288335550953,
        0.8331076820405996, -0.13168950488485553, -0.5889244336295477,
        -0.0945628548908372, 0.875707900197432, -0.1253874985413308,
        -1.0290096965893598, 1.564471316827887,
      ],
      [
        0.4963024850839612, -0.331876237739606, 0.006279030325744999,
        -0.1708867823296302, -0.034426412188974284, 0.18301307360717275,
        -0.1679218774343662, 0.04707085249350929, 0.10413703669893869,
        -0.16138462906847584, 0.023510102268818524, 0.14690050092469198,
        -0.1320858247308332, -0.014889357701825211, 0.13810486028622315,
        -0.12948604112921297, -0.0374694611517186, 0.17071389246524246,
        -0.09191599906665938, -0.0756539246966751, 0.15022401884153772,
        -0.07971574554515139, -0.09236642781899143, 0.17121300743662315,
        -0.03728220825302821, -0.12601354897300113, 0.13870327500683247,
        -0.01925133909645974, -0.13303169837607165, 0.14833834392577516,
        0.02371815036861245, -0.15871853379263784, 0.10521933602294298,
        0.04317103921402531, -0.15340226118969807, 0.10543949349743201,
        0.0820509381742862, -0.1690970210852043, 0.05467163912068635,
        0.09853396602449735, -0.1503887622302589, 0.04878514829297656,
        0.12906743528412523, -0.1557377120885084, -0.005534337534936134,
        0.13885710661591036, -0.12432806424815217, -0.013353832589667332,
        0.1577701508689592, -0.1206956713886978, -0.06657040239567778,
        0.1583638580309474, -0.07893459185135529, -0.07191417037628048,
        0.1638371193019749, -0.06919111355039785, -0.11947714909331945,
        0.15432561220403568, -0.020757575926134884, -0.11836576863268077,
        0.1462548458015662, -0.008845236847736544, -0.15647470732243265,
        0.12746014625528868, 0.042102891108551525, -0.13762751632572678,
        0.17066193355868695, -0.03200808602116072, -0.15415226112319907,
        0.11149548023123013, 0.029180294639824387, -0.1421778664812587,
      ],
      [
        0.09280438316072354, -0.1407202709161128, 0.04578131581765825,
        0.007122196265580161, -0.0015405837295691487, -0.0007006142059969764,
        -0.0030547912053299217, -0.0024444825086419753, 0.0005076891062339175,
        0.0029573433926722774, 0.002541214413668778, -0.0003763342413006449,
        -0.003039702524136277, -0.002905645430307184, -5.383366678561076e-5,
        0.0028755325413830635, 0.0031616432733423032, 0.0005611825837941772,
        -0.002469167209600897, -0.0030940449229983178, -0.0007710107091990332,
        0.002250048092134291, 0.00306801382032769, 0.0008847318154299546,
        -0.0022338369349311086, -0.003310673604882435, -0.0012791621034668214,
        0.001995527476804213, 0.0034640095855125144, 0.001761901757809532,
        -0.0015072585483357583, -0.003285971963018228, -0.001943323661152491,
        0.001197540432073623, 0.0031246785470507295, 0.0019956170439285516,
        -0.0011156881967690812, -0.0032356420953286776, -0.00231017963841937,
        0.0008402596386533113, 0.0032811817884456102, 0.002725379133977965,
        -0.00031103579021910953, -0.0029938454669729384, -0.002839360156804597,
        -4.731495908689705e-5, 0.0027026258080449284, 0.002794410175813607,
        0.00015248974015507916, -0.002689858448814709, -0.0029944995911373473,
        -0.00042023693748177943, 0.002640133103051582, 0.0033100314739701433,
        0.0009431728628706771, -0.0022620739257468653, -0.0033295960854717163,
        -0.0013034146426714184, 0.001863427945356124, 0.003164972662780429,
        0.0013865755962327066, -0.0017514756958033474, -0.0032305019015732763,
        -0.0016006411512376247, 0.0016347345773096134, 0.0034295708747606674,
        0.0020704825705324505, -0.0011993864810796672, -0.0033438101226315737,
        -0.00238790191163346, 0.00072980672852676, 0.0030539229763669315,
        0.002407505397131543, -0.0005560703257612165, -0.002982206988432594,
        -0.0025274588539908227, 0.0004120232143905509, 0.0030656313720563034,
        0.0029045049424532557, 3.708183844910887e-5, -0.0028813466761923407,
        -0.003142909444911768, -0.0005323179443610353, 0.002478440237074232,
        0.0030674569152389216, 0.0007231794995619428, -0.002284547477413541,
        -0.003064406177592765, -0.0008493061342287597, 0.002270460733043799,
        0.0033216958965162323, 0.0012647856026067762, -0.002011203284228608,
        -0.00345864724166872, -0.001738099063849551, 0.0015237457023627716,
        0.003271463760072964, 0.0019008160624660602, -0.0012382666090990915,
        -0.0031323491212642595, -0.0019650389470055557, 0.0011592836567639944,
        0.003259436675171361, 0.002302481390014613, -0.0008619297303151722,
        -0.0032894586040617914, -0.0027108029233821767, 0.00033063054987601673,
        0.00299129750396967, 0.0028062205248311394, 4.810471865394363e-6,
        -0.002720882646693765, -0.002772385845295782, -0.00010654655674615949,
        0.002725203108946342, 0.002996749624381623, 0.00039718353712758867,
        -0.002660495553498966, -0.003307663502640481, -0.0009251455949891873,
        0.002269587248475916, 0.0033085609096093795, 0.001263978105416562,
        -0.0018898554926610738, -0.0031537926158295175, -0.0013431433659768014,
        0.0017954818077359808, 0.0032444462136544706, 0.024342575033017365,
        -0.038797132975812776, 0.008470920533498627, 0.003659583496947894,
        0.0023069118141099652,
      ],
    ];
    const result = wavedec(data, "db6");

    const reconstruction = waverec(result, "db6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db6_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5026925835118614, 0.9266932106431034, 1.2097696925731538,
      1.318709243012116, 1.2550397731178395, 1.052658483921204,
      0.7680992240436488, 0.4659631322607468, 0.2031915602886898,
      0.016090818018859032, -0.08672876718283964, -0.12387045074521233,
      -0.1334283369855694, -0.16017085068592962, -0.24106796719955265,
      -0.3930137022127568, -0.6060285806358968, -0.8438224839279086,
      -1.0517104980294996, -1.1699792355932357, -1.1493771553022756,
      -0.964810513125334, -0.6237192021281288, -0.16688940783819312,
      0.33868524175637216, 0.8133175441663683, 1.181354742293972,
      1.387152036400093, 1.4064943232886173, 1.2507777477383437,
      0.963033259126087, 0.6068660150784316, 0.2511016692518298,
      -0.0460530220844898, -0.24946286118125813, -0.353156535369131,
      -0.3787188988171968, -0.3666002392832288, -0.3627468935472466,
      -0.40412672363994473, -0.506981154419533, -0.6609192901521277,
      -0.8304608279634774, -0.963714282416974, -1.006030348447492,
      -0.9151639035034931, -0.6740436742654767, -0.2977987449085929,
      0.16690860724258327, 0.6502920469955016, 1.0737114018975575,
      1.366449653211841, 1.48099428801825, 1.4031616372206261,
      1.154649848644479, 0.787449765144356, 0.3715248681185987,
      -0.021201043706709277, -0.332640428901955, -0.5303176561212267,
      -0.6123644373515367, -0.6046999152624287, -0.5513289161694944,
      -0.5004109210771976, -0.4897913201467179, -0.5357865486123167,
      -0.6281530800059761, -0.7325660958515288, -0.7999927400693482,
      -0.7805576871090409, -0.6383172923816409, -0.3630827821839683,
      0.023864780888255943, 0.471818083984554, 0.910160450364441,
      1.2631910354416513, 1.4667410058562924, 1.4825788777676931,
      1.3071104143670287, 0.9722535396095042, 0.5382707833009218,
      0.08029821332233106, -0.3281656054167399, -0.6308326399932873,
      -0.7995538952356663, -0.8380837326580569, -0.777963539248768,
      -0.6677753887110707, -0.5586549042949918, -0.4898534941998535,
      -0.47808021150989277, -0.5133509868439652, -0.5623829501973956,
      -0.5786216317547369, -0.5162717648950335, -0.34465231172864547,
      -0.059079589728524784, 0.31466929754104145, 0.7236582338266315,
      1.0982494295433014, 1.3672893033266391, 1.4743733867353204,
      1.391222089319534, 1.124867552796768, 0.7168435793659602,
      0.23451596936624403, -0.24339393464097336, -0.6436304308383999,
      -0.9135542386794913, -1.0310471142102724, -1.006914790641583,
      -0.8794026181196967, -0.7023898658511261, -0.5303745735857335,
      -0.4041163047432049, -0.3405831985655751, -0.32971158631397113,
      -0.3387204597307926, -0.3227758875394621, -0.23916378018837042,
      -0.0612165127811819, 0.21171906238349247, 0.5509969239249071,
      0.9031089756875291, 1.2009210429099497, 1.379041782427007,
      1.3895732168151718, 1.214339512924718, 0.8705137582318446,
      0.40815865475718677, -0.09982974878158843, -0.5730267722655333,
      -0.9404010912190213, -1.154836093578231, -1.2018375511171708,
      -1.1004591641805173, -0.8964007282220439, -0.6491553237021277,
      -0.41652320757930517, -0.24041323398448017, -0.1374704115444384,
      -0.09680051316251193, -0.08523120943673486, -0.05861663336830278,
      0.023854044316039158, 0.18615381673792175, 0.4263307369949513,
      0.7143262679664625, 0.997430060922994, 1.2121474529632534,
      1.299598084101839, 1.220621938188322, 0.9667828546535335,
      0.5644298056795607, 0.07066381934716222, -0.43795598074820086,
      -0.8813448133093766, -1.192694683849298, -1.332161263104675,
      -1.2942158320476023, -1.1070014222942097, -0.8239944912574162,
      -0.5101505064010474, -0.22603679484155903, -0.013900841717050028,
      0.11092047762071827, 0.16123548498666404, 0.17174665356777902,
      0.18709030113632408, 0.24738956207477558, 0.37516619603875445,
      0.5671005338306749, 0.7928836963807633, 1.0015862895005696,
      1.1340321130397735, 1.1381027197730096, 0.9831045404135323,
      0.6695078873684731, 0.2314759074353578, -0.26863287503386063,
      -0.7526220262395886, -1.1428032692227634, -1.378458788089497,
      -1.4285014775363027, -1.2973365977016211, -1.0225888702377934,
      -0.6653452654378749, -0.29538141949916086, 0.024962758402054808,
      0.2543112138245541, 0.37993774323429735, 0.4178687049411217,
      0.40558960136955124, 0.38940941063548284, 0.40987293951422865,
      0.4890827829231889, 0.6232818213411999, 0.7826847581369287,
      0.9186774804771196, 0.9765982590777819, 0.9108563707026816,
      0.6985012472530254, 0.34769365282042314, -0.10123169956440778,
      -0.58259275843953, -1.018591468942847, -1.3358565895409857,
      -1.4813558643977622, -1.433860452354934, -1.2082143945265327,
      -0.8514115965139574, -0.431477493299267, -0.02189638398824484,
      0.3146145614691045, 0.5390691847167132, 0.6428550928158644,
      0.6466062287540766, 0.5918144458600175, 0.5275042724304684,
      0.4955122647834123, 0.5182280990187974, 0.5919920534341598,
      0.6878719598477716, 0.7596345787562983, 0.756863938352156,
      0.6398333196792108, 0.39224942356658266, 0.028482513294344647,
      -0.40674650861019357, -0.8463704830200993, -1.214886747587328,
      -1.4448878251347108, -1.4922341195180358, -1.3461847613073166,
      -1.0320118692817049, -0.6054483991004153, -0.14030714534061584,
      0.2877356421620453, 0.6172853382388069, 0.81345102835429,
      0.8732997926230636, 0.8234031672414097, 0.7103106082038554,
      0.5865352369993306, 0.49572604581077656, 0.46085765296122444,
      0.4784575426723364, 0.5203185738180031, 0.5422094815177778,
      0.4972871613131263, 0.3506888705455486, 0.09145053906394285,
      -0.2614551586248112, -0.6607011569078481,
    ]);
    const expected = [
      [
        3.0491865182973017, 3.433480749297444, 3.4205190313110525,
        3.3397202491205924, 3.0349254089480118, 3.2405381188085567,
        3.5652625709833425, 3.335704504465361, 3.180081505427616,
        0.0013775507703194245, -0.6038214224940414, 0.6089123837362442,
        0.04116542962082048, -0.6634166531782817, 0.5808466615289263,
        0.12922688072002236, -0.7023661935828329, 0.5201545408140015,
        0.2134069602273267, -0.7106667482928376, 0.46991254982546415,
        0.26294846529948385, -0.9735670136736043, 1.6021099012613662,
        -2.114520997714892, 0.24668545656733806,
      ],
      [
        0.0885412981275594, 0.011023911729844828, 0.7295816349805817,
        0.6505501179640254, 0.6391842151246359, -0.3143261277157284,
        -2.9508553184764046, 3.941273212752586, -0.9880365210916436,
        -3.105900980394626, 3.944613077427947, -0.44702116388327956,
        -3.6329844478267552, 3.757255819290409, 0.23533691287731942,
        -3.912958078818376, 3.2779409486907727, 0.8201633307201689,
        -3.8861772916286905, 2.056494324564389, -0.24243725844165953,
        0.3049562062835246, -1.9059112627234158, 3.2264888267319822,
        0.06044241997781777, -3.7051164599012885,
      ],
      [
        -0.35453687896599456, 0.10009878740833775, -1.2486361170936666,
        -1.2878967379889958, -0.27040106853393286, 0.8560124108277293,
        0.0033173830882066964, -1.214676706642475, 1.5538778850227315,
        -0.6813352296727728, -0.6504270182359155, 1.3702097244639984,
        -0.9891935134344457, -0.08832960783780495, 0.9846392344631386,
        -1.071966517902086, 0.3956454933076202, 0.47048706030785953,
        -0.9181311583281795, 0.7163368742284894, -0.078750396867562,
        -0.5578293820549491, 0.8174240286979721, -0.5634779689294422,
        -0.057564796812148385, 0.6813282694557707, -0.8955147013090765,
        0.4914930795003867, 0.3323027359075803, -1.0136001383010798,
        0.9895408589763397, -0.16783176851318643, -0.8941795704269182,
        1.3492594605329813, -0.6135141873454362, -0.02221259629376945,
        -0.09850282751010306, 0.4062374890795529, -0.01243117972425109,
        -0.9473356940584754, 1.1006618421596286,
      ],
      [
        0.4929775544180988, -0.3297656206255614, 0.006436015565261968,
        -0.17016490257997977, -0.03460581722253561, 0.1820757130659079,
        -0.1655459445119057, 0.043490796423872526, 0.10610828462979817,
        -0.1574723898731794, 0.016301032674154278, 0.1485067822554782,
        -0.12560890037663894, -0.0233137414960205, 0.14031942220979496,
        -0.12040309978617961, -0.049791509209847776, 0.17010349742709469,
        -0.07822654384568963, -0.08699281767328378, 0.14791409408387354,
        -0.06356106490722509, -0.10656059517453387, 0.16375422645735382,
        -0.015726223648089142, -0.13598565221653613, 0.12753973754127748,
        0.0031172447015152113, -0.14395334109242508, 0.13059116976752225,
        0.05084747922215252, -0.16175201010475587, 0.08276352500138937,
        0.0679681095942046, -0.15532410585608786, 0.07645745513263774,
        0.10973199409515137, -0.159833823100101, 0.021445285725206088,
        0.11965092750752308, -0.13860288213269056, 0.010879912209760569,
        0.15051467516199696, -0.13063880241417328, -0.045644214347116456,
        0.1491417740862517, -0.09665930131577354, -0.05460573377867857,
        0.16596340543051696, -0.07936866182049108, -0.10671673191337153,
        0.15131969520059277, -0.036798261418274116, -0.10848282267141741,
        0.15329807464615486, -0.01510456954830806, -0.15103887966800172,
        0.12586686499855895, 0.030524154960238657, -0.14127836418372366,
        0.11467940859592037, 0.05078939576197243, -0.17081902300054935,
        0.07736989776308834, 0.09739414807019345, -0.09431523296849864,
        0.5155653469813551, -0.38898173869550373, -0.2167967934447366,
        0.14026514335184498, -0.010438682945331032, -0.11589364752849778,
      ],
      [
        0.0922848469795862, -0.1399677174141058, 0.045580487973026496,
        0.007025133491169181, -0.0015503616738713945, -0.0006577853741548882,
        -0.0029899007150706656, -0.002436808248702799, 0.000438373289151261,
        0.0028817857466454486, 0.002550668869299601, -0.00027255430035259245,
        -0.0029378739978230825, -0.002917029575241365, -0.00018566174842681103,
        0.002741882705200541, 0.003161029046695316, 0.0007057991132468391,
        -0.002314851568719571, -0.0030871778169857577, -0.000929931343904496,
        0.00207755555268854, 0.0030634056735811344, 0.0010742231927630876,
        -0.0020217080355523463, -0.0032897420416441005, -0.0014933638521226569,
        0.001731705963885053, 0.003400363852259239, 0.0019708090899729306,
        -0.0012137815823778215, -0.003187352826841191, -0.0021409060521144635,
        0.0008899879804169402, 0.003012446030986565, 0.0022067691448084134,
        -0.0007688622394821944, -0.003091124171802429, -0.0025319033818235553,
        0.0004355653607278384, 0.0030672148564801793, 0.0029146156323291155,
        0.00011904729097779552, -0.0027206838721824506, -0.002982629529333244,
        -0.0004728527207106968, 0.002406491070577496, 0.002926246879995773,
        0.0006011266536316479, -0.002355126461323355, -0.0031177479897168763,
        -0.0009179875671014269, 0.002220387808213352, 0.003371019862498402,
        0.001448603820545976, -0.0017701806724941113, -0.003308083530305086,
        -0.0017720624367206109, 0.0013518455208889144, 0.00310647249090312,
        0.0018481546200675605, -0.0012101606026217301, -0.0031469589179524554,
        -0.002090336159021651, 0.001008954637325205, 0.0032594706776861424,
        0.002540406415588515, -0.0005039177751966058, -0.0030609969031119323,
        -0.0027798949128303545, 3.372994043755414e-5, 0.002716097201985525,
        0.0027537589314297053, 0.00014347353543603652, -0.0026134645343000905,
        -0.002874747774059867, -0.00035395328885164454, 0.0025992258799231306,
        0.003201745455209031, 0.0008545139250477997, -0.002285736540022671,
        -0.0033197979961175714, -0.0013162802996388142, 0.0018241179158517153,
        0.0031595222182048887, 0.0014687986682170473, -0.001610129068257379,
        -0.0031327177658979663, -0.0016286133342033177, 0.0015059672168450534,
        0.0033155622521715165, 0.0020653153034404037, -0.0011195064458158258,
        -0.0032974501332161685, -0.00246096514058052, 0.0005877472035019943,
        0.0029949206833728074, 0.002533818639949931, -0.0003124286649389867,
        -0.002818319114147508, -0.002590854382577631, 0.00017146439945227716,
        0.002861028816953272, 0.002914636493588256, 0.00023177369143810708,
        -0.0027173409901854835, -0.003199162336880804, -0.0007752248369786962,
        0.0022897208257795162, 0.003152301292563015, 0.0010523955389479516,
        -0.001986277109797572, -0.003071465655703223, -0.0011701368920389698,
        0.0019172105524482685, 0.0032521725706594604, 0.001529669941726652,
        -0.0016819813667845896, -0.0034011311440213833, -0.0020247181405318787,
        0.0011687453636879176, 0.00321651614057382, 0.0022452845112759324,
        -0.0007823495854046449, -0.002985943594224356, -0.002283476535995928,
        0.0006491679854781115, -0.039248531560940395, 0.07156511759777663,
        -0.06067099033763653, 0.03761616627280128, -0.003828601721974972,
        -0.0004104661838555555,
      ],
    ];
    const result = wavedec(data, "db6");

    const reconstruction = waverec(result, "db6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db7", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49835197386325447, 0.9182719309653564, 1.1980222393026505,
      1.3052384223230056, 1.2425789099624074, 1.045084128687694,
      0.7700431656683837, 0.48201556668417805, 0.23682977403582178,
      0.06858469217988905, -0.017131411740375024, -0.04221103035640516,
      -0.047608618309984085, -0.07985317590898633, -0.17611114031567487,
      -0.3517878849282693, -0.5940026277358716, -0.8627612542306111,
      -1.0996681851797683, -1.2420661283545193, -1.23906824804816,
      -1.0654146928406671, -0.7295828440253197, -0.2739857392047661,
      0.23294638394233896, 0.7109838751753054, 1.0852222017521072,
      1.3019904087359375, 1.3397196959038065, 1.212201443979836,
      0.9635557185553827, 0.6562851540074566, 0.35548840410109595,
      0.1132254301514376, -0.04306495696816354, -0.11526990702239964,
      -0.13138721482154905, -0.13538429578169175, -0.17289921716661916,
      -0.27661129186718036, -0.45518624731123586, -0.6887770449245427,
      -0.9323710967961552, -1.1262476607271688, -1.210961183337644,
      -1.1430681013752175, -0.907572781406625, -0.5238476123124806,
      -0.04338894240300609, 0.46019898748698973, 0.9066571146151889,
      1.2262613839086234, 1.374606179656289, 1.3414299125159426,
      1.151409073981068, 0.8568389567643844, 0.5241239513320111,
      0.21751383942218577, -0.015834625990745865, -0.15577842361247132,
      -0.2117141215753808, -0.21723970603883264, -0.21849861997919506,
      -0.2593635411527019, -0.3674160727815478, -0.5444625208330252,
      -0.7641509032928346, -0.9774193748975474, -1.1244781390059717,
      -1.150321863600488, -1.019822445141608, -0.7285058746952813,
      -0.30616176964842123, 0.18779138386695682, 0.6762044578990599,
      1.0805562600673069, 1.3378425498974769, 1.4139192663686264,
      1.310095718108317, 1.0614448087950206, 0.7273475937486769,
      0.37670287672722247, 0.07152845141500142, -0.14696533556249525,
      -0.2664228629761574, -0.30363259171716794, -0.29717275338425675,
      -0.29447934570595374, -0.3368178655202357, -0.44616100265597236,
      -0.6174695178365677, -0.8184720070117473, -0.9970980819582139,
      -1.094732698054158, -1.0619329354386264, -0.8725722250878714,
      -0.5327254390221741, -0.08189654753051243, 0.4139044585122844,
      0.8756868062900303, 1.2283942700902541, 1.4171338182414543,
      1.4187941327541091, 1.2462644693071492, 0.9442940857107169,
      0.5780979408855005, 0.21759625330081817, -0.07877349055357219,
      -0.27667573199347023, -0.37187766645772086, -0.38829099109790577,
      -0.36875020093268446, -0.3610701724434664, -0.40311571199566054,
      -0.5108477458748504, -0.67252738049777, -0.850660385769397,
      -0.9912579118525364, -1.0380853494913604, -0.9482553726911263,
      -0.7051298383287036, -0.32513076542444336, 0.14343472322507694,
      0.6294351229152801, 1.053777448272766, 1.3465190415700354,
      1.4620905303371239, 1.3889418948652765, 1.151295609788613,
      0.8026405670038754, 0.41263779778720977, 0.05072190070620136,
      -0.22953395163559087, -0.40146141718091, -0.4691207126725274,
      -0.46313044846672274, -0.42976633493058847, -0.4162952984072516,
      -0.45645099770621245, -0.55989503985644, -0.7084626775248819,
      -0.8602294019396476, -0.9604045402943098, -0.9562768080710475,
      -0.8123589551225655, -0.5217803488426503, -0.11088559447252072,
      0.3643132978555021, 0.8291396043781035, 1.2061351176954604,
      1.43200434362878, 1.4715080568224037, 1.3249312329655407,
      1.0273316211570098, 0.6398039634756205, 0.2349611880809122,
      -0.11975613543167041, -0.37683039554401054, -0.5178984432813509,
      -0.5553128222720689, -0.5258415827287709, -0.47831046295129664,
      -0.45851591890102755, -0.49540672054328005, -0.5921776978472266,
      -0.7246334999671704, -0.8472910559921251, -0.9056780551698321,
      -0.8516636138375555, -0.6578400593554724, -0.3271715112938081,
      0.10471123848880656, 0.5753513759441216, 1.0081743023301868,
      1.3290526755955487, 1.4827228578463634, 1.44505386797283,
      1.228177957958049, 0.8772491715304339, 0.4596613421984519,
      0.04941097416264917, -0.28953218448923046, -0.516777828568503,
      -0.622736101104887, -0.6278780973798948, -0.574432172964371,
      -0.5128233940016622, -0.4864770924543179, -0.5189924365107075,
      -0.607052716451244, -0.7209400171948035, -0.8125455063195897,
      -0.8288162263158574, -0.7271520475843505, -0.48872683002482775,
      -0.12619543245740544, 0.31635787727970055, 0.7714247368569702,
      1.1622144072652065, 1.419548164538406, 1.4973994895530058,
      1.3832780185625961, 1.100913412185489, 0.7045915882187597,
      0.26655380462539807, -0.13942825254935065, -0.4542682394504873,
      -0.6456309692002766, -0.7129861236199773, -0.6845779200351322,
      -0.6072865440204823, -0.5321442084129381, -0.499343666922001,
      -0.526669541320022, -0.6043718751173831, -0.6978203472557798,
      -0.7572552347196446, -0.732102718408028, -0.5861186588039219,
      -0.30937422445948104, 0.07613510544999669, 0.5188809235564874,
      0.9477983600177945, 1.287559421747714, 1.475437852756511,
      1.475643606029481, 1.2876017360064003, 0.9461324168545363,
      0.5134842577906893, 0.06518080449172009, -0.3268443427672303,
      -0.6097051474124768, -0.7598838626252583, -0.7860058870001285,
      -0.723576538321546, -0.6232149644823752, -0.5355459707955623,
      -0.4967242622943873, -0.5183637087683642, -0.5844805863909623,
      -0.6562319900517195, -0.6832046892868171, -0.6183017319766251,
      -0.4323195543954846, -0.12435166442063134, 0.27481251773638926,
      0.7073630353767324, 1.1002419235097936, 1.3812229851819338,
      1.4953894630555689, 1.4179593825988692, 1.1602843478780782,
      0.767521994385169, 0.30853499524970135, -0.13951529750150032,
    ]);
    const expected = [
      [
        2.722293276298724, 2.7994455411457118, 3.005907531778667,
        2.8155478422600457, 2.8573559965580975, 2.933213363967599,
        2.8189688814391123, 2.939812569519621, 2.609075929948169,
        3.8842954482402647, 0.8087416837387067, 0.700585608344658,
        -0.44047760085865384, -0.1916727262321448, 0.6469985939373128,
        -0.5411039523508995, -0.032352110697691366, 0.5841121499869656,
        -0.6339473587322175, 0.12212639036401765, 0.5141353935092668,
        -0.7092675038732605, 0.31500698014126405, 0.24358694621942253,
        -0.48940263241905657, 0.31422123088687554, 1.75794413237485,
        2.2968138346546256,
      ],
      [
        0.0975790641117843, -0.5216442619518311, -0.11706399412472054,
        0.35852178389463, 0.22250388932442133, 0.222780384742335,
        2.8053443699675964, -3.5450998517645, 0.9494319503570504,
        2.386431955977592, -3.5421499032177097, 1.7144331891485929,
        1.4808117598325916, -3.454748050416195, 2.570273489232375,
        0.5801316104561071, -3.41979312554802, 3.3511063121649713,
        -0.16876844238629354, -3.3806173157457398, 4.120589307382862,
        1.8940033627980044, -1.552743962891494, -3.564926757387333,
        0.7507096905261494, 2.97772757152549, -3.980888260451269,
        1.4960041479451687,
      ],
      [
        0.2115606967909957, -1.717949238003858, -0.5729006416115546,
        1.6826641172926393, 0.31855861123068685, -1.1363616223085315,
        0.013417863283947526, 1.1036103273574853, -1.3492606442434834,
        0.5242921988239125, 0.7860489855252896, -1.5230287715150996,
        0.9987144277660807, 0.42796561168926445, -1.5665771793699248,
        1.4001191111918192, -0.011067999448953142, -1.4312558293356041,
        1.6680857921063827, -0.4695536302008712, -1.1387024252848998,
        1.767096648142085, -0.8831506126995208, -0.7308251804577296,
        1.6832580413882843, -1.1932314746362653, -0.26429213857076006,
        1.4261249967887202, -1.3545858507418778, 0.1969054343055731,
        1.027465552717836, -1.3413720732781793, 0.5898412272497634,
        0.537330341622217, -1.143252985056946, 0.9069738808673223,
        0.4174550076453456, -0.11726560337006207, -1.2276348648466728,
        0.7457491030115436, 0.40331060833269294, -1.280423220833474,
        1.1352580562847696,
      ],
      [
        0.0505203705228062, -0.18828401764315336, -0.0813499254977605,
        0.4767331975703485, -0.38819333934766576, 0.33137187629670123,
        -0.19790521969461594, 0.027182788017280784, 0.10349494735759651,
        -0.12247064578492863, 0.005184032738838169, 0.12458152410318739,
        -0.10745156716051638, -0.026066405101581792, 0.12431465060940833,
        -0.09411225739627366, -0.04320380759812113, 0.13879341274750084,
        -0.07156478203850394, -0.07148162963240813, 0.12968069467046164,
        -0.05364232507802098, -0.08556108245539576, 0.13545018415453597,
        -0.026112120805459643, -0.10791830416080384, 0.11751358943729949,
        -0.006402507835979758, -0.11639748177147483, 0.11499561220149525,
        0.023018673906827918, -0.13056833010790492, 0.08939917748318572,
        0.04138307573015484, -0.13173139394070066, 0.08010411025193459,
        0.06945673533326625, -0.1364223125397848, 0.049012772906051855,
        0.08342168568191251, -0.1296097759073765, 0.035331226208874265,
        0.10718015659692544, -0.12466328656484656, 0.0016388596595696468,
        0.11417474137449814, -0.11036290519561974, -0.013481637880963782,
        0.13130249986820683, -0.09677396034416515, -0.04651954686385322,
        0.12958201950665565, -0.07656072730091774, -0.05997049089323937,
        0.13871095380786874, -0.05634345574457428, -0.08915162191632507,
        0.12759262765205143, -0.032676507523404806, -0.09808025984779706,
        0.12847274872424166, -0.008598797083333663, -0.12066359108618457,
        0.10843336218626434, 0.015160708181334798, -0.13370306841520654,
        -0.00281682466818779, 0.011942934732371747, -0.020155890446152954,
        0.09587411811968478, 0.09279870976614868, -0.14553929563492166,
        0.030220515530672443,
      ],
      [
        0.08730654914900528, -0.1558473211644207, 0.09197389132855735,
        -0.023698850579574743, -0.001568007679013898, -0.00015682067709049463,
        -0.0010154755003779993, 0.0004774966943274769, 0.0014992536468175926,
        0.0010774181804429008, -0.000386062936409666, -0.0014964968797622844,
        -0.0011905155609311044, 0.00025307508547382475, 0.0014746748493908795,
        0.0013204711447571485, -6.485447231268352e-5, -0.0013748936216778254,
        -0.001378198348473034, -8.297283009077184e-5, 0.0012736515415894614,
        0.0014008242345117815, 0.00017894292804267276, -0.0012272123108055118,
        -0.0014743646079221492, -0.00031683018294756176, 0.0011576138732575052,
        0.0015564561544654464, 0.0005011847441921627, -0.0010137768094170595,
        -0.0015622306100554037, -0.0006356448843933387, 0.0008777219278886964,
        0.0015374528263627555, 0.00071798208719984, -0.0007983314286893972,
        -0.0015643109813327986, -0.0008424111562378427, 0.0006931257404500036,
        0.0015928211905945435, 0.0010044524361214145, -0.0005192188164543861,
        -0.0015431618757373315, -0.0011080407775723577, 0.00036328847548379553,
        0.0014693393216207002, 0.0011603378777115436, -0.00026626900030185286,
        -0.0014489669159719715, -0.0012552538801829704, 0.00014180824567710376,
        0.0014249064606185347, 0.0013794438529497117, 4.4515421499633336e-5,
        -0.0013231131835858131, -0.001438146406275044, -0.00020230379690705817,
        0.0012053102636149235, 0.0014479547154181175, 0.0002990870798924312,
        -0.0011437800028045032, -0.0015017016218555896, -0.0004244287502935725,
        0.0010747115059950494, 0.0015773896627608694, 0.0006041087374782383,
        -0.0009304632833761913, -0.001582518857984521, -0.0007449902595619918,
        0.000779830613809063, 0.0015430270948453677, 0.00082351204910792,
        -0.000689011026297304, -0.0015498639981695185, -0.0009317592236914328,
        0.0005880197822246065, 0.0015726269436319783, 0.0010867695450196791,
        -0.0004161436066737408, -0.0015219663504355328, -0.0011936668443841144,
        0.0002485002326090033, 0.001432942044865079, 0.0012381471472474412,
        -0.00014446917596541134, -0.001393781478905157, -0.0013140869836876868,
        2.8415499660417267e-5, 0.0013659509109237302, 0.0014297411115342968,
        0.00015301391718859246, -0.0012640592276690669, -0.0014894836359354397,
        -0.0003192118836250071, 0.0011319291423620046, 0.0014885011007476584,
        0.0004183073336503318, -0.0010542010748854115, -0.0015216812389143258,
        -0.0005310253953116781, 0.000984509395158727, 0.001588499652085353,
        0.0007030069257391227, -0.000842143848278078, -0.001593537380143119,
        -0.00084904612113066, 0.0006792024443014107, 0.0015415738789035282,
        0.0009254033667861132, -0.0005758618734037822, -0.0015276732575955246,
        -0.0010172842787909227, 0.0004782538747442008, 0.0015425699456445199,
        0.0011623297581809587, -0.0003109882010887194, -0.001491957636439191,
        -0.0012716571406228268, 0.00013383713655587532, 0.001390171765110704,
        0.0013101895303542495, -2.16451765974252e-5, -0.0013315651591495298,
        -0.0013669410834962407, -8.658914581874204e-5, 0.0012981985156142305,
        0.0014713143931991534, 0.00026037175206572634, 0.06241979025135382,
        -0.11323234800458967, 0.06658309437466352, -0.01685073783789116,
        0.00013200002148072362, 0.00016611781079023017,
      ],
    ];
    const result = wavedec(data, "db7");

    const reconstruction = waverec(result, "db7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db7_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49689060102288196, 0.9127796903486696, 1.1848655301645556,
      1.2821488323573924, 1.211039891003012, 1.0116540351180565,
      0.7458981716191633, 0.48057159639837976, 0.26997020495343005,
      0.1425642136027379, 0.09519731053866759, 0.09622851417017281,
      0.09664367378570105, 0.04603469944924632, -0.09095606932193318,
      -0.32225764524046835, -0.6235120418778758, -0.9421899433695112,
      -1.2097409346352315, -1.3586836030196283, -1.3401941898509355,
      -1.1375720442506163, -0.7719965322269058, -0.29897338276762075,
      0.20372080293306127, 0.6535814434949732, 0.981970100328862,
      1.1490589466675716, 1.1513859716007855, 1.0202153409757302,
      0.8112954129123577, 0.5888387903250016, 0.40802866974038504,
      0.30069641030846184, 0.2679299461808423, 0.2814977641556801,
      0.2936056828280824, 0.2522701367393183, 0.11808291126881348,
      -0.1222424024281164, -0.4493100781233221, -0.8133888656320604,
      -1.1452211843537632, -1.372591494550475, -1.4383945187651226,
      -1.3155035210462007, -1.014532735644032, -0.5824102157519754,
      -0.09205093780609386, 0.37427737419989326, 0.7436755222827749,
      0.9686748980637202, 1.0366066080058278, 0.9700067347834135,
      0.8181354606609104, 0.6420043462038603, 0.49698179132735787,
      0.4176423136092235, 0.40888651932008707, 0.44565679074864395,
      0.48126025069772793, 0.46199804179771087, 0.3441004266005663,
      0.10833080819224078, -0.23178203042975665, -0.63045130509275,
      -1.018937878728357, -1.3213760937905454, -1.4730942039392874,
      -1.4367078018597779, -1.211805908367406, -0.8356882064379377,
      -0.3749196275028451, 0.09015969776156355, 0.48401708836273194,
      0.7528695455489929, 0.875708237627385, 0.8666987275366012,
      0.7685218241487088, 0.6385935508802103, 0.531954064210428,
      0.48545824368248214, 0.5075152398659479, 0.5761147234250581,
      0.6456446091538203, 0.66064003591614, 0.5727324899275537,
      0.3561868660859355, 0.017757482146906978, -0.40192701531680686,
      -0.8360137860216836, -1.2062876858055422, -1.4415026544138272,
      -1.4944963653134506, -1.3536834849049775, -1.0459583038512257,
      -0.6302514614265027, -0.18339782459642728, 0.2180490788790781,
      0.51539454952908, 0.6803043935082508, 0.7191235918751011,
      0.6680721558713251, 0.5807808867784336, 0.51163453762776,
      0.499469591173842, 0.5560456387292314, 0.6624091391684614,
      0.7741413706748658, 0.8340920026909833, 0.7891787853304391,
      0.6067178571263843, 0.2858349313746289, -0.1392250720420685,
      -0.6049555937634106, -1.0322691289135202, -1.3445888230044774,
      -1.4857574520662613, -1.4331882538615701, -1.2028964963915594,
      -0.845144051080995, -0.43185295959672865, -0.03906262616121503,
      0.27103618227187565, 0.463887477553074, 0.5387078853440174,
      0.5255457888892285, 0.47423454769307494, 0.43834697969346414,
      0.458561752774766, 0.5499822797979002, 0.6968724882673514,
      0.8562771659324246, 0.969606167753497, 0.9791138320064275,
      0.8448664962072171, 0.5576177092945368, 0.14405107136758988,
      -0.3371670986729549, -0.8076792929725066, -1.1870334593462204,
      -1.4111406761736434, -1.4469034832682028, -1.2993030244754866,
      -1.0091806248606463, -0.6423552471532397, -0.2729515216701761,
      0.03471151679335077, 0.24098878889532016, 0.33874826119392687,
      0.3522795103856528, 0.3277461775229698, 0.3178956608268297,
      0.36525104716343937, 0.4883964947389656, 0.6751271652340072,
      0.88439126916229, 1.056592711767518, 1.1295723898514192,
      1.0560402707356702, 0.8177993873967628, 0.4329034226905028,
      -0.04628646027046873, -0.5438106068572165, -0.9769585679963173,
      -1.2750161040372914, -1.3951641283734373, -1.3315128826938296,
      -1.1150326670263508, -0.8045013546266466, -0.47090973837783856,
      -0.17943995417034098, 0.02627814922525834, 0.13357497910406213,
      0.16146627637513805, 0.1526686635534104, 0.15919629256423468,
      0.22553125913695377, 0.37399817227606397, 0.5963787605593359,
      0.8541331518412396, 1.0872918274649666, 1.2297550614057675,
      1.2270006970302347, 1.051516734426787, 0.7118258362939985,
      0.2526125155700876, -0.25422976785251994, -0.7254503680416277,
      -1.0852103076873247, -1.2820226820036322, -1.2995929541803224,
      -1.1588746872953852, -0.910939884055114, -0.62264347328746,
      -0.3589139792219666, -0.16634189023166868, -0.06234565507046502,
      -0.032678866664161726, -0.03780348059570173, -0.026285231256658603,
      0.04850515487143059, 0.21298305317796723, 0.46348933039209855,
      0.7647583151806355, 1.057274995294878, 1.2717048669738433,
      1.346673556264899, 1.2452428545256855, 0.9657233108125616,
      0.543906821950554, 0.04601859200689941, -0.4459045835091892,
      -0.8525354323595162, -1.1149919077996986, -1.207314084677564,
      -1.1405862460227059, -0.9577891575537301, -0.7208788259951167,
      -0.4935963262743833, -0.32459198108453713, -0.23531499625937768,
      -0.21581452496439765, -0.22946700927314506, -0.22525191352207954,
      -0.1541765622946436, 0.014664680728753543, 0.28282593170501136,
      0.6192040317003978, 0.9657446288411402, 1.2508133894543056,
      1.4068307459094982, 1.3876022243117085, 1.1808085382145141,
      0.812344840660882, 0.34129716334969695, -0.15323367458815776,
      -0.590139875646698, -0.9045802385886037, -1.0619000765869253,
      -1.063729302190723, -0.9448429032184509, -0.761781412883493,
      -0.576368815301296, -0.4385698422307479, -0.37325664059345204,
      -0.37437549063532644, -0.40800507519227874, -0.4234085400039387,
      -0.3690346276879301, -0.20908670017184877, 0.06389337366701636,
      0.4239400281733519, 0.8156134992064193,
    ]);
    const expected = [
      [
        2.7286343149080863, 2.788946803719843, 2.977962005722484,
        2.8011904292602288, 2.847663816018192, 2.9247893818986213,
        2.8120733378928766, 2.9010594588893097, 2.644945376749246,
        3.778060413053525, 0.8774280678629589, 0.8188076951683201,
        -0.767470865921464, 0.16984356379736487, 0.5348154602969398,
        -0.8463580494723362, 0.5548115900652973, 0.12592170180163398,
        -0.7155270239915948, 0.7992545877826683, -0.3129738986449433,
        -0.4114500725201561, 0.8972554482858797, -0.9179433159324405,
        0.736062347455166, -1.0801270594237564, 2.7330526952953855,
        0.7280040407807236,
      ],
      [
        0.08572862957244871, -0.4575787875853546, -0.10324774972422242,
        0.3142307992634447, 0.2309532324080245, 0.3902778398439071,
        2.4764995072049354, -3.7771605924166254, 2.04592466314569,
        1.2004413183787828, -3.4679125352035585, 3.1975120685899947,
        -0.7121712426778061, -2.1933235733465093, 3.53480862867634,
        -2.428645336173401, -0.3706256993423809, 2.9617573902170795,
        -3.5208783873816185, 1.6180452046211566, 1.7529718889490067,
        -2.4193469431306918, 1.3840546934928424, 0.641406671626066,
        -3.431953510753733, 3.064955521656919, -0.4115160763997169,
        -2.4693302262274015,
      ],
      [
        0.20538541345858202, -1.661466346623241, -0.559827811542595,
        1.5998673106415409, 0.33413460257324584, -1.0646413965817538,
        -0.19492542243549976, 1.229231491004732, -1.1043966705312098,
        -0.04448335926581435, 1.1891136435132301, -1.2404849787542296,
        0.07893891267487567, 1.2289412485694204, -1.396358766631387,
        0.19219108729158485, 1.2573134860417787, -1.5212179415439115,
        0.2878278855292066, 1.2694189865905674, -1.6115658570176985,
        0.3673641249344076, 1.2608332719652842, -1.6653228478825703,
        0.4332778251247833, 1.2277254674049511, -1.6819125646333593,
        0.4887732726073437, 1.1671426770860207, -1.6622653319583742,
        0.5375010950569211, 1.077248160145799, -1.6087383381767357,
        0.5828824266468291, 0.9563463084663313, -1.4385505090818795,
        0.19967318535249354, 0.06367568091568157, 0.5162874640638323,
        0.4237030460032736, -1.5448747603855197, 1.431942583178703,
        0.0011076431547302943,
      ],
      [
        0.01869573783407228, -0.13934832963543603, -0.11441816891740506,
        0.4924958996444953, -0.3921948985740187, 0.3362538652304583,
        -0.21326449972139994, 0.046528633291279084, 0.10032300449074522,
        -0.14590457016605524, 0.03956010469784543, 0.11283674716003285,
        -0.14043935497421048, 0.026930021459315445, 0.10996821522033579,
        -0.14188405133310725, 0.02279182484964269, 0.12327498222720311,
        -0.13381949326277573, 0.011820192226401864, 0.11988373696271659,
        -0.1360817601632921, 0.005671909906319115, 0.13206112942696763,
        -0.12575702931133517, -0.0033688400038888173, 0.12858477219140485,
        -0.12852782145230018, -0.01155020715495933, 0.13910498759740803,
        -0.11638068439598234, -0.018507754864117452, 0.13594986146575908,
        -0.11928211715815897, -0.028621732850336243, 0.14434831259117015,
        -0.10582453758193237, -0.033468459150339545, 0.14186248045510544,
        -0.10843534738804268, -0.04529253860832752, 0.1477640026534058,
        -0.09422500315755485, -0.048122547554177234, 0.1462142279917875,
        -0.09610906476935412, -0.061321100495329316, 0.14935431153329842,
        -0.08171848342982144, -0.06233991369493414, 0.148908464405215,
        -0.08245461475020835, -0.07648010100038927, 0.14914823851622364,
        -0.06843976965400447, -0.07598770429134656, 0.14986421352987767,
        -0.06765097173766405, -0.09056145901342531, 0.14719828331752863,
        -0.05452120954385066, -0.08892978560995231, 0.14902011420724331,
        -0.051891867669180476, -0.10247606503283833, 0.15578702840357941,
        0.12090766510869824, 0.2621645606172236, -0.5603691029003184,
        0.18313011324237746, -0.168186028988811, 0.17459763259962374,
        -0.11084709614597138,
      ],
      [
        0.0873292877618067, -0.15621396997691908, 0.09217473089223047,
        -0.023450340824039004, -0.0017616772955501043, -0.00039699763042366754,
        -0.0010344050377283048, 0.0007321667471357655, 0.0017619901588876328,
        0.0010373815616125913, -0.0007273753320821005, -0.0017893998443453724,
        -0.0010942748406202766, 0.0006837847831690419, 0.0018031235623344752,
        0.001166952700210824, -0.0005982513915376042, -0.0017594959911301357,
        -0.001182040742863873, 0.0005556625263059866, 0.0017338654797502608,
        0.0011866794939893463, -0.0005487423400173882, -0.0017605981805649746,
        -0.001248359211702356, 0.0004935745836614023, 0.0017601133829076134,
        0.0013115416700367963, -0.0004078784656055392, -0.0017078966869119344,
        -0.0013155447467947657, 0.00037345361239493716, 0.0016865772130471679,
        0.0013233519483117954, -0.0003625453846381603, -0.0017104784674701495,
        -0.0013878089733799742, 0.0002968584544308251, 0.001695223948043488,
        0.001439350286371638, -0.00021389825879417377, -0.0016369425446205374,
        -0.0014336778701374028, 0.0001874001066036982, 0.0016205158669833656,
        0.00144578385313375, -0.0001708214157886609, -0.0016393535812201255,
        -0.0015106520325152922, 9.625451776281395e-5, 0.0016094190739565563,
        0.0015489221375704766, -1.8710254011844777e-5, -0.0015477207358220624,
        -0.0015353751001574842, -6.261310137300606e-7, 0.0015362274794054772,
        0.0015524466192077555, 2.4250855594492438e-5, -0.0015478369209023222,
        -0.0016151284621997023, -0.00010554934987651364, 0.0015039675078011643,
        0.0016390944520281666, 0.00017535153846866248, -0.0014414728027666664,
        -0.0016197383340675181, -0.00018874418017690754, 0.0014344212729700697,
        0.0016419214724108255, 0.00022037188071589325, -0.001436848797927609,
        -0.0016997303416605824, -0.0003058470607057745, 0.001380412234479165,
        0.0017090040729558318, 0.0003660483023393306, -0.0013195683881888868,
        -0.0016860287713249974, -0.000375066004134249, 0.0013159785126913323,
        0.0017129261047578123, 0.00041514857431013016, -0.0013076151395315613,
        -0.0017632364476167291, -0.0005019663217773411, 0.001240533937055391,
        0.0017580855666918663, 0.0005512600294866772, -0.0011834818554819519,
        -0.0017336601506745372, -0.0005576988445474948, 0.0011819614145524811,
        0.001764343724084105, 0.000606127658202953, -0.001161657941501965,
        -0.0018047403574825952, -0.000691319265354971, 0.001086310159488451,
        0.0017860622200677693, 0.0007290029154719783, -0.001034772516278059,
        -0.0017621938521970393, -0.0007347492457174565, 0.001033620827106759,
        0.0017952533109202992, 0.0007908343393685546, -0.0010007772854710236,
        -0.0018236707980549731, -0.0008714499403234188, 0.0009198718622210221,
        0.0017929309856693962, 0.0008974407912496001, -0.000875068845546625,
        -0.001771336639997503, -0.000904329771466538, 0.0008724013673331596,
        0.0018049596849358562, 0.0009668152702914117, -0.0008270251368269621,
        -0.0018198034108640338, -0.001040077068757194, 0.0007434591096629647,
        0.0017789426665836261, 0.0010548911816322286, -0.0007060567138851349,
        -0.0017609415236233955, 0.026223504324832125, -0.022335762433702742,
        0.010453774395163557, -0.026857656052498565, 0.014238023059765141,
        -0.0008520267297772325, 0.0013898532703223439,
      ],
    ];
    const result = wavedec(data, "db7");

    const reconstruction = waverec(result, "db7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4974663523652803, 0.9150912973251768, 1.1905567644422672,
      1.2922573525512953, 1.2249305584014363, 1.0264344000670467,
      0.7566348298402282, 0.4813638633198546, 0.2556360061451094,
      0.11045097850546332, 0.046531885954867847, 0.03650649166110624,
      0.034814762587906944, -0.007403285386919312, -0.12649209866610006,
      -0.3338349540981283, -0.6101950121845273, -0.9084821984317831,
      -1.164371868155622, -1.3121274815915327, -1.3015846962448294,
      -1.1119024977198682, -0.7584725874226568, -0.29110116309910267,
      0.21620543148242352, 0.6813792325805778, 1.0323697486924353,
      1.2226870770689695, 1.2405852877427155, 1.1096920784879363,
      0.8810766248452963, 0.6189256061908996, 0.3836062327041983,
      0.2165212064972784, 0.13064508166576477, 0.10911119182516177,
      0.11208991806662254, 0.09001638167945783, -0.00044399112690490794,
      -0.1820263000235438, -0.44801547754406273, -0.7613956943574625,
      -1.0623863962527855, -1.2825456714368773, -1.3618783040822382,
      -1.2645590812371665, -0.9891888542591636, -0.570865371154685,
      -0.074423037276615, 0.4195578612120478, 0.8325302693378532,
      1.1051434516495813, 1.2095509241756752, 1.1538735670723486,
      0.977839004521956, 0.7408711520147341, 0.5058175614842937,
      0.32258406786008526, 0.21591924617027597, 0.1804655905480883,
      0.18426479649438718, 0.17967365371984115, 0.11869504535950892,
      -0.03143714074402432, -0.27665653889862296, -0.591649858855758,
      -0.9239571390998735, -1.2056828960916652, -1.3699067185721558,
      -1.3676201440040159, -1.1808303863008558, -0.8284120921150526,
      -0.36311562159951116, 0.13961542888225373, 0.5982816628763044,
      0.9432993707114603, 1.131854836873175, 1.1559992441081728,
      1.0420807334652236, 0.8418293453829219, 0.6175371643687217,
      0.42526172597360906, 0.3004437740837135, 0.24965404755527437,
      0.2505463263858623, 0.2599226152644939, 0.2276761831896873,
      0.11282579520951558, -0.1027063056844214, -0.40634287019679954,
      -0.7553305017699801, -1.0855033790970925, -1.326211293348019,
      -1.417655835383704, -1.326208318313007, -1.0537546483915365,
      -0.6386070434976399, -0.1476566410969754, 0.3383346630239978,
      0.7426633567745617, 1.0093846193646003, 1.1146635284155328,
      1.0700399830524152, 0.9169488556412645, 0.7140740408565107,
      0.5209332850810046, 0.3820216575928706, 0.31564715018421524,
      0.3103256769256391, 0.32959577667238704, 0.3238883392353137,
      0.24622255673436413, 0.0674810188763228, -0.21289019678844595,
      -0.5637294686550057, -0.9275648690908053, -1.2333485112160225,
      -1.4133613099370301, -1.4200077571983123, -1.2382004801469835,
      -0.8901246310947253, -0.4310936217361665, 0.06253374176797757,
      0.5103906278990765, 0.845859144049786, 1.0301461425953897,
      1.0592378581781146, 0.962131496056633, 0.790981932741146,
      0.6058649472809844, 0.4582126860427253, 0.37727433250526393,
      0.36312124004561713, 0.3879701551104752, 0.4053957918657881,
      0.36491817502432544, 0.22802358420767438, -0.018717840471664804,
      -0.3570357015100172, -0.7387586229281443, -1.095751731099928,
      -1.3555826501923756, -1.458987421549038, -1.3746976575409589,
      -1.1078238274531662, -0.6996060165581803, -0.21852768725186747,
      0.25502225074677065, 0.6467222713066553, 0.9044558282279267,
      1.0086356503968892, 0.9742456848073757, 0.8442667094128289,
      0.6763606592773087, 0.5264012323068692, 0.4332131550905336,
      0.4085216986903842, 0.43471411104622565, 0.47094124784305164,
      0.4658808385068464, 0.3737178555380829, 0.16903216745012656,
      -0.143454876420066, -0.527001365449293, -0.9195189410007995,
      -1.2472547455411371, -1.442093116282815, -1.4581133616032422,
      -1.2831865630258792, -0.942628128916543, -0.4939276532262179,
      -0.013837855385119863, 0.41896189943570245, 0.7413024959135932,
      0.9187369770870931, 0.9513092278570041, 0.8705884598687388,
      0.728926967560207, 0.5838870231075939, 0.4819980043929089,
      0.446134601725675, 0.4698204417924287, 0.5199172248017623,
      0.5469382006889294, 0.5002047567914119, 0.34377194181766313,
      0.06882012147959948, -0.3008932667649293, -0.7121366983329991,
      -1.093254833931817, -1.3704810011962902, -1.4854329633238204,
      -1.4093658343784465, -1.1505479173864912, -0.7528543525934631,
      -0.2858954581227072, 0.17086035658797522, 0.5459968490164542,
      0.7916281448582803, 0.8926315509241309, 0.8674482316151447,
      0.760444580634004, 0.6279956975016424, 0.522049630673318,
      0.4755453034957559, 0.4935317250165088, 0.5523101081681734,
      0.6067921069452477, 0.604090813364619, 0.4997030431317335,
      0.2719338734763006, -0.06935709994479533, -0.4821529660643491,
      -0.9001789319527684, -1.2474504518432248, -1.4558717199323117,
      -1.481462085735521, -1.3151000719250119, -0.9850449979379288,
      -0.5505731582265248, -0.08831474764560365, 0.32527969918873,
      0.6309526331706998, 0.7989069662338271, 0.8333495562412561,
      0.7683382635334248, 0.6562044794362283, 0.5517254736128907,
      0.49629024998864735, 0.5062640152231179, 0.5686224249269007,
      0.6449940354984307, 0.6830214272871256, 0.6320083068674052,
      0.4586676700045678, 0.15872582261425183, -0.2388134876177994,
      -0.6760515440112852, -1.0782901297089906, -1.370894827457143,
      -1.4967198643573894, -1.4297057113002496, -1.1812063884227497,
      -0.7974354930735446, -0.34866731891218883, 0.08708635157198602,
      0.44181842176696734, 0.6722524758007848, 0.7679256049661416,
      0.7507362236519018, 0.6662770153728443, 0.5693892115470109,
      0.507847458718425, 0.5085347285298841, 0.5697796980337995,
    ]);
    const expected = [
      [
        2.4193103054636427, 2.506140077996784, 2.2257621041018663,
        2.7073543305810914, 2.2829985151507475, 2.4687274141186633,
        2.9515142618947277, 2.291194088743336, 2.377340362730348,
        2.8830216980978465, 1.4735085599984357, 4.153599456044469,
        -0.2563129025185582, 0.23641083681429836, 0.4087370594365058,
        -0.7306734183036703, 0.459747056773944, 0.18780266162636944,
        -0.6825923222581141, 0.6209150831712198, -0.05855136957908009,
        -0.542605494267427, 0.7068557801261952, -0.3356890283979794,
        -0.2582871932397258, 0.7048565918082285, -0.8993032088524211,
        0.6998909413579669, 2.8834319673000914, 2.3578581163567547,
      ],
      [
        0.5866342972966789, -1.2194652757804434, 0.27058634012597693,
        0.5595074016001259, -0.7717795777064144, 0.8596117070472244,
        -0.6293807503020423, 2.5414662675176594, -1.0702862883782398,
        -2.143930297235265, 4.098450925207505, -2.851973922442221,
        -0.7793726583742273, 3.8194494241397257, -3.695653050580624,
        0.5078068671988741, 3.050783452057593, -4.034168062610898,
        1.7310077751111947, 1.8603104006877218, -3.8935407553073467,
        2.0856054901377368, 0.6395524664266606, -0.3327821361663563,
        -1.4335980747413886, 0.42693542719494976, 2.8256763806967555,
        -3.987654972402235, 1.9868747760857242, 1.6914027963930043,
      ],
      [
        0.9548130729184688, -1.8814016398437845, 0.7244560316152814,
        0.32111433172747367, -1.0198507939894526, 1.7858818590736838,
        0.10832519753171531, -0.6688523368351195, -0.16264203321733514,
        1.2324675903604116, -1.3424258056576257, 0.3225791298368533,
        0.9117471405771128, -1.2948273652099844, 0.5639309689332069,
        0.5890084251171744, -1.18200370318631, 0.7722949078550615,
        0.2406986366607262, -1.0101484526739593, 0.9387797608958537,
        -0.11712075566481914, -0.7868171130187721, 1.0554394491569792,
        -0.46800131092853864, -0.5221392043291224, 1.1168820941932356,
        -0.7958722153383544, -0.22835127248581844, 1.1205221670181953,
        -1.0857867254614233, 0.08077546752749983, 1.0666926387353257,
        -1.3246161079274126, 0.39103099529312285, 0.9707846875037606,
        -1.4087603230235863, 0.7131888028396626, -0.4195273629649548,
        0.3368469793265265, 0.7281406558758743, -1.754973122609363,
        1.4481248853623165, 0.044838676018671406, -1.4580014153720193,
      ],
      [
        -0.29036068416740884, 0.19429329561597428, -0.04940574614282239,
        0.33876698288604773, -0.6384537788725497, 0.4736787055019497,
        -0.23377323725452837, 0.016789561558842897, 0.10650040280975696,
        -0.10581764795168129, 0.0006986955110085212, 0.10736577339564253,
        -0.09854864249637073, -0.016471028125563204, 0.1099065440450892,
        -0.08932179800934092, -0.025349774706676792, 0.1169984562587787,
        -0.08094789258704001, -0.041834809725734494, 0.11628196571782685,
        -0.07041277689639558, -0.05017463032311934, 0.12101705085414817,
        -0.059450875770857545, -0.06521106199118216, 0.11702860273109543,
        -0.04810917812100687, -0.07255457864120263, 0.11923113079382422,
        -0.03508782333139728, -0.0854706168361482, 0.11210769663141495,
        -0.02349140706672704, -0.0914143610142693, 0.11172907265446767,
        -0.00902711512122495, -0.10163363465745519, 0.10175453631237856,
        0.0022487534232615257, -0.10584914638273034, 0.09887371991792142,
        0.01748083411458082, -0.11291693996672358, 0.08646718141875379,
        0.02786575620969471, -0.11516799999365755, 0.08128485377378492,
        0.04316364911986206, -0.11877190492685617, 0.06698248996114899,
        0.05212048306684489, -0.11892702273093923, 0.05980931696347905,
        0.06678814039523205, -0.11891105046275871, 0.04424060437863478,
        0.07384011158875924, -0.1169505693372629, 0.03548023067069936,
        0.08721958142572937, -0.11332207762476477, 0.0193396075950768,
        0.0919747657176656, -0.10937181502233959, 0.008175615647808483,
        0.08971282698318243, -0.1691532520923445, 0.08206440444765666,
        0.03922013841294937, -0.03411549302742998, 0.08816188796965613,
        -0.12351233294015994, 0.05735567503013446, 0.06877537657216501,
      ],
      [
        0.0780352979726941, -0.14015031268291345, 0.10125190337671089,
        -0.05177426284136714, 0.011903579989944372, -0.0002460406836175264,
        -0.0001075652762012108, 0.0008034304782407778, 0.00043061106079665017,
        -0.0003608555556760997, -0.0008019172831703526, -0.0004631005230157643,
        0.00032898663589469787, 0.0008075669724177882, 0.0005081824999737371,
        -0.00028126397677570174, -0.0007988073365796331, -0.0005456781294832793,
        0.00023129312012132473, 0.000779140481717829, 0.0005680850544123057,
        -0.0001956100933313486, -0.0007698630382404767, -0.0005960540654443905,
        0.00015936258297389818, 0.0007655846246825184, 0.0006349942551773729,
        -0.00010764378673634064, -0.0007455766846489822, -0.0006635668077100107,
        5.6943961679820386e-5, 0.0007172155905175758, 0.0006781330312459941,
        -2.093851584950571e-5, -0.0007006593052394859, -0.0007001949556630005,
        -1.7834629265100645e-5, 0.0006868057619855021, 0.000731267137513163,
        7.117298380917082e-5, -0.000656461864951377, -0.0007495649217170702,
        -0.0001202543982998336, 0.0006206311056921765, 0.0007554360340570433,
        0.00015472289077726948, -0.0005976585600391054, -0.0007705165749086555,
        -0.00019406896474817673, 0.000575033596910039, 0.0007923769903831352,
        0.0002465887270555635, -0.0005357387005522457, -0.0007995154324638436,
        -0.0002917588786658329, 0.0004940357848183077, 0.0007962552549592725,
        0.0003228907827912174, -0.0004658430056124345, -0.0008036445951380025,
        -0.00036085424241359253, 0.0004356577925589549, 0.000815391571427494,
        0.0004101687659191466, -0.0003892053076568994, -0.0008109959356771423,
        -0.00044929740188255423, 0.00034352801089063297, 0.0007986126589929731,
        0.00047544417263047794, -0.00031158386257742067, -0.0007979991017406941,
        -0.0005101628594366856, 0.00027539462683842187, 0.0007992114326046155,
        0.0005540471926155878, -0.0002239033416418962, -0.0007834359062356826,
        -0.0005852677616975556, 0.00017636199126756728, 0.0007623866699732714,
        0.0006050163396983954, -0.00014233370966691374, -0.0007538701763295571,
        -0.000634812308141541, 0.00010196334862679677, 0.0007446225801854762,
        0.0006713053519848925, -4.7779326483436224e-5, -0.0007181447684879253,
        -0.000693104315412774, 5.981420816406253e-7, 0.0006893182955015928,
        0.0007053503334268534, 3.373327885902178e-5, -0.0006734033158930429,
        -0.000728810871708085, -7.628567841601537e-5, 0.0006542583877939981,
        0.0007563047497514604, 0.0001306976343821689, -0.0006182494206245326,
        -0.0007675948187621825, -0.0001752854931403042, 0.0005829273869512435,
        0.0007716009203280053, 0.00020811584157197913, -0.0005604954108277542,
        -0.0007876458543927235, -0.00025077312949687116, 0.0005324726049431539,
        0.0008049583603583044, 0.0003029433654745969, -0.0004885442027584182,
        -0.0008051321207911327, -0.0003428020600247034, 0.0004483430646642178,
        0.0008005684105199663, 0.00037239585283768066, -0.0004206063160529788,
        -0.0008085004735351482, -0.0004131037986945319, 0.0003851295834234476,
        0.0008149272733454672, 0.00046067172812850606, -0.0003352605169085036,
        -0.0008038885724770131, -0.00049386523610061, -0.016163480680386068,
        0.03156774662985142, -0.024255657839922153, 0.012071780693437598,
        -0.0015205494545590527, -0.00040842782645840117, -0.0006886357885804313,
      ],
    ];
    const result = wavedec(data, "db8");

    const reconstruction = waverec(result, "db8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4838494610968561, 0.895507110823919, 1.177400620537261,
      1.2978544632200313, 1.2564748357244118, 1.0824863600346637,
      0.8265281538984186, 0.5479517603050508, 0.3007035465075177,
      0.12117230457147327, 0.020869915686131835, -0.014385278759242615,
      -0.018706365035663863, -0.03532543349602968, -0.1034879083045755,
      -0.24636758018140242, -0.4630673605091876, -0.7267760209582508,
      -0.9896502436868975, -1.193345891655519, -1.2827293859852773,
      -1.2194960986450185, -0.992403219527593, -0.6215968800822358,
      -0.15589451424149256, 0.3364557774722603, 0.7814735026637089,
      1.1144790791936408, 1.293021628070496, 1.304758279748779,
      1.1685361132563383, 0.9285329525891193, 0.6429457151945923,
      0.36998507212216725, 0.15454036874049798, 0.01867635524009781,
      -0.04183557143216321, -0.0542316453959555, -0.05964416527477498,
      -0.10050979577069014, -0.20768770430304284, -0.3905457352275782,
      -0.6325487493783271, -0.8935413900907214, -1.1182812730363625,
      -1.2492425016101552, -1.2406443991383593, -1.0703245246275324,
      -0.7465515807874441, -0.30805086763746414, 0.18288773106181694,
      0.6527130632645607, 1.0315373782889412, 1.2672682329323743,
      1.3357184682810996, 1.2444151001089425, 1.029315947715543,
      0.7453131283126395, 0.45285621874803483, 0.20391832864696452,
      0.030644329899513545, -0.060663225391785924, -0.08888182065781634,
      -0.09102335961699451, -0.11065136751791466, -0.18470758362587253,
      -0.33207742529301376, -0.5467972102818055, -0.7976728944240765,
      -1.0345135710686884, -1.199560795899584, -1.2414084419278695,
      -1.1280684366640492, -0.8560014119511412, -0.4528612666648327,
      0.026821940178572513, 0.5121275679763087, 0.9300420447648066,
      1.2203047050941427, 1.3474035254350267, 1.3069935745170111,
      1.1253273322629298, 0.8519330145039984, 0.5473612174809899,
      0.2689635654689359, 0.05809765217760182, -0.06823037237253876,
      -0.11937628437443919, -0.12636644325664692, -0.1317814341893877,
      -0.17680744758330835, -0.28873160731186887, -0.47204416410378547,
      -0.7054280291732161, -0.9454773770235209, -1.13633891690005,
      -1.2230095520101056, -1.1651052886406132, -0.9477615177733312,
      -0.5869738776249481, -0.1279884491823236, 0.36300974176354933,
      0.8120720116837528, 1.1525297298500967, 1.338462305204649,
      1.3535129406158717, 1.2130721113833158, 0.9594120786497891,
      0.6510124998006716, 0.3486718463854091, 0.1017291732768621,
      -0.06234681316711144, -0.14259070634951274, -0.1624041521110805,
      -0.16130912345109855, -0.18273226698995487, -0.26092067189798657,
      -0.4102936650454749, -0.6199361750237522, -0.8546815094000624,
      -1.0626183927488022, -1.1872779178744437, -1.1815920159471367,
      -1.0202480700933698, -0.7074090452666237, -0.27784471424103924,
      0.20892886545589195, 0.6802481046805595, 1.0650204237839016,
      1.3081975150025098, 1.3816890093402674, 1.2892386747909603,
      1.0642077454897079, 0.7608786920813837, 0.44140923348848404,
      0.16156904689969936, -0.04135765926288032, -0.15567940618319914,
      -0.195822120050976, -0.19628591789471506, -0.20064361907094358,
      -0.24838935594395045, -0.36295998440511407, -0.5439585422025639,
      -0.7655789444783773, -0.9817130085378899, -1.1365809788025796,
      -1.1783608258592146, -1.072530048652978, -0.811661883522413,
      -0.41923147202102234, 0.0536063338475245, 0.5376428069691861,
      0.9594978424216885, 1.256595143585626, 1.3897982095183667,
      1.350821056842422, 1.1627571167892818, 0.873689345941429,
      0.5449675122555133, 0.23697764450432246, -0.004211113038034897,
      -0.1561874255964673, -0.2233902000303603, -0.2335210416652416,
      -0.22819331001461277, -0.25022881342658315, -0.3308186606025364,
      -0.4797878876470583, -0.6814392438522464, -0.8970845733213131,
      -1.0737323939438272, -1.156883294176604, -1.104357186261688,
      -0.8977874859822921, -0.5489388402318126, -0.09921427669521478,
      0.3876736033510559, 0.8382690737297185, 1.1843290958520345,
      1.3767435706671876, 1.3952303803308301, 1.2516071118276784,
      0.9859525589552427, 0.6566411154550467, 0.3266634047417568,
      0.04949613478746695, -0.14214814533950648, -0.24208872814740895,
      -0.2697059212784456, -0.2626160219136664, -0.2649150894720459,
      -0.3139814672993423, -0.42916591631350987, -0.6052281789568572,
      -0.8122136608063819, -1.0018849598866009, -1.119211230509623,
      -1.116163072782328, -0.9644656434676717, -0.6641733698791945,
      -0.24589787165017346, 0.23398380768487753, 0.7041480301842381,
      1.0927408487756984, 1.3420980381739378, 1.4203913767852956,
      1.327541002012007, 1.0940811640257715, 0.7733227254143711,
      0.428724980500479, 0.11949758675986655, -0.112162825127475,
      -0.249227053636785, -0.3015431113321929, -0.300837549372186,
      -0.2903705624107485, -0.31189620866500295, -0.39322140204780354,
      -0.5394989859247084, -0.7304700908397079, -0.9244114332344826,
      -1.067896508188984, -1.1090433259242205, -1.0110427103536619,
      -0.7626536904927266, -0.38304444670158944, 0.08031523857539455,
      0.5603578356534031, 0.9837948614283226, 1.2861235149106054,
      1.4248204241081868, 1.3876966816298306, 1.1945228486217705,
      0.891614048326389, 0.5407161510450411, 0.2048605081156823,
      -0.0654591111648658, -0.24254994257814702, -0.325874910910065,
      -0.3395946160517881, -0.3240460714857779, -0.3233713350540674,
      -0.37243129878158726, -0.48629925414025416, -0.6549879267686322,
      -0.8447776587169719, -1.005892828296926, -1.084709654209509,
      -1.0375491023400034, -0.8426873717207426, -0.5076070045366116,
      -0.06962259233096763, 0.41041838025078303,
    ]);
    const expected = [
      [
        2.4785697928315304, 2.552935891982799, 2.309953294759908,
        2.7685728136018772, 2.340767302722419, 2.5353800178910872,
        3.0029060815645106, 2.352364813116086, 2.4450857938517343,
        2.948351102418351, 1.511438355855759, 4.327153380265197,
        -0.4351742206194915, 0.48088695111471735, 0.22122766446896752,
        -0.759844516142804, 0.7896964508080685, -0.3088943738477718,
        -0.3734366090550638, 0.8219947326242969, -0.7292285114204824,
        0.13653170546123358, 0.561853358973475, -0.915215432473801,
        0.7817586144596534, -0.42361946316662447, 0.34352909612822913,
        -1.285919227713766, 0.9173385546917877, -1.4925933332781096,
      ],
      [
        0.5572374382064553, -1.1845073730950986, 0.2110576071998191,
        0.5622060261865369, -0.6977130200625451, 0.7960042233456744,
        -0.43965284113481656, 2.800004503807208, -1.664452073161798,
        -1.7247739417924621, 4.017963844973631, -3.3039177349505153,
        0.6560415891907454, 1.927166620548607, -3.396683515572374,
        3.1255856922766574, -0.6697725615665647, -2.769123049504564,
        4.331198060883744, -2.4645995408744743, -1.180355635902457,
        2.7959272307441854, -2.0586221948927657, 0.9838943939854918,
        0.20114013324902674, -2.2131802862367493, 3.3287008363532773,
        -1.1494526451150466, -2.487249770011016, 4.2435847406935485,
      ],
      [
        0.9935362831316005, -1.928721184501051, 0.7919212060654677,
        0.3430424667453361, -1.131405982938391, 1.8346817380419147,
        -0.04063946953620621, -0.7207165218729138, 0.36335570691782776,
        0.479609684232383, -1.0710438082149778, 1.0605793452927597,
        -0.5308185936789961, -0.24776559412803012, 0.9489665429882319,
        -1.2027805491265933, 0.74105308927995, 0.30554880344789864,
        -1.299040699262866, 1.4690466092453582, -0.5679844881072013,
        -0.806557334153623, 1.6223815787126037, -1.258032487778809,
        0.020555419745034775, 1.1393234659443294, -1.4272256475494896,
        0.7792775160778124, 0.2375122404357493, -0.9698556392473555,
        1.103238844943988, -0.6846736822130081, -0.06260242946183577,
        0.8311554415006918, -1.2225134105416655, 0.9899051727966109,
        0.5612789474348652, -0.23277598144887893, 0.16010424190128308,
        -0.130608227953569, -1.1873260373373706, 0.3212779215013393,
        0.9142103109296872, -1.6197872573532244, 1.225763172536193,
      ],
      [
        -0.2575887843868744, 0.14930037737719784, -0.011270974336424438,
        0.3016044893953224, -0.6029149489938412, 0.4471542338944348,
        -0.21075743290835103, 0.00293083040193118, 0.09617352686638729,
        -0.06855479114020338, -0.03409409972568886, 0.09707426685853002,
        -0.04071496933823267, -0.06531517598441257, 0.08954715642785203,
        -0.008692223907691634, -0.08252087469809427, 0.07723145532003037,
        0.024118104675474452, -0.09600791502035567, 0.049667364773173496,
        0.053269489402904054, -0.09296515151815232, 0.022910543654151197,
        0.07808164695012568, -0.08361461132369853, -0.013372499852239322,
        0.09087563075900615, -0.060786760953356916, -0.04117284800917212,
        0.09687144517849385, -0.033611619799820115, -0.07098601685937779,
        0.08687591406614387, -0.0007595830973814155, -0.08593220451707892,
        0.07212375042584553, 0.03148569611690202, -0.09698878225498743,
        0.04293946611475678, 0.05967708462009089, -0.09111280574662448,
        0.015196043241515625, 0.08232582377770171, -0.07948707071452414,
        -0.021088921494455317, 0.0928919283297737, -0.05447978643256563,
        -0.048000105360338975, 0.09602554551936344, -0.026285210071688787,
        -0.07618732351684972, 0.08362276129244209, 0.007178496436337911,
        -0.08876750377176465, 0.06653862150012992, 0.03864365177560532,
        -0.09732629149266092, 0.03592189897621724, 0.06568618344511723,
        -0.08865058205544703, 0.007383929587722237, 0.08602266734672069,
        -0.07483487251343478, -0.028946332435316195, 0.09116726869722365,
        -0.06452864730109285, -0.515331062562043, 0.28852825417839384,
        0.4168976368997411, -0.2904895305673049, 0.1596269366849061,
        -0.00970366552357029, -0.08783039785703992, 0.07689396281186499,
      ],
      [
        0.07574894890892617, -0.1353423729038821, 0.09737573415002738,
        -0.04998817349199856, 0.011813981220197174, -0.00022886671273195512,
        -0.00026999261989482193, 0.0005903622100931268, 0.00042595334407515207,
        -0.00012438080243235542, -0.0005619954359605021, -0.0004900888815894658,
        2.77313540862466e-5, 0.0005245420348585493, 0.000551405796697497,
        8.267713671985487e-5, -0.0004605122812274131, -0.0005898672270629197,
        -0.00019014897862519665, 0.0003771861695847822, 0.0006003758693673084,
        0.00027915776246170915, -0.0002947756756471961, -0.0006014666281040433,
        -0.00036243832929494903, 0.0002075681776099152, 0.000594160735465348,
        0.0004475286754656222, -0.00010162984107061552, -0.0005596662437746221,
        -0.0005150248510086872, -9.231999366683924e-6, 0.0005008821246859855,
        0.0005555609445693328, 0.00010690370445410783, -0.0004382550451530085,
        -0.0005859824863942022, -0.0002014926533853636, 0.00036885353507551416,
        0.0006099854357796238, 0.00030305790642691104, -0.00027674261142027423,
        -0.0006081147487943973, -0.0003936419330579106, 0.00017218713513536936,
        0.0005787307258809414, 0.000460046684200927, -7.507646105175608e-5,
        -0.00054170869249897, -0.0005169117315589704, -2.1880973314689446e-5,
        0.0004968960991202316, 0.0005705301096368057, 0.00013107350132102852,
        -0.00042679399091951286, -0.0006014976868163398,
        -0.00023678070474442462, 0.00033761632590390277, 0.0006036898151582992,
        0.00032257994484444024, -0.00025016557686378027, -0.000595672984537518,
        -0.0004005075826354916, 0.00016005770043472226, 0.0005800174784353974,
        0.00047932991136660904, -5.284367587474843e-5, -0.0005381925095659383,
        -0.0005404550516347737, -5.871900067748104e-5, 0.000472029573979298,
        0.0005735369948520572, 0.00015572746824124055, -0.0004023755135339014,
        -0.0005951936052571729, -0.00024733999132316593, 0.00032776075990940463,
        0.000610615635724482, 0.0003446215113554606, -0.00023202695908209933,
        -0.0006008567000392222, -0.00043056737483510146, 0.0001243488357115215,
        0.0005632330252001842, 0.000491070086526963, -2.5269446101490375e-5,
        -0.0005178036888340429, -0.0005402778331992373, -7.133481508977786e-5,
        0.0004659490549869336, 0.0005858578526805542, 0.00017859595346438007,
        -0.00039023771179280464, -0.0006091303155907073,
        -0.00028184711074537793, 0.0002957849560162079, 0.000602973008221708,
        0.00036385068103960696, -0.00020388361092049938, -0.0005858997224536715,
        -0.000435895166249622, 0.00011149269332387496, 0.0005620176064278825,
        0.000507940155424434, -3.7080767184082637e-6, -0.0005131403149014524,
        -0.0005622952893493385, -0.00010782727256302221, 0.0004400209331463737,
        0.0005876853153369983, 0.00020351417661412325, -0.00036380756441156995,
        -0.0006004269342547657, -0.0002915261914556869, 0.0002844948815976683,
        0.0006071834408825309, 0.00038388954003521305, -0.00018576997836884087,
        -0.0005896042156202113, -0.0004646358293456802, 7.566975798455741e-5,
        0.000543973006420276, 0.0005188176216881091, 2.4709142201225306e-5,
        -0.0004904390907735319, -0.0005600311604690746, -0.00012030070403760306,
        0.024896887503099457, 0.008294195875722405, -0.04639268723195412,
        0.007112086688445316, 0.01291693760226049, -0.0070441383477293515,
        0.0013756448623797345, -0.00038367863667644375,
      ],
    ];
    const result = wavedec(data, "db8");

    const reconstruction = waverec(result, "db8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db9", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5047503610347552, 0.9290678172601565, 1.2097318297397572,
      1.3137776226917033, 1.2442513478783193, 1.0373899517882028,
      0.7520871823751047, 0.45442580651499986, 0.20125812978719654,
      0.026999149902320052, -0.06308324357965178, -0.0915097340549782,
      -0.09969626020993497, -0.1340151031977561, -0.23060408688737039,
      -0.40303654959676505, -0.6362166731380192, -0.8882420269680138,
      -1.0998947397851049, -1.2094193387339123, -1.1688347406243063,
      -0.9575747592015871, -0.5898758252306022, -0.11387685280916596,
      0.3975273096271169, 0.8619584989780604, 1.2052816518130682,
      1.3774834949297265, 1.362856414921156, 1.1820635750399366,
      0.8856917324699882, 0.5410199338463526, 0.21540674291741402,
      -0.039498010301603714, -0.19877990657569655, -0.26785645014426324,
      -0.27791505575471626, -0.27457739671055975, -0.3029192010409901,
      -0.3929030354430519, -0.5491572235661812, -0.747889898359677,
      -0.9418580214799889, -1.0721979008756373, -1.084110207561555,
      -0.9423463836253043, -0.6424362239236115, -0.2146341071319356,
      0.28061788153878925, 0.7647704594705251, 1.157935542259894,
      1.396284453521666, 1.445837086867148, 1.3092914795660948,
      1.0242759888808486, 0.653543698209768, 0.26962828049044274,
      -0.062164653399706726, -0.2981887866478258, -0.4247780338380613,
      -0.4585256374805306, -0.4386714557487579, -0.4137754563411833,
      -0.42631072363804834, -0.49932027264009143, -0.628719467998946,
      -0.7833360523535803, -0.9127467059382075, -0.960916153735266,
      -0.8821009669226924, -0.6548441659546121, -0.29032503256955655,
      0.16726742879584394, 0.6486553710671159, 1.0738951428135821,
      1.3698421997313468, 1.4863983625107342, 1.4075572946261539,
      1.1545461922327502, 0.780326076591279, 0.35686150443054515,
      -0.041642015993522796, -0.35536079218949257, -0.5512486062672735,
      -0.6282363747341729, -0.6141304264349976, -0.5552346531482225,
      -0.5015743605172842, -0.49170113768217555, -0.5411284975466873,
      -0.6374719382767505, -0.743597241605544, -0.8079734915397112,
      -0.7795252606489756, -0.6230719953400343, -0.331244080853001,
      0.07037153163502824, 0.5263960240530432, 0.9625573282833715,
      1.3017612716742182, 1.481428119031051, 1.4678264718431073,
      1.263855242621848, 0.908342486007916, 0.4670375633891528,
      0.017535894563398546, -0.36812967311260775, -0.6389482722437885,
      -0.774693139896482, -0.7877169360554521, -0.7165538119872572,
      -0.6131867323470719, -0.5274330994017404, -0.4926000015531121,
      -0.5161865710101514, -0.5780639362919341, -0.6365913080842386,
      -0.6410380472488061, -0.547014144453289, -0.3307954118117781,
      0.001323301114322717, 0.4112640923266705, 0.8356743944084305,
      1.199266313653478, 1.431773955452531, 1.4843519436225292,
      1.341331247802788, 1.0243777643049452, 0.5879801462055688,
      0.10734954283844211, -0.3383017866847835, -0.6830013989517204,
      -0.8875774057157848, -0.9463003455143708, -0.885140684717043,
      -0.752308213887544, -0.603685863672031, -0.4870355766327549,
      -0.4291172234095037, -0.42905931002269015, -0.45966141160404733,
      -0.47622106722687874, -0.43049988816809126, -0.2860842064850687,
      -0.03100534659427645, 0.3158343866127836, 0.7063043706597962,
      1.072556751201456, 1.3421671766743037, 1.455186846788769,
      1.3788479344228362, 1.1162062310136633, 0.7064935665964671,
      0.21701185542986456, -0.2714917261590125, -0.6824078843538657,
      -0.9595229303677549, -1.078024555982587, -1.0476742005210469,
      -0.9075534752290877, -0.7139174518088054, -0.5244080935862849,
      -0.3827598133172395, -0.30794504223938796, -0.29051186253190375,
      -0.29696804174379804, -0.2809553582454285, -0.1981780535327324,
      -0.02105763080868217, 0.25086129652132244, 0.5876450301354805,
      0.9338963979969063, 1.2208006947039436, 1.3823586064451505,
      1.3717504177730189, 1.1736836345651478, 0.8095417834687182,
      0.3339329528679122, -0.17661846817789836, -0.6401289755874213,
      -0.9867693199038433, -1.1733622737554577, -1.1912899717759122,
      -1.0660052207970347, -0.8484570661521582, -0.6007647111624994,
      -0.37989129375600744, -0.22352137068088956, -0.14172168310268657,
      -0.1164276437190824, -0.10874494239205915, -0.0720151049946744,
      0.03290971404772064, 0.22431757910908579, 0.49185553590492254,
      0.7965191490476646, 1.0785984736406131, 1.2716888614994932,
      1.319271632903126, 1.189653646559485, 0.885413255114237,
      0.4448456228951765, -0.06510695651928565, -0.5628199912351373,
      -0.9694942126132198, -1.2259617584409988, -1.3047251852691824,
      -1.2143645965077041, -0.9953669742773629, -0.70857994213405,
      -0.4193236562863859, -0.18124490447191777, -0.024002399857212253,
      0.052165361962390994, 0.07374922774174586, 0.08403281532811893,
      0.12866804915707442, 0.24068117984902965, 0.4289707651473554,
      0.6734483085927836, 0.9282416408077736, 1.1322752830655185,
      1.2246023044709329, 1.1605880950831295, 0.9247677882483822,
      0.5369912060831928, 0.05013370264985371, -0.46023377654425435,
      -0.9117944776119185, -1.2332105776807538, -1.3793208245461144,
      -1.340135718251351, -1.1415065831346602, -0.8374272983496044,
      -0.4960114740684737, -0.18274457346707168, 0.05475388418698407,
      0.19666661990889248, 0.2532276484482774, 0.2589032098312862,
      0.2602125546727764, 0.3005336620605716, 0.40600509096316023,
      0.5763347997097342, 0.7830380772385549, 0.9756814759056166,
      1.0946082163558013, 1.0869038636399182, 0.9214720618374213,
      0.5992601795092174, 0.15586434584804637, -0.3443480717108006,
      -0.8213181070054871, -1.1964661177337588, -1.4097918866486083,
    ]);
    const expected = [
      [
        1.1818028485731804, 2.2143050103040482, 2.141395008729029,
        -0.14339671967429157, 1.4777929298106742, 3.0476761425562935,
        0.4460731636627605, 0.7040262118317142, 1.7611881309651192,
        2.8850194657279515, -0.27339159076415986, 1.4175644992276744,
        2.053136045041618, 2.815353059801233, -2.1520716663509325,
        -0.4855242716664967, 2.61723111371861, -2.171149346365174,
        -0.38741636514075334, 2.535434009229537, -2.177960090523243,
        -0.307053369876006, 2.4621918878534923, -2.1774660249292506,
        -0.24341709088569335, 2.4012621815113446, -2.1750677684639603,
        -0.19394811090024644, 2.3550409563596633, -2.1761169213219387,
        -0.15478330815086078, 2.3243527806843693, -2.1854331720966287,
        -0.12110963368525357, 2.3083809001736872, -2.2068721355413348,
        -0.08761616759164764, 2.304734766394939, -2.241812848309071,
        -0.05403716996006766, 2.3151648646566914, -2.2685868220757923,
        -0.13024603626703046, 2.621860387847149, -2.6217166107395458,
        -4.456068258082461,
      ],
      [
        0.9690673455610922, -0.6650438189716136, 1.8044971061113835,
        0.05952572147616486, -0.2516886391054433, -0.9442625380711688,
        -1.1231423927227284, 1.1078545967618976, 0.19099644437346827,
        -1.3053307073624123, 1.367129357492294, -0.34064005679489,
        -0.9647483497252518, 1.4753928516200163, -0.7332624609030794,
        -0.6672235288985756, 1.5383956370073788, -1.1075111170165264,
        -0.2932311381258518, 1.4772710337179347, -1.4115905612871662,
        0.12311964039980851, 1.2964820956044387, -1.618313433938534,
        0.5455012492801071, 1.0112614578905639, -1.70913839253822,
        0.9370291829848059, 0.646138186433103, -1.6758230286178402,
        1.2635490230546802, 0.2327522608192648, -1.5211587697393134,
        1.4966801396006952, -0.19289372312558425, -1.2550486109477694,
        1.6629768043529194, -0.279591318351904, -0.5681461936653956,
        0.6664198586070995, -0.24900719516269834, -1.0026487533137112,
        1.0578542444101495, -0.1246414257815303, -0.8939462258167203,
        1.1445090743297448,
      ],
      [
        0.09663412569870428, 0.0450487348471983, -0.13526762693694797,
        -0.0761244282778497, -0.12728426569122192, 0.2807423417456195,
        -0.11772050829938782, -0.05914827864405881, 0.12969749134219025,
        -0.08475041510445554, -0.019175930009320545, 0.09276027543752917,
        -0.06465654235661003, -0.03604137791390365, 0.09563723200755897,
        -0.05070477711061532, -0.04698472771895402, 0.09543866366908356,
        -0.04062495881836334, -0.06078606570098083, 0.0942367268321238,
        -0.024599352996122703, -0.06937439333312417, 0.08970070986862216,
        -0.01308345382773347, -0.08019744759769251, 0.08446294235127513,
        0.0038108532609838464, -0.0854961357812073, 0.07593782610590237,
        0.015511802636657098, -0.09254244452065857, 0.06719093233747592,
        0.031994376986624475, -0.09391563639889856, 0.05537304905344445,
        0.042610836592740994, -0.09671778552858583, 0.04396411198941133,
        0.057439831490869266, -0.09388525147380496, 0.029835777707664865,
        0.06579717745071297, -0.09234835730990079, 0.01685667263003089,
        0.07787977362245457, -0.08541065440333208, 0.0015987038881319468,
        0.08300326468536748, -0.07982064534395931, -0.011711317268419048,
        0.09149282419024946, -0.0692503265898513, -0.026824772711779823,
        0.0926947522973887, -0.06024828576589888, -0.0391896427164812,
        0.09706602611114284, -0.04684794245884593, -0.052904586377837105,
        0.0940072820470899, -0.0353727986598249, -0.06312527412760945,
        0.09410296757755197, -0.020205548288380712, -0.07440528898042734,
        0.08582773737291856, -0.013903977533156215, -0.2027405643866663,
        0.27817681323820675, -0.1507762180962158, 0.12158176213720906,
        -0.12546889649923967, 0.08267700316637466, 0.014916759206999895,
        -0.0896453676758447,
      ],
      [
        0.06821079817050209, -0.10994186806043492, 0.07772280796965474,
        -0.05749413967850322, 0.027391049690673477, -0.0061740099266754216,
        0.0004015379634404782, 0.00034813805994738083, -0.00019306716782284666,
        -0.00036441204824012613, -0.00018535930400321373,
        0.00017242977567292903, 0.0003658705849379143, 0.0002089863335489595,
        -0.0001488728513006909, -0.00036575108019234554,
        -0.00023421379673303332, 0.000120160266722066, 0.000358881494103483,
        0.0002543236305620808, -9.265274162150228e-5, -0.00034944444036822216,
        -0.00027016944424845644, 6.89774867021719e-5, 0.00034273548385874077,
        0.0002882551602264373, -4.3109422460228865e-5, -0.00033473663306580554,
        -0.0003076240874058454, 1.2616925122776097e-5, 0.0003201817325716146,
        0.00032156030239300477, 1.621448298664065e-5, -0.00030311848257554914,
        -0.00033072937616363587, -4.05431378839112e-5, 0.000289020554800275,
        0.0003416996649686641, 6.630177712277958e-5, -0.00027409172898786716,
        -0.00035377752981526864, -9.612816808495699e-5, 0.00025297245277601966,
        0.0003602647445796942, 0.00012383266881802276, -0.00022956470960555146,
        -0.00036164515105361315, -0.0001463759626204438, 0.0002095069657799732,
        0.0003645502431105116, 0.00016960521984528396, -0.00018922116486934007,
        -0.0003685554820319568, -0.00019637476194159592, 0.0001632517277830918,
        0.0003669922708227758, 0.00022061109533188928, -0.00013534099712009853,
        -0.0003601655042588828, -0.00023909366880796887, 0.00011127563365160309,
        0.000354764605059348, 0.00025759005227358404, -8.768899253202794e-5,
        -0.00035063595044943315, -0.0002791800869033823, 5.902427102911397e-5,
        0.00034114848094906556, 0.00029792507871455066, -2.8847987137367385e-5,
        -0.0003264270994082269, -0.00031043810399921545, 3.076034670697644e-6,
        0.00031320983342661223, 0.00032241115905940626, 2.1455744050136198e-5,
        -0.0003016114384242566, -0.00033715602661501815, -5.0412116783122124e-5,
        0.00028504224008458497, 0.0003488847791374646, 8.041975219705339e-5,
        -0.0002634423407105265, -0.00035405641123225116,
        -0.00010545372146816902, 0.0002435850966286222, 0.0003582884838522395,
        0.00012848564445436993, -0.00022584699508249034,
        -0.00036512770698641535, -0.0001552953673324294, 0.00020367985916732893,
        0.0003689493631341298, 0.00018272008032170966, -0.0001768308397267119,
        -0.0003660673189257102, -0.00020464603095209555, 0.00015209190847900538,
        0.0003620222692584362, 0.00022386205627160187, -0.00013009111778033682,
        -0.00036059479554348476, -0.0002462693494271632, 0.00010431882350630601,
        0.00035633177440964946, 0.0002689317070343864, -7.431847382893559e-5,
        -0.00034540711201300244, -0.00028566556440149087, 4.688132685110373e-5,
        0.00033327828711752464, 0.0002990853542864805, -2.2874192735524682e-5,
        -0.0003239543904931269, -0.0003152178880645728, -4.179149390371851e-6,
        0.00031215803139066154, 0.0003313672724984187, 3.495130937134345e-5,
        -0.0002939244442711974, -0.0003412968460352102, -6.267263134558813e-5,
        0.0002746176333638782, 0.00034745259977978936, 8.625190288654859e-5,
        -0.0002584656311229752, -0.00035598825307575394,
        -0.00011213805423901893, 0.0028945493635945956, -0.0036090245457451337,
        0.002192604767874839, -0.0014641875799222114, 0.0005919003119855399,
        -0.0006185989652246379, 6.973396124306596e-5, 0.00034277984324366677,
      ],
    ];
    const result = wavedec(data, "db9");

    const reconstruction = waverec(result, "db9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db9_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48757647874532506, 0.899959758120118, 1.1778235388433824,
      1.289803515242728, 1.2379761861590266, 1.0555015995890995,
      0.7971295172810398, 0.5250068269900514, 0.293351362948246,
      0.13579578781740093, 0.0584982002248024, 0.04064213143322738,
      0.04207661721943701, 0.01604474509344672, -0.07633365416118204,
      -0.25360260191281647, -0.506804134277346, -0.7995452821542381,
      -1.075414131683698, -1.2710011497651255, -1.3313493837247865,
      -1.2240107253684256, -0.9481885380045929, -0.5366268769678856,
      -0.04967242862127801, 0.43714969057195574, 0.8491153153523558,
      1.128034171304184, 1.2439989472347914, 1.2003959855766524,
      1.0310807351204163, 0.7905423743585818, 0.539590745526104,
      0.33017212035496035, 0.19309387188138216, 0.13167134107637585,
      0.1227964288788767, 0.12504570280960944, 0.09166628541016192,
      -0.014955170765975356, -0.2111136595640225, -0.4850997693152609,
      -0.7978312229896318, -1.09078523140624, -1.2993688247226702,
      -1.3684747975273335, -1.266385758589884, -0.9935561014261485,
      -0.5840328281096301, -0.09906751583999227, 0.3856197773055865,
      0.7959107975304854, 1.0748667319857068, 1.194114679084658,
      1.1583817767280178, 1.002204495110959, 0.7797615997910674,
      0.550456392246615, 0.3638919750713184, 0.24799165482883628,
      0.20319085650056234, 0.20407511993437744, 0.2079493880541381,
      0.16806907247958672, 0.04808159757555103, -0.16608643237658338,
      -0.4600278749257025, -0.7920479484201568, -1.1016017385155195,
      -1.3229967386790558, -1.4010359391765905, -1.3047537433427585,
      -1.0358280584550772, -0.629532734269858, -0.14790922066722645,
      0.33326393790524794, 0.7406106545142908, 1.0185584661348153,
      1.1403461861490187, 1.1120734789525089, 0.9689455221223289,
      0.7647843993893699, 0.5575223570584795, 0.39435373172989185,
      0.3002653637617287, 0.2727815293708467, 0.28417133087917,
      0.29047165654757456, 0.2449508979000938, 0.11250935281059987,
      -0.11873597703291516, -0.4317389938530635, -0.7822747902681643,
      -1.1078704269683919, -1.3418223150256903, -1.428907544463832,
      -1.3389357368175694, -1.0747822643215035, -0.6728726805124345,
      -0.19592409707359076, 0.28036201541797917, 0.683486988417105,
      0.9593586977838783, 1.082904580081561, 1.061629133788497,
      0.9313958858387265, 0.745627509781225, 0.5607257183364034,
      0.4214166069559172, 0.34970467704975916, 0.3401779219617554,
      0.3627837723185624, 0.3722975585587308, 0.3220059949855485,
      0.17805273857523568, -0.06928953570203539, -0.4003993531191,
      -0.7686093880229554, -1.109617910980218, -1.355803102114441,
      -1.4519834374530864, -1.3687695549368226, -1.1102098481740565,
      -0.7138076253161906, -0.2428425768257078, 0.22719519638913083,
      0.6248183116962015, 0.8975277209409478, 1.0220157014420244,
      1.007224256989207, 0.8896667380391012, 0.7223271818541239,
      0.5600223596793477, 0.4449568623594586, 0.39611363501166197,
      0.40512550657810864, 0.4396180168052746, 0.4531145528096897,
      0.39892635813897187, 0.2444295531978113, -0.017985504910147332,
      -0.3661900769448418, -0.7511671911510117, -1.1068904631968168,
      -1.3649169143026414, -1.4701769825549365, -1.3941105062743124,
      -1.141916184459478, -0.7521025523690013, -0.2884002348242178,
      0.17404470555199136, 0.564888278676992, 0.8333356441333615,
      0.957919148593847, 0.9490511138061293, 0.8438878826084619,
      0.6949390762373333, 0.5553872010481156, 0.4648683593948564,
      0.4393114846103085, 0.46738174627056883, 0.5143877456031708,
      0.5326138383316708, 0.47540307390108943, 0.31135199536957103,
      0.034927647382308025, -0.3293063317993719, -0.7300808815284326,
      -1.0997537458612994, -1.369161884254205, -1.48342145167701,
      -1.4148320502348861, -1.169721802548877, -0.7875335785051165,
      -0.3323390312320444, 0.12119050167220771, 0.5039843961934464,
      0.767061193446821, 0.890867247175301, 0.8873179207018226,
      0.7942072624280221, 0.6635380712225762, 0.5468143432144433,
      0.48106303361184005, 0.47913345443187944, 0.5267171208852955,
      0.5868159591149332, 0.6104916705354068, 0.5511276577925751,
      0.37852793694708675, 0.0891925116491244, -0.28995640743960216,
      -0.7054997186417283, -1.0882924562459744, -1.3685564263177976,
      -1.4916703048375493, -1.430826376547121, -1.1934632305094053,
      -0.8198890127801619, -0.3744085247859288, 0.06890998041558227,
      0.44239671911787176, 0.6989904793843251, 0.8211239646919104,
      0.8222479769802942, 0.7407903653542293, 0.6282179839139725,
      0.5343171248401248, 0.4934712861841016, 0.5154314565321798,
      0.5829160939405904, 0.6566361456575454, 0.6864506557027625,
      0.6257933910407937, 0.4456622172278768, 0.14454390855289423,
      -0.2483607380917252, -0.6775888105475599, -1.0726098880006971,
      -1.363139111197476, -1.4948973830114423, -1.4420049034693507,
      -1.2129937692115034, -0.848970361894334, -0.414367051812345,
      0.017476690075274304, 0.38041653661799824, 0.6294157330277205,
      0.748963775019768, 0.7540787301344025, 0.6838195518570565,
      0.5890912057860562, 0.5179280918962297, 0.5020422909722575,
      0.5480747120611212, 0.6357780160880407, 0.7235934034550281,
      0.7602010182018317, 0.6990966512803669, 0.5124579529422917,
      0.20071009733725031, -0.20475086819357224, -0.6465283139132194,
      -1.0528274104427253, -1.3529684525240908, -1.493097012366504,
      -1.4482986924691033, -1.2281841932705344, -0.8745932774133148,
      -0.451982865623066, -0.03284093406483679, 0.3183350550183376,
      0.5586340171191954, 0.674670477831083,
    ]);
    const expected = [
      [
        1.4349085842840286, 2.1397758202420847, 2.200551874005848,
        0.24954672541511908, 1.601106333978022, 2.9295556679475236,
        0.6918132611916615, 1.035494987412292, 1.7560370332901762,
        2.8370336505640332, 0.10243909310655436, 1.6159417940785739,
        1.9949873726627847, 2.8526681097785094, -1.5644141977682926,
        -1.4078242008424267, 2.601841403126351, -0.6363852109578382,
        -2.0663987564397988, 2.2224825336199805, 0.35927174505015413,
        -2.545856461590174, 1.6501522644087492, 1.311152834785812,
        -2.7899597566708145, 0.9432501313191295, 2.113979244573949,
        -2.7622608056410476, 0.16733104032834278, 2.681448306025289,
        -2.452378305950814, -0.6104542424517078, 2.9562865395164453,
        -1.8798651072591672, -1.3259456543606998, 2.9161807642020596,
        -1.0946608206925863, -1.9215850151486713, 2.574826262525795,
        -0.17477747910296382, -2.340077322579568, 1.958183657774845,
        0.7780576299616272, -2.4026639283967435, 0.6803850054632571,
        2.8752632007592513,
      ],
      [
        0.9399352920004755, -0.6456790862592228, 1.728998767377764,
        0.06302769682339748, -0.23492339116366603, -0.9093064883081746,
        -1.0749145338475588, 1.1003343637249947, 0.11653497470595933,
        -1.2731036715675408, 1.5071425900485786, -0.6078881057319917,
        -0.7892545765539577, 1.589382614546313, -1.1175613211130035,
        -0.26167900364321883, 1.4195029610966663, -1.4236048219813722,
        0.31699068756495036, 0.9686075464023559, -1.435409909117972,
        0.8120087298367419, 0.3342531167324355, -1.1426491265242644,
        1.1098255404034587, -0.34873281428653197, -0.6003737906374098,
        1.1417344434603405, -0.9373306669649079, 0.08209098631890455,
        0.8991764842580626, -1.3108384726608988, 0.7640360645760357,
        0.43575811346825566, -1.3963846563716644, 1.301426844640365,
        -0.16816489728790332, -1.3358413290195466, 1.0405169695008045,
        -0.7044269229893334, 1.1934472293731968, -0.48220563501698516,
        -0.4809972593392079, 1.1189954694096964, -1.019048361766059,
        0.20040684726558647,
      ],
      [
        0.08695202138063568, 0.049906532346756224, -0.13335975471838024,
        -0.07182706815238579, -0.12288242156368637, 0.26969860237996046,
        -0.11250859160666705, -0.05704060059855598, 0.12201093206436177,
        -0.07368528036750681, -0.027171371167634146, 0.087445680653103,
        -0.04679069315963912, -0.04829352113439697, 0.08686631352569814,
        -0.026929188839821854, -0.06257502111198916, 0.08241944831512812,
        -0.00778629524286872, -0.07660723531429994, 0.07216572408603703,
        0.013582810184051499, -0.08319257654460918, 0.059674128063523436,
        0.032852118908884564, -0.08840858916136841, 0.04176613344685925,
        0.05119058546986313, -0.08567585373562521, 0.024054718908174018,
        0.06634120183584238, -0.0811344012915577, 0.0022357353497535256,
        0.07771054921673758, -0.06949556059676462, -0.016696255238338696,
        0.0854503187842916, -0.05634824393364365, -0.03787013237304101,
        0.08736204955562488, -0.03817764742784184, -0.053731932484062384,
        0.08606628438666646, -0.01940277344256677, -0.06986240860740114,
        0.07802374701551458, 0.0014629380564965217, -0.07902039374441948,
        0.06808221641860204, 0.021718710973665362, -0.08680160659059857,
        0.05169639398356906, 0.0408022911881844, -0.087086321394725,
        0.03541807853122649, 0.058130516969411926, -0.08500271826699649,
        0.01407139827080066, 0.07128024554264495, -0.07619739265416484,
        -0.004831282483790634, 0.08196816428079852, -0.06483540463758027,
        -0.026701506309086364, 0.08626247123058631, -0.04864294417071148,
        -0.0429754328077528, 0.09582727689010996, 0.036319301013485364,
        -0.16705789948315763, 0.16582891792890495, -0.14887640976350502,
        0.0710668569866071, 0.0366681976527107, -0.08846163746098996,
        0.03718396682191131,
      ],
      [
        0.06582225223678212, -0.105990494202804, 0.07475282840496336,
        -0.0552646907914226, 0.02640136914136651, -0.005996211946753373,
        0.0003655872393501715, 0.00034051625279055554, -0.00015169638386687301,
        -0.00032410302825712766, -0.00019314173030686397,
        0.00011892763060301965, 0.00032065803826493097, 0.00022339451474050429,
        -8.261070468803729e-5, -0.00031228050659246997, -0.0002515766800869452,
        4.2869000013045885e-5, 0.00029658904168296333, 0.00027328811103082614,
        -4.8048013069654325e-6, -0.0002777937628210494, -0.00029069510464632014,
        -3.139725250791413e-5, 0.00025802152282948976, 0.00030718077495325803,
        6.973878019930946e-5, -0.00023325691662052548, -0.0003194813924261477,
        -0.00010864192186936166, 0.00020264921271272144, 0.0003242826126878746,
        0.00014323484185411935, -0.00017109624641644753, -0.0003250500999152151,
        -0.00017477282952333846, 0.000139520099966891, 0.00032436160814883864,
        0.00020688361397308455, -0.00010380356842061431,
        -0.00031828699930948096, -0.00023675220754997903, 6.466926422953035e-5,
        0.00030494234563996364, 0.0002602779664273666, -2.7173051650375087e-5,
        -0.0002887612582614366, -0.00028008993208445966, -9.109764203985402e-6,
        0.0002712650247697342, 0.0002991384946188709, 4.8046881174177794e-5,
        -0.00024824073433155487, -0.00031369977717868184, -8.747164762824598e-5,
        0.00021940935448481135, 0.0003208947571400176, 0.00012272930871004052,
        -0.00018971650845033968, -0.00032450741461729707,
        -0.0001556112365196548, 0.00015945155148662233, 0.00032655443780359443,
        0.00018941645882633844, -0.0001245025618638341, -0.0003227988637812172,
        -0.00022081024289768753, 8.618496973906361e-5, 0.0003118890249100662,
        0.000246059288884645, -4.942495728500197e-5, -0.00029840518109228474,
        -0.0002682040767482144, 1.3202935362340655e-5, 0.0002832388059549279,
        0.0002897058985590604, 2.613908913708228e-5, -0.0002620580099229485,
        -0.00030644384081621504, -6.587730719039677e-5, 0.00023516465242313968,
        0.0003160230253368567, 0.00010165008096656408, -0.00020746897330725693,
        -0.00032247677169522734, -0.00013574639625869313,
        0.00017862784757177917, 0.00032722398141692204, 0.00017107158520861986,
        -0.00014461368896575481, -0.00032579625600254294,
        -0.00020382462822994156, 0.00010731760394395916, 0.0003173990432759685,
        0.00023070059483999976, -7.145500079078027e-5, -0.0003066793420748545,
        -0.0002550924258276794, 3.5436338797620584e-5, 0.00029388533288707513,
        0.00027892426104542795, 4.114647479336851e-6, -0.00027464637656061567,
        -0.0002977479127329585, -4.3958514902132916e-5, 0.00024984369354712964,
        0.0003096924152605577, 8.009748020267803e-5, -0.00022426924795674601,
        -0.0003189665573478621, -0.00011527068182130556, 0.00019695862626946178,
        0.0003263649036750178, 0.0001519315800660365, -0.00016404586198656357,
        -0.00032726665483193867, -0.0001858743871093801, 0.00012797013190634163,
        0.0003214488424921854, 0.00021427565921974996, -9.3158561050683e-5,
        -0.0003135436424609142, -0.00024081522089504454, 5.748662754875622e-5,
        0.0003031534612902678, 0.0002668412003553481, -1.792674169096745e-5,
        3.353604721148306e-5, -0.0023479591420866373, 0.003478233828544314,
        -0.0011040668534342739, -0.0013667544823536958, 0.0010544640672590809,
        0.0002422285152089316, 5.040994048797513e-5, -0.00022776824735506448,
      ],
    ];
    const result = wavedec(data, "db9");

    const reconstruction = waverec(result, "db9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db10", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49469782408633467, 0.9114211462054741, 1.1889512776876268,
      1.295520411835959, 1.2344040935020315, 1.0411490329836932,
      0.7732644203897537, 0.4950768389555497, 0.26162980657060325,
      0.10570199192377083, 0.031177405984671225, 0.014343006613980136,
      0.01263809132145896, -0.021541069778910626, -0.1256790026498178,
      -0.31466855522132153, -0.5743847348881652, -0.8631060360927059,
      -1.1205607840677674, -1.282400015097947, -1.2964744428281894,
      -1.1367857109775694, -0.8115234052899529, -0.3630548783346354,
      0.14026188573803897, 0.6185275422422307, 0.9975291789050216,
      1.2245670922790515, 1.2790540771538672, 1.1753733229669034,
      0.9574206717816296, 0.6863328060853582, 0.42458999801743774,
      0.22055466858163875, 0.09734662798320154, 0.048806406841146927,
      0.04345455574296462, 0.03528817891944516, -0.021506553607991752,
      -0.15785629213035507, -0.37904566136185414, -0.6608226625718312,
      -0.953516695944133, -1.193253849133438, -1.317510506891715,
      -1.2810977418511569, -1.068510059003641, -0.6994464044947519,
      -0.22599998369994068, 0.2779096094357931, 0.7323481844898567,
      1.0685961977379894, 1.2436160128410814, 1.2482737178651955,
      1.1074005342407527, 0.8718226388224887, 0.6044900526101693,
      0.36428913287333586, 0.19166274738036793, 0.0996534956867649,
      0.07256074840776311, 0.07242664266390275, 0.051543951932589704,
      -0.0323742898643804, -0.20241143507740733, -0.45374546206724903,
      -0.7524204390822569, -1.0420601127984692, -1.2569406677911878,
      -1.3381820776437658, -1.2489777965928675, -0.9849771280813389,
      -0.5771172070106372, -0.08607489034466198, 0.41039999966203256,
      0.8342284263278541, 1.1237623248135316, 1.2465007866452344,
      1.204720648242461, 1.0327592141830513, 0.7867760342663992,
      0.5296910728973092, 0.31517575028793077, 0.1747646566429848,
      0.1113137988096945, 0.10037302721463157, 0.0989899259370698,
      0.05954326319992015, -0.05509443958939486, -0.2591123989432209,
      -0.5373885828670009, -0.8469839469836806, -1.1262744326581577,
      -1.309514789753024, -1.3432048246117407, -1.2001225657408063,
      -0.8874317178446758, -0.44672793519650283, 0.05410714367568556,
      0.5353298315741168, 0.9225530030563177, 1.1625802325906593,
      1.2340294788887252, 1.150232720908174, 0.953836938934968,
      0.7046064121127338, 0.46361168538550174, 0.27786133275125796,
      0.16927065134456687, 0.13071097253297212, 0.13003969472838836,
      0.12094555649450496, 0.057683169009918434, -0.09023556150589224,
      -0.3273209753169176, -0.6282693345891499, -0.9421570534513203,
      -1.2037429815312417, -1.3491124876025258, -1.331749244684138,
      -1.13496309569176, -0.7774783138798453, -0.3106766620979728,
      0.19193234424118172, 0.6505007723036156, 0.9960652142969137,
      1.1850245059341245, 1.2073893955250155, 1.0868894966702909,
      0.8730657577658532, 0.6274770758443928, 0.4076017540557145,
      0.2525521903223112, 0.17421098172246513, 0.15597129371494706,
      0.1592889792138451, 0.1362330609843786, 0.04467043138387883,
      -0.1379644146017166, -0.40600810382045494, -0.7244027372301838,
      -1.0354884410244638, -1.2721639556479472, -1.3741676073745444,
      -1.3033922897294263, -1.0543441146188943, -0.6570385401554423,
      -0.17150244286598113, 0.3248574065192239, 0.7539784554212249,
      1.053899183316045, 1.1914889844833918, 1.1681102611717744,
      1.016950668692623, 0.7928515385618555, 0.5573273011482207,
      0.36264796398066407, 0.2390462039136771, 0.18826736981786657,
      0.18502201633966317, 0.18585082171245035, 0.14299421558128933,
      0.01956300590702198, -0.19803748879226463, -0.49378065592005355,
      -0.8235798208040311, -1.124501425212865, -1.3294170443047797,
      -1.3834580709447366, -1.2581319077837405, -0.9595028659060113,
      -0.5282995873149121, -0.03181634760363701, 0.4504784393428908,
      0.844143993427874, 1.0956009527292938, 1.1827721725229985,
      1.118017722510528, 0.9427895225932091, 0.7155043151250325,
      0.4958172662562206, 0.3293473011276801, 0.23674154563494276,
      0.20981468953639196, 0.21565534207752166, 0.20752679460132786,
      0.13963105353847843, -0.018198694918261538, -0.2698045193690657,
      -0.5889189148375664, -0.9234296136216071, -1.2067647472510707,
      -1.3736250623455744, -1.3761426843725886, -1.1963896432705252,
      -0.852036781758527, -0.39365509288936285, 0.10576952766891254,
      0.5665958930343078, 0.9197364552451164, 1.1211378199320594,
      1.1600511473356752, 1.0591785261056172, 0.866823356574788,
      0.6431716467818871, 0.44428127615429, 0.30789199559487046,
      0.24465711562858472, 0.23697163629831086, 0.24559636723958622,
      0.2222579716004423, 0.12485631911831852, -0.0687716775205951,
      -0.352223894706447, -0.689423678526019, -1.0214860347961972,
      -1.2799623014046926, -1.4032088125189062, -1.3517871853309793,
      -1.1190012133532603, -0.7338609192948818, -0.25564016692780556,
      0.23871303707654098, 0.671273610966852, 0.9798850961653891,
      1.130895654547131, 1.1248447283455176, 0.9938389591385904,
      0.7914428726715752, 0.5777769131166557, 0.4036906268465629,
      0.2980663560139414, 0.2614640961937049, 0.2676589125407366,
      0.2725730324246408, 0.2281887771476931, 0.09773489862879498,
      -0.131901975298648, -0.4438895230422146, -0.7930716343890916,
      -1.1152577655507547, -1.3419597862156443, -1.4169335925385813,
      -1.310378772543507, -1.02719532384654, -0.6071563763368923,
      -0.11686242515476125, 0.36461091362830855, 0.7628903146536459,
      1.0241304231571637, 1.1256642865251143, 1.0789669786598874,
      0.924358335267264, 0.7189425791369864, 0.5209643234801441,
    ]);
    const expected = [
      [
        0.8013331088656378, 1.8566533936043652, 2.8050465808550715,
        -0.15358170370312857, 0.7403241250739528, 1.7523091396602402,
        2.9258767213087915, -0.0198324382066693, 0.5662590827764272,
        1.690521408602552, 2.9029242458809814, 0.30412823040597886,
        0.2858236712416912, 1.865355272679377, 2.3784809538667737,
        1.6682567536502089, -2.860601087428718, 0.8884592685898172,
        2.110170157583143, -2.810497172204491, 0.4069054149323122,
        2.4683958988623087, -2.6424472781866646, -0.08624056880543841,
        2.716926855817892, -2.3596749331205125, -0.5764447734955779,
        2.8483329138254034, -1.9712027713331814, -1.0492396977322167,
        2.861019263698428, -1.4917301970413865, -1.4902565969994583,
        2.758885449887809, -0.9411125175068012, -1.8853200416152354,
        2.5506708839312844, -0.3434650881268941, -2.2205779985020278,
        2.2489290508704993, 0.27372837009272266, -2.481488240532351,
        1.872460775588747, 0.8465729957391567, -2.524799979063214,
        1.0977306849743835, 2.114145657915374, 2.3148981628780865,
      ],
      [
        -0.30500237904680455, 0.6692622809953559, 1.4704830216029128,
        -0.719963975596418, -0.045328132057998634, 0.7536158407383786,
        1.198749991430261, -1.2032363409582614, -0.23930483357916416,
        0.7338036381588644, -0.0811743724324028, -0.9317896856972366,
        1.3101235672268694, -0.6935792091496169, -0.4189172189892242,
        1.1613179537700673, -0.9988131424203387, 0.09134116973460885,
        0.8691239506068239, -1.1711680689014865, 0.5855573602491784,
        0.4663917571554925, -1.19468023017358, 1.010891018424845,
        -0.0029419641301363696, -1.067983574933955, 1.3219965378567338,
        -0.4868260223028117, -0.8073914436389868, 1.4865169246488992,
        -0.9309682525528397, -0.44496292314863034, 1.4886528050964063,
        -1.2849936991954054, -0.024743578287564336, 1.3313519848885171,
        -1.505102375455423, 0.39119919979224016, 0.9808707325282654,
        -1.4665169567310277, 1.1852292369723647, -0.42281947684626503,
        -0.796035013851129, 1.6379288190029107, -1.298386454544384,
        -0.027608628058884335, 1.2740277480860138, -1.427831445008157,
      ],
      [
        0.23944900838003355, -0.19455270855823611, 0.052375639717331134,
        0.07657841291679349, 0.32863827808780427, -0.32198387535197404,
        0.24021121926169964, -0.2419277515134996, 0.197573037460774,
        -0.09013851916166755, -0.024621589264301243, 0.07835005083366296,
        -0.04069705267565752, -0.04221083702279875, 0.07814320577367272,
        -0.027642272949921245, -0.05235234070673857, 0.0752199218241711,
        -0.015821220726719345, -0.061873004007217236, 0.07102546706916087,
        -0.0017243303970680517, -0.06858153280848849, 0.06406257629864101,
        0.010618097285728404, -0.07449788442328614, 0.055818765690551886,
        0.024424504402243443, -0.0769644622443981, 0.045586220050023295,
        0.03581256364223979, -0.07864867849834153, 0.03425142332349055,
        0.04781945571100391, -0.07654003606313921, 0.02190535077391363,
        0.05689023262126074, -0.07385609436985391, 0.008777114026374504,
        0.06578864800639495, -0.06735298204272075, -0.004271637164258994,
        0.071450031015095, -0.060669988307379116, -0.017704792162830434,
        0.07627803407082774, -0.05044889013737896, -0.029951699229247092,
        0.07783554102588715, -0.04059651452179039, -0.04217973090126759,
        0.07808588483833244, -0.027755026299185883, -0.05219885637977793,
        0.07532378888367997, -0.01592622719821736, -0.06186159643134816,
        0.07100008361625115, -0.0018605119249163003, -0.068469385926572,
        0.06420750873329964, 0.010527251892388616, -0.0745103509242634,
        0.05582255409541516, 0.024283246413092496, -0.0766781298098223,
        0.0487542315878592, 0.054297073463885265, 0.028700228522154824,
        0.09739132259118545, -0.23902589990279324, 0.10126927073894403,
        -0.10285812857214546, 0.07682905021832064, 0.0034725241602621072,
        -0.07234740963154382, 0.058278956430543344, 0.019873289190785463,
      ],
      [
        0.0556478336047617, -0.07158137270606219, 0.03274421323784209,
        -0.03516765095687081, 0.029175675512499978, -0.013407439436509919,
        0.00305103131390292, -0.00016151760058664137, -0.00023292107509137808,
        -6.841669629046993e-5, 9.629868563542707e-5, 0.0001693132301567195,
        8.103217705707714e-5, -8.462711148865785e-5, -0.00017005693745216307,
        -9.390942264772309e-5, 7.149031300981851e-5, 0.00016892472663387862,
        0.00010582676109288408, -5.768372384087764e-5, -0.0001660211390766245,
        -0.00011616606110765122, 4.4333853548664044e-5, 0.00016263049193816865,
        0.00012603461493641642, -3.0734239259320615e-5, -0.0001585558260479856,
        -0.0001357769384291974, 1.6034921676147918e-5, 0.00015258492329131172,
        0.00014410016233807238, -1.2379101036174637e-6, -0.00014510488905735227,
        -0.0001506498247793367, -1.2691175015202018e-5, 0.00013737703612589603,
        0.00015663071466877194, 2.663334578334365e-5, -0.00012899339061649034,
        -0.0001621705611864653, -4.1250406199807026e-5, 0.00011885262300248998,
        0.00016596070654339515, 5.538058789529006e-5, -0.00010760615780482983,
        -0.00016792861193865578, -6.826461813847546e-5, 9.643934401728737e-5,
        0.00016933339676446826, 8.093144457160853e-5, -8.474482489711736e-5,
        -0.00017008429145154373, -9.383660898420284e-5, 7.15703204641438e-5,
        0.00016891059361764832, 0.00010571155052280186, -5.780082136031609e-5,
        -0.0001660265537606473, -0.00011604044044875717, 4.44936581325188e-5,
        0.0001626978664344511, 0.00012596724594035152, -3.0859590671131354e-5,
        -0.00015861954399600434, -0.00013573044631994173, 1.6125976317231934e-5,
        0.00015260851698303146, 0.0001440108681392195, -1.3699187067210869e-6,
        -0.00014515688184449247, -0.0001505625615931074, -1.2527727888977137e-5,
        0.00013748626917584148, 0.00015660575316132704, 2.6514694730245368e-5,
        -0.0001290874954253219, -0.00016215799135313192, -4.1161415584993604e-5,
        0.00011890878709108237, 0.00016590593005526413, 5.524842072942085e-5,
        -0.00010769774899717266, -0.00016788752144533716, -6.8113481823967e-5,
        9.658054240484814e-5, 0.00016935548761771118, 8.083360356748578e-5,
        -8.48593750593211e-5, -0.0001701090401098713, -9.376247099846468e-5,
        7.16500007044793e-5, 0.00016889459261265158, 0.00010559346830369537,
        -5.7921029593896754e-5, -0.00016603455839387223,
        -0.00011591630313606564, 4.465341318430805e-5, 0.00016276665533268038,
        0.00012590246393855175, -3.0981783468664274e-5, -0.00015868033880974626,
        -0.00013568206511128846, 1.6217356767152588e-5, 0.00015263079761917498,
        0.00014391901300042176, -1.5050345164236345e-6, -0.0001452117467405216,
        -0.00015047727029104567, -1.2364916008876896e-5, 0.00013759635850776647,
        0.0001565829785720005, 2.6399073091311394e-5, -0.0001291784801308421,
        -0.00016214304713645358, -4.107145816102868e-5, 0.00011896425080387372,
        0.00016584900943004765, 5.51132710832804e-5, -0.0001077923885513483,
        -0.00016784882085081436, -6.796354221597698e-5, 9.672201140166557e-5,
        0.00016937928662317413, 8.073854566139636e-5, -8.497073544448321e-5,
        -0.00017013102866556362, -9.368676469096329e-5, 7.172962562870904e-5,
        0.01651305632592877, -0.020977853088519748, 0.009415050298989076,
        -0.010238327147800583, 0.008334327594667122, -0.0038598026360443676,
        0.001059454841055282, 5.02541502699053e-5, -0.00011553705839046986,
      ],
    ];
    const result = wavedec(data, "db10");

    const reconstruction = waverec(result, "db10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db10_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5008140662645486, 0.9200727571369056, 1.1943885420146052,
      1.2921490098553399, 1.2191872415116765, 1.0151972262009048,
      0.7419696256333347, 0.46662536431951185, 0.24428631704437648,
      0.10471570889552778, 0.04636476922338095, 0.0392680909539793,
      0.035865039722836944, -0.01328761782605603, -0.14324912333651763,
      -0.36236082339745307, -0.6472884662144336, -0.9469232259127248,
      -1.1942618098318007, -1.3232454600195467, -1.2861839539105258,
      -1.0671827777732197, -0.6879876459364793, -0.20460233668223893,
      0.30458342696222523, 0.7562222196886019, 1.0806210094056994,
      1.2368615591696617, 1.2206646417147389, 1.0631200279709252,
      0.8207717870573589, 0.5597772583955465, 0.3383653641013034,
      0.1922129815063326, 0.12653713547985362, 0.1168850040998767,
      0.11827351168571895, 0.08010070367513122, -0.0372897827261226,
      -0.2489556299225682, -0.5384114551811132, -0.859412030155421,
      -1.146160550145628, -1.3293866207314684, -1.3541489015406094,
      -1.1947113964743838, -0.8625565624595442, -0.4053486642192635,
      0.10300922536068137, 0.5787804825866498, 0.9471487771356532,
      1.1586051467535703, 1.198876215337423, 1.0899858607503692,
      0.8823464744026394, 0.6400956747820514, 0.4236229534948338,
      0.2739171241921812, 0.20283267255272108, 0.19176467289562837,
      0.19896386185390807, 0.17341213321415339, 0.07142402675251702,
      -0.12859528281883648, -0.4173260986239284, -0.7541676195906526,
      -1.075608268486926, -1.3102835479715749, -1.3968716878817289,
      -1.3001814088378822, -1.021206982117792, -0.5984563774916289,
      -0.10010009937876294, 0.39114429569081344, 0.796603073150639,
      1.0590332209557571, 1.154451517622946, 1.0955072485135664,
      0.9257032164904461, 0.7061431105565046, 0.4984054759500644,
      0.3481131987021437, 0.2735312922049239, 0.26215036082048593,
      0.27606328121796975, 0.2645865284733185, 0.1806371308892905,
      -0.0036363577982534423, -0.28628752867390117, -0.6330578051184252,
      -0.9837716813929872, -1.2661311029561941, -1.4134163712141583,
      -1.3815277082962785, -1.1609223315170254, -0.7802882695785269,
      -0.30091382706958975, 0.19689228091129876, 0.6319268652673504,
      0.9401961121023924, 1.0884517286082338, 1.0798167422743323,
      0.9502254970063141, 0.7567914531109974, 0.5613013024863026,
      0.4132692785252585, 0.33704977095028116, 0.3263859168463872,
      0.3477646047259554, 0.35158509801939386, 0.2880533151119289,
      0.1234398606622677, -0.1477760336564275, -0.49828064829327184,
      -0.8722399904073613, -1.197607065162991, -1.4033428167347624,
      -1.4371379204013022, -1.279041176292667, -0.947421733515331,
      -0.4956519278029548, -0.00028391533897981214, 0.4563170312376886,
      0.8044990324390504, 1.0023456253698, 1.0434603533970692,
      0.9556790626097432, 0.7912414619272681, 0.6111676950276244,
      0.46806789415619027, 0.39197617484535513, 0.3829529355412713,
      0.41236676454803267, 0.43243468907031946, 0.39138310208824567,
      0.25007677143858464, -0.004449660003204237, -0.35232406104507974,
      -0.7429970491374067, -1.1058618673415368, -1.3667172680742432,
      -1.4658844514525713, -1.3733083686563752, -1.0967138431222607,
      -0.6806569413831396, -0.19665042200320432, 0.27316190719573635,
      0.6546534605174045, 0.897977778308219, 0.9873828821594716,
      0.9422124876203088, 0.8090353292748202, 0.6471518315511748,
      0.5114326425137699, 0.4371004088757904, 0.4305049218206613,
      0.4683131490905743, 0.5052710489370771, 0.48839186466947804,
      0.3736938878040326, 0.14090720062430329, -0.19791933625577024,
      -0.5983856165121599, -0.9924991050449994, -1.304113198571765,
      -1.4671473129957393, -1.441918473218651, -1.225361064145288,
      -0.8524633856486319, -0.3885025268383087, 0.08597544096225954,
      0.49362289164327816, 0.7775296473466785, 0.912905495725143,
      0.9103500503257506, 0.8100621234812658, 0.6687055542705638,
      0.5425494235514905, 0.47144024206747803, 0.4678977151625977,
      0.514227029885157, 0.5683801327939273, 0.5769472734433346,
      0.4917392728338327, 0.2854382377606888, -0.0379894866419499,
      -0.44106434867068356, -0.8595471542669568, -1.2166023902196954,
      -1.44082726080787, -1.4835506286229552, -1.3309524508560133,
      -1.0078633642261103, -0.5722352672756604, -0.10167076232968675,
      0.32456404089192825, 0.6434743893813814, 0.8216960612402647,
      0.8609771304065139, 0.7945560655794153, 0.6755935827366817,
      0.560881883553827, 0.4942622578882069, 0.4942155078624837,
      0.5489432778773697, 0.6202365659339556, 0.6550650845372895,
      0.6017419160114654, 0.4262715926989451, 0.12440662143998676,
      -0.27395832863858394, -0.7094224060408658, -1.10573637785789,
      -1.3873489733975166, -1.4973941670739104, -1.4115153092907013,
      -1.1439671197315397, -0.744411871730785, -0.28621617913891073,
      0.15076466830824004, 0.49852630700420736, 0.7157328802769527,
      0.7953184861469841, 0.7630877373148448, 0.6678950716982291,
      0.5661807694187795, 0.5050972894435247, 0.5087918859060243,
      0.5715356667526351, 0.6595384230853071, 0.7209523003250168,
      0.7013629808089485, 0.5605770567062918, 0.2861332624860661,
      -0.10020406466043597, -0.544884792892624, -0.973518583767297,
      -1.3076541871585328, -1.4831644916509261, -1.4655524540137834,
      -1.258257378070447, -0.9018287399352657, -0.4641795580295976,
      -0.024420744295836627, 0.3455859681574247, 0.5972625975639217,
      0.7149099110246013, 0.7165484626925938, 0.6459985332194773,
      0.5584870287414947, 0.5037500180743544, 0.5112254273029991,
      0.5813391522069138, 0.6852375596464545,
    ]);
    const expected = [
      [
        0.7560286470975474, 1.8645844643369072, 2.7654499023562904,
        -0.13405769625868252, 0.7124413788759772, 1.7632927787178503,
        2.8790769014001665, 0.00736640232192675, 0.5463920857261536,
        1.694846562788162, 2.8666221936291016, 0.31670621937252824,
        0.27199446390873605, 1.8381884470049605, 2.4250734292575515,
        1.5393198515981041, -2.8090888532686855, 1.0482697143254245,
        1.8683435552652479, -2.782307239950654, 0.6847885392309332,
        2.173225795013303, -2.6996210023964147, 0.3070387278372782,
        2.4349854500387824, -2.562770905362541, -0.07733187351552644,
        2.648381500791408, -2.374584942965447, -0.46053512723367374,
        2.8091358512681603, -2.1389202513204144, -0.8348001605478642,
        2.9140191489537624, -1.8605843855542479, -1.1925307963143197,
        2.9609180022918267, -1.545234909246691, -1.526608198472187,
        2.9494006292620485, -1.1972853898357463, -1.853737055731695,
        2.9845959829019515, -1.1404393072965469, -1.3954017743951546,
        1.3808031837011705, 1.8665762618009778, 1.0544394991711872,
      ],
      [
        -0.3284372342636981, 0.6954815701903819, 1.4647785590124633,
        -0.6587026579800119, -0.015049091085034449, 0.7719374507067555,
        1.1826964083144107, -1.1577271688449577, -0.32300589960769865,
        0.6670600102650867, 0.22908025932555406, -1.2597103404176293,
        1.264853373210474, -0.14958265387009567, -1.0688245804836818,
        1.2774297536634287, -0.3174219466312079, -0.9016399527205339,
        1.2677830629905587, -0.47811603103335387, -0.7200279223688273,
        1.2383658290406103, -0.6320797059218476, -0.5265743604153049,
        1.189758276817164, -0.7768197311503249, -0.3245053513904403,
        1.1228286450086065, -0.9099725023716149, -0.11718862376564743,
        1.0387238823376979, -1.029342821120448, 0.09192302913829235,
        0.9388498833624082, -1.1329568622140633, 0.298914949380859,
        0.8257107399632136, -1.182861734296313, 0.47746275439328895,
        -0.19856104667725802, 0.11508478513176053, -0.19171743185598983,
        0.9499250743955908, -0.9242218310043069, -0.04134823264661956,
        0.9959389293502817, -1.0350367918527994, 0.12006801348391613,
      ],
      [
        0.2592647697127172, -0.21883157075942516, 0.06561151824774457,
        0.06604743168119344, 0.3460067896846484, -0.3371570111743734,
        0.25018234310369386, -0.2505151651556501, 0.20813625578758332,
        -0.10168292430296905, -0.019154215002474537, 0.08627523007317352,
        -0.05879909931645498, -0.03023672167374845, 0.08736842107425313,
        -0.053295006894094034, -0.035037480253350815, 0.08745502227517712,
        -0.04976939167480862, -0.040518273961466476, 0.08832257691861004,
        -0.04404812418238089, -0.044890720051805916, 0.08782441895134589,
        -0.04014918972873916, -0.050151713182501084, 0.08786121966831818,
        -0.034097867594981124, -0.05402613712288089, 0.08678822888968894,
        -0.029883959952831732, -0.05898076245218072, 0.08599199862996114,
        -0.02360356378074384, -0.062297663170129386, 0.08436277731783397,
        -0.019138144629250238, -0.06686380424404852, 0.08274512550600065,
        -0.012733211496275891, -0.069573038241243, 0.08058662542025251,
        -0.008083922731712653, -0.07367440014116851, 0.07817288500041003,
        -0.001660792458241798, -0.07573592468172184, 0.07551995845921512,
        0.0031015492305723354, -0.0793033196026755, 0.07234879172527435,
        0.009436512828200705, -0.08068776671711334, 0.06924362773403803,
        0.014238976856590322, -0.08366029248886298, 0.06536640702631179,
        0.020381159719326462, -0.08434936595411596, 0.06185786160440982,
        0.025149802458104244, -0.08667545721389006, 0.05733783479322153,
        0.030998048159234178, -0.08666369205865579, 0.053575294049950754,
        0.03782168929641833, -0.07359083599759035, 0.01683998808177149,
        -0.06955769942837144, 0.16512686226010806, -0.14089596017887765,
        0.11820361903000252, -0.11450972002900514, 0.07054606681005549,
        0.01828962269323633, -0.08492340303771716, 0.06366362275363509,
      ],
      [
        0.05640596852954758, -0.07253265568582275, 0.03329623613096043,
        -0.035876683401277004, 0.02971200758642267, -0.013578215358896886,
        0.0030837197050621466, -0.00018907693735933665, -0.0002596919994612448,
        -6.108457956973677e-5, 0.00013184430125871878, 0.0001952301801883957,
        6.669952465283651e-5, -0.000127639297711787, -0.00019698588012299626,
        -7.317212961658302e-5, 0.00012238998608760514, 0.000197870707666705,
        7.931344867093084e-5, -0.00011679436987204183, -0.00019790929189696167,
        -8.44690777924275e-5, 0.0001120139619177921, 0.00019846896219970157,
        8.986230256301478e-5, -0.0001072787986493082, -0.0001994266267798523,
        -9.604880829066319e-5, 0.0001014926895611412, 0.0001994226514171777,
        0.0001017541330006039, -9.551429948193649e-5, -0.00019867596925433697,
        -0.00010650145205531326, 9.039004483491002e-5, 0.00019853046999441365,
        0.00011158769485682005, -8.51983766173291e-5, -0.00019867207411815137,
        -0.00011738651590846797, 7.896982131565344e-5, 0.00019777979268344837,
        0.00012256354411248628, -7.270645907464685e-5, -0.00019626245963695922,
        -0.0001268291008605795, 6.731858852228215e-5, 0.0001954134992511852,
        0.00013152765554057293, -6.175163079750124e-5, -0.0001947341617722052,
        -0.0001368432959017478, 5.5182349138628105e-5, 0.00019296867116672106,
        0.00014140855526385008, -4.873611034728116e-5, -0.0001907075432488443,
        -0.00014512670592601378, 4.316881271763468e-5, 0.0001891677292408865,
        0.00014936269927854186, -3.731407974452432e-5, -0.00018767584367577244,
        -0.0001541073345580184, 3.051149151581301e-5, 0.0001850665828821763,
        0.00015798753070905665, -2.3987094683481337e-5, -0.00018210027509876214,
        -0.00016110143758542897, 1.832721074933053e-5, 0.00017989293200486477,
        0.00016480702091315686, -1.2277147044613545e-5, -0.00017761008212893958,
        -0.00016890195906539557, 5.352607154697585e-6, 0.00017420033731893142,
        0.0001720351530374585, 1.1443131981245562e-6, -0.00017057855692743224,
        -0.00017449764031855986, -6.808634820578313e-6, 0.0001677373796277238,
        0.00017761307620371198, 1.295810846445594e-5, -0.0001646980402423733,
        -0.0001809900722052504, -1.9891141852183018e-5, 0.00016054422137447283,
        0.00018332666834469378, 2.6255749971798892e-5, -0.000156326927541365,
        -0.00018510092341218954, -3.1836414375835604e-5, 0.00015289547496149335,
        0.00018757555034489972, 3.7987417542006294e-5, -0.00014914650166581234,
        -0.0001901779527114216, -4.4815251516290614e-5, 0.00014431720287129155,
        0.0001916814812337148, 5.094520522181633e-5, -0.00013957360708582325,
        -0.000192741591492206, -5.6355529375222814e-5, 0.00013560464362899076,
        0.00019453465063449962, 6.240977742211402e-5, -0.0001312045590649951,
        -0.00019631836038180948, -6.902035868487507e-5, 0.00012577941843763406,
        0.00019696604230808273, 7.481745666720123e-5, -0.00012058684247705318,
        -0.0001972973598530698, -7.997350353195134e-5, 0.00011614153704324905,
        0.00019837867044874373, 8.583387713608469e-5, -0.00011115962414626988,
        -0.00019931289603098868, -9.211864091775561e-5, 0.00010522800214898057,
        0.0001990959818528681, 0.0024393674644332983, 0.011872157635305046,
        -0.02775781470052014, 0.020646548475282446, -0.008575490951854808,
        0.0006903072425345532, 0.0006573321754251561, -0.00020762365620691843,
        0.000231078780647244, 0.00010291000998433788,
      ],
    ];
    const result = wavedec(data, "db10");

    const reconstruction = waverec(result, "db10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db11", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49327258770007454, 0.9119796900020305, 1.1966491674039932,
      1.3145363205888558, 1.265164218762199, 1.0785863671356088,
      0.806914705878854, 0.5112432632822981, 0.24716406096302196,
      0.052362105461496944, -0.06077643819158074, -0.10586741174810314,
      -0.11652446315152203, -0.13528007447457419, -0.20030858924419137,
      -0.33336277851196333, -0.5320311862643213, -0.7683545030331914,
      -0.9942658847767998, -1.1526256512234136, -1.1912182550815311,
      -1.0763115922705937, -0.8024348834189765, -0.39590118776870764,
      0.08892348897393212, 0.5798753832247491, 1.0014812458395468,
      1.2903685145036126, 1.408055012307791, 1.3481898961411722,
      1.136629611578783, 0.8244269598378503, 0.4754804485274574,
      0.15183382532195305, -0.0998655215894162, -0.2575680775644983,
      -0.3265937393503821, -0.3354717494284249, -0.326045942290882,
      -0.34043841860556573, -0.40822003721127836, -0.5370679349824539,
      -0.7093163550746311, -0.8853409549107703, -1.013016068224375,
      -1.0409639642457296, -0.9323464416520628, -0.6757700163420196,
      -0.290533025888573, 0.17522016219468503, 0.6531775104710167,
      1.068465489734588, 1.355082148302273, 1.4695980568558706,
      1.3999580746530913, 1.1673657953238183, 0.8208626580318933,
      0.42593328530450825, 0.04986450319357855, -0.25267695585475813,
      -0.4504792617087712, -0.54056778762992, -0.5459600980198018,
      -0.5071329826422935, -0.46946310877227815, -0.4698645484469329,
      -0.5260156062279431, -0.6309047305542408, -0.7540936487196523,
      -0.8494205553464275, -0.8672560957676593, -0.7682732396268619,
      -0.5352810510635799, -0.18010431158551127, 0.25633622111797105,
      0.7109566572701753, 1.1109736009494442, 1.3890661485569433,
      1.4977273676980183, 1.4194588185111685, 1.1704259646712243,
      0.7967277320310426, 0.36417138419147144, -0.056033196208030045,
      -0.4023032898395372, -0.6349438867825847, -0.7428451726533051,
      -0.743187568346273, -0.6744227957399255, -0.5844192838039464,
      -0.5168103668347686, -0.49898703046517945, -0.5347378776723863,
      -0.6033665359903444, -0.6654979251985098, -0.6741149600635767,
      -0.588054033215502, -0.3845520852542153, -0.06763676642255545,
      0.3298619436863873, 0.7513629283957122, 1.1276161365125172,
      1.3913051395449012, 1.491777069741755, 1.4064368050752818,
      1.146103849532475, 0.7530423141285094, 0.2920981330837697,
      -0.16300091374006467, -0.5449971383186721, -0.8065545139178665,
      -0.928739740428944, -0.9226759324668632, -0.8241619654397683,
      -0.6827377680711448, -0.5479929477142147, -0.4565459815732767,
      -0.42291377411398706, -0.43649987184654476, -0.4653973971905124,
      -0.46600417840526415, -0.3959971152489667, -0.227364588972714,
      0.04384260604735424, 0.39359887905323826, 0.7729725077334283,
      1.1176137479429757, 1.361520694135806, 1.4518694234214622,
      1.3613933990415275, 1.0953416828613085, 0.6913075701124823,
      0.21189655288009523, -0.26810786717799173, -0.6771262702507532,
      -0.9611685684766482, -1.093933637845188, -1.0803740462370481,
      -0.9530477816472557, -0.7623020551326235, -0.5627936915085969,
      -0.39969518062508863, -0.2979634429468307, -0.25725616705843,
      -0.2536633691819757, -0.24772605608740006, -0.1966531697351654,
      -0.06760280160797738, 0.1513810366544326, 0.44562137242023714,
      0.7748308411545078, 1.080823350728085, 1.300182397801532,
      1.3789122642979148, 1.2855708885745691, 1.0197005053572072,
      0.613460671968547, 0.12596777124384886, -0.3684287303903756,
      -0.7952654434996017, -1.095008975498363, -1.2345789571980348,
      -1.2127508669364668, -1.0583024954326536, -0.8214948016533096,
      -0.5610524007953757, -0.32985235421597076, -0.1627926927899515,
      -0.06973387464565833, -0.03513049987938044, -0.02430916249660217,
      0.005293640115788756, 0.09084234941738173, 0.25217673807816454,
      0.48433076331811936, 0.7564841221549174, 1.0177489698330588,
      1.2085012205542995, 1.2745780128814737, 1.1809193365007926,
      0.9213158100306993, 0.5218191728202939, 0.03686377831023338,
      -0.461122136243426, -0.896284131797343, -1.2047567744104086,
      -1.34738853461669, -1.3168759491939626, -1.1377344078166018,
      -0.859231304992988, -0.5430673949103839, -0.2488149239086671,
      -0.02061364317623854, 0.12172779687534818, 0.18518844089156095,
      0.19910921807179516, 0.20513701340269297, 0.24416842965429592,
      0.3436509141617831, 0.5085007928523657, 0.7179981535673281,
      0.9295368561163792, 1.0884052676111473, 1.1412647468764652,
      1.0500469124202332, 0.8028397320401461, 0.41901630526177747,
      -0.05278372419878688, -0.5435077450069717, -0.9774279161382322,
      -1.2876334355477872, -1.4297137366337802, -1.390485554590357,
      -1.1897844225035732, -0.8749792578300732, -0.509583351217194,
      -0.15871420543455617, 0.12513233343951574, 0.3126507030486375,
      0.4022193169022834, 0.4174029827728201, 0.3982596109444439,
      0.3887534420370793, 0.4235131978915438, 0.5173129861988748,
      0.659963975600258, 0.817954852704799, 0.9424984023799445,
      0.9820402538543075, 0.8961549620424957, 0.6673713081655774,
      0.3079289427114908, -0.14033646901077496, -0.6131398435322886,
      -1.0363914517787347, -1.3414708366282122, -1.479607375198139,
      -1.4320328576643637, -1.21355705342304, -0.8687644231408793,
      -0.4617672634227187, -0.0619602765172102, 0.2708583902699466,
      0.498523798421965, 0.6109452108013596, 0.6255766199619667,
      0.5802412617179745, 0.5212422981031717, 0.48981886727131213,
      0.5103810400047926, 0.5834899851801993, 0.685356377733456,
      0.7740026479273159, 0.8005703862873252, 0.7229594288802572,
    ]);
    const expected = [
      [
        -0.09422874737809296, 1.7472297146234192, 2.7212302648924798,
        0.8872138633189844, -1.3911160668321993, 1.2074140952294639,
        2.2098145412186643, 2.4615664041081926, -0.8765979121989236,
        -0.08866055752342712, 1.625857728308654, 2.719723457346186,
        1.1373716277587747, -1.420802839633133, 1.085438280592747,
        1.9382669473890437, 2.9934717415668786, -1.1280653839281436,
        -1.6122876936197952, 2.5639311802698033, -0.72459714447583,
        -1.9025049270165157, 2.466695614242312, -0.3330475829113836,
        -2.2207446589072095, 2.4277567380555305, -0.002353390804270019,
        -2.5136716082771344, 2.4245451935714466, 0.24481237611581064,
        -2.7294258215377822, 2.410842262071173, 0.419068480326935,
        -2.837150957903256, 2.335208603192963, 0.5591359845439559,
        -2.8384524621580813, 2.1615343874293718, 0.7157237919239899,
        -2.766425306097744, 1.8848806654196353, 0.9255468270909373,
        -2.660753468991892, 1.5264892170855822, 1.1557281163969388,
        -2.3648952315112077, 0.6344671440047652, 2.029954135482237,
        2.0512040786708963, 2.644846863439855,
      ],
      [
        -1.1227605384808534, 0.8790683326067671, 0.18077542705962335,
        -1.5965520898952723, 0.15506466668356794, -0.3553598889810509,
        -0.5966663544736119, 0.7924644823511007, 1.0231413131272502,
        -1.0229646590488168, -0.05114192394107847, 1.2104470309186366,
        -1.6352001711726223, 0.9980870695775403, 0.31106550978595193,
        -1.3969740607572732, 1.4894591097837233, -0.5309542052226693,
        -0.7742232898669319, 1.496859987857645, -1.1681092502688806,
        0.08072562407811741, 0.9844011880319966, -1.3408996135630213,
        0.8327794664035804, 0.14631259401077426, -0.9747254628635411,
        1.187525310304868, -0.6971763299646109, -0.20454306361489005,
        1.005632321098188, -1.2242516243966566, 0.677489834348794,
        0.35699395925878036, -1.236472375558926, 1.3354701857197528,
        -0.5072400751350006, -0.7493322416291883, 1.4611373203087643,
        -0.9079491252072475, 0.5909610987400159, -0.3503183035097251,
        -0.15669653839806785, -0.44296202092436376, 1.4132836944270637,
        -1.7277660943851894, 1.0128127478131466, 0.3213143992742097,
        -1.37665849724162, 1.4403250583116556,
      ],
      [
        -0.04921793209606641, -0.05357519702007761, -0.00368592138983917,
        -0.025072279558687904, -0.08909292458796136, -0.42224438852118656,
        0.5311930677169034, -0.42211110528466683, 0.2627504017037449,
        -0.09295224670004355, -0.026849037948884272, 0.056713335093019526,
        -0.011413907639953607, -0.04466763328995732, 0.04625685388488843,
        0.007775295472089369, -0.05225499493726979, 0.03449115646690902,
        0.02379269265367058, -0.054128056574548576, 0.020279271366333472,
        0.038122660644817064, -0.05088788908370621, 0.003079380427008984,
        0.04793753378552038, -0.042349819225364994, -0.013473046431077624,
        0.05372992426517652, -0.029774221269727178, -0.02962132089810785,
        0.05338664952531143, -0.014102064896538065, -0.04190031775493535,
        0.048540419286937884, 0.002893362443439819, -0.050904016769152495,
        0.03801713076236268, 0.019631930503644524, -0.053963026334715475,
        0.024575814087250156, 0.03443389621958616, -0.052496534277264535,
        0.007794447511360158, 0.04573752611327574, -0.04497980538957474,
        -0.008849318506137417, 0.05260427913551989, -0.0337750618338345,
        -0.025544954889395947, 0.05406356779036022, -0.018446000257935153,
        -0.03874605991083958, 0.050355358504075735, -0.0020065379319534455,
        -0.04905296725712683, 0.041365989017424665, 0.015324253251684794,
        -0.05349709982396145, 0.028570277147075128, 0.03047433813295863,
        -0.05359984211966271, 0.012568156291021829, 0.0432049110017531,
        -0.04736984103465771, -0.004280370375866665, 0.05095721946984796,
        -0.0388628967392817, -0.029874918338105988, 0.005087067785394986,
        -0.14174617665307723, 0.09765136549945304, 0.10080042478370484,
        -0.04901976335621019, 0.05562747714915531, -0.07029319443617686,
        0.06563593400677367, -0.01823514178874827, -0.0404569546737198,
        0.050094614887587305,
      ],
      [
        0.044857284400718005, -0.03711964418810293, -0.015074324458761666,
        0.0025913329550998586, 0.013736257131881549, -0.014104284696358958,
        0.006493789153992889, -0.0014534629368666385, 1.442477591517808e-5,
        5.971948197763843e-5, 6.301040747521735e-5, 3.228609694201914e-5,
        -2.78808043086785e-5, -6.270969245725755e-5, -4.046795794198564e-5,
        1.8643508638309027e-5, 6.086226447012454e-5, 4.777871249061166e-5,
        -8.71497964935926e-6, -5.724273239944514e-5, -5.368635828406527e-5,
        -1.32063243602529e-6, 5.2176627810210905e-5, 5.8116187997734104e-5,
        1.110462902618641e-5, -4.6050838860798215e-5, -6.130235801952179e-5,
        -2.0732584692361704e-5, 3.8771032079714426e-5, 6.307446638251772e-5,
        3.005346488247035e-5, -3.0272052626033333e-5, -6.304748101926857e-5,
        -3.84884789400889e-5, 2.1027055204806333e-5, 6.13296652422808e-5,
        4.575331096040056e-5, -1.1502252879904955e-5, -5.829931478403261e-5,
        -5.2014811340753784e-5, 1.6643897814763772e-6, 5.390802157546655e-5,
        5.7171614240772786e-5, 8.461003209413478e-6, -4.793677804708093e-5,
        -6.074284735793632e-5, -1.833725613440054e-5, 4.0675985537960776e-5,
        6.260107085496794e-5, 2.7510064890620532e-5, -3.2629581833832696e-5,
        -6.305327902072899e-5, -3.6042882191147355e-5, 2.3842313857584344e-5,
        6.210843031130626e-5, 4.391408310203938e-5, -1.4220196526575484e-5,
        -5.9435630298038835e-5, -5.062354247791047e-5, 4.176899036997767e-6,
        5.5099278819512524e-5, 5.582609681496843e-5, 5.730381511802974e-6,
        -4.9562729160896915e-5, -5.970313057986344e-5, -1.5441236289096162e-5,
        4.2949558428147214e-5, 6.23189655982317e-5, 2.5008499337572465e-5,
        -3.507153114977484e-5, -6.328824476220991e-5, -3.3989809966286725e-5,
        2.6158883304364455e-5, 6.244119333444663e-5, 4.187409234682968e-5,
        -1.6787237918193644e-5, -6.012611797812793e-5, -4.868071865177854e-5,
        7.140977929646842e-6, 5.653017115996223e-5, 5.451432898480349e-5,
        2.8879711193114096e-6, -5.140992072829425e-5, -5.899807284138407e-5,
        -1.2980396199580382e-5, 4.478118636556284e-5, 6.175593540851015e-5,
        2.253702701284217e-5, -3.7149219025578544e-5, -6.296266676958755e-5,
        -3.140363163484547e-5, 2.8800782631919072e-5, 6.283951128631983e-5,
        3.970016779636565e-5, -1.9601133686778333e-5, -6.113313531525101e-5,
        -4.71164275089773e-5, 9.702441409999672e-6, 5.764762684625197e-5,
        5.312956834546073e-5, 2.994200757000805e-7, -5.2738667194280844e-5,
        -5.770808265873171e-5, -1.009287143208924e-5, 4.675451919838491e-5,
        6.106830704283162e-5, 1.9783409638657637e-5, -3.956552562320978e-5,
        -6.299033949420429e-5, -2.917165080120891e-5, 3.114053163428636e-5,
        6.310174104745401e-5, 3.766929468232105e-5, -2.1980800141308956e-5,
        -6.155162927842507e-5, -4.503762810935168e-5, 1.2512635065670219e-5,
        5.869553337065161e-5, 5.14463727011953e-5, -2.673286772675626e-6,
        -5.4437284813577014e-5, -5.674302801481249e-5, -7.4725011650557686e-6,
        4.857527509052081e-5, 6.0440123620358996e-5, 1.736143067448326e-5,
        -4.143952668535352e-5, -6.245466565831033e-5, 0.018062786789121647,
        -0.015292750361879524, -0.005686317239184182, 0.0017259834368406714,
        0.0043557411575745, -0.005164217133548643, 0.00252993264208601,
        -0.00055165632009343, 8.571732718633702e-5, 4.025697941070227e-5,
      ],
    ];
    const result = wavedec(data, "db11");

    const reconstruction = waverec(result, "db11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db11_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5127924304400311, 0.9415250306254546, 1.220601048240946,
      1.316757598842689, 1.2349400668439907, 1.014841492017139,
      0.7191708836901032, 0.4168263384077408, 0.1654195720697173,
      -0.0023010277848213856, -0.08467287474135296, -0.10852252369437944,
      -0.118649200948375, -0.16239998684423174, -0.27365117804812455,
      -0.46066098354586327, -0.701217703978804, -0.9465501543061641,
      -1.1331105516420923, -1.199207507859667, -1.1021230995243934,
      -0.8311512662417868, -0.41300167857181264, 0.09203622613390652,
      0.6023886972126598, 1.032975397084169, 1.3140594997737296,
      1.4064676726085557, 1.309402617173854, 1.0589727094154122,
      0.7179452714090546, 0.3594703011439217, 0.04903610369958228,
      -0.17068580343651435, -0.2882710239617517, -0.3232316165889595,
      -0.31728301832469863, -0.3197413080488822, -0.37114847570527765,
      -0.4896728851316456, -0.6640692788202418, -0.855210328332271,
      -1.0058890929429427, -1.056350825157407, -0.9614370442504623,
      -0.704733700508526, -0.3058424452433701, 0.1813472871288665,
      0.6791761675426367, 1.1030195670218144, 1.3802207030076858,
      1.4664135196663675, 1.3551441587022846, 1.0784084310622268,
      0.6980469172412304, 0.2902729529992008, -0.07265650275720842,
      -0.3389321261496132, -0.48769066470089095, -0.5309846928981319,
      -0.5069573353569525, -0.46627713226916767, -0.45565098346513855,
      -0.5029744890108685, -0.6082060795836053, -0.7424914229007669,
      -0.8558316015787822, -0.8912739079678572, -0.8018210000891135,
      -0.5654761081350639, -0.1942779853368955, 0.26528136274362,
      0.7408220987131202, 1.1496355346423501, 1.4173956993906087,
      1.4953227370612963, 1.3714573789006341, 1.0731942564632004,
      0.660451946295418, 0.21124811628202367, -0.19662417321470227,
      -0.5031597521425151, -0.6785349342758138, -0.7273160534192141,
      -0.6836365782710312, -0.5988692849908381, -0.5252731529369824,
      -0.5001162841876966, -0.5346003539846031, -0.6105886982025636,
      -0.686021303677808, -0.7075473467595681, -0.6269427355598003,
      -0.4168269927251482, -0.08133168670329732, 0.34133144083014977,
      0.7853388422696586, 1.17131585400048, 1.4245263865951323,
      1.492602659604584, 1.3582926035708716, 1.0439477297727802,
      0.6065754259754015, 0.12468959535716143, -0.31971599139216994,
      -0.6595210019278155, -0.8565640816942602, -0.9080133716304034,
      -0.843609596425992, -0.7147565962072258, -0.5785473704309656,
      -0.4810996001486665, -0.4446985254690472, -0.46217853423804917,
      -0.5000028444955864, -0.5091464164253121, -0.4407742534154235,
      -0.26239525278480724, 0.029990783256962583, 0.40720306412537216,
      0.8111393788979926, 1.1671098078867306, 1.4012134605214248,
      1.4583530024875828, 1.316253689294156, 0.9918359003999049,
      0.5382294881303297, 0.033110020507733845, -0.43874247270449107,
      -0.8042915638371944, -1.0177918477060097, -1.0692109498802862,
      -0.983570443989257, -0.8116145797808839, -0.6144559949955901,
      -0.44637761763804146, -0.34039147360658584, -0.30036184228133295,
      -0.3017055246848373, -0.30036248927121245, -0.2475000412163843,
      -0.1058630094176739, 0.13677811740663315, 0.46087661878233466,
      0.8170834095817161, 1.136652874600057, 1.3477295261779891,
      1.3933629366544902, 1.246579082032805, 0.9185401306372769,
      0.4575718328863152, -0.060826144345295, -0.5505556865511616,
      -0.933959353610518, -1.1585766049021298, -1.207475107453108,
      -1.1006893799125128, -0.887604087877602, -0.6324517141526577,
      -0.39684455248710254, -0.22397333067596592, -0.12859685773651947,
      -0.09535738082370668, -0.08570742818523007, -0.051421133533905095,
      0.04910230547028904, 0.23628688764856537, 0.5006625591916809,
      0.802512773853021, 1.0801826830037244, 1.2650170083983783,
      1.2990926752963374, 1.151108565007833, 0.826209105474452,
      0.3670459729796379, -0.15437372008571956, -0.6521292504756322,
      -1.0453093075515298, -1.2757051427810557, -1.319879767655126,
      -1.1926725131298028, -0.9414078844340986, -0.6324657923021182,
      -0.3338132709079736, -0.0980897176359869, 0.04937718599372326,
      0.11460795962473483, 0.13018686210137023, 0.1431427834766178,
      0.1989344996806235, 0.3260101233457468, 0.5252481402591573,
      0.7672752211078602, 0.9985409616022607, 1.1546708434635957,
      1.1776400048111237, 1.0322365478564661, 0.7174012741770979,
      0.2693147749238719, -0.24478024061858036, -0.7406362092668404,
      -1.1355020683358092, -1.3664671448544137, -1.4040705372737308,
      -1.257808791007615, -0.9722543779992986, -0.6149040897722844,
      -0.25898188729277644, 0.03432339042836835, 0.2296237759374769,
      0.3236495446324209, 0.3426714386228714, 0.3319509604651245,
      0.3402517574462477, 0.4037392626445921, 0.5337344407823548,
      0.7117358413917784, 0.893161316296393, 1.018906284336608,
      1.0316925382997932, 0.8928530566910572, 0.595018196576427,
      0.16718901164390337, -0.3293598133142551, -0.8135228503553352,
      -1.2021446531668698, -1.428718612947931, -1.458315837223048,
      -1.2950033293958385, -0.9799280670523958, -0.5806310352432429,
      -0.17439017476270086, 0.17010874012548477, 0.40809831629432497,
      0.5272202552214832, 0.5471835354177319, 0.51093662063175,
      0.46993440697520067, 0.46761796362003544, 0.5256627046825817,
      0.6367757610353808, 0.7660430061936916, 0.8605124971560186,
      0.8644667961269465, 0.7362738638957298, 0.4622304736388224,
      0.0635527565447706, -0.4055655197817887, -0.8685765930944173,
      -1.243351370729146, -1.4609327431117554, -1.4815439417080964,
      -1.3037964050094735, -0.9647665724767183,
    ]);
    const expected = [
      [
        -0.319826194909436, 1.712545714051483, 2.7177504710080105,
        0.7231846671936863, -1.6148009857317647, 1.0297845516774977,
        2.2471503820217835, 2.356275321468919, -1.0157322867686454,
        -0.31442205678074653, 1.5765390717332102, 2.7245322450501708,
        0.9903290197150578, -1.6714899386477602, 0.9699790318983778,
        1.8273464721886488, 3.1206964425832155, -1.6262546796815032,
        -1.063892209368904, 2.7864178014639838, -1.9678329839549917,
        -0.6472029170953147, 2.674005668552621, -2.2624876885811895,
        -0.21403420468968337, 2.49745790423507, -2.503835545873823,
        0.22529665824646328, 2.2608661050631946, -2.6860069085105933,
        0.6603087573075065, 1.969763192995595, -2.8045368337818806,
        1.0806078609600496, 1.6309930027803339, -2.856473676006295,
        1.4761332951471073, 1.2525514439284737, -2.840440769394419,
        1.8374812196416648, 0.8432858931211058, -2.7611700877569847,
        2.1855351581365583, 0.3125795962060715, -2.3823655983178487,
        2.047087018480723, 0.5125812285700788, -3.0283655395956393,
        -3.4190895850961422, -3.772656462403305,
      ],
      [
        -1.0521494422880748, 0.8178882486765549, 0.13119917730190067,
        -1.5835910317707504, -0.028915803884314653, -0.456240769833815,
        -0.4907668278527767, 0.7906321528487947, 1.0977265431032681,
        -0.8473180966008521, -0.5291270804467336, 1.5046916396124947,
        -1.18811288572657, -0.11805095592328742, 1.24154739785951,
        -1.1855188434652428, 0.02655480234342126, 1.152546377590303,
        -1.258555819837455, 0.19742825887076562, 1.0425614431486625,
        -1.3111233928460082, 0.36305513016542706, 0.9178790832581344,
        -1.342706569489326, 0.5208731586602856, 0.780681087158348,
        -1.353159270163856, 0.6685605213449684, 0.6333020563021841,
        -1.3426701024606638, 0.8040015620202979, 0.4781880971594753,
        -1.3117509395997629, 0.925315041357045, 0.3182444530957987,
        -1.2497110420171431, 1.1295831635389937, 0.6138130404620208,
        -0.1401581958100441, 0.22121913870778656, -0.38415548567024527,
        -0.2142045188600092, -1.24932880152611, 1.065837512210362,
        0.19661651833495988, -1.4035593249557239, 1.3731807013220017,
        -0.08318231701211092, -1.288428932376549,
      ],
      [
        -0.06544205776515018, -0.04601884259152598, -0.00465668207588357,
        -0.04049491292113085, -0.06784432793356537, -0.47006456610470193,
        0.5786325059430686, -0.4582167493629761, 0.2898271496466376,
        -0.10970426305223509, -0.027711971393480275, 0.07867668245254855,
        -0.040555245453543734, -0.03681560797499453, 0.07482214887429335,
        -0.03436160045633948, -0.04140578627711257, 0.07380623563400994,
        -0.0304571520260152, -0.04468860876443847, 0.0740316715163885,
        -0.025943027679243336, -0.04884729091065201, 0.07247556856707932,
        -0.021704692420431045, -0.0516821048415195, 0.07209710659881505,
        -0.017122047987551504, -0.05552723910488002, 0.07002157666681484,
        -0.012614357753288062, -0.057874920220715435, 0.06903904816701036,
        -0.008035259936935569, -0.061341502437092826, 0.0664822010613348,
        -0.003327927218048386, -0.06317108697004395, 0.06490525692632004,
        0.0011766139243523134, -0.06619947124707193, 0.061912182862314605,
        0.006009771198856371, -0.06748850494739234, 0.05976027807598525,
        0.010370902115543177, -0.07002546875531826, 0.05638221878181677,
        0.015253123582834021, -0.07076021271783303, 0.05368443100968112,
        0.019405189689991758, -0.07275993141302926, 0.04997787026435578,
        0.024258004910517966, -0.07293542493025494, 0.04677255245532701,
        0.02813952011650003, -0.07436033703875, 0.04279824289933135,
        0.03288403018863194, -0.07398032011034844, 0.0391325127928665,
        0.036438596077974984, -0.07480034536863986, 0.03476348272161649,
        0.036217328321094054, -0.11195525751240398, -0.0847592172067704,
        0.4044754785875779, -0.3850826615203097, 0.024069704103643407,
        0.20550177517597315, -0.12920894376266034, 0.030649417470049817,
        0.0591513121800537, -0.08371238723568139, 0.032540716957478406,
        0.044512951206243656,
      ],
      [
        0.04678502924921445, -0.038566893028319775, -0.015835621746378686,
        0.002495176186117065, 0.014677199388765617, -0.014859166612200778,
        0.006759706252551416, -0.0015336421356733933, 1.908303650380277e-5,
        9.632589045481329e-5, 9.180867292079099e-5, 2.1299402863608047e-5,
        -7.021967040737313e-5, -9.281092609483622e-5, -2.4218413345592648e-5,
        6.825598554451152e-5, 9.38296131459048e-5, 2.7383114014701514e-5,
        -6.586978517446898e-5, -9.441409613390395e-5, -3.0287784050425763e-5,
        6.347778679865063e-5, 9.477351232339769e-5, 3.287568609610096e-5,
        -6.13846979954479e-5, -9.537339353462078e-5, -3.564277277020711e-5,
        5.9201566067879383e-5, 9.603951637025823e-5, 3.867885389203645e-5,
        -5.65978649960226e-5, -9.629190947420792e-5, -4.1489668161415365e-5,
        5.3941363604718075e-5, 9.626686106621577e-5, 4.394194689908053e-5,
        -5.159556905647624e-5, -9.645428862760728e-5, -4.6514508534745146e-5,
        4.922546661188812e-5, 9.675540076389545e-5, 4.9372638034613025e-5,
        -4.644632626974184e-5, -9.667237777057414e-5, -5.20453414372365e-5,
        4.356818506742871e-5, 9.626539401885694e-5, 5.4325986232251945e-5,
        -4.100466907678942e-5, -9.60370242440436e-5, -5.6664773714936905e-5,
        3.8482740940032706e-5, 9.596627256675806e-5, 5.9298486074122386e-5,
        -3.557269646333252e-5, -9.554938630224902e-5, -6.17906489326472e-5,
        3.25194412987751e-5, 9.476898605838269e-5, 6.386619090211519e-5,
        -2.9776841752648857e-5, -9.412827551996565e-5, -6.593589969983271e-5,
        2.714039527428916e-5, 9.368455883547565e-5, 6.830236706160096e-5,
        -2.4145731203718935e-5, -9.294021073825762e-5, -7.057406588516678e-5,
        2.0966784544327214e-5, 9.180071756299269e-5, 7.241405075702731e-5,
        -1.8086821195092798e-5, -9.075787159293935e-5, -7.418384460515822e-5,
        1.537479162635816e-5, 8.994591040467597e-5, 7.624458776787706e-5,
        -1.2342797261596766e-5, -8.888525291121793e-5, -7.825905424246425e-5,
        9.089662927380346e-6, 8.740651989710373e-5, 7.983647251160879e-5,
        -6.116510680209373e-6, -8.597832808536826e-5, -8.128043082104574e-5,
        3.36890486459552e-6, 8.4808643298524e-5, 8.300195796912221e-5,
        -3.471214411060792e-7, -8.344741645592788e-5, -8.472618539690437e-5,
        -2.927466076162937e-6, 8.165446640624009e-5, 8.601785410436903e-5,
        5.947849727086884e-6, -7.986402767049833e-5, -8.711533687599374e-5,
        -8.690523835279744e-6, 7.835282733150503e-5, 8.846969913127111e-5,
        1.1655052083911205e-5, -7.67111320119325e-5, -8.987499606689456e-5,
        -1.489799923544214e-5, 7.463371967032099e-5, 9.086188720215762e-5,
        1.7918582476629362e-5, -7.251006171644707e-5, -9.159781267410772e-5,
        -2.061589285476633e-5, 7.067903624795164e-5, 9.256306705839938e-5,
        2.3477351716105343e-5, -6.878104697312346e-5, -9.362554856334369e-5,
        -2.6636083771491656e-5, 6.645315137774126e-5, 9.429305973890194e-5,
        2.9609493572909717e-5, -6.403075078704817e-5, -9.465809152418232e-5,
        -3.222165999055723e-5, 6.19067789105727e-5, 9.521866337269285e-5,
        3.493617114976672e-5, 0.008050264711554593, 0.05253011513951183,
        -0.1120548524159282, 0.08801556781931774, -0.055212529143538185,
        0.023393366483273934, -0.004720112322053956, -0.0004811919080316333,
        0.0005560367854218601, -0.00012824418671425946, -9.824388111814547e-5,
      ],
    ];
    const result = wavedec(data, "db11");

    const reconstruction = waverec(result, "db11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db12", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.508283301940541, 0.9374075872577399, 1.2244238631033735,
      1.3350345185900483, 1.2694130610874486, 1.060155129712835,
      0.7630143495984798, 0.44280471695300516, 0.15798296550976654,
      -0.052315857496098905, -0.1756880518173316, -0.22664667529284704,
      -0.23974681639092105, -0.25759249758310815, -0.3169462030215179,
      -0.4366250694367383, -0.6104004358057178, -0.8068372980060413,
      -0.9762373727600987, -1.0630270600867844, -1.0205156623842513,
      -0.8242954447186277, -0.4808303204547214, -0.028920395041819452,
      0.46654350128228733, 0.9272328882297602, 1.2775565021606012,
      1.460584589254272, 1.4499812383410609, 1.255146461137704,
      0.9183946221561979, 0.5049041151025407, 0.08789679532243166,
      -0.26737752740173504, -0.517038214754939, -0.6462347335185921,
      -0.6694069022424659, -0.6233286731330967, -0.5549046558002801,
      -0.5069678145878797, -0.5057848151998758, -0.5535015802926002,
      -0.6274768509528132, -0.6866786715412355, -0.683501785990136,
      -0.5779579865516811, -0.3505493972137015, -0.010419515985005456,
      0.40347897191069465, 0.8287386687572401, 1.192039636710203,
      1.4249842406393665, 1.4794710101737234, 1.3389129041850898,
      1.0225714414017346, 0.5819165534506622, 0.08983168726088672,
      -0.3748036989200932, -0.7435264834920734, -0.9718585258349945,
      -1.0469167341296262, -0.9874271321668633, -0.8363705904050579,
      -0.6482797571514487, -0.4744838801989952, -0.35004771939617574,
      -0.28566553284015195, -0.26647615347630405, -0.2579861910602666,
      -0.21747082298134401, -0.10781989977619255, 0.0898382772239405,
      0.3681125836378508, 0.6921557806900086, 1.0058179486957566,
      1.2438025012536307, 1.3469407452345423, 1.2768663098597721,
      1.0264526729825232, 0.6233600293282717, 0.12568317739742052,
      -0.3894032236352927, -0.8414098454787449, -1.1630464705205283,
      -1.3136423162177082, -1.2863844294645874, -1.107787231428444,
      -0.8296860013626594, -0.5158425182345586, -0.22652153513074125,
      -0.004832165565369251, 0.131874363163795, 0.19357050444039053,
      0.21189260135904103, 0.2288897271669723, 0.28321696366748006,
      0.3974403158509914, 0.5698253519518679, 0.7728345958988159,
      0.9588465079442772, 1.0717594159935715, 1.06161960782444,
      0.8985963905056992, 0.5827254213193752, 0.14683521490379872,
      -0.3482817476429113, -0.8254972926057943, -1.207143980080025,
      -1.4313069743932494, -1.4647895809099885, -1.309712859015637,
      -1.0022324233392668, -0.603745467506829, -0.18675453649062407,
      0.18118783265363653, 0.45161454521234756, 0.6040465218188007,
      0.6476826309914383, 0.6157044311060617, 0.5538552468907323,
      0.5063559483199204, 0.5028469912202977, 0.5497448039216937,
      0.6282485893414496, 0.699520718836999, 0.7157192461395894,
      0.6340465882126426, 0.4301740246684745, 0.10751080719874023,
      -0.3002143847356286, -0.733948426345763, -1.1208921438298403,
      -1.3900155337702074, -1.4878492071469962, -1.390771047586334,
      -1.1108138707482325, -0.6935584653050297, -0.20857043559485366,
      0.26537564507509176, 0.6568028634390413, 0.9158987231622756,
      1.0234256787139004, 0.9922173620126873, 0.8611276591712034,
      0.6831406472847823, 0.5107518919129898, 0.38235147356232996,
      0.31302686583218525, 0.29204144944579374, 0.2875248864243232,
      0.25706560251518307, 0.16138489117744192, -0.022525522986947988,
      -0.29230512397475916, -0.6176667832488067, -0.9452417874892916,
      -1.2098207285705571, -1.349349392105134, -1.320048709633504,
      -1.1079312161678623, -0.7338120108294366, -0.2504603076091144,
      0.2675706301457945, 0.7391266981005444, 1.093126723107985,
      1.2828454590603504, 1.2945091686769448, 1.1482910105557602,
      0.8916354390990217, 0.5866875633865242, 0.29500127206826443,
      0.06330714498258488, -0.08620782969014429, -0.15883558683360163,
      -0.18295644903757532, -0.19963450123449117, -0.24902205030299157,
      -0.3571904363721173, -0.5268842505380441, -0.7346923417552722,
      -0.9354928299227333, -1.0731694253652146, -1.0949776924849144,
      -0.96596824213772, -0.6797948257815954, -0.2630732315178901,
      0.22799165408937316, 0.7181092661464684, 1.1281838677530844,
      1.3918316672685225, 1.4692663185235815, 1.3552989074918318,
      1.0796054802531803, 0.6992698832092951, 0.2854570908062971,
      -0.09254058479134014, -0.3820537928609224, -0.557104307788365,
      -0.6215134431887616, -0.6045226530373138, -0.5502610302887213,
      -0.5039083426708933, -0.4981930113006304, -0.5437381553688534,
      -0.6257599320940247, -0.7079848929912319, -0.7427972904822511,
      -0.6850178758741323, -0.5057562600663604, -0.2027114222937837,
      0.19586024698237947, 0.6347396399449008, 1.0422595043742378,
      1.3453641602115887, 1.4856793487543198, 1.4327584824445532,
      1.1913119310953455, 0.8006510880647324, 0.32644050224970467,
      -0.15330697474314064, -0.5646869159287308, -0.8529435321687366,
      -0.9926049284534669, -0.9904518872288979, -0.8808277414576734,
      -0.7146703004755364, -0.5451621234390676, -0.4136801801197687,
      -0.33958953264779934, -0.31640643663902274, -0.3152115806782695,
      -0.2943363843776023, -0.2127391139590382, -0.04353476720056926,
      0.21591789953059937, 0.5401205363996838, 0.8789315546127336,
      1.167793625697146, 1.342318090941123, 1.3537154716702722,
      1.1812870600386038, 0.8388533579759478, 0.37343210341200017,
      -0.14365949710911186, -0.6312739708644548, -1.0151221540635047,
      -1.2427949357230015, -1.293642580370122, -1.1812898482244076,
      -0.9483529695243211, -0.6548061180334916, -0.362957862206617,
      -0.12277174109659506, 0.038887247731927366, 0.12253422032325526,
    ]);
    const expected = [
      [
        -1.20969299477262, 1.4179476893880418, 2.7209537782611255,
        1.4267555843953705, -1.829259379956726, -1.1368440675694487,
        1.3785874337931288, 2.755664881451317, 1.3975898661630286,
        -1.7824166345759538, -0.9717242556503808, 1.3428103056021523,
        2.7609896923056514, 1.4211290123808327, -1.9270870455330404,
        -1.0925002049700725, 1.5549614246918737, 2.4326522148873924,
        1.8967969386422263, -2.9036203789550106, 1.4190908069019745,
        1.3252107843413563, -2.9256611390916913, 1.9692221898735047,
        0.7193155902398106, -2.79103566808969, 2.4281595387058252,
        0.05970953682125539, -2.5010094175873396, 2.7608024738644765,
        -0.6103048109222958, -2.07159960874398, 2.942382542628073,
        -1.2451092504473968, -1.5320908112454734, 2.9619865652077135,
        -1.8026610582945888, -0.9212458703064056, 2.8237438857521124,
        -2.2497399938374483, -0.28201239175534126, 2.545679471909448,
        -2.566475776118487, 0.3450422945277928, 2.1672654250952563,
        -2.8165270225049523, 1.1738658529875015, 1.0563715207641167,
        -1.5039172320616376, -0.6993704693823045, 1.0075857986401722,
        -1.367146669757194,
      ],
      [
        -0.4863915408113533, 0.1608200773022801, -0.9259811247547697,
        -1.4447512504470141, 1.136613845431017, 0.21891715964655367,
        0.32227447609870186, -0.8736832788415552, -1.4778361743594872,
        1.0321476920154784, 0.22794875284074084, -0.7777732662057721,
        0.32087607613822305, 0.6299866997817225, -1.23521974970215,
        0.9849098777585168, -0.05043868150335957, -0.8946755559799592,
        1.189641010476946, -0.6486273308470794, -0.3313661064387037,
        1.0631801187878653, -1.0463764705597574, 0.3027821397674045,
        0.6478720431784244, -1.1470116640679713, 0.8467871724783822,
        0.050551506104424014, -0.9253931599889849, 1.161851855262889,
        -0.5773264783023642, -0.43539342164359074, 1.1649793402638102,
        -1.0762075661074433, 0.20300019862756247, 0.8491197006853887,
        -1.3169170489102338, 0.8318262320301265, 0.27620889827792616,
        -1.278597838647738, 0.9936024320803215, -0.8702968385881231,
        0.7693115728743212, -0.5384751815411691, 1.4004472954352527,
        -1.882824694999969, 1.382251466646386, -0.06288643277334588,
        -1.2215621849483187, 1.5690328555522302, -0.7279641194902993,
        -0.676112853703686,
      ],
      [
        -0.05860126193925269, 0.09455923502069205, -0.1098399151961534,
        0.05530258721615214, 0.04212812503437366, 0.16878035272399156,
        0.23383868173852074, -0.32984733561197005, 0.2028613818874996,
        -0.040053337703711375, -0.06187528451388156, 0.0707678621545313,
        -0.015890352645365792, -0.039275483286604386, 0.04237059470287586,
        0.004737165039909592, -0.046553197570304884, 0.034638453775081075,
        0.01672444890864478, -0.04877374399051305, 0.025324021807726176,
        0.027342002850612047, -0.04887170408318014, 0.01403025748411695,
        0.036716560486436955, -0.04517633638003469, 0.002256175071591406,
        0.043380872397543756, -0.039570992686739755, -0.009943853451137737,
        0.047972319713071976, -0.030758973442064335, -0.021335637738680885,
        0.04904165580924135, -0.020868919224285857, -0.03155560291634349,
        0.047812585252994234, -0.008963651448481155, -0.039830844141098574,
        0.0429678836287903, 0.0027751596892862194, -0.045639922080456426,
        0.03628058883200263, 0.015005567669099294, -0.04882517105728361,
        0.026604380639706576, 0.02572436546292453, -0.04882769665868598,
        0.01613139649513773, 0.03542439715279801, -0.0461811164212507,
        0.003852724754320204, 0.042509044970190146, -0.040350006810184656,
        -0.007825599228595352, 0.04741435789887572, -0.03253757963637957,
        -0.019859541636842927, 0.04913155587040841, -0.022221953434504983,
        -0.02987426962978261, 0.048107060339819534, -0.011157070531150854,
        -0.03887386905386433, 0.044019727732598046, 0.0012339626873742935,
        -0.044821096434684675, 0.036887925311200484, 0.010967236890587768,
        -0.06195409864576541, 0.0022054087323275223, 0.08535519236670687,
        -0.09814556303457372, 0.09173401243940232, -0.0454532252107882,
        -0.016051882790454615, 0.050388238381897064, -0.028206648853721268,
        -0.02490818958722782, 0.0489323686629819, -0.01720418227367713,
      ],
      [
        0.036748192248151325, -0.008210752762041796, -0.05885693914710919,
        0.0443422508691917, -0.014004475659004537, -0.00429459764307751,
        0.006771677052454902, -0.0031699764659862627, 0.0006759471604186784,
        1.0729322035719768e-5, 9.238191108985078e-7, -2.2016552115553418e-5,
        -3.3174283915195524e-5, -1.34599547042661e-5, 1.880193337842209e-5,
        3.361225765410147e-5, 1.71877359305225e-5, -1.522128293617021e-5,
        -3.350286891906995e-5, -2.067199437611867e-5, 1.1342423199799429e-5,
        3.278736526357517e-5, 2.3742801079631175e-5, -7.364421711643316e-6,
        -3.1599849068021905e-5, -2.642462295946376e-5, 3.3490088660871125e-6,
        3.0031683602629935e-5, 2.8801115040959087e-5, 7.827621959227011e-7,
        -2.7991150884924858e-5, -3.0778038078363314e-5, -4.984010506975523e-6,
        2.5423856566446262e-5, 3.2194843582462575e-5, 9.052567407224659e-6,
        -2.2475434925802093e-5, -3.307445502605694e-5, -1.289619629685721e-5,
        1.9287268926627956e-5, 3.3538656958575264e-5, 1.6591606923033983e-5,
        -1.5811311927737253e-5, -3.355008287474766e-5, -2.012717305903558e-5,
        1.1993726005879887e-5, 3.29702322598261e-5, 2.331868815930283e-5,
        -7.97787523433546e-6, -3.18237501715781e-5, -2.60594448299992e-5,
        3.940401162651622e-6, 3.026804644171949e-5, 2.843216157866078e-5,
        1.3056763648733489e-7, -2.8325587800577174e-5, -3.047199189873609e-5,
        -4.296424259082425e-6, 2.5885790966405417e-5, 3.203100993069241e-5,
        8.433514832835669e-6, -2.2972252744459584e-5, -3.300206361416286e-5,
        -1.234937333707976e-5, 1.976795283636465e-5, 3.34785795607264e-5,
        1.6031252428241995e-5, -1.6349599033958968e-5, -3.354809525793195e-5,
        -1.9557670411148212e-5, 1.2633383791092635e-5, 3.311128911010132e-5,
        2.2842333250706103e-5, -8.633575819001418e-6, -3.2069734261960174e-5,
        -2.5697413299692587e-5, 4.54231527141695e-6, 3.052652904386397e-5,
        2.8097774913025938e-5, -4.777506502844511e-7, -2.8619329840587035e-5,
        -3.014674827372728e-5, -3.623826781709313e-6, 2.6301811405290056e-5,
        3.1809565344204956e-5, 7.769174787193297e-6, -2.3487114583949504e-5,
        -3.292075874931875e-5, -1.1777031938336698e-5, 2.0280555469616032e-5,
        3.3452389310328215e-5, 1.5505003953406295e-5, -1.6859501515070177e-5,
        -3.353541356663417e-5, -1.9006154097145e-5, 1.3226880315222318e-5,
        3.319417287067903e-5, 2.2320229925445026e-5, -9.30413933257244e-6,
        -3.229749687810614e-5, -2.529686419725006e-5, 5.185970238869049e-6,
        3.0819138220146514e-5, 2.7787384169345925e-5, -1.0724035244190066e-6,
        -2.89137499830057e-5, -2.984310443692506e-5, -2.9947195608837744e-6,
        2.6664005313692578e-5, 3.154554274268318e-5, 7.093183037267988e-6,
        -2.3977538249119606e-5, -3.279145755150736e-5, -1.1154623125709497e-5,
        2.0828221373989304e-5, 3.344105014145774e-5, 1.4977071328788847e-5,
        -1.7383474061618634e-5, -3.354916159881328e-5, -1.8493819341208775e-5,
        1.3775128309963843e-5, 3.324178419880959e-5, 2.1790750744674038e-5,
        -9.946795868130514e-6, -3.247223552315046e-5, -2.4840948525551176e-5,
        5.865547857080906e-6, 3.1119201268014467e-5, -0.0015911522332528283,
        0.0013728641281636287, 0.0004874184832218786, -0.0008526707586012668,
        0.0012688590155363229, -0.0009683223157593957, 0.0002234882139975337,
        7.375930544013538e-5, -1.4105955327474607e-5, 2.914344735102168e-5,
        -7.412941128195953e-6,
      ],
    ];
    const result = wavedec(data, "db12");

    const reconstruction = waverec(result, "db12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db12_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4959543637692236, 0.9140795202014957, 1.1931215177159,
      1.3009910991972853, 1.240375064164147, 1.046114349252042,
      0.7751371448232199, 0.49157161855609155, 0.25083093572531734,
      0.08667145812485993, 0.00442402782687662, -0.01800637364070104,
      -0.02177737159303511, -0.053675090237526424, -0.15119916421906443,
      -0.3301346759351534, -0.5779415911588194, -0.8548014846449543,
      -1.1021948956080727, -1.2569392466815077, -1.2671903764857637,
      -1.1063638193479552, -0.7814064440087829, -0.33322841801933456,
      0.17095555860135866, 0.6516152110987213, 1.0338850253676592,
      1.2634494393375393, 1.3175175460743853, 1.2082938957100477,
      0.9782172699409911, 0.6882788296774827, 0.40243231303118754,
      0.1720453752196736, 0.024279517638066406, -0.04275475421293701,
      -0.056974875405890045, -0.062364009835557704, -0.10477456077135416,
      -0.2172830742604674, -0.40899397134052584, -0.6603041586352749,
      -0.9259825544946971, -1.1454083457176678, -1.257459385336882,
      -1.2163182407487685, -1.004180297180906, -0.6375808425000018,
      -0.165624455817815, 0.3395923464428986, 0.7981299548500094,
      1.1392990162375876, 1.3165826005291887, 1.3168090868617728,
      1.1614264882372232, 0.899689656261406, 0.5955714938027784,
      0.3117457349997892, 0.09467717886943011, -0.03547501456259511,
      -0.0876975463668461, -0.09513562461003967, -0.1037139926927858,
      -0.1574352665489196, -0.28426978838693406, -0.48639493723501903,
      -0.737423930304026, -0.9874681784267894, -1.1748587687248473,
      -1.2416239846477886, -1.148820532257021, -0.8878019553752449,
      -0.4844854937505316, 0.004595418866006083, 0.5036248214146318,
      0.9335530549404003, 1.229009046722652, 1.3520032500620422,
      1.2991429943630521, 1.1006925821155544, 0.8118321590346197,
      0.49839409426619313, 0.22070023470167793, 0.019551626339799677,
      -0.09217067954978064, -0.130296343795753, -0.13250818712527124,
      -0.14575384003163805, -0.21130504950495138, -0.35143796085621637,
      -0.5612861616919684, -0.8080875902042952, -1.0381441949810641,
      -1.18982213163526, -1.209345925277211, -1.0653831684319408,
      -0.7586714229069982, -0.3241448992307375, 0.17512633653204795,
      0.6608333971287463, 1.0561017203300838, 1.3019312989923362,
      1.3694453892677128, 1.2650266466327493, 1.027183672480517,
      0.7160380772704791, 0.3981380935648713, 0.13043401840336782,
      -0.05258853186388818, -0.14546668331108892, -0.1704932274315767,
      -0.1691162483603629, -0.18837022931289749, -0.2659666390422609,
      -0.41800596190886813, -0.6325937951328418, -0.8711236745948977,
      -1.077014426907287, -1.1897613125489792, -1.1607680261221849,
      -0.9669255949146414, -0.6184242217350289, -0.1586970153983465,
      0.3436536355416008, 0.8090961747517031, 1.1641806849118275,
      1.3572242149736624, 1.368895520039001, 1.2151864302810376,
      0.9421435425012843, 0.6137705107918492, 0.29618647098874257,
      0.04202021919992627, -0.12108977153721046, -0.19510166221413355,
      -0.20827376595921349, -0.20497969268735014, -0.2314050914557792,
      -0.3209391537856806, -0.48314122969741596, -0.6992377684088473,
      -0.925422402892056, -1.1032193692517052, -1.17433857236135,
      -1.0962652124936356, -0.8545906425054123, -0.4688669860297273,
      0.009636857494740261, 0.507886055465272, 0.9464192016333322,
      1.2564041117777842, 1.3942984482030436, 1.3505896508693471,
      1.1505535641319375, 0.8469469141803021, 0.5065390533667085,
      0.19389357338640262, -0.04354632091655858, -0.18539251696708825,
      -0.2408908341487607, -0.24365963873478955, -0.24010693980676034,
      -0.2746518755444974, -0.37568127032446164, -0.5459711961229141,
      -0.7601488833701167, -0.9699552215437234, -1.1160532540397263,
      -1.1434252321049225, -1.016443200659649, -0.7297309020650492,
      -0.3119529388329272, 0.17858358197896212, 0.6655886490233434,
      1.0709648019994171, 1.3316143081578888, 1.412823014316879,
      1.315006649229257, 1.0722471081669427, 0.7430765866215419,
      0.39587640980712346, 0.09256611395440062, -0.12536038741680716,
      -0.24503387968175067, -0.28272166752810457, -0.276700693557303,
      -0.2744877535188189, -0.3178531199084657, -0.42959606145278645,
      -0.60559563524782, -0.8142864961331497, -1.003793716599389,
      -1.1149791697611817, -1.0971083444356156, -0.9221336637385799,
      -0.5938917858281112, -0.14975497784552122, 0.3458506141426857,
      0.8146149147730326, 1.1810775553526631, 1.3888969840106986,
      1.412727578377913, 1.2628580847860738, 0.9815544635424849,
      0.6320994496150805, 0.2833153136599673, -0.006554399635877839,
      -0.20261571639265352, -0.2996484438264376, -0.32054822790503396,
      -0.3074666623861544, -0.3080867270705427, -0.36069943911710994,
      -0.4820374703530298, -0.6611002499953469, -0.8606564941880616,
      -1.026127553059429, -1.0996419397391364, -1.035694193273484,
      -0.8143858998996815, -0.44879149775664695, 0.01556323794642503,
      0.5091588710199288, 0.9529376640854803, 1.2753075352600571,
      1.42759284194899, 1.3942008777218737, 1.1950747613343864,
      0.8799097048679507, 0.5156417716274251, 0.17036610903302724,
      -0.1023075581330215, -0.27461221312864037, -0.34896716539551387,
      -0.35438438580340936, -0.33603876242716246, -0.34083763350140306,
      -0.40283000577554856, -0.532318351124492, -0.7115712827678322,
      -0.8983292545445023, -1.036281107533518, -1.0698784948763462,
      -0.959708504573378, -0.6944550801374677, -0.2962981866530486,
      0.18177777507596948, 0.6662755382683384, 1.0786781550363407,
      1.3524304642867626, 1.447305344002536, 1.3576853390908192,
      1.112790184970743, 0.7688701153438544,
    ]);
    const expected = [
      [
        -0.917745512077415, 1.6194022309147382, 2.4829938076546645,
        1.8227431263064264, -1.7572950004686325, -0.7825143962924016,
        1.5617876136847166, 2.551731264998911, 1.7370294890393654,
        -1.6277088259460197, -0.6212335650885071, 1.5290894155460246,
        2.545181897606959, 1.7969336972180256, -1.8378504680571373,
        -0.7470919976617061, 1.7430479493851507, 2.2037099379151424,
        2.2881582317293994, -2.693593315091119, 0.23672503931720848,
        2.502143610559296, -2.562788199149385, -0.13590033371706545,
        2.695697894164924, -2.362397901318237, -0.501916509677044,
        2.812402447371481, -2.092940259748979, -0.8595792368288316,
        2.853487744071321, -1.7586523106161738, -1.206914933678189,
        2.8235587449034156, -1.3676659649128065, -1.5409137838135232,
        2.7297208983825696, -0.9317441386176148, -1.8569264047771776,
        2.5805020639083462, -0.46562476382665846, -2.1472133871665804,
        2.378905901817945, 0.02964381205584185, -2.429916624667582,
        2.169563389825866, 0.47285332353779685, -2.512994128630817,
        1.3097002103427327, 3.425725460149892, 2.842655388399619,
        4.026003814743918,
      ],
      [
        -0.2857575919499043, 0.0646854011109189, -1.029216222634086,
        -1.2794268412311818, 0.9843352199983871, 0.4561948723266371,
        0.3518067685707689, -1.0440444478054627, -1.2806691957406346,
        0.8557600979670223, 0.37836365501390273, -0.8386659504057149,
        0.249145496917043, 0.766426595665178, -1.2875421501591844,
        0.853455265867523, 0.21018705406631896, -1.096675610383026,
        1.149059045385216, -0.33656197065620386, -0.7345414760019039,
        1.261672019407362, -0.832021820968032, -0.25556607338889126,
        1.182223414014936, -1.2114288285862944, 0.2752290758274466,
        0.9231750287420318, -1.424786810566175, 0.785142204559395,
        0.5223051222949059, -1.445138911754042, 1.2039820439768831,
        0.037420744954926845, -1.2722556044787825, 1.4737848131561806,
        -0.46149404186503207, -0.9165758126873089, 1.7073527384655305,
        -0.32021372051925767, -0.2538097884013853, 0.6904579644669553,
        -0.8267448068909423, 0.5849524461180093, -0.9687340260601084,
        -0.30131765127100446, 1.1274941567261991, -1.0172945727621077,
        0.09328654741726719, 0.9160007823638111, -1.237215944083144,
        0.6156664511369256,
      ],
      [
        -0.04581596672644048, 0.09634904493248067, -0.1387887792611018,
        0.07386987823195547, 0.040556917478981, 0.15531577134016764,
        0.23676745675114147, -0.3256713050924001, 0.19909915505952608,
        -0.038947854357435724, -0.06334151872596967, 0.07489501614164133,
        -0.019926906365738826, -0.04003248647205718, 0.04856721612378656,
        -0.001636700702227953, -0.047117805536672656, 0.04336255039730679,
        0.008332082252089793, -0.05080639126471485, 0.03704621377418659,
        0.018048316578190712, -0.05306007851584058, 0.02900725338558966,
        0.027037275071634767, -0.05312763790293215, 0.020383828263695267,
        0.035204691034506796, -0.05163227528507869, 0.010604810672954988,
        0.04197831731918717, -0.0480509018098461, 0.0008993609784448955,
        0.047469372277873706, -0.04303139580844213, -0.009285682977490198,
        0.05107531237744624, -0.0362838368941485, -0.018697014424684917,
        0.05313835159265878, -0.02845201969163827, -0.02789787391756163,
        0.05306129632846302, -0.01946477120389718, -0.03567985809859849,
        0.051424822259715494, -0.009920086842331149, -0.04264290011168414,
        0.04765848992882553, 6.519547578261273e-5, -0.047687523940173046,
        0.04256857344430924, 0.009988835102909877, -0.05146946236234695,
        0.03561696829857602, 0.019587840301022702, -0.05305061537277731,
        0.02780260645301085, 0.028507724722742038, -0.05314913644627025,
        0.018610369235516868, 0.03638591925386881, -0.051024154631536735,
        0.009181624703243428, 0.04306289537229776, -0.047527806177001954,
        -0.0030650453836593163, 0.029798298050075493, -0.12980800450813074,
        -0.09566196436158217, 0.44863452829642214, -0.6575847426439408,
        0.5872696471465858, -0.2837575580693084, 0.2114296173909285,
        -0.14556463535098374, 0.06050890616956548, 0.021637425129186198,
        -0.0521881294765119, 0.017881897970162087, 0.03708415851500807,
      ],
      [
        0.03586766421299862, -0.00798809449299296, -0.05750511597651908,
        0.043306197660189956, -0.013637579421287677, -0.004228456261538077,
        0.006615956303665361, -0.003093696589624806, 0.0006636350032105019,
        1.445750735038993e-5, 8.24021137441106e-8, -2.6448986272538277e-5,
        -3.6435664591727936e-5, -1.1926241482874152e-5, 2.3888535750755553e-5,
        3.7114241621480145e-5, 1.522908337476289e-5, -2.1064643852650442e-5,
        -3.742996749968275e-5, -1.838761732155467e-5, 1.8037208150891167e-5,
        3.7374150517802254e-5, 2.1328682936575164e-5, -1.4906118956806471e-5,
        -3.702971956620704e-5, -2.4096959673123728e-5, 1.1658299550612035e-5,
        3.639941255257832e-5, 2.6708208381231354e-5, -8.25206823811467e-6,
        -3.540635264026216e-5, -2.9065932818203652e-5, 4.763244269296518e-6,
        3.406576140996754e-5, 3.1114856955485435e-5, -1.2892628715701965e-6,
        -3.2471348856598775e-5, -3.2913120581634895e-5, -2.190252497733381e-6,
        3.0624466771851494e-5, 3.447374070870808e-5, 5.707660604528638e-6,
        -2.8460372665322523e-5, -3.570468391869004e-5, -9.176400145612457e-6,
        2.601684373810801e-5, 3.657220567808191e-5, 1.2507234120511332e-5,
        -2.3394918349305228e-5, -3.7148724632871384e-5, -1.573095822665614e-5,
        2.0592893513358702e-5, 3.744607395808912e-5, 1.887346797474752e-5,
        -1.7557696449475145e-5, -3.7380324818755936e-5, -2.184299177339351e-5,
        1.4346599281686214e-5, 3.694127648655138e-5, 2.4564031827587082e-5,
        -1.1063220152674498e-5, -3.6214914604216536e-5, -2.7080544462383807e-5,
        7.700144254668616e-6, 3.521221904257297e-5, 2.941470186523962e-5,
        -4.214263743446632e-6, -3.385952949063884e-5, -3.147478395577121e-5,
        6.779580740758777e-7, 3.217034732452123e-5, 3.320375581220258e-5,
        2.808169452775964e-6, -3.024187004720094e-5, -3.466055775886962e-5,
        -6.260455869490741e-6, 2.8083234567616313e-5, 3.5865734144348886e-5,
        9.714546090389104e-6, -2.5631649532897807e-5, -3.67320462418837e-5,
        -1.3088138686089496e-5, 2.2922629187654968e-5, 3.7224302187858376e-5,
        1.628950727174797e-5, -2.006069467640955e-5, -3.7416898267368605e-5,
        -1.9347132366350668e-5, 1.7050955575187525e-5, 3.732979336599759e-5,
        2.229195488618582e-5, -1.384066121352135e-5, -3.688340039553405e-5,
        -2.5037123800246758e-5, 1.0484032665248705e-5, 3.6066040142560517e-5,
        2.7505287919135695e-5, -7.087816132381559e-6, -3.496642350513335e-5,
        -2.9739730948998758e-5, 3.6500392945106323e-6, 3.360367992410427e-5,
        3.176914730692969e-5, -1.2606677826086188e-7, -3.190754664910096e-5,
        -3.350708600460199e-5, -3.4156735291124023e-6, 2.988965690136079e-5,
        3.489510521213151e-5, 6.872023796532018e-6, -2.7650231913534917e-5,
        -3.599287015360175e-5, -1.0255485147890434e-5, 2.5206017965636627e-5,
        3.682848991678868e-5, 1.3605122607584033e-5, -2.2496231771469065e-5,
        -3.7319913536966e-5, -1.6843438482764906e-5, 1.955381816677162e-5,
        3.7430688763341844e-5, 1.987678755944471e-5, -1.648621567954203e-5,
        -3.723696783123849e-5, -2.2731475314455685e-5, 1.3305114988804757e-5,
        3.6766780367172676e-5, -0.004872062750624983, -0.045780410992893775,
        0.08779020120410749, -0.06608850430532534, 0.0489434646860825,
        -0.02952199258692612, 0.011963324814249728, -0.002509673793592637,
        -0.00011669718039387965, 0.00020980315030456114, 5.745364565731167e-6,
        -2.722672644397397e-6,
      ],
    ];
    const result = wavedec(data, "db12");

    const reconstruction = waverec(result, "db12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db13", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5078327439166741, 0.9346723200870182, 1.2167638759197252,
      1.320671787150843, 1.2490897938630399, 1.0380897635215216,
      0.746657093483596, 0.44127262473045326, 0.17950207522595962,
      -0.003257705293094104, -0.10059437479303412, -0.13387472094188294,
      -0.14352668731640902, -0.17526460561717672, -0.26501769358472643,
      -0.4266491505242871, -0.6458201960358868, -0.8817487070950407,
      -1.0765478644371238, -1.1698367868137636, -1.1149054722038072,
      -0.8922548106153178, -0.5169413728566803, -0.03768499684570026,
      0.47224146752320273, 0.9302497742267464, 1.2621566552683956,
      1.418101215025227, 1.3828096289979634, 1.1777610262726388,
      0.8548241109264799, 0.48305097826748455, 0.13199662441418192,
      -0.14424494377003216, -0.31833968560286585, -0.39364073729057036,
      -0.3999568644991736, -0.3824806874484594, -0.3869473383819908,
      -0.4450452845730561, -0.5640090926325584, -0.723214342672326,
      -0.8787539141461266, -0.9748761591682614, -0.9593490853685072,
      -0.7987488035378969, -0.48963171886224427, -0.0625522604420414,
      0.4223210712151297, 0.8871135644355757, 1.2528803064484202,
      1.4569529979248106, 1.4667678832279338, 1.2867983918161174,
      0.9569203712888105, 0.542662000227406, 0.11979682303680494,
      -0.2428806712691042, -0.4983499455679014, -0.6301487162538048,
      -0.6531317643388465, -0.6062537778351249, -0.5394603455124461,
      -0.4982567638295861, -0.5100829188626974, -0.5761139932328627,
      -0.6706642768611182, -0.7483671811488384, -0.7572547158102598,
      -0.6542919922595672, -0.4192412873900573, -0.06311350968765306,
      0.37118224036870595, 0.8164012155936877, 1.1950467993055944,
      1.4365982444722856, 1.4936653786937502, 1.3530771909578674,
      1.0391451435032393, 0.6082752189830303, 0.1362462197984508,
      -0.298716870588001, -0.6329246203878256, -0.8301362812620294,
      -0.8873444414265543, -0.8321994833318295, -0.7129673908666139,
      -0.5837949578554069, -0.48921399709276125, -0.45195811791366775,
      -0.46725948560738567, -0.5050742738923245, -0.5195975363973238,
      -0.46350844227448745, -0.30312944322793445, -0.030412435797326,
      0.3315469716964353, 0.7311189862016401, 1.098438952293088,
      1.3609709580547968, 1.4605234401247271, 1.3674794840788431,
      1.0886535775912227, 0.6667484156449675, 0.17146591427089825,
      -0.3156007086685202, -0.7186270673309864, -0.9834859097617901,
      -1.0881199057606958, -1.0449544955074312, -0.8949621747267141,
      -0.695088536712138, -0.5023989905238633, -0.3590857626092544,
      -0.2821922779100602, -0.26064286117992586, -0.2602384433398123,
      -0.23518994907827728, -0.14304742897191036, 0.0410146523756626,
      0.3144459458097811, 0.6448328055379818, 0.9755315198075517,
      1.2381708131655254, 1.3689705294399, 1.3247912202409498,
      1.0948342818246046, 0.7049575524892716, 0.21339468663154287,
      -0.3011929159024628, -0.7564878793355374, -1.0840649169136118,
      -1.243480722043556, -1.2295477076041421, -1.0711503796332023,
      -0.8220835970184098, -0.546377594758805, -0.30192219528846176,
      -0.12657235905722058, -0.030219309311021736, 0.005271391778393655,
      0.018412968378120398, 0.05490678469062826, 0.15251215323579165,
      0.3280832893238924, 0.5703170594105058, 0.8402710313821113,
      1.0796867919428397, 1.2251082187450186, 1.224244177967193,
      1.050387411404268, 0.7111335323833994, 0.24904028098895953,
      -0.2661247450920282, -0.7517888479147325, -1.130195088570093,
      -1.344985660101992, -1.372745458826834, -1.2267601069509426,
      -0.9521859139353416, -0.6139662682797187, -0.28061815125442485,
      -0.008001568731513642, 0.17287416571118153, 0.2610407034478472,
      0.2826251508993962, 0.28074612478906913, 0.30107301190669744,
      0.3769770104162337, 0.5182895720317582, 0.7067300056813919,
      0.8993150498669695, 1.0389688845983034, 1.0696509313385252,
      0.9521006031798562, 0.6760784496615716, 0.2658223701161101,
      -0.22287457585665196, -0.713449465787948, -1.1247090983716184,
      -1.3884446443914198, -1.4642449279451242, -1.3479107174684297,
      -1.0714565480602558, -0.6947751907891528, -0.291103967126388,
      0.07005065284656603, 0.33828602392243423, 0.4922172524104569,
      0.5416100330108323, 0.5214228989101357, 0.47952433981512577,
      0.4614572787916773, 0.4963528532178531, 0.5877628360299433,
      0.7118730308629208, 0.8236158273910598, 0.8691192996076404,
      0.8012484496494188, 0.5941452611965027, 0.2528790338919399,
      -0.18447166860224154, -0.6530753228800305, -1.0745897176323862,
      -1.3742436456870564, -1.4976038598349892, -1.4229113199421677,
      -1.1659479667589827, -0.7762403298933985, -0.32555260760015475,
      0.10847381475315565, 0.45949668323695053, 0.6862674019700722,
      0.7797444880054345, 0.7619514933882172, 0.6771145894965396,
      0.5775708454304511, 0.5082420700320642, 0.4937903098181824,
      0.5318308839527982, 0.5939700653630435, 0.6343722405992667,
      0.6035765855660122, 0.4638870373174057, 0.20221199336245815,
      -0.16315085323360562, -0.5837595658863017, -0.990227059542675,
      -1.3072497962897234, -1.4708195045508032, -1.4433666065345698,
      -1.2230544112380553, -0.8448726179345282, -0.3732068913169725,
      0.11232489172823606, 0.5343148434911479, 0.8340370744559018,
      0.9829771930713931, 0.9867208298974907, 0.8804480824624186,
      0.7174014552138319, 0.5534511113280212, 0.4318274154049,
      0.3719888539102218, 0.36547366231436945, 0.37973621499783095,
      0.3688705274370132, 0.28831305055649104, 0.1095610359777136,
      -0.16908652666242652, -0.518751792805624, -0.8843649931632794,
      -1.1963064385560511, -1.3865025520532304, -1.4049857192637205,
    ]);
    const expected = [
      [
        -1.8703106740038837, 1.2025931319837158, 2.3432754896568917,
        2.154224601946569, -0.9851452535523012, -3.0831740169231585,
        0.08886703814307031, 1.8107939228509782, 2.7011883502775715,
        0.5799431618408806, -2.5947171151999635, -1.4987264199167443,
        1.2737463483008609, 2.5094622833171143, 1.9056578005534122,
        -1.3839187201499676, -2.9358937090813915, 0.4833091656398001,
        1.6751279600206228, 3.2091459053161655, -0.6981982507811034,
        -1.8868604694138194, 2.702371239799224, -0.9868776809206813,
        -1.644151136297657, 2.725198939260435, -1.2504471544722555,
        -1.3899168511754172, 2.7188320624355455, -1.4952329468095824,
        -1.1268044348069497, 2.685375065015335, -1.7210813851908342,
        -0.8567040025787227, 2.6264958866145878, -1.9280322670120944,
        -0.5808697219113309, 2.5432881201258795, -2.116036879886844,
        -0.3001181388388042, 2.436227564460518, -2.284765227758316,
        -0.014340980840756903, 2.300971409746425, -2.418823683513824,
        0.24307593999226515, 2.1884230872768087, -2.576469946070109,
        0.5403197438928523, 1.9159143270857844, -1.8349556555089228,
        -4.325246779385846, -4.149857228394406,
      ],
      [
        0.8191364552313137, -0.48923910773558504, -1.038674875159986,
        -0.08900549056212559, 1.4453127222947089, -0.4459564971851469,
        -0.2241038578250306, 0.66382701192083, 1.3721422828357384,
        -0.548407155992245, -0.9466228816135085, 0.7385626027318041,
        0.5020792365804426, -1.540462654985968, 1.4553218934621526,
        -0.27069204920118917, -1.0819804568544367, 1.511048781359033,
        -0.6662792010436716, -0.7492886209449251, 1.548160380132807,
        -1.0505592637991243, -0.3362389719503101, 1.4506205503332148,
        -1.3509506161230496, 0.11297964222468133, 1.226550781896685,
        -1.539316605832584, 0.5576541299276266, 0.8956780784205743,
        -1.5980748208422693, 0.9574465227761652, 0.48768495039154036,
        -1.52166103144453, 1.2761503824430398, 0.03943067368125188,
        -1.3170975072929136, 1.4836050129165745, -0.42322482349691837,
        -1.0777840934219711, 1.3309426579175565, -0.2791154105933453,
        -0.01744296201918203, -0.25450909048624093, -0.4332860189388581,
        1.0340762194720314, -0.3414687415973249, -0.8752158600020037,
        1.5249998347481655, -0.9807953886050693, -0.35009062856195283,
        1.3736860260681083, -1.2480085715339655,
      ],
      [
        0.10183268023517639, -0.033142842417875275, 0.042588799016491395,
        -0.03472875844670978, 0.05387072307236142, -0.06708035896001872,
        -0.32753050380703447, 0.18684284852698343, -0.13234713513746046,
        0.16238306814371775, -0.16852833157021307, 0.11493373201030915,
        -0.029277036974589818, -0.03485550728138962, 0.04066121229805339,
        0.0021525907162575305, -0.042766259151030814, 0.03640722555920546,
        0.009648512254488317, -0.04504881827410111, 0.03148747598762483,
        0.01641763362412345, -0.046563692631910576, 0.025792724793215163,
        0.023095315670485166, -0.046657298140532696, 0.0194950353381148,
        0.028916647439816163, -0.04595164140407286, 0.012746785980578499,
        0.034370750339081574, -0.043860132458904966, 0.005664147779053919,
        0.03868256799425428, -0.04101281932962136, -0.0015004035937084739,
        0.042412023371512654, -0.03692153658624809, -0.008701889718842153,
        0.04479422019094586, -0.03221240657272733, -0.015604635691478389,
        0.04646120701903026, -0.02649630143557534, -0.022249306366037894,
        0.046675083013232546, -0.020379624260593775, -0.028235201026733665,
        0.04613670065053163, -0.01356804547471752, -0.03370149533103929,
        0.044147653508044164, -0.0066295539195842575, -0.03820037374003818,
        0.04146920964657152, 0.0006435396608848214, -0.04197937596967346,
        0.037450185737313964, 0.0077419963145201, -0.044559790592659396,
        0.03289884875716799, 0.0147977039303877, -0.0463031315628154,
        0.027214226337822882, 0.02138077888187391, -0.046705374945926935,
        0.021344055015025162, 0.027887056946585425, -0.0476873653605577,
        0.017593162608641192, 0.11373410617612002, -0.1390601991263603,
        0.07404063332453267, -0.07851036692426326, 0.041399326850481026,
        0.013757675010433547, -0.057134839458349074, 0.062231310258049025,
        -0.023540789116585928, -0.028465081492781152, 0.046127001370287614,
        -0.01304910628017842,
      ],
      [
        0.028793478631268285, 0.015159847288255191, -0.09044588689847297,
        0.077602689763518, -0.04422260169878294, 0.014569243592811556,
        0.0003564023111897008, -0.002999526449525068, 0.0014589463529079952,
        -0.00028831807187460883, -4.7262816933305855e-6, -1.4316776431267097e-5,
        -2.573759686957161e-6, 1.4774493583740868e-5, 1.800203458517746e-5,
        4.0196760123170966e-6, -1.3811104402048698e-5, -1.844862458870319e-5,
        -5.459618309313014e-6, 1.2743130348614968e-5, 1.8764669992843366e-5,
        6.85353956892189e-6, -1.1601922529887447e-5, -1.895987565423025e-5,
        -8.188101624723944e-6, 1.0414557193865775e-5, 1.9062987341206255e-5,
        9.486589636732003e-6, -9.164233315948098e-6, -1.9063520077214683e-5,
        -1.0748139521595072e-5, 7.836710919444921e-6, 1.8931001937309473e-5,
        1.193444368923561e-5, -6.462484635841052e-6, -1.8674351766089186e-5,
        -1.302985301824612e-5, 5.072668685688302e-6, 1.8326026698575422e-5,
        1.4058189818507526e-5, -3.654213125665594e-6, -1.788172997378473e-5,
        -1.5023687111137652e-5, 2.1913673264787415e-6, 1.731280245531223e-5,
        1.5890877328827373e-5, -7.127369194403119e-7, -1.662719873854534e-5,
        -1.6642574615381082e-5, -7.475889586687582e-7, 1.5860547826844954e-5,
        1.730336360932816e-5, 2.199414648147522e-6, -1.5014627608786629e-5,
        -1.7883017845940418e-5, -3.6604861883754836e-6, 1.4062743497498153e-5,
        1.8349830756348733e-5, 5.105160790953536e-6, -1.3011508779454955e-5,
        -1.86857192680051e-5, -6.497526038628686e-6, 1.1898936672702271e-5,
        1.891607946554504e-5, 7.8447217845148e-6, -1.0732486043293596e-5,
        -1.9056420041382747e-5, -9.166964869945512e-6, 9.487359127012404e-6,
        1.9079481632207378e-5, 1.044261039968251e-5, -8.168282716870509e-6,
        -1.8966741189187456e-5, -1.1635081226037902e-5, 6.814659200557913e-6,
        1.8744243798196233e-5, 1.2749435034112503e-5, -5.438994629513017e-6,
        -1.843314632471951e-5, -1.3808752630161968e-5, 4.018141033387374e-6,
        1.8011053304810785e-5, 1.4796303719492361e-5, -2.5542757439025628e-6,
        -1.7459249920083435e-5, -1.5675931701204667e-5, 1.0870479017971376e-6,
        1.6804042425452834e-5, 1.6451124353554288e-5, 3.6680422209405834e-7,
        -1.6071857464221547e-5, -1.714807024793064e-5, -1.8291482381403795e-6,
        1.524529954525872e-5, 1.7755680372245744e-5, 3.3010715907593736e-6,
        -1.4305497316551837e-5, -1.8239159124606323e-5, -4.743894034846415e-6,
        1.3278414583939254e-5, 1.8600805357252517e-5, 6.137569179211031e-6,
        -1.2195092623870287e-5, -1.886995538296029e-5, -7.503107894300485e-6,
        1.1043004225629213e-5, 1.9041640555464126e-5, 8.845556038796743e-6,
        -9.802963046812617e-6, -1.9083165530070503e-5, -1.0128409420913957e-5,
        8.49980351207548e-6, 1.8995844749568904e-5, 1.1329268125995608e-5,
        -7.168287343251842e-6, -1.8811961854500538e-5, -1.2468691765651094e-5,
        5.800391765519351e-6, 1.8532862382059726e-5, 1.3556280762059401e-5,
        -4.376303517066719e-6, -1.812845267477121e-5, -1.4558823600312485e-5,
        2.9188098600987967e-6, 1.759906603174178e-5, 1.5452474211108726e-5,
        -1.4653176453508818e-6, -1.6979478089778285e-5, -0.009697113210764594,
        -0.0048260818268884625, 0.029767403285354183, -0.02544810401372747,
        0.014610332163849679, -0.004983123284980343, -5.205436520403499e-6,
        0.0009458225499562435, -0.0004650475339142538, 0.0001178020438945354,
        4.6239747327237544e-6, -1.1001513819388469e-5,
      ],
    ];
    const result = wavedec(data, "db13");

    const reconstruction = waverec(result, "db13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db13_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4980520664319026, 0.9207715228824345, 1.2079208902286287,
      1.326022216612868, 1.2739733400940454, 1.0814300142294104,
      0.8004738568495506, 0.4926576611104205, 0.21458089219992865,
      0.005446801229466225, -0.12047968452886437, -0.17482512180249188,
      -0.18941290028569965, -0.20549366674246128, -0.2607122264781496,
      -0.3771677752367253, -0.5536451245500782, -0.7640591828016725,
      -0.9626151924389947, -1.0945174564966336, -1.1096658448251895,
      -0.9760022673516091, -0.6891999276129877, -0.2762228362242312,
      0.20827635983801573, 0.6920506760230453, 1.0996220072538605,
      1.3676582822007977, 1.457848784371032, 1.3643361038558537,
      1.1140358947321432, 0.7598424783358377, 0.3683804998611065,
      0.005222952211931031, -0.2789463121117335, -0.4580228783280687,
      -0.5338610858088229, -0.5327276473069127, -0.49589846792785863,
      -0.46687857378541336, -0.47852312534202013, -0.543331174802014,
      -0.6493767302424888, -0.7629314320950168, -0.8371634853887894,
      -0.8247751218167041, -0.6914370249451033, -0.42663876048682303,
      -0.0491603183803756, 0.39435745740054867, 0.8376118815886952,
      1.2078384270943339, 1.4410187892776622, 1.4955886503168219,
      1.3614568691269495, 1.0622290856798398, 0.6501136825228683,
      0.19469798445357214, -0.23179129951423108, -0.56932758337485,
      -0.7816208544985532, -0.8617698421762686, -0.8308794273057702,
      -0.7301865198926214, -0.6087858314922947, -0.5100773120321227,
      -0.46032302509007894, -0.4621416308513093, -0.4945219529739772,
      -0.5193079715794601, -0.4924930032314315, -0.37745407204753556,
      -0.1567529384813489, 0.16054781184137307, 0.5380328505822479,
      0.917960897827334, 1.232905660819668, 1.420359375781283,
      1.4368894627490967, 1.268495762295423, 0.9346774396881323,
      0.485180788473249, -0.009887167992604612, -0.47433912297184044,
      -0.8413171573178329, -1.0663175494208204, -1.1349013380567636,
      -1.06343818051429, -0.8928924327292203, -0.677306651796515,
      -0.469873854961225, -0.310020546013082, -0.21462319639715655,
      -0.17542758742020564, -0.163191198527025, -0.13740112607289168,
      -0.059039405466474626, 0.096890325214471, 0.3323116837862054,
      0.6228917525179118, 0.9216799520125067, 1.1688449860895846,
      1.3052696575344793, 1.2867808291249956, 1.0955830088824572,
      0.7460831776927805, 0.28359596769890694, -0.22390836125572205,
      -0.6992062480651982, -1.0713454697472253, -1.2897595530575352,
      -1.3337726434171073, -1.2153865912595154, -0.9748291037092262,
      -0.6700442511000111, -0.3627166326002847, -0.10420138760852815,
      0.07530063089089861, 0.17181807336612442, 0.20586208956780344,
      0.2144647120218251, 0.23913103622371956, 0.31282653298105306,
      0.4493457949132435, 0.6378122778343223, 0.8437856721035151,
      1.0168140015472868, 1.1026601486175664, 1.057248731891428,
      0.8589086194298718, 0.5158462407751607, 0.06689194992535441,
      -0.42484816157580296, -0.8841108536802955, -1.2386540915184936,
      -1.4340374724036067, -1.4446202940698183, -1.2782702907710717,
      -0.9737483986944631, -0.5914499376242618, -0.19973004025731667,
      0.13994857348518763, 0.38557428697950336, 0.521977369442294,
      0.5614581996519147, 0.5377098391494104, 0.4947153521727272,
      0.47350354073835216, 0.5001400881244604, 0.5779970467467728,
      0.6862652529903424, 0.7851149891931922, 0.8262499517080726,
      0.7662428262812042, 0.579318732649273, 0.26634321531623595,
      -0.14234454766600135, -0.5911462042477638, -1.0096629444965424,
      -1.3270779564512118, -1.4871710086628116, -1.460484471659482,
      -1.250801177112618, -0.8944142381063694, -0.4523524776049188,
      0.0026299922277194243, 0.40127839448185204, 0.6917624432122277,
      0.8491332347519609, 0.8782394819050579, 0.8096127945549583,
      0.6895174496093556, 0.5667434231198412, 0.47947026097288464,
      0.4454654903759338, 0.4580233532205697, 0.4886083699962546,
      0.4954952824689101, 0.43619977621291617, 0.2805377904972002,
      0.020968904847288916, -0.32248264778002683, -0.7041301375773248,
      -1.0610920998936888, -1.3264580813331686, -1.4441133016431906,
      -1.3817356169331831, -1.138865773930211, -0.7480848374152617,
      -0.26894131314585157, 0.22402956102983693, 0.6564674420291269,
      0.9690648421052958, 1.1287818964344691, 1.1339045286370544,
      1.011925797196006, 0.8109358185768598, 0.5867339018453961,
      0.38886122769750947, 0.2489592063556253, 0.17424133970721356,
      0.1475778196764423, 0.13404693813641172, 0.09220607175012424,
      -0.012833228093571791, -0.1978927286153151, -0.45476850530880725,
      -0.7497041650010032, -1.0295957721245803, -1.2335645615492707,
      -1.3071901024103634, -1.2160006281313391, -0.9549404245894539,
      -0.5514506020423257, -0.061291850203390126, 0.44205086420352735,
      0.8820214813843646, 1.1943795612359718, 1.339819676919845,
      1.3109763837769253, 1.1322948429377906, 0.8529294302972631,
      0.5344667238827029, 0.23646412956975021, 0.003266449087126422,
      -0.14479990181779545, -0.21386032378516168, -0.2321358245811564,
      -0.24004631068398685, -0.27737389591045547, -0.3707959623157432,
      -0.5249936381839524, -0.7196501330939471, -0.9131920165241142,
      -1.0524504530300167, -1.0859364479463731, -0.9774959216489434,
      -0.7169647794571814, -0.32511993944659584, 0.14844025101631556,
      0.6341737148874576, 1.05630063073034, 1.348241635747658,
      1.4662585524083591, 1.398172646438299, 1.1651827887914656,
      0.8164218234692109, 0.4175873596291387, 0.03635711211475423,
      -0.2719788908440123, -0.47533701595753053, -0.5696723896605814,
      -0.5768588522808711, -0.5363410036049172,
    ]);
    const expected = [
      [
        -1.8297598659217218, 1.227062684748025, 2.394948770161773,
        2.1192991883915147, -0.8548087083404209, -2.927840269871316,
        0.1701766396694894, 1.8007771729123467, 2.7577631463773398,
        0.5609867412699535, -2.384389384631033, -1.3944931938654976,
        1.2702492473350275, 2.5888627401194113, 1.8411151134486672,
        -1.2159053925256824, -2.7761145767880544, 0.48963130950789546,
        1.7874297291751373, 3.0984255082761223, -0.49456523462709656,
        -2.008894299363315, 2.4868796114019704, -0.4620663472753912,
        -2.037301362962388, 2.5031589258500233, -0.44694233585844156,
        -2.1001396595652544, 2.5907760820634826, -0.49449273286297324,
        -2.1494700194546112, 2.7233667716555474, -0.617039379495057,
        -2.1422581317513543, 2.855089896726715, -0.7956814786628937,
        -2.058181339018566, 2.939569469331741, -0.9880833733859513,
        -1.9080471337953964, 2.9490603105769893, -1.1459542214855127,
        -1.7295308084214909, 2.8874138558635822, -1.240793648075169,
        -1.5578607889343492, 2.7681838573298494, -1.2637792439091766,
        -1.3791242850206114, 2.4794135667669335, -1.0071959543586742,
        -0.9314202527549881, -2.9758823319945344,
      ],
      [
        0.7564744823669216, -0.48418049948850195, -0.96317875603441,
        -0.17702742436618604, 1.5159754826524905, -0.6222055702773372,
        -0.24679798814814294, 0.5396699646301941, 1.4142176001719704,
        -0.5986747397342764, -0.8816028657584585, 0.8911393117930189,
        0.09773712568820203, -1.2223838710040136, 1.6656734080917175,
        -1.0806513653206908, -0.185224058169891, 1.299230216110478,
        -1.5127866192768473, 0.6960417287850811, 0.5704865914643094,
        -1.4168161665677963, 1.2947203719631766, -0.3326600808475072,
        -0.7959799657777865, 1.3581875587164278, -1.0376429977914636,
        0.09229488130593902, 0.8621656716441805, -1.254079296386209,
        0.8798919004696744, 0.01367425015081799, -0.89358038691055,
        1.2403608151473773, -0.8345722694099695, -0.1062891204368531,
        1.0238274958001126, -1.3301406856622666, 0.783237001488977,
        0.3404494341243722, -1.2206606059775245, 1.0582757991950658,
        -0.766462183563908, 0.39917615845327925, 0.49203001649491007,
        -0.7874648744936972, 0.22042767275675162, 0.6571328734889794,
        -1.1927128930842217, 1.008712340204116, -0.18925193678488902,
        -0.7846122194017462, 1.3075989788674856,
      ],
      [
        0.1042490059383405, -0.014996638144725757, -0.013280996948616218,
        0.012908337657647127, 0.022283667917983755, -0.052046637492324244,
        -0.3193126540471881, 0.17505006204268247, -0.1207478871036157,
        0.15038621850285563, -0.15512944435105697, 0.10170925372847715,
        -0.022299470439927756, -0.029443441714764006, 0.025492817763298117,
        0.013206050646975312, -0.03624669553110202, 0.0156711398104273,
        0.023616580601625647, -0.034593435708967446, 0.004379522721363493,
        0.031097149859624022, -0.029528393708162206, -0.007444103889592642,
        0.03549501757470098, -0.021044095339150307, -0.01841373962808761,
        0.03590344112136301, -0.010609082266177877, -0.027488231401863968,
        0.03272456719245465, 0.0012341216560839477, -0.03358911748042588,
        0.025844812194149584, 0.012665760524245813, -0.03617561049566583,
        0.01645101965849251, 0.023031925181401326, -0.03487453961833795,
        0.005078554544392287, 0.030675467725772433, -0.029914319168534854,
        -0.006598167416895724, 0.03533858688669276, -0.021739538832506417,
        -0.01781187894132472, 0.03597581037824858, -0.011291665066407245,
        -0.02689475439578816, 0.03306664595996637, 0.00038547303370962786,
        -0.03336495900681244, 0.026376169228973418, 0.011995312169754106,
        -0.036048345831303966, 0.017154879627144813, 0.022353939431025514,
        -0.03515212974916906, 0.005845056335813864, 0.030321514879326807,
        -0.030274673497041757, -0.005819752732576976, 0.035084011761503074,
        -0.022435137891537414, -0.017130350460965164, 0.036107160649440945,
        -0.012098239013887466, -0.027701782939567047, 0.026441624095187945,
        -0.027716853160987858, -0.05154570092335934, 0.0794429059987081,
        -0.060813109558888974, 0.09104506917243017, -0.05940550864734703,
        0.03175273932686852, 0.009677508297958218, -0.03861092690403981,
        0.02687244232393256, 0.01332077044913976, -0.03613948553877497,
        0.015562780378772163,
      ],
      [
        0.028203348971686363, 0.014725101584752919, -0.08827861023945771,
        0.07570911503010962, -0.04319706052609409, 0.014316687128029002,
        0.0002832712823726682, -0.002915882446100075, 0.0014216922377922978,
        -0.00028162723447708673, 1.1670554699024466e-6, -1.0097437890055611e-5,
        -4.700829581446487e-6, 8.045685801860174e-6, 1.349571192063926e-5,
        6.70248748597712e-6, -6.174916204125317e-6, -1.3457475567910034e-5,
        -8.539345953061978e-6, 4.120220206115571e-6, 1.3041191006644282e-5,
        1.0135010902524213e-5, -1.9595026426332335e-6, -1.2270459558832847e-5,
        -1.1445426825993106e-5, -2.3456687988795244e-7, 1.119029196486132e-5,
        1.2462878800416703e-5, 2.4261640453199282e-6, -9.817413257594433e-6,
        -1.3161989677475302e-5, -4.571994455432196e-6, 8.163914716214528e-6,
        1.3496809259490108e-5, 6.59214392749131e-6, -6.285762961861527e-6,
        -1.3456200353878717e-5, -8.417059076146055e-6, 4.257893945592281e-6,
        1.3068488411384022e-5, 1.002034406182767e-5, -2.123048781729429e-6,
        -1.2346607670379629e-5, -1.1375056392477448e-5, -8.665033298128305e-8,
        1.1282641193278809e-5, 1.2422862512447517e-5, 2.301076193231816e-6,
        -9.90205736135238e-6, -1.3119561019187667e-5, -4.435990790054524e-6,
        8.268905117472508e-6, 1.3468447447730559e-5, 6.445088510207779e-6,
        -6.43016054802352e-6, -1.3476715088880026e-5, -8.299914417419981e-6,
        4.407835895014768e-6, 1.3122465825306887e-5, 9.940531610662647e-6,
        -2.2522400891529325e-6, -1.2398344185064729e-5, -1.129773556705509e-5,
        4.8029295666470164e-8, 1.1345137447212636e-5, 1.2345286580416876e-5,
        2.141799354489666e-6, -1.0008107673217583e-5, -1.3080707845012327e-5,
        -4.285743013813815e-6, 8.401778764125289e-6, 1.3474687778529596e-5,
        6.331005282985902e-6, -6.551647483634451e-6, -1.34910521500378e-5,
        -8.195998922141304e-6, 4.528099046955945e-6, 1.3138664883374435e-5,
        9.826029809817824e-6, -2.4029151560025024e-6, -1.2452720010764686e-5,
        -1.1204420015480674e-5, 2.1217281139073826e-7, 1.1442606759790576e-5,
        1.2299585570215396e-5, 2.0036039094287984e-6, -1.0109408458015e-5,
        -1.305546642969852e-5, -4.164763888693985e-6, 8.497318357112164e-6,
        1.3446245381054497e-5, 6.195268773522958e-6, -6.675434020044763e-6,
        -1.3488201770588336e-5, -8.06105960439193e-6, 4.684226548309618e-6,
        1.3186212686440295e-5, 9.73086708025906e-6, -2.5507557116163877e-6,
        -1.2521711046353733e-5, -1.1140146991301951e-5, 3.398613352174321e-7,
        1.150607756997564e-5, 1.2232384335708938e-5, 1.863134063992259e-6,
        -1.0192993809235311e-5, -1.2998061149581872e-5, -4.006838538816472e-6,
        8.624290302876568e-6, 1.3435858997971948e-5, 6.060333553673659e-6,
        -6.8154289776006255e-6, -1.3514686012749168e-5, -7.961657473776449e-6,
        4.807618736491655e-6, 1.3213023875943976e-5, 9.633553653514296e-6,
        -2.680854732046035e-6, -1.2558053573176457e-5, -1.1038075794381613e-5,
        4.994514939176472e-7, 1.1586956339359817e-5, 1.2164249614384564e-5,
        1.704553008621582e-6, -1.030683412607196e-5, -1.2975636672039916e-5,
        -3.880133585606301e-6, 0.0004095499122352264, 0.0062303869328329325,
        -0.010485946311701935, 0.007119976321550295, -0.0063565076311668574,
        0.005165696892407252, -0.0028790790065672004, 0.0009662276835484291,
        -0.00014211783222135583, -3.5587383357175604e-5, 9.154089430893783e-6,
        9.628916764042198e-6, 1.2839877630000552e-5,
      ],
    ];
    const result = wavedec(data, "db13");

    const reconstruction = waverec(result, "db13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db14", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5110685585158672, 0.9396667479127581, 1.2210705222944822,
      1.3217206570913609, 1.2450848233814984, 1.0286505756806283,
      0.7329770549989291, 0.42572325960030377, 0.16480086580823144,
      -0.015043034773131236, -0.10885899207144753, -0.1397990323959002,
      -0.14974243793170644, -0.18490740184574017, -0.2804199637588752,
      -0.44807530098990916, -0.6706786366223314, -0.9046143220358611,
      -1.0901138532332497, -1.1666428199543089, -1.089437084631217,
      -0.8428535436512649, -0.4469597559487415, 0.044521869335819295,
      0.5546085849717076, 0.9993558648679659, 1.3061082139383793,
      1.4292352643586914, 1.3595068153866978, 1.124858694381831,
      0.7824676406186029, 0.4042325458312727, 0.059393319771157194,
      -0.20130958664637844, -0.35599100024552555, -0.4140151017804383,
      -0.4100430721600107, -0.3915246093346327, -0.4031181779193009,
      -0.47230132180721573, -0.6000914441482055, -0.7594295795115733,
      -0.9017415064408987, -0.9700126093834011, -0.9149623174494079,
      -0.7100376554979353, -0.3611918495708466, 0.09128639533719027,
      0.5796066046694796, 1.0224645976355775, 1.342825171077266,
      1.4851379972753833, 1.4277332875750268, 1.1873362405517272,
      0.8146121070022376, 0.3819019319800806, -0.033742970702607455,
      -0.36797006932805687, -0.5826613209344398, -0.6723213921561277,
      -0.6619165446905462, -0.5969788394748785, -0.5287780721553512,
      -0.49861029086146735, -0.5254369729942809, -0.6001881984847661,
      -0.6882581758332513, -0.7395377531247393, -0.7033148299451566,
      -0.5440546752945631, -0.25379304339145675, 0.1422885463612985,
      0.5887971853557802, 1.011070695969711, 1.3315431131110536,
      1.487516699267101, 1.4459134108494294, 1.2112999742760793,
      0.8251514454060616, 0.3565116670635197, -0.11363604756389506,
      -0.5104100361196521, -0.7810306105465357, -0.9048872803988877,
      -0.8953287433118339, -0.7929666437442218, -0.6524550488605607,
      -0.5263552558760347, -0.45039714264790653, -0.4340263025361027,
      -0.45869402002047577, -0.4842793704122828, -0.4618681853226416,
      -0.34941585288139776, -0.12603233263743824, 0.19904487159405798,
      0.5853632133702621, 0.9685828248655637, 1.2745508867044653,
      1.4366705696960558, 1.4122072588500563, 1.1933854890896705,
      0.8104068296987095, 0.32553706722527487, -0.18034575986145646,
      -0.625457332621099, -0.944723041425086, -1.1030064659719399,
      -1.1007909213187954, -0.9710901562390322, -0.7685983933913351,
      -0.5540479342107014, -0.3779222270734467, -0.2677731586432002,
      -0.2223920325358163, -0.21424719124197927, -0.19940650267999852,
      -0.13218097976196813, 0.019528086153425328, 0.2623956608574052,
      0.5726627826786237, 0.8994789222065187, 1.175934052216143,
      1.335082290837447, 1.3269095658939767, 1.1318869870263288,
      0.7675645483373743, 0.28639143604015677, -0.2348428500543345,
      -0.7114341177690315, -1.0690585562509929, -1.2594697571782478,
      -1.2697951120786748, -1.1232578303926233, -0.8713246650549101,
      -0.5794398811815568, -0.3100990562257056, -0.10763514142992536,
      0.011421065982968881, 0.06004664960085039, 0.07424178263078549,
      0.10025349057053051, 0.17905637474563313, 0.3323539388319471,
      0.5539601194900656, 0.8090024483214414, 1.0413242209537612,
      1.1872892540612536, 1.1924746246323845, 1.0269225104439372,
      0.694927052206221, 0.2366821559885973, -0.27883284629278604,
      -0.7681267127347241, -1.151197087764611, -1.3688657017434158,
      -1.395210091652083, -1.2420861206273706, -0.9547291838586938,
      -0.5996657730690185, -0.2480859603752587, 0.0410693342399423,
      0.2340446608879071, 0.3280533649585205, 0.3486248676597786,
      0.3394425942840313, 0.34755238086120654, 0.40801239730072714,
      0.5321776254009097, 0.70283481395648, 0.8775826669904548,
      0.9996607891609781, 1.013439863419721, 0.8805136229781039,
      0.592113716038439, 0.17446280750362167, -0.3145377234493707,
      -0.7966781751294887, -1.1901897705482423, -1.4277949964626282,
      -1.4716179301330465, -1.3212810780901851, -1.0132187363582765,
      -0.6114403765557974, -0.19211673588701994, 0.1741112930612858,
      0.43767475440155323, 0.5796500697710159, 0.6131231587466872,
      0.57624450596805, 0.5190240292746606, 0.48751584199389286,
      0.5096845347943764, 0.5867631055323648, 0.6924358559572708,
      0.7800929880245008, 0.7962507760536104, 0.696572865226121,
      0.460197394135511, 0.09846421433004965, -0.3444506751470423,
      -0.7994126761362317, -1.1869370899948808, -1.4349890364854625,
      -1.4955740216245403, -1.3559794406489185, -1.04184692304281,
      -0.6112972907485237, -0.1415716265439279, 0.2884803721710859,
      0.6157175519131438, 0.8055767074307044, 0.8574174750791645,
      0.8012192502348411, 0.6867316423781065, 0.5681027204069389,
      0.48813519047845016, 0.4663619743202747, 0.4940826715564362,
      0.5376367786404909, 0.5489949020755956, 0.48079707300413627,
      0.30176617850966836, 0.008288385796710485, -0.3710807834717099,
      -0.7796043535244773, -1.1440587620755363, -1.391327865961695,
      -1.4657772396400532, -1.3430305206747066, -1.036632901769032,
      -0.5958547486078318, -0.09510918790591838, 0.3824372867595424,
      0.763031864916073, 0.9978263908884426, 1.0719470905498665,
      1.0050552130312782, 0.843488952926982, 0.6462150357131626,
      0.4683666954419717, 0.34670724674253683, 0.2907941738373458,
      0.28207813571607554, 0.2810572073406815, 0.24046958253594436,
      0.12090376109754997, -0.09544862888571531, -0.3967048036395003,
      -0.7412061296308923, -1.0656846555662796, -1.2997579074539785,
      -1.3831413337418268, -1.281202947981905, -0.9948446974734824,
    ]);
    const expected = [
      [
        -2.2836884721356427, 0.6751591506481674, 2.1121688940947694,
        2.5211602064482497, -0.3442101001012661, -2.5465929981051603,
        -2.3743897972030115, 0.8640156345251762, 2.259994141105428,
        2.3220815680872393, -0.5298096969916132, -2.8341357646248806,
        -1.9301418316612269, 0.9715355467411152, 2.451655349450551,
        2.0725583249266677, -0.8180357021024713, -2.920508998060851,
        -1.7374831622636169, 1.3733115940922025, 2.144211797029258,
        2.576376938919337, -2.605431119506034, 0.41477065305025873,
        2.1560488809228437, -2.7731948492218277, 0.8738148427134508,
        1.8212778059527004, -2.866781319114973, 1.3116334027843124,
        1.4359147150976375, -2.883670871684044, 1.7161653636425853,
        1.0101209047869737, -2.8229040075412994, 2.0761614653790614,
        0.5552719359328592, -2.685670978588881, 2.3815148446626804,
        0.0836469121971276, -2.475303423300747, 2.6235655070095536,
        -0.39187640964782533, -2.197180513940143, 2.7933820764460413,
        -0.8455440937928594, -1.9057753303643128, 3.0136415586112695,
        -1.5487728431605106, -1.0454260015657024, 2.215415204451087,
        -0.4912053977063475, -3.1031078069938163, -3.6780545061102603,
        -3.5928515959153757,
      ],
      [
        0.8639367707743715, -0.37837275265131237, -0.06505645948437978,
        1.1052340446662325, 1.1475097059763608, -0.9671287527889667,
        0.009700242475103133, -0.6883692741536209, -0.6251162948422089,
        0.28016517218312464, 1.4911391801548999, -0.7451656217538651,
        -0.5022744864748733, 0.8521119730575069, -0.08776265674505995,
        -0.9762412567153705, 1.2891535550595417, -0.5078297889239304,
        -0.7135258727460321, 1.3193689066253533, -0.7867750499303341,
        -0.42044829880227563, 1.2583946094174536, -1.0072607296055345,
        -0.11030523847289829, 1.1266871399796994, -1.1670338821982882,
        0.20198683499616943, 0.9319707638241698, -1.2575506677967796,
        0.49865300078707425, 0.685864741991476, -1.274227255834282,
        0.7628964757814501, 0.40282884806279845, -1.2166799548819154,
        0.9798249441333087, 0.09950194890780815, -1.0805943570986516,
        1.2078268622100499, 0.07337090725072982, -0.5118175339313092,
        0.2785926472658148, 0.06832962279329391, -0.33444785917666603,
        0.530190023113004, -0.43248442022448436, -0.8596741641106111,
        1.2673969882976204, -0.5734115256118775, -0.5951364254665902,
        1.2136745870801822, -0.7562324278387917, -0.3682417592958926,
        1.1811527765280996,
      ],
      [
        -0.0410297504488559, -0.1634987908444422, 0.37547183717664606,
        -0.3156999590318265, 0.2118137394705763, -0.17552427082304692,
        0.07546798393049199, 0.4298561658144578, -0.4732717015632183,
        0.3995541190686253, -0.2911147789278884, 0.15845349356802757,
        -0.036309747853447975, -0.03383726856247295, 0.03620080351062981,
        0.004743935204737225, -0.03896622466698458, 0.030347155813786417,
        0.011001975725552362, -0.04050974705949254, 0.02675435970224081,
        0.015541024539791762, -0.04131724607629547, 0.022900204316977677,
        0.020056232428910515, -0.041484951995453996, 0.01859606832158655,
        0.024101585735535752, -0.04112652028264694, 0.014176620900599358,
        0.02799875315776955, -0.040161716578601396, 0.009406589670847489,
        0.03132565900424601, -0.03865782706659426, 0.004668842932365117,
        0.034391598150524144, -0.036613564450788234, -0.00030516661067656015,
        0.03681315425362878, -0.03404768847967204, -0.0050963112005587225,
        0.038880524837375745, -0.03103728058716686, -0.010001327735644928,
        0.04026021346067301, -0.02755125233664087, -0.014577798581728424,
        0.041216727098793524, -0.023741996809465725, -0.019144850481471916,
        0.04147603976896929, -0.019528164290805342, -0.02325032565039529,
        0.0412706216652428, -0.015132061228876672, -0.0272292688491347,
        0.0403934627165871, -0.01042265105837557, -0.030633448712788055,
        0.039039030854073495, -0.0056846333613640295, -0.03380674883773695,
        0.037072654435020225, -0.0007389965967301113, -0.03632368474520673,
        0.0345821550205836, 0.004399291593259011, -0.031082628917554547,
        0.0699467927377288, -0.015636858328286624, -0.4026213164816165,
        0.510225202225561, -0.08948861921945397, -0.1215091853752362,
        0.12021641066809817, -0.08063220611950439, 0.017737115435039013,
        0.03535669809107071, -0.047476587223721854, 0.015093720569056357,
        0.028555961327219027, -0.03985939491089656, 0.008160654937770063,
      ],
      [
        0.022489663542356497, 0.03188950264455002, -0.10885913717196777,
        0.09594837814869038, -0.06631706122396351, 0.03484726437313777,
        -0.01160709553462839, 0.0008688185438156997, 0.0012688483324268104,
        -0.0006535536762892794, 0.00011919100749090828, -4.8688212797205435e-6,
        7.515639107017718e-6, 8.549950641660828e-6, 1.8074338549351582e-7,
        -8.365354144755871e-6, -8.831030912466232e-6, -7.653477442209571e-7,
        8.040300612428067e-6, 9.079457031587562e-6, 1.3487693041580148e-6,
        -7.682801821028322e-6, -9.290079834992017e-6, -1.9212797685075887e-6,
        7.303046403278167e-6, 9.469839181835999e-6, 2.485126741275526e-6,
        -6.902743948424279e-6, -9.623016943085289e-6, -3.0463925176132896e-6,
        6.474372448384376e-6, 9.741805802958603e-6, 3.5995386925993997e-6,
        -6.018310178256001e-6, -9.820296309358153e-6, -4.134308216837841e-6,
        5.544966938907082e-6, 9.865044860846149e-6, 4.651753018067027e-6,
        -5.057814962569835e-6, -9.881945571564655e-6, -5.158643272881546e-6,
        4.5498722628263685e-6, 9.864600534510143e-6, 5.650999216638697e-6,
        -4.02037588479292e-6, -9.806506695250369e-6, -6.118359644844712e-6,
        3.4796380725920935e-6, 9.71367342642088e-6, 6.560607643316493e-6,
        -2.9327547461203575e-6, -9.593457430743424e-6, -6.985076727481573e-6,
        2.3734171002148188e-6, 9.441039307768164e-6, 7.3895014230795854e-6,
        -1.7996892743486105e-6, -9.249490797169876e-6, -7.763540129511316e-6,
        1.2214623291762404e-6, 9.024111104792745e-6, 8.10595765675158e-6,
        -6.452675789633754e-7, -8.773517600984299e-6, -8.424503920529409e-6,
        6.557886986569063e-8, 8.494583275189951e-6, 8.718730198022607e-6,
        5.207187604471937e-7, -8.18012044316681e-6, -8.97872613167913e-6,
        -1.1044725466398736e-6, 7.834560011333049e-6, 9.202208620608116e-6,
        1.677945443654671e-6, -7.4675316525720565e-6, -9.397176012713509e-6,
        -2.2457949328183062e-6, 7.077657083978094e-6, 9.565040435931141e-6,
        2.8122925034573565e-6, -6.657648904130076e-6, -9.696612012234333e-6,
        -3.3693227528970426e-6, 6.210921831357845e-6, 9.788645867177987e-6,
        3.908204677254706e-6, -5.7478307611369385e-6, -9.849202244305059e-6,
        -4.432663510433809e-6, 5.268744896814361e-6, 9.881536977710338e-6,
        4.948073235312261e-6, -4.7664281447177734e-6, -9.877438189172358e-6,
        -5.447625729597074e-6, 4.243147016420104e-6, 9.832797496721584e-6,
        5.921979774293758e-6, -3.7096652898123817e-6, -9.755535511118905e-6,
        -6.373885669439221e-6, 3.1680429108588817e-6, 9.650672732229074e-6,
        6.80973259619051e-6, -2.611235746237815e-6, -9.511193431186842e-6,
        -7.2242502221333e-6, 2.040251720760295e-6, 9.332232794072223e-6,
        7.607732302666868e-6, -1.4659286801752705e-6, -9.121360020520126e-6,
        -7.961930459287418e-6, 8.919092115375625e-7, 8.885221081918288e-6,
        8.294127839866044e-6, -3.1147035209248083e-7, -8.618169281921308e-6,
        -8.600774090893747e-6, -2.7572148168947895e-7, 8.314696489736967e-6,
        8.872094046490614e-6, 8.59096011242589e-7, -7.981804248276509e-6,
        -9.108833795753754e-6, -1.4335816747234438e-6, -0.019031396767358915,
        -0.026919335139293205, 0.09198385972205703, -0.08103360581787528,
        0.0559957018820624, -0.029452527751164224, 0.009826549962776604,
        -0.0007421956689533204, -0.001060072327564284, 0.0005533753185871918,
        -0.00010744064726529819, -3.6952490971252786e-6, -8.001232222243676e-6,
      ],
    ];
    const result = wavedec(data, "db14");

    const reconstruction = waverec(result, "db14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db14_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5097551607559423, 0.939055090214596, 1.2242153633187594,
      1.3311260589891516, 1.261100944011193, 1.048499012045932,
      0.7508653986212094, 0.43416012588337893, 0.15681202282842227,
      -0.043437682474171735, -0.1567043703365184, -0.20050698529043703,
      -0.2120203311738106, -0.23522428391219075, -0.3064367554550623,
      -0.44211688881525535, -0.6322289691651252, -0.8410176377183448,
      -1.0151263998918014, -1.0970807117605195, -1.0407393790001824,
      -0.8247551541919269, -0.4605237789331699, 0.007565455361407153,
      0.5098669793590205, 0.9655066054880821, 1.2994242762231543,
      1.4583842899198456, 1.42213391390588, 1.207065427048055,
      0.8615643733047759, 0.45425257874669556, 0.05805344246357852,
      -0.26600830245404106, -0.48135264858680943, -0.5817837307729798,
      -0.5895653311276859, -0.5463694867565537, -0.4996257309134299,
      -0.48793498824646236, -0.5294101985979578, -0.6160182422098243,
      -0.7154265101761506, -0.7799022400006453, -0.7599702709227634,
      -0.6192736215178634, -0.3467232011620274, 0.037337849951378066,
      0.48275093117795603, 0.9187873016103569, 1.2689410167254493,
      1.4677658886017793, 1.47569578784311, 1.2882393445654476,
      0.9372910665459617, 0.4842158841756904, 0.0063663632076783605,
      -0.4197175094199918, -0.7343926590438429, -0.9064652915477615,
      -0.9375557190409965, -0.8584304304687339, -0.7184608305772381,
      -0.5710638513376072, -0.45894238410377625, -0.40293448577129104,
      -0.39730614989632507, -0.4126329844685859, -0.4054413798014989,
      -0.3320212299770953, -0.16272658785870037, 0.10707321826875654,
      0.4524005368167739, 0.8218387484673441, 1.1478928132772355,
      1.3621215338754968, 1.4113688846029773, 1.2710827574643075,
      0.9523744713127575, 0.500979006626435, -0.011749911682890524,
      -0.5037260888341211, -0.8993760567995441, -1.1451520908724941,
      -1.2196645107604724, -1.1361267020906805, -0.9367109209709465,
      -0.680403210144964, -0.42752422360523207, -0.22485647241932033,
      -0.09509754875175014, -0.033203808385698086, -0.010395222219217223,
      0.015384722567453768, 0.0854191817859783, 0.2263645412488885,
      0.4403302480528587, 0.7016208191389788, 0.961157629391169,
      1.1576163821353502, 1.2325662344299584, 1.1458230020422007,
      0.887106626626615, 0.48095786724455913, -0.016491853977975063,
      -0.5282985519964118, -0.972563002720832, -1.2796321733239964,
      -1.4065644296279998, -1.3454415198198306, -1.1236171482597301,
      -0.7959661767638397, -0.431147415774609, -0.0953309179615835,
      0.16258913795255497, 0.3207110086108467, 0.3865146061564308,
      0.3915488807644387, 0.38000292230362503, 0.3942894360283042,
      0.4615068770616489, 0.5843941408609714, 0.7392150696601423,
      0.8812085226686858, 0.9562707947776513, 0.9159008495703318,
      0.7315517701298121, 0.404621989494055, -0.0306311399493418,
      -0.5122254574452555, -0.9625971488338938, -1.3049485757309023,
      -1.4799179770804674, -1.4585699081155314, -1.2485795285425167,
      -0.8921344746657603, -0.45609427950938375, -0.016826816142054724,
      0.3565838346802146, 0.6167094206428373, 0.7463322687735361,
      0.7592758102974153, 0.6935561100378387, 0.5988219717228493,
      0.5214607908016409, 0.49129155392239715, 0.513311451305231,
      0.5666269612914128, 0.6108246455174902, 0.5980980551559474,
      0.4879377214215489, 0.2604953635642705, -0.07497004916589345,
      -0.4789398010568723, -0.8883192014873159, -1.2295127334249667,
      -1.4348044078180364, -1.458077502761122, -1.2860146331680449,
      -0.9419897355855289, -0.4816335453150391, 0.01891680885326394,
      0.4792910380237204, 0.831797077707755, 1.0349563929719334,
      1.0805118312226467, 0.9923938691100731, 0.8181311666947553,
      0.6150527725270665, 0.4348867008063474, 0.31070045149660724,
      0.24947216260411237, 0.2320966366612983, 0.22069684133663642,
      0.17121967894579504, 0.04792468463438654, -0.1641265115292358,
      -0.4519758591713855, -0.7750966050598905, -1.0732734804063806,
      -1.280221040682321, -1.3396253141444843, -1.2196192258709422,
      -0.9220278642861937, -0.4839686035771957, 0.028745955373862795,
      0.534941586328957, 0.9550322678019912, 1.2275742315610096,
      1.3215115114377678, 1.2412655970946527, 1.0235864987461347,
      0.7271052464339995, 0.4173033529625704, 0.15070080400791824,
      -0.03780764957631283, -0.1413950228035095, -0.1800723111085376,
      -0.19230972835876992, -0.2218595996940092, -0.30334986537473513,
      -0.4505192065494001, -0.6502751259472423, -0.8642502300209699,
      -1.037591336730302, -1.112833013070255, -1.0453600407836035,
      -0.8164959422679336, -0.440789555900851, 0.03452129452718472,
      0.5379608917627647, 0.9883046623374321, 1.3117147224748373,
      1.4574506391478885, 1.4084110707574613, 1.1840157580482538,
      0.8348059566233366, 0.4301589887411448, 0.042176363790056015,
      -0.27029870196628875, -0.47367023625405763, -0.5647732214670718,
      -0.5681852710126238, -0.5265955380769336, -0.48690404689727534,
      -0.48577790307070196, -0.5384899945113639, -0.6339886151192092,
      -0.737517330049313, -0.8001376574172172, -0.7727024217562165,
      -0.6206438965723624, -0.3356805383132, 0.058721273911163274,
      0.5097497491398533, 0.9451642172197331, 1.2884756230266718,
      1.475789369949509, 1.4702476151576747, 1.2705562729671693,
      0.911505725671229, 0.45634008010219196, -0.01718680657545124,
      -0.43370344632905206, -0.7360052138692322, -0.8959909865896565,
      -0.9182514162644394, -0.8356588684934166, -0.69830477731999,
      -0.5587701728969992, -0.45758931538123504, -0.4126583006592639,
      -0.4152816979976758, -0.43381191480880893,
    ]);
    const expected = [
      [
        -2.2656888909639523, 0.624780815053829, 2.142507887149749,
        2.5205418578045395, -0.42944863457332677, -2.383312725800562,
        -2.3589872634566778, 0.8162138400573627, 2.3010770378813623,
        2.2992686076726283, -0.5942152304416957, -2.6504953112740863,
        -1.9227661228711166, 0.9206839672086831, 2.5101888737885814,
        2.017499066975657, -0.8405883080398773, -2.7717140792860264,
        -1.7455898788757935, 1.341579697852961, 2.168352227792489,
        2.5722365054435614, -2.6798824448451097, 0.5664276678793035,
        2.055222423231453, -2.8705398953874144, 1.1543802219866361,
        1.5849981877585961, -2.932539474006567, 1.6964919338702569,
        1.0375229934645287, -2.860841926000788, 2.1649213154298708,
        0.43905779759065894, -2.657420767435025, 2.5354676066352586,
        -0.18073477201552793, -2.3318699348939824, 2.789340379028302,
        -0.7908022144613553, -1.9008170996179778, 2.9144872290525807,
        -1.360802236295488, -1.3870258763505265, 2.9069680187882847,
        -1.8615483190517208, -0.8348053023149681, 2.8425268975732427,
        -2.4792079953758845, 0.21134982878987738, 1.7547050138052254,
        -1.4120958631324707, -1.033787731826207, -1.4407402057243537,
        -0.36472937783514575,
      ],
      [
        0.9440792121139927, -0.4281673911463894, -0.0844781159311853,
        1.061808393792586, 1.1779950183750412, -1.0683680964251847,
        0.1238076686901858, -0.6162177409146848, -0.6497592462435674,
        0.24103736765892264, 1.534951558811895, -0.8534907744349752,
        -0.3826128153132146, 0.889205308449188, -0.3532133985268662,
        -0.6643553592017278, 1.2548292235466154, -0.898745310680653,
        -0.14418873174216854, 1.0700311642137281, -1.1714605879531645,
        0.37974508449343736, 0.6933100962241523, -1.229189342888287,
        0.8252351777718739, 0.20476988952808223, -1.074242126569197,
        1.1225497251455592, -0.31485824481757235, -0.733210325736626,
        1.223121020976453, -0.7796118695852935, -0.2626318047205331,
        1.11012184655224, -1.1123711021918365, 0.2600149247427072,
        0.8011487662614424, -1.2572842669433788, 0.747318494219926,
        0.3387566408445754, -1.2197191753524828, 0.8607156959492595,
        -0.6387078456975038, 0.4104434711488258, -0.13081352187460746,
        -0.0917056149603604, 0.798401563405614, -0.49316375029722426,
        -0.4741096257503559, 1.2241966302853189, -1.0735477293883413,
        0.10091845211283912, 0.9464698540657662, -1.2623393119274673,
        0.6123047448423106,
      ],
      [
        -0.039297536890744125, -0.14859853616476495, 0.3406698821897087,
        -0.2832552578675705, 0.1891418105746996, -0.16460822731912766,
        0.07546001291864994, 0.42114431556042664, -0.46319232497641644,
        0.3913186359089088, -0.28476730645064247, 0.153923400274572,
        -0.03506258005972288, -0.030357608583919612, 0.029734020383956495,
        0.00877408332156026, -0.03581286508671188, 0.021639428259721812,
        0.017011961471733294, -0.03656997311559599, 0.015300991930280696,
        0.022999478366298825, -0.035697849498475244, 0.008485784468429106,
        0.02827885570019186, -0.0333551043731721, 0.001179298649857347,
        0.03223632097032301, -0.02972310850194669, -0.006005398779403904,
        0.035107490705814474, -0.02489985355073186, -0.01313258544057269,
        0.036403857662488985, -0.019079841796361734, -0.019547954603310064,
        0.03642681340209317, -0.012533617194447616, -0.025387214847935175,
        0.034848094628364704, -0.005438628218006209, -0.030014082230813,
        0.03202883822025108, 0.0017998765784137613, -0.03366006582555532,
        0.027814256431731403, 0.009059000797670759, -0.0357594649849214,
        0.02260345987205518, 0.015847946398473502, -0.03665182187852861,
        0.016408231466519898, 0.022136901401063423, -0.03588157105651997,
        0.009630123639689575, 0.027402856234717905, -0.03389246229757446,
        0.0024228178106728135, 0.031741805938477335, -0.030361424739865986,
        -0.0048545202558772545, 0.03464864942592217, -0.025815095917982363,
        -0.011943935609984545, 0.03636580270895951, -0.020066886836870516,
        -0.018582684115156872, 0.036388352517065944, -0.01401324260037084,
        -0.026040926306321936, 0.01494074671387827, -0.0057663572945321675,
        -0.023260033761618025, 0.060963375231248146, -0.03906371587987546,
        0.030936322221909906, -0.040878588274603556, 0.051015330526129006,
        -0.03596054120205669, -0.0037351536283178263, 0.034785291079303636,
        -0.026618409133307104, -0.010932080602169632, 0.03611199052758371,
      ],
      [
        0.02242183519202548, 0.031729784324927235, -0.10837271294227986,
        0.09547709502515327, -0.06598422539860808, 0.0346973935330746,
        -0.011582715774109425, 0.0008808585615646623, 0.00125942672204672,
        -0.0006492494818591364, 0.00011991747635048842, -5.647440333084954e-6,
        5.723932453268616e-6, 7.620637496566653e-6, 1.190715828558966e-6,
        -6.364382988202131e-6, -7.919768512785533e-6, -2.0076395545705675e-6,
        5.798297621903096e-6, 8.138334508705726e-6, 2.8064765262584305e-6,
        -5.169528604501695e-6, -8.26921885460586e-6, -3.5708301664654392e-6,
        4.493882741787549e-6, 8.31905296912301e-6, 4.297149049973698e-6,
        -3.779069321985422e-6, -8.29309102744942e-6, -4.987079910022794e-6,
        3.022738251314993e-6, 8.184242533974285e-6, 5.63061833072445e-6,
        -2.2304545202333934e-6, -7.987093652413754e-6, -6.212181020439633e-6,
        1.4193511372963781e-6, 7.710293034678278e-6, 6.7282002206053446e-6,
        -6.003843004671317e-7, -7.363767340836659e-6, -7.182957424913465e-6,
        -2.2726853318360542e-7, 6.945000982000568e-6, 7.570674592115138e-6,
        1.0591838109219504e-6, -6.450376283744739e-6, -7.877958942926343e-6,
        -1.8785146997613428e-6, 5.8899801411083645e-6, 8.102044747955471e-6,
        2.6724418735687015e-6, -5.277688627654637e-6, -8.250272504209011e-6,
        -3.441175753619397e-6, 4.61526159791181e-6, 8.321851602649714e-6,
        4.18257236785663e-6, -3.900539051816948e-6, -8.306571840633015e-6,
        -4.881717736805155e-6, 3.144064216030312e-6, 8.202937624190119e-6,
        5.525398251915182e-6, -2.362450877038626e-6, -8.021310486576369e-6,
        -6.11412342987498e-6, 1.5609536565083798e-6, 7.766091021010805e-6,
        6.649006365331205e-6, -7.381903645936027e-7, -7.43074841444616e-6,
        -7.118529399055925e-6, -9.609481915070309e-8, 7.015100143316906e-6,
        7.510430233343376e-6, 9.241002449987535e-7, -6.531988684729983e-6,
        -7.826242525212741e-6, -1.7381950092685973e-6, 5.990617031630268e-6,
        8.070973335076077e-6, 2.5398559840273825e-6, -5.388102851021914e-6,
        -8.237587879708244e-6, -3.3214862071409572e-6, 4.725195559057794e-6,
        8.315816177328754e-6, 4.065784289633983e-6, -4.01621648876971e-6,
        -8.308607884322178e-6, -4.76401163260514e-6, 3.27423828585922e-6,
        8.225026917140529e-6, 5.4186230334406665e-6, -2.499516751330357e-6,
        -8.063090045050767e-6, -6.025405420533672e-6, 1.6930048909899345e-6,
        7.815128955847483e-6, 6.569164523523106e-6, -8.691543481677976e-7,
        -7.485480324096411e-6, -7.041270530254302e-6, 4.3556172460077206e-8,
        7.086889177783658e-6, 7.445865562312422e-6, 7.812656585094964e-7,
        -6.622407401299789e-6, -7.783049562844253e-6, -1.6050906941060386e-6,
        6.087091582764251e-6, 8.041054273460856e-6, 2.414857127424567e-6,
        -5.486202396535382e-6, -8.212338453232807e-6, -3.1940419609703885e-6,
        4.835267401298949e-6, 8.303110531206275e-6, 3.9389117708568626e-6,
        -4.141788152312303e-6, -8.318248168067514e-6, -4.650943158183353e-6,
        3.4032084263992657e-6, 8.250276772860387e-6, 5.3199480255887105e-6,
        -2.624879459550916e-6, 5.620528759130112e-5, -0.00039646561737987783,
        0.0004820626854398624, -0.0004956575955661122, 0.0011828093883437028,
        -0.0017294740842390337, 0.0013507005017092252, -0.0005334583833948098,
        5.96039956517829e-5, 3.553109606096792e-5, -2.3181712723899085e-5,
        -3.272066652185782e-6, 4.181533600491479e-6, 8.313743884709182e-6,
      ],
    ];
    const result = wavedec(data, "db14");

    const reconstruction = waverec(result, "db14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db15", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4982060513947771, 0.9177640787800608, 1.1968477420226789,
      1.3032098702029438, 1.2398298993491514, 1.0421844305461687,
      0.7679637685956963, 0.481929513522315, 0.23979063826645902,
      0.07517115459092544, -0.007094714887789566, -0.02975796793483572,
      -0.03450673225281098, -0.06825947184378434, -0.16808527236017928,
      -0.3487885487580323, -0.5965082148851534, -0.8701304134445389,
      -1.110294702765437, -1.2538011634842343, -1.2498039776259369,
      -1.0736700186009782, -0.7349211268585001, -0.2771323527250885,
      0.2303403720896992, 0.7068863370911876, 1.0779344220488363,
      1.2908331995359972, 1.325485498406437, 1.1972170263923605,
      0.9512976621227535, 0.6506109929750146, 0.35965801507600875,
      0.1289586691356301, -0.016239327339063303, -0.08017841702334941,
      -0.09280917246422558, -0.09914658375548974, -0.144667230553158,
      -0.2606640148541009, -0.45348098798521025, -0.7005472456599505,
      -0.9543719178047941, -1.1536000767543477, -1.2383882411043994,
      -1.166208739606158, -0.9240298377523111, -0.5336879635738858,
      -0.04895217681336241, 0.4551453934348012, 0.8982002223679211,
      1.2117202237388123, 1.3536218156314204, 1.3164468818532447,
      1.1273766168154418, 0.8401624225119699, 0.5210995563463965,
      0.2326299500294003, 0.01870904439129656, -0.10442811807685182,
      -0.1498836724642609, -0.15385090117084949, -0.16328343936769962,
      -0.22081737201532897, -0.3509823989739066, -0.5513982434014981,
      -0.7913611225419683, -1.0183119675397656, -1.1706313628433431,
      -1.193548562978625, -1.054107699275576, -0.7513213029360291,
      -0.3188155036829051, 0.1808623003587466, 0.6690151537339636,
      1.0676092844508358, 1.316067352610352, 1.383976837745937,
      1.2766625472673176, 1.0323497201616407, 0.7117357588833437,
      0.3826660395145449, 0.10379911471106462, -0.08864968685057817,
      -0.1878279855019453, -0.21522209480725912, -0.21213072711343597,
      -0.22600366706872616, -0.2953231644675329, -0.43706894790334755,
      -0.6401315581730873, -0.8664961731758805, -1.0600040358002216,
      -1.1605254278268187, -1.1199511101167459, -0.9158941031155159,
      -0.5595248990709057, -0.09540909288694295, 0.40678727085277006,
      0.8668172480611548, 1.2111192104901536, 1.3886501172814276,
      1.381452678055471, 1.2074306847767127, 0.9147452000725901,
      0.5693241061673326, 0.23867378107521459, -0.023932889869404228,
      -0.19096464816454226, -0.26504683144271535, -0.27533159664148504,
      -0.266940020388725, -0.2863645459279172, -0.3667449942786091,
      -0.5169488703267568, -0.7173934852882861, -0.9237974717135312,
      -1.0779894353760624, -1.123057854251295, -1.0189704335081626,
      -0.7546199874831684, -0.35311441707364555, 0.1311949289408057,
      0.6233824806280872, 1.0438121764377288, 1.3253755790491488,
      1.4279235469347435, 1.346398598144138, 1.110738684344343,
      0.77766762976619, 0.41649678560927705, 0.09252965127492246,
      -0.14778271335461474, -0.2862804537507205, -0.33488619028671474,
      -0.3294794794443358, -0.31761369430844816, -0.34340297900358724,
      -0.4336166699043434, -0.5886899908110108, -0.7810778006074801,
      -0.9614704487090356, -1.071344624565998, -1.0586603127544736,
      -0.8926630414362836, -0.5739283504890291, -0.13695092824167054,
      0.3555589754427355, 0.8254246230962746, 1.1957689573087622,
      1.40774353947449, 1.4331561270919047, 1.2799428249725824,
      0.9892062780227022, 0.624634249784547, 0.25699493191276557,
      -0.05239794956730953, -0.26514608268813056, -0.37287425449892575,
      -0.3963538431151214, -0.37706226266920806, -0.3635298995985547,
      -0.3961466645390633, -0.49447493634560535, -0.6504503463202117,
      -0.8293173832011264, -0.978135418060218, -1.039716297548029,
      -0.9684219177902122, -0.7437264926266359, -0.3779699286108456,
      0.08383363501141622, 0.572277059305217, 1.0080356088859004,
      1.3190680823867718, 1.4563694632126634, 1.404442301132978,
      1.1839576772676046, 0.8460139105852673, 0.45948323440341743,
      0.09463821207417611, -0.19285785832214541, -0.3736520658553879,
      -0.44928345836531336, -0.44867065028133896, -0.41760270825510415,
      -0.4041100882681008, -0.4436277565532767, -0.5478916233782687,
      -0.7005262546607081, -0.8605384620123906, -0.9728733969192426,
      -0.9833430727335877, -0.8540742353309294, -0.5754419796795627,
      -0.17130650447829515, 0.3039604536100656, 0.776107429852293,
      1.166802503418173, 1.4107892612062065, 1.4702231009642417,
      1.3426945607782002, 1.061006752965738, 0.6848183117349065,
      0.2862756945952534, -0.06676829579006155, -0.32578981011174846,
      -0.4712096565267444, -0.5143257946719539, -0.49127186780035415,
      -0.4507445577658821, -0.43881982393067626, -0.48489892733953815,
      -0.5925077176177319, -0.7373995819843921, -0.8735096630830173,
      -0.9452617754248305, -0.9030629128481596, -0.7179600251029825,
      -0.3916016192868026, 0.041196965955800524, 0.5181323015424828,
      0.9621016879966866, 1.2978861286883492, 1.4687817890179942,
      1.4491192748752284, 1.2496154624685443, 0.9142756687414714,
      0.5096575390521939, 0.10919396185097352, -0.2235247512904306,
      -0.44839130442446606, -0.5560458039821375, -0.5671116149139519,
      -0.5238033579472876, -0.47624553635699973, -0.4671706516591721,
      -0.5190516218207235, -0.6270685310535397, -0.7597828919471887,
      -0.8673843717604344, -0.8953986180460725, -0.8003057607105555,
      -0.5629862189156082, -0.19642207216568475, 0.2544888119487709,
      0.7211633459017913, 1.1257271392472787, 1.3981156070220906,
      1.491715811416065, 1.3937186529511023, 1.1276504083234429,
      0.7474882409241704, 0.324847995177374, -0.0675612534894599,
    ]);
    const expected = [
      [
        -2.4863223411519244, 0.38348319867080727, 1.683289331654834,
        2.9278672358331317, 0.29714822669903684, -1.5987519097269423,
        -2.91166972541281, -0.9335927974569024, 1.4426349864776808,
        2.590211887957612, 1.6881017068775392, -1.2459073785754446,
        -2.683204912112761, -2.173324451195139, 1.0007382303665704,
        2.083440942764969, 2.6437640396743554, -0.6416459456530323,
        -1.8546258263954485, -2.9457108760480275, 0.16121069687649658,
        1.5686892816496234, 3.005686540611458, 0.6529567965455974,
        -2.649983482470848, 1.8288460668505597, 0.9499690466020767,
        -2.706440022997558, 1.5577851527127393, 1.266895765056864,
        -2.7400788321317626, 1.2751738359416716, 1.5697465769585106,
        -2.7493618021172206, 0.986369105894994, 1.8514026426510974,
        -2.7320053001795754, 0.6957359991079638, 2.105250649642703,
        -2.6852774992106214, 0.4064959667223339, 2.325631716328686,
        -2.6063777253713556, 0.12069803710210669, 2.508488635627139,
        -2.493762395722032, -0.15927720081108304, 2.650755735219276,
        -2.3458289921602806, -0.4448797025001149, 2.8107007271605835,
        -2.3397232222111586, -0.2995315241534482, 1.8882241337532306,
        0.9689312611457082, 0.19635771945076552, 2.952226822609172,
      ],
      [
        -0.1678261142495478, -0.08172078262062113, 0.9320984289441615,
        0.9968239053541732, 0.02085960241019471, -1.4819174215864992,
        0.22124644163299767, 0.6328866807676943, 0.8457479360790421,
        -0.9695424125284771, -1.2049331766199094, 0.1234978808724243,
        0.94653746372575, -0.6425748274353154, -0.5591489074028191,
        1.55011636462923, -1.4501447203426505, 0.279241730369313,
        1.0556214419322363, -1.4909974476244652, 0.6852055720343444,
        0.6869348802381091, -1.4868782337693696, 1.0571535263551781,
        0.23697512730066683, -1.321539977544695, 1.3110716997632088,
        -0.2332303092528212, -1.01401324824836, 1.4162441515490074,
        -0.6686807276750079, -0.5993342190995569, 1.3594412542199823,
        -1.0185708072254807, -0.1247502460467734, 1.146065512777813,
        -1.2420514698097722, 0.3555747463031985, 0.7984719482962555,
        -1.309111850844031, 0.8619146327835784, 0.6721127607630231,
        -0.9457021328489555, 0.5724706561734484, -0.39138618545937065,
        0.5072611381488284, -0.3408761143449596, -1.0725774225177556,
        1.4427167485209682, -0.6392295833048455, -0.6962682821719847,
        1.4764060722670445, -1.0638563762480915, -0.19568471245225913,
        1.269290603025411, -1.2944957763052174, 0.2763113238368865,
      ],
      [
        -0.15514997348960033, -0.11691695743822583, 0.4138656635931305,
        -0.3921808428203314, 0.31966751230940366, -0.167619753488528,
        0.1988368311173874, -0.14076781032736477, -0.2611012818670394,
        0.33821003654449905, -0.24714415255737385, 0.11029156833354585,
        0.0017163522922552827, -0.050154435688390425, 0.03555256449370553,
        0.006509688983283158, -0.030844284878370817, 0.016613416003896188,
        0.017007150533447823, -0.03198226037924656, 0.011763658825774296,
        0.021376771098044263, -0.031027931516320686, 0.00654459093278163,
        0.025157749030943127, -0.02916191510756622, 0.0010945831295516768,
        0.028157649418609005, -0.02646277300753626, -0.004347886465750218,
        0.03039404335037179, -0.02298146788202515, -0.00970144714971296,
        0.031696022861543, -0.018851960672236642, -0.014738929073036372,
        0.032133161737186916, -0.01415523105803323, -0.019381679591967915,
        0.031584568558887936, -0.009071698090755352, -0.02343257696196532,
        0.030174943331121144, -0.0036990204890712847, -0.026831728265875612,
        0.027836100662719583, 0.0017520991825587153, -0.029428262135285925,
        0.024744798847990634, 0.007183719484868797, -0.03119390713710877,
        0.02088209553077612, 0.012373405879213933, -0.03203597914343113,
        0.016467764192013457, 0.0172404390244468, -0.031965957209458246,
        0.01152302583081287, 0.021569514623250616, -0.030955707731629655,
        0.006296554693497354, 0.02531365826562247, -0.02905886168609117,
        0.0008362204471140071, 0.028281764458306533, -0.02631298799359188,
        -0.004604939466392771, 0.030731769651392033, -0.018928137992184672,
        0.01239431009447329, 0.094774422613002, -0.14479764579817134,
        -0.26554155075008845, 0.7077426730301928, -0.6280599097262775,
        0.38081665143657506, -0.2547236880388622, 0.1424673799926187,
        -0.0471244769688063, -0.014144390728236568, 0.02464494442520032,
        0.0031355574279473514, -0.029794614396327357, 0.023788412424419824,
        0.008532009141429419,
      ],
      [
        0.016860876323707488, 0.04120932923883582, -0.11038825817285206,
        0.09351039526700802, -0.07068566541395886, 0.0463802564930883,
        -0.023499810131840913, 0.007845362155511947, -0.0009707192374237778,
        -0.0004833665802785443, 0.0002723479700932855, -4.9654578940978744e-5,
        5.8941852433819045e-6, 2.204764551248781e-7, -3.7059631421677025e-6,
        -3.7057970130398836e-6, -1.805763380690228e-7, 3.5166415576578242e-6,
        3.869135001902708e-6, 5.416106930661368e-7, -3.3008643746143727e-6,
        -4.003460569712779e-6, -8.980311560129105e-7, 3.0613875845522916e-6,
        4.108499738739526e-6, 1.2472816014685161e-6, -2.8005962211783945e-6,
        -4.184646983171081e-6, -1.5881946461107144e-6, 2.519158512924324e-6,
        4.2305845363477e-6, 1.9181885090096425e-6, -2.218538671210717e-6,
        -4.244863998475045e-6, -2.233505229658517e-6, 1.9021761325943135e-6,
        4.228208046601329e-6, 2.5320374872079354e-6, -1.5728774014952187e-6,
        -4.1818070028445e-6, -2.8129702043594625e-6, 1.2317480807201035e-6,
        4.105112463489888e-6, 3.074007537046913e-6, -8.808257604660391e-7,
        -3.997660595061303e-6, -3.3119162691007195e-6, 5.23967326700173e-7,
        3.861172964241548e-6, 3.5252992400655584e-6, -1.6413037338676523e-7,
        -3.6976092216050435e-6, -3.713927250315983e-6, -1.9740217503093545e-7,
        3.507161975259635e-6, 3.8760281659518976e-6, 5.582992569713339e-7,
        -3.290299880335874e-6, -4.009127395501944e-6, -9.145951988466803e-7,
        3.049642505715285e-6, 4.112732871523553e-6, 1.2634838332871647e-6,
        -2.7877933937478203e-6, -4.1873640559886235e-6, -1.6037899800428527e-6,
        2.5055611866494754e-6, 4.231934894733187e-6, 1.933187783311312e-6,
        -2.204198607026093e-6, -4.24488014578815e-6, -2.2479201842148974e-6,
        1.8870297246480147e-6, 4.226718485571423e-6, 2.5456327578647884e-6,
        -1.5570907988096804e-6, -4.17878966039403e-6, -2.8255336647267395e-6,
        1.215600504465662e-6, 4.100762444875498e-6, 3.0855849349432723e-6,
        -8.643691973828525e-7, -3.992032831989612e-6, -3.3225294345474753e-6,
        5.071602198125364e-7, 3.854133813573261e-6, 3.5347283453413344e-6,
        -1.4716885308710552e-7, -3.6891960645191947e-6, -3.7220058183755636e-6,
        -2.1423800912016292e-7, 3.497611135919527e-6, 3.882845725874577e-6,
        5.749699546780203e-7, -3.2796847695226124e-6, -4.014724317168406e-6,
        -9.311321233554e-7, 3.0378647188718102e-6, 4.116915384236323e-6,
        1.2796757607716855e-6, -2.774944026623719e-6, -4.1900203701137376e-6,
        -1.6193720032566767e-6, 2.4919086761665385e-6, 4.2332033512541865e-6,
        1.9481460457064624e-6, -2.189826846915883e-6, -4.24482427612773e-6,
        -2.2622879875854625e-6, 1.8718687156196524e-6, 4.22517706228763e-6,
        2.5591987171379074e-6, -1.5412754518595072e-6, -4.175710040411186e-6,
        -2.838063279554838e-6, 1.1994186061553357e-6, 4.096332136950413e-6,
        3.0971018237830005e-6, -8.479038346455669e-7, -3.986338725555762e-6,
        -3.333079688213788e-6, 4.903598780226971e-7, 3.847049100022291e-6,
        3.54411362425585e-6, -1.3019930425221592e-7, -3.6807266892962573e-6,
        -3.730035017020835e-6, -2.310849413241783e-7, 0.010232077678657362,
        0.02447922174130352, -0.06576248652543691, 0.05532959528407087,
        -0.04161239564747059, 0.02731511713466348, -0.013962561092552596,
        0.00477149577724703, -0.0006475614035027878, -0.0002692791052548456,
        0.00015780643387384196, -3.259079285269591e-5, 5.2836164476217634e-6,
        3.923119375348448e-6,
      ],
    ];
    const result = wavedec(data, "db15");

    const reconstruction = waverec(result, "db15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db15_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5041831404357309, 0.9263692050109887, 1.2026754776627133,
      1.3009299951378241, 1.2263999029184594, 1.018332703117596,
      0.7383555789548903, 0.45385919838952793, 0.22074902605822933,
      0.07005396866126012, 0.0018151268362325834, -0.012280245431341739,
      -0.01838670924203395, -0.06507094838091582, -0.18722898723512527,
      -0.39378733991809933, -0.6626205993642722, -0.9442004470817242,
      -1.173164489272525, -1.2848696080211628, -1.2326330925364248,
      -1.0011259408367472, -0.6123328888530424, -0.12238798477261413,
      0.39005962456458765, 0.8411089311323807, 1.1602025100878133,
      1.3054114056802668, 1.271621240686387, 1.0896634414679884,
      0.8167672047489158, 0.5209312709749698, 0.2633508169504235,
      0.0834853243257464, -0.009395912691911146, -0.036102865939421164,
      -0.03904777179948876, -0.06782487127433168, -0.16284516742239719,
      -0.3415380808658991, -0.5909488651785206, -0.8688605767197672,
      -1.1132991335670008, -1.258036560548315, -1.2500815793635018,
      -1.064567720792933, -0.7130726455054017, -0.24306898558612,
      0.27151605488611563, 0.7463610405982357, 1.1054464931578676,
      1.297718408926561, 1.3075733618448486, 1.1566131665718002,
      0.8963660519706599, 0.5939891280709271, 0.31474989869054615,
      0.10586949576615301, -0.01410441516835692, -0.05772898937281769,
      -0.06242790243997981, -0.0774148086610782, -0.14742247327395647,
      -0.2977251020174813, -0.5245947300219489, -0.7938869120611439,
      -1.0482864310911253, -1.2214294903715572, -1.255263981970268,
      -1.1161032627538008, -0.805112602454361, -0.36037071897573586,
      0.15019219145289367, 0.6433259525704982, 1.0388748794187082,
      1.2774805524272952, 1.333157963876878, 1.2176510809419492,
      0.9755916249464999, 0.6718472122557542, 0.3744364427872022,
      0.13749121481216653, -0.01132434778001401, -0.0757509576185677,
      -0.08708923647007392, -0.09277182831782235, -0.140561732874598,
      -0.26274133371642194, -0.4646538522924578, -0.720799244726863,
      -0.979674883054064, -1.1762167259168828, -1.248653407686244,
      -1.155372344810566, -0.8873351580424796, -0.4726895564105947,
      0.027780557556890892, 0.53336463292106, 0.9611818733888777,
      1.244561675413454, 1.3474581364885834, 1.2713284317688283,
      1.052845759953607, 0.7531735605725622, 0.44168484496922206,
      0.17840744918932538, -0.0002491178773224023, -0.08884482380044106,
      -0.11155983468557187, -0.11268421379052845, -0.14165010240669546,
      -0.23675178213324505, -0.4120402869621427, -0.6510306737106273,
      -0.9090450232245848, -1.1237100816445746, -1.2309413747280114,
      -1.182251790141782, -0.9588170162949147, -0.5785230027679373,
      -0.09400796822210955, 0.4179712117255775, 0.8732751936157486,
      1.1990642380354082, 1.3497590908902102, 1.3163101912020605,
      1.1265269537839617, 0.8365177994986054, 0.5155680769193807,
      0.22844438621335367, 0.01972887581163202, -0.09580126839381803,
      -0.13436781463786115, -0.13582581894756218, -0.1498761681559378,
      -0.2196913798718073, -0.3674676129760025, -0.5858969288235762,
      -0.8379749611631634, -1.0653356489116985, -1.2030215183746258,
      -1.1968563869795354, -1.0188471222675763, -0.676500000869916,
      -0.21347894498425946, 0.29874275729807875, 0.7762582763902377,
      1.1413285693580457, 1.3395646133235402, 1.3514043834828633,
      1.1950648752543052, 0.9203418083636022, 0.5949764907123045,
      0.28719948532813344, 0.04900304797858179, -0.09555401388870316,
      -0.1540754904610213, -0.16078693862665416, -0.1642494123972238,
      -0.2112679040409723, -0.3314345027518791, -0.5265683452954385,
      -0.7680060888178972, -1.002602216935152, -1.1659690119739918,
      -1.1995347279475919, -1.0669400498698307, -0.7654084111523958,
      -0.3289887994165302, 0.17734685624183322, 0.6714083020570033,
      1.0719270468730329, 1.3166088841648143, 1.3755884227972959,
      1.2569543126646783, 1.0030523889393637, 0.6786406717686121,
      0.35404855914913697, 0.08774212151810662, -0.0872051172829515,
      -0.16931277645939502, -0.186107021647097, -0.18362361704154515,
      -0.21096989496943364, -0.30421504384175396, -0.47404509534661426,
      -0.7006096934514613, -0.9370680094265863, -1.1210161514017591,
      -1.1908600629027377, -1.102844557057092, -0.8442190766609181,
      -0.43897815244163274, 0.05548769642184263, 0.5601505151793865,
      0.9916533298568775, 1.2808634040609197, 1.3880318901976922,
      1.3107878221571614, 1.0830352352211359, 0.7651578482341805,
      0.42815773359222875, 0.13588454457636245, -0.07004658736263575,
      -0.17880912558938275, -0.2103085124799195, -0.20672369350334133,
      -0.21807940024809025, -0.2858540196618952, -0.4291362117498186,
      -0.6371551999707381, -0.8703064586911173, -1.069524634453458,
      -1.1716163672173794, -1.1265471278190489, -0.9121059574552532,
      -0.5420033263086257, -0.06512861788608906, 0.44402938994573654,
      0.9015068758313296, 1.232538874290693, 1.388115254799753,
      1.3552863697933528, 1.158689469005248, 0.8530212874411923,
      0.5085000318127131, 0.19313795541004863, -0.043577853391011,
      -0.1814233057013708, -0.23193108335948232, -0.2321753529166106,
      -0.23168926409736762, -0.2761672485730599, -0.39244285602099016,
      -0.5788807301761996, -0.8038717595678943, -1.0129551379932376,
      -1.1427799308657711, -1.1382704288187837, -0.9684619035504789,
      -0.6367653552219187, -0.18282877284596108, 0.32467726040116685,
      0.8026730713543412, 1.1720819875930926, 1.3754441320421937,
      1.389327303352404, 1.2284619943530362, 0.9406520451785997,
      0.5938762263434806, 0.25898371113428575, -0.007518701757059154,
      -0.17617036325108137, -0.24956551011122247,
    ]);
    const expected = [
      [
        -2.471265890418109, 0.3623529480861103, 1.622225485946662,
        3.0094665876020397, 0.12349349745201536, -1.4738377106944618,
        -2.789565583993529, -0.976793668419162, 1.4095629278639987,
        2.6149466887509196, 1.6215667332135564, -1.277410589373692,
        -2.5369862267881937, -2.212531207090402, 0.9932769541723682,
        2.0433504845389217, 2.6825535719059888, -0.7977202455635422,
        -1.6472390315480203, -2.9187398493565695, 0.15232892213968563,
        1.5031315487060877, 3.0653693911282183, 0.5457818073748043,
        -2.638710330413775, 2.037850471917833, 0.6588463565133332,
        -2.6709214652908497, 1.928476148703273, 0.7985322658330415,
        -2.6980058848920616, 1.8146814078535674, 0.9373790299622786,
        -2.7199909222223453, 1.6969461747184977, 1.0749017896393493,
        -2.736866342217676, 1.5757507425487438, 1.2105987575145287,
        -2.7486033163799712, 1.4515704370991316, 1.3439564881770518,
        -2.7551572849085577, 1.3248670089430454, 1.4745995628148076,
        -2.757484988003509, 1.2005679325478615, 1.587455299522891,
        -2.7174279152690195, 0.9939643272474151, 1.85398817020793,
        -2.96721215123246, 1.3611500892786557, 0.8406549518835196,
        0.16553706778807067, -1.7861128558882686, 1.9081736417734667,
      ],
      [
        -0.26373208228188655, -0.118566557836776, 1.132440533682121,
        0.8922815677527837, 0.08789400984746433, -1.5161722024220823,
        0.11992871881449506, 0.7536554942334789, 0.8993325189422473,
        -1.1336758261348248, -1.1120507154297676, 0.02312597685993175,
        0.9984220365820348, -0.5089820900600944, -0.8257651903909066,
        1.6636401928289775, -1.1698983090912014, -0.26639207731817766,
        1.3857504195688406, -1.1978679304668673, -0.10780308915458682,
        1.3218031323348916, -1.318418490475149, 0.0945965033145135,
        1.2219073455293032, -1.4123231096388018, 0.2963740626576996,
        1.0965783095528259, -1.477761188105525, 0.4926711055675252,
        0.9487165020964503, -1.513314355897376, 0.6791412744319308,
        0.7816083630063574, -1.5181996461457796, 0.851649366327039,
        0.5989533707535537, -1.4923292221027895, 1.005874313406077,
        0.4027950879336113, -1.4359131478193012, 1.1452051991270884,
        0.12933289161178757, -1.06152463790759, 1.017226570310171,
        -0.11342439486967522, -1.030760598571335, 1.2850702586169527,
        -0.37339841059162443, -0.8311426954928965, 1.210598416431891,
        -0.4271711079097692, -0.7824444805371561, 1.299285307720345,
        -0.6425373659268933, -0.5979242576379672, 1.2986711052284883,
      ],
      [
        -0.16190739309500823, -0.11242609158228478, 0.4143316705666369,
        -0.3992107906533951, 0.3283919181983243, -0.17102464052468933,
        0.19758453405004703, -0.13542505540808059, -0.2724479322756606,
        0.34838808793315734, -0.2535588565782805, 0.112746224173675,
        0.0034468206252351533, -0.055726431954787034, 0.04218091654987932,
        0.003802020473136748, -0.035307387553043676, 0.025362722069394862,
        0.012152343710831404, -0.03705378155227895, 0.023298887277685414,
        0.014729481315895483, -0.037425305993499844, 0.02109143634678623,
        0.017262683922065473, -0.03758695742642033, 0.018717569638479512,
        0.01964553615055205, -0.03755026358534607, 0.016293472737306407,
        0.021979285435500834, -0.03730301990708637, 0.013730700445422841,
        0.02413585381263453, -0.036862034340496216, 0.011142886501804436,
        0.026220164550207453, -0.03621117550600356, 0.008446229386564526,
        0.028103182429605637, -0.035375537862435955, 0.005751213916599497,
        0.029893482580786276, -0.034335055461547116, 0.002978610940992943,
        0.03146159710309591, -0.03312298159236087, 0.00023521186791021088,
        0.032919691742116244, -0.031715276085861596, -0.0025537334671885976,
        0.03413836078372429, -0.030153163262372395, -0.005285670711084646,
        0.03523325789246157, -0.02840855917843554, -0.008030980128042075,
        0.036075499536938505, -0.02653041405553392, -0.010691879703138073,
        0.03678407978693218, -0.024486503645123836, -0.013334498075268686,
        0.03723105808218361, -0.022333206863959707, -0.015866450659836676,
        0.037536368971106814, -0.020052388869607998, -0.0184232700255183,
        0.03732793290464606, -0.02192826531724465, -0.08424397669943373,
        0.010798186986293356, 0.12355036998126831, -0.08599751567640805,
        0.06434452156883051, -0.025462325333465492, -0.015244088708729904,
        0.02628850285824564, -0.0007346103240716839, -0.0317097045244632,
        0.03437088163391977, -0.0024441145419711744, -0.03176198471724909,
        0.03287147264228166,
      ],
      [
        0.017073563014830744, 0.041808684966811296, -0.1119643425037435,
        0.09490755916297053, -0.07177984584920268, 0.047094048509966145,
        -0.02383728453678047, 0.007940189704834306, -0.000974223761220101,
        -0.000493773811142603, 0.00027678227194898806, -4.9154639908893415e-5,
        6.409414837803949e-6, -4.804972691678921e-7, -4.9211694969867475e-6,
        -4.138766248201263e-6, 6.948539980583814e-7, 4.8486322055897055e-6,
        4.256872282526385e-6, -5.012152113709733e-7, -4.7684498746191474e-6,
        -4.368173131763597e-6, 3.076201244502361e-7, 4.682024423758611e-6,
        4.473213856673156e-6, -1.1441613826923744e-7, -4.5903164260667945e-6,
        -4.573231355255181e-6, -7.968606072298048e-8, 4.492136347742248e-6,
        4.667360240850531e-6, 2.7447019174884664e-7, -4.386806119237739e-6,
        -4.754111457972493e-6, -4.681197357071009e-7, 4.275802310781538e-6,
        4.8341305381672895e-6, 6.603632952049918e-7, -4.1600539219803155e-6,
        -4.908651706285393e-6, -8.524928523276482e-7, 4.038365049034971e-6,
        4.976777864405422e-6, 1.0442186903229086e-6, -3.910155349118957e-6,
        -5.037093429597526e-6, -1.2337289355006242e-6, 3.7769697670606867e-6,
        5.090345123712485e-6, 1.42083390318991e-6, -3.6397006104816635e-6,
        -5.137763646486979e-6, -1.606830177140936e-6, 3.4971454313807554e-6,
        5.17842427012354e-6, 1.7913603132591083e-6, -3.348819832133826e-6,
        -5.210990052819718e-6, -1.9726264250465995e-6, 3.1963300849219154e-6,
        5.236308700475475e-6, 2.1505259421482717e-6, -3.040526189959828e-6,
        -5.25560582705276e-6, -2.3263618398975653e-6, 2.8801984522078118e-6,
        5.267932535827305e-6, 2.4997146625233876e-6, -2.7149558436828837e-6,
        -5.27203477676501e-6, -2.6688096229313544e-6, 2.546458256122262e-6,
        5.2688600626131585e-6, 2.8336362533883248e-6, -2.3755073673787674e-6,
        -5.259626663054044e-6, -2.9955054478662707e-6, 2.2008850538586863e-6,
        5.243364271862329e-6, 3.153941333071268e-6, -2.022290409998539e-6,
        -5.218905062828041e-6, -3.3072009974704476e-6, 1.8414286527764978e-6,
        5.187294186398928e-6, 3.4553705080673486e-6, -1.6590468303319363e-6,
        -5.149739575314497e-6, -3.599769864671144e-6, 1.4739168295997967e-6,
        5.105251602781564e-6, 3.739872135788238e-6, -1.2858240153209827e-6,
        -5.0527510186549565e-6, -3.8739745842771e-6, 1.0965102118512737e-6,
        4.9933774882156774e-6, 4.00226362054002e-6, -9.066613039208264e-7,
        -4.928324889411482e-6, -4.126069048876196e-6, 7.15037381331948e-7,
        4.856585651529635e-6, 4.244817921903992e-6, -5.215057511081826e-7,
        -4.777170518697743e-6, -4.356855418750665e-6, 3.278357553943445e-7,
        4.691309579025077e-6, 4.46247133602507e-6, -1.3464554705136368e-7,
        -4.600178250843706e-6, -4.563005457013575e-6, -5.931859515461687e-8,
        4.502751725984919e-6, 4.6578434287603875e-6, 2.541120963273257e-7,
        -4.398131248106317e-6, -4.745385387084171e-6, -4.4794738451783944e-7,
        4.2876323037102035e-6, 4.826026758409332e-6, 6.402805796751674e-7,
        -4.172406795091933e-6, -4.901116872536597e-6, -8.323812618521306e-7,
        4.051412745987942e-6, -3.574729819139643e-5, 0.00042478143840593053,
        -7.541045047058333e-5, -0.0007796963486526496, 0.00041361038596890426,
        0.0006569468930606529, -0.0012360597570691503, 0.0009328062030855601,
        -0.0003552186031997249, 4.883899653694567e-5, 1.649276078736563e-5,
        -1.1891560452803702e-5, -3.592735595074706e-6, 9.35622810972837e-7,
        4.910378852194982e-6,
      ],
    ];
    const result = wavedec(data, "db15");

    const reconstruction = waverec(result, "db15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db16", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5080066621153512, 0.9354028283108347, 1.2185931051523886,
      1.3239405999696805, 1.2535823064658773, 1.042834648995754,
      0.7499932206845453, 0.44120229589228577, 0.17425632020318232,
      -0.014599151440468638, -0.11762308231271129, -0.15468606842893284,
      -0.1649585630741067, -0.19352111746836886, -0.2765385265997365,
      -0.42899954481392555, -0.6383514685328159, -0.8658264520586065,
      -1.0552552637857835, -1.147205452084214, -1.0948656291316328,
      -0.8775893721778378, -0.508544633611286, -0.03435686183224104,
      0.473375811454209, 0.9327808645897882, 1.269141291688697,
      1.4308734699215533, 1.400211824050465, 1.196060846507399,
      0.8684087251028552, 0.4857757997976051, 0.11887236645873311,
      -0.17546290116730429, -0.36610328087878785, -0.4524331222799701,
      -0.46110869292719836, -0.43584381716482035, -0.42305669371249777,
      -0.4572507051509453, -0.5500396362178472, -0.6857590846256637,
      -0.8248798111333033, -0.9143970766418607, -0.9025349788912074,
      -0.7539465386304478, -0.46140711569264864, -0.050841202897763615,
      0.42181959372930355, 0.881394643452876, 1.2493435971698694,
      1.4609828723555873, 1.479854865800631, 1.3057501630327815,
      0.9744351035344476, 0.5491769565472979, 0.10617381154029482,
      -0.2825202916355624, -0.5644042799277493, -0.7165685827147789,
      -0.7480502341341958, -0.6941529713293209, -0.6044139310242628,
      -0.5274880597632257, -0.4969656026443821, -0.5218509194916634,
      -0.5841888085977055, -0.6444467867679606, -0.6532292611353914,
      -0.5662324051808517, -0.35847401476232715, -0.033976226440466994,
      0.3717928290897781, 0.7975839577989131, 1.1689384859825687,
      1.4146886156047191, 1.483371041455223, 1.3555071232904892,
      1.0486898372769753, 0.6141768366849991, 0.12577870118551787,
      -0.33627360092493447, -0.7025742901965017, -0.9287479924383568,
      -1.0032533100807726, -0.9470509475752418, -0.8054523750966348,
      -0.6344181665813619, -0.4849384137928019, -0.3895583842022345,
      -0.35450555844751785, -0.3593877955974397, -0.364448309414112,
      -0.3233891683617608, -0.19831590826208806, 0.02721501430518336,
      0.34059966669060754, 0.7002114343005443, 1.0432664830636547,
      1.2997264025283108, 1.408855552631724, 1.334319355290386,
      1.0740158014280747, 0.6621027184348733, 0.16260033411832583,
      -0.34396940264904396, -0.7777225821264679, -1.0762183888353998,
      -1.2069128558459252, -1.1723432002761967, -1.0069461376673783,
      -0.7664977016462007, -0.5129829076298045, -0.2988028667283494,
      -0.1543301201854954, -0.08190847384691674, -0.057698059107606864,
      -0.040724129359597794, 0.013379067615389595, 0.13765368461449384,
      0.3421113669741209, 0.608239953677379, 0.891327206428927,
      1.1301808568815939, 1.2618948456061119, 1.237970099603817,
      1.0376892060412994, 0.6752762779236152, 0.1988904807597607,
      -0.3184765121530141, -0.7941117335483774, -1.1531099741981572,
      -1.3441199845313907, -1.3495452933642273, -1.187813145802798,
      -0.9072921259366096, -0.5735013797404289, -0.25289286782417575,
      0.00270835665875524, 0.16715138023091483, 0.2438413361181312,
      0.2616670369096101, 0.264235463700637, 0.295388216935622,
      0.38491700794771494, 0.5383263964701377, 0.733431035247168,
      0.9247932136984728, 1.054959763049542, 1.069668662936037,
      0.9331232284857434, 0.6393522418187501, 0.216612427284993,
      -0.27648877618859247, -0.7624007043515283, -1.1609197368320872,
      -1.4064708434178428, -1.4622148319340367, -1.327582724823989,
      -1.0374549378513869, -0.6532620983399151, -0.24826840489595803,
      0.10929122598077567, 0.37106544223285615, 0.5178389682572195,
      0.5610507073201514, 0.5364310470947271, 0.491618388247105,
      0.47113203672770443, 0.5027223414357795, 0.588727946696796,
      0.7047464051379847, 0.8060076996427704, 0.8398209965042196,
      0.7608600096774096, 0.5452733663950876, 0.1998551074837706,
      -0.23627265468228736, -0.6981339498141051, -1.1081331943301138,
      -1.3929236072667022, -1.499831343683002, -1.4088245316249952,
      -1.1370903202537452, -0.7350948474738492, -0.27509565686342974,
      0.16507307623675205, 0.5189800384589378, 0.7452307682159175,
      0.8345267129729705, 0.8086035697039453, 0.7115614404464738,
      0.5960103511539837, 0.5077350184263185, 0.47291012726498177,
      0.4911921952843363, 0.5364593539693094, 0.5649649889562204,
      0.5287284608950374, 0.39060325815936753, 0.1369945436785358,
      -0.2152339939944573, -0.6196618354014573, -1.0090332485298736,
      -1.3098037750487794, -1.4590006820694597, -1.419248431027926,
      -1.1882154409818022, -0.8000884208524205, -0.3186375215496316,
      0.1764922208004318, 0.6069614986808748, 0.9122465311217227,
      1.0615294747292152, 1.0581997007657664, 0.9360600299993284,
      0.7484088605438517, 0.5529341281532095, 0.39636351026358546,
      0.3028152624062864, 0.2687899630878103, 0.2659945821939226,
      0.25114484559194494, 0.18007283823601822, 0.022339038997591598,
      -0.22759990022091564, -0.5457454042523091, -0.8818420255482716,
      -1.1699593568773587, -1.3438407743485092, -1.3532236557929735,
      -1.1770261041356354, -0.8300243248849175, -0.3612323967872889,
      0.1557559304341131, 0.638210973772551, 1.0118084286309903,
      1.2260638859813198, 1.263988767045194, 1.1437424987559306,
      0.9120508316789776, 0.6312002033978523, 0.3629889918685736,
      0.15372408582017155, 0.024020522351533236, -0.03411845978760111,
      -0.05236454662155171, -0.07472971487321012, -0.14294357115773276,
      -0.2824976159025198, -0.49313596355735684, -0.746420932135959,
      -0.9911687271367576, -1.1655029124371756, -1.2125344746024154,
    ]);
    const expected = [
      [
        -1.7668469285347064, -0.6360056379601315, 1.4497155519678833,
        2.911109120256997, 0.9576869490558503, -2.0509286532208364,
        0.5012898792242565, -2.410926072722169, 0.11597642468696961,
        1.4832647893577038, 3.240821508046687, -0.2027084515058974,
        -1.3500756180379445, -0.43172910396260716, -2.3921738496575156,
        0.7608131048022894, 1.5383355654685298, 3.4830169879206756,
        -1.571141745092443, -0.347041330164815, -0.7736602962577259,
        -2.0058978965141674, 1.1294724392576185, 1.8415483972507198,
        3.115518358285528, -2.1007803501699787, -0.54492784689391,
        2.697652952089317, -2.3725920462258907, -0.13438717017545165,
        2.5201404772325584, -2.5911371111593264, 0.28102235166002154,
        2.287478579191206, -2.7539774839234674, 0.6905145029462965,
        2.0055842355266518, -2.856922325221008, 1.083496165849337,
        1.6820918110151286, -2.897934562785618, 1.4501207213492282,
        1.3259246577636192, -2.8771811910962946, 1.7817279135848556,
        0.9471166815298844, -2.798144437694726, 2.0733011282818135,
        0.5586106938784623, -2.6949137261572513, 2.4286033786727312,
        -0.11182631120230134, -1.9739376279856697, 1.7338242808427191,
        0.7516430478827861, -2.789031190307352, -2.6308720217382597,
        -2.7701036905514616, -3.615278003039221,
      ],
      [
        -1.2204185959107263, -0.14917234757645395, 1.5637696741278435,
        -0.3724528135185036, -0.8235910773339774, -0.9306928036144911,
        1.5529184670027627, 0.16393939657526052, -1.3684774949540581,
        0.7552264841367908, 1.3701330222441295, 0.11290558566003132,
        -1.4124628209273735, 0.7113268297407315, 0.49949942212725423,
        -0.9992237042332041, 0.4253678669874287, 0.6492171478092784,
        -1.2650184478996798, 0.8774361520898035, 0.21695695151865155,
        -1.143220629754908, 1.1619011258970051, -0.25879761508405846,
        -0.8480043970918822, 1.2800598715375757, -0.6946020013133634,
        -0.4441834845037225, 1.2321746428274334, -1.041311120605809,
        0.019261991805624816, 1.0238972830468833, -1.2559243380896028,
        0.4852685851574972, 0.6803632939568806, -1.3113831813880399,
        0.8963742292615872, 0.2431395054504332, -1.199870030762528,
        1.200947580080562, -0.24090687522140075, -0.963184945015647,
        1.2940012877769826, -0.19603993042878143, 0.6912736167994591,
        -0.5656110476946916, -0.40489004737038015, -0.3133565072230957,
        -0.054165259907018, 1.1046418503454871, -1.5902392585827803,
        1.014103689196405, 0.23971920823621903, -1.2208838543674416,
        1.178413992966466, -0.16310975388851875, -1.002560520103453,
        1.3722067602425687, -0.634224314753314,
      ],
      [
        0.005648810440186039, -0.07332681353528911, 0.19609989820488483,
        -0.18512090152640795, 0.17497024092501012, -0.17233013874168646,
        -0.010762322111398494, -0.17281685874387806, 0.2929895794079882,
        -0.09968886692087212, 0.047983019852790146, -0.08549244682418113,
        0.12023843908791783, -0.10875874139842173, 0.05705097713469829,
        -0.0011761192482476473, -0.023720205501246556, 0.010100233578161262,
        0.017494455004456132, -0.02592297098057236, 0.005634696665525226,
        0.020877699425695815, -0.02438799992450347, 0.0010396346091949135,
        0.023474476327914863, -0.022117577844097888, -0.003631598659526248,
        0.025359301552979698, -0.01914092103192822, -0.008151920488723177,
        0.02647986290910526, -0.015627807298969457, -0.01246616667868921,
        0.026804416359087688, -0.011601052756183564, -0.016366428852268695,
        0.026314740410541045, -0.007267993635546581, -0.019809126064540578,
        0.02504037829154315, -0.002671075235291537, -0.022620460253631815,
        0.022998717250297236, 0.0019608801338707863, -0.024781197847929565,
        0.020278556167357673, 0.006579872043221132, -0.026165330071369973,
        0.016928664405731673, 0.010953799342154931, -0.02678695407547107,
        0.013089238682309226, 0.015044198193797376, -0.02657673743921741,
        0.008831200857643119, 0.018634022134690897, -0.02558611081811407,
        0.004333350701177419, 0.021708472612371556, -0.023805564548873198,
        -0.0003243019290509743, 0.024081998417081276, -0.02132229993391068,
        -0.004940628250169731, 0.025774761711746405, -0.01818385980529554,
        -0.009441703889316684, 0.026702951977006152, -0.013678452627831838,
        -0.008494415205536237, 0.04556937348155406, 0.020546495098013814,
        -0.015247847251952667, 0.048889721475974375, -0.11396105248772635,
        0.050278161574680603, -0.03103939194458535, -0.014689625776765518,
        0.04563117855604562, -0.050832556777901126, 0.027402607320834996,
        0.00794926529170045, -0.026786372172926627, 0.014261936919268237,
        0.01400909963882397, -0.02670033360620635, 0.009951043546023955,
      ],
      [
        0.013131740071942495, 0.04743053774030976, -0.10643365508630703,
        0.08014807322048978, -0.06166583404886013, 0.047149473953305425,
        -0.030837072242208413, 0.01533136376601924, -0.005098931706515983,
        0.0007660447679315468, 0.0001760322427228259, -0.00011596874838561617,
        2.2817014054943175e-5, -2.9664645494954757e-6, -1.761197405299881e-6,
        1.8916220733557486e-7, 1.8121793403484103e-6, 1.7133082649141255e-6,
        -1.3568035908607154e-8, -1.7275953562836382e-6, -1.8001167531086513e-6,
        -1.6225422571385437e-7, 1.6296508004637527e-6, 1.8729191367079193e-6,
        3.364594262598565e-7, -1.5196612300621002e-6, -1.9316389647168602e-6,
        -5.079706337306475e-7, 1.39851973611535e-6, 1.97617873696027e-6,
        6.760254554020561e-7, -1.2665700374957482e-6, -2.0057520745329937e-6,
        -8.391516863268119e-7, 1.1247077335290515e-6, 2.019758804358729e-6,
        9.955699493746926e-7, -9.745690027985246e-7, -2.018517319135589e-6,
        -1.1442639701578132e-6, 8.174277266966065e-7, 2.0024427062655065e-6,
        1.2846688445426375e-6, -6.539160072643601e-7, -1.9712598772391463e-6,
        -1.4155966392618016e-6, 4.850915045844434e-7, 1.924771627976373e-6,
        1.5354912646531556e-6, -3.127724271055276e-7, -1.8636961436474704e-6,
        -1.643535575864289e-6, 1.3847511456345798e-7, 1.788952610528542e-6,
        1.7394864681996201e-6, 3.701198459036004e-8, -1.7007698848805262e-6,
        -1.8225696105550116e-6, -2.1261381025622823e-7, 1.5993334190674356e-6,
        1.8915809218952572e-6, 3.86492697079205e-7, -1.4857124646396229e-6,
        -1.946009221451093e-6, -5.57049616324623e-7, 1.3612667210238542e-6,
        1.9860205028685397e-6, 7.234877953154137e-7, -1.22666751481596e-6,
        -2.0113417237917365e-6, -8.84868945483934e-7, 1.0824119293868249e-6,
        2.021206436087392e-6, 1.039504073475678e-6, -9.298230177057655e-7,
        -2.0154716744956366e-6, -1.1858739257820908e-6, 7.705891225090195e-7,
        1.9947512484953467e-6, 1.3233187206350272e-6, -6.057163557093407e-7,
        -1.9593090529103057e-6, -1.451181685474814e-6, 4.3590114739230417e-7,
        1.908849669588807e-6, 1.5680769986191435e-6, -2.625856517793094e-7,
        -1.8436084806212115e-6, -1.6727114319073709e-6, 8.763906547588564e-8,
        1.764631570114024e-6, 1.7646864898605787e-6, 8.773814408254474e-8,
        -1.6726990668187572e-6, -1.843744256083857e-6, -2.627893107902869e-7,
        1.5679647611681852e-6, 1.908925399996429e-6, 4.3610971017571716e-7,
        -1.4509994238561916e-6, -1.9592759077193486e-6, -6.058162094732373e-7,
        1.3232123041874573e-6, 1.9947460549554796e-6, 7.70670019153519e-7,
        -1.1858250150083602e-6, -2.01555205596286e-6, -9.300025572136021e-7,
        1.0393672417641463e-6, 2.021239131211172e-6, 1.0826063011406838e-6,
        -8.846544223001268e-7, -2.011259855333605e-6, -1.2267514357163169e-6,
        7.233436220416089e-7, 1.9859527983466235e-6, 1.3613135462926209e-6,
        -5.569776860438475e-7, -1.9460315576563193e-6, -1.485850710414327e-6,
        3.8634717500082944e-7, 1.891570162059452e-6, 1.599496848388075e-6,
        -2.123850160770381e-7, -1.8224420904962278e-6, -1.7008239358832538e-6,
        3.6847278672318156e-8, 1.7393603896263826e-6, -0.002942333318130656,
        -0.00996885172446019, 0.022457200191172144, -0.016445230753543674,
        0.012263479628202381, -0.009233399249358072, 0.006112865813016048,
        -0.003164289155417269, 0.0011343534879696975, -0.00021232218909732862,
        -2.190461050059265e-5, 2.5986684021515155e-5, -3.87200926749449e-6,
        -6.664121900289731e-8, -1.849282909050763e-6,
      ],
    ];
    const result = wavedec(data, "db16");

    const reconstruction = waverec(result, "db16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db16_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5037725375093673, 0.9261290831622534, 1.2034866259248964,
      1.3035158142961332, 1.2308691867455406, 1.0239077579927447,
      0.7434159968688261, 0.45632768951239466, 0.21872580571934447,
      0.06250950526869842, -0.010889017780352117, -0.028239489839000334,
      -0.034466771951034925, -0.07764237759071779, -0.19314068467940837,
      -0.3913045780391083, -0.65203875243558, -0.9279193972630927,
      -1.155154072118651, -1.269634308416022, -1.2239429727142077,
      -1.000871444606879, -0.6198519691019577, -0.1345008964710497,
      0.3782631117396374, 0.8349023747240731, 1.1636302928298252,
      1.3199172740105842, 1.295313360361686, 1.1174790063669755,
      0.8415618112990313, 0.5352577147873435, 0.2614813381578374,
      0.06313313085751754, -0.04615167223783845, -0.08299499423518308,
      -0.0869226973037956, -0.10678217464169659, -0.1846848442059032,
      -0.3418746567474636, -0.5704111876440343, -0.8330178344591603,
      -1.0712837681505945, -1.2201873200330542, -1.2252092041934106,
      -1.0575719595948245, -0.723571528615162, -0.2654501660167473,
      0.24658522384347067, 0.729326009069959, 1.1048369771130129,
      1.317518045936937, 1.3457317753140934, 1.205163769511758,
      0.9431947032161007, 0.6258516211634417, 0.3207804471283068,
      0.08065766197276975, -0.06871296959902695, -0.1326442883121257,
      -0.14321270581290138, -0.14764010902922542, -0.19265220149630152,
      -0.3091067254489627, -0.5011053542377775, -0.7426131399363649,
      -0.9826202609073462, -1.1576121411402316, -1.208158898509624,
      -1.0953055738178823, -0.8124383177182763, -0.38942420862141836,
      0.11221460278076895, 0.61203550210717, 1.0282271262155325,
      1.295640912147022, 1.3798321016043031, 1.2836544068756157,
      1.0448525601725664, 0.7253908143568257, 0.3953498551114093,
      0.11557860790429586, -0.07644706802715506, -0.17399492885004042,
      -0.19991944284837038, -0.19747392953333545, -0.21569915952538066,
      -0.2934140850250032, -0.4461906403593021, -0.6598966886319326,
      -0.8926481291378603, -1.0847785167284811, -1.17429591319305,
      -1.113811801646452, -0.8844857548257663, -0.503250789902967,
      -0.02128411367313969, 0.4860725177878021, 0.9355391650528466,
      1.2542780723488813, 1.395869182256238, 1.3499263616705819,
      1.1430191127286424, 0.830779833945821, 0.48331511528672566,
      0.16772267077265857, -0.06779040528918995, -0.20416386274618062,
      -0.2536015632484181, -0.2531903253658889, -0.25189546096957716,
      -0.29454060449263475, -0.4071586633025146, -0.5877244014874746,
      -0.8048464919079249, -1.0048825973849682, -1.1256979242635619,
      -1.1135025439257784, -0.938343653427564, -0.6041231752551608,
      -0.15038590998663975, 0.35477534260822075, 0.829067438133914,
      1.194092675775486, 1.3927097461290316, 1.4013492217834294,
      1.2342524638970054, 0.9386589343297121, 0.5822679783145412,
      0.23625239284179012, -0.041800964897384885, -0.22068517980183613,
      -0.3009219354902212, -0.3114602288298645, -0.2987965923126411,
      -0.31157138619359614, -0.3848694118513432, -0.5285123620281771,
      -0.7225612385212414, -0.921329007215165, -1.0649390032617565,
      -1.0954453162267734, -0.9732864766652949, -0.6897008802974244,
      -0.2717324601941285, 0.22165852319452942, 0.7115798316131589,
      1.1163958329671633, 1.3698747756486922, 1.4357834200629989,
      1.3153109757184862, 1.0455264270652007, 0.6893533859764821,
      0.3196951923122148, 0.0018052660218150773, -0.2216025682370137,
      -0.3387720372232681, -0.36884278819749944, -0.35353508236642833,
      -0.3429676363192967, -0.3795206105437361, -0.48414863273468767,
      -0.6488822231966986, -0.8376053498691703, -0.9949940712932533,
      -1.0613225047222925, -0.9892580029114361, -0.7581933489413238,
      -0.3822530784351721, 0.09028607453597653, 0.5862180913410666,
      1.023099947813411, 1.327557975632406, 1.451659029996588,
      1.3832719003188343, 1.1478663026285756, 0.8013729057907653,
      0.4159957261435286, 0.06264198608629928, -0.20554308174688696,
      -0.3643879805391976, -0.4219134648649153, -0.4129273469924734,
      -0.38662446089780167, -0.39064142713292327, -0.4559245020880696,
      -0.5865299249141149, -0.7571537524338022, -0.9191287331747396,
      -1.013368145229179, -0.9868715014572298, -0.8084234959675344,
      -0.4792751238221664, -0.0358570980184674, 0.45638448699619205,
      0.9166500778465924, 1.2666196650200472, 1.4480337687629694,
      1.4356384085422829, 1.242276456070738, 0.9149008181460629,
      0.5225896635714076, 0.13966487028798036, -0.17176951176159655,
      -0.3754539120633148, -0.46739155766645685, -0.47359216205853755,
      -0.4399494671853077, -0.4171107523643313, -0.4444876810199661,
      -0.5377557258688483, -0.6832441553758529, -0.840778530399328,
      -0.954284544518443, -0.967385414772436, -0.8398687888318626,
      -0.5606198171943186, -0.15349085447041297, 0.3256189726486494,
      0.7999358358226477, 1.188556313821999, 1.4246280814541405,
      1.4704310942916052, 1.325592818781497, 1.0264086037487636,
      0.6364961693199662, 0.23120801438395377, -0.12020944259372285,
      -0.3701889955872947, -0.5022624781851992, -0.5320764204877843,
      -0.499959287912253, -0.45719938063955196, -0.4498191630562764,
      -0.5042594628044128, -0.6188539926169407, -0.7634220392692487,
      -0.8871418015732799, -0.932655441281913, -0.852678366446759,
      -0.6246799618897609, -0.2596579521811181, 0.19747134228903845,
      0.6761870585810658, 1.0954468399427209, 1.381836019976827,
      1.486260601452491, 1.3950048484736723, 1.1323932712447424,
      0.7544257098177125, 0.3350432003798951, -0.05145992162861218,
      -0.3474147865673066, -0.5238902932081015,
    ]);
    const expected = [
      [
        -2.024278453616167, -0.49083654779862057, 1.5193545130641466,
        2.8031874890655852, 1.1745627264500056, -2.0319846100542893,
        0.08993441909184886, -2.5741197915881204, 0.29681336881963677,
        1.4657266389476071, 3.2136764801680453, 1.9747853928562924e-5,
        -1.4001311244483303, -0.8862112852169238, -2.4593562514504574,
        0.9675804648237519, 1.4187932538917187, 3.5703256047037972,
        -1.4083262172059796, -0.49069910179936765, -1.194363538214868,
        -1.9755241757369308, 1.274627533612694, 1.7680725161987136,
        3.140060889425611, -1.7765624468674082, -1.104096405236525,
        2.8667470879470156, -1.7059010660556828, -1.1978272708225557,
        2.882922986871159, -1.6284804597063698, -1.2879947051647374,
        2.8922716794861496, -1.5476235784060253, -1.3748204771665828,
        2.8947321415708984, -1.4630428498010284, -1.458581073012606,
        2.8903432164094975, -1.3745056269315021, -1.5395922810751388,
        2.8792421860453, -1.2818530050009946, -1.6181722943358665,
        2.861643223699765, -1.1851541202921476, -1.6938500378877033,
        2.835013113268899, -1.0746387977156964, -1.7992716233919746,
        2.8915446205322, -1.1679159854968806, -1.4925737227289846,
        2.233343504483485, -0.2869054254590377, 0.05195487636648352,
        -1.7218794366203694, 0.6865661529648222,
      ],
      [
        -1.2593182161606493, -0.2346372389513124, 1.7417807581012454,
        -0.522879957608902, -0.7603202260611855, -0.9591933268745233,
        1.4784814554380377, 0.2914306931416946, -1.5127020746619528,
        0.8943363030177484, 1.336783188702378, 0.0847687137880538,
        -1.3407683613428019, 0.55494867885313, 0.6555862786020418,
        -0.9712158257871435, 0.15309061700960702, 0.959386695864249,
        -1.2819426509104876, 0.47773919550414223, 0.7547834758099363,
        -1.325221691919499, 0.7294340374377501, 0.5057448252937479,
        -1.2916233481742554, 0.9377605656123595, 0.2422598426344419,
        -1.208396893928473, 1.1091486481177497, -0.03064551520804218,
        -1.0777333308099795, 1.2373610723008184, -0.3031116090882953,
        -0.9043771528761035, 1.317787922434083, -0.5652824456789666,
        -0.6946437855467293, 1.3475821118471822, -0.8074065409486529,
        -0.45308367579753345, 1.3418427132645825, -0.9740329063890137,
        -0.03980030290182082, 1.7838415185009848, -0.4138649985795883,
        0.11208246587020068, -1.289367085316392, -0.4708782064555042,
        1.3706523903465457, -1.266527527951168, 0.08595035237452453,
        1.0563801196279046, -1.1742802378097685, 0.18981981508069423,
        0.9984477569632716, -1.316732894133371, 0.46648982365316033,
        0.8080065816236601, -1.3746607376753328,
      ],
      [
        0.005381117582545514, -0.0642478346727299, 0.1797893483234012,
        -0.1718149242558753, 0.16557725404558044, -0.164750489612771,
        -0.01724141257942238, -0.16591334980249528, 0.28801642874045397,
        -0.09916144146526093, 0.05011860488078146, -0.08851815646539994,
        0.12375394936271172, -0.1127976887433413, 0.06030626039045883,
        -0.0012212606943208019, -0.027749589815492838, 0.015348794636514937,
        0.016034789138561815, -0.0305988658952311, 0.012715620700024072,
        0.018612799164229938, -0.030297230645046812, 0.010001397631177831,
        0.020869685902826982, -0.02969924509714389, 0.007162083855912954,
        0.022921789985002064, -0.02881040995424421, 0.004288319980568342,
        0.024776942678313946, -0.027674674302579447, 0.00134382042868072,
        0.026390516454571095, -0.026267698960355742, -0.001581624017299198,
        0.027776391025795225, -0.02463613676811242, -0.0045239624605939366,
        0.028892053866901676, -0.02276228200368752, -0.007393334223947953,
        0.02975812804166031, -0.020694968183420002, -0.01022624465505203,
        0.030334725783309344, -0.018422621745036536, -0.012933844859339927,
        0.030649543875351737, -0.01599558024937573, -0.015554070219444452,
        0.030665657299230428, -0.01340775126763633, -0.01800012847123212,
        0.030417982447699145, -0.010710168835509104, -0.020312204471848477,
        0.029872712619262956, -0.00790144641597884, -0.022406535721346297,
        0.02907193809403335, -0.005032404008074206, -0.0243262882110406,
        0.027984939782194112, -0.002105492334882205, -0.025991804739609825,
        0.026653662754259747, 0.0007433663549114406, -0.027926012874201992,
        0.023592039922482887, -0.0017103570545172987, -0.04330684401665681,
        0.14150068574636784, -0.06155719515066162, -0.15068128110598436,
        0.1865342159510142, -0.10353348903943733, 0.019512692659007593,
        0.020991146087772743, -0.009965528079985653, -0.018840274974032775,
        0.026227053559069183, -0.002994667493299051, -0.025202596679268257,
        0.027490361339866563, -0.0009087180592753844, -0.026627878418554036,
      ],
      [
        0.013027287099036713, 0.047100890089764674, -0.10568767205049943,
        0.07962489343901774, -0.061299481439058924, 0.046882656262134774,
        -0.03065366293535048, 0.015226928498043324, -0.005057008429062229,
        0.0007567398253934624, 0.0001762455036315174, -0.00011496700147614706,
        2.234321172728363e-5, -3.415876441423321e-6, -1.918972679814591e-6,
        5.22874639570924e-7, 2.309875508271204e-6, 1.8507016052891094e-6,
        -4.081608804922426e-7, -2.270117206508202e-6, -1.9245432464421045e-6,
        2.9247405431115217e-7, 2.2249748608322486e-6, 1.9937052142679857e-6,
        -1.7639547324559194e-7, -2.1749487065915166e-6, -2.0584011964665108e-6,
        5.994182504018309e-8, 2.12009248619906e-6, 2.118626390095871e-6,
        5.693010623846921e-8, -2.0601368450135315e-6, -2.1738671050541564e-6,
        -1.7369585751737107e-7, 1.9952884099044783e-6, 2.223860025589846e-6,
        2.897815718598982e-7, -1.9260901256033104e-6, -2.2688683716810583e-6,
        -4.051826284429974e-7, 1.8526242880286592e-6, 2.3089177781744527e-6,
        5.199345033698629e-7, -1.7746671355373675e-6, -2.343535685654473e-6,
        -6.335057108800034e-7, 1.6924820758775304e-6, 2.3725210316689806e-6,
        7.453401172531874e-7, -1.6066487151692245e-6, -2.396190200373541e-6,
        -8.55454570702012e-7, 1.5172721848446642e-6, 2.41460286239788e-6,
        9.638860584470875e-7, -1.4241687385170807e-6, -2.4273315335434982e-6,
        -1.0701061287441618e-6, 1.327651861837121e-6, 2.4342404922364753e-6,
        1.1735863881628832e-6, -1.2283303217054272e-6, -2.4357011575419034e-6,
        -1.2743741297535492e-6, 1.126325011298765e-6, 2.4318090593141286e-6,
        1.3725167017620094e-6, -1.0214852365673542e-6, -2.4221839095750962e-6,
        -1.4674982309030365e-6, 9.141665974480228e-7, 2.4067565711330834e-6,
        1.5588274194133826e-6, -8.049983100492915e-7, -2.385953491049146e-6,
        -1.6465903141762322e-6, 6.941088151516651e-7, 2.359906027567875e-6,
        1.730852659469443e-6, -5.813724944196262e-7, -2.3282813551541774e-6,
        -1.811119865129454e-6, 4.671780338090486e-7, 2.2910762400349835e-6,
        1.8869461611880525e-6, -3.521655188005201e-7, -2.24877027732669e-6,
        -1.9584635444961884e-6, 2.364619225586638e-7, 2.201528768214327e-6,
        2.0257631777006304e-6, -1.1995792973734269e-7, -2.149064751355557e-6,
        -2.0883792898008204e-6, 3.0656565329000903e-9, 2.0914383458116084e-6,
        2.1459187564078433e-6, 1.1357416019552676e-7, -2.029178578106109e-6,
        -2.1985654848828825e-6, -2.2984545024203206e-7, 1.962481039591051e-6,
        2.2464416845017216e-6, 3.458504313074636e-7, -1.891101240013121e-6,
        -2.289116516385466e-6, -4.6116357442170465e-7, 1.8151583193885786e-6,
        2.3262551626152143e-6, 5.751538766234568e-7, -1.7352252945245234e-6,
        -2.358097813415263e-6, -6.877257653554739e-7, 1.6515227270783319e-6,
        2.384801755661156e-6, 7.989835868702038e-7, -1.5638435752709772e-6,
        -2.4059756490124366e-6, -9.084984070207361e-7, 1.4723600844641613e-6,
        2.421346894011418e-6, 1.0156592022699592e-6, -1.3776822411180063e-6,
        -2.4312146031471443e-6, -1.120400271124568e-6, 1.280048811814078e-6,
        2.4357735050197947e-6, -0.0001936170951067293, -0.004004308720517252,
        0.002719002708287493, 0.0038618069533478978, -0.004257082778949034,
        0.003012815991173449, -0.0016432913072823168, 0.0005773702923354086,
        2.335673622650026e-5, -0.00017841786406688203, 0.00010890301832586236,
        -3.441909303219518e-5, 5.582012153661039e-6, 2.760764905956031e-6,
        7.279568678723565e-7, -1.5376131420162683e-6,
      ],
    ];
    const result = wavedec(data, "db16");

    const reconstruction = waverec(result, "db16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db17", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49731674973874823, 0.9200033001714515, 1.2082244499097143,
      1.3284071549390148, 1.2788333593304817, 1.0881888451773198,
      0.8075434403587693, 0.49776039727661686, 0.2153719541374154,
      0.00026920585217721227, -0.13193312061038295, -0.19116228342800828,
      -0.20765096429838664, -0.22164807179324286, -0.2707483247232647,
      -0.37808051776246715, -0.544373590102152, -0.7459634300942338,
      -0.9393424098662441, -1.0712401044674247, -1.0918467498646895,
      -0.9679837442470371, -0.692984784873049, -0.29079047217800175,
      0.1868951164217218, 0.6699044618582373, 1.0833503555557533,
      1.3627358300389192, 1.4670096493062759, 1.3866083995978897,
      1.1446842591718758, 0.7912978196809598, 0.39198335870978895,
      0.013384131357292273, -0.29069714701380117, -0.48963362873971183,
      -0.5803982392357245, -0.585218048144254, -0.5432315601604251,
      -0.4983526417066532, -0.4864346782651238, -0.5249654322211719,
      -0.6078763090047582, -0.7067768742993075, -0.7783343279083118,
      -0.7759925049714692, -0.6631344037403999, -0.42440067483290855,
      -0.07228078474600302, 0.3528004652369068, 0.7891335213221781,
      1.1657291721780934, 1.4169968408204006, 1.4967441892958189,
      1.3882662622880724, 1.1081773680835743, 0.7030805506987922,
      0.23982685080139565, -0.20840293704885662, -0.5770080707931089,
      -0.822482141954804, -0.9297413020670586, -0.9127258765158367,
      -0.8083385933000719, -0.6653570488194258, -0.5311278437380554,
      -0.439337503630989, -0.40184717488652816, -0.40655133064783566,
      -0.4217246635991204, -0.40571757908818995, -0.3195363602908593,
      -0.13911898604773842, 0.13583242770554493, 0.47878690478544783,
      0.8400267859906777, 1.1563120143935883, 1.3644086961820552,
      1.4153565362338398, 1.28612203502587, 0.985854448341948,
      0.5551969071877128, 0.05871414446218305, -0.4279002530617079,
      -0.8329601627484393, -1.102851354428797, -1.2118727300163012,
      -1.165706239570268, -0.9978700717648329, -0.7601540881107267,
      -0.5094315534204363, -0.2940564152919358, -0.143099291872892,
      -0.06094124384408672, -0.028411691552426482, -0.010047748759871855,
      0.03444537395124364, 0.13747891790285577, 0.31286309635023135,
      0.5498550350920262, 0.8135781029565586, 1.051860480627198,
      1.2069610458496554, 1.2294301050365506, 1.0907866322186248,
      0.7919216241613551, 0.36510822759415323, -0.1310152649922991,
      -0.6224758628095095, -1.0345780837875056, -1.3068155619476713,
      -1.404719370768393, -1.325990213984161, -1.0995934439914696,
      -0.7781335765928924, -0.4253800417815836, -0.10192004467914378,
      0.1476926219352374, 0.30333236384664036, 0.37138831679182416,
      0.38023149940121403, 0.37035365361369477, 0.38174800731453046,
      0.44175209415903427, 0.5564386430465877, 0.7077561071695619,
      0.857199627374426, 0.9551790438987626, 0.9538326241645596,
      0.8201563845712669, 0.5461931837903193, 0.15368667561911664,
      -0.30810241330971655, -0.771103280372353, -1.1617948499614374,
      -1.4162245699988312, -1.4932711457347287, -1.3831194389354653,
      -1.1090144384979121, -0.7219157264176452, -0.28931609928667096,
      0.11917094494214464, 0.4461272294191697, 0.6572864740677845,
      0.7467023916732392, 0.7351009155461669, 0.6620221408151464,
      0.5738311345854488, 0.5106393446830807, 0.4954014642986535,
      0.5278855073109265, 0.5849953651767946, 0.6273503041707429,
      0.610475166042608, 0.497803045712799, 0.2722178315706731,
      -0.05681652347309757, -0.45245413521459066, -0.8563956906717816,
      -1.2003281944827926, -1.4203126047927905, -1.4708129120417104,
      -1.3350985928709083, -1.0295663069346528, -0.6009252235252388,
      -0.11684285266923969, 0.3478367438244717, 0.7261719100090291,
      0.972087733703344, 1.0683351690326863, 1.0277523619689222,
      0.8877238602222514, 0.6993330028619421, 0.5139330744248441,
      0.3704322282910896, 0.28636285862015204, 0.25484537115842326,
      0.24809276314485496, 0.22648978690291663, 0.15090773338373126,
      -0.0048859551084094455, -0.2449012632890496, -0.5471231186684061,
      -0.866338125929241, -1.143082511368567, -1.316699892018029,
      -1.33946626995762, -1.1884305447561085, -0.8721094707904133,
      -0.43035286545401014, 0.07271975008445498, 0.561191858052686,
      0.9624463470434955, 1.2214861204804595, 1.3112640360807297,
      1.2367462842454773, 1.03190316716752, 0.7504724377970065,
      0.45278078977359404, 0.1917976468771262, 0.001723317262431412,
      -0.10824590078098037, -0.15361855747426253, -0.1680185302773317,
      -0.1920794971039551, -0.2606904093668907, -0.3918514370413783,
      -0.5799984135370272, -0.7955555800955929, -0.9909460948418248,
      -1.1116961200689461, -1.1099958460668116, -0.9574375986117591,
      -0.6537948659389894, -0.22960596638601313, 0.2582298119079385,
      0.7369902036947783, 1.1324934534072693, 1.38406094558919,
      1.4566921115983622, 1.3477009981012378, 1.0863468440551538,
      0.7266167270367547, 0.33490145058757864, -0.024528485188557658,
      -0.3028666927172967, -0.47588297774250954, -0.5468009502451328,
      -0.5424539856837587, -0.5038505767363732, -0.47361326074152466,
      -0.4834848249426332, -0.5450481700456821, -0.6459955213498119,
      -0.7529053945520753, -0.8198746798166976, -0.8008974499256885,
      -0.6629335917679429, -0.3963995539762316, -0.02039396923042447,
      0.41879368639737624, 0.8557466999699515, 1.2188357616956202,
      1.4450842239124988, 1.493585047241181, 1.3543740755731775,
      1.0507002953612778, 0.6341579155017861, 0.173796732718214,
      -0.25828483731178864, -0.601563802140213, -0.8186168133252936,
      -0.9009918313092188, -0.8682351334690317, -0.7605126710659129,
    ]);
    const expected = [
      [
        1.4138767198073876, -1.6993848135874978, -1.479414758345389,
        -0.5616579492994912, -0.39917412109786543, 2.638630712777114,
        0.9846333246447532, 1.355526053862464, 2.430435830664438,
        0.5693602189396031, -0.16889210948257963, -1.0215746211392753,
        -2.460062482886913, 0.42681218688274036, 2.549025678551388,
        -0.3759725529555682, -1.9863305101993047, -0.7081234381752112,
        -0.9923193972812802, 1.3541052210483866, 2.1780817651708544,
        0.5707037955094486, 2.3627156306508166, 1.5780930866408998,
        0.04470840890647986, -0.3182698177942024, -2.032590326445014,
        -1.5886489085332702, 2.0499180876159784, 2.25880041057552,
        -0.3320302227084925, -0.8198335421911177, -1.355519224651246,
        -1.5987493010904807, 1.4981434270564202, 2.7978921222584856,
        -0.22987568162666017, -1.557523111823397, -0.9682643659901217,
        -1.1398936268926814, 0.8677001547784166, 2.927162593790923,
        0.26991524982820037, -2.200288899270794, -1.0505446817828346,
        -0.40142523688414755, 0.4874914161144257, 2.576448375812931,
        0.8938102313123398, -2.462095181964652, -1.5543060951663976,
        0.29268374068365943, 0.5648234022934967, 1.906118236651515,
        1.308065402120022, -2.2399500913214045, -2.226925747196826,
        0.6401628496926752, 1.0853167728320932, 1.229679604734297,
        1.2798518110603307, -1.6635876589147518, -2.7331558648354877,
        0.5062987557222479, 1.8198190293238354, 0.8624716704842013,
        0.7896740507176913, -1.0328221939881699, -2.816949181235108,
        -0.01108362510006719, 2.4349815241749617, 0.9694757371303148,
        0.04081998749686729, -0.6728078720320649, -2.425076002555849,
        -0.628850558646618, 2.6542711063434576, 1.4845000950662155,
        -0.6338196924113061, -0.7913481554989401, -1.6996281422522637,
        -1.080864115000884, 2.5068879407135665, 1.9533917846038091,
        -0.6393768645418494, -1.7452109822044968, -1.5486630709150142,
        -2.051239881691729,
      ],
      [
        0.05595104981768042, -0.05854130727279285, 0.05355604640170897,
        -0.023719011508289912, 0.031382355688651976, -0.02639299032178638,
        0.08364327096303287, 0.15308272229754424, 0.11219169891792867,
        -0.37889713610191345, 0.363866545093464, -0.31386115399126585,
        0.25141861997893095, -0.1662439594070925, 0.0751298610920279,
        -0.0096063162148945, -0.012288044374286567, 0.00111995618728519,
        0.013873449460160699, -0.010927023574943044, -0.006057202430725256,
        0.01591354671322583, -0.0065137796778131545, -0.010769245538870327,
        0.015012579163363333, -0.0010738375776452144, -0.014173856202560139,
        0.012247353570819585, 0.0045180121751679505, -0.015802373151032636,
        0.00794967948371038, 0.009529310998074296, -0.015473363226112476,
        0.0026693191006296225, 0.013371680977461865, -0.01320692612881873,
        -0.002951174082731079, 0.015530768918085292, -0.009305695459923402,
        -0.008196148373148788, 0.01577352920899019, -0.0042357051286308,
        -0.012428588144712552, 0.014033834685590732, 0.0013522924688850462,
        -0.015104594617304274, 0.010564272588462991, 0.006781127196511845,
        -0.015908212979525493, 0.005761023342948283, 0.011356425619932048,
        -0.014721483551950153, 0.0002582404361869893, 0.01452606111161689,
        -0.011710622401720409, -0.005294666475502287, 0.01587812348080461,
        -0.0072316622444826, -0.010170203883500291, 0.01526081739690109,
        -0.0018619144501440712, -0.013797034489697903, 0.012734988222331106,
        0.0037498582763236914, -0.01568761515303471, 0.008630711311851044,
        0.008883389637966213, -0.015686336594195657, 0.002837211879871074,
        0.00896993575510877, -0.029160565423829637, -0.04930130109036618,
        -0.031450629460959514, 0.10811021374346101, -0.16416065983395187,
        0.20038232693591077, -0.07744525249312971, 0.06619924048170857,
        -0.05520346143577263, 0.04922131599304234, -0.031122756568762715,
        0.004078692314498268, 0.0134594639928551, -0.008843271673429659,
        -0.008278994367988573, 0.01574104111771124, -0.004164471685090202,
        -0.01247586754365024,
      ],
      [
        0.00974603916822713, 0.04782417666148532, -0.09042062502581287,
        0.052566642124039074, -0.036481687259401686, 0.032152527124450256,
        -0.027041501966650117, 0.018172630023370554, -0.00899001822098094,
        0.002985027778449061, -0.0005008017184557557, -5.053709696144288e-5,
        4.688692203171578e-5, -1.0025832351606518e-5, 4.631377173700867e-7,
        5.560999069829704e-7, 5.583625749548313e-7, 1.1061753831158535e-7,
        -4.366396651082924e-7, -5.912123564813575e-7, -2.1407507631995928e-7,
        3.5558663791134255e-7, 6.054354012970905e-7, 3.107720646108004e-7,
        -2.6337464463443045e-7, -6.006163694102691e-7, -3.9764329566813127e-7,
        1.6298148323822376e-7, 5.770210747607202e-7, 4.720767095676324e-7,
        -5.747493005949018e-8, -5.353609835655054e-7, -5.317690380176227e-7,
        -4.9919416327874905e-8, 4.7682839178452917e-7, 5.747334327146348e-7,
        1.5574997842303594e-7, -4.032871816936338e-7, -5.995869597504588e-7,
        -2.5660870892614275e-7, 3.1716080410328574e-7, 6.056626256671944e-7,
        3.4941020905158486e-7, -2.2112711407507934e-7, -5.928063583222463e-7,
        -4.3133040741805426e-7, 1.1808387804549171e-7, 5.613092752291997e-7,
        4.997202300521867e-7, -1.1287765631961497e-8, -5.12121284883329e-7,
        -5.523438299738414e-7, -9.579331665787146e-8, 4.4689766609661513e-7,
        5.876264387935283e-7, 1.9981984890713544e-7, -3.677257949318449e-7,
        -6.045517587248211e-7, -2.9764399636462916e-7, 2.7697929649947015e-7,
        6.02513554654701e-7, 3.8617695238926134e-7, -1.774635762909355e-7,
        -5.814835205440484e-7, -4.625232556403961e-7, 7.241185678280541e-8,
        5.42195103212781e-7, 5.243038191703485e-7, 3.4834734730289356e-8,
        -4.859748078628747e-7, -5.696972120262431e-7, -1.4101998199348723e-7,
        4.145151122091749e-7, 5.972641136079275e-7, 2.4285784596549083e-7,
        -3.299637843721986e-7, -6.060217748238494e-7, -3.370437926956609e-7,
        2.3504441539933474e-7, 5.957080709021707e-7, 4.2057388120261156e-7,
        -1.3283180832712097e-7, -5.6676454038929e-7, -4.909345277835853e-7,
        2.646513308998001e-8, 5.200888347863165e-7, 5.459677226268674e-7,
        8.081480748966598e-8, -4.5702769175589824e-7, -5.83839500631286e-7,
        -1.8557454444042733e-7, 3.7956870090227125e-7, 6.033094213777895e-7,
        2.8442807015806593e-7, -2.902609140031152e-7, -6.038724662198107e-7,
        -3.743382240367556e-7, 1.9190047556292253e-7, 5.855647679352474e-7,
        4.52582964677994e-7, -8.745583030456906e-8, -5.488557899547989e-7,
        -5.166434506352118e-7, -1.979084135799369e-8, 4.94841924682531e-7,
        5.644086738702122e-7, 1.2635550039846718e-7, -4.253223438777604e-7,
        -5.944412410429319e-7, -2.2889629982051363e-7, 3.425361545751149e-7,
        6.0590037823365e-7, 3.2431374074319675e-7, -2.4897829990465027e-7,
        -5.9836666499516e-7, -4.096130633192312e-7, 1.475255899174376e-7,
        5.719737765395114e-7, 4.819989411688693e-7, -4.14638943481742e-8,
        -5.276079806812874e-7, -5.391980026111154e-7, -6.581732111155067e-8,
        4.667653468829532e-7, 5.795336202347134e-7, 1.7105230342294232e-7,
        -3.912990585466238e-7, -6.017438014370198e-7, -0.0026756345086009136,
        -0.01373798125377235, 0.02592872857557965, -0.015391625614990667,
        0.011032223297467704, -0.00993524796711347, 0.008362151689962972,
        -0.005529981200382776, 0.0026501860979096853, -0.0008319801286382134,
        0.00011906738311116057, 2.1541072992811156e-5, -1.3659799858233064e-5,
        3.1386271670023428e-6, 8.490115696586746e-8, -3.8853208821225015e-7,
      ],
    ];
    const result = wavedec(data, "db17");

    const reconstruction = waverec(result, "db17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db17_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4954821082092472, 0.9146814889487995, 1.1971172358983964,
      1.3102090959665726, 1.2548718954679976, 1.0633854283339812,
      0.7901917051364736, 0.4979741483972744, 0.24248895580363877,
      0.05987511655355948, -0.04049342063678246, -0.07596503344511446,
      -0.08354336026385673, -0.1077253369378735, -0.18644826463634273,
      -0.33881962609937916, -0.5578522349932034, -0.8101674086254392,
      -1.0428729951421458, -1.196007319661856, -1.2175158782875397,
      -1.0770500082344543, -0.7751166221752863, -0.3452095345564322,
      0.1517530776611544, 0.6394898234611222, 1.0421333639424277,
      1.30002847206819, 1.3818423023290127, 1.2901684120263959,
      1.059381061996768, 0.7463692067828375, 0.4164904163308538,
      0.12821427420537512, -0.0798030181762448, -0.19611987527194896,
      -0.2366997174916305, -0.23801744948116432, -0.2449797330954242,
      -0.29684586036246396, -0.41482446401872153, -0.5945887655684756,
      -0.8057076343407037, -0.998241098953195, -1.1149317609041722,
      -1.1059898630599871, -0.9427771402597309, -0.6269175613017733,
      -0.19244981172603887, 0.29967877433751067, 0.7736081376905481,
      1.1542896749237006, 1.3832531014163938, 1.4307038308686046,
      1.3011171301334503, 1.03106358758378, 0.6798736532851811,
      0.3154674271148476, -0.0011817048635143768, -0.22919336021976738,
      -0.3554150905904878, -0.3948223751264087, -0.38377288642779406,
      -0.3679825781741937, -0.3883948386833044, -0.46862094443272223,
      -0.607215972638802, -0.7768231980480618, -0.9304783696972823,
      -1.0135463639391147, -0.9783192040220834, -0.7975963766266474,
      -0.47377402586701867, -0.04104117995759757, 0.4400435635836011,
      0.8944545548888634, 1.248342115378173, 1.4447422951055129,
      1.4556395286004822, 1.2875347601965135, 0.9792327220667043,
      0.5924350538334912, 0.1974513743034199, -0.14250458865417953,
      -0.3846641043254543, -0.5145495301838549, -0.5465584938151209,
      -0.5173393211926298, -0.4737967523787483, -0.4588851755605724,
      -0.4988719986577725, -0.5953579662941307, -0.7241241564606793,
      -0.8411404977511847, -0.8942497329266358, -0.8375870855157186,
      -0.645071995135063, -0.3194961819861228, 0.10521170925054862,
      0.5692993267411065, 0.9989715707793835, 1.3219255079329417,
      1.4829792482023973, 1.4560810522861756, 1.2498389499920644,
      0.9052645910749813, 0.486297260125065, 0.06540581938309298,
      -0.2922666328891277, -0.5424334679544919, -0.6696969511411055,
      -0.6882899076027351, -0.6355454860320217, -0.5599072172742577,
      -0.5066240745940331, -0.5048188004249546, -0.559239955955373,
      -0.6488048562397584, -0.7323120968076431, -0.7598791248645815,
      -0.6871961271271243, -0.488947411151708, -0.1679212138066768,
      0.24263108927579657, 0.6841703600307742, 1.0845016492496207,
      1.373175802418075, 1.4970163720635694, 1.4320598008076293,
      1.1890380376254528, 0.8110779786426251, 0.36416294008228456,
      -0.07736097934343794, -0.4467722621286811, -0.6986624173863334,
      -0.817128216871351, -0.8166435059160184, -0.735596946229998,
      -0.6242826778996768, -0.5304774712846774, -0.4862993734140893,
      -0.49968273326385265, -0.5526146563177939, -0.6065555976783915,
      -0.613640887387856, -0.5307849559144139, -0.3330533896894895,
      -0.022819232549475432, 0.36775626328349015, 0.7817337020946639,
      1.148852391691788, 1.4007757864669412, 1.486498529743003,
      1.3842061420719896, 1.1067063209476444, 0.6990872711112698,
      0.2291273014821036, -0.22727718981005793, -0.6022086861766216,
      -0.8495487976770507, -0.9533027289520194, -0.9285739336861036,
      -0.8151446110872655, -0.6654253835599537, -0.529897837258936,
      -0.44375256410009695, -0.41808255138128064, -0.4378150414254197,
      -0.4668484261420478, -0.45903184659265334, -0.37213899185078675,
      -0.18121411576456958, 0.1121991697780193, 0.47742846660389654,
      0.8594908123760582, 1.1903503013144454, 1.4039873878421179,
      1.4516717446956577, 1.3137339534035317, 1.0049454498175363,
      0.5721432489943432, 0.08460219057854995, -0.38059499205805175,
      -0.7547393906321317, -0.9914205584264596, -1.074955236116351,
      -1.0214382550044139, -0.8723423251663854, -0.6824078461940881,
      -0.5049376027011483, -0.3782072824983236, -0.31637689405472275,
      -0.3071241783873985, -0.3165100052202876, -0.29975357243709105,
      -0.2150976340028167, -0.03715342616370659, 0.23377145523424486,
      0.5688683257678693, 0.9154288427994637, 1.2078818241365004,
      1.3826697764412086, 1.3933771692413643, 1.222410854488805,
      0.8863328878626175, 0.43346317857222105, -0.06576757319745755,
      -0.5334824793402135, -0.900598209221892, -1.1208257894807026,
      -1.1791758918447592, -1.0930607495776554, -0.905892127670231,
      -0.6748955759940483, -0.45624786787976057, -0.29125727462312395,
      -0.1969969737804831, -0.16365027465358653, -0.15912037176873628,
      -0.1396216239095935, -0.06346012321618388, 0.09559649820359534,
      0.33886559250850773, 0.6397440149241189, 0.9480700003833674,
      1.2009206603478806, 1.3372828221253443, 1.3130304606808398,
      1.1125148627564325, 0.7538587074441527, 0.2865519173565995,
      -0.21819357500725334, -0.6821176210644063, -1.0361816712812255,
      -1.234617358916546, -1.26348159756765, -1.1417862531885736,
      -0.9150760702051277, -0.6431552768028961, -0.3850624353604056,
      -0.18502204523285953, -0.06280812380025064, -0.010815373097235903,
      0.0015675971166589572, 0.0175280007486161, 0.07910761046680603,
      0.21378174052612336, 0.42485440548061726, 0.6882284384578898,
      0.9565077904254304, 1.169540676368066, 1.268875823584871,
      1.2125870707564135, 0.9867785339913393,
    ]);
    const expected = [
      [
        1.3588152954165496, -1.9437138026787524, -1.6082094443815393,
        -0.3502779923314347, -0.2832861853169555, 2.611548097260948,
        0.9678905372858331, 1.360579685837053, 2.3642319846673066,
        0.6131834494109452, 0.10744189011996855, -1.0714085711998687,
        -2.6478050390633627, 0.29117359054388603, 2.498182628308045,
        -0.5101410865097514, -2.2510182263640073, -0.634054948592221,
        -0.7873109412384475, 1.3793481343294887, 2.145441301611737,
        0.5767341816753949, 2.3336714200355737, 1.5180120527243888,
        0.2441395354557602, -0.14325223938544923, -2.230971709497727,
        -1.7127769490771751, 1.9347914827603734, 2.0191750887039754,
        0.10681753470879643, -0.19420125533839203, -1.7267329727554825,
        -2.091910535442658, 1.426769198727794, 2.4964869250379143,
        0.1924639723560493, -0.42869567332528835, -1.2714889873114108,
        -2.2077711603491403, 0.7653102271845235, 2.824377919445293,
        0.5204170335959685, -0.742169633289755, -0.9768314526197597,
        -2.0705467716708283, 0.07375137037784976, 2.911870921078881,
        1.0451428892662384, -1.0079621396722565, -0.9083886369178304,
        -1.7519288060698848, -0.5185611432834626, 2.7245208193099724,
        1.6674809278457927, -1.11015250622643, -1.069155314937541,
        -1.3664225983553318, -0.9088388170691672, 2.2933382250438212,
        2.2596248269589982, -0.9736662804159845, -1.3988748668622195,
        -1.0417546217636098, -1.046620276465997, 1.707037483178075,
        2.6974603373135473, -0.5839545438544982, -1.789629915630148,
        -0.88594101748793, -0.9461637715709647, 1.0895880355821181,
        2.8920017908957796, 0.008778076401725319, -2.113654675892413,
        -0.9592119219593074, -0.6837338849280756, 0.5742306693487195,
        2.79675967384555, 0.736093677886093, -2.3231246727825092,
        -1.1389561015401841, -0.5822714604991895, 0.6227183225916654,
        1.787879181741187, 2.442860618871567, 2.2108084633795517,
        2.5755018392338074,
      ],
      [
        0.061632867201576014, -0.05001161615552374, 0.03218963568761175,
        -0.006057696404808946, 0.015149399707598151, -0.010650337394085744,
        0.06940285654196708, 0.16324807958682552, 0.10799757541192197,
        -0.3808971246586475, 0.36960614166868766, -0.3203521564704051,
        0.25697774734589407, -0.1701248020612964, 0.076439499775773,
        -0.007638952152501246, -0.016358717399365053, 0.00385159073855995,
        0.015496275933505586, -0.0158971561435829, -0.002784220332705367,
        0.018468007874610646, -0.012917825680310026, -0.007495528626672403,
        0.019286965350750702, -0.008880681950479344, -0.011752667195845425,
        0.01885411534190974, -0.004254590743151498, -0.015236218689288275,
        0.01719587982494849, 0.0006360343644656763, -0.017741347980819885,
        0.014421662394091506, 0.005496778196822632, -0.019083331366068792,
        0.010711166438478158, 0.009989529937108103, -0.019197765168008675,
        0.006304428247002847, 0.013844397100235592, -0.01805388191341264,
        0.0014897688845772578, 0.01679000384923139, -0.015749838036306765,
        -0.0034236932774208387, 0.018655380453022005, -0.01241086333424206,
        -0.008112139371368884, 0.019299965975971934, -0.008278551709829452,
        -0.012277221341565335, 0.01870045619834852, -0.003596055765113717,
        -0.015641164656975806, 0.01687816994321796, 0.0013071372498056621,
        -0.017994134397149752, 0.013968048631635931, 0.006138352007411372,
        -0.01917354267242071, 0.010143452756313025, 0.010558044674616258,
        -0.01911382205660137, 0.005667239427473305, 0.01430572984519894,
        -0.017788788796110018, 0.0010239017813084448, 0.017988774595911236,
        -0.01509869411264225, -0.010210201465964934, 0.05827599211890304,
        0.252901501777707, -0.10433427986841354, -0.024811197112638222,
        -0.29782014280206426, 0.20091188462373336, -0.11832000032294797,
        0.08759935033444637, -0.08008453258472303, 0.06676217496717436,
        -0.038310067425713794, 0.003272323020263948, 0.017643727679972843,
        -0.012241362735241406, -0.008360998483150459, 0.019278922577751014,
        -0.007919146288164456,
      ],
      [
        0.009714583777583309, 0.047722551034478096, -0.09022455371728524,
        0.05248217684413606, -0.03645965355295517, 0.03215724215610564,
        -0.027045689401406364, 0.018164106909714196, -0.008975953175984845,
        0.0029755742637154942, -0.0004972108792289721, -5.114463153745939e-5,
        4.661886424431814e-5, -1.0085492746994363e-5, 5.630043274766634e-7,
        7.636404363357664e-7, 6.642189114311475e-7, 9.331792809441534e-10,
        -6.63233597599945e-7, -7.12489756950569e-7, -1.0116531060926596e-7,
        6.03943905275292e-7, 7.490909014085998e-7, 1.997098779645082e-7,
        -5.348210125568543e-7, -7.734621126880604e-7, -2.949531296018524e-7,
        4.5704107819221556e-7, 7.852847991468028e-7, 3.854300123097162e-7,
        -3.717985196058535e-7, -7.843259709694625e-7, -4.696690514714526e-7,
        2.8043684116425066e-7, 7.705246629276299e-7, 5.462097890982297e-7,
        -1.8452075278798248e-7, -7.441499752302093e-7, -6.138059141012571e-7,
        8.565560940480235e-8, 7.057061466072039e-7, 6.714430962004487e-7,
        1.4624951297479637e-8, -6.557718666349031e-7, -7.181762870785349e-7,
        -1.1472457879624696e-7, 5.950890564123855e-7, 7.531566770870135e-7,
        2.1293210496048253e-7, -5.246982948064591e-7, -7.758241455008492e-7,
        -3.076127733240034e-7, 4.458162320246289e-7, 7.858958465179015e-7,
        3.9730477445047213e-7, -3.596735277903775e-7, -7.83193243413906e-7,
        -4.80576232199003e-7, 2.676076193884706e-7, 7.676744919281119e-7,
        5.559870242265501e-7, -1.711774571181508e-7, -7.396112522635519e-7,
        -6.222822276525874e-7, 7.20183817211017e-8, 6.99545858850137e-7,
        6.784655111568622e-7, 2.831502840578838e-8, -6.481083416728612e-7,
        -7.23642711095584e-7, -1.2824798704644316e-7, 5.860532759179474e-7,
        7.569922145598534e-7, 2.2608705470333075e-7, -5.144193167998753e-7,
        -7.779531972679955e-7, -3.2018030045305286e-7, 4.34456428366503e-7,
        7.862701724172775e-7, 4.0906165346571957e-7, -3.474365223946622e-7,
        -7.818205067461871e-7, -4.913363123374288e-7, 2.5469709553670567e-7,
        7.645899177051911e-7, 5.655930484895098e-7, -1.577851527282903e-7,
        -7.348506982471702e-7, -6.305712401344799e-7, 5.835928348529407e-8,
        6.931747979613671e-7, 6.8528460992331e-7, 4.199943519424374e-8,
        -6.402456391163134e-7, -7.288880446808905e-7, -1.4173231726366942e-7,
        5.768384444944909e-7, 7.605957195779772e-7, 2.39170513963876e-7,
        -5.039869495653209e-7, -7.798479761494135e-7, -3.326510288803155e-7,
        4.2296598176315754e-7, 7.864083171041913e-7, 4.206973386497913e-7,
        -3.35091420303151e-7, -7.802087927855493e-7, -5.019468843233025e-7,
        2.417083037009742e-7, 7.612711841339066e-7, 5.750246424121267e-7,
        -1.443477486623575e-7, -7.298691685695083e-7, -6.386695924934611e-7,
        4.4683358061517825e-8, 6.865956001665778e-7, 6.918986789838908e-7,
        5.567390319334872e-8, -6.321866707687724e-7, -7.339115295518958e-7,
        -1.551743941482737e-7, 5.674466085222982e-7, 7.639657132466515e-7,
        2.521785858503377e-7, -4.934038535758695e-7, -7.815070920462183e-7,
        -3.450202626616106e-7, -0.0008423427867082154, -0.02499926698133381,
        0.0014913304300715412, 0.056470330454372435, -0.05887287628011682,
        0.04426002535597954, -0.025845541294115607, 0.010419177563950477,
        -0.0015599966404909536, -0.001295324220501419, 0.0011382047884227978,
        -0.00044902945262735475, 9.260388059499638e-5, -6.113876217230944e-6,
        -7.6378600240747e-7, 9.702023544922487e-7, 2.2660639474317444e-7,
      ],
    ];
    const result = wavedec(data, "db17");

    const reconstruction = waverec(result, "db17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db18", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49624268668242805, 0.9151110214917837, 1.1955418450344932,
      1.3052084425468986, 1.2461345524774536, 1.0522532214443054,
      0.7796490432483786, 0.49201137253840105, 0.24497632419344156,
      0.07326177254626826, -0.016251175819565256, -0.04387317244368162,
      -0.049215028918498716, -0.07821088040684304, -0.1685081658274269,
      -0.33708895391426974, -0.5734178079600791, -0.8400035822933414,
      -1.0803705861512702, -1.2325348084569867, -1.2446522791101104,
      -1.088910389021133, -0.7701219318859465, -0.326761660612288,
      0.17596140609126426, 0.6594376744704852, 1.0482522516726627,
      1.2860863418252315, 1.3471361956940435, 1.2403645289446175,
      1.0056641446926258, 0.7029994304942626, 0.39730343263829354,
      0.14292041704706843, -0.028554090339191207, -0.11408399250189183,
      -0.1373359380393198, -0.13979213362029855, -0.16725363817072825,
      -0.2553198141831447, -0.41768236451649704, -0.6403501077919085,
      -0.8834054614211092, -1.089967124986268, -1.2001810397636234,
      -1.166750626717725, -0.968079484808465, -0.6156482993486787,
      -0.15364845088488305, 0.34920041551998554, 0.813787816044309,
      1.1673639963067601, 1.3589089918511936, 1.3694551382880833,
      1.214937554165926, 0.9409829578133719, 0.6110226137493511,
      0.29073810971059916, 0.03271560793069117, -0.1349186584761296,
      -0.21315246194034038, -0.22902181123885215, -0.22577836828684622,
      -0.24895458434698436, -0.3320216923709802, -0.48542694933686464,
      -0.6919262696604866, -0.9095162563011407, -1.0813218982876753,
      -1.1500038237987464, -1.0730643947942935, -0.835155383891836,
      -0.45419415377008326, 0.020393214999473608, 0.5170407069680407,
      0.9568729333549905, 1.270484234748715, 1.412657108095431,
      1.3715066874504156, 1.1699029322228238, 0.8589161070511052,
      0.5049821423491213, 0.17400674687326423, -0.08365741855827025,
      -0.24369350998290065, -0.31127610759872826, -0.31680657304774507,
      -0.3051914468679657, -0.32155420919681926, -0.39716007939881637,
      -0.5392626137594363, -0.7275685960292202, -0.9183197176176965,
      -1.0550339331622254, -1.0832293182362485, -0.9654031645951247,
      -0.6924255008636939, -0.2883609290728285, 0.19265570302819202,
      0.6768972977629053, 1.0864527006198688, 1.3559047294476696,
      1.446284939661917, 1.3529677771108646, 1.105648424882097,
      0.7604873250289671, 0.38641715997122694, 0.04901893639759353,
      -0.2040674374021767, -0.3526627736039392, -0.40627126675877656,
      -0.3986349450266849, -0.3761854333355985, -0.38348982338498416,
      -0.4495293383605604, -0.5784168144841446, -0.7470116762897316,
      -0.910118886097325, -1.012008293224155, -1.0013548426449934,
      -0.8457916279392681, -0.5423178183251196, -0.1208025916813397,
      0.36047341992102255, 0.8263201976442608, 1.2005047774328497,
      1.4222008564872646, 1.4590731162533404, 1.3138587000761974,
      1.0228962072207084, 0.6470223091966174, 0.2571171822832356,
      -0.08213064344071824, -0.326271448851683, -0.4595749749552078,
      -0.4959934722034185, -0.47256105546123073, -0.43708701429347896,
      -0.433425587424604, -0.4881939337476087, -0.6024171423904332,
      -0.7503045475423329, -0.8855273838150326, -0.9534366992329252,
      -0.9061197536522858, -0.7164323942934148, -0.38735800356034683,
      0.045819996064981244, 0.5212679305635057, 0.9630356843457437,
      1.2972591789209391, 1.4682565564571355, 1.4506424458312235,
      1.2545449368435184, 0.9226928614807935, 0.5201278917702644,
      0.11909217587665244, -0.21719899138104998, -0.447955737781428,
      -0.5621857509900876, -0.5783792455718197, -0.5367869132658591,
      -0.48642850473909616, -0.47027819761885487, -0.5125052861841934,
      -0.6110982308986403, -0.7378070133514815, -0.8454550619346337,
      -0.8807730724362377, -0.7994721551391621, -0.5796658435030365,
      -0.23012500610282774, 0.2088846678844672, 0.6725914504425059,
      1.0849844749520416, 1.3752282761339474, 1.4932839596590597,
      1.4209618101957764, 1.1757329227429283, 0.8063935689929533,
      0.38166605630791495, -0.025461536900729553, -0.3538344883758749,
      -0.5667784799945454, -0.6583006455347267, -0.6514865248386306,
      -0.5896981702672555, -0.5229769703662326, -0.49323775287592525,
      -0.5221131599261988, -0.6046028761727326, -0.7101802065987866,
      -0.7910882873865026, -0.7957044635907198, -0.6835320588738429,
      -0.437927753111809, -0.07320593109486806, 0.3658526932295796,
      0.8121679476536328, 1.1903561226023125, 1.433231897603737,
      1.4968373342818952, 1.3703500083207247, 1.0784598134617573,
      0.6756407645814629, 0.23372324983191795, -0.17419894573640815,
      -0.48961883220422575, -0.680413118885194, -0.7458171958122779,
      -0.7135329724065399, -0.6298965018573057, -0.5457589212440196,
      -0.501783415768181, -0.5169713793683401, -0.5833773619274227,
      -0.6683715876972163, -0.7238652480597733, -0.7001179132727453,
      -0.5605516736717766, -0.2937054676398302, 0.08084900521656768,
      0.5143118734770078, 0.9379311325145442, 1.277619035719323,
      1.470417090242501, 1.4788211071459356, 1.2994715051460797,
      0.9640774164986343, 0.5323376178034903, 0.07857552520037525,
      -0.32466692520627904, -0.6221104465316086, -0.7865917200963788,
      -0.822765531360776, -0.7629314481341322, -0.6562279976434822,
      -0.554080113153842, -0.4956935772642974, -0.4973377753831913,
      -0.5481610880626286, -0.6135946709655017, -0.6454467461278073,
      -0.5960638617172593, -0.4328735514952137, -0.14949340172180214,
      0.22957063459295007, 0.652017234129834, 1.048058669203721,
      1.3455455953304745, 1.4862721928958287, 1.4394918121037819,
      1.2093261522274565, 0.8342305606805245, 0.3786167988685405,
    ]);
    const expected = [
      [
        2.6073721556426785, -0.7007244283640128, -2.3150222758931074,
        -0.5587055039754599, -0.6501005284526183, 1.497694836898639,
        2.0895269899055413, 0.5931742491755865, 2.3634623724748507,
        1.4173195160897278, 0.19896621185979352, -0.1475374053043635,
        -2.509502284653941, -1.243323034762284, 1.539919765195957,
        3.116636030433597, 0.8915941644777371, -2.1733024131671645,
        -1.291687851793226, -0.5158405752591145, 0.15326907351241903,
        2.619353876423272, 0.663595282501497, 1.7574131765575036,
        2.119368206248103, 0.4887739891778788, 0.23761354707053237,
        -1.5104565229404017, -2.5308989382594436, 0.797734993674753,
        2.4168189669893496, 0.6198007925641633, 0.11356078582213408,
        -1.0723383670107367, -2.6131401705952406, 0.15464706728639047,
        2.5981521155325007, 0.9008137656176731, -0.060224116530698764,
        -0.7353885631273437, -2.5059217884829947, -0.5054932512550854,
        2.60316647641502, 1.3037393752819724, -0.21391895837137123,
        -0.5396191712921845, -2.247427622556353, -1.105828026273923,
        2.4096732493151127, 1.7749093387001071, -0.28137650489565863,
        -0.49618600653985323, -1.8981444588172585, -1.5795858656386972,
        2.0265424475605047, 2.244226101105615, -0.2123411057015597,
        -0.5857726084714765, -1.5299993963249365, -1.881249213054726,
        1.492516967730885, 2.6373025389684677, 0.01814067624849508,
        -0.7623887946979253, -1.2135522768769247, -1.9939982407093884,
        0.8698239982590787, 2.888424817085533, 0.40477919033621024,
        -0.9619096900326879, -1.0054982927823757, -1.9321303944525088,
        0.23370145488171015, 2.9520597414948244, 0.9124363402104967,
        -1.1137376806716244, -0.9392261405387621, -1.736217333882295,
        -0.344548565853601, 2.8172066393311024, 1.4790607346549514,
        -1.1705262605055788, -0.9541616487785165, -1.6135510381713525,
        -0.5612776110437551, 2.247286130197298, 1.7689608949560345,
        1.901935370812619, 1.2127713519101904, 2.9495946476287753,
      ],
      [
        -0.040393537433192545, 0.0737036036182073, -0.10092698776383795,
        0.0324663888897214, -0.024450619597965385, 0.03411174064976581,
        -0.08438434400743053, -0.028436234230981326, -0.2698458226764125,
        0.03434306169676301, 0.26729120007065393, -0.3268482027091682,
        0.26500163933491167, -0.15667490688951796, 0.05169212229341339,
        0.01403784316130419, -0.02898332647922021, 0.00985708193958937,
        0.011797121491568025, -0.013300083105785988, -0.0031970738030015875,
        0.01690267182866016, -0.011697974712798216, -0.006665484713042103,
        0.017539556286602476, -0.00869538359796558, -0.009928294121408237,
        0.01738822945994951, -0.005295718548000855, -0.012748200203813502,
        0.016459650062052956, -0.0016664544707166123, -0.015003299828376568,
        0.014802883349370934, 0.0020428617658982805, -0.01658881619969997,
        0.012484418202313323, 0.005655351834603159, -0.01743941146541259,
        0.009613937112012793, 0.00902235849830548, -0.017511444553832023,
        0.00631312233717421, 0.011982170459154262, -0.016808157750487926,
        0.002734070616228751, 0.014415119241651434, -0.01535377472925968,
        -0.0009687164191025669, 0.01620115265736366, -0.013220597149957826,
        -0.004626615005698185, 0.017272585529877475, -0.010495304651812174,
        -0.008080237447760147, 0.017570209381828027, -0.007307782978185847,
        -0.011173446659258608, 0.017092138770271284, -0.0037905895972026355,
        -0.013770536923366074, 0.015848540324618555, -0.00010976448070082137,
        -0.015754904282863944, 0.01390550843730849, 0.003581089230282944,
        -0.01704002201156991, 0.011275488411258684, 0.006190565145394806,
        -0.023882686234326073, -0.0172526187869593, -0.06930760415004039,
        -0.23036059829757116, 0.06391109804180739, 0.23206016925223477,
        -0.5088233901726843, 0.8555617790033235, -0.5594071848235345,
        0.4075524340462607, -0.24571026583814334, 0.1217116333830965,
        -0.033767942188602136, -0.009224660150631177, 0.010776404763200334,
        0.007187271986336577, -0.01695821138759202, 0.006630857837563757,
        0.011641809630430697, -0.016941762049538706, 0.0032083454150684788,
      ],
      [
        0.0073469560570503184, 0.04672619250402052, -0.07258000481546739,
        0.021468877667963807, -0.005205400006631814, 0.00821995470297646,
        -0.013930680809372839, 0.014586519538368986, -0.010378063899297588,
        0.0051479116789972515, -0.001699301640928683, 0.00030137947182931623,
        1.0360862120270527e-5, -1.9128408967656243e-5, 4.3453956280899335e-6,
        9.796731998596947e-8, -1.1517677782654781e-7, -3.990632997103993e-7,
        -3.2674420681915713e-7, 5.259667000261768e-8, 3.8251602050725984e-7,
        3.5300904776034447e-7, -8.19665602088597e-9, -3.6169559998627896e-7,
        -3.7532515331677895e-7, -3.6280266680921855e-8, 3.368548151415993e-7,
        3.934632586276485e-7, 8.0351603344513e-8, -3.082668698358336e-7,
        -4.0722802599309156e-7, -1.235417145077592e-7, 2.762300297384147e-7,
        4.1644606096748305e-7, 1.6535482326408728e-7, -2.4110640255619523e-7,
        -4.2100896079169324e-7, -2.0530999744474915e-7, 2.033076864034415e-7,
        4.2088613294085985e-7, 2.4297701007204034e-7, -1.6324907223937247e-7,
        -4.160833623503371e-7, -2.7794981494094633e-7, 1.2135737290986375e-7,
        4.066336359194485e-7, 3.098225010437817e-7, -7.81069984436587e-8,
        -3.9263914904299125e-7, -3.3822684793200213e-7, 3.3999413682736046e-8,
        3.742766472786269e-7, 3.628630410891005e-7, 1.0482248446551108e-8,
        -3.517527393331668e-7, -3.834682915845876e-7, -5.4860882437118585e-8,
        3.252976497737634e-7, 3.9979534735963926e-7, 9.86320330868815e-8,
        -2.952056910924683e-7, -4.116513930941504e-7, -1.4128954954909495e-7,
        2.6183322436489576e-7, 4.1892246764123824e-7, 1.8236871571885217e-7,
        -2.255516373948827e-7, -4.215371999756785e-7, -2.2142910333650064e-7,
        1.8674452707889077e-7, 4.1944764016636926e-7, 2.5802337168491463e-7,
        -1.458464609036164e-7, -4.126685358393465e-7, -2.91726762257487e-7,
        1.0333410187794845e-7, 4.01294791559354e-7, 3.2217646883664593e-7,
        -5.967818852886327e-8, -3.8546057229751113e-7, -3.4904905679790814e-7,
        1.5344855433927104e-8, 3.653226047199045e-7, 3.720310498884595e-7,
        2.916722213802251e-8, -3.4109924835543856e-7, -3.908510676637724e-7,
        -7.334154314804248e-8, 3.1308069111515944e-7, 4.053141318296784e-7,
        1.1669134892421423e-7, -2.8158420451792943e-7, -4.1527327317756405e-7,
        -1.5875328376309027e-7, 2.469404683591615e-7, 4.2060177962746167e-7,
        1.990515474060182e-7, -2.0953201670311364e-7, -4.212269266721742e-7,
        -2.3711738913843226e-7, 1.6979654990540283e-7, 4.1715826701723175e-7,
        2.725345356751875e-7, -1.2817946240831875e-7, -4.084534526725707e-7,
        -3.0492717217001294e-7, 8.512387520718191e-8, 3.951922583531864e-7,
        3.339249281073746e-7, -4.110863565705676e-8, -3.775112819055006e-7,
        -3.5918609075066255e-7, -3.354686681160196e-9, 3.5562557801472907e-7,
        3.804394216324744e-7, 4.7770542371351855e-8, -3.297892784928651e-7,
        -3.9746580412512757e-7, -9.166466326149359e-8, 3.0027184592668787e-7,
        4.10063962090807e-7, 1.3454631165667718e-7, -2.6739331482142917e-7,
        -4.1807634065429595e-7, -1.7591664890558438e-7, 2.3153933781947444e-7,
        4.2142612085998725e-7, 2.1531714402382186e-7, 0.006809164503264709,
        0.04329775190433995, -0.06725575232804275, 0.019892808953737216,
        -0.004820224121385851, 0.007609959521890603, -0.012899805985092638,
        0.013508989115446072, -0.009612948790577296, 0.004769417645070522,
        -0.0015746947597255149, 0.0002794426624896356, 9.459908941374517e-6,
        -1.7801763125687663e-5, 4.027038774322751e-6, 1.7122563995724397e-7,
        -2.0673789869695002e-8,
      ],
    ];
    const result = wavedec(data, "db18");

    const reconstruction = waverec(result, "db18", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db18_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5074919607062125, 0.933976868803335, 1.2157245388236997,
      1.3193840756033162, 1.2477873348206598, 1.0371616097803211,
      0.7466091284173073, 0.44263094230106187, 0.1826766528280852,
      0.001885879097864751, -0.09369017664516638, -0.12580963545671014,
      -0.13522906437776325, -0.16784137433699342, -0.25954779888148494,
      -0.42396950541985373, -0.6463585203272719, -0.8854477062524292,
      -1.082902035903141, -1.17803273148957, -1.124027388467098,
      -0.9014974044125927, -0.525768886076842, -0.04588928906897022,
      0.4646020626097588, 0.9230133653611332, 1.2552723981665475,
      1.4118257069298563, 1.3778147968221763, 1.17510364395399,
      0.8557638916999558, 0.48874799060045626, 0.14315762967226786,
      -0.12767903696365368, -0.2973741719244907, -0.37021036407546976,
      -0.3766928271104757, -0.36229640992710266, -0.37252666136690205,
      -0.43834638785506996, -0.565899459354708, -0.7333244938337579,
      -0.8955864920467027, -0.9961447394180467, -0.9824638065764988,
      -0.8213287633111522, -0.5099175029291028, -0.07961855489879535,
      0.4085992608153441, 0.8763206063656799, 1.2444623726204664,
      1.4506387051344918, 1.4628745290272254, 1.286319690565207,
      0.9613503277161686, 0.5535837023690053, 0.13833497003014167,
      -0.21659796116559427, -0.46556479075269674, -0.5935590183039099,
      -0.616631671798276, -0.5743576055442896, -0.5165212764178047,
      -0.4876499779039572, -0.513540508037421, -0.5933700435593359,
      -0.6994987037489715, -0.7850429556737394, -0.7972484325043363,
      -0.6931465307914659, -0.453340348630309, -0.09019926714821846,
      0.3518599701382539, 0.8043197558558774, 1.1889443846018688,
      1.4351433448257496, 1.4960626812590423, 1.3594290566887317,
      1.050454585401977, 0.6260763508385042, 0.16195478316204653,
      -0.26455526862606493, -0.5912709837372057, -0.7837791830488063,
      -0.8407773022631311, -0.7910357644143836, -0.6829952807770855,
      -0.5698723734581046, -0.4942567273350794, -0.4762637239520943,
      -0.5083378322159029, -0.5580389023476887, -0.5780390650056573,
      -0.5206552099843905, -0.3530314148247917, -0.0688802339030935,
      0.3064532772033787, 0.719142323619537, 1.0976727627812697,
      1.3687307919788132, 1.4742915588528236, 1.3856572519525094,
      1.1109125671179685, 0.6938835895670606, 0.20479403957404366,
      -0.27512375478162204, -0.6713101134023616, -0.9315492871089426,
      -1.035863703922891, -0.9983452696992478, -0.860686107490193,
      -0.6792639279778412, -0.5092416859445874, -0.3898502444156623,
      -0.33465901831578226, -0.32930029007898687, -0.33714490647551065,
      -0.31133778373764825, -0.20992905745582652, -0.010011610142392546,
      0.28298864196959356, 0.6334858592264466, 0.9820638367799076,
      1.258538914811603, 1.3985670157533483, 1.359644038016546,
      1.1324415459701065, 0.7445473535789876, 0.2555595416747884,
      -0.2553631623980731, -0.7065085881864654, -1.0310561189622611,
      -1.1907429180863103, -1.1824986771296533, -1.036574459226573,
      -0.8068307523356213, -0.5558062488448389, -0.3384654626118767,
      -0.1887978478374625, -0.11264786719797154, -0.08850173212897612,
      -0.07586926968303373, -0.02891579704192787, 0.08837105114580412,
      0.28959879018574225, 0.5594254052360605, 0.854941010299729,
      1.1148014207488433, 1.2739083063175691, 1.2799542396094474,
      1.10761061672224, 0.766674683317015, 0.3019757007869991,
      -0.21510536276993397, -0.7015447317129753, -1.0804375763480984,
      -1.297316400009174, -1.3310902515471204, -1.1970187484525807,
      -0.9411308527732148, -0.6276331392084891, -0.3225839665645271,
      -0.07800015998533194, 0.07961146752699011, 0.15349515285567342,
      0.17275414584124765, 0.18153584552852559, 0.22429576056696865,
      0.33114947297188835, 0.5072875588556389, 0.7293620133033645,
      0.9499286594596662, 1.1089174616144684, 1.1492453053629443,
      1.0325626585548364, 0.7510281700803667, 0.3319630247911351,
      -0.1659909903734587, -0.6644488076711523, -1.081875856558674,
      -1.3511993491945962, -1.4341631143247926, -1.3289533580401458,
      -1.0692977882858397, -0.7153643604451951, -0.33881958139050045,
      -0.00583445994167392, 0.23771164910775475, 0.37519662048249747,
      0.42029338321968013, 0.4100406629678933, 0.39195930353922853,
      0.4087474240254615, 0.4846883196723676, 0.6174334875619603,
      0.7774023413212986, 0.9150365125288142, 0.974076224042308,
      0.9074226430037498, 0.6914277537563722, 0.3348010782788029,
      -0.1203445654337624, -0.6058057656602115, -1.0413335174422085,
      -1.3520592226319845, -1.4850650030037273, -1.421043783015229,
      -1.178200293228333, -0.8074687085362745, -0.38027830767478304,
      0.028061143698361046, 0.35522344731921546, 0.5648371110553433,
      0.6524565948459738, 0.6432414881027749, 0.582180033183057,
      0.5195911129960639, 0.4958211756305958, 0.5292191063205867,
      0.6105829736445122, 0.7055587131265195, 0.7643744001827479,
      0.7363551098936496, 0.585382432243966, 0.3021710448385844,
      -0.08998958101893284, -0.5377328343788397, -0.9679567312616257,
      -1.3035987151778632, -1.4810164704342328, -1.4646954830016783,
      -1.2556340615919268, -0.8913114701139464, -0.437231604376092,
      0.02787553280140881, 0.42954910121421697, 0.7135028542688868,
      0.856095570290284, 0.8669300070526882, 0.7831584395786872,
      0.6571781667756615, 0.5410594179459135, 0.4718389753060893,
      0.46153653411352735, 0.49448183535111834, 0.5326076116378698,
      0.5272649553785904, 0.43439456240143653, 0.22898377688124272,
      -0.08511038878312993, -0.47272419037222246, -0.8731997629773078,
      -1.213185216590195, -1.423340985384591,
    ]);
    const expected = [
      [
        2.8630659684198796, -0.16456505629877116, -2.196118202577713,
        -0.6942204092363966, -0.8337789976323897, 1.4112237143433748,
        2.0966750465859927, 0.6122694601005584, 2.4004033050727873,
        1.3591846006761963, 0.04709919640962226, -0.33417525542801024,
        -2.578219626672332, -0.6501707959961067, 1.7764885095176854,
        3.2087396615174777, 1.4279604901232106, -1.8571837325528486,
        -1.356725114032326, -0.68832969760211, 0.004176523695606891,
        2.60872831851525, 0.6664812778920296, 1.8059088251663122,
        2.102785798668525, 0.3788910719605456, 0.053695088512861186,
        -1.688278106245346, -2.227506278872517, 1.376770579034899,
        2.4115959164090253, 0.16404631689856677, -0.37142669351486846,
        -1.4408395449433904, -2.071858525934052, 1.300033530406784,
        2.6731290510535266, 0.026459273814794678, -0.831139106632464,
        -1.2222500161477428, -1.8161430830986343, 1.1820349769731588,
        2.853604477573004, -0.03516932316692023, -1.2985275811643104,
        -1.052252733524585, -1.469218048420273, 1.04711843057783,
        2.9362514041512466, -0.029729403990462654, -1.7451362972966784,
        -0.9445993067613229, -1.0473565706015509, 0.9202149666319444,
        2.9114079763959286, 0.027224597219305344, -2.143374037087817,
        -0.9058350031269246, -0.5729452378291693, 0.8244794332248792,
        2.7774090463227217, 0.11502189657299236, -2.468853069253021,
        -0.9347455023216195, -0.07264184581876246, 0.7790965603375126,
        2.540775607258771, 0.2098864017893693, -2.7024532306602453,
        -1.0225142893603176, 0.42484436156408206, 0.7974544665617911,
        2.2156885125620356, 0.2872293764472079, -2.8319311574442803,
        -1.1535548686800476, 0.891070103667494, 0.8860417788892334,
        1.8227013669891825, 0.32270857055469604, -2.84617154684292,
        -1.328116051043415, 1.3510765911639926, 0.9418996604629722,
        1.5637101757127714, 0.029113776101803258, -2.4475930539172173,
        -1.202139672678623, -2.724001192686539, -1.5604311405951126,
      ],
      [
        -0.03839067803275584, 0.09792907312810473, -0.13741713080265328,
        0.04197458517516873, -0.028367355168395093, 0.04354629306064194,
        -0.09976993768073453, -0.016918552347171642, -0.28322791460460145,
        0.0357973686443691, 0.276857273700991, -0.33832657638702324,
        0.2739070177598836, -0.1616186254415302, 0.05272603349772524,
        0.015958032648840808, -0.03202574338702148, 0.01169208500816292,
        0.012736976206580035, -0.016334605987808913, -0.0009335000186812602,
        0.018003471016089838, -0.015581285168910736, -0.0037962306894145986,
        0.01904778195346879, -0.01358289865293214, -0.006662486629143645,
        0.01966075964274782, -0.011265838861952301, -0.009380968063130029,
        0.019821431124306364, -0.008703669240878488, -0.011886263597256043,
        0.019546806527467393, -0.0059379677354849175, -0.014127089019675151,
        0.018822130091519437, -0.0030461844108672104, -0.01604693921532524,
        0.017684897845256158, -7.88877765972951e-5, -0.017609822463661218,
        0.016139263356314944, 0.002883595833555203, -0.01877238321987308,
        0.014241557345346845, 0.005787378427494946, -0.01951771139088821,
        0.01201276944022208, 0.008555360222168608, -0.01981882582273001,
        0.009524741614921233, 0.011136164224365553, -0.019680143825255715,
        0.00681169964040751, 0.013461874357144951, -0.01909265942810236,
        0.003956298016433567, 0.015489082552592837, -0.018082611264177137,
        0.0010012120039302097, 0.017164344932965144, -0.01665881061091581,
        -0.001965763152187145, 0.018456810517582575, -0.014868021357603553,
        -0.004899544018586963, 0.01932647246515109, -0.012737717633830508,
        -0.007473476748476108, 0.021350111048477904, -0.006043856702306683,
        -0.01559837651843124, 0.05339559844807531, 0.07528436616535579,
        -0.2856029603322067, 0.3370677356395468, -0.3004773250310901,
        0.20518850079302053, -0.09911257994787168, 0.01595589088054281,
        0.021052554905262547, -0.014880604129182884, -0.008171050990687182,
        0.018597044963167136, -0.006300663904750102, -0.01373111117583084,
        0.018993927326006976, -0.0036076516811581736, -0.01570166903960569,
      ],
      [
        0.007516477245451492, 0.04784548803093935, -0.07431323747013452,
        0.021987356103375766, -0.0053451522899596, 0.008450264904668336,
        -0.014307818212287157, 0.014971080171643798, -0.010643994735823881,
        0.005275287131295242, -0.0017392867387191005, 0.00030764387099885737,
        1.0851192054017836e-5, -1.9554000052039884e-5, 4.515937785660062e-6,
        1.1516017798351399e-7, -1.7996347551688233e-7, -4.856831579576782e-7,
        -3.458040025904956e-7, 1.250046178410489e-7, 4.761883991360367e-7,
        3.7167187474558753e-7, -8.852185159325243e-8, -4.6399271002175334e-7,
        -3.9542186194968614e-7, 5.1564651765905717e-8, 4.4920058824104963e-7,
        4.1694873618662683e-7, -1.4327840269914877e-8, -4.319009889147544e-7,
        -4.361543381919862e-7, -2.3012953773006176e-8, 4.121557414839603e-7,
        4.5290326385572977e-7, 6.02360515466099e-8, -3.900684897259884e-7,
        -4.6707682115395934e-7, -9.709734631345064e-8, 3.657987424735872e-7,
        4.786212634069648e-7, 1.3339905159127518e-7, -3.3949241660536895e-7,
        -4.874973491470578e-7, -1.689718876405941e-7, 3.1126289838352485e-7,
        4.936303867713867e-7, 2.0360767905213054e-7, -2.812580299984321e-7,
        -4.969588448022978e-7, -2.3707598790795627e-7, 2.496808391553738e-7,
        4.974873335063414e-7, 2.691945236001224e-7, -2.1672189728380596e-7,
        -4.952410798324873e-7, -2.998182745893479e-7, 1.8253325976050175e-7,
        4.902108166487681e-7, 3.287705574814249e-7, -1.4729286061451003e-7,
        -4.823955446309256e-7, -3.5585240129660105e-7, 1.1123180807460462e-7,
        4.718596705655844e-7, 3.809137990655669e-7, -7.45692893296503e-8,
        -4.586928562239582e-7, -4.0384980448226407e-7, 3.7479780435584594e-8,
        4.4295036752121255e-7, 4.2453070006865605e-7, -1.5423291489474298e-10,
        -4.2468949515903017e-7, -4.428039189515483e-7, -3.7166223020392283e-8,
        4.040302922558337e-7, 4.585653495181991e-7, 7.425211407608984e-8,
        -3.8112126706539873e-7, -4.7176235867178814e-7, -1.1092468083364597e-7,
        3.5607574501220624e-7, 4.823237535400771e-7, 1.4699842343063293e-7,
        -3.2900172608337865e-7, -4.901541345650082e-7, -1.822413301247749e-7,
        3.0006554252705115e-7, 4.952045055844062e-7, 2.1643260910255086e-7,
        -2.6946379474004255e-7, -4.974821180228852e-7, -2.494075766571189e-7,
        2.3735653779284593e-7, 4.969809118194842e-7, 2.8100444032421764e-7,
        -2.0389016195855594e-7, -4.93668342374403e-7, -3.110187689278358e-7,
        1.6926352784230198e-7, 4.875545318538183e-7, 3.392564078304521e-7,
        -1.3370641575346303e-7, -4.787087831325479e-7, -3.6558369173651274e-7,
        9.741031735128662e-8, 4.671912332846782e-7, 3.898789063560416e-7,
        -6.054422651612703e-8, -4.530323321678217e-7, -4.119813493845915e-7,
        2.3322556537297563e-8, 4.3629969505632077e-7, 4.317388975730665e-7,
        1.4009518847815001e-8, -4.171212803257035e-7, -4.4906285195511556e-7,
        -5.124688503633037e-8, 3.9561884998334665e-7, 4.63884550282061e-7,
        8.821586484949316e-8, -3.7188040370966194e-7, -4.7609950271255834e-7,
        -1.247051173839396e-7, 3.4602405972726765e-7, 4.856090283146887e-7,
        1.6047316165467032e-7, -4.9948802464162275e-5, -0.0018804923058992837,
        -0.0011592176294591852, 0.006730687622671684, -0.006787661188028934,
        0.005507040702137521, -0.003806430198967177, 0.0020827102306137605,
        -0.000782578381547632, 0.00011327662327484168, 7.4991197209971e-5,
        -5.961619860005679e-5, 2.0215383134164994e-5, -4.0962608018229345e-6,
        1.0815040361332427e-7, 4.491538878848393e-7, 4.564131315424344e-7,
        8.499439012534703e-8,
      ],
    ];
    const result = wavedec(data, "db18");

    const reconstruction = waverec(result, "db18", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db19", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5016729230034429, 0.9224915434441102, 1.1993129947133643,
      1.300037821089746, 1.229305183636805, 1.0252480329815212,
      0.7482856597812086, 0.4649490820984312, 0.23096964399540343,
      0.07799609199283486, 0.007308993190543789, -0.007964126525266547,
      -0.012876704878517192, -0.05572084282240636, -0.1722080555554159,
      -0.37309634868759683, -0.6386804861702502, -0.9217555271544654,
      -1.158427129903872, -1.2840586743255746, -1.2502587493534687,
      -1.0384863490155745, -0.666673603373171, -0.18702725601163855,
      0.3245833581744384, 0.7850925626498182, 1.1224992849950248,
      1.291402247835303, 1.2819866693439717, 1.1203156606305738,
      0.8600002691366228, 0.567513770211793, 0.3050126174700969,
      0.11511751836145878, 0.011543730168751043, -0.022099971044936995,
      -0.02518833701483633, -0.04667147562876456, -0.12907259880905725,
      -0.2942632674218068, -0.5349191543618009, -0.814063874028019,
      -1.0729755468044584, -1.24551624381271, -1.2752259279831026,
      -1.130749384741931, -0.8155412494750618, -0.36922656567160883,
      0.13988587595594382, 0.6293799554562074, 1.0208245171302583,
      1.2569048609209754, 1.3133612327420678, 1.2028307446879114,
      0.9697583994979065, 0.6778178682033635, 0.3931758181873721,
      0.16795697085686973, 0.028158766032963245, -0.03094364276207706,
      -0.04085226587619993, -0.04856513709103505, -0.10109273023120363,
      -0.23000810713280584, -0.44025576673778266, -0.7063222269841831,
      -0.9769309696201239, -1.1871710608667412, -1.2749900245267498,
      -1.1977941888494414, -0.9448155224647398, -0.5419485048872952,
      -0.04766636122268277, 0.4590983448735405, 0.8961661799282437,
      1.1961664160312562, 1.3209669259733934, 1.2689361149296037,
      1.0733269586900906, 0.792337743724838, 0.4935157368981143,
      0.2365839601915971, 0.059124157848946146, -0.031246931909139408,
      -0.0563055529103063, -0.058570603042497504, -0.08701875767867434,
      -0.18108772890594627, -0.35733698515618467, -0.6024335391513964,
      -0.8744632447340246, -1.1123697857264525, -1.2511671710978298,
      -1.2390198048080396, -1.0517433205912472, -0.7008934552345136,
      -0.23322357930451337, 0.27851121706875914, 0.7512117707614901,
      1.109704565204086, 1.3031007895219617, 1.3152081574417274,
      1.166478765642866, 0.9071369708177276, 0.6033744454400296,
      0.3202461273184761, 0.10570093868955699, -0.02016902326114678,
      -0.06798306318533251, -0.073445888697748, -0.08489138226580195,
      -0.14744027013259414, -0.2881017637420881, -0.5058969726523956,
      -0.7697573394948902, -1.0248996815668232, -1.2061353286069054,
      -1.2547196357231731, -1.1343736703682497, -0.8422687084607541,
      -0.41201881990230427, 0.09224483508161566, 0.5893656966144172,
      0.9989271422719921, 1.2588996485825277, 1.3388037264204338,
      1.2451672409051633, 1.0180234841521083, 0.7194786800522945,
      0.41738500434681347, 0.16837011035064953, 0.004584939760136741,
      -0.07248675537859572, -0.08969343000929422, -0.09214162798989634,
      -0.12820310575209343, -0.23371203686540387, -0.41966883958681206,
      -0.6668403758739451, -0.9288266094200341, -1.1429254976195635,
      -1.2460545321030834, -1.1916202921472214, -0.962925037239476,
      -0.5795439348043852, -0.09488240653228207, 0.4146273826960872,
      0.8660898563391224, 1.1883877004467207, 1.3375847817435436,
      1.305695463813883, 1.1207191253897044, 0.838066051138713,
      0.5256865284409968, 0.2467949402423018, 0.04464846238858006,
      -0.06674796936877408, -0.10372625214305814, -0.10571688009388737,
      -0.12176522891161468, -0.1945171531240248, -0.346047793297332,
      -0.5694170519726405, -0.8283232945275969, -1.0650875330266136,
      -1.214991336940454, -1.2232893822309885, -1.0604672247338636,
      -0.7317150135884573, -0.27803827014352944, 0.23144549817589066,
      0.7142200282279807, 1.0924888338641883, 1.31021553729037,
      1.3448725807930515, 1.2110345867063979, 0.9550332190906696,
      0.6421643191841055, 0.33981825578543057, 0.1009064084795478,
      -0.04817582823890876, -0.11203808285616004, -0.12222766503182568,
      -0.12585175788002018, -0.17005343637557124, -0.28658897064455224,
      -0.4807202542491651, -0.7274950043941077, -0.9765361861877493,
      -1.16420953308848, -1.23007158729998, -1.133334120028258,
      -0.8650205469510419, -0.4525553762213367, 0.04455419255800277,
      0.5470094032634173, 0.9730030716951266, 1.2562280313421517,
      1.3601510598387638, 1.285042519375918, 1.0660999530387538,
      0.7632723615262468, 0.445494971219474, 0.17343957473619454,
      -0.014785448633057752, -0.11137020332344494, -0.1381089402490707,
      -0.1376369365876457, -0.15907878854141316, -0.24205057382168976,
      -0.40338302036962365, -0.6302098725047234, -0.8813838048084955,
      -1.0969799486244831, -1.2134986220633097, -1.1808450435925313,
      -0.9766463414336546, -0.6141030709646902, -0.14120202296338713,
      0.36868034743417205, 0.8325480044753772, 1.1760533266422337,
      1.3497390665512032, 1.339241637739927, 1.1669823183121748,
      0.8850425065332647, 0.5611586126638078, 0.26150356419633136,
      0.03469950699094809, -0.09886796355093985, -0.14978905666936118,
      -0.15388080819238442, -0.15964078688312128, -0.21237502399861735,
      -0.3393371145973863, -0.5399408955236298, -0.7837666605794648,
      -1.017020622047656, -1.1758664366295553, -1.2032107546091988,
      -1.0645721611338759, -0.7588454973049388, -0.3210476477964922,
      0.18383083016028529, 0.6744675236676119, 1.0710169602089308,
      1.3126832548715623, 1.3707050083834682, 1.2535678468520723,
      1.0032411617545698, 0.6835191885149856, 0.36354296546100856,
      0.10077433541825165, -0.07222031836345194, -0.15385923591011114,
    ]);
    const expected = [
      [
        2.5691082065319724, 1.2793350833393828, -2.1050971899821214,
        -1.5412043194269713, -0.33347538054032094, -0.017906735637302766,
        2.6331406070068195, 0.7324974734998868, 1.6656511155950364,
        2.123492977825803, 0.5243147664779004, 0.23352708145954867,
        -1.525567757153116, -2.612047159512972, 1.1912294192305946,
        1.6418010555306857, 2.3376774210974816, 2.2687437166480917,
        -1.2570838635764512, -2.1391552785026033, -0.3539252104984089,
        -0.6672943709850506, 2.2666487142998117, 1.3138916592668093,
        1.0598805641029039, 2.405250062035794, 0.8963628202407193,
        0.4243878770064977, -0.764083648995502, -2.778157374538673,
        -0.3021726790108241, 2.3646758316071104, 1.0424162955772265,
        0.39012362997890593, -0.5462573174534255, -2.7271894045189153,
        -0.6729719742963766, 2.3332584598679316, 1.2104608284767047,
        0.35465499640031956, -0.3552140355089508, -2.6288126588001326,
        -1.0336858220014922, 2.25251538577086, 1.3946765087809032,
        0.3250981167516367, -0.19466489232334352, -2.4884408815266044,
        -1.3749425496581125, 2.1214164165808977, 1.5885213338926754,
        0.3081722633370206, -0.06672410180982404, -2.3127346222377723,
        -1.6880044434161154, 1.940701181421619, 1.7845573368299277,
        0.30988090835929866, 0.02814515288191723, -2.1093190164425986,
        -1.9650899948298415, 1.712883072574426, 1.974754418121743,
        0.33522387142040916, 0.09111424968036028, -1.8864652781736764,
        -2.1996580879992367, 1.442181765903018, 2.1508224097171276,
        0.38795276253561245, 0.12490297804945619, -1.6527491216554202,
        -2.3866426320019034, 1.1343868533156154, 2.3045573983461067,
        0.47038197199453996, 0.13361986394211495, -1.4166883542178292,
        -2.522577337670373, 0.7962370380752692, 2.429821010840345,
        0.5788045495572701, 0.13208477175913938, -1.2033599441632,
        -2.5794132817664557, 0.39788553942829724, 2.573783029350011,
        0.6379739926096322, 0.15763418116628708, -0.18846603323295494,
        -0.21369323124899356,
      ],
      [
        -0.028743329357472525, 0.11146891348919521, -0.0958157971392654,
        -0.04919618067794064, 0.0803050971629437, -0.03635417814890936,
        -0.0031836675989460263, 0.08244387059516806, 0.08464444064345127,
        0.2865556470144011, -0.22741560924739546, 0.041976047570148306,
        0.008321062130143607, 0.026366773729335557, -0.0739353273392797,
        0.09089680707972957, -0.06850129436034325, 0.026037603546501475,
        0.007168317226340464, -0.013308700473703129, -0.0020567438222314177,
        0.01700737986751658, -0.014044749138981906, -0.003885615056455164,
        0.017731358347320175, -0.012797888103562603, -0.00569492133066712,
        0.018155106160467397, -0.01137959837664125, -0.007450898937890563,
        0.018387021166306864, -0.009844940562235071, -0.00912815568818263,
        0.018431187438989964, -0.00820605349732147, -0.010711806725479106,
        0.01828071042012257, -0.006484018569121811, -0.012183127039976859,
        0.017943544850370027, -0.004692448489206101, -0.013528847988039125,
        0.017416856666551496, -0.002854430610561972, -0.014733246118630394,
        0.016712384844432437, -0.0009843783044305454, -0.015785287929798834,
        0.015831256841269025, 0.0008934188101984326, -0.016672843435509063,
        0.014788723536375824, 0.0027645037154844, -0.01738762189359647,
        0.013589615779334083, 0.004604224823502619, -0.01792154833602086,
        0.012252272706727475, 0.006398852912703364, -0.01826945002269308,
        0.010784823533512494, 0.00812421772549417, -0.018427619380309734,
        0.009208136712109538, 0.009768070468152222, -0.018394229280220366,
        0.007533089184502444, 0.011307371541024415, -0.01816987985083684,
        0.005794343252693496, 0.012809339086260267, -0.01752254429330623,
        0.0034501569723347243, -0.011484288732261866, -0.08658226315213463,
        0.09729155098227585, 0.03479634119318786, -0.0535443877589964,
        0.029295293572420448, -0.00014636255701479944, -0.01121861605804977,
        0.0008905634033380668, 0.015066605738728301, -0.017175821482468732,
        0.001868626145836217, 0.015343796598841436, -0.016472231940456328,
        0.00029476071683630405, 0.01613722025763406, -0.015459578268011658,
        -0.0015989169509445765,
      ],
      [
        0.005585246953694734, 0.04441366192926874, -0.053564416574932425,
        -0.010569249835287094, 0.027934859882468285, -0.020572191968210383,
        0.0066270293299050854, 0.0037357000614055462, -0.007178209718766288,
        0.005669508334723182, -0.002857284005903947, 0.0009410500630011537,
        -0.0001732682993436636, 1.293965908357465e-6, 7.89087656910416e-6,
        -1.7699823246539794e-6, -1.9067151269011766e-7, -1.370662518935522e-7,
        1.271885080829931e-7, 2.7481591865623527e-7, 1.5567734988577996e-7,
        -1.1457800072235916e-7, -2.7361023501331306e-7, -1.6704537905720198e-7,
        1.0167197165169505e-7, 2.7169384694548824e-7, 1.7797756959072184e-7,
        -8.850512449423067e-8, -2.6907555448996297e-7, -1.8845097825580927e-7,
        7.510598374528116e-8, 2.657577265218477e-7, 1.9843638524775013e-7,
        -6.15084364112318e-8, -2.617453596511001e-7, -2.0790246217996976e-7,
        4.775354522497328e-8, 2.5705346598357763e-7, 2.1682685541873412e-7,
        -3.3877725258061474e-8, -2.5169766367294026e-7, -2.251916641587077e-7,
        1.991127382199394e-8, 2.4568713750514474e-7, 2.329726787449328e-7,
        -5.890047854592006e-9, -2.3903427615252844e-7, -2.401445057332657e-7,
        -8.143745785781796e-9, 2.3176123852181912e-7, 2.466912102425322e-7,
        2.2153454833027326e-8, -2.2388994171467846e-7, -2.526008336297726e-7,
        -3.6108468647052e-8, 2.1543583247296729e-7, 2.5785511847569024e-7,
        4.9972459137421934e-8, -2.0641807812588496e-7, -2.6243546841187537e-7,
        -6.370362410198545e-8, 1.9686522719678657e-7, 2.663331133323339e-7,
        7.726659346153256e-8, -1.868046882128589e-7, -2.6954271734979086e-7,
        -9.06319021431542e-8, 1.7625736731714083e-7, 2.7205262628120816e-7,
        1.0376425686562577e-7, -1.6524831087924472e-7, -2.738516511819129e-7,
        -1.1662380186593122e-7, 1.538114591883014e-7, 2.7493863880382414e-7,
        1.2917791333027974e-7, -1.4197865034136776e-7, -2.753152888278236e-7,
        -1.4139968703807266e-7, 1.2977521035382806e-7, 2.7497688754923334e-7,
        1.5325632815774332e-7, -1.1723095976409134e-7, -2.7391997478939386e-7,
        -1.647113552674546e-7, 1.0438398607965966e-7, 2.721511979424795e-7,
        1.7573630374192706e-7, -9.126932414913217e-8, -2.696793442485961e-7,
        -1.8630811776247794e-7, 7.791549303578336e-8, 2.6650673429558033e-7,
        1.9639782501239176e-7, -6.435576363592002e-8, -2.626376123695583e-7,
        -2.0597364740552248e-7, 5.06309912093957e-8, 2.5808629221990436e-7,
        2.150124712186325e-7, -3.677802886245368e-8, -2.528684247470124e-7,
        -2.234962844828467e-7, 2.282717283283025e-8, 2.469931369891327e-7,
        2.314010503678036e-7, -8.813757324418723e-9, -2.4047206886923905e-7,
        -2.3870082708307696e-7, -5.220106017740269e-9, 2.3332674318848326e-7,
        2.453789007891369e-7, 1.9237250466489386e-8, -2.255791596983597e-7,
        -2.514231863018178e-7, -3.320700365888088e-8, 2.1724471880789502e-7,
        2.568155427879661e-7, 4.7093514457110795e-8, -2.0834184112711337e-7,
        -2.615367584258264e-7, -6.085494198745675e-8, 1.9889853578216883e-7,
        2.655772530349735e-7, 7.445531692375252e-8, -1.8894235533579262e-7,
        -2.689316024753186e-7, -8.786510225700406e-8, 0.00013867243968124248,
        0.00019797369434566747, -0.0004794621704391652, 0.000362926852959411,
        -0.00034532304422567675, -1.4687576277825444e-5, 0.000495387721816353,
        -0.0007126896571981287, 0.0005632295937887548, -0.0002672818919620376,
        6.0880757527375016e-5, 9.05963847093747e-6, -1.1278578351559438e-5,
        2.8926930300357043e-6, -2.1051556624337114e-7, 1.9593581925519998e-7,
        2.3745274677577551e-7, -1.2333696946736806e-8,
      ],
    ];
    const result = wavedec(data, "db19");

    const reconstruction = waverec(result, "db19", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db19_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4990785743973271, 0.9202926882006237, 1.2021097546544155,
      1.3117848899234292, 1.2510206333804201, 1.0535841214005242,
      0.7756094718607618, 0.4810963549403873, 0.22626481708308888,
      0.046657342139656166, -0.04986220754581161, -0.0825875603028981,
      -0.09022440346420976, -0.11805466208686766, -0.20343480107586787,
      -0.36347060615128884, -0.5881531780762719, -0.8408475600031422,
      -1.066147034649449, -1.2032153984216718, -1.2013128657140983,
      -1.0335993363606324, -0.7056859521348577, -0.2566713836870558,
      0.24776035091418935, 0.7286464514582328, 1.1103359184605828,
      1.33642444006789, 1.381246366624188, 1.2542235073639767,
      0.9961215031724984, 0.6682438045696287, 0.3373084952510005,
      0.05977854499632457, -0.1305013906367538, -0.22838579882366944,
      -0.25586513492553664, -0.2534412666259125, -0.266809734833846,
      -0.332395773080983, -0.46556762039105, -0.654656564531842,
      -0.8624237088958592, -1.034703901029944, -1.1141086302366776,
      -1.0553482214732566, -0.8382738034314334, -0.47526007361662204,
      -0.01092389580337283, 0.48593982669035535, 0.9363947909166748,
      1.268072599552863, 1.4305768879100853, 1.405908386738275,
      1.2114483888750607, 0.8948559717140768, 0.5222067173364884,
      0.1623373299167331, -0.12874449853883718, -0.3195927176217257,
      -0.4084147260946137, -0.42043436822977653, -0.3983932712312239,
      -0.38878186425910327, -0.42745262901345993, -0.5284012489678751,
      -0.6786744728123689, -0.8407859302991592, -0.9620906696279394,
      -0.9887724708595522, -0.8808884457183492, -0.6245995056792221,
      -0.23837548849412993, 0.22856221139771873, 0.7053764378667355,
      1.1142554634618242, 1.38710213793416, 1.480280658021342,
      1.383883979530955, 1.123313232773609, 0.7528342285882595,
      0.34272964434101605, -0.03678654927375091, -0.3309671922324023,
      -0.5115344041712502, -0.5807136938228878, -0.5674942332227492,
      -0.517264976312017, -0.4776293477833997, -0.4841387320483117,
      -0.5496735663597432, -0.6602454772574027, -0.7783365727463241,
      -0.8529509178449918, -0.8338179035102187, -0.686095737439656,
      -0.40175235177688806, -0.00459649365488507, 0.4525030436641972,
      0.8977273334279224, 1.2554254086771985, 1.4626482127474052,
      1.4831210350365678, 1.3152767609733433, 0.9924093883417814,
      0.5749254063132296, 0.13659331022273047, -0.25185881652056186,
      -0.5378304093398656, -0.6970194056893214, -0.7363322504596546,
      -0.6890174727287132, -0.6034515163955239, -0.5285778974398282,
      -0.49980893298249274, -0.5290429314758162, -0.6013707091380743,
      -0.6793169748903715, -0.7135207372185698, -0.6570940916729449,
      -0.479930819464239, -0.17921061382200593, 0.21672957509867452,
      0.6523385431198857, 1.0558326184504891, 1.354663579071725,
      1.4917687441125387, 1.4386638477090168, 1.2021813314380092,
      0.8231936837182169, 0.367612287851357, -0.08816767851059976,
      -0.47386343509150286, -0.7399572551343163, -0.8669351964507661,
      -0.8670111813486304, -0.7781169771108706, -0.6518606013958756,
      -0.5386381944221945, -0.47375820367814964, -0.4681357562412651,
      -0.5059178772547779, -0.5496099982358438, -0.5513428069031883,
      -0.46733297209072716, -0.27175175883759217, 0.03366514287985589,
      0.4168830412931306, 0.8206060858700135, 1.174026558737401,
      1.408518648072512, 1.4734846603564573, 1.3484765878749683,
      1.0485953763252351, 0.6217975556588932, 0.13871048753217746,
      -0.32261653189174866, -0.6933714537187685, -0.9280721086995172,
      -1.012774957231138, -0.9655583756604529, -0.8293613080046454,
      -0.6591467472266845, -0.5067432987709719, -0.40725311419054916,
      -0.3704699386171325, -0.3794416868528896, -0.39646929311206114,
      -0.3749224507834404, -0.27375498219652994, -0.07089569433994503,
      0.22804628617716116, 0.5881541816476848, 0.9512650098695087,
      1.2483823400935004, 1.4154773614208782, 1.4088217355527097,
      1.216060877195386, 0.8602473581331742, 0.3957616917006344,
      -0.1029719304092712, -0.5573066180125752, -0.9009588101832073,
      -1.0934157763219905, -1.127022256808296, -1.026177361981597,
      -0.8390252489381735, -0.6238672505384909, -0.43379976281167326,
      -0.30347474961037857, -0.24129339771794733, -0.2289287060631605,
      -0.22818741952821214, -0.19334106007030435, -0.08565353289542987,
      0.11373787004751396, 0.3960260449554304, 0.724180104151259,
      1.0399576475502061, 1.2768795120424232, 1.3760269478161835,
      1.300763641992945, 1.0466992798730703, 0.6443474501666067,
      0.15370797257781404, -0.3480192625246589, -0.7826969860705904,
      -1.0876245249177614, -1.228138233581907, -1.2034920415880546,
      -1.0447338165218765, -0.8052641616023946, -0.5465529129444565,
      -0.3226501486942784, -0.16737561574617488, -0.08734493794437309,
      -0.062478100264633935, -0.05371767147924625, -0.01584416288939644,
      0.0880232175378996, 0.27408362036098527, 0.5309677708340506,
      0.8202212264745798, 1.0841952698280501, 1.259486692448124,
      1.292628834503684, 1.1541183181472356, 0.8472232759751309,
      0.40927278278435897, -0.09503670191535789, -0.586820290566473,
      -0.9895725730091816, -1.2451906465946787, -1.3256514291679502,
      -1.237612693390356, -1.0189481128879085, -0.7282043251185265,
      -0.4296903242142502, -0.17794860478743618, -0.005456922167250022,
      0.08345186414139014, 0.11106748359199088, 0.1177334822673392,
      0.14857744890406033, 0.2390746154941485, 0.4032691534916458,
      0.6277960273005564, 0.87336506636721, 1.083460696985335,
      1.1981558869791076, 1.16960486602072, 0.9753036148889567,
      0.6257127226099014, 0.16420100027592266,
    ]);
    const expected = [
      [
        2.766225107889614, 1.147743101301104, -2.029105521809069,
        -1.4246795246418893, -0.46099186067683373, -0.049758350310249,
        2.66412691161207, 0.7417825068821335, 1.6473446131906888,
        2.1965311419494307, 0.4844871944315584, 0.07040098654255103,
        -1.3592468977927497, -2.603219818666248, 1.0918027521971438,
        1.801157989043889, 2.6465291257878385, 2.203386713487515,
        -1.2782113757884976, -1.9704071581415945, -0.43502629331508585,
        -0.7430211954556386, 2.288617367305706, 1.3379684231415123,
        1.034059395173477, 2.4563034589615262, 0.9254050556381578,
        0.2453522247626528, -0.7007194675313486, -2.6425848561735013,
        -0.48084390450229797, 2.5337626303911676, 1.2213241248768327,
        -0.07722225292638074, -0.5351565194206687, -2.3512912040483283,
        -0.9661109581818672, 2.4867748236823712, 1.6309107234729894,
        -0.3267818759463094, -0.5480341722032394, -1.970433794128777,
        -1.3428979201251545, 2.2571248681588716, 2.084957685979786,
        -0.44084210215590663, -0.7255689096817354, -1.5748145264119953,
        -1.559524941538811, 1.874891752642814, 2.5058012822813387,
        -0.3817744816907225, -1.023372278492827, -1.2411240772255332,
        -1.5932869984982712, 1.397344610244225, 2.8210198237110298,
        -0.14369937315321363, -1.3745636925290858, -1.0339629038340146,
        -1.4545503848676904, 0.898540585484485, 2.9766145147672614,
        0.24640448067845788, -1.7019812551615554, -0.9940662120030321,
        -1.184826234887337, 0.45586631022853147, 2.9468367061405947,
        0.733575701716954, -1.9322664878957407, -1.1308775550844077,
        -0.849172130801075, 0.13597444860302343, 2.738872539979569,
        1.2448211311399622, -2.0090862325907084, -1.4216233760690604,
        -0.5216751782387417, -0.023871891322785922, 2.4044506485265065,
        1.6812843999505607, -1.87324893405418, -1.8573422269579993,
        -0.20548702073037947, -0.16199844687405615, 2.4115788489301884,
        0.7331889605739681, 2.145885620881189, 1.327581528103863,
        1.3846245771037895,
      ],
      [
        -0.021950541974320496, 0.12372083285987037, -0.11442574187222065,
        -0.05083439456772285, 0.08778270015719505, -0.04348114367004393,
        0.001392377209829266, 0.08151055941683216, 0.07992863054633259,
        0.2900501652308071, -0.23055152279061497, 0.04407042805808437,
        0.008942403258975388, 0.023036984802404032, -0.06872956375245486,
        0.0849097855224711, -0.06349650413902845, 0.024289052441908782,
        0.004594256234332562, -0.008430306320533588, -0.004766927034819051,
        0.01438317516155295, -0.007901247119258457, -0.007571280427619606,
        0.014545832945119738, -0.005138888833868496, -0.010058422469758115,
        0.013924666020809858, -0.0021014526373257254, -0.012088430172507809,
        0.012658460727930552, 0.0010310214234980173, -0.013559834141826006,
        0.010812724713714384, 0.004117877606053331, -0.014408283856057528,
        0.008465326965095875, 0.007013095775884896, -0.014591419069494845,
        0.0057315467081527375, 0.009587277816873857, -0.01410392591602258,
        0.0027301798792708693, 0.011717732634628868, -0.012965294629917298,
        -0.00039339702601539175, 0.013310573265615947, -0.011230784149837855,
        -0.0035023962074139676, 0.014288036272714267, -0.008977645748079934,
        -0.006446527334569609, 0.01460961962376104, -0.006312157280800296,
        -0.009097216274455089, 0.014255852655811516, -0.003354778929114774,
        -0.011325345333821745, 0.013247818254452617, -0.00024390281381494121,
        -0.01303525402002178, 0.011627037718773872, 0.0028791651877334693,
        -0.014141238461377183, 0.009473209986815077, 0.005868802654282388,
        -0.014596790520964603, 0.006902654828970667, 0.008491790426836654,
        -0.017008925410160282, -0.013278204823591166, -0.04968823231907008,
        -0.10796855627041177, 0.22286729450688303, 0.1329225448842443,
        -0.277537922195177, -0.05727744181943084, 0.11830932818813743,
        0.04047100434946644, 0.028017702606454115, -0.07481239453582224,
        0.09370815462935292, -0.0761295064221415, 0.03713364833200986,
        -0.0019164425000001261, -0.010863051976788081, 0.001594812617154546,
        0.012120775343792835, -0.012527614656731382, -0.0012262569472998603,
        0.01362880955047175,
      ],
      [
        0.005553579078435919, 0.044109812445086126, -0.05321334352093067,
        -0.010468900272702655, 0.027711910836063464, -0.020426373935380503,
        0.006613594054090885, 0.0036611905521735564, -0.007090570231097297,
        0.005612806746010237, -0.002833673026084778, 0.000935170652652138,
        -0.00017279434243147262, 1.388739457586763e-6, 7.811499855028634e-6,
        -1.6954073616524972e-6, -1.1164951071805051e-7, -1.2812328070080377e-7,
        5.290436401126153e-8, 1.9108028946608362e-7, 1.4991387384624128e-7,
        -3.195717297096048e-8, -1.8383315541188452e-7, -1.6316729057085157e-7,
        1.0643139345331494e-8, 1.7446286125163058e-7, 1.7453400691763806e-7,
        1.0789982129005035e-8, -1.630820703679417e-7, -1.8388885519332838e-7,
        -3.2100823398941564e-8, 1.498176166520815e-7, 1.9112197026107544e-7,
        5.3044693962051896e-8, -1.3481837268757548e-7, -1.9614374099372645e-7,
        -7.337349415480501e-8, 1.1826228462994678e-7, 1.988981382140897e-7,
        9.285114254058392e-8, -1.0034477621540298e-7, -1.9935937147973927e-7,
        -1.1125891643684368e-7, 8.126798245628882e-8, 1.975199993875224e-7,
        1.2838536915964034e-7, -6.12481294963137e-8, -1.9339529827433834e-7,
        -1.44026418823463e-7, 4.052134518937591e-8, 1.870351597551194e-7,
        1.5800042997915556e-7, -1.9331001762867254e-8, -1.7851896020427991e-7,
        -1.7015229836145987e-7, -2.0831779255488194e-9, 1.6794265418760787e-7,
        1.8034252289410413e-7, 2.3477717625287308e-8, -1.5542253817664797e-7,
        -1.8844709426084342e-7, -4.460043257290346e-8, 1.4110575586856636e-7,
        1.9437172338319799e-7, 6.520362311163456e-8, -1.2516345374827607e-7,
        -1.9805430290152837e-7, -8.505451948094563e-8, 1.0777707707420576e-7,
        1.9945284698630716e-7, 1.0392746021055375e-7, -8.914170085321329e-8,
        -1.9854485410899438e-7, -1.2159920571740925e-7, 6.947537281440974e-8,
        1.9534043110399251e-7, 1.3786216777816395e-7, -4.9010892898205404e-8,
        -1.8988294606925746e-7, -1.5253387314649059e-7, 2.7981662282729917e-8,
        1.8223565418657558e-7, 1.654482258319388e-7, -6.624965279511421e-9,
        -1.7248051292587668e-7, -1.7645062873759676e-7, -1.4809442815912857e-8,
        1.6073011999867135e-7, 1.8541079783474014e-7, 3.606849254327114e-8,
        -1.47126553743549e-7, -1.922307503905506e-7, -5.690987188164892e-8,
        1.3182684480764753e-7, 1.9683481108221525e-7, 7.709831260032561e-8,
        -1.1500133322582625e-7, -1.991642246317513e-7, -9.639729545458907e-8,
        9.684459086932459e-8, 1.991891198492604e-7, 1.145785537385214e-7,
        -7.757266506957553e-8, -1.969148755330164e-7, -1.314356091800364e-7,
        5.740775142518269e-8, 1.9237057578526663e-7, 1.4677903580091456e-7,
        -3.657640974338186e-8, -1.856029773864102e-7, -1.6042800427632732e-7,
        1.5319763782288295e-8, 1.7668756466667193e-7, 1.7221968771204675e-7,
        6.110351189744042e-9, -1.6573309777908074e-7, -1.820216425447464e-7,
        -2.7467119426566608e-8, 1.528686386738302e-7, 1.897257648074327e-7,
        4.851018844456269e-8, -1.382369053203211e-7, -1.9523919713975987e-7,
        -6.89956752230433e-8, 1.220044932865546e-7, 1.984932658965028e-7,
        8.868070269471156e-8, -0.0005600368927974471, -0.022924048052023163,
        -0.026243307181605308, 0.09922546852112757, -0.08953663485659899,
        0.0715862874150832, -0.054447195141142234, 0.03683577095560728,
        -0.020377958126696044, 0.008342006019086193, -0.0020064720245303027,
        -9.995555395476581e-5, 0.0003124815221362821, -0.00013165499894098604,
        2.7476989263595465e-5, -2.086442313061863e-6, -4.2632096830483433e-7,
        -1.131486410137643e-7, 2.544025138900691e-8,
      ],
    ];
    const result = wavedec(data, "db19");

    const reconstruction = waverec(result, "db19", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db20", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49145285911775255, 0.907911570496982, 1.1898418665019996,
      1.3050271363519972, 1.254093032033652, 1.0684971300140187,
      0.8015959903518055, 0.5150582540493674, 0.2639874533752931,
      0.08438646221385282, -0.014025690780804179, -0.047989250848236784,
      -0.05397039959654856, -0.07633912530415676, -0.15354216423778988,
      -0.3058507528973526, -0.527868940776352, -0.7878014599220494,
      -1.0337928538267087, -1.205877348121774, -1.2506587822655373,
      -1.135122869939947, -0.8561489886985718, -0.4432982538998764,
      0.045935827045050656, 0.5374104111568112, 0.9555647115340653,
      1.2390549123513037, 1.3531452667201613, 1.2959877845812173,
      1.097394767451214, 0.8105132428141264, 0.4985079026239511,
      0.21953600825456981, 0.013668370739037261, -0.10511282757062695,
      -0.14999465203747664, -0.1553785449319694, -0.1655250401785292,
      -0.22077000120921086, -0.3448804476578082, -0.536827228108163,
      -0.7691460839881487, -0.9934105949218012, -1.1515562675226017,
      -1.190314686743355, -1.0752060807891621, -0.800599680227228,
      -0.39327195500598106, 0.09154975385294649, 0.5808560099808033,
      0.9988054702220418, 1.2824808318937297, 1.3947701631087868,
      1.331379110981825, 1.1203890030540793, 0.8145653419741945,
      0.47835435403013093, 0.17276000744801034, -0.058234306603397124,
      -0.1964590267720888, -0.2515387578383968, -0.2557333363550556,
      -0.25308454179725853, -0.2857187977718289, -0.3808506183789152,
      -0.5418448797235339, -0.7456749605599811, -0.9475103990907165,
      -1.091377338777154, -1.124299367697098, -1.0104249105107548,
      -0.7416042185911224, -0.34170777826400833, 0.13652189351317115,
      0.6214871657369898, 1.0373524906428573, 1.3198670230320264,
      1.4296915592760886, 1.3601184053544175, 1.1374152935590711,
      0.8137926973924073, 0.45475690116213086, 0.12393964909986083,
      -0.13093349124855685, -0.28759678899770025, -0.3521158547801239,
      -0.3545394198840023, -0.3385815184056904, -0.3480535595566427,
      -0.4135561734252813, -0.5428587765682575, -0.7174617965304118,
      -0.896283024475941, -1.0256189263792757, -1.0529457855829065,
      -0.9411361661670148, -0.6795190347740375, -0.2889459520610723,
      0.18053637381422938, 0.6590156855216662, 1.070947705280404,
      1.3509909009549474, 1.4577330337822878, 1.3820916185248922,
      1.1484414649586892, 0.8082635696716195, 0.4278966184295744,
      0.07337011235223773, -0.20403295211049827, -0.3780568433698558,
      -0.4512241831493261, -0.4513104873294511, -0.4215935190581933,
      -0.4074572521660683, -0.44281400790614284, -0.5398313852237876,
      -0.6846086856016471, -0.8399490930124928, -0.9545888470630248,
      -0.9766136021648466, -0.8677180745016289, -0.6147143379365358,
      -0.23533104495800483, 0.2232833147766561, 0.6931694850067068,
      1.099357917373859, 1.3756611865773976, 1.4787529336527194,
      1.3972197414361602, 1.1534676843624172, 0.7980734780950327,
      0.3979751878671093, 0.021359834688911172, -0.27713048580000665,
      -0.46737063671252316, -0.5483685407869803, -0.5455717754450937,
      -0.5017139307813341, -0.4636324687701039, -0.4684640276051884,
      -0.5327510727548964, -0.6472457214154985, -0.7787580747410555,
      -0.8786228472729398, -0.8956873004585383, -0.7905681988139548,
      -0.5475719706660162, -0.18120987682520445, 0.26446077059928297,
      0.7236943141435251, 1.122376253590471, 1.39371903228721,
      1.4926451159673666, 1.4054591019706562, 1.1525262551267383,
      0.7833444537597093, 0.3652136022946078, -0.031771296279565875,
      -0.3498201425333688, -0.5550728288656539, -0.6430628557022308,
      -0.6368625000185738, -0.5785540608262, -0.5163029773429166,
      -0.49037003201600965, -0.5216322659307148, -0.6055304474423997,
      -0.7129871099492411, -0.7980829296696397, -0.8105741759284163,
      -0.7101012601628736, -0.47848321100668717, -0.1269294257074503,
      0.30377662447706333, 0.7503553866274726, 1.1398234784096621,
      1.4050389785227035, 1.499339503399364, 1.4068014740049004,
      1.1456812370718215, 0.7642241430812076, 0.3298507533321601,
      -0.08569382620962412, -0.4216944853698765, -0.6407037805898823,
      -0.7348327137755863, -0.72473821202898, -0.6517451130055822,
      -0.5652151392758772, -0.5084204515889081, -0.5065154536188085,
      -0.5596471461181445, -0.6429396750068954, -0.7133555373495519,
      -0.7217022096982286, -0.6267468749293915, -0.4078465337591409,
      -0.07283474262131001, 0.3409504250215134, 0.7729389033316718,
      1.1515491623538596, 1.4095297356101155, 1.4988024507234554,
      1.4012739985324985, 1.1330278945639338, 0.7408847673850232,
      0.2921419127418634, -0.14007068176059329, -0.4923468701888423,
      -0.7238120205357014, -0.8232178280543283, -0.8087730634316539,
      -0.7209400477226358, -0.6101391918554164, -0.5225289351496742,
      -0.4874670320648784, -0.5098059706397091, -0.5689440986394975,
      -0.6248496052378769, -0.6295178351622015, -0.5409472211937041,
      -0.3360653437265096, -0.019266886415609863, 0.3757151533519545,
      0.7912534605029204, 1.1574326969903093, 1.4071347862272068,
      1.491036920329937, 1.3889389177083813, 1.1146919761868936,
      0.7135219451075219, 0.25235711618543366, -0.1945591714408137,
      -0.5613737336600698, -0.803956677832141, -0.9077744364469402,
      -0.8885619706332385, -0.7858153159639782, -0.6508703878872315,
      -0.5326347843280426, -0.46457899368620625, -0.4562419237363078,
      -0.49135193622761497, -0.5329944888432099, -0.5344836099499772,
      -0.45315464674070627, -0.2635456937014473, 0.03343910931729033,
      0.4078189103272798, 0.8051313341488732, 1.1573841504587226,
      1.3978328048229118, 1.47608246580496, 1.369893123676941,
    ]);
    const expected = [
      [
        2.072696251504925, 2.249190451908392, -1.215816317952758,
        -2.165118259812237, -0.3870124270404183, -0.6946454687406076,
        1.924648046740499, 1.7766021326601364, 0.7253763787010927,
        2.446922432308022, 1.222231435389454, 0.2495274792048459,
        -0.3296044070929083, -2.440245863706539, -1.3925359299619335,
        2.290861559348507, 1.280908017344067, 1.7854858864100545,
        2.6989547419578637, -0.43067395566924693, -2.331182178020464,
        -0.6212747716839799, -0.8282847825696359, 1.287337665542244,
        2.1842146450497584, 0.5731191654828458, 2.253658890303832,
        1.6394954201141398, 0.3478826446318343, 0.039328549348674684,
        -2.0869172861957117, -2.0561631004801333, 1.557446234223228,
        2.153509018351775, 0.36019230031590527, 0.05463161089330221,
        -1.4835812416573275, -2.45804093107546, 0.7843577387808395,
        2.552449472656886, 0.6237975852676809, -0.10149787950190693,
        -0.9537459232764586, -2.509982841131696, -0.11888985259345397,
        2.6860224661619547, 1.1252808390502091, -0.28643992209068153,
        -0.6243959456800264, -2.2561273799933916, -0.9750567273631835,
        2.472021942019175, 1.765369509923888, -0.3469219184734334,
        -0.5459787313277548, -1.8186900729091697, -1.6215329859837924,
        1.9186124261036894, 2.3873335399358635, -0.16861772313163068,
        -0.6786979303253216, -1.3594519420308246, -1.956523306574173,
        1.1236778541019061, 2.823305326644552, 0.286100931399585,
        -0.9066245418069568, -1.0297693521623328, -1.9668813017861326,
        0.24739137496230318, 2.944511604760885, 0.963806313795865,
        -1.0752814149275924, -0.9242925562641623, -1.729251493896732,
        -0.5337508402637656, 2.700220328229676, 1.7334498060441814,
        -1.041123002379487, -1.0524578130814735, -1.3850341834312025,
        -1.0740966162434233, 2.1236037096225298, 2.446125604727647,
        -0.7608755269664765, -1.263865687600363, -1.2060400216243046,
        -1.149787227610293, 1.1800709415328094, 2.7395217084423606,
        2.61246558401063, 3.258543378292932, 1.908696853359219,
      ],
      [
        0.05842785675080753, 0.05187964796630088, -0.053197344628632244,
        -0.07235764201401768, 0.11076156725325938, -0.09376061299627984,
        0.0420239792776259, -0.01579043738566587, -0.04315226766185844,
        -0.16311485347966678, -0.2210249584584981, 0.3506752707617863,
        -0.3100354112683403, 0.26712986169449887, -0.2271526847888859,
        0.17121738773443565, -0.10129729331849659, 0.03789415520968552,
        -0.0013134296245184804, -0.004806276236309357, -0.004650316694848207,
        0.009827857353992829, -0.0027668162449825296, -0.008060031227613552,
        0.00966314415711881, -3.400676047752192e-5, -0.009634303862052652,
        0.008078401777307554, 0.002890300965310551, -0.010491382435903382,
        0.005868269650008018, 0.005591565751683592, -0.010536656387256886,
        0.0032056568703217195, 0.00786087530007738, -0.009768354943571571,
        0.0002941263818250486, 0.009522236722413665, -0.008244237191428635,
        -0.002638978660820813, 0.01044802487507588, -0.0060835770763467654,
        -0.005369277478088874, 0.010565696910954842, -0.0034520845497326134,
        -0.0076833841855583635, 0.00986732917885174, -0.0005542763283835332,
        -0.009404776483370158, 0.008405552069317592, 0.0023867892856488495,
        -0.01039807609586347, 0.006294869772369372, 0.0051430544841589475,
        -0.010588789791164852, 0.0036967551342602213, 0.007502000896527618,
        -0.00995995181620055, 0.0008138412655020875, 0.009280976085439863,
        -0.00856231578532328, -0.002132977734376324, 0.010342583427157274,
        -0.006501857685807924, -0.004913877921397574, 0.010604868960382482,
        -0.003939934691390079, -0.007322603946821998, 0.00994654544925619,
        -0.0018012992593957142, -0.011913088445520845, 0.00246961416427551,
        -0.015451091497430224, -0.10744764970551646, -0.15660289568756705,
        0.11670115682741225, 0.0185769193622193, 0.21808290901621263,
        -0.11208303303340941, 0.06377143072670684, -0.034602492317772744,
        0.03606930049138753, -0.038895476200845824, 0.0306845567169701,
        -0.011610147521420795, -0.005509321520442695, 0.008642861245994542,
        0.0009436274244536776, -0.009960249222737444, 0.0073500411336654995,
        0.0038749173305273315, -0.010600674705515525, 0.004977957587974538,
      ],
      [
        0.004093053924703928, 0.03952238337431064, -0.03310954490652867,
        -0.03868808963868813, 0.05533754455918189, -0.046216959831012525,
        0.02866969368978775, -0.011985797609137112, 0.0012218093561791995,
        0.0028879998582667524, -0.002797040622434079, 0.0014640297537183771,
        -0.0004859665134756114, 9.25989415905237e-5, -3.3011772929137623e-6,
        -3.010049725603422e-6, 5.98572122315576e-7, -1.0435543691482946e-8,
        7.356920732233023e-8, 5.769943315398972e-8, -1.3700901930480208e-8,
        -7.248834957820355e-8, -6.45438013354438e-8, 2.8189818958091638e-9,
        6.75863897011559e-8, 7.013414992400214e-8, 8.116915156007281e-9,
        -6.137266082315992e-8, -7.43629562892277e-8, -1.8895133089988348e-8,
        5.396763236065091e-8, 7.714847393877799e-8, 2.930721725600256e-8,
        -4.5514011435183e-8, -7.843555101309922e-8, -3.915020946421307e-8,
        3.617623140375851e-8, 7.819892152463946e-8, 4.8232219985077624e-8,
        -2.6136676466089478e-8, -7.644426927318365e-8, -5.6377730872956824e-8,
        1.5589902374141604e-8, 7.320584317411192e-8, 6.342926902818142e-8,
        -4.739696879747556e-9, -6.854541448671159e-8, -6.924900355795328e-8,
        -6.202794189869243e-9, 6.255341252812756e-8, 7.37233159834819e-8,
        1.702409784427318e-8, -5.53472960853819e-8, -7.676627902995554e-8,
        -2.7514653985577157e-8, 4.7066972410640916e-8, 7.831933607580962e-8,
        3.7471681555355716e-8, -3.78721105262232e-8, -7.835132280699686e-8,
        -4.6701204674904855e-8, 2.7941387614473232e-8, 7.686118024056914e-8,
        5.502312053684021e-8, -1.7468732626969638e-8, -7.387888613582687e-8,
        -6.227656121848088e-8, 6.657286504987954e-9, 6.946270953173586e-8,
        6.832149130526296e-8, 4.284103635007597e-9, -6.369729937152471e-8,
        -7.303972646776797e-8, -1.5142656896534732e-8, 5.669438100954547e-8,
        7.633891509535085e-8, 2.5706467105079594e-8, -4.8591038265784685e-8,
        -7.815586197256866e-8, -3.577083312301433e-8, 3.954475414262447e-8,
        7.84559478491093e-8, 4.5141320126066696e-8, -2.973009010547932e-8,
        -7.72324117023546e-8, -5.363548171142671e-8, 1.933756614999775e-8,
        7.450843939055558e-8, 6.108741415391253e-8, -8.570113120891655e-9,
        -7.033789948528819e-8, -6.735299041394403e-8, -2.36324848885233e-9,
        6.48022703566633e-8, 7.231147312794093e-8, 1.3251331006750601e-8,
        -5.800801994190057e-8, -7.586591228409888e-8, -2.388254825766941e-8,
        5.008667499076672e-8, 7.794642596050772e-8, 3.404937276583854e-8,
        -4.119311090367252e-8, -7.851335631860712e-8, -4.3554633141780994e-8,
        3.150032821746727e-8, 7.755649286235274e-8, 5.221483421308245e-8,
        -2.1195457843871866e-8, -7.509359528398817e-8, -5.986146513458242e-8,
        1.0478384575156666e-8, 7.117177773519958e-8, 6.634500391601719e-8,
        4.416806199385094e-10, -6.586806043164809e-8, -7.153999064094636e-8,
        -1.1352584066008772e-8, 5.928608132991279e-8, 7.534654768008382e-8,
        2.20435657897355e-8, -5.155270604507386e-8, -7.769024016614529e-8,
        -3.230705486895159e-8, 4.2817548822957314e-8, 7.852460174239901e-8,
        4.194262849326186e-8, -3.3251209348944244e-8, 0.002324809653168157,
        0.02246256624211641, -0.01881149025141814, -0.02200419836599105,
        0.031473644924351285, -0.026286180976831833, 0.016302280234653594,
        -0.006809251117576375, 0.0006864906594809323, 0.0016481282085288732,
        -0.001592911423886602, 0.0008329939925620321, -0.0002762215337779743,
        5.2476122082694326e-5, -1.9091393932813354e-6, -1.7045777066940459e-6,
        4.0779832506646726e-7, 5.876184442420036e-8, 4.3701162028108366e-8,
      ],
    ];
    const result = wavedec(data, "db20");

    const reconstruction = waverec(result, "db20", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db20_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5040447354663024, 0.9290526641693917, 1.212511856530528,
      1.3210448206042376, 1.2561535689552454, 1.051842054799334,
      0.7648517366622631, 0.46004565728207425, 0.19463406073033268,
      0.005163962846551795, -0.09955704554910971, -0.13797337765039108,
      -0.14804050557184753, -0.17438919536122566, -0.2538456213822788,
      -0.4031683704689173, -0.6122891945291193, -0.8449310381277464,
      -1.046581167256262, -1.1578978342687063, -1.1302060794115012,
      -0.9391530759166236, -0.5929969265019714, -0.13329784824487836,
      0.3723540533984959, 0.8439697951417877, 1.2059634835528243,
      1.4031377520385095, 1.4120499483398792, 1.2450805999800942,
      0.9463097942539933, 0.5803067788553893, 0.2166555555993387,
      -0.08595212623148907, -0.29217393601524777, -0.39605721021715,
      -0.41934386890323666, -0.40268726732268445, -0.39221609866469637,
      -0.42504131704350534, -0.517545148696981, -0.659557158390633,
      -0.8159977081553272, -0.9356397727999801, -0.9647938558333153,
      -0.8624250233028161, -0.6127951060269882, -0.23229520826482775,
      0.2314463113537234, 0.7081808658497265, 1.1194520591120936,
      1.3954116783523538, 1.4900205013167356, 1.3909824278049956,
      1.122032430341926, 0.7370598684370765, 0.3075359509655785,
      -0.09366669767902008, -0.40812526560887397, -0.6035816669607351,
      -0.6787872544875575, -0.6604881973465968, -0.5935395149398071,
      -0.5268489031224519, -0.4988716471136653, -0.5264509864609047,
      -0.5999087053670127, -0.6856651294709984, -0.735717916978886,
      -0.7015283938273802, -0.5487035579446237, -0.26861623876408863,
      0.11615992974103784, 0.5541918873407973, 0.9749488565143698,
      1.3037543732459322, 1.4783688062202456, 1.4631923942853358,
      1.257624164265992, 0.8965196871024588, 0.44261146265721035,
      -0.027287786818403215, -0.43897311515557447, -0.7364201892717706,
      -0.8925483562949494, -0.9127032140966573, -0.8302156584105582,
      -0.6953673236127493, -0.5607166320731196, -0.46660993359263275,
      -0.4306031180688667, -0.44347914816059525, -0.4728311606087895,
      -0.4732237952712194, -0.4002422604338233, -0.22472025741264023,
      0.056637266613715376, 0.41713152942556614, 0.8037111958412585,
      1.1476769660953048, 1.3799455449348188, 1.4471811852188579,
      1.3248316539994411, 1.0238224661088782, 0.5891928578322331,
      0.09091978716155624, -0.39091604207081704, -0.7830904591846906,
      -1.0342857851633804, -1.1246863079065146, -1.0679405268712008,
      -0.9052074739454552, -0.6929567914750128, -0.487713512025352,
      -0.33165020586442634, -0.2426566160618811, -0.21133263325935156,
      -0.20555580027760692, -0.1813237062741923, -0.09695753119687606,
      0.07311668146148631, 0.3286977043504435, 0.6409022606434323,
      0.9569567689383297, 1.211656579635281, 1.3427420625625346,
      1.3064027511784733, 1.089028254705657, 0.7122052227724585,
      0.22959663946889608, -0.2836735172232064, -0.7466656147414068,
      -1.0895979152091482, -1.2681224642766544, -1.2715471007858816,
      -1.12314326306998, -0.8726277432786085, -0.5828213868222456,
      -0.3138919771204971, -0.10913386566506467, 0.014209262536098666,
      0.06689361028662794, 0.08207302131167528, 0.10375284445075555,
      0.17242117560412246, 0.31169379847435613, 0.5195457080061685,
      0.7665268921715589, 1.0015695865181418, 1.1640403165767528,
      1.199066293409747, 1.0722834309862497, 0.7802379775819112,
      0.3537084482482198, -0.14705646897623828, -0.6441955287623468,
      -1.058440343920497, -1.3258351320190853, -1.4109970674188679,
      -1.313784710958878, -1.0678554806889284, -0.7315769602746236,
      -0.3736169116087516, -0.056810604623098726, 0.17572376284707303,
      0.3088693880547253, 0.35629314878144647, 0.3537392364219598,
      0.3467447303321993, 0.376089743568395, 0.46484974096640214,
      0.6104872486448393, 0.7841143838602704, 0.9372068938806896,
      1.0141225768577522, 0.9672597397547718, 0.7709695831520036,
      0.43059528946009584, -0.01581107246851307, -0.5037374386901886,
      -0.9550884956544379, -1.2946904153729346, -1.4664982702006477,
      -1.4456250661615448, -1.2433162902055526, -0.9037104459807455,
      -0.49322734564136517, -0.08521403114500542, 0.25639116411732377,
      0.4904222452436808, 0.6057109444812145, 0.6205773660974748,
      0.574944254248976, 0.5172821635710585, 0.48987207101596153,
      0.5162618832394228, 0.5941982958502197, 0.6958879144083443,
      0.7755433161827658, 0.7822811434936993, 0.6750383849835044,
      0.4356152098689845, 0.07638158260666139, -0.35950431652824766,
      -0.805651983021134, -1.1861011696813657, -1.431872254188892,
      -1.4964271558949143, -1.3662907721173527, -1.0642418655477113,
      -0.6442861574564464, -0.17962476596622637, 0.25346946877484017,
      0.5919790846950387, 0.798772304172737, 0.868589552983482,
      0.8261162610601079, 0.7168514953990088, 0.5932677181602426,
      0.49990250676049924, 0.4612435433304226, 0.4755115778995853,
      0.5159060806098559, 0.5389454409997633, 0.49769694061595615,
      0.356416004425433, 0.10272286174987777, -0.2459614684904412,
      -0.6435662924546831, -1.024044889553702, -1.315595719273663,
      -1.4570272389899135, -1.4122759075159577, -1.179493479843844,
      -0.7924212114890261, -0.31364283538592436, 0.17871078335541787,
      0.6076376008572855, 0.9133413922511244, 1.0649024716171018,
      1.0648464063819851, 0.9456866656279758, 0.7595051472864214,
      0.5633419473177366, 0.4041669780950184, 0.30725343463034255,
      0.2708587627177172, 0.26847631321015597, 0.2579664792456191,
      0.19510391547789638, 0.04793522228265007, -0.19188183342575715,
      -0.5038334848119829, -0.8409347230497136,
    ]);
    const expected = [
      [
        1.6494076982552481, 2.6517478181515086, -0.6577370547927069,
        -2.0996360181982143, -0.5450257568609198, -0.8995883324977083,
        1.8490661364474845, 1.7825830701380403, 0.7521054805925642,
        2.486418217223128, 1.1355896198009325, 0.09536273670102403,
        -0.5704381083709292, -2.4388228265282006, -0.7982307632717451,
        2.7303989525551753, 0.9199165633198341, 1.243848399921998,
        2.926142379179596, 0.1771569532447172, -2.1539948442180483,
        -0.7451626869489383, -1.0365487272817695, 1.1734010298702866,
        2.1825633957853254, 0.5886425917591027, 2.306869323426773,
        1.5818717591693001, 0.21163393411790904, -0.19250847954267433,
        -2.2074006559910413, -1.563027764184009, 2.125089851966874,
        1.966175464107249, -0.17419862075304918, -0.4786147646428471,
        -1.7738801222202054, -1.6203099334111337, 1.9814072990224438,
        2.347324580785261, -0.4106748771162241, -0.8949025120526775,
        -1.3641800139858349, -1.5090527312546318, 1.7194674626478368,
        2.6519179926184613, -0.4790621097505396, -1.3873316953434995,
        -1.0435356633336883, -1.22631872197674, 1.4007564451068446,
        2.8221819128574035, -0.38985445457128, -1.8877372948794067,
        -0.860402183953029, -0.7981005609429459, 1.0953412897966965,
        2.821804211538096, -0.180876073966768, -2.325417329476922,
        -0.83819308920059, -0.2749798640276081, 0.8698053946800951,
        2.6421827055104044, 0.08929935373780316, -2.639160630505383,
        -0.9713114384783796, 0.2764203135580334, 0.7757858460094523,
        2.303938625277484, 0.3514811772745686, -2.787656406343419,
        -1.2261525217775728, 0.7847271367852252, 0.8410752069579948,
        1.8534326539672137, 0.5378200476594681, -2.7564836556914374,
        -1.5471892302171264, 1.1873364501803185, 1.0599913483463939,
        1.367675391071693, 0.5652248239363182, -2.5056800672136363,
        -1.9634838307773876, 1.6031473350775978, 1.1284025270399618,
        1.3855937315042475, -0.4161940929892126, -0.8934022890504687,
        -0.02248326957976369, -1.3148987266142529, -0.16678314945061753,
      ],
      [
        0.061065778079437076, 0.05339603230511292, -0.057409552307434296,
        -0.06823099608082762, 0.10725635228168899, -0.09165966131975839,
        0.04119247998960724, -0.016846427305079514, -0.04162690060386463,
        -0.17096072796629105, -0.2257388554092085, 0.361736890381941,
        -0.3218995709516476, 0.2785182711208966, -0.23718773421260267,
        0.17888800851818587, -0.10576533279368942, 0.0389473274188881,
        0.0001539840181560248, -0.0067748014542462045, -0.0043208930327479226,
        0.011726466116401747, -0.005166200874351738, -0.007746572385857324,
        0.012132953359244898, -0.002926133277662212, -0.009564695227239503,
        0.011319815048277077, -0.00036663923743714046, -0.010998572793850135,
        0.010015633796014702, 0.0022101745148867848, -0.011954358400295823,
        0.008279732893247389, 0.004690372255962355, -0.012395583004409337,
        0.006184352169578649, 0.006968816918689028, -0.012298237143342126,
        0.0038228135350201376, 0.008944683435892279, -0.01167146594709555,
        0.0012946996790582064, 0.010534949416460077, -0.010537439677339252,
        -0.0012882440038766091, 0.01166825635512273, -0.008950138406384117,
        -0.0038165611552543185, 0.012298313167900768, -0.006973287848930265,
        -0.006178801138000161, 0.012395005450637899, -0.004697295250780052,
        -0.008274744192513497, 0.011957153225984991, -0.002215708374902815,
        -0.010011953287854425, 0.011000557851659607, 0.0003592839838353372,
        -0.011316922967565231, 0.009569857220785651, 0.00292114268307545,
        -0.012131747632073994, 0.007723537016133414, 0.00535426573385491,
        -0.012422917977114303, 0.00554269503440823, 0.007626692532539939,
        -0.011072532273154521, 0.010327467395834143, 0.036867374156013925,
        0.06069964937385499, 0.06379145338717512, -0.19156522420030542,
        0.11150226845835508, -0.019458601270760385, 0.16331131003612356,
        -0.3816567044621079, 0.2941135872917535, -0.25174827270714945,
        0.17525927346710574, -0.09608461803695846, 0.03099086127617329,
        0.004948676223657706, -0.009806066396778048, -0.002509811614490956,
        0.011642533134531275, -0.006563258616335203, -0.006446080754171664,
        0.012373584148125786, -0.004434871514573534, -0.008482451991629496,
      ],
      [
        0.004199564996955094, 0.040584404078526835, -0.03398343627750799,
        -0.039766670018340715, 0.05687980470917419, -0.047505131437960306,
        0.029459203085633687, -0.012300000878327071, 0.001234817854368369,
        0.0029821419928168285, -0.0028801885169798154, 0.0015054271414996938,
        -0.0004989985553290469, 9.48925075929645e-5, -3.342365829427017e-6,
        -3.114025760568654e-6, 6.115084757690788e-7, 5.084037408341216e-9,
        9.411070138735914e-8, 6.169451480175719e-8, -3.12178015162554e-8,
        -9.477088673558659e-8, -6.919507786220314e-8, 2.145620715262818e-8,
        9.192805021774897e-8, 7.594386283817212e-8, -1.146340914172265e-8,
        -8.808942461321258e-8, -8.186936912016134e-8, 1.3470532552226271e-9,
        8.329708646249843e-8, 8.690885012901433e-8, 8.78530918750808e-9,
        -7.760083087795324e-8, -9.100604664105107e-8, -1.8823192001354827e-8,
        7.106187579105357e-8, 9.411499182486775e-8, 2.865562432097564e-8,
        -6.375326441796387e-8, -9.620353577051535e-8, -3.8176564644921554e-8,
        5.57548520529661e-8, 9.72506525229116e-8, 4.7284943881413433e-8,
        -4.7151212978742565e-8, -9.724347283389655e-8, -5.5881529952481736e-8,
        3.803495833397628e-8, 9.618041346023054e-8, 6.387095275739222e-8,
        -2.8507022681983114e-8, -9.407445779151224e-8, -7.116698720792876e-8,
        1.8671460780554645e-8, 9.095014096287489e-8, 7.769272626060156e-8,
        -8.632828174743481e-9, -8.683995080608866e-8, -8.337709123880032e-8,
        -1.5008604809382832e-9, 8.178668769850048e-8, 8.815624689316934e-8,
        1.1617694151977618e-8, -7.584646917524651e-8, -9.197863996969971e-8,
        -2.1607082749119273e-8, 6.908550464160357e-8, 9.48050285167924e-8,
        3.136275019907139e-8, -6.157582270805292e-8, -9.660460552248873e-8,
        -4.077989121206362e-8, 5.339698950469894e-8, 9.735563373297662e-8,
        4.975442226212954e-8, -4.463889750574429e-8, -9.705007000874879e-8,
        -5.818800762613966e-8, 3.539837665693662e-8, 9.569345311894621e-8,
        6.599115833945799e-8, -2.577447582228342e-8, -9.330046479063233e-8,
        -7.308038355790776e-8, 1.5869607249820244e-8, 8.989483167848642e-8,
        7.937690663572696e-8, -5.792228626091682e-9, -8.55134230585084e-8,
        -8.481129724766604e-8, -4.346433536408357e-9, 8.020595539873149e-8,
        8.932650385230536e-8, 1.443746900344477e-8, -7.403010332570771e-8,
        -9.287480858231862e-8, -2.4373473445396974e-8, 6.705061342765318e-8,
        9.541591467153347e-8, 3.404577946708868e-8, -5.934294267627842e-8,
        -9.692097372862096e-8, -4.3347494797142207e-8, 5.0992871499876554e-8,
        9.737544890566561e-8, 5.217863685241072e-8, -4.209120990706162e-8,
        -9.677577781282031e-8, -6.044551949299763e-8, 3.2732261751500626e-8,
        9.512672409800259e-8, 6.805772750580178e-8, -2.301714562809975e-8,
        -9.244474330031057e-8, -7.49306365385401e-8, 1.3053370708872545e-8,
        8.876060105879842e-8, 8.099045374333068e-8, -2.9494053636011557e-9,
        -8.411571930673142e-8, -8.617359817726468e-8, -7.187382250240791e-9,
        7.85588245500312e-8, 9.042321793584863e-8, 1.7247604230311884e-8,
        -7.214862266471752e-8, -0.00023283419865928394, -0.011097916636494485,
        -0.020826005202429276, 0.05894568196858546, -0.04619490904533566,
        0.03489434161742116, -0.028240312090100642, 0.02221182075935302,
        -0.015181116157809222, 0.008319957399970693, -0.003370635504866923,
        0.0008459385392727843, -2.062469940733558e-5, -8.263377525255087e-5,
        3.6046241359783613e-5, -7.436829109776366e-6, 4.783995401198841e-7,
        6.568815309097472e-8, 8.006313541273881e-8, 8.030670465909336e-8,
      ],
    ];
    const result = wavedec(data, "db20");

    const reconstruction = waverec(result, "db20", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db21", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5024415176550152, 0.9257174236207824, 1.2073965193793832,
      1.3145120732636255, 1.2492794980645265, 1.046535664688557,
      0.7636835148595839, 0.4657679663187896, 0.209482184447567,
      0.030114664138452096, -0.0653521498000269, -0.09738586721477188,
      -0.10568610334711989, -0.13588874697047365, -0.22477464369738992,
      -0.3879423347995317, -0.6132664933106181, -0.8619723937440069,
      -1.077190908487437, -1.1979176218897958, -1.1748775055994707,
      -0.9842563657180764, -0.63574245141263, -0.17270827322991394,
      0.33569301772191595, 0.8087287474363554, 1.171221211485177,
      1.3695098261241843, 1.3824155953210024, 1.2246151422761562,
      0.9417070280762724, 0.5983005221971605, 0.2621626728225185,
      -0.011603549646370726, -0.19244176246894992, -0.27942281938428865,
      -0.29842046086225976, -0.29230455618882845, -0.30685289576079366,
      -0.3761632549106493, -0.5114576392230205, -0.6962834967536093,
      -0.8894584161873983, -1.0350972261908722, -1.0772141524155636,
      -0.9751780845613864, -0.7160269157688827, -0.32038994371644597,
      0.1596587909605176, 0.6504834152417296, 1.0722323895193073,
      1.3559936787741909, 1.458631360806728, 1.3717314092813644,
      1.1225301157019907, 0.7666724370612578, 0.37465436440545413,
      0.015340140818841774, -0.2593723783670896, -0.4250052798209209,
      -0.48761386236980153, -0.4789830069765226, -0.4453439347476337,
      -0.4326841570290999, -0.47256747402660015, -0.5722213735994115,
      -0.7115285098737911, -0.847763123801753, -0.9268995032363255,
      -0.8986005032119656, -0.731008057970884, -0.42145748054363663,
      -0.00022662600496420326, 0.47383745861418153, 0.9249334762771857,
      1.2764504320031484, 1.4677686738697038, 1.4676475663114212,
      1.280949418993329, 0.947080896581083, 0.5305682195861164,
      0.10611083862864007, -0.2582032079731452, -0.5154226530271259,
      -0.6485124886682909, -0.671380305197949, -0.6221141992480218,
      -0.5503625697407497, -0.5022488981837901, -0.5068062041512253,
      -0.5674889542746784, -0.6609855714461783, -0.7436530502597862,
      -0.7639108532703165, -0.6773695488688177, -0.4607289265260177,
      -0.12075112177015151, 0.30416906971669755, 0.750457484601537,
      1.142429116756497, 1.4088749528773552, 1.4991500275595067,
      1.3948284145837553, 1.1140586902299607, 0.7075400378605133,
      0.24709718849504228, -0.19035407709164148, -0.5395444037979036,
      -0.7602471243046947, -0.844160462042645, -0.8137612625224021,
      -0.7136415260291553, -0.5967203870935903, -0.508987172877388,
      -0.47675887313536247, -0.49974794921711113, -0.5517111217257873,
      -0.5884758570124089, -0.5612213982583347, -0.4315141970655823,
      -0.1841147443385316, 0.16589123368405212, 0.5736630074513214,
      0.9729539631199742, 1.2903340244912207, 1.4618642297155415,
      1.44813927224613, 1.2439737730666576, 0.8803036519947085,
      0.41778184214274805, -0.06641021379850931, -0.49534941193028914,
      -0.8087007290850028, -0.9746766663290523, -0.9948295290695875,
      -0.9006872235173234, -0.7432855917496479, -0.578412746572877,
      -0.45142036079026665, -0.3855138036772162, -0.37649660220836856,
      -0.39525543186043605, -0.39726047790406543, -0.33653449334708674,
      -0.1803757390731207, 0.07909699265565417, 0.4197182691536202,
      0.7919101878113965, 1.1287140589819575, 1.3608557537484076,
      1.4331653056385418, 1.3182766545713827, 1.0241628881314164,
      0.5935608908780405, 0.09533240158608418, -0.39020358356767965,
      -0.788448179647522, -1.046083131967622, -1.141308062118154,
      -1.0863891984886456, -0.9220779447626142, -0.7054789838642888,
      -0.49455829103259513, -0.33327755942338566, -0.2411256065064305,
      -0.2096478229426273, -0.20675110648766887, -0.1875484914082996,
      -0.10881677530974115, 0.056798322614339924, 0.31064263036994705,
      0.6247618244877022, 0.9464908791584528, 1.209934258182083,
      1.3515613727557048, 1.3260493841692051, 1.1183852026718095,
      0.7491248413098086, 0.27138123704376005, -0.2398475720447833,
      -0.703501637240306, -1.04964981524881, -1.2339298983977092,
      -1.2458107536255025, -1.1087905418568325, -0.872649238183079,
      -0.5998364535473757, -0.34950416688345165, -0.16323113223144797,
      -0.055999680539293384, -0.014603188435016567, -0.0037366732016552995,
      0.021956374379322074, 0.10313803463704213, 0.26228078568053936,
      0.4950526065419322, 0.7689594877033953, 1.0297558718215476,
      1.2141265142817173, 1.2655058721059929, 1.1490506693199651,
      0.8619365474045624, 0.4362754784584669, -0.06623370759884471,
      -0.566759119197111, -0.9859619319141077, -1.2608194845864953,
      -1.3576155091169908, -1.2780161802275147, -1.0568639111140168,
      -0.7523682618669485, -0.43124080356209815, -0.15254015949806043,
      0.04573936017704083, 0.1540505944503851, 0.19093418797995432,
      0.19519726200091236, 0.21282040688292736, 0.2821254355101341,
      0.4211707232673697, 0.6207582062813235, 0.8449848000358888,
      1.0393200720713058, 1.1442373835022006, 1.110964831128588,
      0.9153281890886442, 0.5660847651137884, 0.10549063211784805,
      -0.39823204704622195, -0.8648394459173021, -1.2191244457693713,
      -1.4069992277239964, -1.4067385922385474, -1.232709126967651,
      -0.930762387079454, -0.5665226916841148, -0.2095371334113147,
      0.08275789605660305, 0.2773082034389881, 0.37100423625974127,
      0.388319819214105, 0.3718387853538202, 0.36828762351878974,
      0.4138220108847647, 0.5224830515961891, 0.6809041741007951,
      0.8507251909595371, 0.9781694717374158, 1.0083725686150682,
      0.9007917352060173, 0.6416976226556779, 0.25043868946760794,
      -0.2222953275119764, -0.7039875930990183, -1.115407461261914,
    ]);
    const expected = [
      [
        0.29792632902855193, 2.849110535272045, 0.9284981870697673,
        -2.1047013023828303, -1.1996175062453185, -0.6458246024868949,
        0.27775873912371024, 2.599900535883365, 0.6088522198352471,
        1.8957911368751776, 2.0235700181882925, 0.3417314919897634,
        0.060651130217576656, -1.763025903473436, -2.201637186016766,
        1.3247845860014613, 2.4604900627782365, 0.07679789646815459,
        0.0275384741438999, 2.7234722634158115, 1.4162048361789987,
        -1.8862637545202618, -1.3771343110565797, -0.6951332750550023,
        -0.07249616113529549, 2.578165734845439, 0.7276252256312843,
        1.6949887852146321, 2.1831491971347825, 0.508619323525698,
        0.19754009797209693, -1.4679880700262766, -2.4824569700624117,
        0.8798350692004454, 2.499948364271777, 0.4915521952916637,
        -0.15085432137995156, -1.175586792373485, -2.4052454727872354,
        0.542687056851054, 2.7577123973502617, 0.6097969057899947,
        -0.53805035779646, -0.9837365577533119, -2.1993707838150423,
        0.19176110619571296, 2.8990083389857597, 0.8452146553859158,
        -0.9133672283823052, -0.9195620505462717, -1.891358023053727,
        -0.1221994381888486, 2.905170905088778, 1.163682756378794,
        -1.2277509771031645, -0.9926204168057736, -1.5217495348961414,
        -0.3535363496840778, 2.7760803780802403, 1.5196487034421222,
        -1.4405148556805054, -1.193587931572332, -1.1395340398761218,
        -0.46795073377732105, 2.5301789929267042, 1.8623897959645974,
        -1.5249299498155595, -1.4955411274838932, -0.7954151540185705,
        -0.4472163325469314, 2.2019366892189125, 2.1429832087334537,
        -1.4718978287010354, -1.857656346926948, -0.5348442532363913,
        -0.29168430058856926, 1.8371134826676585, 2.321043383145243,
        -1.29129868367287, -2.230392434649472, -0.39312275876324143,
        -0.017014242087611646, 1.4806582084403241, 2.377536038008403,
        -1.0138572895254583, -2.5750606572968047, -0.34418252703305224,
        0.25274741817659513, 1.3017218367484935, 2.270574389836993,
        -1.2174924121386022, -0.21511212182397, -1.8975711530141433,
        -0.5301459079372375,
      ],
      [
        0.005056444855735145, -0.006187069220974231, -0.008846742006573177,
        0.017532064799973216, -0.023940646966128902, 0.020929052700144387,
        -0.011525315112700371, 0.005811773677805029, -0.003669401563209142,
        0.005854923187284216, 0.2617722548966796, 0.058047940601324635,
        -0.279608803091013, 0.3214758335355739, -0.2755111084112483,
        0.18883926308481158, -0.09414249251305043, 0.02069945188463389,
        0.014535883366161515, -0.014949803873070391, 0.00025808335627389877,
        0.008345685716706587, -0.003053048485967379, -0.007666548794309714,
        0.010453305338496909, -0.0017265902756325813, -0.008918999538336728,
        0.009673640902691027, 0.00030392798030199583, -0.009944670605511765,
        0.00855143067049903, 0.0023295088501952706, -0.010625477055929415,
        0.007133003968900901, 0.004273531478286515, -0.010939015180869323,
        0.005467296502245461, 0.006070302292651097, -0.010872544435703707,
        0.0036122239258666484, 0.007655874922100733, -0.010430239655883966,
        0.0016318866397499136, 0.008976992226870492, -0.009625560813307364,
        -0.0004049161167222252, 0.009986179610917564, -0.00848825580279025,
        -0.0024277670452697263, 0.01065016461916039, -0.007055876909395095,
        -0.004366413040853006, 0.010944233406285335, -0.005379915461635434,
        -0.006153818877216256, 0.010859905608876981, -0.0035165984063368926,
        -0.007727909763789237, 0.010398387982450793, -0.001532341907069978,
        -0.009034264095172525, 0.009577394443635548, 0.0005059350279081658,
        -0.010027496461406134, 0.008423648888551115, 0.002525762098673013,
        -0.010673237823145734, 0.0069812910174445, 0.004496994710174744,
        -0.010680733797837282, 0.00611336594721333, 0.006491942586337516,
        -0.014896481334472874, 0.013407673361063435, 0.13456821792320817,
        -0.06639409211007348, -0.09365881863367644, 0.26077228684046855,
        -0.5181178477964444, 0.5010530171143914, -0.36765071186438125,
        0.21470693150025794, -0.0891529205848902, 0.011061623276789183,
        0.01579687109030482, -0.009246114797786508, -0.004315103335116582,
        0.0066281866001500446, 0.0025686427229113964, -0.010629581904030528,
        0.007374482849070391, 0.003980671012448784, -0.010914916779516008,
        0.00574106468047169,
      ],
      [
        0.0031235274895065595, 0.035993387190017635, -0.015819376019329274,
        -0.06292095766502473, 0.07697404273848159, -0.06642434522179377,
        0.04800861601660162, -0.028508548638242523, 0.012615995912421768,
        -0.0029433141213936853, -0.0009192583530423112, 0.0013718538352728265,
        -0.000760372898317696, 0.00025469782547583544, -4.9492980644614625e-5,
        2.6572063605440763e-6, 1.1676305684331243e-6, -2.1665013118067715e-7,
        3.853501931603742e-8, -2.3856215546715203e-8, -4.998441512831585e-8,
        -2.790578298214823e-8, 2.059047867259358e-8, 4.9594197465278454e-8,
        3.164832727842701e-8, -1.6258165574692577e-8, -4.877334017902302e-8,
        -3.511587642959081e-8, 1.1785014401770165e-8, 4.752936434298649e-8,
        3.827881009416967e-8, -7.209428156314844e-9, -4.587278711941695e-8,
        -4.110962174253969e-8, 2.5709236419862e-9, 4.3817599810305026e-8,
        4.358324826468553e-8, 2.0897817840987236e-9, -4.1381918472229854e-8,
        -4.5678260441308577e-8, -6.732025073503044e-9, 3.858729686847161e-8,
        4.737694463881373e-8, 1.13159314092486e-8, -3.545770908708863e-8,
        -4.8664518982596704e-8, -1.5801913632711162e-8, 3.201993795216019e-8,
        4.952932033957119e-8, 2.01505875195246e-8, -2.8304103112062525e-8,
        -4.9963877585098676e-8, -2.432398961815484e-8, 2.4342863610320558e-8,
        4.996489878499718e-8, 2.828632017537022e-8, -2.0170338963603573e-8,
        -4.953234659394411e-8, -3.200338329529422e-8, 1.5822354935781375e-8,
        4.8669483139779576e-8, 3.544248193961342e-8, -1.1336934257080653e-8,
        -4.7383841511765476e-8, -3.857354094146959e-8, 6.753426835766421e-9,
        4.5687061590794304e-8, 4.13698045128477e-8, -2.111343168744017e-9,
        -4.35938431159813e-8, -4.38072171581876e-8, -2.5494033428031318e-9,
        4.1121887687516106e-8, 4.5864177439226076e-8, 7.188088913756997e-9,
        -3.8292678625863963e-8, -4.7522615551815913e-8, -1.1764024114452063e-8,
        3.5131256677001745e-8, 4.876855381765406e-8, 1.623774666870528e-8,
        -3.166504681082721e-8, -4.959141232462084e-8, -2.057083956698593e-8,
        2.7923664780107373e-8, 4.9983600035939175e-8, 2.4725401179844782e-8,
        -2.3939612167731708e-8, -4.99414989736913e-8, -2.8664957585369076e-8,
        1.9747972401517136e-8, 4.946590390719585e-8, 3.235556712232872e-8,
        -1.538510775272615e-8, -4.8561159662370006e-8, -3.576558834770206e-8,
        1.0888412919324642e-8, 4.723470282151833e-8, 3.8865166625852254e-8,
        -6.296948268576971e-9, -4.5497815061633716e-8, -4.1626984382578816e-8,
        1.651067714490995e-9, 4.3366006154798184e-8, 4.4027305048938654e-8,
        3.0089187490858802e-9, -4.085802846055028e-8, -4.604571071388999e-8,
        -7.643030451576343e-9, 3.7995205694653645e-8, 4.766442332407836e-8,
        1.2211010486664566e-8, -3.480217367700417e-8, -4.8868965548658846e-8,
        -1.667273069086281e-8, 3.13070864738455e-8, 4.9649143122318664e-8,
        2.0989467134215775e-8, -2.7540515745604305e-8, -4.9998588652731925e-8,
        -2.5124201865100387e-8, 2.353473297698637e-8, 4.9914029807325636e-8,
        2.9041049200670437e-8, -1.9324292172521158e-8, -4.939576925247031e-8,
        -3.2705514032808987e-8, 1.4946162408408072e-8, 0.00169323788222179,
        0.019518309990093862, -0.008573395461423236, -0.03413400084432494,
        0.04176074845087884, -0.03603995002122354, 0.02604832300113593,
        -0.015466056767940163, 0.006841453123059086, -0.0015934481308415185,
        -0.0005009397552397438, 0.0007451249511506572, -0.00041261016560133527,
        0.00013814912393929932, -2.6832063690981607e-5, 1.3988922075675437e-6,
        6.113272217634912e-7, -1.0608292636816067e-7, 5.537239167245252e-8,
        1.2050089142031248e-8,
      ],
    ];
    const result = wavedec(data, "db21");

    const reconstruction = waverec(result, "db21", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db21_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5016239115019492, 0.9261274146822618, 1.212112015124051,
      1.3259880639331068, 1.267668205685243, 1.068647796242424,
      0.7830786014514418, 0.47410973210082785, 0.19887356851767463,
      -0.004232479196183192, -0.12293801882883734, -0.17149299976992963,
      -0.18414819017630313, -0.20353331097868044, -0.2670089808626468,
      -0.3945637659043467, -0.5814308932305239, -0.7974091630812484,
      -0.9931835291918856, -1.1121702683564845, -1.1049978031537648,
      -0.9430280897498353, -0.6275024625155037, -0.1919199512419098,
      0.30312250846903277, 0.7815750195254455, 1.1674318758684108,
      1.4004984540880627, 1.4487596306757204, 1.3144819493576374,
      1.0326742917504559, 0.6623533051275194, 0.2727670572289715,
      -0.07209155817115798, -0.3269862215914967, -0.473793585510379,
      -0.5228552272939081, -0.5072090687543711, -0.4713409877625092,
      -0.4574358394287993, -0.49269924192474196, -0.5810234520126818,
      -0.7011580519387843, -0.8118952716680686, -0.8629995170938072,
      -0.8091420442940862, -0.6233092276258173, -0.3062348286243655,
      0.11065373944788404, 0.5697159995991559, 0.9981314792919476,
      1.3229945498639624, 1.486960109717868, 1.4607570813114783,
      1.2496075125604762, 0.8920292580833605, 0.4513101996056891,
      0.0016816915099498453, -0.3875344565055363, -0.666079771219309,
      -0.8119394359288257, -0.8335159683008404, -0.7644877984329113,
      -0.6528290238955752, -0.5468741215686865, -0.481998030035156,
      -0.47128196487582286, -0.5025011022507102, -0.5421595754896801,
      -0.5455104733570038, -0.46997649085625914, -0.2885077895813972,
      0.0006036884555797317, 0.3700832132978612, 0.7673235605995016,
      1.1246428365725258, 1.373817326257202, 1.4614676466547585,
      1.361616893315193, 1.08237669519311, 0.6650987168331797,
      0.1761202541258874, -0.30700234848464875, -0.7115691834133113,
      -0.9843822370534936, -1.101589419961455, -1.0715351410937979,
      -0.9301271081521308, -0.7300364949112321, -0.5265202942412694,
      -0.3634323196187409, -0.26288566546154246, -0.22107392059084496,
      -0.21118967687503498, -0.19258586012060205, -0.12375171855038325,
      0.02428997191140697, 0.257675874750519, 0.5552372815514517,
      0.8711793568068691, 1.1444222212654076, 1.3124437290938777,
      1.3263067620186353, 1.1632053093781267, 0.833413094875542,
      0.3798353411425388, -0.12987076386629828, -0.6168578475745272,
      -1.0072162013382335, -1.2469343420892525, -1.3122422917883576,
      -1.213002152490743, -0.9884841129275003, -0.6966901455293637,
      -0.3999177978892981, -0.15012085992941093, 0.022385759796626714,
      0.11420643825731128, 0.14698512390319224, 0.159015820193358,
      0.19261653715244947, 0.2805901273718052, 0.43531432079147614,
      0.643337565537528, 0.8669717641633682, 1.0526100706870007,
      1.1437934055095638, 1.095825316816964, 0.8882957365782262,
      0.5323319168413424, 0.07064091952148462, -0.42985998685707644,
      -0.891233251783184, -1.2405196215395988, -1.4248371908265358,
      -1.422071045534101, -1.244689629089729, -0.93586351192733,
      -0.5588962616491022, -0.18255935947023955, 0.13413059154665408,
      0.35407189253332516, 0.46835275064144244, 0.4952985262569065,
      0.4727437946755434, 0.4456507870112812, 0.4523284491470007,
      0.5128253994720229, 0.6224988802935951, 0.7524431817018746,
      0.8567219351617881, 0.8846197863821391, 0.7948386611410398,
      0.5680328533750967, 0.21443954369598844, -0.22546867528851042,
      -0.6876899030692235, -1.0973367407943344, -1.3843283593915094,
      -1.4984670666645532, -1.4203473593915747, -1.1655185659537972,
      -0.7809213283639647, -0.3344548387396119, 0.09984065260674735,
      0.45747836962997535, 0.6964175625781618, 0.8041945501272966,
      0.797764252294694, 0.716315253412469, 0.6090323048103056,
      0.5209919638983022, 0.480794354128626, 0.4930572613146817,
      0.5376484902310291, 0.5758193916823627, 0.5616512526677364,
      0.45587059088491194, 0.23846560320076876, -0.08319987600228945,
      -0.47298926205477054, -0.8718790620419252, -1.2098910548249577,
      -1.4213204575354825, -1.4596585445554648, -1.3086313869308144,
      -0.986671880502805, -0.5436942860601806, -0.05087237742634193,
      0.4142115831978066, 0.7835847797160964, 1.0123483316942745,
      1.0865082107689548, 1.023472939517799, 0.8653005354592074,
      0.66652477787953, 0.47967734061435974, 0.3421349985550718,
      0.26753784752223253, 0.24384337872039358, 0.23839630061215478,
      0.2086226292892916, 0.11553693432982814, -0.06346514074266929,
      -0.32589312907503726, -0.6418857696652758, -0.9591325057245318,
      -1.2139523800722112, -1.345934046019524, -1.3126130008557866,
      -1.100594515714146, -0.7303437535604898, -0.25336284570637585,
      0.2577055560879645, 0.723810710272961, 1.0756624178871173,
      1.2675931291161142, 1.285930640823234, 1.150024180627051,
      0.9058343551274602, 0.6137757839433395, 0.33385707745427073,
      0.11176722115716964, -0.030733819851364863, -0.0988737825123475,
      -0.12078441351285966, -0.13747269678924184, -0.1895258327542208,
      -0.3040377760570291, -0.4851825082071139, -0.7109409307053923,
      -0.9369412926905748, -1.1065796131707282, -1.1649900683152197,
      -1.0734314288758797, -0.8204948249011583, -0.42726393765528503,
      0.05500316801102301, 0.5543006667573948, 0.992316367784149,
      1.3005689108067302, 1.4344953122589967, 1.382221117627917,
      1.1660118399955954, 0.8361514039740807, 0.45879565414529405,
      0.10076823750513436, -0.18504182660152585, -0.3702225722232759,
      -0.45490414707788385, -0.46455149895512016, -0.4404930156284672,
      -0.4267339202086609, -0.4565025737409832,
    ]);
    const expected = [
      [
        0.29933128406388737, 2.942893451274949, 0.8730567195174709,
        -1.954183554930957, -1.1387378195182205, -0.7809853682806034,
        0.2456259817031776, 2.625083700870584, 0.6133642046286527,
        1.8887129285287982, 2.0898851336310185, 0.27041199798538107,
        -0.09183626716297756, -1.6218225643971125, -2.1526076424053824,
        1.2867820466033026, 2.678145391818812, -0.10921806032971915,
        0.013474797243989499, 2.8318831675739617, 1.356530200780683,
        -1.7541913361773354, -1.2854387513124617, -0.8208309874504194,
        -0.12137669421977751, 2.6002333354916467, 0.7367966126037787,
        1.6813016978735318, 2.2511477652023455, 0.46248671342422937,
        0.03056295531123318, -1.361934814802356, -2.39307803804364,
        0.8074980662439866, 2.715094381689044, 0.45476263466595024,
        -0.6314813391383972, -1.0463479970574399, -2.054255726366295,
        0.3963229281425282, 2.963499972378802, 0.7085350848243331,
        -1.2860486505317112, -0.9928288406823036, -1.486020044178985,
        0.06702642537464634, 2.907844535888885, 1.1170446784546595,
        -1.7772565109358802, -1.2239723875051052, -0.8251446461321469,
        -0.044361410386460395, 2.569924919186981, 1.525864465727362,
        -1.9966926987010634, -1.6748913314564302, -0.23420864443669892,
        0.13224254863473994, 2.052550526815284, 1.778828553434043,
        -1.9154520528073584, -2.212483393605283, 0.14655860178975647,
        0.5799606860053601, 1.5089738134868296, 1.7646205862054771,
        -1.5925479161943272, -2.6749883781674106, 0.2407820012026495,
        1.199794655168241, 1.097342074609894, 1.450039030288197,
        -1.1571989896973374, -2.9200774995259886, 0.05845916311578916,
        1.8398816133199933, 0.9337073697445907, 0.8900591801748107,
        -0.7702883835093346, -2.8671033323551187, -0.3073104726531458,
        2.3404286515857797, 1.0583349905206683, 0.2090431329183418,
        -0.570191973761338, -2.5327864309055017, -0.689466050371877,
        2.555312276069929, 1.4508291943223064, -0.4341498519018739,
        -0.814132757964337, -0.9766716512911342, -0.8757220700290995,
        -0.9184249888831865,
      ],
      [
        0.0035237027294922614, 0.009568370581238545, -0.012508684767052495,
        -0.01534150265253675, 0.01903771992793139, -0.017921261132572985,
        0.015725890953120786, -0.007392617143682833, -0.001864370090118282,
        0.009856572054578216, 0.25681206554256536, 0.057750292977693726,
        -0.27452739794626624, 0.3148429973346221, -0.26994992298437454,
        0.18560376237634688, -0.09349308755517877, 0.022278657866079823,
        0.01181369138795797, -0.012884590256504656, 0.0004280852473540174,
        0.006042519187238667, -0.0007703200853374522, -0.007467016391186584,
        0.007597146759321796, 0.0010261267792103577, -0.008458779362729953,
        0.006055126396984628, 0.0033924167753422575, -0.008893681210531927,
        0.004047506332569407, 0.00550758063589199, -0.008654612644587225,
        0.0017332939842197874, 0.007204508011894598, -0.0077610589003813705,
        -0.0007121121650373458, 0.00835686843737775, -0.006278675371688226,
        -0.003103712855943174, 0.008875143904970706, -0.004321712479458052,
        -0.005260061757917035, 0.008722350830022813, -0.002036471852318951,
        -0.007018224443273948, 0.00790775957148861, 0.0004020943054109759,
        -0.00824456132106072, 0.006495398797094985, 0.0028110951457635575,
        -0.008846747419450492, 0.004589885926603077, 0.005006321402685399,
        -0.008778529832742068, 0.0023379251664254934, 0.006823191966214793,
        -0.008045801083434464, -9.231610139969619e-5, 0.008122471436416371,
        -0.006703251098459821, -0.0025143539584557683, 0.00880730917652052,
        -0.004853454659373881, -0.004747169502436466, 0.008824345532187498,
        -0.0026355141505215143, -0.006619221687176652, 0.008161662633178125,
        -0.00039420551177056127, -0.009172197060084595, 0.002186423984451296,
        -0.011340361715955427, -0.038843225893166876, 0.0005524850124876724,
        0.05407813458982445, -0.05997513216657104, 0.017023562440450276,
        0.022351224846371108, 0.028871876884865012, -0.022233983336124512,
        0.027797443453510276, -0.023638050706487137, 0.011545371376346009,
        0.003612673925660959, -0.01171780011929381, 0.007495421740679979,
        0.0032351546183163895, -0.008709301230211375, 0.0034231386156046125,
        0.00601136586457836, -0.008473894406417663, 0.001075593952980413,
        0.007575755748602189,
      ],
      [
        0.0031173894879203004, 0.03589614073663674, -0.01579792791224268,
        -0.0626936465443432, 0.07668233593433772, -0.06616042100953776,
        0.04781741418665706, -0.02840459173652462, 0.012583196579797081,
        -0.002948030667389044, -0.0009060971735089567, 0.0013632431425975153,
        -0.000757144205498753, 0.00025401818540285513, -4.9440573849714045e-5,
        2.6780551395599034e-6, 1.1510587308814582e-6, -2.2869843172607376e-7,
        3.7491537035506156e-8, -1.1875222157480981e-8, -3.6637986845550013e-8,
        -2.6756429988628175e-8, 7.778060919026163e-9, 3.514590595348373e-8,
        3.013079774189333e-8, -2.6463468586356906e-9, -3.2985049724492624e-8,
        -3.2931619247733156e-8, -2.5353195581989044e-9, 3.019702472080826e-8,
        3.5106178209732796e-8, 7.668851587258498e-9, -2.6834590670229017e-8,
        -3.6613115674802084e-8, -1.2656875223602375e-8, 2.2961216176143783e-8,
        3.7423182272045915e-8, 1.740400723466173e-8, -1.865086214719662e-8,
        -3.7520935697925395e-8, -2.1819608220164725e-8, 1.3986047522320801e-8,
        3.6905095087000394e-8, 2.582015337013063e-8, -9.055279571636437e-9,
        -3.5587421838273315e-8, -2.932985630984748e-8, 3.951847355902037e-9,
        3.359241998581027e-8, 3.228147694112722e-8, 1.226928572533429e-9,
        -3.095796876694625e-8, -3.461851131479853e-8, -6.381984723931122e-9,
        2.7734765337959913e-8, 3.6296944110768854e-8, 1.1415447163194875e-8,
        -2.3984217856476317e-8, -3.7285210010072704e-8, -1.623209806383139e-8,
        1.9777121302658757e-8, 3.756406755594854e-8, 2.0740099274503553e-8,
        -1.5193411273128908e-8, -3.712783117611754e-8, -2.485314074603704e-8,
        1.0320854834288137e-8, 3.5985231292669926e-8, 2.8493141307224307e-8,
        -5.252284507839926e-9, -3.4158388891485056e-8, -3.1591390742303524e-8,
        8.357845023665054e-11, 3.1681659790106e-8, 3.4088805103764874e-8,
        5.087078293210843e-9, -2.8601749493803635e-8, -3.5937296862706367e-8,
        -1.0160746253436902e-8, 2.49776641670033e-8, 3.7101836390835366e-8,
        1.5040741606560365e-8, -2.0878759551270185e-8, -3.756083436006729e-8,
        -1.9634755758165326e-8, 1.63826516520563e-8, 3.730543078507949e-8,
        2.3855576292351118e-8, -1.1574450117168687e-8, -3.6339933944275455e-8,
        -2.7622353296884966e-8, 6.54598239249254e-9, 3.468280352074738e-8,
        3.0863219620935505e-8, -1.3933934116684282e-9, -3.236613350824632e-8,
        -3.351705447568752e-8, -3.785661858631056e-9, 2.9433924049425077e-8,
        3.553357073681832e-8, 8.893090339565676e-9, -2.5941395430139068e-8,
        -3.687390081635274e-8, -1.3831391966628142e-8, 2.195504349785179e-8,
        3.7512284915497135e-8, 1.8506140239606058e-8, -1.755130029162251e-8,
        -3.7437102696916904e-8, -2.2828707037306307e-8, 1.2813900838228901e-8,
        3.6650042567761474e-8, 2.6717348650932494e-8, -7.832403986523603e-9,
        -3.5165570787936465e-8, -3.0097765994366054e-8, 2.7016057352539613e-9,
        3.301165625332944e-8, 3.290515565970352e-8, 2.4803068375770934e-9,
        -3.022976484670553e-8, -3.5086384395704005e-8, -7.614723773797632e-9,
        2.687313502373676e-8, 3.6600463799936435e-8, 1.2604549649700242e-8,
        -2.300513962644933e-8, -4.696923339160378e-5, -0.002518667599511932,
        -0.006576701775585366, 0.015022529738444106, -0.009066594278210527,
        0.005446975334158138, -0.0044017742962364735, 0.004163436587931135,
        -0.003618823854419318, 0.0025822100512121644, -0.0014384584151433523,
        0.0005934302980088236, -0.00016058596058419344, 1.4984596738916138e-5,
        8.485194886057471e-6, -4.363057667847092e-6, 9.733527831034951e-7,
        -5.9445714776749604e-8, -2.2757465673425593e-8, -3.647713180086631e-8,
        -2.240748992207697e-8,
      ],
    ];
    const result = wavedec(data, "db21");

    const reconstruction = waverec(result, "db21", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db22", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49789070076700825, 0.9199117172235522, 1.2055801169651343,
      1.321649447297816, 1.2677325606749184, 1.0744965936862605,
      0.794999114360862, 0.491357006825424, 0.22002288571153167,
      0.0192275382545522, -0.09843424374333931, -0.1465978639552298,
      -0.1589269105968334, -0.17782176378849024, -0.24099963219565518,
      -0.3694253153285316, -0.5597286894311174, -0.783124422694771,
      -0.9912265377654073, -1.1274231028220574, -1.1410685344690088,
      -1.001009273702785, -0.7050673847610636, -0.2830430782569986,
      0.20766353853328867, 0.692941275327669, 1.09692571067687,
      1.357593563206679, 1.439391759740476, 1.339993971759577,
      1.0896685881407584, 0.7434937111219988, 0.3683434392280728,
      0.02778778002002097, -0.23149688697176635, -0.38862586967357016,
      -0.45071378510155047, -0.4480501629719108, -0.42362866891996553,
      -0.41979096599617827, -0.4654347746877413, -0.567070658741862,
      -0.7060355337385039, -0.8426233805185205, -0.9261553327618861,
      -0.9085092349338235, -0.7577325626565923, -0.4682941970579477,
      -0.06530988391417858, 0.39848385394926517, 0.8524808668054242,
      1.2225172808437617, 1.4464548136716298, 1.4874089123315408,
      1.341529674251379, 1.0385223277402307, 0.6348089210069775,
      0.20096976002881256, -0.19355722243515033, -0.49492122964939983,
      -0.6750973638381907, -0.7356215862292458, -0.7041227128601306,
      -0.6247068760117677, -0.54473305148296, -0.5013697174104411,
      -0.5113369601795446, -0.566414566961144, -0.6358387490494246,
      -0.6749768619128258, -0.6380867693025306, -0.4919244867466134,
      -0.22671775416577455, 0.13836317633030942, 0.5567805508098058,
      0.9630770710474708, 1.2863358275832695, 1.4655429877635213,
      1.4632415442275075, 1.2742327737805672, 0.9272347661245575,
      0.47906734090874875, 0.002699349638574544, -0.42805889123851276,
      -0.7536575652116527, -0.9402212906526989, -0.9847054949586957,
      -0.9127501025102245, -0.7699500142222951, -0.6088378208292189,
      -0.4748795396384159, -0.39497668470986835, -0.3713040430463219,
      -0.38195748923273515, -0.38817384514175307, -0.346235895845669,
      -0.22099510221055035, 0.002477463847601613, 0.3121601986276629,
      0.6691202804424472, 1.0145104130770053, 1.2819881716360553,
      1.4126633965285604, 1.3690154859836527, 1.144419861719355,
      0.765936882963498, 0.2896038632401358, -0.2107513729064249,
      -0.6586184919475109, -0.9903501930726741, -1.1675694025244807,
      -1.183626989825521, -1.0627339631187798, -0.8521489369430204,
      -0.6094542132396933, -0.3881022256272192, -0.22478191410074339,
      -0.13165587665553075, -0.09527913371782123, -0.08233471878547484,
      -0.05062148128997246, 0.03757783673269943, 0.20321467980759,
      0.44248120053355466, 0.7252490407424734, 1.0004901507249488,
      1.2074899322332677, 1.2902043742514113, 1.2112936341185305,
      0.9623878736229031, 0.5680051782361977, 0.08203927919112752,
      -0.4224949851871366, -0.8681564611880245, -1.1888440072589808,
      -1.343005098577427, -1.3212665044459686, -1.1467980888366418,
      -0.8684518539593995, -0.5484302525368048, -0.24751683194993457,
      -0.011440554287169391, 0.1383846686470221, 0.20761759164947455,
      0.22474018056292502, 0.23103167803557356, 0.26741854907658114,
      0.3616140777855025, 0.5188769605982966, 0.7188094849027549,
      0.9191059953246822, 1.0654217352818929, 1.1049880148364017,
      1.000631734078888, 0.7417051128701821, 0.3491357653387117,
      -0.12680024004352403, -0.6156354455355418, -1.0407782287960385,
      -1.3352748077954872, -1.455624020008969, -1.390449884290672,
      -1.1620505891749124, -0.8205298536930762, -0.4319698612872807,
      -0.06350078172175416, 0.23117592414966043, 0.4224120445970121,
      0.5089644819371739, 0.5152099351252928, 0.4821111559605725,
      0.45434599980783047, 0.46693130114496123, 0.5347694213120786,
      0.6477946574359997, 0.7729850443819685, 0.8627795067511033,
      0.8678247525102717, 0.7508680155292544, 0.4982843487729014,
      0.1262636788037719, -0.32004471951586894, -0.774432281202312,
      -1.1628625046335905, -1.4190080879627274, -1.4984795382491105,
      -1.3884108847400178, -1.110151265794158, -0.7144369288629651,
      -0.2701942416736859, 0.15037814809164612, 0.48694193612902736,
      0.7028478453479753, 0.7909746514571467, 0.7723666763503811,
      0.6882125644953644, 0.5873162663524133, 0.5122819372879002,
      0.4879089648689194, 0.5147073411062156, 0.569143075475203,
      0.6105286968203191, 0.5928016508489645, 0.47819452394783296,
      0.2493005539335299, -0.08359957562926412, -0.4819444909777991,
      -0.885387902070791, -1.2239985479117497, -1.4333630116763123,
      -1.4690443559496587, -1.3169587616631442, -0.9971732104703541,
      -0.5601742056147314, -0.076437573878131, 0.37828736512584804,
      0.7385618633092783, 0.9621095224241833, 1.0370158086075079,
      0.9817327486354679, 0.8380850162818216, 0.65915114764893,
      0.49510317997730663, 0.38053761903937044, 0.3264140419506111,
      0.31853993866627606, 0.3228922104448061, 0.2963521783194472,
      0.20007266982814267, 0.012026285469764197, -0.2645317103961191,
      -0.5989581476729098, -0.9381845301935899, -1.2177090885968906,
      -1.3760727378270623, -1.3693771896602809, -1.1823398510290852,
      -0.8331682103382958, -0.3709880067926873, 0.13367530275458825,
      0.6032100660342955, 0.9687357631833657, 1.1837818142202876,
      1.2327072206436198, 1.1320077806009137, 0.9243629401525291,
      0.6670040878084911, 0.41732159187548257, 0.21924708398103265,
      0.09370322464155095, 0.035368719585158276, 0.01641974687516001,
      -0.0038300540430568075, -0.0659340170362096, -0.19733676410174816,
    ]);
    const expected = [
      [
        -0.7039986755173682, 2.2636650568018504, 2.2052722561292404,
        -1.170551393844269, -1.9013099670197031, -0.4882061292246617,
        -0.8310224337659348, 2.2227302417620964, 1.468685192934516,
        0.9374471821991822, 2.500035615630915, 1.0030899088073946,
        0.05335214268446564, -0.6242408067388329, -2.5020942709269733,
        -0.6124498232934694, 2.521657513706726, 1.583932579642871,
        -0.6220733100535315, -0.8015168624209291, 2.193544450466157,
        2.292760711473495, -1.0309725730844899, -1.8896180749836917,
        -0.5443758116822646, -0.9438277779633801, 2.1936325927400935,
        1.436396777667623, 0.9555267503275253, 2.4877627580953527,
        1.063553982889864, 0.15222452546016838, -0.5607378686172976,
        -2.487702458501867, -0.8173631519671523, 2.530836381824462,
        1.5304575610908078, -0.36435704268568914, -0.5988375833058598,
        -1.9363503636175248, -1.2346543247163009, 2.3175021580983923,
        2.119812094806438, -0.6340200768136601, -0.9610985318498191,
        -1.3652433271362898, -1.3440280050826001, 1.8311108444203064,
        2.6258692909238484, -0.5621101230807278, -1.5210531869130928,
        -0.9730736558795694, -1.1085005974385593, 1.2399307823029941,
        2.8732222414317095, -0.17259977704264057, -2.083573970917054,
        -0.8963874119636266, -0.6108721927777324, 0.7486222451707791,
        2.776310471263163, 0.400235670807278, -2.452640952149478,
        -1.1621620437533422, -0.024970142909949606, 0.527159045318401,
        2.36913504100126, 0.9584519635238165, -2.4994194549496975,
        -1.6784371329249157, 0.4447210803025558, 0.6517967286644276,
        1.7934499980341485, 1.3091818006712768, -2.207004274867439,
        -2.266252139691071, 0.6340768540297382, 1.0785907422412875,
        1.2495282359694866, 1.3316033705360328, -1.6761509711987153,
        -2.722440150875621, 0.4784120079844187, 1.653315147788115,
        0.9381256829304858, 0.9972280747766373, -1.0535257913794274,
        -2.9481219039929862, 0.12299372106042446, 2.029126857583611,
        1.2157954504648307, -0.010597245452360949, -0.05667119687753775,
        -0.17329659273739575, -0.1206648625400434, -0.24366150554671878,
      ],
      [
        -0.043806009156681806, 0.007024123912783866, -0.010760744731022679,
        0.04961917813666241, -0.07026216675353406, 0.07394035263681123,
        -0.06307656859462324, 0.043725193942503404, 0.001807430714664857,
        0.04093793922557848, -0.013654243494204786, -0.31046839165525814,
        0.16976512436638047, -0.004363708271986123, -0.04765614838815973,
        0.02418696539670357, 0.022412639211644464, -0.054160603894930534,
        0.05583763977314582, -0.03496721538956298, 0.01101674236349512,
        0.000596045138507839, 0.001311901119239434, -0.006444862900009223,
        0.0051330158945321665, 0.002148328774894994, -0.0069641773972061085,
        0.0036085760884370655, 0.003990366121496263, -0.006891111438071805,
        0.0016784334536403046, 0.005510486791375191, -0.006211322872721546,
        -0.0004007304923896212, 0.006540859766328673, -0.004980232008072386,
        -0.0024440586020377606, 0.006990916234352892, -0.0033066828106088748,
        -0.004270616368448253, 0.006819721086445225, -0.0013397470435103699,
        -0.005717708239266298, 0.006043447666717229, 0.0007463870343597295,
        -0.0066573420359432815, 0.004730054072072896, 0.0027660105082545072,
        -0.0070055787596960215, 0.0029971363748301626, 0.004540257907404133,
        -0.006731998998532998, 0.000997598865951073, 0.005911113371605494,
        -0.005860393531439812, -0.0010900354923687517, 0.006757320706569418,
        -0.004468658882216393, -0.003081365001364387, 0.007003269087955529,
        -0.002679874775296533, -0.004798595510980127, 0.006627590860838493,
        -0.000653378344599466, -0.00609021574104035, 0.00566317251691717,
        0.0014313699497245727, -0.00684121797062644, 0.004185786360011094,
        0.003321318341264214, -0.007078091331150034, 0.003465817211018131,
        0.012046995290800423, 0.01116951430226774, -0.010419832427446526,
        -0.11346305603611571, 0.047630647214867726, 0.01204922051047095,
        0.1148285006315893, -0.08330027628674436, 0.01000198015138298,
        0.0011285230180439836, -0.00012479165251307622, -0.009109814329551302,
        0.01904176746870284, -0.02136916009093411, 0.013540984165206533,
        -0.0011664148533910427, -0.006046419744416424, 0.0033701969383054483,
        0.0040812295788426834, -0.006850244604264612, 0.0015412798241218684,
        0.005594675658393224, -0.00614656444889911, -0.0005381643531505773,
      ],
      [
        0.002301229033031048, 0.03108075375652885, -0.0003164735079795296,
        -0.07806558652967621, 0.08549897017925848, -0.07331288866710108,
        0.05698797833872818, -0.03952822958532226, 0.023133563215571633,
        -0.010497732768225984, 0.003026126248003291, 2.699847169044403e-5,
        -0.0005987742476882295, 0.00036661952396387017, -0.0001253909690455308,
        2.4857894872499055e-5, -1.6937104754364608e-6, -4.050458946308525e-7,
        9.777212681138501e-8, -2.234175137176516e-8, -1.0607467890321193e-8,
        5.243853827585822e-9, 1.598065966663015e-8, 1.2096220533377236e-8,
        -2.8554477893956254e-9, -1.5194542249729944e-8, -1.363160003404725e-8,
        4.0337486410590465e-10, 1.4069274928467604e-8, 1.4862678253528368e-8,
        2.0576632668459214e-9, -1.2630002182886123e-8, -1.57620499712655e-8,
        -4.4728472532969896e-9, 1.0908734963101936e-8, 1.6309553041129327e-8,
        6.788214960382944e-9, -8.94387659338912e-9, -1.649288608216828e-8,
        -8.951973042281384e-9, 6.779401958599883e-9, 1.6308043145973555e-8,
        1.0915848289451612e-8, -4.4636581928511235e-9, -1.575922618396501e-8,
        -1.2636125295579284e-8, 2.0482269219209533e-9, 1.4858604444763035e-8,
        1.4074350224196912e-8, 4.130027833281793e-10, -1.362620104305326e-8,
        -1.5198311926412393e-8, -2.8649656780658702e-9, 1.2089617462503054e-8,
        1.5982954141239485e-8, 5.252901811443361e-9, -1.028323186672185e-8,
        -1.6410878263830273e-8, -7.523616882689332e-9, 8.247281304628524e-9,
        1.647248395503687e-8, 9.626456342379435e-9, -6.0271438319385075e-9,
        -1.6166293537495558e-8, -1.1514344635403726e-8, 3.6724633629911273e-9,
        1.549917338935586e-8, 1.3145124455330761e-8, -1.2358769840593393e-9,
        -1.4486132297623843e-8, -1.4482504137653528e-8, -1.2282953436031073e-9,
        1.3149748439697147e-8, 1.5496653376247798e-8, 3.665141056000598e-9,
        -1.1519736581957648e-8, -1.6164812889321364e-8, -6.020153195265949e-9,
        9.632524346027851e-9, 1.647204010886757e-8, 8.240692960863409e-9,
        -7.530352968953399e-9, -1.641161057987578e-8, -1.0277275862046914e-8,
        5.260123732111561e-9, 1.598487617431682e-8, 1.2084518099220705e-8,
        -2.872391392102959e-9, -1.520126081422551e-8, -1.3621986758800498e-8,
        4.2049300973014787e-10, 1.4078225401563771e-8, 1.4855282903598703e-8,
        2.0407146732438847e-9, -1.2640964965656367e-8, -1.575694828823348e-8,
        -4.45632265651803e-9, 1.092157224627866e-8, 1.6306954189902034e-8,
        6.772531779370906e-9, -8.95833017887367e-9, -1.6492926376600325e-8,
        -8.937587991646233e-9, 6.795038896317485e-9, 1.6310628146247114e-8,
        1.0903045844059009e-8, -4.4801041773245545e-9, -1.57642284482594e-8,
        -1.2625082857224638e-8, 2.06522302026641e-9, 1.4866000053247582e-8,
        1.4065347411174205e-8, 3.9580249764764965e-10, -1.3635894574491007e-8,
        -1.5191665576686408e-8, -2.8480710844641067e-9, 1.2101311031276248e-8,
        1.597877595595094e-8, 5.236705436534943e-9, -1.029658374362574e-8,
        -1.640913837101018e-8, -7.508368245448276e-9, 8.262086532711972e-9,
        1.6473267900349834e-8, 9.612470816428196e-9, -6.043142486295851e-9,
        -1.6169696178182315e-8, -1.1502050236234927e-8, 0.0009458438069236038,
        0.012671667221539352, -0.0002358021578878992, -0.031544933620462,
        0.03445749404223999, -0.029462541672561283, 0.02286019058058672,
        -0.015858764678463762, 0.009310580882528702, -0.004260151905362885,
        0.0012571789590795207, -1.3444296679125105e-5, -0.00023205112751748856,
        0.00014621005409491875, -5.086836500698553e-5, 1.0299129362360898e-5,
        -7.541349116934322e-7, -1.7758487949296947e-7, 2.9195774983344338e-8,
        -2.9585278810713418e-9, 1.3470928875626702e-8,
      ],
    ];
    const result = wavedec(data, "db22");

    const reconstruction = waverec(result, "db22", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db22_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5068363960535084, 0.9347670599151093, 1.2210922817447385,
      1.3317468847339065, 1.2670931979013886, 1.0598326429170815,
      0.765697529200061, 0.44931768715919523, 0.16878952414760795,
      -0.03726844179545191, -0.15706843984763086, -0.20575103031698586,
      -0.21840632560653847, -0.23798136538699755, -0.30131639098214125,
      -0.4270112457558392, -0.608346556255732, -0.8131925479892412,
      -0.9910544427042887, -1.0855734565353612, -1.049384622162789,
      -0.8575832750706229, -0.5163367899631947, -0.06433074401621536,
      0.4335230381993985, 0.8987934552848417, 1.2557444463500416,
      1.447268029317718, 1.4467893701568761, 1.2633536210038563,
      0.9387410397895208, 0.5373719854437918, 0.1314862666808862,
      -0.21481059037700095, -0.4588185223933485, -0.5867290327036878,
      -0.613692686709128, -0.5766925557997606, -0.522233220346398,
      -0.4921241873037372, -0.5110764183366823, -0.5793343701932134,
      -0.6722599574207763, -0.7469971640711486, -0.7545245860086678,
      -0.6540044142564478, -0.4257116747824476, -0.07913581616270998,
      0.3459853212681012, 0.786199063732798, 1.1670573590459064,
      1.419084455480525, 1.4932120736012995, 1.3719830461184266,
      1.0738142264798318, 0.6492662120011123, 0.17018484738183828,
      -0.28571330025744235, -0.6511613233646201, -0.8827329214655348,
      -0.9682194324694707, -0.9264072520951039, -0.7995444711626758,
      -0.6405716611586807, -0.49844838741417763, -0.40532557606211717,
      -0.3687943638216725, -0.3711177943225481, -0.37555581190157883,
      -0.33807645501890415, -0.22136193025737302, -0.007414133108048282,
      0.2946074871866043, 0.6475021068906108, 0.9925437472813241,
      1.2619762256809302, 1.3945367234685342, 1.350250016739565,
      1.1208529701517482, 0.733227240972721, 0.2448894183237535,
      -0.2674979510590998, -0.7239445750101402, -1.0575864226088636,
      -1.2279380202615586, -1.2278957264370673, -1.0829734260224237,
      -0.8431417628366559, -0.5694266153579326, -0.3186630008794818,
      -0.13019357632126188, -0.01775356123275268, 0.031563336926668725,
      0.051172051332452104, 0.08342808942841762, 0.16572907946524745,
      0.31797682166756974, 0.5347439083496035, 0.7842959315217793,
      1.0148788075905921, 1.16682568719314, 1.1875331845987036,
      1.0455798589952836, 0.7404083490961351, 0.30503409980119034,
      -0.19907586600129434, -0.6939044514151638, -1.1008548472202335,
      -1.35707178335866, -1.4282937916180753, -1.3152456741737415,
      -1.052137058971108, -0.6977344120910058, -0.32125262596313237,
      0.013468301074512523, 0.2616736557884032, 0.40604371709328124,
      0.45780961865327197, 0.4505871570773239, 0.42870081675467553,
      0.4331337570485014, 0.4888080365708705, 0.5965333875988924,
      0.7317557546132638, 0.8504914871698017, 0.9009866211978976,
      0.8381556586620105, 0.6371036465803634, 0.30220972472745505,
      -0.13068978000126674, -0.5997951145305681, -1.0293951535015702,
      -1.3457241005012541, -1.492900121212895, -1.4451623071532365,
      -1.212487682627554, -0.8382506653143573, -0.3894958363920824,
      0.057837564857646795, 0.43520807712577547, 0.6954233494847746,
      0.8210093493819095, 0.8251615005708844, 0.7452849847783477,
      0.6309553515412697, 0.5294838842068071, 0.4728214269957986,
      0.4691465861748798, 0.5012595675758167, 0.5321496481352882,
      0.5162619286174412, 0.4135190434784275, 0.20242454000748705,
      -0.11122924200005962, -0.49245112237499405, -0.882653114322367,
      -1.2115962770996882, -1.4129034618535927, -1.4394287153447365,
      -1.2747501197321371, -0.9379500912276701, -0.48044672367639735,
      0.02445037552224541, 0.49683539052127845, 0.8667668011845227,
      1.0882200083546054, 1.1472156031158767, 1.0623435910722034,
      0.8777650743738292, 0.6505986696712716, 0.4359393557936281,
      0.27328381794982237, 0.17772251044052678, 0.13801190823541518,
      0.12187460638295461, 0.08703226747799603, -0.004982491238105624,
      -0.17589984716553841, -0.4221213652219236, -0.7128243424306451,
      -0.9954324419371959, -1.20725208009708, -1.2904894718052096,
      -1.206962163991891, -0.9488292730689025, -0.542588612785404,
      -0.0452018595202007, 0.46688508695641173, 0.913329708811579,
      1.2264649039881963, 1.3649864670059424, 1.3215838121019279,
      1.1228092626099817, 0.8213580362175843, 0.4827551297310227,
      0.16976844002445823, -0.07163389948681331, -0.22140881206272492,
      -0.2875465715263263, -0.3008449685542941, -0.3038785845058895,
      -0.337142745997633, -0.4260455810591351, -0.5721873667484665,
      -0.7512638575367588, -0.9182357630200918, -1.0185439772626705,
      -1.0025858331330981, -0.8397941989862588, -0.5286999274101715,
      -0.10030370903578259, 0.3862950869153523, 0.8551669277180807,
      1.2291668483697213, 1.4462539795254306, 1.4726706645577932,
      1.3098712870696765, 0.9935861355365431, 0.5852938356050656,
      0.15819327336391176, -0.21893351941104344, -0.4961103196756425,
      -0.6514307858898913, -0.6931250740573041, -0.6541584151296367,
      -0.5809427811514003, -0.5191849819029248, -0.5005708488874423,
      -0.5337302814009455, -0.6018084792645896, -0.6672664545532747,
      -0.6826756589911263, -0.6047228457676722, -0.4077906666918202,
      -0.09354186307122514, 0.30610214290002075, 0.7335707041248303,
      1.1169359795271552, 1.3853016273157572, 1.4846477139733603,
      1.3903270682449975, 1.113178627666397, 0.6977415629368791,
      0.21294824284186892, -0.2625207222368823, -0.6567634254474981,
      -0.9191814140401593, -1.0296376991975, -1.0002204697891022,
      -0.8694072820236525, -0.6902810340978762, -0.5158813703798666,
      -0.38543114193016725, -0.3148984033792121,
    ]);
    const expected = [
      [
        -1.1868847827628568, 1.93432013236129, 2.4928739773875668,
        -0.805927622010536, -1.8646865109206165, -0.5814797118044208,
        -0.9706387284648046, 2.1777800257408413, 1.468282040345746,
        0.9632720229342439, 2.517874125405026, 0.9286097618533744,
        -0.0543376065555235, -0.7715505886682597, -2.453315477673049,
        -0.1432234045728128, 2.706874387737379, 1.221536723041088,
        -0.9600909729977256, -1.3083982057757795, 1.839883230109046,
        2.556878211244073, -0.6620269249762498, -1.8355689693591128,
        -0.6301773816068872, -1.0859611627895538, 2.1454401012413062,
        1.4312428828761656, 0.9825040126549788, 2.508074333647747,
        0.9929963938048166, 0.050748076116472654, -0.7210188809554503,
        -2.451369311442513, -0.3622267096255824, 2.7552367526648625,
        1.179317299740146, -0.7401334621028148, -0.8470560839195438,
        -1.8459709282514287, -0.4179326379023303, 2.8108505208894563,
        1.433660103570019, -1.3928054905714005, -1.1492698948890796,
        -1.1318541757137628, -0.30798809155959467, 2.59829730375969,
        1.6526658466676183, -1.8238139075786726, -1.579592912733438,
        -0.427906405298198, 0.009172913853076078, 2.183590224024439,
        1.7339818943240237, -1.9983020186841023, -2.048679251633792,
        0.15728587486446635, 0.5229753017387829, 1.6680991551463606,
        1.6001277862325551, -1.9362231126619323, -2.4463779787264412,
        0.549097940531224, 1.1713291513365944, 1.1648256948590696,
        1.2182197872086131, -1.705941711454423, -2.6673887198515613,
        0.7224429981632405, 1.8534078876202607, 0.7723148911276322,
        0.6094787205019179, -1.4067644326672366, -2.6361299429095646,
        0.7056916157772747, 2.4516541317608334, 0.5522664258922992,
        -0.1537413995984567, -1.1445185034081922, -2.3250223294188817,
        0.5721781345653679, 2.8573854469570965, 0.5179467481613068,
        -0.9678439509423596, -0.9948011083560853, -1.7826587953414899,
        0.4553964729172293, 2.943759561065002, 0.7046804611473638,
        -1.818696273862816, -0.86580991615504, -1.0803493886567321,
        -1.4516521823584088, -0.5349142770231664, -1.5149086035580275,
      ],
      [
        -0.046011641594824876, 0.0004340322915788332, -0.010228714591276476,
        0.06707201923416799, -0.09142155380775172, 0.09413166409713179,
        -0.07966628282600147, 0.054598939310994736, -0.0024891707920635443,
        0.04233781762648836, -0.013252843920928566, -0.3169276371756476,
        0.1724524728608921, -0.0034130077091930828, -0.04906370480522799,
        0.024182003257055672, 0.024139003437186904, -0.05692454593495417,
        0.05850586128459535, -0.03647421893669513, 0.010937072288624089,
        0.001672564769096924, 0.000541630208372231, -0.006949200349733417,
        0.006563364840734685, 0.0012551265903471861, -0.007702756784868458,
        0.005368582222550569, 0.0031004697912680994, -0.008023376994397365,
        0.0037694213278728636, 0.004796158836914652, -0.007875716176635947,
        0.001947349976619391, 0.006207999669274196, -0.007263206248822244,
        1.1026968029560212e-5, 0.007254105028488412, -0.006221937227311594,
        -0.0019266883377883743, 0.007871284002082176, -0.004813296858229223,
        -0.003749894508486132, 0.00802446088977814, -0.0031206636652800312,
        -0.005352533471407172, 0.007703324515783371, -0.0012435935237853312,
        -0.0066383829161621236, 0.006928002873903966, 0.0007066034384753106,
        -0.007533184227342452, 0.005743201120369759, 0.0026154395915806723,
        -0.007982446024640476, 0.004219810220909348, 0.004369465041907516,
        -0.00796132562037625, 0.002446931377596902, 0.005866026956942386,
        -0.007469394674272566, 0.0005299223736931995, 0.007015770642137942,
        -0.006537352811062153, -0.0014186195808182796, 0.007751943948395409,
        -0.00521858515635027, -0.0032831938092585276, 0.008029860253399851,
        -0.003597281276890215, -0.004998407971291277, 0.007636337379829133,
        -0.0022986766562814688, -0.00718730873184237, 0.010948019905585575,
        -0.009862868306738243, -0.0723197135649968, 0.11978711131994467,
        -0.04858111351876272, -0.003224926693920094, 0.017006094913155655,
        -0.010200366661208582, 0.004215217799260807, -0.00436452670165236,
        0.006093693730790552, -0.0026909128752122618, -0.005075049698117769,
        0.00940354130925565, -0.0049650142527073405, -0.004032841123297522,
        0.007980678152501414, -0.0026911008307513597, -0.0056882873451956995,
        0.007559134654914166, -0.0007825266868971437, -0.006889050918890989,
      ],
      [
        0.0023432251373402776, 0.031665769018396704, -0.00030369109189541633,
        -0.07958461181278594, 0.08717877779947344, -0.07476824617090914,
        0.05812676744298435, -0.04031760501699622, 0.023590119182336604,
        -0.010698519026433177, 0.003078784529292743, 3.184745742353806e-5,
        -0.0006121567030090003, 0.0003740790721745344, -0.000127788908748345,
        2.530113174113246e-5, -1.7131550045846401e-6, -4.135834454953434e-7,
        9.654084797048286e-8, -2.5915685251392987e-8, -1.0926408552041217e-8,
        8.546089553453172e-9, 1.9743843231165377e-8, 1.2569375204044899e-8,
        -6.301239486125378e-9, -1.930831659610468e-8, -1.4348381374046053e-8,
        3.963160705444327e-9, 1.858682589821436e-8, 1.591481939884881e-8,
        -1.566474923317412e-9, -1.7590150142655862e-8, -1.7245652806186655e-8,
        -8.53522110691998e-10, 1.633287544856847e-8, 1.8321065345658608e-8,
        3.2609775039702437e-9, -1.483351994737896e-8, -1.912495369962996e-8,
        -5.620037729394259e-9, 1.3114464126705652e-8, 1.964549393802608e-8,
        7.895733354013183e-9, -1.1201285332132197e-8, -1.987515893731112e-8,
        -1.0054552530993537e-8, 9.122170572059843e-9, 1.9810480034317534e-8,
        1.2064559007101254e-8, -6.907787766479346e-9, -1.9452218999943614e-8,
        -1.3895777403838172e-8, 4.591075959226216e-9, 1.8805740472033773e-8,
        1.5521032902843367e-8, -2.206505001056129e-9, -1.788082058869484e-8,
        -1.6916438571880787e-8, -2.1073863730895237e-10, 1.669110818362039e-8,
        1.806139710281528e-8, 2.625005227203928e-9, -1.5254043442487357e-8,
        -1.8938758375236245e-8, -5.000413106467458e-9, 1.3590926548233857e-8,
        1.953544637573336e-8, 7.301608469498895e-9, -1.1726594439255313e-8,
        -1.9842796392386837e-8, -9.49460908003036e-9, 9.688658275607026e-9,
        1.9856359389326863e-8, 1.1547097367258226e-8, -7.507108774660811e-9,
        -1.957575876558669e-8, -1.3428597751915523e-8, 5.214246924769138e-9,
        1.9005043125441117e-8, 1.5111046922038052e-8, -2.8442348619390614e-9,
        -1.815282277156473e-8, -1.6569591602119827e-8, 4.3220828924926275e-10,
        1.7031853434370687e-8, 1.778282565861615e-8, 1.9862976596417927e-9,
        -1.5658583275206964e-8, -1.8732713957056506e-8, -4.375504422057377e-9,
        1.405321977389775e-8, 1.94049893827792e-8, 6.699833980797514e-9,
        -1.2239684129466595e-8, -1.9789740270678034e-8, -8.924787305830117e-9,
        1.0244981344451537e-8, 1.9881466607666175e-8, 1.1017591336315029e-8,
        -8.098544420994098e-9, -1.967877917056635e-8, -1.2947331613092863e-8,
        5.831999082927751e-9, 1.918448420540558e-8, 1.4685235532339013e-8,
        -3.47903430096488e-9, -1.8405907894741922e-8, -1.620546998030509e-8,
        1.0746753867962019e-9, 1.7354785598489575e-8, 1.7485690530196024e-8,
        1.3455607103967228e-9, -1.6046701163995245e-8, -1.850703686409032e-8,
        -3.746001656679166e-9, 1.450082635631345e-8, 1.92542162179912e-8,
        6.091007179191713e-9, -1.2740034587001351e-8, -1.9716045766163437e-8,
        -8.34565513975372e-9, 1.0790603781972025e-8, 1.9885824651104754e-8,
        1.0476610949067773e-8, -8.681452184033246e-9, -1.9761181365802562e-8,
        -1.2452511791178814e-8, 7.99612733021584e-6, 0.00034842659249006795,
        0.0006459036402830805, -0.001361136613098366, 0.0003944839507579529,
        5.7088724480248044e-5, -0.0002647724354943684, 0.0003825532614582854,
        -0.00039203664093273187, 0.0002833689231050526, -0.00012745503239902742,
        1.4253235093206005e-5, 2.59863535885192e-5, -2.1584917853186805e-5,
        8.548119913372145e-6, -1.656777682473362e-6, 3.1425071004612293e-9,
        8.364356625192317e-8, -3.269327086342776e-8, -1.7401228547547827e-8,
        -1.8499070281760925e-9, 1.5672191581976695e-8,
      ],
    ];
    const result = wavedec(data, "db22");

    const reconstruction = waverec(result, "db22", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db23", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4918794532179686, 0.9076878883490864, 1.1873383286708177,
      1.298920938045179, 1.2442459465489772, 1.056509424139593,
      0.7907828788574165, 0.5097734827190595, 0.2684334199729972,
      0.10123559988103731, 0.015222387726947506, -0.009546047519765663,
      -0.01239552693711024, -0.0393523186792793, -0.12871044713612378,
      -0.2986340023117164, -0.540063009255479, -0.8168525755405989,
      -1.0732454024682219, -1.2469146219764875, -1.2843834882922107,
      -1.1549895774119379, -0.8598758689311135, -0.43368409016026765,
      0.06159712049675402, 0.5492552056114697, 0.9539843604063041,
      1.2176972732518627, 1.3112687259599543, 1.2394606424054428,
      1.0379506211284286, 0.7633173477147647, 0.47854796831489915,
      0.23770107336633345, 0.07352133053587312, -0.008979362143923753,
      -0.031486647299957954, -0.034297438184658136, -0.06336665284938064,
      -0.1558974400486285, -0.3282510120831935, -0.569365802624835,
      -0.8414837886544704, -1.0881322362044756, -1.2474642131229208,
      -1.2676826844367683, -1.1207068608107122, -0.8106296610142962,
      -0.3747675608085947, 0.12309021265402237, 0.6057142709254548,
      0.9986864608545878, 1.246013909744567, 1.3214042409245559,
      1.2325647698584596, 1.0175984593162228, 0.7345010907565583,
      0.4464389173233941, 0.20648979865122036, 0.045616588456107166,
      -0.03320895603508933, -0.053385611340547034, -0.05611914611207919,
      -0.08722188840586753, -0.18274874870818453, -0.3572337577856717,
      -0.5976329086600667, -0.8646363984929413, -1.1011467927359202,
      -1.245895869961498, -1.2488484834677311, -1.0845492637055683,
      -0.7600330194757707, -0.3152295107322961, 0.18437542406785076,
      0.6611611051684017, 1.0417180344122317, 1.2722391674706,
      1.3293086095717723, 1.2235679870316343, 0.9954855037991874,
      0.7043816019639891, 0.4135003987643825, 0.17485336895895537,
      0.017570753801676164, -0.057422301468876696, -0.07520233007990361,
      -0.07782028276628014, -0.11087487794814971, -0.20921722957659783,
      -0.38553275154843286, -0.6248172462439792, -0.8862728801816515,
      -1.112269162577371, -1.2422143426528793, -1.227914438091935,
      -1.0465790125674777, -0.7081719525999737, -0.2551706179399866,
      0.2453492539073745, 0.7155018586755801, 1.083005724641745,
      1.296327491519012, 1.3349667310762723, 1.2124835367837012,
      0.9716473667743083, 0.6730086822538821, 0.3797880082137305,
      0.14284640170958968, -0.010566449668965028, -0.08157526815780264,
      -0.09689632007961793, -0.09936072638305171, -0.1342829061649657,
      -0.2352565081612813, -0.41309979371259903, -0.6508736858560136,
      -0.9063583645573895, -1.1214826896494543, -1.2364279700673961,
      -1.2049176371297148, -1.0068613683569423, -0.655134575704416,
      -0.19469242240186008, 0.3059087279570307, 0.7686445351714156,
      1.122479099130864, 1.318236921862165, 1.3383673055641885,
      1.1993282275100101, 0.9461226501517848, 0.6404343570018325,
      0.345358773832103, 0.11052426429407897, -0.038745042558477605,
      -0.1056237679450521, -0.11842729845405317, -0.12070067493209918,
      -0.15740376661380934, -0.2608210601872919, -0.4398880550145634,
      -0.6757591246168559, -0.9248606944000357, -1.1287739959602714,
      -1.2285486622054116, -1.17989863994681, -0.965464514292909,
      -0.6010109612485304, -0.1338971541430956, 0.36595157276687107,
      0.8204991477212965, 1.1600707697630221, 1.3379291664149453,
      1.3395028560823028, 1.1841224078486903, 0.9189528829863796,
      0.6067127896268618, 0.31027105976509084, 0.07794297828450636,
      -0.06691487838873833, -0.1295238347718405, -0.13975525697176275,
      -0.14180071904214273, -0.18019583748376522, -0.2858662911259932,
      -0.4658521562317322, -0.699432557705963, -0.9417504759263946,
      -1.1341330006539947, -1.2185918765512773, -1.1529014050383195,
      -0.9224594387267073, -0.5458929856807471, -0.07288756019997278,
      0.42537638861612526, 0.8709778713081924, 1.1957165078716772,
      1.3553696679101426, 1.3383697440850377, 1.1668899353292042,
      0.8901824538292884, 0.571900191381534, 0.2745844670783473,
      0.04515912233814967, -0.0950257326007195, -0.15323170452722923,
      -0.1608405356934321, -0.1626219141733093, -0.20261815620626622,
      -0.3103486139415255, -0.4909482451550327, -0.7218551460334289,
      -0.9570011254633224, -1.137552933399994, -1.2065765884066635,
      -1.123973212890292, -0.8779198133224315, -0.4898741732848094,
      -0.011766730731788813, 0.48408282099717337, 0.919995191774897,
      1.2293553540815747, 1.3705276644732578, 1.3349681784082914,
      1.1476581390113254, 0.8598585381106668, 0.5360547274978312,
      0.23835973239628366, 0.01222973396366217, -0.12302739183867772,
      -0.1767038946363802, -0.18164389601190423, -0.18312585190561453,
      -0.22463049278054575, -0.33422552491958285, -0.5151340707573882,
      -0.7429902800543529, -0.9705889112261438, -1.1390303421058583,
      -1.1925252552592673, -1.0931645832541244, -0.8319218667527501,
      -0.43304953729060747, 0.049362075416601967, 0.5419717303293081,
      0.9674680508791651, 1.2609297226489122, 1.3833762437906878,
      1.3293022177103522, 1.1264577761730674, 0.8280310206719991,
      0.4992364198458964, 0.20165862441675575, -0.02078778968009809,
      -0.15086974336027206, -0.19989728324315612, -0.20212659296085572,
      -0.20327473021390846, -0.24619342168297187, -0.3574556774466463,
      -0.5383690544326261, -0.7628036396206913, -0.982492990136832,
      -1.1385650949473196, -1.1764637752530704, -1.0605291869784443,
      -0.7845442541270947, -0.3755154185201875, 0.11039560540606647,
      0.5989453596151219, 1.0133159872152264, 1.2903855001216842,
      1.393892390776018, 1.3213797663711626, 1.1033229831159126,
    ]);
    const expected = [
      [
        -0.4387472350024154, 1.0834935903359935, 2.755276364689906,
        0.026157413393349514, -2.441189713800592, -0.8403475062020758,
        -0.623415019494965, 0.8206745412854938, 2.4376118572303795,
        0.5489647056355011, 2.0585153604061492, 1.8409608869326402,
        0.42112306329129645, 0.19922735467916158, -1.8664745487605323,
        -2.3448375071863756, 1.1927179424915701, 2.1805681477282683,
        0.6286589475592396, 0.04594638714499741, -0.4541392224918619,
        1.2693205876825626, 2.7165785137682175, -0.14546778857376816,
        -2.443441227497188, -0.6589681542169551, -0.8573421015899471,
        1.1572490082946798, 2.2072725471171024, 0.5834177336900019,
        2.1814147546776463, 1.69775212404707, 0.46696124783351556,
        0.2062273138251889, -2.0421996674413587, -2.2234223302400022,
        1.3504654729666343, 2.069214962626329, 0.5468366076645914,
        0.35307935759827097, -1.4658156593383989, -2.6335096033952374,
        0.5933786714973285, 2.3315659428586484, 0.7625731392141873,
        0.3717853788335375, -0.8873095778228114, -2.759473648451201,
        -0.271061813434146, 2.3930960890840534, 1.1090744253333022,
        0.32883061270461506, -0.39507856771508454, -2.608952767509247,
        -1.1303006165014897, 2.2003716019559683, 1.5405934855522652,
        0.3029958383853077, -0.04705294702610095, -2.2344243090397313,
        -1.8705609276859294, 1.7425542206768876, 1.9791489551540031,
        0.3655767076500748, 0.1395085378291303, -1.7211771400029106,
        -2.397900045158927, 1.0559942896650014, 2.3304394596287645,
        0.5623596113977397, 0.18916132762313495, -1.1689878957917679,
        -2.655304118552989, 0.2192310142717218, 2.5038732408611875,
        0.9013004722217046, 0.16022540635832255, -0.6713928915221392,
        -2.632322511797846, -0.6606827531877033, 2.432528231475518,
        1.348558939694075, 0.12918804199709993, -0.2954961323389425,
        -2.3703471811176904, -1.4547685030996984, 2.0612248325039806,
        1.8845181719808697, 0.08740718070819714, 0.05957735317849235,
        -2.1385647967997747, -1.7862810036776042, 1.0933783477101033,
        2.371032157984034, 2.670709207532628, 2.480487961273529,
        3.03612603191793,
      ],
      [
        0.018022800054428523, 0.00992242150517463, -0.0019729233065588704,
        -0.01820842671325503, 0.010403118712745529, 0.0055491247831954945,
        -0.017248045110846332, 0.013543642102011096, -0.02170607781494731,
        -0.05789506473854977, -0.07868333805875993, 0.07349391330617432,
        0.27455660761757633, -0.3214108482030413, 0.2671195737188845,
        -0.22701929360054007, 0.2001031438658239, -0.16505586168648234,
        0.11494034614974363, -0.06050973927063665, 0.019057415230604034,
        -0.0004375789583685538, 0.00039309131584678447, -0.005471804281095369,
        0.004772439679355336, 0.0019354091041164873, -0.006824164714726756,
        0.004081463891125324, 0.0032775866594125565, -0.006909039497668651,
        0.002686091832853892, 0.004590588186727601, -0.006648234516209985,
        0.0011476161895022984, 0.005657673268636923, -0.006030892151357266,
        -0.0004523472614574457, 0.006421351974696535, -0.0050899558238540485,
        -0.0020281094586802025, 0.0068404189263067275, -0.0038760116643554335,
        -0.0034950116799243145, 0.006892627951752308, -0.0024540572811857734,
        -0.004774457333781755, 0.00657494384389868, -0.0009005263337820349,
        -0.005797729636502666, 0.005904639737047979, 0.00070140408041142,
        -0.006509984843777289, 0.004917453123786768, 0.002265609725941366,
        -0.006872983416649002, 0.003666558448310295, 0.003708372110262691,
        -0.006867254642274032, 0.0022188619489335124, 0.004952079046775097,
        -0.006493127283214708, 0.0006522178003328622, 0.005930228665029605,
        -0.005770626481352107, -0.0009494982603997387, 0.006590116778370814,
        -0.0047385750825023965, -0.002499851054144219, 0.0069019609825007,
        -0.003425073935507413, -0.0040259884387232985, 0.004863493550828245,
        -0.012624844396666623, -0.03828281878900008, -0.05225939933111822,
        0.051534947655796554, 0.23174062531780637, -0.180616928998362,
        -0.06504120471817372, -0.10868323053500062, 0.28554196594575276,
        -0.21625678241973376, 0.18219775722055348, -0.13009997530529618,
        0.07888872385843125, -0.03475669431006765, 0.005304785089572646,
        0.005240533929586927, -0.0014755341616748561, -0.005117861342842822,
        0.005071170264654477, 0.0015091882124012629, -0.006732370510184113,
        0.004410167033585809, 0.0029053424803385654, -0.006916185822494746,
        0.0030644009298782557,
      ],
      [
        0.00168669948860941, 0.02638662757790106, 0.012020703752072762,
        -0.085604424484958, 0.08323784087338654, -0.06819456716285077,
        0.054680745688853255, -0.04199320545510713, 0.02902113021201029,
        -0.016945433832315913, 0.007786650150120474, -0.002456241106591483,
        0.00025690454412167737, 0.00023840345551616191, -0.00017088024814426297,
        6.008152164784859e-5, -1.2098563109528533e-5, 9.522290972527193e-7,
        1.3572383675560209e-7, -4.483187044375021e-8, 8.13913268596787e-9,
        9.969196584196013e-9, 4.742556496647904e-9, -4.79990225142233e-9,
        -9.860442395218136e-9, -5.713780532011048e-9, 3.76813359290051e-9,
        9.731542421074832e-9, 6.6081041868340256e-9, -2.685662707622518e-9,
        -9.471692257702521e-9, -7.413513366250334e-9, 1.5670471162052199e-9,
        9.08437634654949e-9, 8.11915873186157e-9, -4.273330191728282e-10,
        -8.574799862458495e-9, -8.715534781715575e-9, -7.181223691699161e-10,
        7.949829099088793e-9, 9.194613628182816e-9, 1.8539119465354957e-9,
        -7.217890809778077e-9, -9.549973403387628e-9, -2.9647534923561584e-9,
        6.388811918890675e-9, 9.776821314608481e-9, 4.035711350839601e-9,
        -5.473747383425968e-9, -9.872084038117941e-9, -5.052345947324465e-9,
        4.485023045157179e-9, 9.834490990677866e-9, 6.000986635280679e-9,
        -3.4359582035933996e-9, -9.664567540134835e-9, -6.868873112050687e-9,
        2.340641000427373e-9, 9.364584356203026e-9, 7.644334005504245e-9,
        -1.213824040474867e-9, -8.938570160736153e-9, -8.31691061244367e-9,
        7.067408167624794e-11, 8.39226566357711e-9, 8.877566567872779e-9,
        1.0734168360496794e-9, -7.733037143906647e-9, -9.318753357255231e-9,
        -2.2030678258402356e-9, 6.969734643473296e-9, 9.634545252404744e-9,
        3.3030830123933347e-9, -6.112626785600272e-9, -9.820666753579155e-9,
        -4.358642692120019e-9, 5.1732671191362215e-9, 9.874626722062294e-9,
        5.355537768790449e-9, -4.164305861283027e-9, -9.795716987516319e-9,
        -6.2803694820729755e-9, 3.0992934232620052e-9, 9.584982024446207e-9,
        7.120684320060602e-9, -1.9925602002617258e-9, -9.245251131554237e-9,
        -7.865166371555144e-9, 8.590245068942258e-10, 8.781099236038381e-9,
        8.50380871675187e-9, 2.8606942537634634e-10, -8.198780144762702e-9,
        -9.028009921472993e-9, -1.4273170328083175e-9, 7.506139463007521e-9,
        9.430730752350493e-9, 2.549365923790919e-9, -6.712470942950076e-9,
        -9.706524710727544e-9, -3.6371006605870594e-9, 5.8284760688037225e-9,
        9.851698470650101e-9, 4.675876039749306e-9, -4.86605427578477e-9,
        -9.864302365468222e-9, -5.6517387416083554e-9, 3.838143916320759e-9,
        9.744161666707014e-9, 6.551554189940447e-9, -2.758569272092494e-9,
        -9.492870044865293e-9, -7.363189350101661e-9, 1.6418815614004828e-9,
        9.113838974611774e-9, 8.075734389360532e-9, -5.031055864415768e-10,
        -8.612166850630599e-9, -8.679609572288965e-9, -6.424463906520775e-10,
        7.994602205170203e-9, 9.166684419543407e-9, 1.7793609076454631e-9,
        -7.269445110379153e-9, -9.530388927674709e-9, -2.8923223920101534e-9,
        6.446455414158604e-9, 9.765843993016453e-9, 0.0010630455869496914,
        0.016785812033204308, 0.007864488536324014, -0.05500370201230403,
        0.053674149320729725, -0.04415622360065288, 0.035530734020386326,
        -0.02733434236016416, 0.01887528390225813, -0.010976459911542424,
        0.004998662418186033, -0.0015439826446867445, 0.00013907376563635805,
        0.00016394865456924494, -0.00011207630223798262, 3.8535051758887516e-5,
        -7.58239668264545e-6, 5.57911892756552e-7, 8.821278308668436e-8,
        -2.7552143477098607e-8, 8.83145697978619e-9, 9.555613998602226e-9,
      ],
    ];
    const result = wavedec(data, "db23");

    const reconstruction = waverec(result, "db23", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db23_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5049721934255109, 0.9309574795601614, 1.215385044840244,
      1.3246477916475556, 1.2598632749678496, 1.0545939469470713,
      0.7652372163789753, 0.4565728800388732, 0.18610484326172716,
      -0.008927223745754831, -0.118717802950603, -0.16060563520752766,
      -0.17158933344504204, -0.1957406424654472, -0.26989587777885543,
      -0.41143313409948185, -0.611402084504858, -0.8349011057397674,
      -1.0287383707272184, -1.1345370862119308, -1.1040231004732197,
      -0.9126253314751318, -0.5678821429611048, -0.11039344184679098,
      0.393119034690678, 0.86313469211065, 1.223946777410627,
      1.4196427505319118, 1.4256657159469714, 1.2532374466731429,
      0.9456583189074215, 0.5674718402912966, 0.18920256341014524,
      -0.1285797061937894, -0.34800592338400255, -0.46044708734136297,
      -0.48541846260285265, -0.46235147061377724, -0.43752530939925344,
      -0.4496503035604168, -0.5179063671804879, -0.6355867637038246,
      -0.7710455938970722, -0.8757635137664948, -0.8975050013349914,
      -0.7952065489070081, -0.5517461377474103, -0.1812264337232295,
      0.27125981033014446, 0.7375550600929139, 1.1403078203103543,
      1.4095452251482978, 1.4980000385830714, 1.3915138618384069,
      1.1120159756874994, 0.7123727814151426, 0.2643717554575604,
      -0.1572414315450648, -0.4908226846525856, -0.7001571968014912,
      -0.7801910222827668, -0.7549677764830468, -0.6685201928751904,
      -0.5712109006318897, -0.5051227283994519, -0.4922919224729638,
      -0.5288127679122112, -0.5863141982888842, -0.6204041607813013,
      -0.5838761807422679, -0.44122911824245525, -0.18068002075139244,
      0.17955299391489438, 0.5925028657396885, 0.9911601367321844,
      1.3026714692585761, 1.4646612441273814, 1.4397301487396632,
      1.2245842494927215, 0.8515284912914219, 0.381904220776941,
      -0.10699563806467915, -0.5384218607913651, -0.852151023989886,
      -1.0161856009586465, -1.0314839964298392, -0.9287683819544893,
      -0.7584158661456761, -0.576130299452283, -0.4280976874355671,
      -0.33939988511848274, -0.3085850869449208, -0.3096929195908241,
      -0.30111107348377253, -0.23888347411116106, -0.09093954992864645,
      0.1515396321136876, 0.46869463798398836, 0.8140833099516336,
      1.1239768936414654, 1.3316961417435724, 1.3835167296466735,
      1.2522225927724095, 0.9449112585651198, 0.5030299724715137,
      -0.005493791031561876, -0.5002359957254817, -0.9050899547370893,
      -1.1639398780062078, -1.251512748311705, -1.1769198906548528,
      -0.9791984627608699, -0.7161205860897916, -0.4491677219381159,
      -0.22846656924489084, -0.08142984100372552, -0.007858390731368792,
      0.017408774631442123, 0.03514184296320963, 0.08821783172733783,
      0.20757596127331096, 0.40137483801562984, 0.6502800120395631,
      0.9102477159316318, 1.122253278277632, 1.2266230661172683,
      1.1784178842517221, 0.9599904116089544, 0.5874851946775026,
      0.1095097685708339, -0.4018814453402139, -0.8658577318016708,
      -1.2097058089712762, -1.3839576726331777, -1.3721863415974362,
      -1.1932022003400427, -0.8952354250305471, -0.5436368988605591,
      -0.2051884662837406, 0.06710179409642081, 0.24502410998920157,
      0.3294127712302098, 0.3467494453555813, 0.3391972741216357,
      0.3507918602381009, 0.41347030937517015, 0.5366384256925114,
      0.7030557542176271, 0.8721909765249752, 0.9902762306996369,
      1.004553047543597, 0.8780929150839378, 0.6013736863569848,
      0.19755365592218976, -0.2800783994417258, -0.7580678422093634,
      -1.1579192694997722, -1.4128297867587785, -1.4820517562467368,
      -1.3594598928389363, -1.074295534469139, -0.6839574487686878,
      -0.2606338217884563, 0.12495263047789967, 0.4187500045845927,
      0.5939069570565154, 0.6542050916917197, 0.629766944706315,
      0.56634770644267, 0.5111105186372877, 0.4986364694290839,
      0.5408204744557814, 0.6232809604026126, 0.7092240435451059,
      0.7497775355937701, 0.698132152795238, 0.5238203724792335,
      0.2233830108560486, -0.17545689306215645, -0.6173888620203212,
      -1.0302147109281006, -1.3401991527045949, -1.4884246573344884,
      -1.4442093341838742, -1.2123266376029014, -0.8322542209408865,
      -0.3696085568910333, 0.098185715052054, 0.4985559982881454,
      0.778797369861063, 0.9159108819217006, 0.9190405342200518,
      0.8241329288235211, 0.682369187509558, 0.5454419107974456,
      0.45149247262391906, 0.4153034549095054, 0.4252165358713548,
      0.4475029648099373, 0.43699189901928515, 0.35114579730701334,
      0.16386929084220797, -0.12462300280087735, -0.48458121004049176,
      -0.8611742455366901, -1.1857198926004235, -1.3910585559778306,
      -1.4273548088546757, -1.2744470599117093, -0.9476665249772135,
      -0.49561641609808416, 0.009647027951160986, 0.4877417166929431,
      0.8668175303645036, 1.0981593805354959, 1.165122189555834,
      1.0843929293430103, 0.8994682820864195, 0.6681434008624846,
      0.4472538264774925, 0.27854088447129255, 0.1791679348205742,
      0.13919075659651745, 0.12649037037197086, 0.0977633151027898,
      0.012614336980303398, -0.15300047379160397, -0.3975751752408452,
      -0.6916232991688676, -0.9828199983111797, -1.2075887176860776,
      -1.306341734593836, -1.2386115511987459, -0.9942749219392166,
      -0.5979864494136875, -0.10557980739993093, 0.40684443691359296,
      0.8586314905996496, 1.181391547625043, 1.332957299819257,
      1.3052123210023325, 1.1240247179492757, 0.8414500584376743,
      0.5222458407445552, 0.22810106613224324, 0.00349287199140913,
      -0.13338496246342765, -0.19249851391092865, -0.20637421886415255,
      -0.21864150599276572, -0.26981503315008953, -0.3841028186442402,
      -0.5607527669690036, -0.7722833425688874,
    ]);
    const expected = [
      [
        -1.3342006492599925, 0.4666230072809747, 2.945833464677495,
        0.6717153606947206, -2.0663008871580852, -0.9463657398841079,
        -0.9390386646719598, 0.6579809448265206, 2.4541681462745752,
        0.5581685911197929, 2.1189569301176547, 1.843053380432813,
        0.211742281376308, -0.13772193744136624, -1.9230568996209014,
        -1.8884527209060828, 1.870823732582211, 2.2116454493158955,
        -0.036417780410513016, -0.7586200359423038, -1.4036411257298844,
        0.6764495346240166, 2.9340592494470292, 0.4986935593277725,
        -2.0905601136703664, -0.7730584244963581, -1.174489485229908,
        1.010795907400576, 2.218249529841923, 0.5932041949349609,
        2.246414036009147, 1.6953039752322463, 0.24526578001456878,
        -0.12623572956256243, -2.0957400159589477, -1.7251421715346895,
        1.9919000774386284, 2.1095351455307045, -0.16783128476252496,
        -0.5306511546339089, -1.6403248487251039, -1.6767953331162515,
        1.8431075881538095, 2.4886886401291126, -0.40861646460073975,
        -1.0560595442255856, -1.2278689080549285, -1.4316210794002726,
        1.5792609438269476, 2.745596372418857, -0.4660342238316267,
        -1.6302019274154653, -0.9293368927271871, -1.0009489092705548,
        1.2773565954727304, 2.8216944930323606, -0.3650785215041245,
        -2.168877889486487, -0.7902816025341628, -0.4305641439090085,
        1.0188667246741934, 2.689280376133678, -0.1616864572257214,
        -2.5917383101526386, -0.8222756235897128, 0.2076406240603203,
        0.8739465431968653, 2.3569361167520575, 0.0683191642973613,
        -2.8373743185969906, -1.0008620925613942, 0.8289880731911042,
        0.8878323104266804, 1.868067933875735, 0.2440839545449425,
        -2.8748268974114066, -1.2704136702658617, 1.3517749909871293,
        1.072029795741645, 1.2928344392574793, 0.29550420200912414,
        -2.7090815097530485, -1.5559715753513383, 1.7154592867222331,
        1.394855847854986, 0.7291241937875307, 0.15275591391503035,
        -2.3427080074486226, -1.8315219811793562, 1.9689144285591613,
        1.6683925987267318, 0.491835438360038, -0.6250811452338028,
        -1.279157514306866, -0.379230522976224, -1.200698992494723,
        -0.8576575787189241,
      ],
      [
        0.017808643442132448, -0.001828313760990153, -0.0073229967572698415,
        0.019659292125537527, -0.026063649307582454, 0.03523083939151841,
        -0.041012740556090006, 0.031676174614031036, -0.034658796125396955,
        -0.05206155040417348, -0.08456224696890235, 0.07689241527142213,
        0.2820165614678742, -0.330660370223737, 0.2749139923011854,
        -0.23357092533798615, 0.2057753607277556, -0.16971117728894514,
        0.11823804199713162, -0.06232555518746761, 0.0196673282521559,
        -0.00040087666885076876, 0.0002729723910978728, -0.005573138946553117,
        0.0050380725167163375, 0.0017869790685052132, -0.006985485118587578,
        0.004423058295616662, 0.0031114364187681473, -0.007129680015667524,
        0.0030941575377497494, 0.004436830191137471, -0.0069555327493685095,
        0.0016166670131719477, 0.0055483509991803015, -0.006445615370949272,
        6.148860520208516e-5, 0.0063922600527525275, -0.005624736971049905,
        -0.001497000241169951, 0.006927451114942427, -0.00453219680680673,
        -0.0029828896238629997, 0.007128434084169178, -0.0032210824619097276,
        -0.004325144214960971, 0.006985196680239134, -0.001754295306871008,
        -0.005458293693191057, 0.006504932129114695, -0.00020304539906221432,
        -0.006328322561164279, 0.005710574715076692, 0.0013582314760594602,
        -0.006892563400700966, 0.004640679921285766, 0.0028537103606967695,
        -0.007124447315341894, 0.0033467090599844443, 0.00421169911529125,
        -0.007012125436945658, 0.0018912647491753562, 0.005366135837258089,
        -0.006561664636161765, 0.0003444867419619332, 0.006261836406235312,
        -0.005794170412348971, -0.0012190770387230747, 0.006847274118559062,
        -0.004854235317907124, -0.0034762921519073584, 0.004011089366887162,
        -0.012063267994365625, -0.02552253728971413, -0.059350855234146765,
        -0.10085974901379273, 0.1318681928773953, -0.04600848819196353,
        -0.061520169726109006, 0.12459749774036231, 0.09876683891008396,
        -0.12091268783427586, 0.1252449094495032, -0.08728038367965386,
        0.045152222008054174, -0.008736004041499873, -0.010958597410374174,
        0.012108476513812824, -0.0026227205690896468, -0.005205192066970538,
        0.004067020160065393, 0.0030371432305019964, -0.007129836113710953,
        0.003247564772271182, 0.00429946314591673, -0.006991951511518014,
        0.0017863530822521667,
      ],
      [
        0.0017318381571618617, 0.027099774144437403, 0.012354073400692075,
        -0.08793918496465644, 0.0855151093415346, -0.07006655477999435,
        0.056185832805732874, -0.0431506462992086, 0.029820728975803998,
        -0.017411117107184786, 0.007999326488924176, -0.002522293917930383,
        0.00026305491774654297, 0.0002453110407583069, -0.00017564588931542595,
        6.172539223182735e-5, -1.2422334617010345e-5, 9.75875029249117e-7,
        1.395233996330475e-7, -4.5891656089447646e-8, 8.639910721691033e-9,
        1.0374576174928722e-8, 4.697289415675857e-9, -5.266461967562723e-9,
        -1.0294814524651151e-8, -5.675514443136812e-9, 4.262514103418521e-9,
        1.0205969638614873e-8, 6.5850203975497485e-9, -3.2070047840649152e-9,
        -9.993627405359107e-9, -7.41484207616372e-9, 2.1126763393905193e-9,
        9.660337859185847e-9, 8.154945408902705e-9, -9.92747275337368e-10,
        -9.210097376286235e-9, -8.796327485601196e-9, -1.3919957564629e-10,
        8.648368358381818e-9, 9.331216378189149e-9, 1.2694261404088164e-9,
        -7.981990137789445e-9, -9.753180833261905e-9, -2.3842914155138285e-9,
        7.21901803768454e-9, 1.0057120240902929e-8, 3.470328791146137e-9,
        -6.368643180135094e-9, -1.0239324351973137e-8, -4.514362249331878e-9,
        5.441166249334984e-9, 1.0297566215877192e-8, 5.503726450163137e-9,
        -4.447860433866707e-9, -1.023118606779434e-8, -6.426473835322887e-9,
        3.400736928365038e-9, 1.004099958401086e-8, 7.271467797401919e-9,
        -2.3124267744247946e-9, -9.729268480574406e-9, -8.028454898993761e-9,
        1.1961113683094449e-9, 9.299753152995274e-9, 8.688241912672512e-9,
        -6.533999581807075e-11, -8.757684140842987e-9, -9.242866651260953e-9,
        -1.066199798055006e-9, 8.109643185966904e-9, 9.68564056813349e-9,
        2.1848598892468036e-9, -7.36344398124269e-9, -1.0011200452113906e-8,
        -3.277093899286056e-9, 6.528091454701513e-9, 1.0215556007790745e-8,
        4.3296441347218405e-9, -5.6137378464941735e-9, -1.0296257910526482e-8,
        -5.3297689657704585e-9, 4.631456383035105e-9, 1.0252371573840397e-8,
        6.265404071776308e-9, -3.5931202542354242e-9, -1.0084402617505829e-8,
        -7.12521966190077e-9, 2.5112575878526715e-9, 9.794352816151658e-9,
        7.89879108187696e-9, -1.3990086860898683e-9, -9.385740479975716e-9,
        -8.576727277997577e-9, 2.698614203081364e-10, 8.86355246051843e-9,
        9.150872635380463e-9, 8.625565827070006e-10, -8.234097581447476e-9,
        -9.614289563280135e-9, -1.984569637173718e-9, 7.504964746923809e-9,
        9.961320052779665e-9, 3.0825577590910117e-9, -6.684968166121435e-9,
        -1.0187755807138438e-8, -4.143211201658791e-9, 5.784093519742275e-9,
        1.0290901471581127e-8, 5.153707416680474e-9, -4.813224885731236e-9,
        -1.0269516412459784e-8, -6.101863864641566e-9, 3.784073381789428e-9,
        1.0123815411731348e-8, 6.9761680718228805e-9, -2.709108020244258e-9,
        -9.8555623036805e-9, -7.766000904260531e-9, 1.601371862027272e-9,
        9.468026744647238e-9, 8.46183296034398e-9, -4.742668303604851e-10,
        -8.965933176645534e-9, -9.055281739108105e-9, -6.585917088070966e-10,
        8.35529689216495e-9, -5.3798930568165564e-5, -0.003742462598736461,
        -0.01667383689833629, 0.024592796280251773, 0.0007319520478795888,
        -0.011584693744108612, 0.011832321192572883, -0.007449718446737423,
        0.0023515581050628496, 0.0011772340627400832, -0.0024615848083752055,
        0.0021219459304690548, -0.0012240840019529173, 0.0004990361169940553,
        -0.00013558706020438735, 1.756173934201469e-5, 2.970144745619044e-6,
        -1.9862380669941286e-6, 4.0714644533336407e-7, -3.8300836027593555e-8,
        4.5463915501508725e-9, 1.0603970280435536e-8, 5.011671654317393e-9,
      ],
    ];
    const result = wavedec(data, "db23");

    const reconstruction = waverec(result, "db23", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db24", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4970282894217892, 0.9179932207502086, 1.202390904238483,
      1.317231276455721, 1.262651577447842, 1.0699798004422008,
      0.7928506548747092, 0.4936320247210796, 0.2285166507220871,
      0.034906621034509755, -0.07589598537528325, -0.11902626918266573,
      -0.1295025617715719, -0.15057864605920068, -0.22006242036762524,
      -0.3581605780781248, -0.5600220872327683, -0.7949760119425051,
      -1.0127817038205484, -1.1554451227909908, -1.1717393889435619,
      -1.0308509604528369, -0.7317343194481467, -0.30576171236741534,
      0.1881423550280043, 0.6748796430507953, 1.078487748035491,
      1.3378377376437902, 1.4190699255276205, 1.321891970513739,
      1.078330679288218, 0.7443321575943596, 0.386305551907309,
      0.06589036708171386, -0.17339039262926415, -0.3144393229059334,
      -0.3679786284479324, -0.36687561087259424, -0.3549950352830539,
      -0.3735179182672288, -0.4482761963546094, -0.5813797187701613,
      -0.7493245754165161, -0.9081387571033145, -1.004345680951814,
      -0.9890466508100295, -0.8316059762575776, -0.5294710792349405,
      -0.11156584659370655, 0.3657604576634753, 0.8294404732560783,
      1.2046374129722837, 1.4304713654365453, 1.4728457910337034,
      1.3313722637416514, 1.0387930367978715, 0.6530881757072537,
      0.24419236758144386, -0.12148619792452653, -0.395063174714082,
      -0.554415177956487, -0.6065779206542707, -0.5829212163293361,
      -0.5284917251264449, -0.48833452891285206, -0.4943226348098496,
      -0.5558649015385119, -0.6568688173150963, -0.7597515341182919,
      -0.8155118340840768, -0.7773371849086914, -0.6143042838874782,
      -0.32166620191595285, 0.07497673199175714, 0.5228466385339408,
      0.9519306001504377, 1.2894611262568585, 1.4755666744190976,
      1.4764043323644358, 1.291660460884102, 0.9546348336948116,
      0.524887168379138, 0.07519350470694869, -0.3240960422272178,
      -0.6196129840706146, -0.7850537823126373, -0.8245217037290624,
      -0.7685172523624182, -0.6637617439954067, -0.5595292759300375,
      -0.4939853304962789, -0.4839860842091263, -0.5208948601200318,
      -0.5734443326046681, -0.5968930063225333, -0.5461319006431424,
      -0.3893858682235575, -0.11897432602868457, 0.2437053198620775,
      0.6504012776904328, 1.0350963861739184, 1.3279196135534996,
      1.470623947026656, 1.4299489301865487, 1.2056550743105832,
      0.8312693738629633, 0.3673130434465726, -0.11142633069883778,
      -0.5316011711515304, -0.8363167920749461, -0.9959715954680002,
      -1.01247725933934, -0.9160290341610255, -0.7554032929094416,
      -0.5843145937976684, -0.44728876996889694, -0.36857828055943764,
      -0.3468474489568586, -0.3568875240163849, -0.3578479586069971,
      -0.3058288816620811, -0.16757562527803455, 0.06827773171442414,
      0.38537891258089896, 0.7408752580554397, 1.0735681173876028,
      1.3171637475762752, 1.4154914841185362, 1.3360295650183311,
      1.078440599424456, 0.6759872452055561, 0.18939152882802665,
      -0.305492890124019, -0.7333467268814811, -1.0347475102552175,
      -1.1776726065628704, -1.162530182056973, -1.0196749296521281,
      -0.8001776925341272, -0.5622311813400072, -0.35659526867562374,
      -0.21466785644100872, -0.1420698846785708, -0.11923020369123243,
      -0.10869496018841901, -0.0672014271289526, 0.04063689472635151,
      0.23059450478099486, 0.49212914342283687, 0.7885418908490318,
      1.0641259626588804, 1.2566767185267953, 1.31237447524662,
      1.199417813148532, 0.917037032347068, 0.49759716460054326,
      0.0011464415122061028, -0.4964209048042133, -0.9188808142765478,
      -1.2052801671273685, -1.322006789016235, -1.2685642125731191,
      -1.0758019364209355, -0.7971620759403686, -0.4951674629397896,
      -0.2264898474472592, -0.029230564277320903, 0.08454846476369038,
      0.12933903249914808, 0.1397845284000277, 0.15912187981706855,
      0.22550598784230846, 0.3597747058303585, 0.557846314208503,
      0.7897802245076999, 1.0058615705760352, 1.1483031216676312,
      1.1657296797248402, 1.0268742370690014, 0.7300556129376121,
      0.30599319422812227, -0.18689256870877538, -0.6737327644969154,
      -1.0784647607646352, -1.3395594449443087, -1.4225634464988208,
      -1.3265538799820373, -1.0830578561812203, -0.7477894268594822,
      -0.38726472294267045, -0.06355680032133565, 0.17914542839985087,
      0.3229999665874781, 0.37808186705369934, 0.3768645681278888,
      0.3631698306270013, 0.37850184098969497, 0.44931086566263595,
      0.5784797499861123, 0.7432559540313811, 0.9002274336794734,
      0.9961635336742193, 0.9820510280991344, 0.8268194739790053,
      0.5272775299451012, 0.11166937305113267, -0.36420686602947644,
      -0.8275721376825329, -1.2035490116339254, -1.430905862996518,
      -1.474980350886988, -1.3347557533770535, -1.0424517225928616,
      -0.6557740366865239, -0.24471253391607894, 0.1239411890302306,
      0.4006751531884816, 0.5626410713872705, 0.6162268210659225,
      0.5923906696211326, 0.536109085413073, 0.49272319349221244,
      0.4947063624615188, 0.5522378723673542, 0.6499911227896457,
      0.7509716017780916, 0.8064587117210628, 0.7695565516884153,
      0.6089250031527261, 0.319176066672909, -0.07479463867225344,
      -0.5208051365073638, -0.9491875631823433, -1.2871915304360768,
      -1.4746408734808407, -1.4771536626652484, -1.293789028001627,
      -0.9572995669175088, -0.526926020500722, -0.07544443009433449,
      0.3264657894353092, 0.6248509128819923, 0.7927057888319659,
      0.8334875201713893, 0.7772678919131139, 0.6706691744727757,
      0.5632305745096448, 0.4936944362122584, 0.47967825909408035,
      0.5133192118908256, 0.5639608958581749, 0.5871729107992189,
      0.5377918403498464, 0.3836434738188142, 0.11640541220899192,
    ]);
    const expected = [
      [
        -1.040826465309921, -0.3976677753929304, 2.513163587465343,
        1.8674346633227055, -1.4952453989458807, -1.7549465403217948,
        -0.49336154232046936, -0.6340686927926281, 2.451749269189095,
        1.1683063135136973, 1.1720215329897365, 2.4498730947898557,
        0.8200805445688949, 0.13289451612774267, -0.8039866806168041,
        -2.6133183082744766, -0.249621752609608, 2.574556455974714,
        1.2824916463093283, -0.4590723147548243, -0.6138021656800698,
        -1.127270775185114, -0.036964608167747826, 2.782754087188444,
        1.4015043613071936, -1.8324141826020808, -1.337045985970421,
        -0.7793307467396929, -0.1893003235443939, 2.556729070918989,
        0.8021358001607588, 1.5729749818109742, 2.2928006032210964,
        0.6141326193218102, 0.21210905747847614, -1.1658119362002868,
        -2.5969208066729585, 0.31130639104824503, 2.6405667637257353,
        0.8133986450832448, -0.2582295874839525, -0.8289726127101408,
        -2.3445722732806127, -0.31689654916410126, 2.767163475042943,
        1.2707167094656546, -0.6874169481537498, -0.783649043901924,
        -1.8852812600139108, -0.8213021158662114, 2.5833760074641217,
        1.8579369463592077, -0.919353973599288, -1.0325220264848234,
        -1.3730173026564139, -1.070763375488795, 2.1340741939509615,
        2.406617808493963, -0.8586122035483844, -1.48692276412103,
        -0.9772353721447191, -1.0125819636328932, 1.5450077663530493,
        2.75935274782992, -0.4998341473531973, -1.994134498021423,
        -0.830717130537912, -0.6886859570326874, 0.9841330786599011,
        2.8181858056355273, 0.07058110346283057, -2.3844026311224225,
        -0.988697670640141, -0.2226917032989921, 0.6099542902092,
        2.5747358488215264, 0.7010254076581968, -2.523188657083753,
        -1.4118540102545216, 0.2181716921556665, 0.522750011946132,
        2.1128828170130647, 1.2208623975055468, -2.351437341020811,
        -1.9808002176469943, 0.4785178520313687, 0.7288089864966238,
        1.5868045490478608, 1.4935828911365974, -1.9126488155305197,
        -2.5156571884509273, 0.45022631218142967, 1.09453891364204,
        1.4383701507029514, 0.4965049326221486, 1.1231612579191834,
        0.6763350196382443, 0.8845505936053966, 0.7921327046173289,
      ],
      [
        0.02905021399772738, 0.0015359364489739356, 0.01883027482467269,
        -0.06410747059474328, 0.05843172202370942, -0.0463521337980858,
        0.03544101728713363, -0.02458751011351663, 0.034351855024209656,
        0.020770329767421755, 0.10972022267559732, 0.11722730924908203,
        -0.1847676347705467, -0.1202506147469379, 0.27474464387114717,
        -0.2994098304391735, 0.26439614119768634, -0.19887149373349228,
        0.12146172585412274, -0.052429532311859456, 0.008036559391151632,
        0.007970333666045671, -0.005347024489586515, -0.0008709786030307252,
        0.001310888349422088, 0.0029469315464866743, -0.0051385442883531895,
        0.0017347789338394046, 0.0036269871974036623, -0.004759301840306918,
        0.0003438853016860076, 0.0044718690040678084, -0.004071536704344864,
        -0.0010778823344644941, 0.004970006922301143, -0.003065111081905285,
        -0.0024149086023266516, 0.0050782178064286585, -0.001818259339071668,
        -0.003562556229522159, 0.004787944576922879, -0.00042867252611990725,
        -0.004430572947854997, 0.004122029825637931, 0.000994481526769308,
        -0.004951056963779006, 0.003132652355412046, 0.002339671756049503,
        -0.00508296358283384, 0.0018975162160847637, 0.0035012201201418867,
        -0.004816149680090096, 0.000513455298484463, 0.004388115486438635,
        -0.00417134304221396, -0.0009108507389351036, 0.004930645457267586,
        -0.003199344734673772, -0.002263732733147349, 0.005086362266803271,
        -0.0019762124819669635, -0.0034389499349576245, 0.004842930595127367,
        -0.0005981251522118222, -0.004344384821477725, 0.004219564692954771,
        0.0008269939999749529, -0.004909033053358701, 0.0032630763078658554,
        0.002181641439049883, -0.004952873468076429, 0.0036672954871989124,
        0.0120085537264388, 0.023824983995411036, 0.06924084846434309,
        0.0909158412021217, -0.13614587659920552, -0.11047268770141677,
        0.22132178712813186, -0.028971815914496015, -0.03913531036081605,
        -0.16084700820610837, 0.11342949038337537, -0.0899252493622036,
        0.04594085520260111, -0.009440294290014027, -0.013507876210281834,
        0.020280038294086, -0.013944978863019231, 0.003064234177642101,
        0.0031900774821645964, -0.0015406985809543283, -0.003472812575079719,
        0.004837121643984141, -0.0006101815956566587, -0.004336031481873325,
        0.004229865445985585, 0.0008089615223716898, -0.004904072555700401,
      ],
      [
        0.001260992626848208, 0.02258193579939789, 0.021605847727997916,
        -0.08808332327656382, 0.0731915664842618, -0.05367943554541376,
        0.042363737699298576, -0.03530913697636257, 0.028224680522100525,
        -0.019925364229186088, 0.011730473060005494, -0.005447935459783601,
        0.0018083362683327048, -0.00029564116830160884, -8.157352446277059e-5,
        7.818633557645727e-5, -2.8687971103789672e-5, 5.88592486213051e-6,
        -5.173012091105772e-7, -4.7335478759255816e-8, 2.021566950750384e-8,
        7.386659293294208e-10, -2.1183037251951625e-9, -3.946971274527176e-9,
        -2.185330239724376e-9, 1.586808096076606e-9, 3.899085040473588e-9,
        2.62420988779119e-9, -1.0649350751896505e-9, -3.774339297144279e-9,
        -3.011356551264906e-9, 5.220689635329621e-10, 3.5751957692327468e-9,
        3.339147204752075e-9, 3.108847036922781e-11, -3.3055701002982084e-9,
        -3.6011138765563298e-9, -5.836401930566231e-10, 2.970780874934646e-9,
        3.79208687385266e-9, 1.1246776670190762e-9, -2.577427396363646e-9,
        -3.908308858845975e-9, -1.643545443950575e-9, 2.1332773204117237e-9,
        3.9474874471591e-9, 2.1300203342739716e-9, -1.6470647266053619e-9,
        -3.908854999583566e-9, -2.5745060584792407e-9, 1.1283801822653331e-9,
        3.793158785171352e-9, 2.9682364245051414e-9, -5.874532675335236e-10,
        -3.602691164993299e-9, -3.303449960929035e-9, 3.495786154395948e-11,
        3.341204075076379e-9, 3.5735536844402644e-9, 5.182351514529526e-10,
        -3.0138593967291244e-9, -3.773209952513502e-9, -1.0612168276866229e-9,
        2.6270936027329235e-9, 3.898482113844881e-9, 1.583277175498629e-9,
        -2.188542664050102e-9, -3.946900726091136e-9, -2.074114501834598e-9,
        1.706854914805397e-9, 3.917515218636062e-9, 2.5240761167274542e-9,
        -1.1915145278753935e-9, -3.81091494854507e-9, -2.9242854111016487e-9,
        6.526827248306902e-10, 3.629177654470156e-9, 3.266838051192015e-9,
        -1.0098974235129533e-10, -3.3759072886216585e-9, -3.545003955933494e-9,
        -4.526938711625051e-10, 3.0560882605692645e-9, 3.753267397907713e-9,
        9.974554240695723e-10, -2.6760257345870814e-9, -3.887563315589563e-9,
        -1.5225555983169499e-9, 2.2432061636086792e-9, 3.94521373903342e-9,
        2.0176434688660706e-9, -1.7661611806322579e-9, -3.9250937867156064e-9,
        -2.4729433733359882e-9, 1.2543063024270784e-9, 3.827602788672421e-9,
        2.879510079838504e-9, -7.177325417133202e-10, -3.6546639811094173e-9,
        -3.2293050222800138e-9, 1.6699775026287588e-10, 3.409668763823051e-9,
        3.5154499859704025e-9, 3.870209257722413e-10, -3.0974668871664523e-9,
        -3.73228689370501e-9, -9.33419460486626e-10, 2.724195508776304e-9,
        3.8755468726051485e-9, 1.4613961024208203e-9, -2.2972360252226516e-9,
        -3.9424252426105124e-9, -1.96059179253121e-9, 1.8249811307278173e-9,
        3.931573659818296e-9, 2.4211201663471375e-9, -1.316755913325496e-9,
        -3.843221209101307e-9, -2.833934825064114e-9, 7.825718634160299e-10,
        3.6791065510092057e-9, 3.1908652542862637e-9, -2.329611745764185e-10,
        -3.4424748627100874e-9, -3.4849135400450497e-9, -3.2123704759743164e-10,
        3.1379741586122056e-9, 3.710260353082934e-9, 0.0009110553291167735,
        0.0162640593739299, 0.015468673006743025, -0.06322674474079192,
        0.05246671612769756, -0.038411048324615234, 0.03025745593682727,
        -0.02518659097743092, 0.02012651647783917, -0.014218022526014285,
        0.008385103434831584, -0.003906717261516482, 0.0013047990284977555,
        -0.00021800397510388206, -5.6097675253587375e-5, 5.556680737203073e-5,
        -2.058313405223291e-5, 4.259674289669925e-6, -3.761328237728314e-7,
        -3.138994369333283e-8, 1.2500946365493995e-8, -3.5724150542767562e-9,
        -3.861108328296833e-9,
      ],
    ];
    const result = wavedec(data, "db24");

    const reconstruction = waverec(result, "db24", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db24_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5045807787763661, 0.9315657822268018, 1.2190726976654216,
      1.333034169717091, 1.2729427507713658, 1.070018390934075,
      0.7783868256739553, 0.46151248803545214, 0.1772296258672567,
      -0.035004730804902406, -0.1616164481118775, -0.2154951670080581,
      -0.22970408114490823, -0.24608231768900424, -0.3017659084859145,
      -0.4171580559097072, -0.5885033443229175, -0.7870572959549108,
      -0.9651795529910631, -1.067926562975511, -1.0473110233598613,
      -0.8756797669636118, -0.5548188882969873, -0.11839045342650367,
      0.37310098855698315, 0.8438090698320666, 1.2179347701500165,
      1.4354640735703013, 1.4646030749503076, 1.3080277907545539,
      1.001528350401936, 0.6054295089208469, 0.19087461795898764,
      -0.17574457508977664, -0.4465327936368372, -0.6008253758077134,
      -0.6469873493580403, -0.6170699137743453, -0.5558677897806443,
      -0.5072772495037358, -0.5014853695973394, -0.5462739090991234,
      -0.624659818924093, -0.6994824220933249, -0.723783690081463,
      -0.6543489936909785, -0.4649476263167689, -0.15584187148347012,
      0.24298365484504497, 0.6758981699571214, 1.072241792158053,
      1.3610990181475233, 1.4867925919846612, 1.4214384127761168,
      1.1715650096427885, 0.7771919881539975, 0.3035446936847481,
      -0.1726747545866643, -0.579259300623982, -0.8630023588581295,
      -0.9994126013249274, -0.995496560284202, -0.8851574286946745,
      -0.7185425373900531, -0.548115188873044, -0.4149782848839126,
      -0.33885705953791406, -0.3141898049865623, -0.3132178382400622,
      -0.2951948511997605, -0.219288873808762, -0.057809516664667215,
      0.19370820370089098, 0.5122679514590331, 0.8502854836177497,
      1.1450649091973855, 1.3327133349460307, 1.3631901872551073,
      1.2128496213328392, 0.8913849232827589, 0.44139244015833423,
      -0.06947658397671824, -0.5620394193010967, -0.9616871762743366,
      -1.2133639147600381, -1.2919875533991065, -1.2059800638437261,
      -0.9932292569230037, -0.7106118564937275, -0.4197283293283235,
      -0.1723657922117146, 0.0007913036407132257, 0.09553841874163274,
      0.13245230195499846, 0.1487271729459959, 0.18576745682661494,
      0.2758100887943382, 0.4310826511573441, 0.6383620363780881,
      0.8604404801032528, 1.044266617090833, 1.1338378574108274,
      1.0846949737789944, 0.8764147445940538, 0.5199276880629102,
      0.057704008117328176, -0.44344220318552774, -0.9053977480540938,
      -1.2546874713524265, -1.4376301209618545, -1.431205217339275,
      -1.2471333527444806, -0.9282822171064804, -0.5383298801487182,
      -0.14720437193195096, 0.18420969512085844, 0.41648424084244745,
      0.5383200026438921, 0.566057578856618, 0.5363794533681554,
      0.49422503024776226, 0.47909872645403695, 0.5133149261065169,
      0.5952061654291305, 0.6990520464045191, 0.7817805192404843,
      0.7947722291365444, 0.6977883594233676, 0.47146791458020276,
      0.12514620399691617, -0.3021392783136328, -0.7479369189219688,
      -1.1386572514523652, -1.4050475370382958, -1.4972581681023929,
      -1.3959476386949063, -1.116786200215873, -0.7072722854544655,
      -0.2365943804687754, 0.2190863956078075, 0.5924889794295509,
      0.8385192368056105, 0.9419996887634474, 0.9181663782576535,
      0.8060411825709302, 0.6565089555963722, 0.5181873740410972,
      0.4246679001287544, 0.386312342048896, 0.3886116844774433,
      0.3974449575061945, 0.3698288988847785, 0.267355820351302,
      0.0688219991140418, -0.22127512738649918, -0.570687167093185,
      -0.9245392256772065, -1.2165720954586332, -1.3839067909555878,
      -1.3818212809377326, -1.1949662961419172, -0.8422556101136827,
      -0.37415279902111975, 0.1371182948058968, 0.6122262235356606,
      0.9808772566326047, 1.195735186957538, 1.240943150277022,
      1.1333804768270273, 0.916534435642147, 0.6486295853377286,
      0.388008004283074, 0.17936528315957928, 0.04417449498949094,
      -0.022455329698506776, -0.04786832133550761, -0.0720496643745468,
      -0.13453689107405653, -0.26149427297659106, -0.45634626024842934,
      -0.6964743360970715, -0.9369619332010634, -1.1205987356589906,
      -1.1917662733404093, -1.1108143523895722, -0.865354812940371,
      -0.4755946646993051, 0.007761219480753062, 0.5127280167208332,
      0.9603512827766669, 1.2808433078002723, 1.4278235628583547,
      1.3873805237074657, 1.179900415040232, 0.8543278692260363,
      0.47631689996317605, 0.11316318682776372, -0.18086572262677664,
      -0.37534022741788103, -0.4681492202044451, -0.482766667780416,
      -0.45920551755381256, -0.44110900628847344, -0.46236165748811997,
      -0.5366906527314862, -0.6529532959137949, -0.7773607246064639,
      -0.8621295427043025, -0.8584164247382324, -0.7302811020431708,
      -0.46611647804966416, -0.0845599240117278, 0.36678055225165285,
      0.8197083818939043, 1.1991107172118378, 1.4387900480794147,
      1.4957623997437899, 1.359658350125995, 1.055005749162002,
      0.6358536314618859, 0.17400842362231683, -0.2563427773983764,
      -0.594015127407168, -0.8026481046656508, -0.8762983133664973,
      -0.8376703204305421, -0.7296489167898985, -0.6024134450911349,
      -0.499458977769392, -0.4460672413822491, -0.4431124098799967,
      -0.4677183933076353, -0.4805444837004448, -0.4377955221192277,
      -0.3048466792375517, -0.067940262332424, 0.2591387389782101,
      0.6352787399729537, 0.9993220232403615, 1.2828262847285141,
      1.4253412911771683, 1.3885667318719541, 1.165971374329949,
      0.7855015171373083, 0.30463648111874075, -0.2011340177584724,
      -0.6537720891294982, -0.988524132285701, -1.166481676232198,
      -1.1810309769772265, -1.0568322916819826, -0.8417672700577468,
      -0.593969629354083, -0.3672029639956541,
    ]);
    const expected = [
      [
        -1.4343256941902107, -0.9347094301353929, 2.3568199956741926,
        2.136908933465052, -1.1451923538905404, -1.6620000912370905,
        -0.6483227779794758, -0.801537312640202, 2.4317724634661038,
        1.1773308530195505, 1.1898266394099033, 2.4885173059170915,
        0.7491710891296312, -0.0615064301018872, -0.938601759724347,
        -2.4164216209860334, 0.09906042759740567, 2.8273765439729868,
        0.9345510794867379, -0.9594287129832098, -0.8672683096150315,
        -1.614643606595331, -0.5453147536845331, 2.6890163567792174,
        1.7038556760609214, -1.5046447520970154, -1.2827054384893732,
        -0.9515101198632184, -0.3358051327415406, 2.5475431986926114,
        0.8061814320481103, 1.5988818911010947, 2.325954743415466,
        0.5244595427654669, 0.0029045240480784587, -1.2578867111088252,
        -2.3806277537518126, 0.6960236157581117, 2.795154926587712,
        0.47090257538065255, -0.8416418230499765, -1.0206586265437083,
        -1.8495469007261491, 0.42437616531389816, 2.995653865545744,
        0.6517855925944214, -1.625529432551716, -1.0393754262801034,
        -1.0855853645891158, 0.2635655456510721, 2.8369287394136324,
        0.939399897275774, -2.1825310820897643, -1.3139414638874642,
        -0.25424190011753184, 0.34078550376912115, 2.3679321109144618,
        1.165948614781426, -2.411162458383452, -1.7507267886541165,
        0.46406468563995196, 0.7012363351314396, 1.7217668626428073,
        1.177473774401421, -2.304857083878965, -2.192116587712313,
        0.9287753469925114, 1.2923607550492104, 1.074241399438253,
        0.8840524869153037, -1.9525424926592754, -2.4664357402400623,
        1.081363431210731, 1.978956461665442, 0.5893182013622116,
        0.2899784477562886, -1.5094710164073437, -2.44257254451017,
        0.9617117421934542, 2.5844506774033125, 0.36857852877240305,
        -0.5056502358997212, -1.1473470135690025, -2.072301131018305,
        0.6933851377040114, 2.9470913782907844, 0.41526827174694,
        -1.326164787232671, -1.0216421104453337, -1.3721489011857995,
        0.3958598891973391, 3.0240682812740776, 0.5932242593501431,
        -2.0126312726242808, -0.8120260094636609, -2.0816940054776127,
        -1.957014494207922, -0.9168319645709915, -2.4891281368229747,
      ],
      [
        0.028767298003100145, -0.010124490068096305, 0.007643737300860043,
        -0.018697433030860567, 0.020276727633089714, -0.017945455275481807,
        0.012670532458579877, -0.005372110443625154, 0.01916755907631575,
        0.03217834184324527, 0.1049704582153096, 0.12191757936655062,
        -0.18845602263720065, -0.12205565813013719, 0.2789737321452248,
        -0.30384680368794525, 0.26821444354559154, -0.20175775967048248,
        0.12332116954034289, -0.05338060065777957, 0.00836585903726881,
        0.00795377941747346, -0.005436818757756358, -0.0007680208522942666,
        0.0012367027522154116, 0.002963756969003466, -0.00509800446985963,
        0.0016824031612469317, 0.0036319077000166265, -0.004704813490878557,
        0.0002855534957001511, 0.004466512332978116, -0.004001069023276358,
        -0.0011382088143994608, 0.004947843057695633, -0.00297775680851939,
        -0.002470637504553402, 0.005033082921937736, -0.001716276226873084,
        -0.00360544648867728, 0.0047154911823940205, -0.0003172182295226695,
        -0.004451515072817088, 0.004020374636690438, 0.0011070338931399779,
        -0.004941378751898665, 0.0030035192263881114, 0.0024428716898150043,
        -0.005035588791090543, 0.0017461489448631932, 0.003582964486112964,
        -0.004726815538285696, 0.00034911112926008163, 0.004436453265353471,
        -0.0040395901164021475, -0.0010759905389284277, 0.004934619013411304,
        -0.003029080444871991, -0.0024148320965357082, 0.005037981149881422,
        -0.001776045148546538, -0.0035605158530718013, 0.004737876164216291,
        -0.0003808859942432485, -0.0044210397508671565, 0.004058707750086814,
        0.0010447905826118824, -0.00492790389193959, 0.003051820397535944,
        0.00234930497979785, -0.00530986307452287, 0.0007156117834724182,
        0.0009030496219240884, -0.009630786415578884, -0.016151553209984373,
        -0.06212066648683319, -0.03855661372933293, 0.1045918886607879,
        -0.10796403916069798, 0.07091752082930873, 0.06547971311386018,
        -0.00838831958302359, 0.0009803573950258524, -0.007516429827269511,
        0.024338561412660425, -0.027699366515229286, 0.019232631162126788,
        -0.00813203738413583, 0.003185618795882187, -0.004525821066345646,
        0.005727730762262207, -0.0023012627059171157, -0.0032267945178028504,
        0.004905214803103266, -0.0008742329721389707, -0.004162000632725835,
        0.004331628366905951, 0.0005593549955601061, -0.004796922225498193,
      ],
      [
        0.0012802259528032168, 0.022928594930679017, 0.02194061092746717,
        -0.08944255537792445, 0.07432315374693085, -0.05451107906292281,
        0.043021203071756414, -0.035857661261376926, 0.028663302337884486,
        -0.020234974201578392, 0.011912615642981898, -0.005532361173855001,
        0.0018362099817010014, -0.00030008692753283594, -8.290517222351004e-5,
        7.94167264009156e-5, -2.913376515893733e-5, 5.976216220113092e-6,
        -5.249381928285754e-7, -4.818849052611348e-8, 2.0427438214445415e-8,
        7.269824237538017e-10, -2.0764443491730457e-9, -3.905378986546407e-9,
        -2.1860024274656166e-9, 1.5427469022010506e-9, 3.853398522929981e-9,
        2.6219998468258596e-9, -1.0195431890033796e-9, -3.7239187235959293e-9,
        -3.0052630006419366e-9, 4.758387731415153e-10, 3.5195508904429854e-9,
        3.328086733910498e-9, 7.74409254727988e-11, -3.244389008033767e-9,
        -3.5839767630049485e-9, -6.291701285053508e-10, 2.903966753444559e-9,
        3.7677767610547504e-9, 1.1682447520227279e-9, -2.5051395298983044e-9,
        -3.875791128215032e-9, -1.683804466821892e-9, 2.0559375371591107e-9,
        3.905860879190431e-9, 2.1655107005145304e-9, -1.565377921913257e-9,
        -3.8573750310928265e-9, -2.603669788401938e-9, 1.043332332401148e-9,
        3.731302558907064e-9, 2.9894546707383457e-9, -5.002983846162188e-10,
        -3.530171988967216e-9, -3.3151077873854537e-9, -5.279092525023981e-11,
        3.2580535969089e-9, 3.574089670149181e-9, 6.048115015222154e-10,
        -2.9204085782129968e-9, -3.761189364622937e-9, -1.1446805658266096e-9,
        2.5240187551112927e-9, 3.872643915391978e-9, 1.6615309958358858e-9,
        -2.0768611643013433e-9, -3.906196489389945e-9, -2.144946397106489e-9,
        1.5879309463089501e-9, 3.86118760169924e-9, 2.585225867090218e-9,
        -1.0670752126029976e-9, -3.738526600222945e-9, -2.973516166439742e-9,
        5.247559168718972e-10, 3.540672797202745e-9, 3.302004398624165e-9,
        2.8135696310962e-11, -3.2715957280413194e-9, -3.564069789257949e-9,
        -5.804424233198112e-10, 2.9367207062404457e-9, 3.754449495322593e-9,
        1.1210799800163984e-9, -2.5427880448517564e-9, -3.869318406331364e-9,
        -1.6391698936086922e-9, 2.0977152628537405e-9, 3.90637979323258e-9,
        2.124297755576276e-9, -1.6104374930856867e-9, -3.864856862093442e-9,
        -2.5666971759928915e-9, 1.0907737504587737e-9, 3.745597496684068e-9,
        2.957463974240159e-9, -5.491742429479816e-10, -3.551014311855944e-9,
        -3.288748318528045e-9, -3.4632712440690196e-12, 3.2850103067327445e-9,
        3.5539063483443288e-9, 5.5604404874905e-10, -2.952931797830492e-9,
        -3.747571509782846e-9, -1.0974398856552707e-9, 2.5614585314952405e-9,
        3.86585739796401e-9, 1.6167561473042071e-9, -2.118462053473429e-9,
        -3.906391802951513e-9, -2.1035540881611263e-9, 1.6328782979917107e-9,
        3.868363283102109e-9, 2.548052364995393e-9, -1.1144406834101245e-9,
        -3.752535968363939e-9, -2.941299505279886e-9, 5.735771111430399e-10,
        3.561220348536658e-9, 3.275382239981474e-9, -2.1190944592979614e-11,
        -3.298282234538615e-9, -3.543590227376e-9, -5.316234733375872e-10,
        2.9690070476774677e-9, 3.23583123391756e-5, 0.002424553471692839,
        0.012726261681110022, -0.01437300293638836, -0.00883990232026491,
        0.017166073037366135, -0.016764198206024646, 0.012791006079072314,
        -0.007853250004940747, 0.0035276323371777347, -0.0006884535544383081,
        -0.0005696681412791446, 0.0007462664706038096, -0.00048542041422578515,
        0.00021241950832560385, -6.299134224952883e-5, 1.0614736506235738e-5,
        1.641563575968243e-7, -5.959141618277233e-7, 1.5138678107406425e-7,
        -1.3565295661223417e-8, -3.2248453444578848e-9, -3.6291742146684053e-9,
        -1.0554056338218438e-9,
      ],
    ];
    const result = wavedec(data, "db24");

    const reconstruction = waverec(result, "db24", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db25", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4869220780390511, 0.9009183945153798, 1.1838203631002364,
      1.3035988943212033, 1.2597979565922044, 1.0818553421090058,
      0.8208275188525214, 0.5365848794754005, 0.2835911980826545,
      0.09867730519142143, -0.0063045765806661325, -0.04527399155421438,
      -0.05210189904322307, -0.06973313340248499, -0.13704102153161274,
      -0.27675451381129523, -0.4875342646868185, -0.7422591217787269,
      -0.99306371907795, -1.1820089082988348, -1.2548709541119027,
      -1.1747411694964216, -0.9321288501753558, -0.5490594995515794,
      -0.0760677969913876, 0.4173357485064966, 0.8565962110232401,
      1.1772678171918316, 1.337919162991718, 1.3278489490569987,
      1.167897821395185, 0.9042721723508967, 0.596939258070102,
      0.3054166630114977, 0.07536161260531904, -0.07087044379269614,
      -0.13752363025154243, -0.15193358546457644, -0.15521449009604482,
      -0.1895545660118237, -0.28535429504171395, -0.4514730695253716,
      -0.6710848856621418, -0.904267201820077, -1.0967921072437463,
      -1.193055895446741, -1.1500434533519104, -0.948930496407745,
      -0.6014529931787216, -0.1493951434476513, 0.3428266977602409,
      0.8008660935337876, 1.1555547124681982, 1.3569567386092203,
      1.384151048946027, 1.2485282553885724, 0.9899188372449467,
      0.6665553372195993, 0.3413125100000927, 0.0675203834022029,
      -0.12229555617005605, -0.222136922129758, -0.2514734640275468,
      -0.2478152045021349, -0.2548759508447484, -0.30935352091497853,
      -0.429677961387457, -0.609587856359782, -0.8182058252169813,
      -1.0066853035304522, -1.1198786560147302, -1.1102244552697813,
      -0.9504734527139084, -0.6421103154337852, -0.2173270884165876,
      0.26607346245052027, 0.735785378225155, 1.1196218981773083,
      1.3603093869846812, 1.4270555683065465, 1.321248117295001,
      1.075020321510742, 0.7430983406213029, 0.3899182960331158,
      0.07509504718325288, -0.15932227396345572, -0.29684234682389965,
      -0.34798240254771245, -0.3449873181905287, -0.3312611977421003,
      -0.3482315865805514, -0.4229767911201064, -0.5597450264033632,
      -0.7375299789361305, -0.9143745837755631, -1.037414802905539,
      -1.0562499739503681, -0.9363815850566232, -0.6694041681890921,
      -0.2773770142171516, 0.18982336184887166, 0.6637007505340228,
      1.070850519107041, 1.348060175970732, 1.4553273592018747,
      1.3838011572498747, 1.1568421547316223, 0.8240136006834325,
      0.44947398648144227, 0.09754389250549128, -0.18114339431686005,
      -0.359677733069821, -0.4388150953886257, -0.44403860108141824,
      -0.41661867407182335, -0.4010005035988181, -0.4317227596146235,
      -0.5231656837383, -0.6647177726172975, -0.8226106360180069,
      -0.9480258452510788, -0.9895242913713873, -0.9067642800378286,
      -0.6821229887555047, -0.32730422146124316, 0.1168067861430917,
      0.5871750304367679, 1.0110189145399269, 1.3207748589315491,
      1.4681833112974456, 1.434243750887246, 1.2327478606426117,
      0.9066062370755381, 0.5178748676855477, 0.13385900061025546,
      -0.1874272709590134, -0.4090513876491627, -0.521502493084544,
      -0.5422164478804471, -0.508574269298151, -0.46623567390853554,
      -0.455783384610253, -0.5010412261463656, -0.6019977733860187,
      -0.7341230009288292, -0.8542856316696014, -0.9118464264136001,
      -0.8622130807626858, -0.6795087774130478, -0.3651838462913469,
      0.04965201275815828, 0.5089072189467401, 0.9422471330746244,
      1.279484208553583, 1.4653167554539597, 1.4710055008254632,
      1.3002811748070113, 0.9881252076773073, 0.5927372071326547,
      0.1825977158947827, -0.17832810577930203, -0.4437916727320331,
      -0.5938287363772947, -0.6367936572716433, -0.6045453795009923,
      -0.54212027782765, -0.49454461172718606, -0.49410800614550837,
      -0.5512795247469029, -0.6515349829767183, -0.7589001274448142,
      -0.8253540809436317, -0.803783289277482, -0.6612807829186405,
      -0.38946692979874853, -0.009196793252361612, 0.43164829879364436,
      0.8669307933538802, 1.2256518518347541, 1.4469070124225893,
      1.4929382015079118, 1.3572426438665302, 1.065849111203354,
      0.671472613930348, 0.24192767186773179, -0.15448109140237942,
      -0.46318348579704627, -0.6539001958620978, -0.7251534192694081,
      -0.7018213931340809, -0.6265018920685788, -0.5469299415491671,
      -0.5026243648683322, -0.514094013285345, -0.5772818746267665,
      -0.6646230727929723, -0.7324570261163141, -0.7329611092131407,
      -0.6276443074665604, -0.39902876664327497, -0.05755583797978492,
      0.35811541463644414, 0.7876663529345921, 1.161128609164587,
      1.413613788914657, 1.4993516406691119, 1.40175821798904,
      1.1371710661644114, 0.7513687810032191, 0.3096839686676158,
      -0.11698255622356601, -0.46699050468781167, -0.7002044645848575,
      -0.8048708608202004, -0.7976481684718583, -0.7169595724158133,
      -0.6114339763736518, -0.5263625710066274, -0.49154593943217106,
      -0.5135350433491835, -0.5741701519991288, -0.6357620059140677,
      -0.6516173531238139, -0.5792843565548722, -0.3932040253514055,
      -0.09356983883386694, 0.29090710868720493, 0.7071701154305616,
      1.0880947612118086, 1.3665565957787575, 1.4900351211322411,
      1.4323376977915045, 1.199680019624962, 0.8296740914559111,
      0.3834367193360895, -0.06735573099233744, -0.45546250420956674,
      -0.7316574642019074, -0.8737886070588363, -0.8893138687336953,
      -0.810879309423971, -0.6861693406404502, -0.5646159161674799,
      -0.48427928049356284, -0.46213424841140793, -0.49013434963483665,
      -0.5379914994343065, -0.5619491579249081, -0.5173443317483528,
      -0.3718075452303563, -0.11576992149063631, 0.23242225471558886,
      0.6281935013000572, 1.008992043748342, 1.3072798300308532,
    ]);
    const expected = [
      [
        -0.6723824392748454, -0.5501658226869937, 1.6589118672898764,
        2.5973201453935832, -0.5552943018461644, -2.3531455614549124,
        -0.5770322990199837, -0.8101761909316281, 1.274265307468301,
        2.226735203238142, 0.5623207685283403, 2.2138936752736065,
        1.7073396527950648, 0.3650554755422137, 0.0548433653558593,
        -1.8817052526103883, -2.316851894089386, 1.4115148283014103,
        2.11008162047996, 0.78545917907062, -0.41836031444453536,
        -0.6846244389057059, -0.651000161072097, -0.30948482332512806,
        2.332488271841822, 2.0528511909808462, -1.3046778794396412,
        -2.032202351405957, -0.41932506615592346, -0.8489338877148223,
        2.1315925418952926, 1.5144976861404635, 0.8742321027943566,
        2.4251977495635058, 1.236142425401035, 0.3867372428984263,
        -0.19363756149658623, -2.457513664736124, -1.5668795831132523,
        1.9551078587551145, 1.8531970621777538, 0.29534927283953133,
        0.04862360662865178, -1.7828741146625666, -2.3081511056008797,
        1.1399373347759703, 2.422129666306995, 0.507995975457021,
        -0.023378713638943616, -1.077847322796425, -2.5483110413526484,
        0.03609647277309503, 2.662119815835315, 1.067056813611428,
        -0.20428422362661372, -0.5983913198876588, -2.3023753299517065,
        -1.0545888501704397, 2.397315149612916, 1.831603459997391,
        -0.23450167950622375, -0.46246246445291883, -1.7612667255814758,
        -1.8376736672805785, 1.634143370646715, 2.53286928870388,
        0.07642295913276684, -0.6038651776488573, -1.2038959426277487,
        -2.14394224819756, 0.5647499299496557, 2.8875817758301836,
        0.7567386647418088, -0.8082512098820208, -0.8732596382167196,
        -1.993237403016842, -0.5086235382436918, 2.7200189880178107,
        1.6508190952261013, -0.8151859282564183, -0.8706337950122993,
        -1.5770501727392456, -1.2958772385199258, 2.0398743417157537,
        2.4782239864926723, -0.4393000559009381, -1.1193032126117173,
        -1.1558567840959761, -1.6592093392885898, 1.0847871693364268,
        2.8781023934835055, 0.4501914951160307, -1.571619988715339,
        -0.6824680712877612, -2.076612497024729, 0.9133456800625048,
        1.6311512105775177, 0.6851778475372263, 2.4402890380542703,
        0.7588361274847273,
      ],
      [
        -0.026721587564676477, 0.0350422750036794, 0.046361034839883575,
        -0.13436484365158263, 0.09204008827509694, -0.05823018304237198,
        0.04885213411559966, -0.05227392730091448, 0.04410892871462226,
        -0.07086526207034162, -0.03463010396106206, -0.15559277339430153,
        -0.10755302028492293, 0.2798805420367709, -0.11444094951133685,
        -0.026389954659485817, 0.07364556871715006, -0.05715489925603755,
        0.014471298119156555, 0.02396257006499172, -0.04095315235531139,
        0.035729208808782574, -0.019765668543952314, 0.006526621133555337,
        -0.002086153655223069, 0.0032397507500060104, -0.003448438978086493,
        0.00021716136986685985, 0.0032340855529704583, -0.0028506727948547682,
        -0.0009316367146658977, 0.0035911208605391054, -0.0019408758591033194,
        -0.002038348360802967, 0.0035715959566874136, -0.0008190379411489602,
        -0.0029163313561359956, 0.0031522029638578774, 0.0003944751325372781,
        -0.003467803407795693, 0.002379862226724157, 0.0015638371894912192,
        -0.003630972476336106, 0.00134106319655477, 0.002558086003319421,
        -0.003387616252472359, 0.00015209886828034403, 0.0032659262595105495,
        -0.002764934710268187, -0.0010538825528965316, 0.003608080314328538,
        -0.0018326955060170888, -0.00214187917804422, 0.0035462558691620677,
        -0.0006952315483447881, -0.0029900385774637456, 0.0030873630154924286,
        0.0005200529804408653, -0.003503431528441461, 0.002282789186410534,
        0.0016771299692280035, -0.003624534857291282, 0.0012226192801254004,
        0.0026464039695351937, -0.003339831943224528, 2.5552447737228985e-5,
        0.003319385507266358, -0.002681174525440836, -0.0011746210550967716,
        0.003621394337093118, -0.0016768944103624306, -0.0017754353937961573,
        0.0060279951231719305, 0.008062424764312228, 0.01915652421558017,
        0.05064171270960091, 0.041067374814629194, -0.0668216790487323,
        0.09436217569604764, -0.1205246654657508, 0.10647258903103123,
        -0.1948864307714942, 0.13486159577853712, -0.14994610197628686,
        0.14072529658909627, -0.11871798095745507, 0.0806614385772511,
        -0.041530187509778715, 0.014931439273153001, -0.0043886285885227985,
        0.003366209698043453, -0.0029640225579484814, -0.0002889889454725301,
        0.0034369435617746733, -0.0026850612120349476, -0.0011996844407576462,
        0.0036229734860060104, -0.0016956852413956228, -0.0022664967179998824,
        0.003508899661722854,
      ],
      [
        0.0009118772774047013, 0.018514789217306173, 0.027679955552445346,
        -0.08218412989232671, 0.053948912811306156, -0.030034107674206747,
        0.020504522790314506, -0.01887404648278468, 0.018698316053300808,
        -0.016593552002122317, 0.012301641372769238, -0.00738534390470367,
        0.0034706966582559178, -0.0011900959923708586, 0.00023578174479723006,
        1.7494913982947725e-5, -3.3220071128799143e-5, 1.2959435139570456e-5,
        -2.7184917204646216e-6, 2.583816200103717e-7, 1.6049023319992055e-8,
        -7.082595445727052e-9, -1.1364780945062514e-9, -7.751629867008017e-10,
        6.496796322923274e-10, 1.5012452581940463e-9, 9.948318571887698e-10,
        -4.1147442945645095e-10, -1.445576087658963e-9, -1.1720513281022676e-9,
        1.616723395504447e-10, 1.3491510037280519e-9, 1.3162325155673206e-9,
        9.268836148536613e-11, -1.2146980165325158e-9, -1.4233059117013975e-9,
        -3.4443725904373966e-10, 1.0459994813933562e-9, 1.4902577250290449e-9,
        5.864735514972091e-10, -8.478162174338292e-10, -1.5151923798877603e-9,
        -8.119796989341996e-10, 6.25731981794595e-10, 1.4974251161556908e-9,
        1.0145901017617228e-9, -3.860062863401803e-10, -1.4374347106623226e-9,
        -1.1886069500413267e-9, 1.353961588923721e-10, 1.3369272048456708e-9,
        1.329113915020747e-9, 1.1902329735244116e-10, -1.1987256474059578e-9,
        -1.4321499330542595e-9, -3.700944239341731e-10, 1.026741303897279e-9,
        1.494813948919872e-9, 6.107274184170969e-10, -8.258081425329291e-10,
        -1.5153403221049073e-9, -8.341462099972222e-10, 6.015912692243933e-10,
        1.4931481214162032e-9, 1.0340487453535009e-9, -3.6041694162250303e-10,
        -1.4288630253844453e-9, -1.204802510351407e-9, 1.090855071497323e-10,
        1.3242980316469207e-9, 1.3415875250849812e-9, 1.4532525872579357e-10,
        -1.1823999045449279e-9, -1.4405607628707528e-9, -3.956364561212555e-10,
        1.0071679782863782e-9, 1.4989156359444501e-9, 6.347944965480321e-10,
        -8.035429881432581e-10, -1.5150257246431485e-9, -8.560598446395092e-10,
        5.772685988220852e-10, 1.488417703926383e-9, 1.0531886477921585e-9,
        -3.347191917679004e-10, -1.419856306493959e-9, -1.2206321300404946e-9,
        8.273512291597307e-11, 1.3112631489702766e-9, 1.3536592723011572e-9,
        1.7158066602871945e-10, -1.165707294516006e-9, -1.4485334080431726e-9,
        -4.210609042008441e-10, 9.872902262019216e-10, 1.502567019333586e-9,
        6.586688134688133e-10, -7.810388206847222e-10, -1.5142476708974099e-9,
        -8.777145892779613e-10, 5.527722846510012e-10, 1.483238706354583e-9,
        1.072009726384283e-9, -3.0892043912879927e-10, -1.410411392363623e-9,
        -1.2360890988807257e-9, 5.636260098189384e-11, 1.2978339238105352e-9,
        1.3653197764576663e-9, 1.9778515945998312e-10, -1.1486643978676444e-9,
        -1.4560652731480864e-9, -4.4635813783064603e-10, 9.671129704829986e-10,
        1.505762012142612e-9, 6.823457787719948e-10, -7.582994117633047e-10,
        -1.513013755481699e-9, -8.991001926349853e-10, 5.281051002939321e-10,
        1.47760355008219e-9, 1.0905043072255069e-9, -2.830308239171482e-10,
        -1.4005497190318886e-9, -1.2511713246698968e-9, 2.99708411044736e-11,
        1.2840089804868204e-9, 1.3765677559446388e-9, -0.0002973947760227107,
        -0.006100366199059491, -0.009260202041910953, 0.027364534952252165,
        -0.01803876170078919, 0.010113381598676049, -0.006977804621193868,
        0.006472076079548047, -0.006423389018286869, 0.0056899264912276945,
        -0.004199960845597566, 0.0025039895417872833, -0.001164245626290667,
        0.0003920173426452617, -7.396758511429177e-5, -7.831149912876052e-6,
        1.15348384023181e-5, -4.339923699345933e-6, 8.862608125385022e-7,
        -8.110567836594179e-8, -7.016432555266787e-9, 1.885056703440752e-9,
        1.0605631150063588e-9, 1.4371154283547266e-9,
      ],
    ];
    const result = wavedec(data, "db25");

    const reconstruction = waverec(result, "db25", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db25_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49467801209936274, 0.9087427690078567, 1.1797535265647312,
      1.277014977244247, 1.2071515097159984, 1.0103690605562334,
      0.7485127983224733, 0.4881511844274317, 0.2831827105583855,
      0.16154000948187203, 0.11943934090053548, 0.1245915008131894,
      0.12739119370186724, 0.07697040251821213, -0.06229917023789627,
      -0.2983950519343695, -0.6067818809422167, -0.934550076217271,
      -1.2126083021132685, -1.3728245879731482, -1.365664496471555,
      -1.1736974225671146, -0.8173835375576686, -0.35154253437937166,
      0.14668009946022, 0.595326871666702, 0.9261803968529907,
      1.0996526363019261, 1.1122779993770568, 0.9950170904843378,
      0.8029793245949339, 0.5994038211328494, 0.43821276444656765,
      0.3497834844878846, 0.3336900749580283, 0.3602813329164287,
      0.38058862863340936, 0.3418231902111536, 0.2042184147242509,
      -0.045402555120667654, -0.3871004023649547, -0.7702430021855416,
      -1.1244147889639624, -1.3760873208267301, -1.4667740680114154,
      -1.3679602836528812, -1.0889030810595612, -0.6752283953195379,
      -0.1986305749650729, 0.25971720802967907, 0.6278119134075106,
      0.8587834881023656, 0.9401507148830333, 0.8941219252731919,
      0.7690459111011865, 0.6244326708911976, 0.5136299465387657,
      0.4688224330005885, 0.492365253366219, 0.5567471511848231,
      0.6131570390868627, 0.6063149045907803, 0.4915369019844945,
      0.24938294645942535, -0.10615090720498838, -0.5282439548849109,
      -0.946695094237228, -1.283889614825715, -1.4732370094879934,
      -1.4753451078373834, -1.287752792087508, -0.9456963158695825,
      -0.5136999930599948, -0.07015336255658444, 0.3111582060853379,
      0.5778371047896904, 0.7097123851034985, 0.7210608208147377,
      0.653815923032581, 0.5637417145917198, 0.5033865477853698,
      0.5064546193462665, 0.5778239839861846, 0.6919097213877105,
      0.7998253378360366, 0.8434291600697292, 0.7724819893589006,
      0.5602808003421996, 0.2135004004848991, -0.22652391450427964,
      -0.6915986210197871, -1.1016937948073493, -1.3834077178945918,
      -1.4871701622378284, -1.3987826825385488, -1.1423485820797656,
      -0.7738705083241378, -0.3672061259240185, 0.003960904765710482,
      0.28347177467723894, 0.44492011599581593, 0.4956926565378199,
      0.4719382857819927, 0.42598192358089965, 0.4096892149417342,
      0.4583420204628172, 0.5794259794325496, 0.7494034015967126,
      0.9193994611763674, 1.0283350311929353, 1.0200294287108223,
      0.8597035317853889, 0.5454290623342243, 0.11136554671095342,
      -0.3782366833367919, -0.8428725730048681, -1.2040022763544074,
      -1.4030381645675534, -1.4145259220888908, -1.2511853989554873,
      -0.9595856926439379, -0.6076543658970653, -0.26732619314709405,
      0.0031296561409875356, 0.1725257067745588, 0.24249957817994577,
      0.24422394148242194, 0.22712667012800972, 0.24278325655716054,
      0.3284169458720199, 0.49453469472167755, 0.720115242466636,
      0.9567436517029762, 1.1406894682108824, 1.2097873841912896,
      1.1206662680349293, 0.8617336195040826, 0.45839740546656377,
      -0.03098475914079824, -0.5275248744302024, -0.9495020210329577,
      -1.2308648984156967, -1.3358505182909297, -1.2660385409299408,
      -1.0581285127815934, -0.7731373856986588, -0.4799341337902834,
      -0.23747467716397636, -0.08039531905556552, -0.011691693169993633,
      -0.004301068398541788, -0.011024506352952962, 0.019998424966922224,
      0.12852823273879516, 0.32878593252702226, 0.6030602026788533,
      0.9042094545813508, 1.1665331554125515, 1.3222431600918774,
      1.3192461438366268, 1.1355556896604384, 0.786493532472188,
      0.32269518229878086, -0.18068067320477144, -0.6408528761032777,
      -0.9861539784186568, -1.1718542286033922, -1.1890921704303992,
      -1.0647346950284324, -0.8523563131912095, -0.6168348857988225,
      -0.4167029704754458, -0.2889400815374202, -0.24020038435782526,
      -0.2467276412808051, -0.26287676664351367, -0.23585650734741212,
      -0.12264024480822971, 0.09559708325953536, 0.4055120996589611,
      0.762381450939366, 1.099606313623075, 1.3445689806654422,
      1.436767225791323, 1.3435091242260282, 1.06904741597959,
      0.6547140223625161, 0.16994173282242425, -0.3035789491830087,
      -0.6905839978450588, -0.9390125872145602, -1.030643755553263,
      -0.9829801776234992, -0.8420628172833846, -0.6682690495303432,
      -0.5189648823856072, -0.4326719527427178, -0.4189662119019296,
      -0.4567673598476711, -0.5014196267354336, -0.4986035630235206,
      -0.401280029942664, -0.18503846697124365, 0.14237788159777148,
      0.5400711210787232, 0.9419638684341861, 1.2718217062616817,
      1.4615114926391946, 1.46779675445354, 1.2833154305579069,
      0.938872536950829, 0.49642175508122716, 0.03451770037295282,
      -0.37003700362414255, -0.6596580597718396, -0.8081273566689529,
      -0.824407814638866, -0.7473109596598536, -0.6326060393732684,
      -0.5361325040445205, -0.4975018061861503, -0.5287816169948978,
      -0.6111988616738059, -0.7007376894606521, -0.741116861892881,
      -0.6806413076716007, -0.4883619238290965, -0.1651280889124449,
      0.2535588680517544, 0.7038333380904958, 1.1074266477431998,
      1.389799616105681, 1.497821702194008, 1.4124587853532022,
      1.153206902423209, 0.7731394140513221, 0.3458614777250657,
      -0.05224818594529873, -0.3599293452764448, -0.544488852695315,
      -0.6074279331877659, -0.5809496926099089, -0.5164585619564772,
      -0.46826877601798483, -0.4769850017908523, -0.5570775222070254,
      -0.6920329928726262, -0.8384227556384355, -0.9378340269865022,
      -0.9334894938219562, -0.7870995513333174, -0.4913891151774683,
      -0.07484712685045128, 0.4027279037340661,
    ]);
    const expected = [
      [
        -0.4244546433170402, 0.28130055806107657, 1.1385287093497902,
        2.4623513196614097, -0.2157690646892534, -2.718136328013456,
        -0.6073501180614737, -0.5487569193845387, 1.2580430296905143,
        2.1490875736496147, 0.5877110384089287, 2.211745963676127,
        1.4946111723970217, 0.6609725802260256, 0.21545576558153703,
        -2.3379380435665142, -2.0690366418388324, 1.6207468114463024,
        1.2090668687244286, 1.4242606447563824, 0.13242777237467426,
        -1.3338654098375278, 0.05422222929979967, 0.17811724534637266,
        1.7166577826096476, 2.1940029297069867, -1.1443813819636286,
        -2.4297025513699793, -0.2843943331592105, -0.6666328959616074,
        2.0932237297541225, 1.4397229644747367, 0.9445965007476145,
        2.331153768207364, 1.0897410850273175, 0.7966824838263853,
        -0.2582074810678769, -2.8567505590136997, -1.0828022796346795,
        1.7522358536072977, 1.1545806798550295, 1.2055141189234018,
        0.3352331302378867, -2.71976397356479, -1.6492322726788922,
        1.216804740758237, 1.0510256125034854, 1.4972879766143694,
        0.971242758550804, -2.3984010865750545, -2.0763507926768963,
        0.6450873247532298, 0.790275821498231, 1.6369622030706539,
        1.5947910030976744, -1.9165366410182192, -2.3334889228587086,
        0.09187660319816437, 0.4019303717755523, 1.6035643370568475,
        2.1511304283245156, -1.312041358392411, -2.405275006972102,
        -0.3905917763414586, -0.07214219930174381, 1.3921859072807639,
        2.590769798154274, -0.6333935133280378, -2.292946991960196,
        -0.7574273019173761, -0.5816978240930444, 1.014519741248204,
        2.8739773568915834, 0.06467121885227686, -2.0141520471454606,
        -0.9751919314479078, -1.0727815630783004, 0.4978777877886109,
        2.974403530788079, 0.7260750302487925, -1.6012581604871476,
        -1.0249038657565013, -1.4929677795397969, -0.1164323451343139,
        2.8794382825295175, 1.3026027055410654, -1.1048420767880838,
        -0.8966409799076943, -1.7989402564174697, -0.7866570956077468,
        2.621967448387032, 1.7065189344286282, -0.5394383253064299,
        -0.5574659722413035, -2.294603750879952, -0.3082849277689725,
        -0.3126632687728625, -2.085414872038992, 0.1152168011043576,
        -0.9308486665936064,
      ],
      [
        -0.024472812381883768, 0.040627241961382364, 0.06906374682142316,
        -0.1868733337794551, 0.12399481376543135, -0.07703634592295815,
        0.0698839783494922, -0.08174727617937748, 0.07664243255553772,
        -0.09720636752249252, -0.023834969361522056, -0.1598837623608906,
        -0.11468491736325373, 0.28925041448559674, -0.11370756200946304,
        -0.03410697939240192, 0.0809139429198678, -0.05914574979213225,
        0.010252072049232168, 0.03252925185880843, -0.05051488525456099,
        0.0425435655404627, -0.021252635198873483, 0.003096194723675963,
        0.0024748473810919584, 0.0022169623814890186, -0.007439410068919375,
        0.005664412590637309, 0.0019106254995797272, -0.0075615797631335725,
        0.005439971486744167, 0.0022840034050140524, -0.007653275178417697,
        0.005134027309300772, 0.0026770461989942367, -0.007728783761297601,
        0.004814164177523058, 0.0030626152580733815, -0.007782631832263046,
        0.00448077530780384, 0.0034395840989128166, -0.007814632873854853,
        0.004134833898048137, 0.0038069123551799054, -0.007824716610520616,
        0.0037772720322560107, 0.0041635470519951175, -0.007812840489843586,
        0.0034091307732952983, 0.004508514408307971, -0.007779046515209467,
        0.0030314067556998286, 0.004840815818203915, -0.007723426598725068,
        0.0026451936473282736, 0.005159552822058587, -0.007646133856120242,
        0.0022515443623184928, 0.005463794843721489, -0.007547393865954189,
        0.00185159019374531, 0.0057527261057510075, -0.007427469374608327,
        0.0014464309865422362, 0.00602549740537627, -0.0072867164352511645,
        0.0010372206285228862, 0.006281471658818177, -0.007122346014549076,
        0.0006696723580875731, 0.006835294013020385, -0.005801079831278066,
        0.00179848722223091, 0.00433163281671259, -0.015050307316754207,
        0.047844625701339884, 0.2512118879052673, -0.06359945247423965,
        -0.19248596027527573, 0.35533811557991907, -0.4663488824130038,
        0.011476734214509399, 0.1687008306573852, -0.20397505110830516,
        0.1945047444120304, -0.15891097675287424, 0.10103814985911072,
        -0.044734512557598756, 0.007002170397784161, 0.0061049670483411984,
        -0.0020810568427512433, -0.00496743781431002, 0.004975729693039374,
        0.0017833541644878919, -0.007495460038464389, 0.0057389763791919025,
        0.0018787673269648304, -0.00755482099072935, 0.005444535987116739,
        0.002277325467492935,
      ],
      [
        0.0009272787755881887, 0.01886486671706005, 0.02829329831211481,
        -0.08392170691640649, 0.055138058744417864, -0.030743556322047963,
        0.021040650674203566, -0.01940417108877913, 0.019232840357311598,
        -0.01705998928631021, 0.012633130734935626, -0.00757086578013812,
        0.0035485663647171705, -0.001211656165304726, 0.00023752296351769634,
        1.9189784581067424e-5, -3.4209805300253345e-5, 1.3242031670071684e-5,
        -2.7593024484942704e-6, 2.62194220274568e-7, 1.552081248203848e-8,
        -1.0379389946836698e-8, -3.1595289602148296e-9, 4.778194119967606e-10,
        4.012078850473352e-9, 3.610080226629755e-9, -3.4693096009769866e-10,
        -3.9623047873755775e-9, -3.675812245312717e-9, 2.3042391218413162e-10,
        3.909749480806298e-9, 3.738962643787908e-9, -1.1375464076661372e-10,
        -3.854453144808169e-9, -3.799492970447351e-9, -2.995712206156139e-12,
        3.796452152284404e-9, 3.857356604928228e-9, 1.1974221452304687e-10,
        -3.735786560060925e-9, -3.9125109302307925e-9, -2.364048863949127e-10,
        3.672501005539556e-9, 3.964926123982395e-9, 3.5290318144291426e-10,
        -3.60663842539298e-9, -4.014556717372815e-9, -4.691556513264367e-10,
        3.538245284470521e-9, 4.061368102685917e-9, 5.850766588453352e-10,
        -3.4673732569841738e-9, -4.105336386750147e-9, -7.005865209176949e-10,
        3.3940646208609826e-9, 4.146420839727825e-9, 8.156048310949037e-10,
        -3.3183777511637236e-9, -4.184598058228942e-9, -9.300503122116009e-10,
        3.2403598891635983e-9, 4.2198397576438694e-9, 1.0438429885071514e-9,
        -3.1600708587071005e-9, -4.252115364343777e-9, -1.1569078167219644e-9,
        3.0775644070117102e-9, 4.28141829672721e-9, 1.2691511128248111e-9,
        -2.9928994559008014e-9, -4.307709000663149e-9, -1.3805139032935137e-9,
        2.906128708091599e-9, 4.3309804269462575e-9, 1.490908665492891e-9,
        -2.8173273395000057e-9, -4.351208767279217e-9, -1.600250361690041e-9,
        2.7265511555951913e-9, 4.368391090472633e-9, 1.7084757316705606e-9,
        -2.6338518893278073e-9, -4.382505091785603e-9, -1.8155012199415728e-9,
        2.539313773924353e-9, 4.39354622133837e-9, 1.9212472003583314e-9,
        -2.442994138254685e-9, -4.401505036812626e-9, -2.0256508306199525e-9,
        2.34495572288357e-9, 4.406371609714749e-9, 2.128635071691835e-9,
        -2.245268482643142e-9, -4.408153786692135e-9, -2.230117746157021e-9,
        2.144017002593461e-9, 4.40684199830608e-9, 2.330042628739866e-9,
        -2.0412585898975423e-9, -4.402436599966419e-9, -2.4283356288280733e-9,
        1.937057203255894e-9, 4.394941134314211e-9, 2.5249217658167965e-9,
        -1.8315108603353156e-9, -4.384366027578136e-9, -2.619731898896089e-9,
        1.7246745866171673e-9, 4.370712670952156e-9, 2.712706076100361e-9,
        -1.6166222493726632e-9, -4.353992211610675e-9, -2.803784488571603e-9,
        1.5074424312340468e-9, 4.3342197814325e-9, 2.892889393986815e-9,
        -1.3972067406582579e-9, -4.311407611138017e-9, -2.9799652317195766e-9,
        1.2859854473953483e-9, 4.285564815678961e-9, 3.064950314312459e-9,
        -1.1738621336513976e-9, -4.256718738742748e-9, -3.1477859282686024e-9,
        1.0609126926975206e-9, 6.203692239217887e-5, 0.005231308798445848,
        0.03337801178964904, -0.025442155935948774, -0.04568391154891579,
        0.06631627915125714, -0.06289474326092147, 0.050980194691399416,
        -0.036240444931112885, 0.021802541332246746, -0.010229389662993816,
        0.002938190025943986, 0.0003415750377470698, -0.0010533643684774278,
        0.0007381117766221896, -0.00032332804727131463, 9.440247619835911e-5,
        -1.5953684369696213e-5, 1.0011642930748793e-7, 6.953104172888479e-7,
        -1.7323941351676728e-7, 1.8925609301582972e-8, 4.54688401447719e-9,
        1.3627571100536339e-9, -2.8356929280290203e-9,
      ],
    ];
    const result = wavedec(data, "db25");

    const reconstruction = waverec(result, "db25", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db26", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4858579421362048, 0.8983845269413951, 1.1792925111130201,
      1.2968998985601243, 1.2515605943888748, 1.0737857412178127,
      0.8156232317240354, 0.5374644754779079, 0.29351750399555476,
      0.11946652004001579, 0.02526442948272073, -0.0052812974161501325,
      -0.008153016307840683, -0.027691633945402028, -0.10303340491426544,
      -0.25588273141361373, -0.4827599013319977, -0.7537607110456724,
      -1.0182585680316454, -1.2162607002305896, -1.2927181145098257,
      -1.2113293421157518, -0.9644579222127612, -0.576686260974828,
      -0.10103723901536171, 0.3913544897157027, 0.8257705266750661,
      1.1392773889424368, 1.29337474681195, 1.2810142279746182,
      1.1264283678640887, 0.8779279845948218, 0.5954992705841626,
      0.33625497445599484, 0.14127256498267, 0.026972628755949635,
      -0.016952172220491668, -0.022673338864055363, -0.033755784231595753,
      -0.09178833544084908, -0.22353604098841934, -0.43190548563846143,
      -0.6930748867895337, -0.9606202703326536, -1.1757382881085958,
      -1.2811476246245368, -1.2353156936914789, -1.0235352251732366,
      -0.6630987199682392, -0.20121447245146823, 0.29396077939017967,
      0.7471491369406253, 1.0914488879856252, 1.2819100499651652,
      1.3040561019365773, 1.1754303369540287, 0.939913302895727,
      0.6562798577687665, 0.3838242153359385, 0.16855109856055706,
      0.03325068701828854, -0.026209068280549003, -0.03758539424268337,
      -0.04290199723652127, -0.08546434676934994, -0.19657537553000232,
      -0.38535007708063723, -0.6342633151352084, -0.9016511200028994,
      -1.1306666701287846, -1.2625875077754154, -1.2512724055925333,
      -1.0752440018047689, -0.7444078183440324, -0.2996823429499804,
      0.19449617567469402, 0.6631249490981687, 1.0360631197774717,
      1.2623624721145645, 1.3201868887405057, 1.2200631166060532,
      1.000800428619913, 0.719164819029796, 0.4358718373385069,
      0.20131428253521988, 0.044462356594604735, -0.03243801247709682,
      -0.05218833579769749, -0.05452731569523281, -0.08371676588343163,
      -0.1750105455943599, -0.3434658310420947, -0.5779774747963504,
      -0.8421277255276903, -1.0817594250311455, -1.237511866113298,
      -1.2593124255426607, -1.1192990989899103, -0.8199876518707954,
      -0.39561264796092005, 0.0938044152298673, 0.5743666346615187,
      0.9734646681950371, 1.234680434309068, 1.3289805069031921,
      1.2596356907554556, 1.0598038937058876, 0.7834640540397046,
      0.49196621329429496, 0.23948601210383325, 0.06089495560317687,
      -0.035070774953231965, -0.06578511240962509, -0.06798971870702648,
      -0.08612865166250677, -0.15876375433194923, -0.3065436726844861,
      -0.5248142567478098, -0.7828126082097682, -1.0297605922173538,
      -1.2064630248446635, -1.2596386788444378, -1.1555057191745153,
      -0.8892814678220513, -0.48820856496679466, -0.007256831441876915,
      0.48159880297316027, 0.9040826961757629, 1.1989053944706793,
      1.3300902461973974, 1.2935040303716376, 1.1161420315530388,
      0.8484477802357518, 0.5516027888722341, 0.2829022616141815,
      0.0827546843835199, -0.03359342054212505, -0.07769278422778846,
      -0.08261766877697886, -0.09221722775464092, -0.14767132968211866,
      -0.27478988779707947, -0.47530822718985044, -0.7244440081322482,
      -0.9754344950629722, -1.170043849743581, -1.252540757451242,
      -1.1837613021161446, -0.9518083037583059, -0.576714459395457,
      -0.10782658108700402, 0.3855931202591315, 0.8284259369951572,
      1.1551719053516596, 1.323253860337025, 1.3210799713811372,
      1.169047477457408, 0.9133561055736606, 0.6142104094652128,
      0.33131264211038963, 0.11016305420483496, -0.027554118255769533,
      -0.08725264737242966, -0.0977200651561781, -0.10144122012648885,
      -0.14148663931803923, -0.24832388637321795, -0.42992476736197366,
      -0.667726056985341, -0.9195553308262293, -1.1289092865426178,
      -1.2383904741577476, -1.2040561897610484, -1.0071686223389504,
      -0.6604251448825089, -0.20705120030216406, 0.2871588080065446,
      0.7470766361088498, 1.103706448603663, 1.3082975577860754,
      1.3418393793818473, 1.2177775166372018, 0.9774090455299806,
      0.6791585789343966, 0.3843831509497419, 0.143154477816889,
      -0.016570102034723144, -0.09384002955123383, -0.11259646777558716,
      -0.11320899894154193, -0.13988414777311953, -0.22717716801818555,
      -0.38905418194282254, -0.6133194498581633, -0.8628966675340672,
      -1.0837572367534227, -1.2176363427831305, -1.216473066629846,
      -1.055048867862383, -0.738694472904724, -0.3040949678168658,
      0.18713264693961978, 0.6606835236524111, 1.0448250594555493,
      1.2851388361047822, 1.3553294907638118, 1.2616241404943573,
      1.0398168498851525, 0.7457655532846144, 0.44170007762663926,
      0.18167505572195275, -0.0003336874090926756, -0.09687362298055135,
      -0.12654745241180462, -0.12688741355790353, -0.1424645597548292,
      -0.2112935020517746, -0.3530068546630792, -0.5618327413051966,
      -0.8062209894042821, -1.0353188933317599, -1.190797059620009,
      -1.2211851845290282, -1.0952248847166595, -0.8109431378192133,
      -0.3981503959812955, 0.08636861950516944, 0.5699539107054207,
      0.9789297727268959, 1.2537881207522672, 1.3611753308690329,
      1.2999236756126293, 1.0997905005755155, 0.8133071610348206,
      0.5027750143162768, 0.22558257590503172, 0.021382738541224355,
      -0.0958242272397603, -0.13888495594577951, -0.14181120007631298,
      -0.14876097898362295, -0.20053031875690897, -0.32200951559107577,
      -0.5138143825184438, -0.75026943163445, -0.9843486668032443,
      -1.1584540748055603, -1.2184533967218536, -1.1275641532096763,
      -0.8766655938873092, -0.4884481742243528, -0.014272671371927975,
      0.4756450141884347, 0.9065039367232952, 1.2143491852993125,
    ]);
    const expected = [
      [
        -0.9732350761648381, -0.44981409682413476, 0.4686005801176259,
        2.725169725674842, 1.0154806725435177, -2.1446359812289697,
        -1.5008321340967092, -0.38851005447925885, -0.1756209151033309,
        2.5823131067272502, 0.9189320244411627, 1.378140750580601,
        2.3381672573863135, 0.7506400238646169, 0.4140651246755828,
        -0.8632937926560946, -2.7253859480086895, -0.523041201227691,
        2.443370086966245, 1.0670627541338376, 0.6631549085231858,
        -0.7582405985202568, -1.6113990758641823, -0.5823462495660139,
        -0.5144736352663379, 1.386565051885841, 2.6785935301418924,
        -0.1574788898896435, -2.458152042008613, -0.6532335548641988,
        -0.9051721074717094, 1.056381298716722, 2.2568777275953247,
        0.588943323304655, 2.0841258412643335, 1.8382319022501994,
        0.5252266341511898, 0.3503554503882324, -1.7331660684022399,
        -2.532966566467437, 0.8263955020103093, 2.2308763475681723,
        0.7322832908250615, 0.4613628826302894, -0.9274830291147234,
        -2.796700579787371, -0.3189732844131387, 2.3235124785523253,
        1.1572257708269655, 0.4306301162900113, -0.23910604468553545,
        -2.5595294489756077, -1.4560268586875453, 1.9708978912066721,
        1.7049857095503829, 0.42985720722506143, 0.19387254772413248,
        -1.9456837781782186, -2.323405156765029, 1.1724626475743753,
        2.189343107184483, 0.6038581786681597, 0.35585382163091056,
        -1.16950976706121, -2.7359691508716932, 0.06720478709042171,
        2.3996307955410594, 1.00534496025982, 0.3472977589308627,
        -0.4579897320043194, -2.6412395264475155, -1.1041049689256115,
        2.1805824661371083, 1.5657702431961094, 0.3344288941095325,
        0.027383022544705968, -2.1302118428296075, -2.073028431352305,
        1.495743360361088, 2.1137258482654624, 0.47461624227623117,
        0.2412395762657966, -1.3993238937968973, -2.6279192393045943,
        0.4505567695277218, 2.4350144489613874, 0.8456029272218105,
        0.25928552258391, -0.6748990357646943, -2.688608622649237,
        -0.7110204328525501, 2.3059788554983567, 1.4875810752975416,
        0.10963297459255379, 0.044096857232631355, -2.5317229612536516,
        -1.5606274096482355, 2.0023178316287846, -0.0714899304492563,
        1.4481674499788062, 1.8199238365346375, -1.4730452451048757,
      ],
      [
        -0.009982065532566493, 0.027271937283406347, 0.04661413990846454,
        -0.10679086391053166, 0.043467002362439895, 0.0008243044816050141,
        -0.008683534129331481, -0.005096229143566783, 0.029131071765259583,
        -0.019531479672849437, 0.06878228142169285, 0.07253621687190595,
        0.19003371580046508, 0.03618700075526119, -0.2912979248711499,
        0.28795388301212826, -0.22537367292428498, 0.18485321375642477,
        -0.1644668603481525, 0.14432140393063048, -0.11278040745638333,
        0.0725558536746449, -0.035296855642963997, 0.011384164361381942,
        -0.002568182220479668, 0.002304236233698459, -0.0024257521635787415,
        -0.00023486011015103793, 0.0030597356505313255, -0.0025389146030804005,
        -0.000889669459304196, 0.003246824749290599, -0.0017638430529470033,
        -0.0018040757617832776, 0.003239102222323019, -0.0008448417379121468,
        -0.0025481877719511596, 0.0029287470954800707, 0.00015306288551832743,
        -0.003053926065760928, 0.002344428271327733, 0.0011366584237672826,
        -0.0032739809070797565, 0.0015408000597892674, 0.00201391753479781,
        -0.0031877816291755205, 0.0005930396359482275, 0.0027027946529145945,
        -0.0028033758864481374, -0.0004101953565454115, 0.003138833849700893,
        -0.0021567396285024003, -0.001375061134927479, 0.003281260086498638,
        -0.0013083439083543692, -0.002211294586281896, 0.0031167383270201935,
        -0.00033756964142179927, -0.002840679120530441, 0.0026606682969883815,
        0.0006647915704237478, -0.00320432903313632, 0.001955705404267403,
        0.0016049563852116612, -0.0032682396327079173, 0.0010677994600782142,
        0.0023949957367234904, -0.0030264124472410355, 8.006837067207004e-5,
        0.00296030635142787, -0.0025235383298706673, -0.0011371691834001513,
        0.0020306632292313117, -0.0060171904794653905, -0.012839516084247925,
        -0.022431797211958725, -0.05234740716661474, -0.021799836709244933,
        -0.0062673837287769065, -0.04882008119649733, 0.2093556612885156,
        -0.21475024469191023, 0.31534003560478385, -0.27285866024026767,
        0.23038717591833827, -0.15773887880521095, 0.08879792840304711,
        -0.03663321341093084, 0.008956595357596771, -0.0003999966705491425,
        -0.0004901142437439466, 0.001676947640053362, -0.0036652397380413796,
        0.003328952930473363, 2.6392147554364485e-6, -0.003019296270830478,
        0.002396982842832989, 0.001066481836324464, -0.003268056432140258,
        0.0016055113109292246, 0.00195519207541688, -0.0032044697881281605,
      ],
      [
        0.0006705014235230672, 0.015320652191404483, 0.03176005771821095,
        -0.07375595570560231, 0.03188111768452177, -0.0036622970593247644,
        -0.004816179746144832, 0.002362056192647143, 0.003438245625526491,
        -0.007815658399422006, 0.008900075236817974, -0.007230153593495719,
        0.0044916145306940925, -0.0021428154226445888, 0.0007516548580985596,
        -0.00016524650166835123, 3.289016244632806e-6, 1.3755646318277675e-5,
        -5.839427273674692e-6, 1.2548817769388719e-6, -1.25940741806854e-7,
        -5.213415640161426e-9, 2.1516501238500334e-9, 3.5899752250593846e-10,
        7.921839445550938e-10, 3.581379551561488e-10, -4.079473721346567e-10,
        -8.016941114593654e-10, -4.637303873857419e-10, 2.974869572196109e-10,
        7.871833349044597e-10, 5.584087740674769e-10, -1.800266867611352e-10,
        -7.541548707500676e-10, -6.399554566854035e-10, 5.833432773140762e-11,
        7.033829512622114e-10, 7.064467783728575e-10, 6.473004879069398e-11,
        -6.360649111652967e-10, -7.563208546790875e-10, -1.8627183616357028e-10,
        5.53785726754884e-10, 7.884003411995584e-10, 3.0343689993418076e-10,
        -4.5848017684515163e-10, -8.019323276388616e-10,
        -4.1345651593918523e-10, 3.523856041835279e-10, 7.96601770371095e-10,
        5.137559710261832e-10, -2.380045052434207e-10, -7.725330197260792e-10,
        -6.019621829290283e-10, 1.1802191680308028e-10, 7.302864280427381e-10,
        6.7601689430139e-10, 4.733988584061772e-12, -6.708645750002633e-10,
        -7.341597926132911e-10, -1.2738369865688882e-10, 5.95659022115873e-10,
        7.750375696721313e-10, 2.4703373120382913e-10, -5.064442891616923e-10,
        -7.976800010921391e-10, -3.6086989307358544e-10, 4.053101467188431e-10,
        8.015643261141855e-10, 4.66226438570614e-10, -2.946441659752383e-10,
        -7.865831717029266e-10, -5.606034439746595e-10, 1.7704913541879774e-10,
        7.531033324591171e-10, 6.41799262407473e-10, -5.528439608581188e-11,
        -7.019060974731326e-10, -7.078892728581364e-10, -6.777882371312506e-11,
        6.341961579112186e-10, 7.573354835642563e-10, 1.8924430066293512e-10,
        -5.515668008119608e-10, -7.889648962027618e-10, -3.0626543984887485e-10,
        4.5596761408729336e-10, 8.020270081830665e-10, 4.160731566255814e-10,
        -3.4963648374508574e-10, -7.962296881232602e-10, -5.161035296098828e-10,
        2.350829254305979e-10, 7.716974819173803e-10, 6.03980059543965e-10,
        -1.1499427401582108e-10, -7.2901640102183e-10, -6.776570149884876e-10,
        -7.791575439107908e-12, 6.691816675790288e-10, 7.353885665005346e-10,
        1.304044472818998e-10, -5.936084548788611e-10, -7.758253536960277e-10,
        -2.499350905249198e-10, 5.040704080246713e-10, 7.98006146547553e-10,
        3.6360442502416565e-10, -4.0267046493500973e-10, -8.014141067626845e-10,
        -4.687077208798841e-10, 2.918004729024096e-10, 7.859757508308744e-10,
        5.627868636593894e-10, -1.7406105734606117e-10, -7.520450627224125e-10,
        -6.436263398949949e-10, 5.222535647098591e-11, 7.004258118005241e-10,
        7.093249857732088e-10, 7.08216075587174e-11, -6.323179296182838e-10,
        -7.583420970342541e-10, -1.922240938381718e-10, 5.493498023903666e-10,
        7.89514943032037e-10, 3.090858242432713e-10, -4.5344387872448114e-10,
        -0.00019848841507326105, -0.004478426804146916, -0.0091269023596133,
        0.021288221576283288, -0.00916868813173622, 0.001039724417776801,
        0.0014204737208378868, -0.0007652935584374567, -0.0008505118643756239,
        0.0020900523749714183, -0.002426568721248256, 0.0019965963360655346,
        -0.00125638915006079, 0.0006088991205913693, -0.00021848625608156881,
        5.028634283046474e-5, -2.1551926221889767e-6, -3.6738290991494684e-6,
        1.661522709685758e-6, -3.712993674202759e-7, 3.858927059582529e-8,
        1.4052107436985666e-9, 9.627746380159314e-11, 5.266414597125987e-10,
        -2.764768410855038e-10,
      ],
    ];
    const result = wavedec(data, "db26");

    const reconstruction = waverec(result, "db26", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db26_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4925200288698842, 0.9083099147193234, 1.1869165549616667,
      1.2965456550366958, 1.2396183738895563, 1.0502623555075536,
      0.7844875149383558, 0.5055918442091643, 0.26849363165200013,
      0.10690790525956512, 0.026524104752190525, 0.005792859077494897,
      0.003983764738514722, -0.025676143527778472, -0.1212654330639662,
      -0.29972135965426266, -0.5499900111941656, -0.8336574992547499,
      -1.0930399277846323, -1.2648005481272087, -1.2957316295552794,
      -1.1567479760859987, -0.851539913580597, -0.41762840052939754,
      0.08056835334126736, 0.5650746332910189, 0.9609354460099382,
      1.2120630990471384, 1.2925639242075295, 1.2108774726971685,
      1.005839355508538, 0.7357712629958973, 0.4634098062034826,
      0.24048370624832488, 0.09578905872398502, 0.029687882015685785,
      0.016300880044577352, 0.012699117243203106, -0.027383241206197617,
      -0.13894286353929425, -0.3340633187087484, -0.5963369135918639,
      -0.8829137702827266, -1.1337953531234082, -1.2861331012986905,
      -1.2899922983699827, -1.1216259877791062, -0.7908808668401561,
      -0.3407848728995897, 0.16071081950733623, 0.6349245133924304,
      1.0091916283902025, 1.232155118007286, 1.2839488336614056,
      1.1788902894419235, 0.9601527565771676, 0.6878638507508764,
      0.4236848709840002, 0.2157615315645927, 0.08779549238338286,
      0.034905730366668386, 0.027203343531197292, 0.02003347211047543,
      -0.031859850422785385, -0.15998831258485985, -0.371382990393963,
      -0.6443408533288999, -0.931879571234892, -1.1721602031671767,
      -1.3033492264644186, -1.2792322112652477, -1.0816549985855701,
      -0.726616869470671, -0.26238905963228615, 0.24000478009500173,
      0.7017221847159965, 1.0528857513728243, 1.2471963125681658,
      1.2708941086751264, 1.1439881127251865, 0.9135862834799098,
      0.6411051338072089, 0.3866297084287859, 0.19436304579513924,
      0.0827828272983851, 0.04189588336557187, 0.038159342328813864,
      0.02568023158928287, -0.03929355743536278, -0.18441614880293883,
      -0.4115118705699083, -0.6936881565761605, -0.9801719499229113,
      -1.207777462687826, -1.3162085481786967, -1.2633909919399489,
      -1.0369745552758642, -0.6590585770421866, -0.18285200895761078,
      0.31803412719787705, 0.7651430039037486, 1.0918586320725452,
      1.2572263345460777, 1.2536230310773433, 1.106518219916353,
      0.8665223380196824, 0.5958169408571545, 0.35242704703827665,
      0.17629008375182936, 0.08057717406182502, 0.05035920499323157,
      0.048827178477920785, 0.029348795260285165, -0.049843235715760825,
      -0.21220664141307738, -0.4542507073033193, -0.7440456966095113,
      -1.0274049369140081, -1.2403045666119263, -1.3244992549514072,
      -1.242444027117004, -0.9877584098944745, -0.5885408772889448,
      -0.10259305526183063, 0.3943924512632812, 0.8248876056349621,
      1.1259856987836063, 1.2623202531344853, 1.2323864285445494,
      1.0668408983778188, 0.8193388017490956, 0.5523004598620577,
      0.32122829676248515, 0.16151057698674742, 0.08097685316983305,
      0.05998199027613957, 0.05886753214068555, 0.030767292387485656,
      -0.06363744509909813, -0.24330590110882072, -0.4993710053918451,
      -0.7950635897521853, -1.073192759505857, -1.269416326280762,
      -1.328040001823264, -1.2164028640246674, -0.9342133063524021,
      -0.5154203625642938, -0.022036602729310798, 0.46868614871126485,
      0.8806841312507786, 1.1551777903247662, 1.2625877321690309,
      1.2074604423554942, 1.0253263679193905, 0.7724058871407783,
      0.5108338074241672, 0.29315244346594904, 0.14995904555303136,
      0.08375435361989036, 0.07043889078591184, 0.06794661057538819,
      0.029685154590838536, -0.08077309024255813, -0.27762611462538583,
      -0.5466167850709279, -0.8463780419069834, -1.1171530645924461,
      -1.2948077203374986, -1.3266815669448735, -1.1853153126841014,
      -0.8765774964449582, -0.4400726240408407, 0.058391132340826754,
      0.540537423617652, 0.9322902307174292, 1.1793816647456268,
      1.2581719255051236, 1.1791440924817476, 0.9823516303610567,
      0.7260830635989206, 0.47166980161942257, 0.26828522410316596,
      0.14153737700933822, 0.0886585129851189, 0.08139594011977108,
      0.07573925043476148, 0.02587550690814222, -0.10131434996464617,
      -0.31504607131483775, -0.5957065803446032, -0.8976143219114091,
      -1.1589101234064327, -1.3161965267574178, -1.3203082481014798,
      -1.1492652519037099, -0.8151189974376509, -0.36288939000360865,
      0.13826539358740472, 0.6095871586492536, 0.9794948214750319,
      1.1985802134178454, 1.2492480999969313, 1.1477566605798826,
      0.9382972726815403, 0.6807160840558041, 0.4350339568421564,
      0.24667858931212577, 0.13611588585545142, 0.09541690035075595,
      0.09251365362755093, 0.08193194700208314, 0.01913735684123946,
      -0.12529188675720532, -0.3554119775668776, -0.646335660360548,
      -0.9483898368726558, -1.198097991262311, -1.3333257738570805,
      -1.3088389872948063, -1.108372140356287, -0.7501336055232157,
      -0.2842755318870383, 0.21716614393404052, 0.6754976315343906,
      1.0221195897529207, 1.2127923789976855, 1.2360219978405311,
      1.1136349129666419, 0.8935442506070703, 0.6366341370407278,
      0.40112271733935867, 0.228350457712805, 0.13353464422685135,
      0.10373838179194642, 0.10345017602548728, 0.08622578459256439,
      0.009297562679907556, -0.15270234340621708, -0.3985385524903731,
      -0.6981784553678417, -0.9983172837719475, -1.2343635957898227,
      -1.3459659896239409, -1.2922282137633236, -1.062790236579179,
      -0.6819426814939383, -0.20464596281269765, 0.29468128526192294,
      0.7379550546439706, 1.0600202220863297, 1.2220727782215373,
      1.2187279522198138, 1.0771301869877818,
    ]);
    const expected = [
      [
        -1.2231884525373575, -0.3895197524149211, 0.23261390344114316,
        2.5858168788347444, 1.3420957800497997, -2.036111128053139,
        -1.6145116426531803, -0.3919112317365963, -0.21874165437608487,
        2.55532497287864, 0.908165445043638, 1.4151921180778735,
        2.295330330078501, 0.7162728165904069, 0.4526533550364654,
        -1.029327222491913, -2.7590833649547237, -0.12001596561417605,
        2.402751891765311, 0.8935380373531677, 0.6780204428369114,
        -0.8886484181073222, -2.0487323709149887, -0.6991454888694968,
        -0.5155483573751956, 1.0756762436984084, 2.733856247318516,
        0.1659275385672886, -2.4814629063103713, -0.7193050583170577,
        -0.9184640282843342, 1.0136726710959887, 2.232078466825663,
        0.5970682468231255, 2.1114903942530145, 1.7648490512658335,
        0.5452662362908351, 0.3369473493386528, -1.9472096956583302,
        -2.36631866278316, 1.159417958076684, 2.0436632869615243,
        0.6502325558592155, 0.5183629464449875, -1.3814483451458066,
        -2.7316651919314436, 0.4165256014700685, 2.219575695395647,
        0.8425154492617078, 0.5945042990708796, -0.797357081538489,
        -2.8458147469393387, -0.4062038099955638, 2.221309507882474,
        1.1158738392855558, 0.6055906349499268, -0.2640415478910555,
        -2.7107654042943268, -1.221886510780524, 2.0140534300234387,
        1.4398943293542743, 0.6011804575626936, 0.16679390593037643,
        -2.3597322000273713, -1.9419101832384391, 1.5905015285573023,
        1.7642334161575208, 0.6293373707258682, 0.46778126653582286,
        -1.8510281380047227, -2.4886076876667294, 0.9740988023204599,
        2.026935329799278, 0.7262443459205733, 0.6383688789466095,
        -1.2582349656202656, -2.806324543544779, 0.2173533566150593,
        2.165265100932166, 0.9081325616876584, 0.7025296410183139,
        -0.6583315135550007, -2.8691037628051017, -0.6045411914366097,
        2.1268335821758915, 1.1683236508154577, 0.6985365290906941,
        -0.11172456641941961, -2.6982333373572125, -1.3825496782082465,
        1.8546529572050265, 1.4982916084764755, 0.6641799686472376,
        0.33028632984294615, -2.3341230672423303, -1.956139669343463,
        1.0683785711350073, 2.322870996482264, 1.8113287422379596,
        1.6961285069444716, 2.7531593344002254, 1.7493691005006295,
      ],
      [
        -0.011985894336336445, 0.02067432985941683, 0.0315547410299162,
        -0.07174745063827109, 0.027773015420188556, 0.0038166985765967607,
        -0.007934478767541308, -0.00517881900247203, 0.027200358462159825,
        -0.015071262238029275, 0.06367928344050246, 0.0796689259747994,
        0.1893584665039283, 0.03853474816937227, -0.2969240125677774,
        0.2935759430249505, -0.2309735047239792, 0.19113747144153978,
        -0.17127595519959335, 0.15072718823036266, -0.11768180022354453,
        0.07520247161915913, -0.035674822356879105, 0.010375811212382327,
        -0.001610208078376606, 0.0024932168132996294, -0.003657896475050065,
        0.0008017528364342661, 0.0033947645391143, -0.0040535470064837755,
        0.0002580109380132987, 0.0038073205659033185, -0.003599072868071878,
        -0.0006470808292520291, 0.00416709362372559, -0.0030115785067186037,
        -0.0015229456015100333, 0.004348715185809341, -0.002295194670137285,
        -0.002333558998448037, 0.0043440373499097264, -0.0014804681469049483,
        -0.0030441919887054833, 0.004153248141284865, -0.0006023285585673126,
        -0.0036244146316169027, 0.0037845310358368424, 0.0003016282431118262,
        -0.004049352273263305, 0.0032536753656167306, 0.0011926507172251382,
        -0.004300818781181525, 0.0025834283055540027, 0.0020325895756772325,
        -0.00436802025304528, 0.001802502694028796, 0.0027854379962986785,
        -0.004248099819330289, 0.0009443535935759214, 0.0034189636711501625,
        -0.0039461716813660236, 4.574941721181504e-5, 0.003906006008788863,
        -0.003475195299066764, -0.0008548187018219116, 0.004225716654970537,
        -0.0028553230118648536, -0.0017187404372628792, 0.0043650283693137575,
        -0.0021041168442898746, -0.002448564912409115, 0.0044751441569011625,
        -0.0016276411056870572, -0.007187887046929187, -0.009883310740830332,
        -0.02236987790216721, 0.03413231770452161, 0.13246916023388586,
        -0.2280614193022605, 0.08246153124137322, 0.22484621485061518,
        -0.4518096231589705, 0.3619632222634376, -0.1934823783481466,
        0.12612432471332125, -0.08600260478134661, 0.06583386967274704,
        -0.05267450991528821, 0.037956176252305025, -0.020994632271527577,
        0.006186519460143416, 0.001303694367165159, -0.0007136007275199915,
        -0.0031214947430325594, 0.004099459517373812, -0.0005520080352793831,
        -0.0036455470260752295, 0.0037746765810232345, 0.0003241950618767355,
        -0.004057864980011276, 0.0032384210374501814, 0.0012145656065377193,
      ],
      [
        0.0006799224784572654, 0.01554655241421282, 0.0322589811712246,
        -0.07489628720569805, 0.032379989533786915, -0.0037216035785940143,
        -0.004884862881210085, 0.0023811922682855312, 0.0035213968336093725,
        -0.007971542846683301, 0.009067493141725934, -0.007360518372914371,
        0.004569029154337008, -0.002177673860653115, 0.0007628495984000038,
        -0.00016724853441209807, 3.097998619753491e-6, 1.4024571023181633e-5,
        -5.933017341399022e-6, 1.2723705446419798e-6, -1.277559015840492e-7,
        -5.62531749603228e-9, 2.3082121986845584e-9, 7.893814897533893e-10,
        1.1134276477207e-9, 2.439425142163063e-10, -8.602640463219354e-10,
        -1.1551764192837876e-9, -3.6335595486592555e-10, 7.702934725349366e-10,
        1.1792864515434742e-9, 4.788656980756933e-10, -6.720477674149493e-10,
        -1.1907318645245697e-9, -5.892323909393257e-10, 5.665895505122996e-10,
        1.1893912570685426e-9, 6.932721101095068e-10, -4.5504287014857836e-10,
        -1.1752764192512862e-9, -7.898650091984802e-10, 3.3861244019188873e-10,
        1.1485379884219253e-9, 8.77979851588987e-10, -2.1854075437866422e-10,
        -1.1094651941872881e-9, -9.566626140358857e-10, 9.61228153258909e-11,
        1.058481172729255e-9, 1.0250696226043199e-9, 2.732436933469308e-11,
        -9.961300313437657e-10, -1.0824692509887446e-9, -1.5048089567294683e-10,
        9.230793410454727e-10, 1.128245895398467e-9, 2.720160584389799e-10,
        -8.401170597092856e-10, -1.1619052656615144e-9, -3.906320923536053e-10,
        7.481320523058396e-10, 1.1830878605871583e-9, 5.050549110570635e-10,
        -6.481089309338076e-10, -1.1915619833865104e-9, -6.140536708833731e-10,
        5.41125756720764e-10, 1.1872406076947382e-9, 7.164602654818872e-10,
        -4.283333964236626e-10, -1.1701745388977265e-9, -8.111680304238291e-10,
        3.109447994767257e-10, 1.1405331831460798e-9, 8.971678976013957e-10,
        -1.9020946570210116e-10, -1.0986496047965464e-9, -9.735324179995841e-10,
        6.743951703012085e-11, 1.044963752006309e-9, 1.0394371286391242e-9,
        5.6063735181011096e-11, -9.80056257198353e-10, -1.0941787411869655e-9,
        -1.7895693862590037e-10, 9.046216417114163e-10, 1.137176106015371e-9,
        2.999342059396293e-10, -8.194771154111682e-10, -1.1679613343403764e-9,
        -4.1768198963827777e-10, 7.25527699357771e-10, 1.186197719789785e-9,
        5.309541981035476e-10, -6.23789293410653e-10, -1.1917034597048827e-9,
        -6.385175170346826e-10, 5.153528658395718e-10, 1.1844022028678627e-9,
        7.392274011219172e-10, -4.0137615632162436e-10, -1.1643877433120866e-9,
        -8.320005707808972e-10, 2.830920156122785e-10, 1.1318649320694139e-9,
        9.158316909552369e-10, -1.6177070992038814e-10, -1.0871869392582738e-9,
        -9.898305459919196e-10, 3.871183657055265e-11, 1.0308326693174974e-9,
        1.0531977255932917e-9, 8.476863403820402e-11, -9.634156634896042e-10,
        -1.1052546393318662e-9, -2.0733173765230846e-10, 8.856432143171155e-10,
        1.1454429101887377e-9, 3.2767488103084224e-10, -7.983590715752541e-10,
        -1.1733368203553313e-9, -4.4449247774214777e-10, 7.025096119911409e-10,
        1.1886195605423477e-9, 5.565409637150127e-10, -5.991055965584194e-10,
        -1.191141025113134e-9, -2.1709129202819354e-5, -0.0020448809387303792,
        -0.015520567087437544, 0.005936370728952552, 0.03150799041380995,
        -0.038996122485142413, 0.03549345851216229, -0.029487642567019613,
        0.022804194443068335, -0.015891951500606537, 0.00950119121755663,
        -0.0045454912476705295, 0.0014915523119171184, -0.00010998266275507049,
        -0.00024651389752668634, 0.0001960252806527123, -8.706688996662356e-5,
        2.521433678758722e-5, -4.285900180359924e-6, 1.0554241182665332e-7,
        1.4536649018779894e-7, -3.7360524122584825e-8, 2.836943482458084e-9,
        7.114942530249783e-10, 1.1709697869163518e-9, 5.840275698841555e-10,
      ],
    ];
    const result = wavedec(data, "db26");

    const reconstruction = waverec(result, "db26", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db27", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49933067609092674, 0.9227574708561666, 1.2096596699422637,
      1.3264924959021287, 1.2724306378767483, 1.07766616889133,
      0.7949051811165465, 0.48620706421344445, 0.2083843504694206,
      0.0004728234187965641, -0.1237756635775579, -0.17669252573977104,
      -0.19076543282929392, -0.2076254206469429, -0.26483570126236605,
      -0.3839015558738315, -0.5626083363699315, -0.7737149503842797,
      -0.9704471726574003, -1.0975355152932509, -1.1051418858104582,
      -0.962261377776952, -0.6662580392366944, -0.24608255493759382,
      0.24178681031655408, 0.7239004254887409, 1.1245477500647765,
      1.3812689756104695, 1.4576030038395142, 1.3501460492987003,
      1.0883323646292475, 0.7270625120828601, 0.33398311705168254,
      -0.025538057669811265, -0.30219333043291696, -0.4720736360896217,
      -0.5394807269116817, -0.5327375171889861, -0.49423022420785473,
      -0.46731090048208745, -0.4834316327579668, -0.552793282275074,
      -0.6608958249790873, -0.7718943801007843, -0.8379581185711565,
      -0.8123162766754959, -0.6627273433258605, -0.3819578209151242,
      0.00745466949579221, 0.4555171530859704, 0.893832139705218,
      1.249401043852193, 1.460025099744645, 1.4877279534330154,
      1.32705958472941, 1.0063303381959163, 0.5814818494284469,
      0.12403035114880628, -0.294098071227635, -0.6153132046967367,
      -0.8072978140486474, -0.8676931480302477, -0.8216144761444684,
      -0.7128105477898313, -0.5908011257963393, -0.497267776882934,
      -0.45510905872329777, -0.46287227628245436, -0.49591325416921717,
      -0.5139470196173928, -0.47304935493576167, -0.3390442706155809,
      -0.09884152988628997, 0.23323621466702082, 0.6158891314157026,
      0.9881431622177362, 1.281936704830475, 1.4370906681751099,
      1.4151375747662787, 1.208708795303262, 0.8441992938118719,
      0.3770029329626744, -0.11963929194647718, -0.5696313741589202,
      -0.9094104281713125, -1.1002109441583023, -1.134448713630937,
      -1.0348848469262877, -0.8469576225728019, -0.6262904002961409,
      -0.4245070099529066, -0.276842733568879, -0.19454643630468577,
      -0.16385097921158667, -0.15164416066114667, -0.11630359621050856,
      -0.020873917345652693, 0.1548226458653798, 0.40629706664748916,
      0.7028461568650006, 0.9929045862627266, 1.2151431148257001,
      1.3127188017615574, 1.2472643176328768, 1.0092095640675525,
      0.6218620792365062, 0.13813497756529758, -0.3694486419096854,
      -0.823246845714937, -1.1561853298889353, -1.3250522521726569,
      -1.318382667948195, -1.1571998908752823, -0.8885749868953251,
      -0.5736591553679127, -0.27312956599896604, -0.03355924446785713,
      0.12205844991044301, 0.19745854769556356, 0.2193306312469925,
      0.2277359936113933, 0.26325489833551957, 0.3541979306576618,
      0.5071867518784232, 0.7035651883959863, 0.9026481682126197,
      1.0511087732679372, 1.0962600322630953, 0.9999862072672592,
      0.7498651670273417, 0.364654534298428, -0.10735994411897987,
      -0.5969536083605679, -1.027622430859407, -1.3312165229595896,
      -1.4619580796181761, -1.405617662293046, -1.1817565414701672,
      -0.8385748561219238, -0.4416432230086053, -0.05922150061154635,
      0.2523592088818196, 0.45984004466560435, 0.5581749418967488,
      0.5686238514896101, 0.5304775365652845, 0.48863655280146173,
      0.48025677031506153, 0.5238706493382214, 0.6137517412200401,
      0.720968043295861, 0.8008919411146049, 0.805311302230963,
      0.6961154588021025, 0.4570990821675396, 0.10084414755449522,
      -0.3311931532123987, -0.775628641218457, -1.159659812240464,
      -1.4163029970369871, -1.4988299513873375, -1.3910277386704362,
      -1.110867838932512, -0.7067128236807514, -0.2469414806288981,
      0.19458511364859227, 0.5538334951294731, 0.7891507002229289,
      0.8882216226620194, 0.8679609612831775, 0.7675799620432964,
      0.6367051867510665, 0.5215947633044471, 0.4529158651984278,
      0.4381170675169614, 0.4602586002918344, 0.48354016129307886,
      0.4640875126614109, 0.3632363702507928, 0.15990916235159608,
      -0.14112441116129237, -0.507324120799364, -0.8834726629591145,
      -1.202744052503558, -1.4012232603919892, -1.4324724312359827,
      -1.2786756807771633, -0.9556677350931302, -0.5105779064465013,
      -0.012558158776151213, 0.46130531181785883, 0.8416657217287999,
      1.0805822996862413, 1.1600833180209893, 1.0937606828661512,
      0.9212004850509538, 0.6967574084033701, 0.47550782022677246,
      0.2998480194862367, 0.18999093855769555, 0.14061220675833605,
      0.12435192560823013, 0.10117004487990361, 0.031098371050482465,
      -0.11291374338713506, -0.3353933839501033, -0.6145180032936155,
      -0.9051858505253939, -1.1483919052424336, -1.2847434747269506,
      -1.2688925603898487, -1.0813828705431083, -0.7349796040985518,
      -0.2738354811031805, 0.23446113058255885, 0.7122180738343797,
      1.0873295624549377, 1.3077373877202665, 1.351365260672753,
      1.2293030700515886, 0.981618838617055, 0.6669176899358293,
      0.3482300442164603, 0.07864446384369461, -0.10989405851250156,
      -0.2120194260382076, -0.24745506834231562, -0.25315406007342256,
      -0.27118765872460476, -0.3355373426605612, -0.46120134465588986,
      -0.6384409823106518, -0.8337085138726468, -0.9971306532671568,
      -1.0747779519300056, -1.0227324217835516, -0.819473336764627,
      -0.4734574311568581, -0.023891873666478547, 0.46568271732334426,
      0.9196567410613102, 1.2657066740472949, 1.4497229829348846,
      1.4468711727889971, 1.2662459901637733, 0.9480846801805174,
      0.5542553238381998, 0.15430997846018413, -0.18958808691831835,
      -0.4353317192227992, -0.5682262235434336, -0.6014481064546754,
      -0.5697096762381544, -0.5178830876266263, -0.4875472540230731,
    ]);
    const expected = [
      [
        -1.2153786066397514, -1.1231663277787096, -1.297781484648641,
        1.5344852793511359, 2.7329097274985914, -0.27927701549158934,
        -2.0629810871486116, -0.6009753492979532, -1.1604522566142428,
        1.5746706271125406, 1.9598956011965014, 0.6652500858753242,
        2.3973014471737253, 1.4710731810692832, 0.1274809211341419,
        -0.30911082453238997, -2.1696238383528494, -1.4852780968989263,
        2.2113491123696667, 2.0140886314188604, -0.2577169665791071,
        -0.8076778528463769, -1.3170309443144337, -1.6903356647213446,
        -1.026388147705836, -1.4927968341098352, -0.424499883918103,
        2.6814565694066084, 1.7267229134325286, -1.5641230521677476,
        -1.3162387489355623, -0.9271685836260902, -0.4125980690916605,
        2.500968705762234, 0.8785938712536933, 1.4847964689640953,
        2.372260581882268, 0.6802506328074138, 0.1449066273943,
        -1.038580129732564, -2.5446282592095724, 0.15075482113798977,
        2.746392895167612, 0.8929371007701338, -0.5612225808615623,
        -0.8431618625648127, -2.0664821567048643, -0.3361688659719261,
        2.8304195805558834, 1.3766604415109494, -1.1404342917947374,
        -1.0200325297010682, -1.4048731258374476, -0.594145446617823,
        2.543420033520879, 1.9265466770763917, -1.4085302685663421,
        -1.5152983106422873, -0.7877766917388919, -0.4915671205262675,
        2.0058016827028484, 2.312771804363607, -1.2984588336521592,
        -2.153409912975792, -0.42514237585091447, -0.033179362155468455,
        1.4310315149940416, 2.366068059556619, -0.8855487066815625,
        -2.7033849758521677, -0.4297144932998325, 0.6416372683667411,
        1.0450578652282314, 2.0416504044791237, -0.35901013609095656,
        -2.9659523972408963, -0.7745375918511461, 1.3113930464370176,
        1.0010254353398076, 1.436169697913741, 0.04953835554626927,
        -2.8487332157267184, -1.3031823944316974, 1.7560015777199203,
        1.321463738693186, 0.7513140360125377, 0.15347368739093756,
        -2.400869739104238, -1.7893856952559626, 1.8409756373199282,
        1.8874344633246283, 0.22177446376884924, -0.12457910932760764,
        -1.7855456286139915, -2.0346295400684156, 1.5848172192174288,
        2.4578898433495313, 0.07222411299450208, -0.8078070836290626,
        -1.141197558848396, -1.215889004083686, -0.9230203477057914,
        -1.5752717866149695,
      ],
      [
        0.02900209492416291, -0.022705803767808137, -0.024069316825059556,
        0.0505712721612693, -0.0067618211227435145, -0.014589054941175031,
        0.017814719196626135, -0.0163059616852709, 0.011662873978303566,
        -0.019190884486969557, -0.013597478638015598, -0.04284666570110221,
        -0.12019422512715511, -0.21704767486049983, 0.10032776435995397,
        0.16624616651787888, -0.27636273267907996, 0.2875608760246091,
        -0.25694501318424806, 0.20459649752888726, -0.14054152602937448,
        0.07757230983468916, -0.029276492114274126, 0.0028848877495751633,
        0.004468951306828807, -0.0025282505525602247, 0.00047440735085930877,
        -0.0014093192403078112, 0.002869624734515441, -0.0018609249320024356,
        -0.0010784402927121117, 0.002691512995767354, -0.0011144850798623916,
        -0.0017807282474624324, 0.002564361150771042, -0.0003082584962088407,
        -0.0023132333206483343, 0.0021927670004515476, 0.0005268500766554623,
        -0.002621975789779865, 0.0016091944880969175, 0.0013110248670902501,
        -0.0026772427288906963, 0.0008700311666426061, 0.001968449340812502,
        -0.0024736635539850424, 4.677029845052788e-5, 0.0024355685761215965,
        -0.0020309480364830304, -0.0007810279909905548, 0.0026672189188321604,
        -0.0013918688409436145, -0.0015333019860863928, 0.0026410071204146755,
        -0.0006182402116531545, -0.002137353783653224, 0.0023594657079683196,
        0.0002151738379007908, -0.002534753904479854, 0.001849814519345406,
        0.0010277701764472842, -0.002687112415110871, 0.0011613259555751558,
        0.0017410182677677353, -0.0025796697276510403, 0.00036056135378690924,
        0.002285931677606239, -0.002222842409111214, -0.00047505897473220987,
        0.002609814754314318, -0.001652314126023954, -0.0012770891265160825,
        0.0026121000546496316, -0.001163942806333331, -0.0025358808167746435,
        0.001170079126133082, -0.0034627163255541004, -0.008235820656856912,
        -0.0029403520433843207, -0.014236412485858996, 0.02701982043795178,
        -0.0027354253193221665, 0.0036952964620431943, 0.0033654882517000365,
        -0.0056007161459660495, 0.011202405053231198, -0.013864889515669958,
        0.011581375812842349, -0.004938231201038124, -0.0014983608367622923,
        0.0035760895372309604, -0.001221271339689744, -0.001812135607416349,
        0.0019348258366754265, 0.0006689417256730253, -0.0026442074772822432,
        0.0015241513395468616, 0.0013997900277096208, -0.002666373973473497,
        0.0007732347725453564, 0.002036274495238614, -0.002432105123185543,
        -5.490951649270105e-5,
      ],
      [
        0.0005068621908503133, 0.01294084152226172, 0.034808128337900764,
        -0.0643077171913027, 0.008472115501967265, 0.023356231307227658,
        -0.030885285089205534, 0.025547803563135837, -0.015327001274970387,
        0.0053705408467138145, 0.0013787700322413189, -0.004184852735110367,
        0.004058765820724321, -0.0026692490042824557, 0.0013019090607311852,
        -0.0004658404992276503, 0.00010944655289291485, -8.077605800037966e-6,
        -5.516665403253669e-6, 2.6501110243452083e-6, -5.863258776941126e-7,
        6.123736234430642e-8, 1.3292591776617698e-9, -5.868825125419824e-10,
        1.7174910204409285e-10, -2.3530666707715647e-10, -3.691903173073902e-10,
        -1.647371284615127e-10, 1.8983395057059996e-10, 3.714175063997055e-10,
        2.1453763819045816e-10, -1.3784602683396987e-10,
        -3.6461080636966547e-10, -2.591202882836805e-10, 8.250062103552183e-11,
        3.489421352084083e-10, 2.973999077247624e-10, -2.5150824925104214e-11,
        -3.24785502328482e-10, -3.284512543539029e-10, -3.281420566638924e-11,
        2.927306744537093e-10, 3.5151573043918296e-10, 8.997308667451702e-11,
        -2.535530744430046e-10, -3.6603134675376835e-10,
        -1.4494872770153505e-10, 2.0821897595040857e-10, 3.71640139866224e-10,
        1.9640215923434968e-10, -1.578147477012368e-10, -3.682176887143111e-10,
        -2.430789252181112e-10, 1.0357514529662693e-10, 3.5584185189554006e-10,
        2.8384063653424505e-10, -4.6814030714565715e-11, -3.348124635231291e-10,
        -3.1770020690371754e-10, -1.1082197826979823e-11, 3.056341797980722e-10,
        3.438380446671604e-10, 6.871116651425018e-11, -2.6903323673780595e-10,
        -3.616129115236226e-10, -1.246659850274086e-10, 2.2588577737955414e-10,
        3.705908601559073e-10, 1.7759107974123718e-10, -1.7723384463248333e-10,
        -3.7056167059589513e-10, -2.26197080819454e-10, 1.2429991151367687e-10,
        3.615184779161946e-10, 2.693031396179481e-10, -6.832019165113478e-11,
        -3.436909624025877e-10, -3.058572402882002e-10, 1.0686578098421153e-11,
        3.1749780292794713e-10, 3.349729402380464e-10, 4.7205164799279085e-11,
        -2.8357924313993857e-10, -3.5595600083326323e-10,
        -1.0395500838120508e-10, 2.427743134955871e-10, 3.682752568032942e-10,
        1.581719961541705e-10, -1.9607326111614869e-10, -3.716331285603698e-10,
        -2.0854216008110187e-10, 1.4459040392268877e-10, 3.659585506505844e-10,
        2.5384637211499466e-10, -8.958806056400515e-11, -3.5139057824298273e-10,
        -2.929687889176626e-10, 3.2416473295708444e-11, 3.2827086037327833e-10,
        3.2497791106631495e-10, 2.5540528837404844e-11, -2.9716414029293983e-10,
        -3.4907805610946315e-10, -8.288181412904518e-11, 2.588370365381282e-10,
        3.6468842889249583e-10, 1.3821541665882473e-10, -2.142157083870776e-10,
        -3.714367015845122e-10, -1.9018201500046525e-10, 1.643831644722527e-10,
        3.691486825209241e-10, 2.375146002494837e-10, -1.105561334532219e-10,
        -3.5788186864078485e-10, -2.7907881231992605e-10, 5.403977402673616e-11,
        3.3790683786230873e-10, 3.1385808809592423e-10, 3.7954111755737085e-12,
        -3.0972370104244804e-10, -3.4100399359095637e-10,
        -6.153649627152365e-11, 2.7401090620437783e-10, 3.598579806332154e-10,
        1.1777325949738093e-10, -2.316280437235223e-10, -3.699597139500509e-10,
        1.7224825183889924e-5, 0.0004201386766176886, 0.00106511252581716,
        -0.0019986121186802534, 0.0002784701421834352, 0.0006758527533498109,
        -0.0008984528656147819, 0.0007520531173339038, -0.00047171864143958606,
        0.00019709477638950556, -4.073902229911291e-6, -8.692631129081309e-5,
        9.824199342429325e-5, -7.030153315548773e-5, 3.703639061075162e-5,
        -1.4506885919432693e-5, 3.929886123501071e-6, -5.175927814677157e-7,
        -1.0381459743406537e-7, 7.556331762410064e-8, -1.923908712501249e-8,
        2.7706925189076564e-9, 1.1685586486879683e-10, -2.481137080474918e-10,
        -3.689322529683503e-10, -1.8709412491652012e-10,
      ],
    ];
    const result = wavedec(data, "db27");

    const reconstruction = waverec(result, "db27", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db27_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5075446688269644, 0.9356499616747964, 1.2213034629746846,
      1.3304921590229872, 1.2640099870063224, 1.0552441105616348,
      0.760637148787904, 0.4452918205348894, 0.16733208825065599,
      -0.0351208058487506, -0.15121423706624415, -0.1972206408553933,
      -0.20922530651129878, -0.23070370404706025, -0.29833358636173557,
      -0.4298218731030562, -0.617000726046264, -0.8260940496976258,
      -1.0052152763685485, -1.0972925806451268, -1.055198203411214,
      -0.8552431976619916, -0.5055458741461805, -0.04700933326933046,
      0.4535517067443345, 0.9166595145090828, 1.2667379010578395,
      1.448094673724992, 1.4365410336374163, 1.2439125360266479,
      0.9144725077352154, 0.5141415271623463, 0.11522053116010034,
      -0.2196650598014528, -0.45053689726722446, -0.5669053549090515,
      -0.5869995453051091, -0.5498213246291053, -0.502250062891113,
      -0.4846429810143702, -0.5187180631422275, -0.6008899469476883,
      -0.7028110035553667, -0.779008021674693, -0.7796686275772893,
      -0.6652836892518552, -0.4193332922863977, -0.05564783742943957,
      0.3816251963087693, 0.8256862224434871, 1.200708700510188,
      1.4382437000540145, 1.4924917492621261, 1.3507615502219874,
      1.036575761569517, 0.6046533310623052, 0.12895906904574497,
      -0.31332030961564045, -0.6580504774901476, -0.8668282606361057,
      -0.9331404578464639, -0.8807121854964782, -0.7546924027295188,
      -0.6080839309160038, -0.486969363534301, -0.4183303730936815,
      -0.40354856168806646, -0.4191926333971855, -0.42481411713739553,
      -0.37566647197188757, -0.23698532667744407, 0.003957030804889572,
      0.3312735195606813, 0.7012463294892706, 1.050506165631252,
      1.3097621325281272, 1.4198062964777978, 1.3458921237691595,
      1.0869277502683792, 0.6771527232746642, 0.17977891339913188,
      -0.3259748269739327, -0.761421188860226, -1.0646217851494182,
      -1.202482730760094, -1.1759520440019284, -1.0172420964659659,
      -0.7799527822701163, -0.5246919114932093, -0.3038528415609823,
      -0.14935451154442442, -0.06634430466512459, -0.03431503095461773,
      -0.015184712751722007, 0.03388974059856059, 0.14640005940654943,
      0.334842450653863, 0.5846833040853456, 0.8556499774245679,
      1.090192510899133, 1.2271191502230643, 1.2170556589282575,
      1.035857578270735, 0.692550518826929, 0.2296796451801132,
      -0.28420586304042567, -0.7682811070725295, -1.1462039839209393,
      -1.3619676957881754, -1.391121800647827, -1.2447600909406116,
      -0.9654322148690051, -0.6160940090350475, -0.2648845609215737,
      0.030506768472287504, 0.23508132301663362, 0.34248080442089657,
      0.3733612278805848, 0.36682782553481463, 0.3673131157722667,
      0.4104139447042548, 0.5114423240149502, 0.6597311923607514,
      0.8202505119020259, 0.9422056426367309, 0.9724829139473158,
      0.8705322498058709, 0.6208564473132618, 0.23982054683944554,
      -0.22512918768570417, -0.7038792129599962, -1.1178424831305431,
      -1.3966279811618336, -1.4932382374175321, -1.3941731423296888,
      -1.122035804897542, -0.7300451179677517, -0.2898131939310291,
      0.12463873225081812, 0.45277334469539354, 0.6595591225669478,
      0.7408432260741491, 0.7209769770231231, 0.6435315710056434,
      0.5576510956871226, 0.5036472996966426, 0.5015842869253226,
      0.5457988092035782, 0.6067573806357, 0.6397549402421469,
      0.5981891568504761, 0.4479460447958497, 0.17910942731250873,
      -0.18815713633652892, -0.6052684799685816, -1.0042447921409445,
      -1.3120777300011273, -1.467037946304721, -1.4329925392894411,
      -1.2082382094066486, -0.8266593682038959, -0.3508695479343097,
      0.14106740648509997, 0.5721918158644191, 0.8825581401184619,
      1.0407676026364632, 1.0484922668300687, 0.9370997859576572,
      0.7574336041705263, 0.565470492088354, 0.40755293711204377,
      0.30893846743478787, 0.2685147745949554, 0.2609260850206865,
      0.24544733871725902, 0.17920892270592004, 0.03125216865841285,
      -0.20633270712477686, -0.5132105218326533, -0.8430749882570369,
      -1.1330264854885808, -1.3178704342855152, -1.3458691831310334,
      -1.1920543333127722, -0.8657490986768619, -0.4103309597583455,
      0.10485634142127885, 0.5986201440626873, 0.9947722276143095,
      1.2377580774350614, 1.3034055916872473, 1.20233521001862,
      0.9753690686749235, 0.6822241289276825, 0.3863909471560559,
      0.13998672612587593, -0.02768813571737977, -0.11514703760496675,
      -0.14618730354177148, -0.16067318381921328, -0.20116711659750647,
      -0.2989907625078099, -0.46343219179100553, -0.6770060929977831,
      -0.8981237192099126, -1.0706281197630125, -1.1378761268146995,
      -1.0578486019214237, -0.8154486971522741, -0.4287893111866614,
      0.05228018461935138, 0.5552593535284931, 0.9996684464513821,
      1.3138916206846933, 1.4502219858797325, 1.3945577574195616,
      1.1684890115797757, 0.8233573303417645, 0.42781023460858203,
      0.05192934749806005, -0.2481980265190168, -0.4417624541879873,
      -0.5277507013140235, -0.5317993332651773, -0.4964129831006916,
      -0.4672311812259329, -0.47899502256748566, -0.5449051844649512,
      -0.652168353104956, -0.7649266050482058, -0.8338577497763524,
      -0.8100043805886108, -0.6592718320910185, -0.373813719603918,
      0.02274256421008064, 0.4777690722043604, 0.9194381908868245,
      1.2716452985090911, 1.470545606097152, 1.4787555311570384,
      1.2937996392573659, 0.9487589582870937, 0.5049567067635397,
      0.038438779672480994, -0.37650595553392785, -0.6828532123581623,
      -0.8517272702878818, -0.8861862588884999, -0.8172101452270744,
      -0.6931259889846975, -0.5653133785902068, -0.473917311234166,
      -0.4372386328084472, -0.447491743533341,
    ]);
    const expected = [
      [
        -1.167574329955702, -1.0705644306536655, -1.5291813160240912,
        1.0925384083476817, 2.864029345096997, 0.07849175893363902,
        -2.0417439825861057, -0.6445525364460661, -1.2359169440314683,
        1.5132084707037166, 1.944082713817909, 0.6839340071802138,
        2.420184823100853, 1.3938726666345418, 0.10794602527299214,
        -0.4148719053384363, -2.268213954429982, -1.1404092973809894,
        2.5162994774848797, 1.6452240128520987, -0.43258820627515293,
        -1.0125347582544353, -1.2254714240639404, -1.593194577418614,
        -1.0087917898378682, -1.4860475047178783, -0.8507206710451757,
        2.435209143105102, 2.058222005791829, -1.3516777062875582,
        -1.3480245909028454, -0.9719077466493548, -0.5006309251812111,
        2.4677758245938404, 0.8671487367141073, 1.5282926009446736,
        2.342373937033321, 0.6190404599259965, 0.12364435028174514,
        -1.2121817290331605, -2.473400423293584, 0.6131813295000218,
        2.7353356442477827, 0.5128025713429776, -0.6499710105347561,
        -1.0435765829443453, -2.0149488313935913, 0.49377324054430494,
        2.9739099021650945, 0.5423140856542227, -1.3964125034441945,
        -1.000913792774075, -1.369780595180932, 0.4057095149832515,
        2.9579161469008115, 0.6552921855155461, -2.0207106673508943,
        -1.0987089910361367, -0.6183949445019523, 0.4182527626939755,
        2.6915752234047297, 0.7784896855524754, -2.4476595644959294,
        -1.313515734936747, 0.14242732022880522, 0.5752926561842456,
        2.219063410715625, 0.8324940302413908, -2.6353675074898884,
        -1.588714797909375, 0.8173611038337706, 0.8852378742333935,
        1.615968345866461, 0.7491640385508826, -2.582340369250852,
        -1.846204265702515, 1.3298863274912174, 1.3181759961332407,
        0.9747678237663988, 0.48689390048227865, -2.326726495417472,
        -2.0026479516178584, 1.6358371892789096, 1.810908379458413,
        0.38720120041043327, 0.040585031311722294, -1.9376796690648659,
        -1.9879042049464175, 1.7330429042528994, 2.2729065006195084,
        -0.061030577397848555, -0.5764801879183195, -1.4687502421039893,
        -1.805343126080948, 1.718421888475489, 2.531526767127849,
        -0.21356339736529045, -1.45709564138202, -0.8349228955525401,
        -1.129326488898029, -1.428472742157136, -0.885944348536323,
        -0.9164466454470694,
      ],
      [
        0.029187508737870255, -0.02979885936858094, -0.048331564499573404,
        0.09232459615502493, -0.009475160008638113, -0.035096705121084155,
        0.043161243498152486, -0.03580523660583888, 0.021135689201099372,
        -0.019501576233371336, -0.019628040925029268, -0.0364583186098034,
        -0.1277029847423884, -0.21931684903115414, 0.10213804631560548,
        0.17014634237639595, -0.2839814774232708, 0.29670683024422406,
        -0.2658197922531813, 0.21173265488283977, -0.14505472173156175,
        0.0793544554631823, -0.02898647697031431, 0.0017175733752110803,
        0.005276466197751734, -0.0023399018952248297, -0.00037125260750384413,
        -0.0008822330619993401, 0.003332226221004827, -0.0029420602343005696,
        -0.0005044022642312682, 0.003331359665548116, -0.0023852592201445114,
        -0.0012596673237631171, 0.0034769813365840936, -0.0017559113005123901,
        -0.0019540261383336386, 0.0034506876940156132, -0.0010388761859087263,
        -0.0025496344967623555, 0.003250268577847266, -0.00026941852087075923,
        -0.0030165968256351183, 0.0028857971114427563, 0.0005136437334326018,
        -0.0033312921751086494, 0.002375705959181539, 0.0012707737227658895,
        -0.00347789451726472, 0.0017457028846921774, 0.001963783592018971,
        -0.00344894882613583, 0.0010276135960650625, 0.00255767227658531,
        -0.003245972542434309, 0.00025765104038778715, 0.003022498802904166,
        -0.0028791528814694754, -0.0005253042262869821, 0.0033347697683256366,
        -0.00236705804434776, -0.0012817567652762775, 0.003478764304074287,
        -0.0017354772340944635, -0.001973517018449773, 0.003447173413527826,
        -0.001016337986088164, -0.0025656838269038857, 0.003241597035754148,
        -0.0002463758640171743, -0.003030701951413046, 0.0028795002283140345,
        0.0006826454891106137, -0.002491964734646376, 0.005263714996484459,
        0.008247680694759583, 0.0062289811534768326, -0.012742860801506946,
        -0.022946634069106863, 0.08407776168293474, -0.11196659484134096,
        0.07189250438025441, 0.0049669095288183114, -0.058357946361298686,
        0.054001305279753754, -0.05117478016482293, 0.04224395230974865,
        -0.031725493211054195, 0.01945236552525123, -0.007031099564463943,
        -0.0022200713778161613, 0.005341876128613881, -0.0026430411249234826,
        -0.0017290858493770444, 0.0030708452823321694, -0.0003856842754078969,
        -0.0029328391497504313, 0.0029764729606397973, 0.0003458291177993598,
        -0.003277218830512102, 0.0024970850110323994, 0.0011113098837457816,
        -0.00346094877178958,
      ],
      [
        0.00051535314260346, 0.013165513977042985, 0.03543928088343138,
        -0.06546082778739773, 0.00861707531709782, 0.02379694621421349,
        -0.03146577748542999, 0.026023963355699713, -0.015603482307690339,
        0.005453255997771938, 0.0014242443441077393, -0.004278732608271944,
        0.004143544803173203, -0.002722431355805458, 0.0013266229826230705,
        -0.00047413657991128035, 0.00011117421836630502, -8.10994546557894e-6,
        -5.64323414061963e-6, 2.6999545993789733e-6, -5.963656858397589e-7,
        6.219214033122993e-8, 1.543710481705102e-9, -4.843245006728885e-10,
        1.145438293129381e-10, -4.18592716870105e-10, -5.003725531142123e-10,
        -1.1200185844715678e-10, 3.811730610815977e-10, 5.176711864240228e-10,
        1.6976977863870628e-10, -3.369921943854838e-10, -5.284190000416672e-10,
        -2.253896828096211e-10, 2.885462164597e-10, 5.324789774665433e-10,
        2.7815428956958205e-10, -2.3644695373600177e-10, -5.297972480231733e-10,
        -3.2740201637678796e-10, 1.8135676102497265e-10, 5.204135147638366e-10,
        3.7250103665976025e-10, -1.2396800647414035e-10, -5.044399908048949e-10,
        -4.1289048917388435e-10, 6.501490563799144e-11, 4.820820328564088e-10,
        4.480521019633021e-10, -5.235093408179652e-12, -4.536250920601898e-10,
        -4.775428015775781e-10, -5.460827884580963e-11, 4.194218090786939e-10,
        5.00989027034585e-10, 1.1376159930734422e-10, -3.79917276119119e-10,
        -5.180930510109833e-10, -1.7147387827940089e-10, 3.355960239726256e-10,
        5.286426577441006e-10, 2.2701617698351968e-10, -2.8703183454550845e-10,
        -5.3249799086337e-10, -2.7968941061537435e-10, 2.3483348477632966e-10,
        5.296147410517709e-10, 3.288208393044192e-10, -1.796588790486674e-10,
        -5.200302228464984e-10, -3.737887705890269e-10, 1.2221221682607826e-10,
        5.038631722531877e-10, 4.1402702387810807e-10, -6.322638332622796e-11,
        -4.813151753687934e-10, -4.490223190254899e-10, 3.433741036765661e-12,
        4.5267607013659663e-10, 4.783332271361688e-10, 5.64022424564806e-11,
        -4.1831124546012794e-10, -5.015951467674701e-10,
        -1.1552078775574778e-10, 3.786520132167742e-10, 5.185057161415406e-10,
        1.731811680863806e-10, -3.341936623789793e-10, -5.288552183081219e-10,
        -2.286462547599281e-10, 2.8551450974470917e-10, 5.325072430993212e-10,
        2.812229461751908e-10, -2.3321556235988365e-10, -5.294224886984929e-10,
        -3.302354950887519e-10, 1.7796470176865646e-10, 5.196398990582502e-10,
        3.75067598758811e-10, -1.204638658962801e-10, -5.032744265705303e-10,
        -4.1515305261655426e-10, 6.143750288924067e-11, 4.805439750625945e-10,
        4.499872521897019e-10, -1.6356880727185328e-12, -4.517269001780421e-10,
        -4.791249242485934e-10, -5.8187516873099944e-11, 4.1719414161143864e-10,
        5.021961801209578e-10, 1.1727584244276468e-10, -3.773806299377756e-10,
        -5.189130962730476e-10, -1.7487845576953733e-10, 3.327916180172916e-10,
        5.290608121921118e-10, 2.3027244027438525e-10, -2.8399080301752713e-10,
        -5.32513278852651e-10, -2.8274469124442137e-10, 2.31593059243708e-10,
        5.292249252434524e-10, 3.316428604298183e-10, -1.762661869602861e-10,
        -5.192321328011098e-10, -3.7634309881555597e-10, -1.7701646215021606e-6,
        -0.0002157860297124302, -0.0021829901032806355, -0.0003113114671520015,
        0.006516297371529216, -0.007263033833806533, 0.0064245349999731815,
        -0.005505049302971066, 0.004625433201650377, -0.0036311685647244796,
        0.0025148196189612726, -0.0014517232766759118, 0.0006465643957246481,
        -0.00018247027392802572, -3.5710619370158623e-6, 3.8380580135938375e-5,
        -2.431737679702282e-5, 8.998710590048975e-6, -2.071950180076853e-6,
        2.188846819008875e-7, 2.8247699993641704e-8, -1.464768708971179e-8,
        2.7006568806712594e-9, 3.521711366041206e-10, 7.098584764084054e-12,
        -4.4210439394785887e-10, -4.860716901654506e-10,
      ],
    ];
    const result = wavedec(data, "db27");

    const reconstruction = waverec(result, "db27", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db28", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5077475972180318, 0.9328889884867437, 1.2109460088652484,
      1.3091977275285827, 1.2324712842827177, 1.0197716614071037,
      0.7327770131411907, 0.43929710079533824, 0.19604743179959067,
      0.03520708647008741, -0.04182183502722178, -0.06197202245935004,
      -0.07021846856120748, -0.11435070474138909, -0.22902990218246583,
      -0.42353648093566104, -0.6766313591935866, -0.9400614946064426,
      -1.149934856330793, -1.2430772093222981, -1.174119174085436,
      -0.9288077099596131, -0.5299623141017724, -0.03436495645529032,
      0.478800638743232, 0.9251654336875345, 1.2337878392829786,
      1.3625356013348318, 1.3064348169846172, 1.0969879371751186,
      0.7927760012105836, 0.4638818745580521, 0.1742241804233029,
      -0.033625670734890034, -0.14728023022481235, -0.18487513739663647,
      -0.18702232394678608, -0.2027090568814246, -0.27306938353658655,
      -0.41750639051730537, -0.6260086374864609, -0.8598495866414678,
      -1.0606197298905136, -1.1653059847159515, -1.1234899437303971,
      -0.9121194677579352, -0.543882574303429, -0.0668325763437371,
      0.44484084907565885, 0.9067126792637041, 1.242780766508697,
      1.40224005112241, 1.370202042783268, 1.1697346863458653,
      0.8548174178582933, 0.49612296842909404, 0.16334974259950663,
      -0.09133296717852951, -0.24451484761313072, -0.3046805971186086,
      -0.30663860435122586, -0.29893025924213185, -0.32775217311816934,
      -0.42182794495702847, -0.5823946542694435, -0.7810945475343833,
      -0.9664463454498621, -1.077269754156864, -1.0595565291064475,
      -0.8823176035671505, -0.5481446308660514, -0.09555527922088206,
      0.40769963364960565, 0.8788510648353292, 1.2383747631318411,
      1.4277618641783727, 1.4223606726706415, 1.2361025188240355,
      0.9169951753294989, 0.5346215436721597, 0.16290790290631801,
      -0.13740038031105783, -0.3320995635139901, -0.4194064508180435,
      -0.4270304932765737, -0.4014389199299291, -0.39236208932982963,
      -0.43682044947982535, -0.5470536492187523, -0.705672328505401,
      -0.8694137605268493, -0.9805742837438121, -0.9831217657804088,
      -0.8392055151966444, -0.5416195088664413, -0.1187837420393214,
      0.3692724053795776, 0.8431107371491805, 1.2213210131044134,
      1.4388663047468402, 1.4617446609391869, 1.2942964479219394,
      0.9773566089738583, 0.577784093671686, 0.17209118773435395,
      -0.1716247278062913, -0.40885781729397236, -0.5271932883581858,
      -0.5461247488926344, -0.5084740569930256, -0.46589716077607407,
      -0.46249251873657227, -0.520996180874576, -0.6353292726969784,
      -0.7715501335707758, -0.8770062523476967, -0.8952745373787234,
      -0.7829034857884161, -0.5234434237703474, -0.13491292227960297,
      0.3314690199888177, 0.8011915306008186, 1.1926517510958625,
      1.435638202871306, 1.4874632268777255, 1.3426812641904269,
      1.0339523394795236, 0.6238637489856868, 0.18982279638991434,
      -0.19411726970782373, -0.4738901413878518, -0.6263489364498595,
      -0.6618619178375676, -0.6181317367897696, -0.5470935716239074,
      -0.4985410910419661, -0.504953480160847, -0.5716385153412962,
      -0.674862561693982, -0.7684896244269804, -0.7973640651969691,
      -0.7138475827107362, -0.49304154554030055, -0.1425244419514361,
      0.29616388397174387, 0.7549186388682634, 1.1536531105930634,
      1.4184790957281703, 1.498923048559734, 1.3798229840642795,
      1.0848861370737393, 0.6710055096016995, 0.21478535697378348,
      -0.20529897295184102, -0.526594716093407, -0.7153889653018369,
      -0.7722462399893331, -0.7284113639747531, -0.6344562638251037,
      -0.5443583635470433, -0.49935891715612657, -0.5159608287556974,
      -0.5812875315396138, -0.6570386426415877, -0.6909677065938076,
      -0.6327806499794715, -0.4501445070390578, -0.14042426298154043,
      0.26514699309780837, 0.706195195141909, 1.105831665673011,
      1.3880964947597922, 1.49584307122812, 1.4045253307303547,
      1.1283635325203583, 0.717294264745283, 0.24545578082323607,
      -0.20588796117201644, -0.5666804365475033, -0.7930719915688957,
      -0.8753939934587617, -0.8372644626313953, -0.7262954292720392,
      -0.5990464753778781, -0.504337047293663, -0.4694108956387242,
      -0.49264322701126084, -0.5447086191966555, -0.5778530682089318,
      -0.5407356167337919, -0.3947972376445366, -0.12767470289902888,
      0.24007713589430196, 0.656952956025532, 1.0508755097477789,
      1.3454855496775644, 1.4782615582459728, 1.4158603293225422,
      1.1627379510813682, 0.7608043903808699, 0.2801453359014979,
      -0.1968794691915493, -0.5941721675286166, -0.8584288941921663,
      -0.9695790681812135, -0.9426447253370375, -0.8207679767484892,
      -0.6614395708345744, -0.5197005124590022, -0.43282985750717223,
      -0.4105848907506475, -0.4335457600456301, -0.4599353828558456,
      -0.439011537391544, -0.32735989590776016, -0.10361998203890616,
      0.22243844203793645, 0.6091023317263577, 0.99061085175111,
      1.2919035713516234, 1.4465352073996718, 1.4131922463183912,
      1.186553207713878, 0.799649674752335, 0.31704392823314215,
      -0.1795188100700174, -0.6094080581103507, -0.9107852126947672,
      -1.0532746260595764, -1.042558074945386, -0.9159229333254642,
      -0.7301326890530522, -0.5449548748190258, -0.4067648271966818,
      -0.336564359326982, -0.32553728026323664, -0.3392312179061553,
      -0.3291429617677603, -0.2485008736947876, -0.0679046561334351,
      0.21350137141001213, 0.5644830214532885, 0.9269552227544134,
      1.228838054933013, 1.4013303546121239, 1.3961942701440992,
      1.19858129308522, 0.8320323139380681, 0.3542674746175248,
      -0.15526803826123164, -0.6130289877796531, -0.9497761688176225,
      -1.1251898038879595, -1.1351114834179088, -1.0097496407892024,
    ]);
    const expected = [
      [
        -1.708508716013656, -1.3819128487462662, -0.8117262602328267,
        -0.23270630053020472, 2.504463316133137, 1.7189478011304744,
        -1.8672452825432317, -1.4269020746728802, -0.7247890572601056,
        -0.06019912290656026, 2.519300720483041, 0.7307411051347144,
        1.7236406107443027, 2.1174978822943746, 0.5221706207724923,
        0.3028470263424126, -1.6596098088023237, -2.4143798709009907,
        1.1200125171782398, 2.289674173399324, 0.3782658221576351,
        0.2551693772481611, -2.0147816632753144, -1.079869145775873,
        -1.4504288479764478, -1.9267276998054954, -0.8647225481120149,
        -0.9664144093074349, 1.2895132082966252, 2.7575267397792245,
        -0.25898433867521264, -2.1886645755652294, -0.5861474286315221,
        -1.1276008364280106, 1.8903407669045278, 1.5323152765631396,
        0.9079187323466879, 2.404801349659006, 1.1485502687495788,
        0.498048079207273, -0.4229194951244959, -2.717994017777884,
        -0.7677419967583752, 2.339397567488293, 1.2229820997772496,
        0.2568994229493368, -0.4404765394146408, -2.5853142581377453,
        -0.8341330568964843, 2.4372615066006547, 1.3184759590121826,
        0.021599102938366206, -0.4797326580351573, -2.4322463062955366,
        -0.8908079494643786, 2.5073526577704084, 1.4251390201790763,
        -0.20399805656806091, -0.5411280032378144, -2.2620408654642588,
        -0.934325813806494, 2.549302267885397, 1.5396489985132251,
        -0.4162470902569907, -0.624477942644473, -2.0782916238743283,
        -0.9615580921044179, 2.5633793711812425, 1.6583992162829357,
        -0.6118549709977806, -0.728975013468499, -1.8848462857997919,
        -0.969771232748853, 2.550481385425058, 1.7775907178898118,
        -0.787959312175164, -0.8532066503650662, -1.6857113895056226,
        -0.9566994937628529, 2.5121090544621807, 1.8933294259198008,
        -0.9421964604018431, -0.9951873753653923, -1.4849544777291062,
        -0.9206140554570486, 2.450392500130022, 2.001443196089574,
        -1.0718893550161093, -1.1544759034886956, -1.2826789127089748,
        -0.8661913560123853, 2.374146798342699, 2.0953773450676674,
        -1.1825585292303198, -1.3057122567453108, -1.1226540579652786,
        -0.745445575281777, 2.2656944705643585, 2.0854196644105296,
        -0.9379251209305728, -2.0415251783149007, -1.819988917758521,
        -1.8728884343347754, -2.7887007748380204, -0.10664124567023962,
      ],
      [
        -0.0016565797185683912, -0.03627773938559006, -0.11983573803265657,
        0.16889907208477326, 0.0647598581447673, -0.18902910091374217,
        0.21557447087431286, -0.18681295795488329, 0.1326551023556379,
        -0.06643510831453914, 0.027757227962789028, 0.02234137560332219,
        0.018795489935069482, 0.1612661007241526, 0.21582238927373507,
        -0.2541504193902246, 0.07075517680789678, 0.061181312150527245,
        -0.10569663134351044, 0.08989955968291322, -0.04520443495084575,
        -0.0012875240365397968, 0.030927141671753693, -0.037514122570204166,
        0.027069410638131158, -0.011972980472474413, 0.002547723881325785,
        -0.0013830809461502138, 0.0039257188572029205, -0.004195174884616858,
        0.0005005598883233437, 0.0037010671753694947, -0.004066141800045676,
        0.00019464552949515016, 0.0038761092306092678, -0.003891246483769366,
        -0.00016449096101104217, 0.004048127319103066, -0.003696770254586729,
        -0.000522002521533573, 0.004194680758369677, -0.003479044411613463,
        -0.0008762355527837162, 0.004314827561632595, -0.0032394162312890736,
        -0.0012249445670064172, 0.004407820102817458, -0.002979403100291315,
        -0.0015659523046129508, 0.004473064824093211, -0.0027006321426816223,
        -0.0018970948124361468, 0.004510158953929309, -0.002404867788664022,
        -0.0022163053582703444, 0.00451886147399807, -0.002093961534904448,
        -0.0025215572428940593, 0.004499124791434851, -0.001769880721697891,
        -0.002810946620231906, 0.00445106631117033, -0.001434654442452786,
        -0.0030826345846266022, 0.004374994981840063, -0.0010904037356362834,
        -0.0033349284198865093, 0.004271384213338483, -0.00073928470606717,
        -0.0035666584016530545, 0.004131889897352127, -0.000470601096393671,
        -0.004252708778694231, 0.002402293760441537, -0.003316965699824504,
        -0.009228316893750147, -0.011182633568506621, -0.06542159096749252,
        -0.09914621110908617, 0.19821603417745812, 0.0042975634411694255,
        -0.32130201922367235, 0.3876095308299518, -0.10656700032172076,
        0.0065302269229139875, 0.043882755898264195, -0.04880394075135304,
        0.04276088876889014, -0.025240811920097868, 0.006934664325687809,
        0.005726120419043294, -0.009114416830583217, 0.004840550433283402,
        0.0012317936928015506, -0.003364773008112785, 0.0004362808221158976,
        0.003640251251189683, -0.004148665752320124, 0.0003782798788999403,
        0.0037783268270778453, -0.0039823581820126845, 2.0777636156864435e-5,
        0.003962373591925402, -0.0038002162529244266, -0.00033758488137202407,
      ],
      [
        0.0003786980097243133, 0.010749740267224996, 0.03602498142260485,
        -0.05214889305523605, -0.015443045705378149, 0.048144670688535056,
        -0.053723796344881204, 0.04642197691454677, -0.03387631774944117,
        0.02048736007119101, -0.009291299035916354, 0.0019659798302289707,
        0.001433770212713512, -0.002087535067128464, 0.001503186596939208,
        -0.0007553097662521724, 0.00027493800415585016, -6.739036751104347e-5,
        7.17284913643457e-6, 2.0434451666695575e-6, -1.1695564902152547e-6,
        2.6709494451054935e-7, -2.858557926177163e-8, -2.779269190312537e-10,
        -9.591187632093401e-11, -3.316791675954608e-10, 1.4738415442815848e-10,
        4.588973859534338e-10, 3.212891147611403e-10, -1.3027817183690407e-10,
        -4.5453716258449204e-10, -3.3463560200495205e-10,
        1.1226778780106463e-10, 4.4946294217180373e-10, 3.474519901592132e-10,
        -9.408120622196352e-11, -4.436812863155459e-10, -3.597254250084685e-10,
        7.574648125820315e-11, 4.371998751225864e-10, 3.714283907290509e-10,
        -5.729543406783225e-11, -4.30033148859766e-10, -3.825532682129834e-10,
        3.8751471252358114e-11, 4.221858231288876e-10, 3.9306959331472034e-10,
        -2.0146456765626567e-11, -4.1367563920125747e-10,
        -4.0296857718057994e-10, 1.5106954455782962e-12, 4.0451320408362987e-10,
        4.1223380932997646e-10, 1.712703931556894e-11, -3.9471644416783965e-10,
        -4.208512863580367e-10, -3.573719367044467e-11, 3.842969095201067e-10,
        4.2880581552155057e-10, 5.429599788883975e-11, -3.7327294781380843e-10,
        -4.360837103489238e-10, -7.276337805102137e-11, 3.6166101610587993e-10,
        4.4267503772609807e-10, 9.11178673709966e-11, -3.4948028244094865e-10,
        -4.485756695446559e-10, -1.0933171018883223e-10, 3.367460400919855e-10,
        4.537663540478922e-10, 1.2736964826980103e-10, -3.23486754553197e-10,
        -4.5824289397478737e-10, -1.452090412687201e-10, 3.09713182892583e-10,
        4.619936372608331e-10, 1.6282033260408646e-10, -2.9545906603591866e-10,
        -4.6502042005844664e-10, -1.8017891863337525e-10,
        2.8073391620605615e-10, 4.673143472889657e-10, 1.9724844507200487e-10,
        -2.655714965874735e-10, -4.688730349691946e-10, -2.140085794845206e-10,
        2.499849688065906e-10, 4.69696533333659e-10, 2.304298588516118e-10,
        -2.340093678739053e-10, -4.697785905120573e-10, -2.464896228823232e-10,
        2.176605318981847e-10, 4.691210929133031e-10, 2.6216005945005555e-10,
        -2.009722682058676e-10, -4.677232690983116e-10, -2.774224429094571e-10,
        1.839679669079395e-10, 4.6559023493673713e-10, 2.9224454608360355e-10,
        -1.6667758486859994e-10, -4.6272489991559205e-10,
        -3.066125839478405e-10, 1.4911938568549734e-10, 4.59129397853378e-10,
        3.204905459413571e-10, -1.3132897486607223e-10, -4.548121156102591e-10,
        -3.338629574722922e-10, 1.1332911993830439e-10, 4.497835722870741e-10,
        3.467164220281313e-10, -9.515557167975405e-11, -4.4404251512813843e-10,
        -3.5901941025929297e-10, 7.68273702384475e-11, 4.3760315407764426e-10,
        3.7075681907069796e-10, -5.837879082593163e-11, -4.304723419726738e-10,
        -3.8191332528201157e-10, 3.984399247362041e-11, 4.226636103597756e-10,
        3.924682941187718e-10, -2.1237083798027933e-11, -4.1418782538255787e-10,
        -0.00015519923956086763, -0.004483354137183826, -0.015329646482986918,
        0.022045571900650467, 0.0067846171215245835, -0.020916253900269997,
        0.023410824574753724, -0.020266423401794, 0.014762140112254456,
        -0.008846802409526698, 0.0039015408210019203, -0.0006963849176403978,
        -0.0007479757153923518, 0.0009775809306267814, -0.0006795681349278259,
        0.00033221176235962184, -0.00011721071231817657, 2.7330397232716007e-5,
        -2.374112275522287e-6, -1.0390865078436823e-6, 5.143355494924583e-7,
        -1.1112346996601898e-7, 1.094123270565855e-8, 3.720626631583277e-10,
        3.1626393069612055e-10, 2.7384690699571654e-10, -1.982163136443439e-10,
      ],
    ];
    const result = wavedec(data, "db28");

    const reconstruction = waverec(result, "db28", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db28_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4953490237579288, 0.9160723845565707, 1.2024996773671113,
      1.3214737320969239, 1.2719181930538348, 1.0832372424482226,
      0.807058141857749, 0.5043839980967435, 0.23127782248277884,
      0.02649934561866285, -0.0960055556457669, -0.14807752144036326,
      -0.16170515869447818, -0.1783207647591527, -0.23580985702422308,
      -0.3565652765900392, -0.539652298556672, -0.7591357784806101,
      -0.9691000767900761, -1.1142358091410856, -1.1434762703793497,
      -1.0233790332404626, -0.7479578622053442, -0.34247787533361596,
      0.13985848128729514, 0.6277235612853843, 1.0458146588180237,
      1.330139457540885, 1.4409487384101198, 1.3703697292218981,
      1.143033027473375, 0.8096277276813395, 0.4349710496090929,
      0.08344619994887503, -0.19475613070786152, -0.3733978612393864,
      -0.45376224378292157, -0.46135743616604585, -0.43675002265262064,
      -0.4229393108856459, -0.4525048122840417, -0.5377897119369711,
      -0.6666166667643569, -0.8046558567674146, -0.9039132170063777,
      -0.9152803076644458, -0.8020573999811477, -0.5510795130089835,
      -0.17861238833689042, 0.2705849152720574, 0.7310060419346129,
      1.1292915346998094, 1.3993610458528745, 1.4963111832015366,
      1.4058688328862996, 1.1472156838727632, 0.7685452325043702,
      0.33641008164957265, -0.07863997748204787, -0.4167835862430867,
      -0.6406244464376641, -0.7412255585648291, -0.7372286292891169,
      -0.6674751678588119, -0.5791006831003211, -0.5141405328277666,
      -0.4980099917955603, -0.5327263025865708, -0.5965489156839769,
      -0.6501160367593961, -0.6475392775983184, -0.5496762996214909,
      -0.3362360797760672, -0.013621658876221743, 0.38357721025764224,
      0.7980055176761643, 1.160769393956327, 1.405938925318629,
      1.4849764675373631, 1.3777143695292828, 1.097287037153457,
      0.6878248057986129, 0.21540706797923642, -0.24565378111533923,
      -0.6280434322479873, -0.8847044076181991, -0.9971293087117097,
      -0.9768967993572046, -0.8602774826639155, -0.6973840823462021,
      -0.5386207811279882, -0.42179417149696924, -0.36303963635779796,
      -0.35374565611828435, -0.36416193123724966, -0.3527191608118549,
      -0.2786712909613811, -0.11483900955600124, 0.1428113082366318,
      0.4712640133493268, 0.8233635145148344, 1.1370136383684013,
      1.3485975859554, 1.4074909103723592, 1.2882277712594337,
      0.9973929862249422, 0.5735293284672764, 0.07998171097828234,
      -0.4077422558480244, -0.8172285855687542, -1.0935543710488158,
      -1.2095650890405922, -1.1697562386124434, -1.0070039752982778,
      -0.7730793371740108, -0.5253356474959248, -0.3128312501450781,
      -0.1652331110699699, -0.08712447450595351, -0.058989160891336365,
      -0.0444947254173621, -0.002146774038951249, 0.10168735252083849,
      0.2817255226820872, 0.5275487122088683, 0.8038884679473762,
      1.0575045356217112, 1.2291057294419818, 1.26750466740079,
      1.142606793001462, 0.8540617732396734, 0.43339966762840865,
      -0.061000796568540336, -0.5550731091030372, -0.9738613108505793,
      -1.2565977792687635, -1.368630785700696, -1.3075126231433662,
      -1.1019346862722594, -0.8038774533143146, -0.4759287804972597,
      -0.17683482736762385, 0.05127962837743283, 0.19103683847574005,
      0.2514574788845746, 0.2629110370419617, 0.26677496499549536,
      0.30249641655402243, 0.39537213711348856, 0.548172090511407,
      0.7387775781611212, 0.9245167862318732, 1.052220754896494,
      1.071593524687883, 0.9486392681323945, 0.675824998085627,
      0.2763988234037245, -0.1983447801619146, -0.6783873802493698,
      -1.0888565348099766, -1.3653056646103066, -1.4669105336307426,
      -1.3845618039212237, -1.1420225293572286, -0.7899417812366061,
      -0.39418348380149204, -0.021244956107971613, 0.2758104809631098,
      0.46765119100685787, 0.5528932072611652, 0.5554114887795146,
      0.5155975755632597, 0.4778702762684645, 0.47763260348827913,
      0.5309734363862436, 0.6297128889841017, 0.7430571054061903,
      0.8254853165970664, 0.8289384742885626, 0.7162922071941626,
      0.47274224313618907, 0.11219623902022624, -0.3230574986473559,
      -0.769528148886481, -1.1550218246901658, -1.4136411017893684,
      -1.4998342135589569, -1.3982341374475498, -1.126994937029829,
      -0.7338466629364886, -0.28578986612826185, 0.1451692717905264,
      0.49693486050793917, 0.729460579990165, 0.8313794333969959,
      0.8197310322511315, 0.7330550498798356, 0.6197026934894513,
      0.5243426853706481, 0.4760353565626077, 0.48082497326172785,
      0.5206613877977421, 0.5588852025876929, 0.5508790678262259,
      0.4571977567146534, 0.25585494644265605, -0.049379458247344576,
      -0.4268716090567574, -0.8219164094286356, -1.1674672401434656,
      -1.3983842295357414, -1.4658986015681577, -1.3488930777661143,
      -1.0593137333012408, -0.6403883277022646, -0.1580062188541391,
      0.31278545285257037, 0.7030774870067773, 0.9636908866506422,
      1.0739956193141746, 1.0440365996421643, 0.909646687282061,
      0.7218897253875728, 0.5335053241454901, 0.385703803288517,
      0.2985245782232351, 0.2670602660064557, 0.26438480074987397,
      0.2503628220086555, 0.18406258663254366, 0.036598575150692425,
      -0.19888953304392815, -0.5027279052330499, -0.8309478492478758,
      -1.1239026999458603, -1.31932062939905, -1.3667391804950084,
      -1.2398841148365847, -0.9439969445428106, -0.5162795123658661,
      -0.019233487170854685, 0.4716566150376208, 0.8831158247843087,
      1.1586901096123667, 1.2694635245310057, 1.218494913044367,
      1.038076357309928, 0.7806086337045812, 0.5053814144631528,
      0.2644815453360434, 0.09120958290574027, -0.006271288968721089,
      -0.04463736256382575, -0.05868190018028417,
    ]);
    const expected = [
      [
        -1.4819747205264207, -1.0086665930558896, -1.3282730297667833,
        0.20379043683898607, 2.8899533505561865, 1.1232178101305117,
        -1.9153611898093432, -1.1981722350059434, -0.8363542812299428,
        -0.02477262404166222, 2.5868364386811793, 0.7512207388787988,
        1.6461618960819853, 2.27780979166117, 0.5191297226649212,
        0.09937902661312797, -1.237642510733369, -2.4895985069975266,
        0.41655761335059666, 2.7486056967335504, 0.7117675569744966,
        -0.37361996582734913, -1.2114667874074598, -1.2969837468010392,
        -1.7820052451477406, -1.2529774003530105, -1.1746413588468112,
        -1.064720569685613, 1.9813052873782262, 2.4938493966178474,
        -0.6881429679458579, -1.9342693498671557, -0.5979297095251658,
        -1.166697865358706, 1.9499357534825421, 1.6016029564010037,
        0.8375755681983491, 2.4439001688712976, 1.3188835572881177,
        0.25539139362366037, -0.27743236254553333, -2.344732213403955,
        -1.4167466979835184, 2.185636027816753, 1.9324381864978606,
        -0.15217081656075662, -0.46227123652840574, -1.6980488615767468,
        -1.7670490704803699, 1.7110975776951458, 2.5705470717147434,
        -0.17345386516630248, -0.975608032341136, -1.172157688240493,
        -1.6883626718484548, 1.0151995650029284, 2.954707890591012,
        0.22628454458728187, -1.5737438400155805, -0.9971501164968867,
        -1.2400733645743753, 0.37571184329084895, 2.9219163277707234,
        0.8998260592169188, -1.9758657081752342, -1.250833539311104,
        -0.64066170721696, 0.0455505897629578, 2.4881723676267042,
        1.5814306899972503, -1.9852295917252936, -1.8251582356313705,
        -0.17341147740514484, 0.1436793293335889, 1.8415750304716842,
        2.0014667894918627, -1.5740715247812849, -2.4728349180504936,
        -0.06415868772188413, 0.6038055294061757, 1.2611643815869191,
        2.002720609102028, -0.8956117588805572, -2.914027264880728,
        -0.3838353812829997, 1.2030314335476497, 0.9964779341357952,
        1.6082537848998364, -0.21785045941021436, -2.957971813248421,
        -1.0147585898821039, 1.6499448183929974, 1.1776098732214018,
        0.9778052051976506, 0.24874459263431464, -2.6716971694777847,
        -1.5810973206723056, 1.55736854159217, 1.9275543877666617,
        0.24839337374437842, -0.024893556528171188, 0.5552981041423788,
        0.34189973490992936, -0.3529021387851799, 0.528971311996054,
      ],
      [
        -0.004796227509053944, -0.024435775137805954, -0.07842895588806718,
        0.11209756383637995, 0.04059150546554792, -0.11765663457541589,
        0.1311172734671383, -0.11218395764647807, 0.0817723065267122,
        -0.04357666049186349, 0.026657199059517613, 0.012541462340651264,
        0.026828976473957537, 0.15308670062095142, 0.20665722541697404,
        -0.24344004261254829, 0.07002694204343697, 0.054004871276141606,
        -0.0967453891223688, 0.08420444083051071, -0.04492914909482561,
        0.0032518067629185134, 0.024002863444489743, -0.031288657963152756,
        0.02398317248410027, -0.012570498109878668, 0.005037272370809326,
        -0.002809224431450392, 0.002541999233723359, -0.0011141428195717942,
        -0.0012141485610947537, 0.0020692846861390126, -0.0004789790165992759,
        -0.0016682560939254704, 0.0018108355224600676, 0.0002183917290176526,
        -0.00198576600359064, 0.0013721556679645063, 0.0008866937268740036,
        -0.0020823805280766796, 0.0007812584782522518, 0.0014566085151244753,
        -0.001947976559979219, 0.00010368284481271336, 0.0018649264499893097,
        -0.00159745459414614, -0.0005853912135366756, 0.002066344480183874,
        -0.0010697143226161539, -0.0012095253579910848, 0.002038520304517123,
        -0.00042329203856279074, -0.0016994681883687089, 0.0017845376163535813,
        0.00027008497459898097, -0.0020008736154749174, 0.0013325766682012329,
        0.0009335042870635213, -0.0020802940413301037, 0.0007327760155189764,
        0.0014933530511972582, -0.0019289277205654098, 5.168116068675581e-5,
        0.0018875325708367994, -0.0015635580662265824, -0.0006351484319339386,
        0.002072300055644819, -0.0010247291873022452, -0.0012515044218471903,
        0.0020273031568468778, -0.0003711446800685822, -0.0017256196428103528,
        0.0017502198598070046, 0.00021720033448924654, -0.0024539762973916006,
        0.00022407630563776849, -0.0002310411458086992, 0.0003964563184083416,
        0.003244501401546607, 0.04302579719491423, 0.04112897003874106,
        -0.19304483768922417, 0.19070587800553132, -0.14828299957996713,
        0.10854974611095987, -0.07681351096490652, 0.058816679286659804,
        -0.047744917630856136, 0.03970211249969428, -0.031089901475774787,
        0.02053512086559639, -0.009639248030893968, 0.0017082018877499962,
        0.0010848564068863134, 0.00014507180199326608, -0.0018373015058840776,
        0.0012947156927451092, 0.0009135164172100495, -0.002085739911608922,
        0.0007753396479922395, 0.0014613680136005848, -0.001945662273024631,
        9.713958704601815e-5, 0.0018678352732853308, -0.0015932431504312404,
      ],
      [
        0.0003691694574306524, 0.010463008420310992, 0.034997896596389695,
        -0.05069471961970073, -0.014952785491485805, 0.04667242481136098,
        -0.05206479769727137, 0.044979920090194754, -0.032830897001416594,
        0.01987499183740116, -0.00904049714808022, 0.0019440195154004254,
        0.0013602408522427828, -0.0020073693398120567, 0.001451385657199962,
        -0.0007315073633874779, 0.000267143788554437, -6.579692663681718e-5,
        7.121794950573746e-6, 1.9490972708932197e-6, -1.1332460116057215e-6,
        2.5985519140034734e-7, -2.8146625114791712e-8, -5.8869450526115e-11,
        2.40976099270349e-10, -1.7894083282285202e-10, -5.462466709113078e-11,
        9.613336419839052e-11, 1.5921014539004217e-10, 7.820263777814844e-11,
        -7.357932521048714e-11, -1.5877112949623282e-10,
        -1.0027238072047121e-10, 4.897039530452751e-11, 1.538988610422854e-10,
        1.1954802764829978e-10, -2.299615419225434e-11, -1.4472572700488527e-10,
        -1.3547896336256097e-10, -3.6242405090309574e-12,
        1.3151132820271003e-10, 1.4763127786617356e-10, 3.0138507773170937e-11,
        -1.1462266939221976e-10, -1.556544464616393e-10, -5.581417282825346e-11,
        9.453447665949211e-11, 1.5933483879356634e-10, 7.993263414012981e-11,
        -7.180407709678376e-11, -1.5855871999091384e-10,
        -1.0181891001384253e-10, 4.706895537184661e-11, 1.533577932952847e-10,
        1.2085687103390533e-10, -2.102112794734252e-11, -1.4387755643857854e-10,
        -1.3652365674434264e-10, -5.613765833090434e-12, 1.3037261321832172e-10,
        1.4837390468464796e-10, 3.2095518655675817e-11, -1.1322716217206386e-10,
        -1.5608011778039393e-10, -5.768088462013251e-11, 9.292585902764509e-11,
        1.5942728298392576e-10, 8.165383999205075e-11, -7.002211349844196e-11,
        -1.583260754887326e-10, -1.0334231925697485e-10, 4.516368202953532e-11,
        1.5279410227704783e-10, 1.2214688616105097e-10, -1.904540530624486e-11,
        -1.430024398384223e-10, -1.375424481498404e-10, -7.609725603156557e-12,
        1.2921337271634724e-10, 1.4909642570963122e-10, 3.404630196407217e-11,
        -1.1181277878365698e-10, -1.564815349812177e-10, -5.953444179459843e-11,
        9.129785195589811e-11, 1.5950341403667624e-10, 8.33614770211484e-11,
        -6.822487512621154e-11, -1.580630564691428e-10, -1.0485349226003211e-10,
        4.3247750471623914e-11, 1.522117162771402e-10, 1.2341736688367497e-10,
        -1.7063812412236474e-11, -1.4210702165557705e-10,
        -1.3854840726646485e-10, -9.594787067467599e-12, 1.2802860054178155e-10,
        1.4979161829645352e-10, 3.5990570653404405e-11, -1.1038373395717776e-10,
        -1.56867875223271e-10, -6.137701961715905e-11, 8.964938165017688e-11,
        1.5954553079918334e-10, 8.505409133617192e-11, -6.641855860095081e-11,
        -1.5777999933265252e-10, -1.0634313699094317e-10, 4.13248509512488e-11,
        1.5160812698738024e-10, 1.2468125223311953e-10, -1.5085583547548723e-11,
        -1.4118294796958862e-10, -1.3951910254791044e-10,
        -1.1585643282572436e-11, 1.2683399513512577e-10, 1.5046977586077237e-10,
        3.7932327713121115e-11, -1.0893181349287611e-10, -1.572166845546532e-10,
        -6.321606291015187e-11, 8.799723588291429e-11, 1.5956611362554272e-10,
        8.673252697214354e-11, -6.460490458535837e-11, -1.5746922312681263e-10,
        -1.4739852529164607e-6, -0.00013754008487304003, -0.0010943226902732945,
        -6.932137774588173e-5, 0.0025549088731771172, -0.0020221682295213507,
        0.0011934495670602907, -0.0006492389049566926, 0.00034913957534018033,
        -0.00020537030140639552, 0.00015750776873460303,
        -0.00015421385873861553, 0.00015083581548867313,
        -0.00012495482197731963, 8.207215004643869e-5, -4.0922927428925485e-5,
        1.430644849696498e-5, -2.6084079030551226e-6, -4.3584421175937313e-7,
        4.961103812480631e-7, -1.7403134356956283e-7, 3.124042484198968e-8,
        -1.5981147444920564e-9, -6.845310434400568e-10, 1.1615752718870278e-10,
        1.361156049944985e-10, 1.4088374568363204e-10, 1.5349515881621115e-11,
      ],
    ];
    const result = wavedec(data, "db28");

    const reconstruction = waverec(result, "db28", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db29", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4991038560499701, 0.9178376779138742, 1.1935015464794896,
      1.2943558260402037, 1.2252750659273424, 1.0244657336291711,
      0.7522308646422754, 0.47478397379115367, 0.2473488280123594,
      0.10091381422829698, 0.036008803024648206, 0.025001820169158348,
      0.022161207121541876, -0.021316582472884982, -0.14141987410482676,
      -0.3489087789111538, -0.6237982590187258, -0.918346379358453,
      -1.1679148202048564, -1.306981710990114, -1.286199500771407,
      -1.0860663085854276, -0.7236056230148987, -0.25021521840338684,
      0.2589035633287015, 0.721171909885572, 1.0648516796131844,
      1.2445350136174813, 1.2500876370158311, 1.106908793476284,
      0.8675942974966605, 0.5972802785438369, 0.35653763930181437,
      0.18627075946782462, 0.09850045925240392, 0.07533304025006465,
      0.07624735183642212, 0.051636518071802584, -0.04110753405380618,
      -0.22335070229999, -0.4867188894882857, -0.7927435169070647,
      -1.080906592461232, -1.2831228155493068, -1.3409787714551176,
      -1.2212820246988787, -0.9258583928337977, -0.4929772565957546,
      0.010088459005213123, 0.501598125602174, 0.9033915636184248,
      1.157969972588836, 1.2403836588546138, 1.162037721766939,
      0.9656011693424114, 0.7124794427303716, 0.46619682358896897,
      0.2760467845806168, 0.1652456621037538, 0.1266033812423762,
      0.12672491448001694, 0.11750010042116238, 0.051715777287845155,
      -0.10146564209079612, -0.3453888024467373, -0.6522375254929021,
      -0.9679504445509166, -1.2245937148675083, -1.357086610153365,
      -1.3199969500028415, -1.1000525405498607, -0.721073940704854,
      -0.23995136792910646, 0.2654301322286728, 0.7133574299928649,
      1.0362894986966666, 1.1952266159676372, 1.1869236707417492,
      1.0422639608389614, 0.8163759730588379, 0.5731801118220943,
      0.36845137399499667, 0.23581740156696795, 0.1792959826711007,
      0.1742270556137024, 0.1762290004679585, 0.13568817434719035,
      0.013827300248779706, -0.20402589566528972, -0.5016224248084593,
      -0.8333930268581973, -1.13422073775972, -1.334981561116552,
      -1.3799072680666766, -1.241300529470158, -0.9277667312369451,
      -0.48375776120779346, 0.019569240103799387, 0.49996074889609665,
      0.8822770659279773, 1.1147803810301917, 1.1794811184821936,
      1.0940568606217638, 0.9050243350217014, 0.6740824874786344,
      0.46127481317551644, 0.309395484117058, 0.23368804413274286,
      0.21945853048525765, 0.22812070511452054, 0.20995912684129192,
      0.1201182989418963, -0.06653327909416057, -0.34573210654287057,
      -0.6820567800817532, -1.0157172220565716, -1.276289733851711,
      -1.3999481117953987, -1.3457856782728919, -1.1070069023800964,
      -0.7140459786937954, -0.22871478841988999, 0.2692335422284987,
      0.6998067225949602, 1.0003402959217649, 1.138576707222819,
      1.118068035679497, 0.9746927380991661, 0.7653570145614285,
      0.5519429261534228, 0.384753572792817, 0.2897849841733467,
      0.26310761606180055, 0.27374269261505624, 0.27416612138396,
      0.21555317759810314, 0.06361746020611991, -0.18927332270205077,
      -0.5190589151815566, -0.8735319825414142, -1.1837224184528083,
      -1.3803058316809338, -1.4108735448606464, -1.2536278061064086,
      -0.9239409438992747, -0.4720171599539077, 0.027843324277630144,
      0.49373979574494914, 0.8543251921918139, 1.0641076252985242,
      1.1121359540757392, 1.022017414989048, 0.843446204263885,
      0.6375944389490216, 0.46026911097661116, 0.34727019888237515,
      0.30576116152375704, 0.3138489995554438, 0.3283894124273796,
      0.29885296056776106, 0.18347929969336507, -0.036671540335783126,
      -0.3496271760158737, -0.7126771517797041, -1.0609587531658926,
      -1.322387845147639, -1.435182396204652, -1.3635066316508917,
      -1.10720003499023, -0.7030377732022247, -0.21711618019063728,
      0.26978537137654834, 0.6802296663761208, 0.9570456238531775,
      1.07496382464516, 1.0441510780447365, 0.9049228804768571,
      0.7151784461239595, 0.5339566283848067, 0.4054735872050457,
      0.34782749405145, 0.349290761380204, 0.37308805189204236,
      0.3693070686098173, 0.2906964402175941, 0.10806492339733925,
      -0.17891932189754584, -0.5385421817044223, -0.9124983645922277,
      -1.2287517995850672, -1.4186107319298438, -1.4336901876247925,
      -1.2584146527693132, -0.9148189025659708, -0.45835144423770036,
      0.034328899210286756, 0.4825374042075968, 0.8194439836495766,
      1.006206911544586, 1.0388992660981355, 0.946634914285039,
      0.7815684518810236, 0.60352381504109, 0.4633611205690476,
      0.3894715088447228, 0.38092568270548116, 0.409021162606543,
      0.42674176179510004, 0.38354307725562925, 0.24145796796803448,
      -0.011852931039945835, -0.3567011507688756, -0.743489908794982,
      -1.102997230169506, -1.362321391551448, -1.462480547822644,
      -1.3731835686975924, -1.1009725332704854, -0.6886048870325189,
      -0.2057654945267729, 0.26659782002214316, 0.6544061006485731,
      0.9065284007624261, 1.0048385855619177, 0.9658478337843552,
      0.8336885846690709, 0.6664486444936802, 0.5195467300948211,
      0.43056566684482706, 0.40953137214603824, 0.43715900479632974,
      0.47146647387705354, 0.46093399790960543, 0.36064651682105814,
      0.14704846153888063, -0.17272059797634892, -0.5595422103466917,
      -0.9496242062327127, -1.2686833418636652, -1.4494778627644451,
      -1.4482520705406643, -1.2558893783124523, -0.9008917693072256,
      -0.4433723634052188, 0.03846968635170964, 0.4660157900149151,
      0.7776206077347289, 0.9414113939003987, 0.9603791973644672,
      0.8686468850271859, 0.7200747800954883, 0.5723267095127853,
      0.47065984262541855, 0.4357272263728758, 0.45858875398797455,
    ]);
    const expected = [
      [
        -1.3160684949929111, -2.138506942848356, -0.48462703738988105,
        -0.3249889954676847, 1.631242522728785, 2.464368238356825,
        -0.7657091562312844, -2.3891491429397615, -0.3994599740113987,
        -0.8386255549839755, 1.9497789564705634, 1.5986355605692064,
        0.8531602280553954, 2.378699453517407, 1.1606822675962734,
        0.5465657315123261, -0.3001906004558557, -2.719762551198477,
        -1.0947711791485886, 2.128348046226055, 1.2706438185463471,
        0.680890377723439, 0.012965063810379906, -2.8646411858886154,
        -0.47907850376654837, -0.6445300805136024, -2.4049199177880434,
        -0.9710595492462315, -0.5122463860650143, 0.6447213816271218,
        2.695022467161405, 0.7741320580664544, -2.4597407370325275,
        -0.8515986606892203, -0.9990323725231972, 0.826396424939197,
        2.2268156270432273, 0.6209838755663516, 2.0667477376612884,
        1.764862307508561, 0.6353323158827333, 0.43721872384900207,
        -2.024548100316558, -2.3235656801867117, 1.2340160792776322,
        1.847761511229702, 0.7197521158953546, 0.641528002789935,
        -1.71309382308987, -2.6021071196681724, 0.8244910687980456,
        1.917030250691299, 0.8038943824852416, 0.8163905558456751,
        -1.3643523512260087, -2.8052832869274726, 0.38242208227029884,
        1.9395034262723283, 0.8867927835164614, 0.9600855223322774,
        -0.9897455712654081, -2.9274241712497906, -0.07965371872038794,
        1.9112420550099458, 0.9672819688030627, 1.0721118998328718,
        -0.601076709293955, -2.9654023276462236, -0.5482868836000815,
        1.829730960242188, 1.0435351489475402, 1.1530872882013046,
        -0.21012880287068314, -2.9187182748811837, -1.0095408905550198,
        1.6940634934028957, 1.113105588222236, 1.2046061245728166,
        0.17172265185346397, -2.789497189091735, -1.4494420987494687,
        1.5050735606231656, 1.1730110243103662, 1.2290653276250736,
        0.5338670057687339, -2.582392717469588, -1.8544385876899567,
        1.2653542190142677, 1.2201289881105821, 1.2285665498620066,
        0.8691009027577976, -2.309369731766845, -2.202858313749251,
        0.9652017980432456, 1.2704113245026487, 1.1823311418021185,
        1.196787894130021, -2.0113155992773026, -2.4395621206665323,
        0.5338197786949238, 1.4634496766584397, 0.918904746701043,
        1.1287153829666952, 1.3047717560089853, 0.6251135813160421,
        1.4725723534663229,
      ],
      [
        -0.025292407503257116, -0.012272489033813271, -0.09990613494077745,
        0.10278445785073907, 0.1091134566219347, -0.20248065733232407,
        0.21896998696018294, -0.19979443959498133, 0.15931444631548908,
        -0.1098964769306111, 0.05594049810207286, -0.017271152705522562,
        0.00985959677800704, -0.020300084384481, -0.1950279077083234,
        -0.133411550766176, 0.30431355660720877, -0.26994521373749963,
        0.20328182018413637, -0.1640922854297563, 0.148638241548876,
        -0.13776321668708116, 0.11742926729897443, -0.08547198458757942,
        0.04975164571414472, -0.02107100749048254, 0.005662472281323713,
        -0.0019034205986476786, 0.0029158948444034326, -0.002477988793342285,
        -0.0006730932256591663, 0.003445610418895388, -0.002763743238116337,
        -0.000775865937514637, 0.0034786275891236272, -0.0024968298158641036,
        -0.0011282103586617179, 0.003558682353015207, -0.002221496074122513,
        -0.001467628097302476, 0.003602948952422925, -0.0019237628486055511,
        -0.001792145989215182, 0.0036106768255674774, -0.001606519879003433,
        -0.00209848793885956, 0.0035817899456306052, -0.0012729862957218247,
        -0.0023835511752891953, 0.003516579383280794, -0.00092654257770234,
        -0.002644441080362198, 0.003415708548284616, -0.000570703593099482,
        -0.0028785157770626984, 0.00328019801786662, -0.00020907653933768258,
        -0.0030833977838890347, 0.003111424561655339, 0.00015467027994546417,
        -0.0032570130879342233, 0.0029110969278378696, 0.0005168489231653832,
        -0.0033975974725282657, 0.002681249586407506, 0.0008737860549467768,
        -0.0035037287722755493, 0.0024242102320023253, 0.0012218632789256932,
        -0.003574263777352656, 0.002143753286567231, 0.001568325374023417,
        -0.0035534367252729347, 0.00198686480208566, 0.001967600488292674,
        -0.004281172094222276, -0.0005434547830089831, 0.0038422395549285943,
        0.025342715461457586, 0.02143742113714804, -0.10495118147858157,
        0.10265992094046142, 0.010609613553026339, -0.1187170856506602,
        0.10014532926711156, -0.06086541950171546, 0.03982390596975525,
        -0.030389905526332903, 0.02696931752558199, -0.025824894197206145,
        0.022803932825307852, -0.016203575698156315, 0.00724051655036531,
        0.00032010881735148846, -0.003001323564456151, 0.0007709851032911648,
        0.002687839497009989, -0.003284795481059067, 0.00033188770568839753,
        0.0030118970489063316, -0.0031799218128164405, -1.5939782576426914e-5,
        0.003194614044599583, -0.002991103968579939, -0.00037913184156601143,
        0.0033479732867681897,
      ],
      [
        0.00027287358621840994, 0.008550327731519447, 0.034597960601756815,
        -0.03747699383930868, -0.03611390436453146, 0.06512119566877374,
        -0.06700433986042595, 0.05842694412981387, -0.045992903585772314,
        0.032417548180028885, -0.01971560390527993, 0.009651962973764057,
        -0.0031610722600815197, 1.2795851397977132e-6, 0.0009052675177873699,
        -0.000767392503436598, 0.00040443392648341467, -0.00015067155337575059,
        3.8316594568883755e-5, -4.991486909543731e-6, -6.187966205419377e-7,
        4.842471155267131e-7, -1.1541289236015015e-7, 1.2753636558136826e-8,
        -2.1984919870137165e-10, -5.677173450461539e-11, 2.169908931750216e-10,
        1.3438865287701146e-10, -6.963052593265685e-11, -2.0578926848253802e-10,
        -1.4211227500750353e-10, 5.956202819222147e-11, 2.033985352880682e-10,
        1.4972176379008789e-10, -4.934224597628111e-11, -2.0049244243043186e-10,
        -1.5695277049497621e-10, 3.89998364400073e-11, 1.9707923916791548e-10,
        1.6378490255372993e-10, -2.8558636977790564e-11,
        -1.9316586309989482e-10, -1.7020224531396107e-10,
        1.8038897545952875e-11, 1.8876427085245636e-10, 1.7618611058029734e-10,
        -7.477332171507908e-12, -1.8388057787229306e-10,
        -1.8172227595751113e-10, -3.1021306882217674e-12, 1.785298703435309e-10,
        1.8680346067354342e-10, 1.3673440034635726e-11, -1.7272983780906604e-10,
        -1.9140309253794112e-10, -2.421549946753148e-11, 1.664913986536103e-10,
        1.9552049183229093e-10, 3.469053249661585e-11, -1.5982663121933286e-10,
        -1.9914332129592073e-10, -4.507954207466751e-11, 1.5275833659511488e-10,
        2.0226050430874047e-10, 5.535140652688655e-11, -1.4530500246161872e-10,
        -2.0486193271916438e-10, -6.549256969834876e-11, 1.374831986349142e-10,
        2.0694396925776361e-10, 7.545707763127452e-11, -1.2930582864225636e-10,
        -2.0850814122879262e-10, -8.523105468012605e-11, 1.2080870345984739e-10,
        2.0953471941888337e-10, 9.479341625688322e-11, -1.1200433719048113e-10,
        -2.1003144078622393e-10, -1.0411134020083644e-10,
        1.0290284421851191e-10, 2.0999770984951675e-10, 1.1316306386973291e-10,
        -9.355467229668381e-11, -2.0943160703861207e-10,
        -1.2193299377546425e-10, 8.396743635497623e-11, 2.0832937749613134e-10,
        1.3039986272094898e-10, -7.41575946247339e-11, -2.0670657513379313e-10,
        -1.385194789910334e-10, 6.417128847251716e-11, 2.0455242124274197e-10,
        1.4630146513093464e-10, -5.402351369205543e-11, -2.018825777488105e-10,
        -1.5370875895718688e-10, 4.372524563829506e-11, 1.9869911464248242e-10,
        1.6071768832929362e-10, -3.3328342207625573e-11,
        -1.9501217574912648e-10, -1.6732960132690925e-10,
        2.2839815732929213e-11, 1.9082982799210583e-10, 1.7351435759794602e-10,
        -1.2291509065536168e-11, -1.8616485965143397e-10,
        -1.792520189083118e-10, 1.7187825764391207e-12, 1.8102545189996564e-10,
        1.845509716435353e-10, 8.859289905033243e-12, -1.7543077158411268e-10,
        -1.893667359073005e-10, -1.942032196522202e-11, 1.6938799132652268e-10,
        1.937044601246814e-10, 2.99256559160376e-11, -1.6291578277729823e-10,
        -1.9755879000015685e-10, -4.035169699155617e-11, 1.5602923925584964e-10,
        2.009035078668254e-10, 5.068545274153726e-11, -1.487492980353484e-10,
        -2.0374001676170394e-10, -2.635877908554982e-5, -0.000914025831278991,
        -0.004098596688893705, 0.0042185496518249025, 0.004746740250205438,
        -0.008596289880552107, 0.009059570266128959, -0.008061037047988396,
        0.0064084775682475914, -0.004486479189321031, 0.00263735589788271,
        -0.0011775117038562808, 0.000273336308386998, 0.0001201611707258456,
        -0.0001887460184887853, 0.00012825538289512262, -5.872942042683072e-5,
        1.8787798752572224e-5, -3.7183435553588758e-6, 1.2276279203597186e-7,
        1.9551233527813344e-7, -7.112977763015295e-8, 1.2535039680150478e-8,
        -7.052209566889366e-10, -4.121014849727067e-11, -1.5709060549090624e-10,
        -1.926299968920038e-10, -2.5704053387225814e-11,
      ],
    ];
    const result = wavedec(data, "db29");

    const reconstruction = waverec(result, "db29", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db29_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49946385388897563, 0.9214079602813695, 1.204429700271655,
      1.3155665546550968, 1.2559598460176893, 1.0586222766407596,
      0.7789963944668157, 0.4807354091352749, 0.22027174765904733,
      0.033984044975225725, -0.068927293925928, -0.10621434292392065,
      -0.11523206084198823, -0.14049134967511073, -0.21942398084749176,
      -0.3701138761760071, -0.5842462764255376, -0.827201176398985,
      -1.0454014695790563, -1.1791737920057574, -1.177955043335839,
      -1.0140380419170933, -0.6913585873863553, -0.2470102476941771,
      0.2550586793492328, 0.7367963412866805, 1.1222889525734507,
      1.3536682751841553, 1.4029300917634244, 1.2768987100076101,
      1.0142382726041037, 0.6753415837766091, 0.3276445878234214,
      0.029996084652834543, -0.18010740407336517, -0.29337364474056304,
      -0.32811697952278907, -0.32255647276249905, -0.322138398212228,
      -0.3652506855710661, -0.47108403474947014, -0.6328340515299946,
      -0.8180721086914353, -0.9762821662529604, -1.0517249447083072,
      -0.9984098328419425, -0.7933759754698521, -0.44485481089864043,
      0.006881945237993015, 0.4963957743715064, 0.9461796275869276,
      1.2829385772090003, 1.4532067374739244, 1.434593423893295,
      1.2400005420202513, 0.9138538450554132, 0.5213232435822865,
      0.133194805934229, -0.18991640391233872, -0.41020951144961887,
      -0.5192173916040379, -0.5367763173089342, -0.5029142708705389,
      -0.46489044536010615, -0.46281263209354045, -0.5175873857227691,
      -0.6243401855329398, -0.7530354218305013, -0.8561821222894526,
      -0.8816930761203114, -0.7876283983861809, -0.5550357332204462,
      -0.19553065435664863, 0.24846204852209205, 0.7110781262377953,
      1.1163772398602094, 1.394580816457576, 1.4973254409027723,
      1.408280564531368, 1.1465854463275662, 0.762292857402596,
      0.32493888754349753, -0.09198743775227886, -0.42693178767535006,
      -0.6427299893590919, -0.7327268865513997, -0.7192483682536912,
      -0.6450220779076253, -0.559885358770212, -0.5062665782083585,
      -0.5071943612837494, -0.5599141885777683, -0.6367443027909077,
      -0.6929464968520661, -0.6795875812157175, -0.5580754796076408,
      -0.3125946868050025, 0.042843663024066836, 0.46470145104203686,
      0.8877040636144485, 1.2383899144286195, 1.4512310446228451,
      1.4834612127937254, 1.325023248170457, 1.0012084363275966,
      0.5673221818388824, 0.09663786951900441, -0.3354809275449438,
      -0.667499960462778, -0.8639075995267965, -0.920860086064192,
      -0.8640905388074535, -0.7398080264169996, -0.6010329357019961,
      -0.4929140404867427, -0.4407801750197982, -0.4439467320983906,
      -0.4768101146099777, -0.49689538404212946, -0.4577419525374261,
      -0.32326549361022094, -0.07983428294378508, 0.2571533838112046,
      0.6440422544268161, 1.0170583478020914, 1.305972491287228,
      1.4500398710289168, 1.4123548631528302, 1.1891021182687405,
      0.8113982853587514, 0.33920589809472246, -0.15127888185881494,
      -0.5837838146867262, -0.8978341918168165, -1.0606043909355143,
      -1.0720158365788355, -0.9620210990682141, -0.7809347648569949,
      -0.585366038668434, -0.42335678773833, -0.3224741460303901,
      -0.28381623352965824, -0.28336339680983713, -0.280228948508928,
      -0.2296033235801382, -0.09698458604644922, 0.1300527264670523,
      0.43569312646634756, 0.7770612835622867, 1.0926413177591388,
      1.315992362822305, 1.3914566196782165, 1.2880086248209128,
      1.0078010097351318, 0.5872252904636741, 0.09011580742319754,
      -0.405365682623599, -0.8230899100718092, -1.1047043303895794,
      -1.2210621082333681, -1.1767022754878989, -1.006454324209771,
      -0.7651651106187194, -0.5132120064892363, -0.3014624068935963,
      -0.15942175177088475, -0.08946350550709414, -0.06846990721353945,
      -0.05632439403857778, -0.008957960436609458, 0.10750291740568269,
      0.30522114540876333, 0.5688396778725666, 0.857011255187877,
      1.1110417900879992, 1.2686088532729478, 1.2792030397588583,
      1.1174559734067924, 0.7909884634679629, 0.34072281819331846,
      -0.16656782134279657, -0.6518047987554452, -1.0400825198501644,
      -1.2761980196114724, -1.3355792477314226, -1.2280838878832292,
      -0.9938805157379392, -0.6925493096948161, -0.3881744772452457,
      -0.1341419223740965, 0.03862689886676074, 0.12718105550818304,
      0.15456469360032282, 0.16103478236025967, 0.19086273341602084,
      0.27821799928872376, 0.43585462253984814, 0.6496049536853818,
      0.8802079677707169, 1.0721322591475155, 1.1672632087180352,
      1.1200587601566387, 0.9103570710807362, 0.5505505512319485,
      0.08519591467117822, -0.41702504095050946, -0.8772005781409065,
      -1.222700148509624, -1.4024061265224266, -1.3970698036855707,
      -1.2223757412218872, -0.9240690355076069, -0.56642312723303,
      -0.21692666825950152, 0.06904773579746526, 0.2598784931867292,
      0.35288478156818937, 0.37196150662491806, 0.35845290218300974,
      0.35775001310025356, 0.40515644811199647, 0.5147301677696693,
      0.6740373108981819, 0.846241235555508, 0.9790751670171384,
      1.0184797745141128, 0.9234708330389038, 0.6784431115913794,
      0.2997076444914478, -0.16554323973721258, -0.6477903164446241,
      -1.0693493171717305, -1.3608300126886423, -1.4759929452663905,
      -1.4014715548733436, -1.159062213212756, -0.8000826689952245,
      -0.39321687771670755, -0.008828006727802484, 0.29645354192796153,
      0.49117553889745136, 0.5738749986985119, 0.5702622936514237,
      0.5236938898584622, 0.4815152104961349, 0.4808646927123483,
      0.5376334155623629, 0.6414481226166013, 0.7579974311808556,
      0.838139883770233, 0.8314898010564045, 0.7010098331734198,
      0.43484153781093704, 0.052254438464106934,
    ]);
    const expected = [
      [
        -1.019433829351009, -1.5153380043603892, -0.9300527537991304,
        -0.9136138004609339, 1.7981233528602218, 2.5495491937638195,
        -0.6708736326584714, -2.1200755402143834, -0.5118452989869107,
        -1.0323392874926685, 1.940406695495478, 1.6398042538790771,
        0.8290796211637405, 2.437581866151097, 1.221522050361563,
        0.2656790826157012, -0.3773819376055439, -2.4880942163943254,
        -1.1364495063379547, 2.3923397400890414, 1.5525013543140016,
        -0.03079090512358908, -0.3806119077996729, -2.3616446621549256,
        -0.33617926403053383, -0.6277115621103594, -1.7078519030808579,
        -0.9748307952053207, -1.2482819760685453, 0.582330512660581,
        2.8604367829431254, 0.7926122356766379, -2.181458757073477,
        -0.8055384706029344, -1.2174251326078636, 0.7506487197366254,
        2.2669059160601805, 0.6168346625588899, 2.07016213007764,
        1.890410558458122, 0.46300870155203067, 0.19830247814456858,
        -1.8259492097655694, -2.284124858318118, 1.3057448185512135,
        2.3156962161908687, 0.35036834409543455, -0.10144793745537978,
        -1.3828062230939047, -2.349953195230394, 0.8627431388923756,
        2.690086613631955, 0.45400336530379104, -0.5090756219962855,
        -1.06208640442672, -2.2009246463030627, 0.3581672990656767,
        2.902201738626797, 0.7574612664667961, -0.9276248601162232,
        -0.9313426476546394, -1.8758170396145424, -0.10700540152823419,
        2.9038739623624537, 1.2012614403431066, -1.257717764565165,
        -1.0167239662558154, -1.4514929876145743, -0.4403978546998574,
        2.692428352334413, 1.6953391911967584, -1.4191252218017,
        -1.2973017517125265, -1.0262170509191129, -0.5782765762533985,
        2.3112641385930006, 2.1385883208208836, -1.3681812621713456,
        -1.7096125613424666, -0.6983284567117279, -0.49937907116759767,
        1.840437444136567, 2.4408007725538554, -1.1072666327962901,
        -2.161420811914715, -0.5449086939573493, -0.22958709578594552,
        1.3797244190733153, 2.5406024265491896, -0.6796831306047538,
        -2.5623261610004366, -0.5844751869876296, 0.12921512966818052,
        1.0772096663926802, 2.355070981117115, -0.09015480291884942,
        -2.9116321416037914, -0.7051785536122163, 0.3228385232297523,
        1.3051482386640303, 1.4324196789526107, 0.5272013246590469,
        1.5278160387935922, 1.539322269699486, 0.6856379034261935,
        1.4224183163110717,
      ],
      [
        -0.02485737119048371, -0.013049515211682159, -0.10972956692553336,
        0.11134513587621336, 0.1213303751825078, -0.2238383477421995,
        0.24060390502237974, -0.2178289900551296, 0.17311991531773271,
        -0.1202052558111881, 0.06324312766832561, -0.02139825024577242,
        0.010497852715148989, -0.01866975298025795, -0.19650567216411258,
        -0.13109169327774287, 0.30199410282625994, -0.26805464110750965,
        0.20082845496128576, -0.1601327297148384, 0.1432366812850535,
        -0.13188817400857208, 0.11236895984874926, -0.0822838243989952,
        0.04885585950488332, -0.02199144084228674, 0.007121994850425251,
        -0.0024931092271404374, 0.0020782838076166326, -0.0009998947252826361,
        -0.001305085276079027, 0.0024662322353223723, -0.0010174283605742056,
        -0.0015200544594874525, 0.0023109806820837816, -0.0004687927318395319,
        -0.001906990154107139, 0.0021112561041809886, 8.848773739589804e-5,
        -0.0021874741006498175, 0.0017956839433677524, 0.0006407703458833082,
        -0.002347609752123181, 0.0013813307612764985, 0.0011578069986641168,
        -0.002378601000556696, 0.0008909910502420407, 0.0016111501873173062,
        -0.002278748902134047, 0.00035163793978570815, 0.0019758671301534905,
        -0.0020535403993854106, -0.0002070584695221129, 0.0022318893483875995,
        -0.00171537008790977, -0.0007543648967645504, 0.0023651385659131463,
        -0.0012828346804200576, -0.0012601735963939792, 0.002368279366048189,
        -0.0007797338354716485, -0.0016966607628471542, 0.002241144343280878,
        -0.0002337369992518976, -0.0020398146577553086, 0.0019907218362237903,
        0.00032511461201673866, -0.002270761091676, 0.0016307323950385322,
        0.0008653157994800131, -0.002378899711611432, 0.0012297286341573428,
        0.0019824897516627837, 0.001324528607234821, 0.014212348667485516,
        0.03761773522642592, 0.0758730207639716, 0.1367235617707537,
        0.03869167690379324, -0.25366168945782164, 0.20776024663634257,
        -0.0831319725809696, 0.010849706932027933, 0.18395517528288674,
        -0.49781084033238404, 0.26980000554284567, -0.22673625311310538,
        0.1480893560381003, -0.11849526455927903, 0.09511315196864509,
        -0.07205328030703784, 0.04705638633629239, -0.023980449723599303,
        0.008119165547296562, -0.0014623958769907795, 0.0011712867154998604,
        -0.0021020887134760744, 0.0010116189046093587, 0.001404199524515028,
        -0.0023834722861096475, 0.0007201001100404157, 0.0017427964261491466,
        -0.0022175089998516394, 0.00016693791578287372, 0.0020736759902313037,
        -0.0019530739525006019,
      ],
      [
        0.00027297388326546075, 0.008547221403070866, 0.034555298822972896,
        -0.037448425039727166, -0.036030770987639, 0.0649687527781883,
        -0.06682969693535593, 0.05826103996054598, -0.04585706710062639,
        0.032324791555971094, -0.019667554947429812, 0.009638670575581227,
        -0.003166640130057764, 1.1742299458075647e-5, 0.0008973522659482665,
        -0.0007634725453173846, 0.0004031411098794433, -0.0001504506242064286,
        3.834579478435101e-5, -5.023318542993325e-6, -6.090369027767182e-7,
        4.82750387886165e-7, -1.1533231728362613e-7, 1.2886417044739305e-8,
        -1.9300816339231795e-10, -1.2815025960099952e-10,
        1.1253967545661769e-10, 1.0223690356435527e-10, 5.652261865986541e-12,
        -9.59594961181535e-11, -1.0805059176721231e-10, -1.933841639988188e-11,
        8.741595481791126e-11, 1.1261692684210607e-10, 3.275612819660004e-11,
        -7.766294385825094e-11, -1.1562886480089335e-10,
        -4.5720569356623195e-11, 6.683932145523894e-11, 1.1704507931851286e-10,
        5.805752923023507e-11, -5.509446676457072e-11, -1.1684741784641e-10,
        -6.958814641823851e-11, 4.258892100820605e-11, 1.1503652111641989e-10,
        8.016401066913301e-11, -2.949871091682063e-11, -1.1163703645315814e-10,
        -8.963134597558338e-11, 1.5996753908471958e-11, 1.0669814531181474e-10,
        9.786051862315098e-11, -2.2772943286758105e-12, -1.0028836080143563e-10,
        -1.047390600779026e-10, -1.1482511269809332e-11, 9.249268181276393e-11,
        1.1017511589355745e-10, 2.507190398681474e-11, -8.342018516521739e-11,
        -1.1408816629132586e-10, -3.832222807914659e-11, 7.319754415832351e-11,
        1.164284788291474e-10, 5.104232350162191e-11, -6.196215784367056e-11,
        -1.1715928426427928e-10, -6.305475107046869e-11, 4.9875069913955294e-11,
        1.1627702281959613e-10, 7.419747876189859e-11, -3.7100689955101086e-11,
        -1.1378277730250396e-10, -8.432263373747324e-11, 2.3805730901572494e-11,
        1.0972650725832654e-10, 9.32819376836306e-11, -1.0192432022118196e-11,
        -1.0415159392240459e-10, -1.0095212551254922e-10,
        -3.567217838591773e-12, 9.714003508925284e-11, 1.0722967127886944e-10,
        1.727549129204203e-11, -8.879161100311155e-11, -1.1202624837472984e-10,
        -3.0744325644227814e-11, 7.92174792634171e-11, 1.1527364011328465e-10,
        4.379028815858329e-11, -6.854768549749317e-11, -1.1693554476193847e-10,
        -5.6232805850481864e-11, 5.6935724540565683e-11, 1.169771725224245e-10,
        6.789691101841108e-11, -4.453255640965444e-11, -1.1541357351788702e-10,
        -7.862678851499612e-11, 3.15163548211529e-11, 1.1225494441271193e-10,
        8.826641414410191e-11, -1.80658293941483e-11, -1.0754415554752833e-10,
        -9.66904060533238e-11, 4.3629142315268045e-12, 1.0134735420485552e-10,
        1.0378888030568685e-10, 9.39856042647537e-12, -9.375896710495918e-11,
        -1.0944377887102327e-10, -2.3027624615918873e-11, 8.486877526748981e-11,
        1.1359645998184629e-10, 3.634058690536243e-11, -7.48155646847146e-11,
        -1.1617814669182725e-10, -4.9148547336279474e-11, 6.372662289788999e-11,
        1.1715375058655034e-10, 6.12837469380399e-11, -5.175401841827553e-11,
        -1.1651422722273478e-10, -7.25713716695889e-11, 3.907490255519789e-11,
        1.142667453167234e-10, -1.4942682630173018e-5, -0.0018096257644310896,
        -0.020268292024752114, -0.01647675094621417, 0.07232733558132404,
        -0.05288093876399809, 0.029321544410031763, -0.017162745633862827,
        0.0137207281193248, -0.013993946514586502, 0.014262412448609601,
        -0.012807805794754941, 0.009730671358870471, -0.0061370581184887005,
        0.0031389235394051244, -0.0012417570120548495, 0.0003333903178810548,
        -2.543492576855757e-5, -2.8950557158966443e-5, 1.810914876054071e-5,
        -5.9264857218211494e-6, 1.1715636990111229e-6, -1.0361278831020357e-7,
        -1.1918171776417171e-8, 4.60101331099587e-9, -4.5258076536093245e-10,
        1.184570646371924e-10, 8.383433279995406e-11, -2.7255804349819818e-11,
      ],
    ];
    const result = wavedec(data, "db29");

    const reconstruction = waverec(result, "db29", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db30", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4863103687499183, 0.897142993090216, 1.1731317587535885,
      1.283265491168468, 1.2303538342020581, 1.0484852368067843,
      0.7932251827551329, 0.5270871898201879, 0.30395421389530813,
      0.15634933427113262, 0.08869904906028264, 0.07819203152902676,
      0.08289918891650291, 0.05497478901144087, -0.04453248327857118,
      -0.23314083070976704, -0.49997920041715166, -0.8063120621918516,
      -1.0935465289073758, -1.2968179005130231, -1.3608153099094367,
      -1.2539073607520261, -0.9770117308085541, -0.5649289494420668,
      -0.07971158044224735, 0.40239576926235376, 0.8073231657982389,
      1.0789127395271423, 1.1902535145561128, 1.1479385560181488,
      0.9883278468301636, 0.7668794630213009, 0.543316865612989,
      0.3664060390823978, 0.26217295993101236, 0.2284877299478581,
      0.23730578472882338, 0.24390131182968278, 0.20064559712755006,
      0.07172197709628841, -0.15507828817690572, -0.462605835166561,
      -0.8062523833221273, -1.1231682913294019, -1.3466070084394934,
      -1.4218865145568063, -1.3200139028962035, -1.0455634068964237,
      -0.6367965461153646, -0.15791773888503333, 0.31470524313419557,
      0.7090423047617146, 0.9726475789217255, 1.0830000431675093,
      1.0505161074439506, 0.9136382134523809, 0.7273693640199541,
      0.5482376553446207, 0.4195345027650681, 0.3605620197493186,
      0.3625784498576662, 0.39241047124090017, 0.40274117320386593,
      0.34637608421240595, 0.1907664809107234, -0.07101267365152003,
      -0.4157518549770665, -0.7933613807957786, -1.1372303453065624,
      -1.379226606022373, -1.4656809813017793, -1.3704157197752311,
      -1.1015776231974044, -0.700546875321411, -0.2331375932507423,
      0.22479958324631205, 0.6038913849465277, 0.8558844927748186,
      0.9629129714801092, 0.9392387757853519, 0.8251945430473033,
      0.6749967481292152, 0.541609047162857, 0.46254288808583066,
      0.4502099053668592, 0.48925882797251025, 0.5415372660789446,
      0.5573675286474555, 0.49020699721671407, 0.3108853809564215,
      0.017695304964723213, -0.3603606210699658, -0.7681503904202632,
      -1.1358353288599863, -1.3944169668032762, -1.4916299917317422,
      -1.4042828451114004, -1.1439990442539887, -0.7549246562954867,
      -0.3039389624989989, 0.13425536046046233, 0.4935378117834242,
      0.7302999006989691, 0.8315678434881886, 0.8154520603523185,
      0.7239801567000964, 0.6102683813215923, 0.5233853151611971,
      0.4948114252035335, 0.5299630319621308, 0.6069403482808362,
      0.6828069751080652, 0.7057793180688701, 0.6301847346967431,
      0.4303200111975018, 0.10959126261443813, -0.2975183983097849,
      -0.7313170531021713, -1.1193050158035667, -1.39215548057542,
      -1.4994020945681457, -1.421003876246194, -1.1719545864991197,
      -0.7988063530670724, -0.3689617758424195, 0.0446398857663019,
      0.37969997734040717, 0.5976739820507042, 0.6906859454548919,
      0.6806768623462119, 0.6111712074074862, 0.5338903025762862,
      0.4937171967596598, 0.5159063445648457, 0.5988367009687836,
      0.7141798700003004, 0.8144555572413946, 0.8460532725795754,
      0.764389033077653, 0.5472945743967039, 0.20314964023920326,
      -0.2284364290126548, -0.6837327346758033, -1.0881734595100487,
      -1.3726555808521512, -1.4889076437045388, -1.420195786814081,
      -1.1847680425902336, -0.8312190158225948, -0.42694036831101695,
      -0.04251356036829956, 0.2641212431275608, 0.45986488319166274,
      0.5421103875951292, 0.536589147328775, 0.4881215175988203,
      0.446759130756356, 0.45295049033854656, 0.5255859899612518,
      0.6560283078466276, 0.8096989022507963, 0.934857950756045,
      0.9763704691331705, 0.8909603245049534, 0.6600424728858447,
      0.2967974279434491, -0.15443105533043047, -0.6264273634418507,
      -1.043177077450678, -1.3363623347136029, -1.4602999479586678,
      -1.4017105371041545, -1.1819719126618866, -0.8513569273521451,
      -0.4767243177136114, -0.12572985399148562, 0.1485437385445461,
      0.31878195380627045, 0.3877805177424355, 0.38499736606596274,
      0.3563447456966832, 0.34995042534979115, 0.4016215881085501,
      0.5238039030597035, 0.7009277089931971, 0.8924003722971131,
      1.042549867079838, 1.0950414532980957, 1.0081263688989432,
      0.7668326925606024, 0.38893874920256355, -0.07690219788934606,
      -0.5605719255233561, -0.985241837210421, -1.2839447689897117,
      -1.4139730167591291, -1.3656383777535435, -1.163316254758847,
      -0.8585957926518456, -0.5172975000526354, -0.2036151420735327,
      0.03468236542005737, 0.17635840313253154, 0.2297050337926907,
      0.2278179523347036, 0.21749413024269387, 0.24470426193670353,
      0.34045000578317136, 0.5107088371929632, 0.733124604930077,
      0.9613826542499802, 1.1362472453034131, 1.2005295709643717,
      1.11422777236536, 0.8659958480745513, 0.4779799333061073,
      0.0026894767039871426, -0.4874588927684811, -0.915467746894741,
      -1.2162850538809453, -1.3505559350184735, -1.3123077901496516,
      -1.1287744100620831, -0.8525042459775088, -0.5477950673364846,
      -0.2748785944087861, -0.07580060526388299, 0.03452377430872883,
      0.06993418011361584, 0.06704924447056776, 0.07334009635104372,
      0.13240822540786967, 0.2703280163228132, 0.48664170489423575,
      0.7524128419857932, 1.0159506660268853, 1.2148630950035197,
      1.2914721754143081, 1.2077420193480959, 0.9559495009128975,
      0.5623546949605986, 0.08284634696109397, -0.40848088837824814,
      -0.8351108919633468, -1.1344647104167893, -1.2709039489848089,
      -1.242282055543298, -1.0785455041013414, -0.8328524893176649,
      -0.5675180830988935, -0.33835246336793195, -0.18131996844845377,
      -0.10482336346184051, -0.08946857410588552, -0.09525579939634696,
    ]);
    const expected = [
      [
        -0.8955987718431815, -2.5693090761241484, -0.6098349960226757,
        -0.021295904934477264, 0.9656195696249199, 2.6016145213494237,
        0.33721912014979366, -2.598187942808381, -0.9533936743497636,
        -0.5775382966040048, 0.592696953558713, 2.453562380030123,
        0.6264658457956452, 1.848967495074031, 1.979314781142649,
        0.6447018185343546, 0.5851574895905964, -1.4946375002974384,
        -2.7299721759955085, 0.3473289058018191, 2.0792236966820585,
        0.8219847462524994, 1.0757231278750814, -0.7276254263263239,
        -3.048248460982172, 0.014570877820929373, -0.27554498475145456,
        -2.5915954774286027, -1.191464074783501, -0.1188872841453643,
        0.3794079508750767, 2.4693217282840436, 1.4023198712835585,
        -2.1487837951931983, -1.560937265543431, -0.531887821583613,
        -0.20193171922075762, 2.4489613190116657, 0.9259982556435619,
        1.3819894944073168, 2.257861887178002, 0.8884127255577368,
        0.7726901619594299, -0.6520944562784257, -2.9122111261530526,
        -0.7014082629211726, 1.9261094708823938, 1.151144545575594,
        1.0253940200328866, 0.18723042011097377, -2.6792776177090794,
        -1.7227626777052711, 1.3911428194402122, 1.2978054486414436,
        1.1450539322759512, 0.9621124573974251, -2.0571808001534406,
        -2.5002485255594618, 0.6282641472430319, 1.293868949201481,
        1.1323119062842266, 1.5662958366304927, -1.1438752801306145,
        -2.9144900824318722, -0.25899860231332655, 1.1235507637448574,
        1.00186791028981, 1.9237462760893895, -0.07907106396205839,
        -2.8997472624691483, -1.143379641002126, 0.7921302073325225,
        0.7782076507798855, 1.9979726953390888, 0.9775349282141894,
        -2.4545243379216464, -1.8924011811691512, 0.32832881189947766,
        0.4910891460554713, 1.7949102145659799, 1.8706502840940527,
        -1.6423809856858549, -2.3885824342212607, -0.21677836006780418,
        0.17159221766836127, 1.3593332002845868, 2.472600118870655,
        -0.582714196737779, -2.5482081991834074, -0.7747065552991174,
        -0.15039288189801722, 0.7644862795040817, 2.7053290842575914,
        0.559246495160076, -2.320348288811509, -1.2939563234088742,
        -0.4081140162049511, 0.04452732541323777, 2.620681126001977,
        1.5142324290998728, -1.6003417425489175, -1.850363450494763,
        -0.46703622594479616, -0.3057206937612761, -0.4913774162091772,
        -0.34828885238433055, 0.16982713909671218, -1.6098877826430171,
      ],
      [
        0.012284235556516889, -0.016266142242367908, -0.06524379821369283,
        0.04530164122225755, 0.11305460728034417, -0.1616735525678985,
        0.15839184707412013, -0.1418481316925832, 0.12082527418162003,
        -0.09337689698651988, 0.062338119959615385, -0.04213349194933395,
        -0.010354504903346823, -0.04659525840561431, 0.026976311484719732,
        0.23562369869577288, -0.024487167130589967, -0.19279482013509427,
        0.2707117369923431, -0.2734793313988592, 0.24651894153182433,
        -0.20405230712579664, 0.15107264365383977, -0.09511734476422068,
        0.04674530252255673, -0.014368221399306075, -0.00040491165379722967,
        0.002934095252933256, -0.0012404356363242045, 0.000714530019384472,
        -0.0018680715250645155, 0.0023602866598558475, -0.0007968338589882202,
        -0.0014852185373605091, 0.0020655529868072375, -0.0003236340138835306,
        -0.0017799870216709324, 0.0018815476020724111, 0.0001325330063247221,
        -0.0019976068011808477, 0.001616668278920521, 0.000581973230871427,
        -0.0021262726256948863, 0.001279894925255922, 0.0010055339423069912,
        -0.0021603895497171346, 0.0008862090006623718, 0.0013843816990604233,
        -0.002098441395026488, 0.00045311607462377037, 0.0017016706685799477,
        -0.0019431821294547866, -1.2518348929409534e-7, 0.0019432918907360053,
        -0.0017015162543771605, -0.0004533611613058406, 0.0020985013066058453,
        -0.0013841892748594732, -0.000886437346125597, 0.0021603973455934402,
        -0.0010053121877076812, -0.0012800969097656358, 0.002126227492574249,
        -0.0005817319885496428, -0.0016168344389695243, 0.0019975114840725993,
        -0.000132284214213773, -0.0018816769842843058, 0.0017799726265735748,
        0.00032304573391224396, -0.0020628905970021677, 0.0014826029380117366,
        0.0007586082419946046, -0.0021787028655152843, 0.0010322148961963262,
        0.0009426069624089997, -0.0026897844953394337, -0.0006875273978985088,
        -0.0005247886684617201, 0.004043618855424827, -0.027918870448668053,
        -0.06634067221827286, 0.16975287547796036, -0.11321060484965068,
        0.03857415384712966, 0.007645206153786817, -0.0234232183884735,
        0.027678374562866925, -0.02474269020519182, 0.0174148890485767,
        -0.007500473856690315, -0.0016812532336638929, 0.006810828553360198,
        -0.006602260021237738, 0.002901425440584932, 0.0005753917925490253,
        -0.0011773243755783382, -0.0006266572909744522, 0.0021186629490706614,
        -0.0013240521312143083, -0.000951377623813382, 0.002162218511103866,
        -0.0009447320877003696, -0.0013342445605630396, 0.0021129595383265125,
        -0.0005159626328546363, -0.0016611561983448677, 0.00197055189784294,
      ],
      [
        0.00019457714725132277, 0.006693744871675561, 0.03198586743370745,
        -0.023460530420771574, -0.05154374294645091, 0.07333613304043814,
        -0.06994815573831613, 0.060086046722128694, -0.049096980621753494,
        0.03775385356478142, -0.026452396966775708, 0.0162193382540178,
        -0.008242547653769893, 0.003116264494190005, -0.0005533659101519546,
        -0.00030677551811280604, 0.0003632779152569493, -0.0002059197635151529,
        7.902834884306998e-5, -2.07598508402778e-5, 3.0693774294388515e-6,
        1.240849875917407e-7, -1.930556328629533e-7, 4.863667497474143e-8,
        -5.658263260877469e-9, 1.5288515736175482e-10, 9.649807349508128e-11,
        -1.4083585246030654e-11, -5.792790152334339e-11, -5.080270228584469e-11,
        3.974652698180967e-12, 5.501493999054138e-11, 5.436247355896489e-11,
        2.6279132885086782e-12, -5.157629457430713e-11, -5.731665843832033e-11,
        -9.197638944542959e-12, 4.756248494150244e-11, 5.963006919012145e-11,
        1.5669427933444985e-11, -4.302069250355097e-11, -6.128222483159655e-11,
        -2.1961488118170102e-11, 3.799236252687099e-11, 6.225165222637484e-11,
        2.801442174509895e-11, -3.2543295344794115e-11, -6.252209958757872e-11,
        -3.375187220025504e-11, 2.673227083996019e-11, 6.209630136741317e-11,
        3.91152865190724e-11, -2.0626346353461657e-11, -6.09821949616138e-11,
        -4.4037014942308475e-11, 1.4283973603626566e-11, 5.918858053636681e-11,
        4.8473717691592904e-11, -7.787820346340976e-12, -5.673125034966739e-11,
        -5.236732357968186e-11, 1.2021679199484592e-12, 5.3641151918309964e-11,
        5.567921510859109e-11, 5.3932356146040074e-12, -4.995652478293102e-11,
        -5.836531351191614e-11, -1.1933393999412751e-11, 4.571737617884614e-11,
        6.040847258748443e-11, 1.8334981002769623e-11, -4.096524872260019e-11,
        -6.177211129031711e-11, -2.4539991229175363e-11, 3.575673820783772e-11,
        6.245074541345104e-11, 3.046153042918169e-11, -3.015062648808121e-11,
        -6.243019513111458e-11, -3.605113289101927e-11, 2.42024115335987e-11,
        6.171797936973151e-11, 4.1234197646624315e-11, -1.798887671093701e-11,
        -6.031169212902508e-11, -4.5962108778047226e-11, 1.1576830486897567e-11,
        5.823754000011381e-11, 5.017696729826028e-11, -5.030140393935724e-12,
        -5.5511356348748314e-11, -5.383119713216532e-11,
        -1.5664966227043663e-12, 5.216531538294899e-11, 5.688508158012681e-11,
        8.15140748809891e-12, -4.8243418370642425e-11, -5.930289824048803e-11,
        -1.4638775621733064e-11, 4.377909658542384e-11, 6.106235736249795e-11,
        2.0969278830460487e-11, -3.882936772664051e-11, -6.213990422883095e-11,
        -2.706169488414273e-11, 3.344322659100129e-11, 6.252645637499999e-11,
        3.2855708979820594e-11, -2.7689440142281453e-11, -6.221305413780965e-11,
        -3.828073638800014e-11, 2.162104705536357e-11, 6.120804614385737e-11,
        4.327795872855036e-11, -1.53167968244276e-11, -5.951914046854926e-11,
        -4.779724677862806e-11, 8.837930428186497e-12, 5.7170271212579675e-11,
        5.178130705683491e-11, -2.2639531569408047e-12, -5.4176991035835566e-11,
        -5.5188898026958975e-11, -4.3383546529508374e-12, 5.05906333739326e-11,
        5.798046277899019e-11, 1.0889796256618323e-11, -4.643188918042611e-11,
        -7.3670645708784555e-6, -0.00018314704364198603, -0.0005095291813499535,
        0.0006229448790042053, 0.00021176715078317717, -0.00011438163826453781,
        -0.00017958468331151026, 0.00039289284443839447,
        -0.00046858635910566014, 0.0004089824794844848, -0.0002565213430635341,
        8.424085136956893e-5, 3.968694748545711e-5, -8.771063858069205e-5,
        7.727016556035285e-5, -4.4877663044121436e-5, 1.7690202548453834e-5,
        -3.874824059711513e-6, -3.297703046362623e-7, 6.519678575299482e-7,
        -2.708380170017729e-7, 5.887902585918215e-8, -4.51872995896955e-9,
        -1.1961042311585e-9, 3.569222232027372e-10, 2.3917714117907393e-11,
        5.358933307295048e-11, 3.604617500336839e-12, -5.115040449804322e-11,
      ],
    ];
    const result = wavedec(data, "db30");

    const reconstruction = waverec(result, "db30", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db30_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5131618281223714, 0.9429367630354358, 1.2239922129524958,
      1.3226734005853784, 1.2428980484524885, 1.022996622923392,
      0.7244745642438919, 0.4157099267275824, 0.1548468567916358,
      -0.02371676783850296, -0.11585111944111379, -0.14570557550047264,
      -0.1559480045559838, -0.19302164906072017, -0.2915164171093437,
      -0.4619746594386082, -0.6855331585269085, -0.9169836622596583,
      -1.0955898594032734, -1.160916701529443, -1.0695543840357333,
      -0.8083162783969873, -0.40034152894474073, 0.09767771100130795,
      0.6066584379297852, 1.0420357141154675, 1.3322872130861647,
      1.4345084922490712, 1.3432087865354132, 1.090211619659526,
      0.735796628787331, 0.35342763602280475, 0.012007995381602854,
      -0.2398221108021722, -0.38342456508159783, -0.4316172198631753,
      -0.4217104536997227, -0.4021994576995933, -0.416832846599167,
      -0.49043964231775805, -0.6204016180424594, -0.7761378552281203,
      -0.9068221141344118, -0.9553437509864533, -0.8748289224547641,
      -0.6433061830183571, -0.2725246047648695, 0.1915927649481832,
      0.6772319940477431, 1.101819428156539, 1.3903238128173234,
      1.4922009122445379, 1.3927613570934476, 1.1161349869083521,
      0.7191229825187941, 0.27752685532148774, -0.1315712781356902,
      -0.4471147539579656, -0.6366639627498071, -0.7012379287747549,
      -0.6714073883718475, -0.5959186907633811, -0.5260539964671637,
      -0.5000081810218211, -0.5315095632438209, -0.6057474642693873,
      -0.6837016818535095, -0.7137137430243511, -0.6471886586457143,
      -0.45418100179792886, -0.13459990840332514, 0.27812738008926036,
      0.7221493380708055, 1.1199776198444558, 1.3958824659867695,
      1.493573214935759, 1.389713219899399, 1.0998370116174345,
      0.6751423854522853, 0.19093116067367058, -0.27042334545387925,
      -0.6377387377551734, -0.8659968182158237, -0.9443911909040327,
      -0.8956219528230006, -0.7668753164872251, -0.6150588544631206,
      -0.4903113122396995, -0.4221963977136472, -0.41222533021242974,
      -0.4346368250543546, -0.44514682914386916, -0.3952448944400092,
      -0.24811928181208134, 0.008168876417620485, 0.3539479495273057,
      0.7396492900487088, 1.0957726463147002, 1.3487245202150613,
      1.4385737596480623, 1.3342085170231153, 1.0419851964431388,
      0.6055804981082457, 0.09697607607775666, -0.3992500555863831,
      -0.8044594982322, -1.0627483705553853, -1.1518995334985094,
      -1.0859044349709086, -0.9086346476401105, -0.6805030430852244,
      -0.4617220237492891, -0.2965858497361782, -0.20286750270146925,
      -0.16902031622896085, -0.1597798660397627, -0.1285216378428496,
      -0.032931121075954306, 0.15034409034057988, 0.41613340376769853,
      0.7290115971384086, 1.0300693130065512, 1.2506023080738906,
      1.329278654060841, 1.2283715397923893, 0.9448170987165283,
      0.5131322796935431, -0.0007193468536403694, -0.5131248610345328,
      -0.940938431876021, -1.2194697367047302, -1.3159309317993866,
      -1.235090719977884, -1.0158735535250982, -0.7199444926447949,
      -0.41534091320901745, -0.15943039999326358, 0.014421847115544839,
      0.10312480439393887, 0.13161621318818967, 0.14290444034749236,
      0.18323785209920884, 0.2865211879145715, 0.4622876957679386,
      0.69058636292101, 0.9253040622904963, 1.1051940395304747,
      1.1698133815314433, 1.0762254443628465, 0.8120538442354811,
      0.40135765798345757, -0.0983918673270102, -0.6076811824449211,
      -1.0419738758903334, -1.3302199292952304, -1.430294430629806,
      -1.3375720349775535, -1.084580357184874, -0.7319345664455472,
      -0.35295383688766796, -0.01593146485693908, 0.23142885924544598,
      0.3715234692963937, 0.418042960776425, 0.40878471649469905,
      0.392214829128418, 0.4115341751254667, 0.4906320788186287,
      0.6257827622930522, 0.7853946391786003, 0.9179659144553033,
      0.9661970710620194, 0.8835393255544159, 0.648757656676974,
      0.2745445070016844, -0.1922789495219875, -0.67927980099146,
      -1.103699342644659, -1.390791070152258, -1.4906738192477471,
      -1.3895058278429095, -1.1122049107411687, -0.7160712378185422,
      -0.27696317734715864, 0.1284578608673081, 0.43994049453711204,
      0.6260365478201928, 0.688689562004926, 0.6590856062385183,
      0.5861088277182727, 0.5206515860847203, 0.5000736249958682,
      0.5370173954724516, 0.6155935828055241, 0.695966624502855,
      0.726115288770359, 0.6576094617148345, 0.4611388561836631,
      0.13754420427891834, -0.2787636361219298, -0.725148863212691,
      -1.1237314542972707, -1.3988682618643817, -1.4947905390324667,
      -1.3889598508941974, -1.0977532344771375, -0.6730123681157721,
      -0.19029537426950652, 0.2682400209621918, 0.6320553826474351,
      0.857043884573196, 0.9333408978487003, 0.884367225035391,
      0.7576086712230933, 0.6097555643103667, 0.4902473460210672,
      0.42762417266350905, 0.42229102263219925, 0.4475619703921818,
      0.458629927934161, 0.4069830255358227, 0.2563196847297661,
      -0.0044139275889594765, -0.3545138254306647, -0.7434911143298917,
      -1.1012619186369816, -1.3541180435047355, -1.4424896750098162,
      -1.3359840466064539, -1.0418232079947336, -0.6044486556563702,
      -0.09628827611256512, 0.3980823005739617, 0.8004832429042947,
      1.0558079408777021, 1.1427631190982122, 1.0761394259544204,
      0.9002586879133863, 0.6754972703373648, 0.46153029399278184,
      0.3017290897005396, 0.21277418368934542, 0.18211958684106944,
      0.1738371490869709, 0.14113472337735133, 0.04206393946323134,
      -0.14592219907799692, -0.41661059134571987, -0.7335542143321553,
      -1.0370899986716482, -1.2582020510205993, -1.3357457857664388,
      -1.2326075611494896, -0.9465800347858144,
    ]);
    const expected = [
      [
        1.6113413249389505, -1.2785076523397376, -1.1039063391305488,
        -1.2894572718380581, -0.3522824780042098, 2.640317269605012,
        1.6262014891420884, -1.8654526651474266, -1.104876070672002,
        -1.0708241524126099, 0.2472454686617697, 2.4303841398251307,
        0.6369235466183937, 1.9686868945052982, 1.959126305500803,
        0.3803396991548083, 0.05750953351177339, -1.9202515893364382,
        -2.006710766142318, 1.7572674712721637, 2.161302801842787,
        -0.016782163768620868, -0.41293954054972054, -1.713265976899395,
        -1.7299183482505462, 1.9236986393051865, 2.44111867583789,
        -0.6843109066450166, -1.2126392781484507, -1.1858690225020307,
        -1.0841179933279284, 1.9754913242336756, 2.481527558557594,
        -1.1298642223679818, -1.4822253997762445, -0.9589175088351871,
        -0.6462559682851446, 2.361617994989842, 0.9132066457699406,
        1.4863643657302137, 2.307701001479342, 0.7029031077447896,
        0.33381811253655813, -1.255300137648099, -2.583418562454625,
        0.6943117896374589, 2.5340947143563564, 0.48462325594921196,
        -0.23000365394306793, -1.2332880112287705, -2.278449946232491,
        0.8854766561419263, 2.759281933219233, 0.2501763226828418,
        -0.7849148391825044, -1.1640642402334227, -1.8876011430158874,
        1.0431576333698702, 2.8802416871208227, 0.005693738075184392,
        -1.3099922231901555, -1.0501833903119582, -1.4256565086751694,
        1.1612587170475508, 2.8924476581348273, -0.23949458266841595,
        -1.785428605850995, -0.8959127038547134, -0.9100783622347737,
        1.2351856570224942, 2.795480128321332, -0.4760136582909367,
        -2.1932979216407382, -0.7070722015587673, -0.3603468506821001,
        1.2620245020281609, 2.593040283766721, -0.6948018374303511,
        -2.518231171861823, -0.4908151027871449, 0.20277610246874023,
        1.240656246436059, 2.292808968379736, -0.8874584340048628,
        -2.7479913113244585, -0.255377320409449, 0.7581009409771942,
        1.1716279134154923, 1.906449785688915, -1.046713684119899,
        -2.8750258017663355, -0.004628214157622997, 1.2700938838031501,
        1.0903121069974862, 1.3858323524284208, -1.060975697399581,
        -3.0536186000000565, 0.47038985157968577, 1.4430839466360155,
        1.3204181377816369, 0.4348692095888606, -0.8170539407677366,
        -2.4546872654525456, -2.083933354715854, -1.9840773873754671,
        -1.927910660205061, -2.8318999800050446, -1.542219398695203,
      ],
      [
        0.012367951613633528, -0.0018431447929470883, 0.004706571860252382,
        -0.003547665852782826, -0.007120364999078168, 0.013352004310626353,
        -0.014372466847027001, 0.011437775187580056, -0.007181170177130586,
        0.005670801778297808, -0.006009736242609857, -0.0028988735856298234,
        -0.029328173863882027, -0.0452042411849414, 0.029675540587724866,
        0.24864093152033737, -0.025385077304013504, -0.20568970193694297,
        0.289810617972153, -0.2941348936554423, 0.26608430608538625,
        -0.22052363449081708, 0.16301922275954026, -0.1020396930043326,
        0.0492660124647395, -0.01405713711584934, -0.0015930132101764775,
        0.003469777754474555, -0.0006939241420730229, -0.00020195296585572361,
        -0.0016692420850776522, 0.003264874855145162, -0.0020323413702921247,
        -0.0011625763175744268, 0.0030962281600139144, -0.001759258299322745,
        -0.001433883935077546, 0.0031115240079701637, -0.0015020617974696596,
        -0.0016941646837883503, 0.003100696054122333, -0.0012316937880365712,
        -0.0019384553682424716, 0.003060845758088124, -0.0009497963430205352,
        -0.0021646043085544286, 0.002992344313816122, -0.0006590123854087287,
        -0.002370492914640693, 0.0028958409299580812, -0.00036205804480024387,
        -0.0025541972350142245, 0.0027722305857260515, -6.171732803189107e-5,
        -0.0027139941965111276, 0.0026226784527570404, 0.0002392028697191942,
        -0.002848392667551117, 0.002448575970324114, 0.0005378828289748466,
        -0.0029561296795295425, 0.002251560755378892, 0.0008315297229005506,
        -0.0030362026108928975, 0.002033468742826743, 0.0011173934359163704,
        -0.0030878557772459772, 0.0017963481961647371, 0.0013927796896520048,
        -0.00311083958798674, 0.001542703634087037, 0.0016878409980593024,
        -0.002742429648648828, 0.003386535678220221, 0.009761959098210945,
        0.0177868516729709, 0.046783254781193176, 0.10054817994371634,
        0.15546088746206219, -0.04318726975738282, -0.16820031270077027,
        0.30871366573591025, -0.3655375026706162, 0.370011841861277,
        -0.367246702602756, -0.07843963226643508, 0.09330450598467338,
        -0.1412828899701363, 0.10834151077106748, -0.08207275236923821,
        0.05032317944843551, -0.0220041786808965, 0.0014974369055972404,
        0.008452882324700019, -0.008644885459118993, 0.0036364759456919316,
        0.0007532042329737311, -0.0011797755419674265, -0.0013289432533900901,
        0.0031306588936586615, -0.0018419671077655895, -0.0013470125318350132,
        0.003109608417270073, -0.0015889059496866289, -0.0016095308936906986,
        0.0031075144199054767, -0.0013227421741083916, -0.0018593569153175613,
      ],
      [
        0.00020540812324013844, 0.007072252010829084, 0.03382511466979371,
        -0.024788749437576547, -0.05455846038412656, 0.07764109132901838,
        -0.07407838820635015, 0.06365395274785297, -0.052024744101254454,
        0.040009273864750866, -0.028030102150132036, 0.017180526145902007,
        -0.008724059859705632, 0.003292206469407311, -0.000579447315618292,
        -0.0003285653778355032, 0.00038611778522966986, -0.0002183535166404719,
        8.364953425729402e-5, -2.192698728787754e-5, 3.2275088935237433e-6,
        1.3624128097404542e-7, -2.048274655706954e-7, 5.1397470511755924e-8,
        -5.927824705966062e-9, 2.0019353515928731e-10, 1.0811271313331689e-10,
        -5.120476494595296e-11, -1.0432183451367943e-10, -5.966811558295946e-11,
        4.290388097088266e-11, 1.0376510922747915e-10, 6.374618867431656e-11,
        -3.82454283809701e-11, -1.0305569893247361e-10, -6.767588666151643e-11,
        3.349827621479547e-11, 1.0210441325193673e-10, 7.144668028726711e-11,
        -2.8672129621257183e-11, -1.0091515059296404e-10,
        -7.504994379956982e-11, 2.377873503005364e-11, 9.948958363689924e-11,
        7.847791357955171e-11, -1.8830861818566558e-11, -9.783079813361381e-11,
        -8.172161358979801e-11, 1.3839481577243656e-11, 9.594537726943519e-11,
        8.477236051320409e-11, -8.812671877329843e-12, -9.383232662437341e-11,
        -8.762656170277851e-11, 3.767045304775414e-12, 9.150065433872944e-11,
        9.027689744407797e-11, 1.2874973604668129e-12, -8.89549695819387e-11,
        -9.271307838738409e-11, -6.339745897532017e-12, 8.62018572505054e-11,
        9.493606954730634e-11, 1.137766999977129e-11, -8.324443280773338e-11,
        -9.693337695731214e-11, -1.6384828818895256e-11, 8.008748043401665e-11,
        9.870309133962802e-11, 2.1358408315944672e-11, -7.675262023546982e-11,
        -1.0024481302337132e-10, -2.627958126809805e-11, 7.323477204718788e-11,
        1.0154644676239891e-10, 3.114248572049887e-11, -6.954472191847246e-11,
        -1.0261586959183553e-10, -3.592812428531344e-11, 6.569384025221761e-11,
        1.0345129406389783e-10, 4.0627676743784414e-11, -6.168644310461706e-11,
        -1.0403187725218146e-10, -4.5234462098780564e-11, 5.753859323537698e-11,
        1.043776385474897e-10, 4.973773086130886e-11, -5.324964391539928e-11,
        -1.0447157477957817e-10, -5.412248152192431e-11, 4.884278108311778e-11,
        1.0432818896104986e-10, 5.838506873601298e-11, -4.4310361839688516e-11,
        -1.0393055168347278e-10, -6.250748906995066e-11, 3.968712854482437e-11,
        1.0330255701268515e-10, 6.648352577303497e-11, -3.4965956687441155e-11,
        -1.0242660132414694e-10, -7.030348430456724e-11, 3.016834209413629e-11,
        1.0130833731309091e-10, 7.395721769796369e-11, -2.5289563051557855e-11,
        -9.995741307922212e-11, -7.74442641456911e-11, 2.0354941993183995e-11,
        9.83670450144857e-11, 8.074225700199109e-11, -1.5378000268674003e-11,
        -9.65506462215267e-11, -8.385963548467746e-11, 1.0358864136612775e-11,
        9.450405378390198e-11, 8.677204614578566e-11, -5.3220895592632864e-12,
        -9.22454704772815e-11, -8.948811391166051e-11, 2.666806840502947e-13,
        8.975595571210195e-11, 9.199190344885025e-11, 4.790045341084754e-12,
        -8.706521735322585e-11, -9.427260881405827e-11, 1.0138889274966895e-5,
        0.0013319625424562877, 0.01675578343825963, 0.021073811019802626,
        -0.0654500876798231, 0.03439663747489612, -0.006730079923767994,
        -0.0052694347892971866, 0.006437198756630414, -0.002469425866577502,
        -0.0024416028213372237, 0.005765905487060671, -0.006644335052029891,
        0.0055702370083695225, -0.0036659374862408178, 0.001916953408117917,
        -0.0007768398553990379, 0.00022317132056111943, -2.991533290596065e-5,
        -9.802806823147962e-6, 7.872025197770753e-6, -2.7039841453016554e-6,
        5.501204037698157e-7, -5.3820493709593245e-8, -3.574090644080161e-9,
        1.6928486083002603e-9, -2.0278127394903954e-10, 8.763819762914011e-11,
        9.621238516576508e-11, 1.2724831720397238e-11,
      ],
    ];
    const result = wavedec(data, "db30");

    const reconstruction = waverec(result, "db30", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db31", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5111133795854401, 0.9401836375935565, 1.2226754625524388,
      1.324832986270238, 1.249547400208128, 1.033516646263924,
      0.7365771858499048, 0.42603509239746695, 0.16003913206871484,
      -0.025784843131013147, -0.12512130247098438, -0.1596026345920804,
      -0.16986155174580428, -0.20153878014027976, -0.2900929730695731,
      -0.4485607880198105, -0.6616338540801925, -0.8877580926640283,
      -1.0688486601368243, -1.1451964218132762, -1.0717414659561455,
      -0.831469927284118, -0.44236480658955424, 0.04405888377944345,
      0.552485926071024, 0.9995543164635893, 1.3118462408280247,
      1.4417460343781519, 1.3773116050005891, 1.1437959505820738,
      0.7965396578085366, 0.40710310948349193, 0.04617229225977659,
      -0.23246760916236608, -0.40293140613773853, -0.47058601245822596,
      -0.467132680493959, -0.43893634200287696, -0.43185120414763684,
      -0.47667198852461307, -0.5791440264887133, -0.7172457369850178,
      -0.8465303290749061, -0.9121785626458802, -0.864623649738271,
      -0.6746272675285996, -0.3437688722077621, 0.09255814432643827,
      0.5706573943618438, 1.0113911443516932, 1.337344058634552,
      1.4901121861193287, 1.4434673094813784, 1.209150636206878,
      0.8338769444716159, 0.38831656856240226, -0.04918789988815009,
      -0.4101260495937459, -0.6502416914947097, -0.7574001178785532,
      -0.7511337414920436, -0.6742399578933763, -0.5788312939435195,
      -0.5106307744467093, -0.49570981948964854, -0.5331814397951743,
      -0.5957678179782265, -0.6380721453028212, -0.6103407790684918,
      -0.4740325697847916, -0.2149988718851279, 0.14934442607778603,
      0.5709482365652041, 0.9801811049176742, 1.300913882895943,
      1.4679688176905523, 1.4426067600374697, 1.2221683670717376,
      0.84141736364576, 0.3651935883308561, -0.1258527151527081,
      -0.5529564427039511, -0.8560393623680614, -1.0055532681433765,
      -1.0065837355114131, -0.8944124313287158, -0.7229023772144216,
      -0.5488706936182178, -0.4165883190843711, -0.34644981164250793,
      -0.3307179262339116, -0.33736422069096866, -0.3208865892408761,
      -0.2371410148236636, -0.05815480453332317, 0.2171304687361068,
      0.5591995501477081, 0.912570733115683, 1.2077016068590942,
      1.377306886054424, 1.3730119598774682, 1.1781136994908672,
      0.8131495712265648, 0.33275374763813304, -0.18554649170565266,
      -0.6579227216311225, -1.012206969973754, -1.2028706655474206,
      -1.2194331869719193, -1.0863788161203023, -0.8548032998310545,
      -0.5880824591365116, -0.3453276408879624, -0.1668929803969394,
      -0.06560399571353798, -0.025843702298506993, -0.010559311403457575,
      0.025824367900614487, 0.12214340074467589, 0.2970577060736921,
      0.5411362202480094, 0.8167202937642248, 1.0657847080640102,
      1.2239094609214096, 1.236843920595309, 1.0754112556459483,
      0.7448583813570901, 0.2861182914483161, -0.23152717979216347,
      -0.7247300396244976, -1.1138919509061418, -1.3401999149449737,
      -1.377755582821447, -1.2378999181084338, -0.9647910316296642,
      -0.6234787495221852, -0.28357832538052435, -0.0027055596277215654,
      0.18617046313100255, 0.28036636160690603, 0.3048718456946021,
      0.30239381288521017, 0.31886690736700524, 0.38840248962129803,
      0.521772817424712, 0.7015841078693821, 0.8855255962960819,
      1.0169485715413409, 1.0400813043127939, 0.9159274297950535,
      0.6346544958722353, 0.2211225572080088, -0.26808229500225833,
      -0.7555944614965329, -1.159644676293698, -1.4119144745698917,
      -1.4725141108032607, -1.3384252946282564, -1.043371984255906,
      -0.6492175460659021, -0.2310917381673981, 0.14000889605031208,
      0.41281870051037006, 0.5657858732250519, 0.6091082288430067,
      0.5785514288319383, 0.5228927023564203, 0.4884550776235787,
      0.5049126397404469, 0.5761750025554079, 0.6787978818517995,
      0.7683698162452373, 0.7922097360402748, 0.7050238862028295,
      0.4833509904155542, 0.13488612175964493, -0.29994702886614966,
      -0.7548346003852135, -1.1513221093073196, -1.4161830925914771,
      -1.4981500113842674, -1.379863453331263, -1.082060946991945,
      -0.6589498718464291, -0.1859015230643857, 0.2574921307884581,
      0.6048249307159881, 0.8164980256149721, 0.8863081733248173,
      0.8395701806791854, 0.7235053320122042, 0.5925863772351252,
      0.49278191991560544, 0.44887060432463166, 0.4581439217844284,
      0.4921088240788593, 0.5056806751534371, 0.45137235649965163,
      0.2946502789378691, 0.02628898817183256, -0.3316971690930697,
      -0.7283241327994288, -1.093771187416465, -1.3549899526866196,
      -1.452951060614118, -1.3572117475395113, -1.074108722181217,
      -0.6464468855910188, -0.14466896827205297, 0.3483836933185118,
      0.7554140302946353, 1.0209513683897493, 1.1220516543820631,
      1.0709253490439137, 0.9090538079749317, 0.694501945774316,
      0.4858295262186586, 0.3268144921119975, 0.2359257079860244,
      0.203195036172617, 0.19517506375752927, 0.1665375018129871,
      0.0751191623060174, -0.10369084596490719, -0.36717110594969066,
      -0.6828540196711148, -0.994321768497067, -1.2339079128436936,
      -1.3391739510006229, -1.2689975977432464, -1.0151404296902045,
      -0.6062539087427194, -0.10315958914457622, 0.4135753863338749,
      0.8608093678044376, 1.1705910414184486, 1.304217705537655,
      1.2592238039271735, 1.0677189316556188, 0.7866671616573344,
      0.48270840521374053, 0.21545648382060012, 0.02353021418740786,
      -0.08319442909249608, -0.12327918400367552, -0.13564841112406628,
      -0.16605457777802685, -0.25181240196165494, -0.4089724321336797,
      -0.6254592069862238, -0.8621322445012591, -1.0616445725296968,
      -1.162911523005529, -1.1174954943528466, -0.9036518384348782,
    ]);
    const expected = [
      [
        2.6716147257616223, -0.39917471473956495, -1.302410078713951,
        -1.0755037247860941, -1.2862167883070168, 1.609943974395953,
        2.6705709188848283, -0.5639215978379613, -1.900429860836057,
        -0.649234000474108, -1.0641188012532066, 2.151909418562286,
        1.3373293892642268, 1.0657710589095122, 2.4596150330691735,
        0.9334149888818597, 0.2232634398744804, -0.8141597463512106,
        -2.57012853921911, -0.14566024271560185, 2.768183258942379,
        0.8009847680972437, -0.2646436582946465, -1.073293852661456,
        -1.9826612862813686, -0.1478251094018334, 2.446223460194465,
        3.244192827233554, 0.2280557117164197, -1.267463314414681,
        -1.0101909316875988, -1.5597130751400612, 0.9543284598095149,
        2.8842863906554346, 0.17340375107703415, -1.9596834911266727,
        -0.6824254926409863, -1.3967754629937834, 1.7063844701055817,
        1.6184559589910192, 0.8518251915813815, 2.4268797420709207,
        1.2709575966513929, 0.35693387111126296, -0.3751814473499154,
        -2.547886781291697, -0.8960720049996377, 2.485407550846811,
        1.3855243459799726, -0.24561464567034544, -0.606113089527477,
        -2.1861616450989065, -0.7690432570389243, 2.6763178410629602,
        1.4884579504741748, -0.8165276982478333, -0.8600461278826353,
        -1.736468122217183, -0.5885605297235758, 2.7372553000590223,
        1.5528417724942989, -1.328190405382212, -1.125872868175997,
        -1.2251364855314126, -0.3527084974209901, 2.6705412675172506,
        1.5647320400997136, -1.7572312879954073, -1.3890398611911916,
        -0.6808685413994853, -0.06413046357250952, 2.485555868978404,
        1.5120196892969229, -2.085956360161816, -1.6324686011788367,
        -0.13289017647976395, 0.26966987312348883, 2.197883251145415,
        1.3857193877163134, -2.3032034942269504, -1.8377575512723134,
        0.39087082879330115, 0.6364241697363527, 1.8280767471339832,
        1.1810804775227388, -2.4047385048795578, -1.9865728134249194,
        0.865458575376594, 1.0195349056268699, 1.4004639538855852,
        0.8973541278523923, -2.390438358218658, -2.067895094144101,
        1.2804727191353762, 1.3839186141102138, 0.9595849007121285,
        0.5220657610126928, -2.2573112628469687, -2.0686370067763282,
        1.613035566341417, 1.7026388976050635, 0.602646994426391,
        -0.16740502418055195, -1.565684214783632, -2.0316519860294036,
        -1.9683428738467363, -1.7554566793207527, -2.4630164102754346,
        -1.5796845231993348,
      ],
      [
        0.016342590324738792, 0.0012470131277913233, 0.06338023802433651,
        -0.020314866090043578, -0.13849515100668255, 0.1723692957558398,
        -0.15903846996941887, 0.1400840723194144, -0.12268648558703434,
        0.10363520696750507, -0.07962706944195583, 0.06413856214142075,
        -0.0040235390656542325, 0.07295267429843787, 0.07845726027433805,
        -0.06051286142392823, -0.2659750885663118, 0.20762781049744825,
        -0.03089654584405013, -0.08354727192377506, 0.12323230039517467,
        -0.11183890499477467, 0.0730379169429014, -0.02758974074278596,
        -0.008147510815227197, 0.02567503240003144, -0.026010143053240332,
        0.017059572601106937, -0.007845653463322087, 0.003261899755278613,
        -0.002657989130897658, 0.0025921478361969692, -0.0008994564590705792,
        -0.0015062028269807487, 0.0022819806426289564, -0.0006188533444869451,
        -0.0016996991661971568, 0.002177399881234589, -0.00030101499301058175,
        -0.001900750897555037, 0.0020480190786439953, 1.837865474960601e-5,
        -0.002064911661133613, 0.001879522310989678, 0.00033740720011376455,
        -0.002189639656112063, 0.0016751322548839136, 0.000649992320721998,
        -0.002272552841045174, 0.001438755784240231, 0.0009501653563487006,
        -0.0023120711827587653, 0.0011749031953674257, 0.0012321941444381624,
        -0.002307436579780704, 0.0008886163564253937, 0.0014906927967862998,
        -0.002258741158236189, 0.0005853590346566763, 0.0017207256807947023,
        -0.002166911046331337, 0.00027092512944530597, 0.0019178991079801253,
        -0.0020337036844478478, -4.8683608204139736e-5, 0.002078449205899716,
        -0.0018616588650393908, -0.0003673615895763446, 0.0021993095732007993,
        -0.0016540033101833805, -0.0006778301329564474, 0.002289421351452007,
        -0.0013640484604938192, -0.0009545406665673865, 0.001327033835075274,
        -0.00708407628041271, -0.020651815432996126, -0.040600846328945436,
        -0.057122501903761155, 0.040834206531273655, 0.18005268769078603,
        -0.1890055126251718, 0.04047195267933311, 0.14870060677003777,
        -0.39220331060653707, 0.33393567026248044, -0.07120457765006832,
        0.026614060999120573, 0.021265869417217576, -0.02672990044825306,
        0.01936325101879539, -0.007170587402703448, -0.004467853422730366,
        0.011085894536928839, -0.011167230244867588, 0.006595587090872335,
        -0.001476009487339573, -0.0007464940252971135, -0.00028742000565393184,
        0.002073053929363409, -0.001969696342001277, -0.00018483733686451746,
        0.002135176636501881, -0.0017824684957602709, -0.0004944965698503794,
        0.002236359543550641, -0.0015608934697112762, -0.0008017164887897116,
        0.002297766499578895,
      ],
      [
        0.00014956052959101652, 0.005630811359123073, 0.0312913397645391,
        -0.012068426498889562, -0.06676092592904519, 0.07977260084050988,
        -0.06916059876939741, 0.05675684850223888, -0.04686289728848124,
        0.03836495502852792, -0.029863726060510964, 0.02116954760508152,
        -0.013139484420772571, 0.006834594644999391, -0.002767283676321121,
        0.0006996612650017438, 5.106161151969402e-5, -0.00017361108337705464,
        0.00010958212415477382, -4.3553942689734e-5, 1.1751718488189442e-5,
        -1.8834474106257196e-6, 1.4148793374614969e-8, 8.132648101970835e-8,
        -2.1861795125832182e-8, 2.6554605683346287e-9, -8.146174401354164e-11,
        -6.170412331433692e-11, -2.236271208699793e-11, 1.7423792877816475e-11,
        4.1897504894609616e-11, 2.6164082427760564e-11, -1.4695149171359682e-11,
        -4.143988204232252e-11, -2.8390215225301212e-11, 1.1924729475400152e-11,
        4.079079385971333e-11, 3.04830083638754e-11, -9.09748272756358e-12,
        -3.99404887479679e-11, -3.242525968794867e-11, 6.2281261577268474e-12,
        3.890086819682454e-11, 3.421661596097769e-11, -3.3298840694476453e-12,
        -3.767810439428087e-11, -3.584269439240345e-11, 4.139111490612919e-13,
        3.6272052662458544e-11, 3.72948490790499e-11, 2.5044103056840548e-12,
        -3.4695530950246636e-11, -3.8574928144406455e-11,
        -5.409595015090785e-12, 3.295262789688671e-11, 3.966632668387341e-11,
        8.289722994964055e-12, -3.104721875681561e-11, -4.056673763612042e-11,
        -1.1126121608965673e-11, 2.899713159178327e-11, 4.127738787586475e-11,
        1.391384641384563e-11, -2.6813498624197653e-11, -4.1788220490727876e-11,
        -1.6634989007452877e-11, 2.4496773150827745e-11, 4.2101952404250614e-11,
        1.9271973427347887e-11, -2.206115833859742e-11, -4.2206274029704156e-11,
        -2.1825993917728136e-11, 1.9519795595248005e-11, 4.2122816430227315e-11,
        2.4270085846442264e-11, -1.689323423246384e-11, -4.18258935155387e-11,
        -2.659759204018415e-11, 1.4174167529833973e-11, 4.1335543740399416e-11,
        2.8795898346694573e-11, -1.1396095460628879e-11, -4.064579537733871e-11,
        -3.086311102067813e-11, 8.557817030128617e-12, 3.97641263318028e-11,
        3.277668770524229e-11, -5.679699646699664e-12, -3.868363031019048e-11,
        -3.453654725149066e-11, 2.7760690322692735e-12, 3.742782270027411e-11,
        3.6134495114595934e-11, 1.3711222382851334e-13, -3.5985809165623926e-11,
        -3.754992387788235e-11, -3.0552405013370673e-12, 3.437935943272078e-11,
        3.8795140470036204e-11, 5.954066769954008e-12, -3.260190049468277e-11,
        -3.9852137883036484e-11, -8.829717180962383e-12, 3.0671254186605196e-11,
        4.071622921634229e-11, 1.1655906800869072e-11, -2.859007296024893e-11,
        -4.1386354417855896e-11, -1.4434743810346036e-11,
        2.6381048354454655e-11, 4.1863162656432505e-11, 1.7141242181260557e-11,
        -2.4041900800676935e-11, -4.2130707098121814e-11,
        -1.9768523348759532e-11, 2.1584207237462235e-11, 4.22086932915872e-11,
        2.2293968901681327e-11, -1.9028460061982996e-11, -4.207730251137227e-11,
        -2.4717061441159977e-11, 1.637969496576087e-11, 4.174699073992111e-11,
        2.702334660992705e-11, -1.3654488797842843e-11, -4.122719792946482e-11,
        -2.919843820433659e-11, 1.0865841670296097e-11, -0.0001078768595684079,
        -0.004046802328053773, -0.022401626586271827, 0.008714695395617948,
        0.04760546443817444, -0.056814955284397305, 0.049173930653471164,
        -0.04028225432818584, 0.03320669010193193, -0.027155760200791617,
        0.021131761278479176, -0.014988811230955131, 0.009319322214706008,
        -0.004863715540016371, 0.0019822111082402655, -0.0005106250971862983,
        -2.8763058124393786e-5, 0.00012051219707467297, -7.726394560163e-5,
        3.0996342315596814e-5, -8.443675090365036e-6, 1.3757687110508056e-6,
        -1.799504434328725e-8, -5.722139759983452e-8, 1.5695830027787673e-8,
        -1.8826500636069245e-9, 8.769294891724049e-11, 2.46840158647461e-11,
        -3.039726809200299e-11, -4.119381831642526e-11,
      ],
    ];
    const result = wavedec(data, "db31");

    const reconstruction = waverec(result, "db31", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db31_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49477758544363987, 0.9129103701734811, 1.193802455100838,
      1.3051578559798533, 1.24856837600103, 1.0572070101359814,
      0.7863256121503914, 0.4990035470875639, 0.25072763218034905,
      0.0766237991815455, -0.015548878854920789, -0.045010921842770404,
      -0.05042946642183899, -0.07729403892743358, -0.1635393259927166,
      -0.3271931671905213, -0.5593143904801697, -0.8241464066794912,
      -1.0665833723612022, -1.225183721822266, -1.2475372231185118,
      -1.1041552038505913, -0.7973709794851043, -0.36293306114223595,
      0.13624717541092002, 0.62280932207637, 1.0211462026659106,
      1.273260115531504, 1.3505188509736168, 1.2585595691171956,
      1.0342646301258493, 0.7356678846458862, 0.4273637336167297,
      0.16506080069237627, -0.01691567735847105, -0.11215073971938352,
      -0.14120249700598783, -0.1435993040142918, -0.16495166023665425,
      -0.2425860030991313, -0.39347319325309477, -0.6076380713245483,
      -0.8488449715588349, -1.0625056884178594, -1.1889136882202767,
      -1.178533002290185, -1.0055078518137879, -0.6759529622421137,
      -0.22883985698027515, 0.2708984773472774, 0.7455108225999737,
      1.1207437016224033, 1.3414662598931768, 1.382900566871153,
      1.2548240521481322, 0.9978259776358921, 0.6726352512049688,
      0.34521346509473844, 0.0713105488040951, -0.11573566089436299,
      -0.21102795143864866, -0.23661352107852723, -0.23301246600997685,
      -0.24607438543300508, -0.31263437424141116, -0.44873035027981856,
      -0.643485334860352, -0.8603162139979093, -1.0452657427990342,
      -1.140434021752276, -1.0991656795728462, -0.8991614524710733,
      -0.550152419750018, -0.0940880111186353, 0.40237914382230594,
      0.861431405896981, 1.21047603319589, 1.3975008258708832,
      1.4017496500917797, 1.2372082293372395, 0.9481419715464561,
      0.5978606075140349, 0.253520790418256, -0.02928659013043583,
      -0.21841241044438214, -0.31065998024639396, -0.3297209170002624,
      -0.31723647859201615, -0.3194078376494171, -0.3726857562867998,
      -0.4922853241434109, -0.666542189959975, -0.858636284209449,
      -1.0153308077566128, -1.0805787162837777, -1.0105862728524866,
      -0.7865111338514907, -0.42151669044340545, 0.03972757919246667,
      0.5291563519342763, 0.9692063746154937, 1.2892406494014756,
      1.440598016357326, 1.4066866867097205, 1.2057405662737093,
      0.8856417202424106, 0.5121395463928198, 0.153390475142562,
      -0.13539204720754472, -0.32346122870013233, -0.40951015644202526,
      -0.4190311901297039, -0.3949122031775184, -0.38381003652368745,
      -0.4218857902971236, -0.523625894343873, -0.6766738610031513,
      -0.8440611667484359, -0.9733369560560705, -1.0103284729162265,
      -0.9140606832367297, -0.6690273577152778, -0.29162373972767563,
      0.1710282877133368, 0.6497594815079263, 1.0675750816482423,
      1.3560739716834656, 1.470156638682801, 1.3975115240338134,
      1.1606315523858575, 0.8109271363793487, 0.41641998602839975,
      0.046049328121513855, -0.24558323113547004, -0.4293566404110607,
      -0.5060467073597493, -0.5031009534377714, -0.4647725264755519,
      -0.43826704472414163, -0.45953603145728744, -0.5424137139926134,
      -0.6739263129020688, -0.8170228436905614, -0.9200801023823296,
      -0.9307971934898308, -0.8109525133934627, -0.548236179311336,
      -0.16206114958420062, 0.29827266395705976, 0.7627995423138921,
      1.155397603682136, 1.4101642160614025, 1.4857482414158167,
      1.3742061896892177, 1.102271217780137, 0.7247652224113281,
      0.3117897371703551, -0.06717013058691212, -0.35837269008820993,
      -0.5345531349809893, -0.5987637336779059, -0.5805567791029658,
      -0.5256598039488674, -0.4819068759561143, -0.4851034215263828,
      -0.5484887309359079, -0.6585253292049111, -0.7781230820049653,
      -0.8565048947832292, -0.8432166901859011, -0.7027045845945884,
      -0.42569877364619374, -0.03440499069932007, 0.419976831427681,
      0.8669875036705339, 1.231669797611276, 1.4508621872608636,
      1.4871229390070781, 1.336935368489742, 1.0312242373087717,
      0.6280781301995821, 0.19946217629305024, -0.1848474407546885,
      -0.4722281639997454, -0.6375061933974556, -0.6862018457926846,
      -0.650114108281227, -0.576541820964028, -0.5140114765901606,
      -0.49822751604036086, -0.5418711906584327, -0.6308731562045162,
      -0.7281249295042507, -0.7836916065077618, -0.748919817778215,
      -0.5908194017586504, -0.30299050406151684, 0.08980113855922706,
      0.5347341050434282, 0.9611512800219424, 1.2955365373860266,
      1.4776898965848995, 1.474212845687057, 1.2860444302845313,
      0.948222687257484, 0.521931128024596, 0.08076021727348132,
      -0.3054931727447493, -0.5855932570183098, -0.7366933157586273,
      -0.76696818154761, -0.7105949635162148, -0.6165260559051854,
      -0.5340266190393366, -0.49872536878440193, -0.5227611942264543,
      -0.5915427588023128, -0.6679420346447317, -0.7028412055396186,
      -0.6493222563236084, -0.4768388299393933, -0.18167981506010805,
      0.20906662426300793, 0.6412335639667954, 1.0442511441966504,
      1.346302953378674, 1.4903468875894832, 1.4471330722244284,
      1.2220550349507873, 0.8541565516732832, 0.40751863653183185,
      -0.04290120291791977, -0.42756884259151134, -0.6969084514545086,
      -0.8306347656313204, -0.8397555349349846, -0.7609442243936878,
      -0.6448720524260099, -0.5415695731815888, -0.4865940076562897,
      -0.49153581750922054, -0.5412697660840151, -0.59862593478481,
      -0.6152588036788573, -0.545903190251529, -0.3623232563094705,
      -0.06330723366368601, 0.32197362415434, 0.7382773301491116,
      1.115393361236594, 1.3834435232504623, 1.4887141844962088,
      1.4061802719751433, 1.145658373339554,
    ]);
    const expected = [
      [
        1.6592268382534752, -1.6913644722041659, -1.5336425574662773,
        -0.707808742213396, -0.4390468212116623, 2.1939966947455147,
        2.176353910073822, -1.2567460156533392, -2.0015487201013253,
        -0.4650995189376128, -0.7955849837591585, 2.2341195460562613,
        1.3487356131331705, 1.0136933325991684, 2.422533362949216,
        1.0496977141706454, 0.4131052598903658, -0.467100877929215,
        -2.6666817649226973, -0.9479831874052033, 2.302971403493962,
        1.4039042113127378, 0.2756470186430061, -0.24068896667774775,
        -2.2643626654032127, -1.6655645314385767, 2.0322442639911866,
        2.256260636979062, -1.1873284045087624, -1.7188264175150914,
        -0.7795165685964679, -0.7790292156193094, 1.7082294669523042,
        2.592220829090692, -0.5704867288779563, -2.1807408002365527,
        -0.5505099879791513, -1.1185535856287045, 1.8263344777278345,
        1.6435926361549429, 0.813153813803613, 2.3678828939934986,
        1.3581642969467649, 0.5197803026986395, -0.033994922560159686,
        -2.457585404298257, -1.6511019540382097, 1.890951647293001,
        1.7534635383938098, 0.3917221647781351, 0.12215001660673037,
        -1.991124127543619, -2.170790028179689, 1.4405154256608244,
        2.17288226793943, 0.40394854070364516, 0.10215269455797889,
        -1.4835608154562987, -2.4762927796294965, 0.8113848452132802,
        2.508076155228628, 0.5949778507795205, -0.03918928689720653,
        -1.030692356778535, -2.5419034313012134, 0.08468310095242276,
        2.673322976153992, 0.9605954585055513, -0.21951672671871186,
        -0.7095915771446394, -2.387033469609481, -0.6393091212229023,
        2.611758501708104, 1.4538756628228016, -0.34731893176117073,
        -0.5626997875660581, -2.0714660734922323, -1.2612847975075117,
        2.3078086789708836, 1.994496639636566, -0.3422932557231014,
        -0.5893625565262983, -1.6822081108936164, -1.7028281824008566,
        1.7910341660762132, 2.4852303040056287, -0.15332620690084284,
        -0.7466455037860241, -1.3144952339168927, -1.9226197039341781,
        1.1321940546226898, 2.828993204260202, 0.23448456380967808,
        -0.9641549212495575, -1.0506441742570507, -1.9116167318024977,
        0.3891040140130358, 3.0336971428235135, 0.6524818973510362,
        -0.9582770044665283, -1.16698510494164, -1.5540772246299668,
        -0.20744535117067658, 2.19758106879369, 2.7462428747843823,
        1.9938560448030718, 1.9329835877971762, 2.8235046980642933,
        2.857625511849814,
      ],
      [
        0.015092284389140707, -0.0075222030388720764, 0.012536760224668932,
        -0.003442788032077143, -0.022285766094393776, 0.030940303344481838,
        -0.03216566111010942, 0.03107237056563238, -0.028417722717324734,
        0.024110024412049267, -0.017671562337303406, 0.021451785056882746,
        0.01905911492460886, 0.060334375934136306, 0.07856404872734941,
        -0.059030917645888525, -0.25565559407539895, 0.1995221795444629,
        -0.03021370704076317, -0.0789893766797478, 0.11687618973507197,
        -0.10642768970611828, 0.07009656299342648, -0.027370895163144664,
        -0.006397250585911462, 0.023228292398904424, -0.024078629740733198,
        0.016277359811441745, -0.008033368563582456, 0.0036581400663970266,
        -0.0025485827438312763, 0.0019071568003166538, -0.00025416080679701534,
        -0.0014331310224534868, 0.001489533461666752, 0.00012016784087312633,
        -0.001580113371601492, 0.0012403922005017065, 0.0005098130248253025,
        -0.0016805467163156793, 0.0009410346555644005, 0.0008681294949879017,
        -0.0016905137200908522, 0.0005913347818808283, 0.0011799992629500926,
        -0.001610058516293644, 0.0002100060111419471, 0.0014287547115583454,
        -0.001443487192361876, -0.00018255486055629568, 0.001601091696892263,
        -0.001199708874245429, -0.0005653518719106929, 0.0016877916446187016,
        -0.0008917626144021307, -0.0009179099495111128, 0.0016842182000058694,
        -0.0005361190437046693, -0.0012213726426393641, 0.0015905615705241237,
        -0.00015180060478181225, -0.0014595082825441838, 0.0014118320403001831,
        0.0002406373212111987, -0.0016195803541252892, 0.0011575882694738972,
        0.0006202041764735716, -0.0016930269387886404, 0.0008414238105776007,
        0.0009665427510525386, -0.0016753721557290348, 0.0004978927302816527,
        0.0014441002501632593, -0.0005060552274089391, 0.004035914606388434,
        0.011622493006850438, 0.019361555010723112, 0.04443095820489804,
        0.11420597525601646, 0.14987038500263822, -0.13133952764025483,
        0.02401101854506513, 0.14851879048385636, -0.3514940933814153,
        0.4369151490068565, -0.700104415288402, 0.4388120162917357,
        -0.32560593864645904, 0.20590226511142284, -0.15459778716646685,
        0.11460916263801343, -0.08745069234181346, 0.06369591842109958,
        -0.04141843426344544, 0.022177260144849446, -0.008774808026362553,
        0.002412476658709154, -0.0012672473636701855, 0.0016918724317923387,
        -0.001003541007594761, -0.0007510958395178041, 0.0017191627018879544,
        -0.0007811996663284683, -0.0010262130534713372, 0.001662390945278144,
        -0.0004081871534983031, -0.0013100457860654162, 0.0015391743170125596,
        -1.876065768506386e-5,
      ],
      [
        0.00014473465619952081, 0.00544572215555239, 0.030242542887482828,
        -0.011681385924314463, -0.06447916586576691, 0.07703006291168574,
        -0.06676343691323487, 0.054772552402921344, -0.04521186377004828,
        0.03700636164780561, -0.028804640218661144, 0.020420997427106402,
        -0.012678736322126315, 0.006598799035728573, -0.0026748746304572166,
        0.0006785253434428632, 4.752161608857806e-5, -0.00016691311223386942,
        0.00010563539703757189, -4.2052356673155735e-5, 1.136518124597547e-5,
        -1.8266835853307853e-6, 1.5483100500240836e-8, 7.835356108918666e-8,
        -2.11482774438518e-8, 2.570758569798246e-9, -6.740081300330586e-11,
        -4.5037045856273434e-11, -1.9208178990955316e-11, 4.189859539933838e-12,
        2.5046399760682703e-11, 2.2543597187186135e-11, -1.0100239803767102e-12,
        -2.3621961591289407e-11, -2.41728435222907e-11, -2.150621275999802e-12,
        2.188012194647747e-11, 2.5479910431126195e-11, 5.284702331906474e-12,
        -1.9844578530785478e-11, -2.6441042410935953e-11,
        -8.344749780856235e-12, 1.7543334286364688e-11, 2.7050708310367738e-11,
        1.129674191149208e-11, -1.5007053533132348e-11, -2.7296252800062327e-11,
        -1.4096151298556581e-11, 1.2269176276628664e-11, 2.7174988729408412e-11,
        1.670279172169869e-11, -9.365727129058452e-12, -2.6689848655233105e-11,
        -1.908993079922527e-11, 6.337459251700902e-12, 2.5848326293580623e-11,
        2.1215397540752912e-11, -3.2253062814006606e-12,
        -2.4656102550336798e-11, -2.3062348386251467e-11, 6.795265498221872e-14,
        2.3136267698635105e-11, 2.4597571549530452e-11, 3.0883736421984026e-12,
        -2.1302825730689383e-11, -2.5801237726445127e-11,
        -6.2052393787705004e-12, 1.9185948023620922e-11, 2.6658678961207325e-11,
        9.236792417956309e-12, -1.681020076993874e-11, -2.7160723882459668e-11,
        -1.2143286539033062e-11, 1.421058270186085e-11, 2.7295552280089223e-11,
        1.4889579298438166e-11, -1.1420099522918306e-11,
        -2.7066785827341007e-11, -1.7434521073627483e-11, 8.479829853530323e-12,
        2.647698556419624e-11, 1.9752083757291073e-11, -5.418819902816463e-12,
        -2.5530851507851115e-11, -2.1798798441779147e-11,
        2.2886244908462777e-12, 2.424028432284599e-11, 2.35544276862226e-11,
        8.737802262187164e-13, -2.262467378825861e-11, -2.499410946210575e-11,
        -4.024605396597968e-12, 2.0703248664966075e-11, 2.6090358430029416e-11,
        7.115502327588648e-12, -1.850833035802453e-11, -2.6846065313317217e-11,
        -1.0115114336485942e-11, 1.6059121650122193e-11, 2.7238447015450092e-11,
        1.2981290279193118e-11, -1.3397170877130815e-11,
        -2.7267019711469174e-11, -1.56726578294971e-11, 1.0558454555945039e-11,
        2.6932799038676824e-11, 1.8155364049935127e-11, -7.576361587844811e-12,
        -2.6234540204622214e-11, -2.038899587491584e-11, 4.491855616877957e-12,
        2.5181046410830964e-11, 2.2352745798423773e-11, -1.3480865412083615e-12,
        -2.379240512417151e-11, -2.4015911161398285e-11,
        -1.8140935780277444e-12, 2.208159991982529e-11, 2.5353125283725234e-11,
        4.951686705173427e-12, -2.0072944769041595e-11, -2.6355671612496178e-11,
        -8.01824321009969e-12, 1.7800189182233458e-11, 2.7000712236581023e-11,
        1.0983984847969747e-11, -1.528690533022545e-11, -6.5195067304880965e-6,
        -0.0009276832156776454, -0.013035098032450525, -0.022548465621424863,
        0.05357389597454567, -0.014577803009603848, -0.013858656181878615,
        0.024403943629019747, -0.02386789368061175, 0.017920372640471048,
        -0.010319938317900807, 0.0035911982849316636, 0.0008567388701917146,
        -0.0027754031401158144, 0.002819468550188624, -0.001984026310100725,
        0.0010674670666392173, -0.00044149298753238283, 0.00013234223887477624,
        -2.2217565076159663e-5, -2.4579384373762997e-6, 3.1649312828924087e-6,
        -1.1512686420095593e-6, 2.399699037778462e-7, -2.5094963844878104e-8,
        -8.413779071518774e-10, 6.303949526087143e-10, -9.965204197837116e-11,
        -1.5344456131833654e-11, 1.0016678276947206e-11, 2.6778414742368388e-11,
      ],
    ];
    const result = wavedec(data, "db31");

    const reconstruction = waverec(result, "db31", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db32", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48823237648779705, 0.9002613241244779, 1.176224346674211,
      1.2849980639890255, 1.2296936951071626, 1.0450084971838913,
      0.7872144517542081, 0.5193842990179294, 0.29561393432283184,
      0.1482096958318469, 0.08101904610873595, 0.07049527396358896,
      0.07410365917212539, 0.04379986659632884, -0.05898431841605051,
      -0.2507998878587559, -0.5194166541748721, -0.8246992409315528,
      -1.107037052789977, -1.3013069145748173, -1.3529147647144644,
      -1.2318967608298776, -0.9415056053262136, -0.5190552436045457,
      -0.02870941035155255, 0.4521027130992743, 0.8493786430228587,
      1.1083087058536027, 1.2043194466575786, 1.1467807367473557,
      0.9745942915015067, 0.7449004597523119, 0.5178399841006998,
      0.3412617288468421, 0.23923809830631337, 0.2072470197358775,
      0.21515828675175913, 0.21715894144462686, 0.16597418923525525,
      0.02763696387133524, -0.20709000204510408, -0.5176926096452206,
      -0.8567142322006557, -1.1598314001983885, -1.3607725050983566,
      -1.4073991438295739, -1.2749357278915079, -0.9730082012363495,
      -0.5446696594091618, -0.057569732636167825, 0.4106304431729122,
      0.7890729583767708, 1.0286789233927378, 1.1116876682992585,
      1.0535284523777884, 0.8967121242939671, 0.69841754918818,
      0.5150046937156783, 0.3874226257827735, 0.33121312056377306,
      0.3336090583680421, 0.358396762113256, 0.35721656266097235,
      0.2843212088078476, 0.11091617084923722, -0.1647034335481623,
      -0.5139495875430675, -0.8826483964368586, -1.2026238518617927,
      -1.4073657848238503, -1.4479263698070712, -1.3050923445059328,
      -0.9947757095503709, -0.5652310174564296, -0.08672547773950659,
      0.3638469918759276, 0.7196726109162264, 0.9379988022736597,
      1.0080409854915025, 0.9509978692190573, 0.8123364796085597,
      0.6484359122292005, 0.511071313545008, 0.43372777232211124,
      0.42323178570714676, 0.45880475490704237, 0.4987297422139255,
      0.4928641998945483, 0.39772351509996035, 0.1901850761363163,
      -0.12380805619218344, -0.5079127751642494, -0.9019300972797062,
      -1.2347385726868123, -1.4404946017521427, -1.4741226963498497,
      -1.3222597716815907, -1.0069210484169047, -0.5809455971919251,
      -0.11630847741750536, 0.3118548367464717, 0.6416182831715087,
      0.8370610554851845, 0.8944367844296288, 0.8403376522131351,
      0.7224858761858459, 0.595626104447272, 0.5062007394703889,
      0.4797631281216596, 0.5143542198773277, 0.5815228852883811,
      0.6347006214511749, 0.6227467615873743, 0.5051404811377427,
      0.26485071531818993, -0.0845214067910467, -0.4993015135878308,
      -0.9140367203598905, -1.2556016479041587, -1.4597071674131614,
      -1.485769199970799, -1.3264722876257367, -1.0096586358846933,
      -0.5920638419319906, -0.14643185016204674, 0.2548303543281161,
      0.5554609383958194, 0.7267798911494063, 0.7720398116859777,
      0.722770226614103, 0.6282098528142983, 0.5406498721277408,
      0.5005188019422464, 0.5250734529562682, 0.6036141253818449,
      0.7004563647537331, 0.7648936246559745, 0.745581164409189,
      0.6056186088108838, 0.3343996909874396, -0.04691256492026746,
      -0.4878360624906746, -0.9185039573706137, -1.2647500911117717,
      -1.4646982962941981, -1.482803702599408, -1.31790267834718,
      -1.003298404113508, -0.5988732014710851, -0.17718432806325574,
      0.1930256234110707, 0.46185829802457445, 0.6081820661048406,
      0.6421091485526993, 0.5995771772164065, 0.5305758726159049,
      0.4841514782910402, 0.4941140553990401, 0.5691672205279029,
      0.6900299263099202, 0.8143173829081934, 0.8879498698849779,
      0.8601701682670847, 0.6983006273924612, 0.39840124529548426,
      -0.011004912952265078, -0.47324462437282694, -0.9149345995994765,
      -1.261839658683366, -1.4553139642298756, -1.4653208611221507,
      -1.296858019108001, -0.9882387553819387, -0.6016906679443417,
      -0.20862505588945263, 0.12676912648332, 0.36156987455645073,
      0.48239650347981056, 0.5059840861110547, 0.4720841093921924,
      0.43065631743438976, 0.4267496444299171, 0.48703646720206367,
      0.6115224008705795, 0.7726164488795313, 0.9218525299481404,
      1.0025828197892694, 0.96541510754716, 0.7824332503748759,
      0.45650908884984154, 0.023220291225096917, -0.4552705056445982,
      -0.9030066998871074, -1.2466513506798478, -1.4315541196447596,
      -1.4335704286557045, -1.2637739198047362, -0.9649585795948525,
      -0.6008551362338812, -0.24077896597271875, 0.05646530676345324,
      0.2554505966017713, 0.35064258883509064, 0.3650690718620697,
      0.3416451624043131, 0.32951573959084024, 0.36903021345913684,
      0.47929702501529603, 0.6515930388205354, 0.8503969887798005,
      1.0218577245458609, 1.1075929326812783, 1.0603273713809966,
      0.8573735148046246, 0.5084619928943206, 0.05581960911871167,
      -0.4336792881849614, -0.8824809684454764, -1.219096494107031,
      -1.3935737031674393, -1.3879537151299144, -1.2192073262234178,
      -0.9340084638212681, -0.5967197208209999, -0.27363282316482757,
      -0.017407045192529502, 0.144443082443021, 0.21421727713234676,
      0.22081791025871111, 0.20962736825373363, 0.22819853213522057,
      0.31153962644656025, 0.47086826575417046, 0.6888165420020208,
      0.9224156097379159, 1.1131927544615552, 1.2018813339919197,
      1.1440385022635853, 0.9225936468706311, 0.5540831694642021,
      0.08688247585197684, -0.40826588311352785, -0.8532072764782042,
      -1.1792203216311798, -1.3416818534257717, -1.3290182971238003,
      -1.1638279866000496, -0.896001233246982, -0.5896441595571691,
      -0.3071320232543621, -0.09429758408311739, 0.029568637517366048,
      0.07448115885450257, 0.0747174086506915, 0.07739504958565185,
    ]);
    const expected = [
      [
        2.282544696653397, -1.0911082604010902, -2.463463267304497,
        -0.5155945304310342, -0.12271371924736105, 1.1595905165422082,
        2.582973425211978, 0.07115442845332126, -2.6430479008153975,
        -0.7068587938992745, -0.7608379899578839, 0.9786176722117892,
        2.2739226983907983, 0.5984142087838153, 2.041313907851126,
        1.7953702356329735, 0.6171878295385517, 0.5066785084295716,
        -1.8534799824168726, -2.5159352280791047, 0.7913278223740534,
        1.9886598570921135, 0.7340504232909204, 1.0744975607409153,
        -1.319967010451109, -2.6359737321165095, -0.446135984130483,
        1.8661999433550747, 2.6031070564279353, -0.6919403210624271,
        -2.4912319506885705, -0.6906391186957253, -0.26630532459312284,
        0.9514207203972229, 2.624462234906453, 0.5110660395737312,
        -2.58515986070389, -0.8171481170864012, -0.9296513711614768,
        0.7707554892047551, 2.271024431429628, 0.6362646163082366,
        1.9413009054603578, 1.8911274452160614, 0.7199317592608317,
        0.6868964919262329, -1.576896537433108, -2.73538891254811,
        0.4757459022036643, 1.899370312097399, 0.9117334175089435,
        1.0701122152604432, -0.7923419056693138, -2.9764044157164737,
        -0.4952659961621067, 1.7252809498846535, 1.040177707334145,
        1.3138257954652408, 0.06098353329776855, -2.847541290041709,
        -1.4244228352818467, 1.3329645035387383, 1.0885303306678773,
        1.4043884622041443, 0.8771018031680965, -2.3673122732718053,
        -2.1936276038974882, 0.757669594565308, 1.0446544507399045,
        1.346219593525121, 1.5587287812472397, -1.5984500950846403,
        -2.7027767791293815, 0.06017313401542519, 0.902332529463527,
        1.1591376660163344, 2.0290555320851174, -0.6395427146085721,
        -2.8830598005350896, -0.6794887321059357, 0.6636206996639238,
        0.8741577764446499, 2.240428469884668, 0.38787631404769024,
        -2.7064278316196204, -1.3712784723653382, 0.34068541978419575,
        0.5285171719075258, 2.1789394049533124, 1.3550773888845156,
        -2.1899830646636897, -1.9260919290259302, -0.043995474920941524,
        0.1620856385665499, 1.8617852672867758, 2.147404656221582,
        -1.4018296148195797, -2.2576532695788636, -0.46930192008037314,
        -0.17670429647013405, 1.3254841279580818, 2.6862403678666396,
        -0.4731949095413901, -2.221645395445911, -1.1357501758330102,
        0.08979037537092871, -0.024398890898701845, -0.09096923607850432,
        0.0027581065674402165, 0.5664488581955456, -1.2860587171653806,
      ],
      [
        -0.017648451039846868, 0.011592438084706409, 0.03332295101263288,
        0.0069097428816277525, -0.1104007817111453, 0.1153070417647141,
        -0.09271749164644079, 0.07686514726121399, -0.07129308165966135,
        0.0690081687783053, -0.06421844769151937, 0.04384305405412516,
        -0.054036881614807464, -0.03362345037289406, -0.09954072091499075,
        -0.09860593396488503, 0.1221556557457618, 0.19230696239828932,
        -0.2872813209577335, 0.23494416528826037, -0.16827752762984943,
        0.12939932497104384, -0.11522622335292125, 0.11025800919388572,
        -0.10094952612959517, 0.0818120518624015, -0.05591158986953726,
        0.0308875101651058, -0.013264131336466738, 0.004675670357993868,
        -0.0021039561057602995, 0.0012306028593703192, 0.0001804943684334129,
        -0.0015484855424251172, 0.0014430927353552708, 0.00013260373635945162,
        -0.001511757395119171, 0.0011948887474615222, 0.0004548173246753959,
        -0.0015976019751094066, 0.0009601237997492153, 0.0007472139666304486,
        -0.0016219542678405036, 0.0006893968662680678, 0.0010113359776203884,
        -0.0015851657830607386, 0.0003926903115372285, 0.0012373488036112983,
        -0.0014886452768574318, 8.118652168186968e-5, 0.0014167361020895205,
        -0.0013360298191262918, -0.00023337658676797891, 0.0015427380561388755,
        -0.0011330703020076265, -0.0005391455827914727, 0.0016106068509678106,
        -0.0008874145347477634, -0.000824598602423596, 0.0016177848902119666,
        -0.0006083193928926746, -0.0010789791885024622, 0.001564001860527753,
        -0.0003063015723247754, -0.0012927018328926694, 0.0014512842480063559,
        7.258185155149517e-6, -0.001457713069355006, 0.0012838795672936653,
        0.0003205419926628002, -0.0015678468944909818, 0.0010675780586611786,
        0.0006193408382053721, -0.0016188718243136501, 0.0008748199258316781,
        0.00128384740485773, -0.00029731558887475265, 0.0036278573724995876,
        0.006470929379547102, 0.002018991785442127, -0.008249339309886992,
        -0.022663905816221946, -0.06048220034956015, 0.10858886346032541,
        0.010861503313798449, -0.07911518614818437, 0.09163125853385799,
        -0.09676039251041899, 0.07836689146567727, -0.061657599789038675,
        0.04444372878555483, -0.02853105681352265, 0.014205241091255422,
        -0.0029606876512702335, -0.0033504294961358887, 0.004367696406213259,
        -0.0020771621045053553, -0.0003048990543298441, 0.0006492654689670665,
        0.0006668725973269103, -0.001628995931425118, 0.0008920543021262977,
        0.0008193060029822656, -0.0016195257529818526, 0.0006176360843096214,
        0.001071584521380415, -0.0015665915193368747, 0.0003159727817184136,
        0.0012867246235992945, -0.001455660743401631, 2.595329462379749e-6,
      ],
      [
        0.00010429894842323238, 0.0042755632082062825, 0.02723501666462181,
        -0.0009519561424248359, -0.07074939230854786, 0.07124842229378064,
        -0.05347806789464104, 0.03940367714735715, -0.031557264280967806,
        0.027259411088438684, -0.023678272960950444, 0.019305422206223062,
        -0.014100077098093331, 0.008926992341385954, -0.004740640021380059,
        0.002003942611268025, -0.0005909296657189278, 5.1523480892511557e-5,
        6.666922941187297e-5, -5.050512272696285e-5, 2.108902629751944e-5,
        -5.861223093803817e-6, 1.0011999074266859e-6, -4.0589000746695436e-8,
        -2.986090378476584e-8, 8.805602343815349e-9, -1.1136815375103787e-9,
        2.3469139317298707e-11, 1.3105889412340002e-11, 1.4968463661863106e-11,
        1.0158105592908363e-11, -4.7738741140459045e-12,
        -1.5206804126534576e-11, -1.1278113114563218e-11,
        3.3008396169174483e-12, 1.4763509645362523e-11, 1.2283370014943527e-11,
        -1.798349821382308e-12, -1.4182857300915176e-11,
        -1.3169877023585095e-11, 2.7566413623822996e-13, 1.3462461044237858e-11,
        1.3937300818177698e-11, 1.2432498455008034e-12, -1.2619207276087257e-11,
        -1.4566917769518856e-11, -2.758427821718829e-12, 1.1655762260385283e-11,
        1.5063818762244176e-11, 4.2439374163257046e-12, -1.0584920810347636e-11,
        -1.5414333853429757e-11, -5.690634907820596e-12, 9.408667888038417e-12,
        1.5624724991488357e-11, 7.07932885643014e-12, -8.146649557280384e-12,
        -1.5680326492138322e-11, -8.40566984168926e-12, 6.8089938292057686e-12,
        1.5592403882099414e-11, 9.649509288309938e-12, -5.409826480678434e-12,
        -1.5356145657897755e-11, -1.0803169171345001e-11, 3.952493441013257e-12,
        1.4979052689143082e-11, 1.1855118003829755e-11, -2.4578153249472227e-12,
        -1.4453589534616142e-11, -1.279673951844652e-11, 9.45906079243853e-13,
        1.3790674938823335e-11, 1.361489224221407e-11, 5.807247376410164e-13,
        -1.3006761501419634e-11, -1.430799827685388e-11, -2.097055304825569e-12,
        1.2090690497944679e-11, 1.4863917456943505e-11, 3.592042690621142e-12,
        -1.106726304840607e-11, -1.5279383441116377e-11, -5.055135143246344e-12,
        9.93689684322557e-12, 1.5550038720000164e-11, 6.477299186773911e-12,
        -8.715334810758179e-12, -1.5672939435593594e-11, -7.831112290215913e-12,
        7.40525014493078e-12, 1.5648429732200413e-11, 9.114306317013243e-12,
        -6.026461253239575e-12, -1.5479009586204493e-11,
        -1.0310218104505266e-11, 4.596091785269382e-12, 1.5158089331903963e-11,
        1.1407835011309208e-11, -3.1185245528838482e-12,
        -1.4700747490726662e-11, -1.2398793082854373e-11,
        1.6133507767484623e-12, 1.4102411516129757e-11, 1.3267391279905269e-11,
        -8.984113286095679e-14, -1.3367975374491638e-11,
        -1.4019746467677975e-11, -1.4288560750866128e-12,
        1.2509652130500498e-11, 1.4632830780581542e-11, 2.9404235043545297e-12,
        -1.1532251588095169e-11, -1.5115473624892436e-11,
        -4.418346793903708e-12, 1.0446270979035764e-11, 1.5445219177984076e-11,
        5.863176059994018e-12, -9.259424179319364e-12, -1.5636932092640474e-11,
        -7.245875748497162e-12, 7.991651554911118e-12, 1.5675824465295186e-11,
        8.561548760766802e-12, -6.6381969070998176e-12, -1.5572158457996637e-11,
        -9.794857342637131e-12, 5.230231349078157e-12, -1.0320919793643485e-5,
        -0.00038846081904480076, -0.002243098053162661, 0.0003248598517626095,
        0.005224513562439908, -0.005047513987066432, 0.0035687948668971154,
        -0.0024309115984118782, 0.0017808275764488657, -0.0014292022501183092,
        0.0011963451048597525, -0.0009794105235067727, 0.0007465621749204442,
        -0.0005119193293641387, 0.0003066056783001588, -0.00015487158313904354,
        6.221682131345498e-5, -1.7131678911313404e-5, 1.0429468224678983e-6,
        2.030504417937897e-6, -1.3591421277250448e-6, 5.050783129544863e-7,
        -1.1903690640738048e-7, 1.4462065968219231e-8, 9.24295415843148e-10,
        -7.22776025565828e-10, 1.1148255550734967e-10, -2.1362714220563646e-11,
        -3.288498777382697e-12, 1.1747913913908059e-11, 1.5053434518838768e-11,
      ],
    ];
    const result = wavedec(data, "db32");

    const reconstruction = waverec(result, "db32", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db32_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5068440985554328, 0.9347588346941006, 1.221032763240831,
      1.3316084110809998, 1.2668755019409068, 1.0595749508214372,
      0.7654773062826725, 0.4492344175632174, 0.16893688531842677,
      -0.03683438843476472, -0.1563552613438587, -0.20484110818192933,
      -0.21744781087028, -0.23715908924789858, -0.30080892446609386,
      -0.4269449595919426, -0.6087593691750572, -0.8140183345588459,
      -0.9921340576274896, -1.0866912469948227, -1.0503220381157947,
      -0.8581758080914921, -0.5165186204846051, -0.06415390039591715,
      0.4339019209897694, 0.899157064021017, 1.2558789862662112,
      1.447030899601803, 1.4461613994669402, 1.2624599036997664,
      0.937831959598192, 0.5367663610375331, 0.13148905513428893,
      -0.21399577771436984, -0.45715896868184536, -0.5843945456609001,
      -0.611037977670074, -0.5741912046113777, -0.520376718808887,
      -0.49130938553273884, -0.5115089803214203, -0.5809731846141922,
      -0.6748182148502118, -0.7500021086493889, -0.7574231446074587,
      -0.6562897938355707, -0.42703984661982614, -0.07940240350590733,
      0.3466279886387028, 0.7873901823358174, 1.168329939250151,
      1.4199960972250518, 1.4934704836289343, 1.3715328631509682,
      1.0728607460316717, 0.6482273073920042, 0.16958093244694367,
      -0.2854047354484562, -0.6496496404149229, -0.8800185118236623,
      -0.9646285250226341, -0.9225443107872492, -0.7961697402255271,
      -0.6384308876849464, -0.49809507396896135, -0.40697967446999056,
      -0.37227387943053103, -0.375862861199253, -0.38074241722766505,
      -0.3427946420114278, -0.22481665118810998, -0.009100328290643056,
      0.29479860781585093, 0.6492722663248193, 0.9952755671154369,
      1.2648985131712762, 1.3969258388297598, 1.3516163372936671,
      1.121064486043971, 0.732537618240773, 0.243861835077628,
      -0.2681531579308493, -0.7235776744122621, -1.0558078371096304,
      -1.224756596567947, -1.223756850142116, -1.0786826391430764,
      -0.8396884601555201, -0.5677484585631534, -0.3194082074123761,
      -0.133540776151712, -0.02333646388506444, 0.0246039014543247,
      0.04401714811092118, 0.07732884835470882, 0.16173297844949436,
      0.3166976727341173, 0.5362315762366293, 0.7880381374261465,
      1.0199352410122748, 1.1720619652997373, 1.1918971472492172,
      1.0483516839249492, 0.7413620099075255, 0.3044695237560222,
      -0.20043820195248047, -0.6951398210063271, -1.1011061190556144,
      -1.3558063744753885, -1.4254778805242911, -1.3113877449701494,
      -1.0481853893052526, -0.6948502829386369, -0.32051350391314315,
      0.011361890139170439, 0.2566125713415427, 0.3985886082801543,
      0.44910842321693817, 0.44214632742742527, 0.4220616396143736,
      0.4295298475460671, 0.488886373305708, 0.6002072081876579,
      0.7382264073888846, 0.8584354420186782, 0.9088633284705884,
      0.8445619172282343, 0.6410882342263888, 0.30347146415448406,
      -0.13176868703180472, -0.602287693141929, -1.0321042697931797,
      -1.347522634885634, -1.4930491442410185, -1.443524533532041,
      -1.2095793281991811, -0.8351154715983905, -0.38743041735197664,
      0.05763914614143928, 0.43200036938536635, 0.6891562688161474,
      0.8124086312849743, 0.815616176315847, 0.7365630899130963,
      0.6248126269444536, 0.5272584688506159, 0.47511314266369176,
      0.4756606057197258, 0.5108553441883865, 0.5430863535719732,
      0.5265835009620929, 0.4214872723990188, 0.2068962057109623,
      -0.11057196968289507, -0.4950720344343032, -0.8873403788968632,
      -1.2168018926307933, -1.4171575269887329, -1.4417234157982732,
      -1.2747956967878005, -0.9362370767136473, -0.478097612828541,
      0.026003200453087183, 0.4962637260942863, 0.8632460962537117,
      1.0817094863391556, 1.1385426541033763, 1.0530642342351821,
      0.8698284514521267, 0.6458936882102739, 0.4358330838066788,
      0.27826586788057694, 0.187245871964681, 0.15057400937326798,
      0.13532410503173165, 0.09903154390676619, 0.0035518800356568736,
      -0.17208766869176512, -0.4232757030356418, -0.718160826797756,
      -1.0033645292349682, -1.2158027417521946, -1.297785327654677,
      -1.2116870027960953, -0.9505241459939942, -0.5417241758449456,
      -0.043005967506107676, 0.4687995803745589, 0.9134409164052206,
      1.2237983424634011, 1.3594323110380526, 1.3139892685613994,
      1.1148164579536843, 0.8150221953578941, 0.4800344309945301,
      0.17201144073594649, -0.06407391589158318, -0.20933210957562728,
      -0.27279186435088326, -0.2859217556260584, -0.2914303600363555,
      -0.3293673848411066, -0.42421138429865135, -0.576361409243793,
      -0.7603184767063605, -0.9301315920970219, -1.0308204342581637,
      -1.0129391671898746, -0.8466017974525714, -0.5313631097911905,
      -0.09932653186170778, 0.3895075095826784, 0.8587367583487828,
      1.2312875657024234, 1.4457096509951395, 1.4691956540759803,
      1.3042553355946214, 0.9874938662785651, 0.5808403535238059,
      0.15738048954832062, -0.21477782797371853, -0.4867465893602253,
      -0.637864869381421, -0.6774607968912694, -0.6391728849995979,
      -0.5694813375812967, -0.5135190923939341, -0.5018737830840585,
      -0.541798772244894, -0.6151000158770061, -0.6832455552220639,
      -0.6983871902032381, -0.6174548391898079, -0.415667057818614,
      -0.09590280908868443, 0.30862225714281905, 0.7392826278590617,
      1.123588654466875, 1.390702237857346, 1.4872504853372641,
      1.3896405730682884, 1.109887137320471, 0.693508301675891,
      0.20994932183576612, -0.26221363993190056, -0.6517935447056623,
      -0.909351489747658, -1.016069578397394, -0.9851801167177044,
      -0.8558293394254549, -0.681103090786809, -0.5133478077368399,
      -0.39053702081623287, -0.32711225249944814,
    ]);
    const expected = [
      [
        2.902287599842945, 0.6836212007784909, -1.0639707296208447,
        -0.9610426298847394, -1.7076667901034033, 0.275920230340699,
        2.881266368558242, 0.9798381639178283, -1.956642163280626,
        -0.8082199364903797, -1.3173422160576034, 0.7115063920397745,
        2.3009087114316435, 0.60778271484716, 2.1310956086756234,
        1.8743329403047366, 0.2533839053874616, -0.07865198548965438,
        -1.9263400852391943, -1.840546940275359, 1.7084217094698013,
        2.467304005080966, -0.38557619134633386, -0.45508756601033457,
        -1.778111598004298, -1.1673787740969628, 1.2340052434206081,
        2.2430887597945666, 3.281373372280597, 1.0222628420068198,
        -0.9260993106095112, -0.8923309227060093, -1.801892640088356,
        -0.07613387508727822, 2.774311387132813, 1.3823150570406446,
        -1.8234537589652713, -0.8159673688199143, -1.469000800579018,
        0.458117103682603, 2.274234116690883, 0.6409791087720106,
        2.0232117025342222, 2.0022740392984026, 0.4160869914656632,
        0.07694964370986641, -1.7308684089959183, -2.1722458682984387,
        1.4404765890153521, 2.4709229718942587, 0.051251504874033904,
        -0.6170998802462275, -1.3274956535363787, -1.8589911290571095,
        1.2903693115854178, 2.8173555637816956, -0.11235238429489902,
        -1.370432458663035, -1.0215785817620233, -1.299050694295925,
        1.0732004315606944, 2.9152258587203312, -0.09917849716982677,
        -2.0655109550057955, -0.8759958911862935, -0.5580640335464399,
        0.891748437122137, 2.728542480334266, 0.022288776886234225,
        -2.5908160581357125, -0.9052631311635336, 0.25998141781456974,
        0.832411002699178, 2.275794350262726, 0.15613237763806845,
        -2.865170104986872, -1.0727328356567796, 1.0348103001366713,
        0.9439974032368119, 1.626392693890982, 0.20307714748182043,
        -2.8553106204442673, -1.2999064716140485, 1.6556333435672548,
        1.22546130512451, 0.885668479229362, 0.0853532699485072,
        -2.5826979040789846, -1.4856918186546855, 2.0447697991583653,
        1.6253649855346055, 0.17202556817773557, -0.2338057062167774,
        -2.1173357836472606, -1.5322222847451121, 2.1752443558936054,
        2.0514473072675248, -0.4069137087262134, -0.7414194515892368,
        -1.5603945194866076, -1.370399096429178, 2.0808498103247777,
        2.370750074907854, -0.7118122842943867, -1.5551812112755503,
        -0.6108155999245332, -1.3678900229199311, -2.0899911124374397,
        -1.0018044316953163, -0.7471757058654568, -2.334612668174406,
      ],
      [
        -0.01854012949219418, 0.018843793866214095, 0.0761971992696999,
        0.00530102147373377, -0.2220338667808425, 0.22817719830167707,
        -0.1777820129888144, 0.13948330696280828, -0.1208757558159421,
        0.11114916933207832, -0.10057352302485606, 0.07344515149312007,
        -0.07717040675083979, -0.020850606293576934, -0.1110589928613361,
        -0.09900238158201383, 0.12611764128741879, 0.19883720498622312,
        -0.29719666877128104, 0.24318928639953738, -0.17408484734573504,
        0.13335313214366437, -0.11803200250145648, 0.11244444736289524,
        -0.10281860804289861, 0.08348179713687649, -0.05739419127238415,
        0.032132389921974536, -0.014163614658658417, 0.00511228707572962,
        -0.002075356048354397, 0.0009477881784824289, 0.000373858789035056,
        -0.0014305354686984693, 0.0011163536411161088, 0.0003291775110704307,
        -0.0013471205483379899, 0.0008130541395259306, 0.0006519010436789654,
        -0.0013715176760837851, 0.0005232229491361757, 0.0009231986181464386,
        -0.0013142975056382644, 0.00020300038046320348, 0.0011403502972950259,
        -0.0011801468713914596, -0.00012910344462878376, 0.0012907731403133057,
        -0.0009769373422179957, -0.00045365211950624255, 0.0013656641285587593,
        -0.0007165619296196853, -0.0007516551307934049, 0.001360641956566445,
        -0.000414254967088535, -0.001005673667291771, 0.0012759993291673005,
        -8.770823390375464e-5, -0.0012008440892373913, 0.0011166905229511778,
        0.00024397177564621593, -0.001325745281172374, 0.0008920363022191841,
        0.0005613745596323577, -0.001373068769552996, 0.0006151841303883707,
        0.0008459285867990122, -0.0013400452252065476, 0.000302332724889011,
        0.0010809797846194399, -0.0012286209043804635, -2.8266457189168407e-5,
        0.0012529740867575495, -0.0010415967235481937, -0.000335462597975336,
        0.0014285302115217325, -0.0006028439553690273, -0.0002644445260291222,
        0.001797221925477009, -0.00319441697797541, -0.008359672060871645,
        0.020735237067697605, -0.0011453227080904587, -0.01820777660027128,
        0.006944081861779989, -0.0028087698274687754, 0.015885643691306035,
        -0.023744242330309966, 0.02388377604000632, -0.022299865565740897,
        0.019400414098026116, -0.015436483729320077, 0.010216333984455218,
        -0.0043749590483585414, -0.000594165667375103, 0.003075628527512674,
        -0.0026050282341578143, 0.0005182854687299292, 0.0009674013146691524,
        -0.0006344630123847061, -0.0007359151578957284, 0.0013612978899631247,
        -0.00044651083416340437, -0.0009808965049828806, 0.00128953666388123,
        -0.000124973178904557, -0.0011822720433504815, 0.0011380259934061895,
        0.00020711597437789175, -0.0013154998559405222, 0.0009201125008099448,
      ],
      [
        0.00010827280845068907, 0.004438179846928446, 0.028267909756112975,
        -0.0009924796633201155, -0.0734215102144586, 0.07393556449403327,
        -0.055490514558539164, 0.04088186814017671, -0.03273678520920857,
        0.02827521008625705, -0.02455930882306146, 0.020023952510580496,
        -0.014625944285967057, 0.009261223818907602, -0.004919219023465342,
        0.0020801632451596993, -0.000613844173652298, 5.3808994306770766e-5,
        6.906464534554906e-5, -5.2389069755717495e-5, 2.1887539615544674e-5,
        -6.085653878285825e-6, 1.0400448111304111e-6, -4.229466239547348e-8,
        -3.098604250200408e-8, 9.145279673341335e-9, -1.1524734945645432e-9,
        2.5411136612482294e-11, 1.0576788174364348e-11, 1.1363795219232523e-11,
        9.323771657334712e-12, -1.9391982923073914e-12, -1.1407723571030893e-11,
        -1.0258018885116249e-11, 4.4076919969840294e-13, 1.0729713081993038e-11,
        1.1032042160938518e-11, 1.0647110352761484e-12, -9.891618659252351e-12,
        -1.1642601429691369e-11, -2.554121301639e-12, 8.912472555528126e-12,
        1.2082088335751669e-11, 4.005293406954088e-12, -7.797160128951629e-12,
        -1.234516733592271e-11, -5.396139089570998e-12, 6.571642481312131e-12,
        1.2425353185882572e-11, 6.711751363906615e-12, -5.249823814229079e-12,
        -1.2323763493502035e-11, -7.927449385657045e-12, 3.8443244237937195e-12,
        1.2040889163584399e-11, 9.027626274142869e-12, -2.3901208054842115e-12,
        -1.1583859968549867e-11, -9.994862091032916e-12, 8.982559983606701e-13,
        1.095050519553751e-11, 1.0813973325655993e-11, 6.05503491117223e-13,
        -1.0164266346407696e-11, -1.1476159764802399e-11, -2.10273874606628e-12,
        9.222932405887829e-12, 1.1970069705818577e-11, 3.574283143629668e-12,
        -8.1476407081797e-12, -1.2285066882366155e-11, -4.985778142925352e-12,
        6.954108139304687e-12, 1.2425379200773381e-11, 6.3201277112463645e-12,
        -5.657541232354655e-12, -1.2375047433509892e-11, -7.567231921095365e-12,
        4.279510547013917e-12, 1.2142017437568543e-11, 8.70380473878853e-12,
        -2.8386420498137152e-12, -1.174131573579343e-11, -9.714310900356505e-12,
        1.3511585673357312e-12, 1.1162953535448281e-11, 1.0583062740202491e-11,
        1.553959007235386e-13, -1.0418389258252014e-11, -1.1291457576560833e-11,
        -1.6500777302227011e-12, 9.523994543312731e-12, 1.1839793705512614e-11,
        3.1300266521827723e-12, -8.485472312138838e-12, -1.2205863417633011e-11,
        -4.557835150169392e-12, 7.32805750562111e-12, 1.2395647083220573e-11,
        5.924440510559352e-12, -6.064265537304907e-12, -1.2409683513407033e-11,
        -7.204956685037982e-12, 4.7015278384707046e-12, 1.2235121058895136e-11,
        8.376634605470327e-12, -3.281390190695255e-12, -1.1881519962603763e-11,
        -9.425722064673309e-12, 1.8098329133416393e-12, 1.1353035739518135e-11,
        1.0336649427158365e-11, -3.0686097620518486e-13,
        -1.0660233175166876e-11, -1.1090551554067508e-11,
        -1.1964737781106791e-12, 9.810194406103548e-12, 1.1689945852750156e-11,
        2.6833877800833907e-12, -8.820918030498178e-12, -1.2116416761749977e-11,
        -4.1324795341476405e-12, 7.689976354825356e-12, 1.236100723421384e-11,
        5.520826434522234e-12, -6.4525176602015526e-12, -1.2420485338004826e-11,
        1.8072181298711798e-7, 2.0935652052828204e-5, 0.0002209778795578127,
        0.00019199846234898695, -0.0005484875574320087, 0.00014140864733914313,
        -0.00010154253720506396, 0.0002010305056060763, -0.0002620767685218546,
        0.00023297097795104026, -0.00012859106154724894, -1.5687240960659954e-6,
        0.00010227724893297719, -0.00014181176520599795, 0.00012472215714239642,
        -7.998762941405029e-5, 3.7241911179431804e-5, -1.092826139102808e-5,
        2.943978330443443e-7, 1.7360720361022659e-6, -1.0843784100059392e-6,
        3.7094772938819905e-7, -7.096889476567055e-8, 1.7005488473629018e-9,
        3.2005405997844123e-9, -9.237044545830519e-10, 8.985404722968596e-11,
        -1.8367907197962378e-12, 6.720543663448473e-12, 1.2353885526708037e-11,
        4.95075880419224e-12, -6.9829273601276154e-12,
      ],
    ];
    const result = wavedec(data, "db32");

    const reconstruction = waverec(result, "db32", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db33", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5009375347804873, 0.925670108511624, 1.2132954148091124,
      1.3300294392494827, 1.2748776644791449, 1.0779636519819684,
      0.7920540843746688, 0.47941658301094947, 0.19722030704229748,
      -0.015016709789109906, -0.14298241413726503, -0.19843844771161262,
      -0.2133726409956891, -0.22906349634890927, -0.2829300665720752,
      -0.39657478368581467, -0.5681196152843595, -0.770863136871733,
      -0.9587099765581003, -1.0771297118532828, -1.077004052688707,
      -0.9279619910590684, -0.627870673492751, -0.20603248345543834,
      0.2808743071953501, 0.7593406172281272, 1.1537251843738574,
      1.4017626642737098, 1.4673204246679918, 1.347475720949742,
      1.072315677376779, 0.6975721932468767, 0.29188195549532686,
      -0.0782944420247208, -0.3625480349070376, -0.5359850754236314,
      -0.6021779250136879, -0.5891040055102792, -0.5392809341488695,
      -0.4967048436794668, -0.49395077070355536, -0.5427182557276586,
      -0.6302228486092311, -0.722362255304283, -0.7728850133008559,
      -0.7362762029530387, -0.5811196893575896, -0.30053500172934783,
      0.08303847505675482, 0.5200878801172548, 0.9429830152339688,
      1.2796848220827994, 1.4690716468836715, 1.4743181620543118,
      1.2911848414896414, 0.949253419862459, 0.5057943312138788,
      0.033679812711712276, -0.39385349399234165, -0.7180692248748044,
      -0.9058226746461975, -0.9544109621013811, -0.8892294485680905,
      -0.7550125035020665, -0.6029640322716456, -0.4770389580404688,
      -0.40279226284947134, -0.3815331038799425, -0.3911764986641556,
      -0.39350425997660926, -0.3459416654444539, -0.21481944741369252,
      0.013299392760278028, 0.32519505350728345, 0.681247726309197,
      1.0225199551499902, 1.2831245787778658, 1.4050149227139992,
      1.3516951358004978, 1.11755281191384, 0.7305178251044597,
      0.24731198301836232, -0.25770060903751785, -0.7075421512460891,
      -1.038096065955071, -1.2105005138437739, -1.217677127526092,
      -1.0836150769241748, -0.8557543341111156, -0.5924404814547557,
      -0.3485649999823916, -0.1628867045618721, -0.05006340627754258,
      0.0007747910700959815, 0.020713707163272754, 0.050479791696297516,
      0.12737749966197032, 0.2731289275632633, 0.48578151672287095,
      0.7378432407292065, 0.9812610500490367, 1.1581539827292064,
      1.2147635582914498, 1.1152457811412355, 0.8519085660084862,
      0.44930475964738675, -0.0389674029452548, -0.5401736872992109,
      -0.9768772204653338, -1.282621465520831, -1.4152778875796193,
      -1.3650165588699323, -1.1551248050663796, -0.8355850364859716,
      -0.4710228098235778, -0.1259417809852343, 0.149238779786596,
      0.3280769119860731, 0.41169662085282793, 0.42540005242851936,
      0.4093425519112268, 0.4057543456491286, 0.4460193110023763,
      0.5409307166972849, 0.6766354132689211, 0.8173503514298918,
      0.9142379384445767, 0.9182749197374496, 0.7939234506965565,
      0.5301655498586227, 0.1460568958843133, -0.31074810641075556,
      -0.7723627446460837, -1.164121169994564, -1.4200678899373358,
      -1.4969120579425765, -1.3832067740135379, -1.1016206045047294,
      -0.7037860031897359, -0.25894921848570684, 0.1609089460381426,
      0.4960086287623891, 0.7103186316887956, 0.797123597071528,
      0.7774831061800733, 0.6921781462968484, 0.5893035015917205,
      0.5106900891009374, 0.48058263080271296, 0.49939978359087667,
      0.5441145611668672, 0.5751290848258823, 0.5478867978559729,
      0.42626653645333007, 0.19433034692923845, -0.1366319582315711,
      -0.5276917936938991, -0.9188244537353591, -1.241022322890348,
      -1.4312133582761994, -1.4464956419889141, -1.2743116950219653,
      -0.9361122875730489, -0.4835782953813113, 0.011783233913593427,
      0.4732958656180908, 0.8346584140444726, 1.0528228163450997,
      1.1153076298396762, 1.0403931670680937, 0.8703492367380278,
      0.6595009326867404, 0.4601433094444451, 0.3097831524013899,
      0.22280589957948815, 0.18853433628416888, 0.17604131646379118,
      0.14439418227308637, 0.0556553832655855, -0.11272742332645863,
      -0.35936862349876275, -0.6565184261062447, -0.95454471683426,
      -1.1923939208371208, -1.311605361308304, -1.2705373266485749,
      -1.05535288813915, -0.6850402686919244, -0.20913421106220198,
      0.3014721654424946, 0.7685954862143216, 1.122518710828054,
      1.3158409449324848, 1.3322772009636679, 1.1884636829971142,
      0.9284810926319151, 0.6125245446909291, 0.30251143671208214,
      0.04810166248618403, -0.12355351193143682, -0.21197439681977265,
      -0.24058805824404886, -0.24790767948165846, -0.2750141252870552,
      -0.35259686260626455, -0.4909054615329531, -0.6752299998874681,
      -0.8681483806770111, -1.0180882117142749, -1.0721637042661654,
      -0.9901526846896467, -0.7561449116862862, -0.38490541302275927,
      0.0787650853992723, 0.5677235273543909, 1.0055887832789199,
      1.3223027487050891, 1.4685835131530391, 1.4259446117966086,
      1.2099868721609994, 0.8662482907889283, 0.4596436520334214,
      0.060020011790079875, -0.27276133637039734, -0.5007416047876557,
      -0.6140732855098198, -0.6302256991552021, -0.5866027370032457,
      -0.5285825894328555, -0.49608106414331815, -0.5120659659261355,
      -0.5759331951766761, -0.6634240630986784, -0.7331199141622368,
      -0.7378968672791995, -0.6384651841887098, -0.4155633528276341,
      -0.07766425451200826, 0.33788714511698614, 0.770803896079024,
      1.149636342551827, 1.4067440758571905, 1.4929961202345314,
      1.3887551365970452, 1.1085481160801134, 0.698297750350391,
      0.2257328078388654, -0.2338061847185587, -0.6128812878402377,
      -0.8652236885129396, -0.9737526909908458, -0.9516274458712435,
      -0.8362928569547954, -0.6781564473120012, -0.5267980322715055,
    ]);
    const expected = [
      [
        1.0318436834150306, 1.9827918105055486, 1.971607411035316,
        1.0489916523041087, -0.14771735052430188, -0.9191221026745826,
        -1.0332213669414398, -0.807149882161986, -0.702428571926157,
        -0.8342565511878981, -0.8611508706341988, -0.35686797072094406,
        0.690698146643768, 1.738821223995001, 2.0711364025726775,
        1.3829558515210163, 0.06512628436392966, -1.1034715948637106,
        -1.5102156493715462, -1.2231554808467162, -0.6582513018616817,
        -0.4129293958176037, -0.2958437800127048, -0.22000945740120792,
        0.5394321051343117, 1.2258480480066714, 2.0410117396626783,
        1.4294758532070193, 0.15111331852567345, 0.5185376385306788,
        1.5303555550895966, 1.8507407102101168, 1.3228693402392495,
        0.48089152485697434, -0.09177169826100275, -0.25160291610927815,
        -0.3217163436579717, -0.6685481422012268, -1.2496608100125204,
        -1.5771095760282374, -1.1504614834383657, 0.03176837507322013,
        1.36337499959417, 2.053017920137699, 1.728901459165572,
        0.70682052343136, -0.3031195851454339, -0.782446329118125,
        -0.7660196146983772, -0.6804962114944738, -0.8424086208895563,
        -1.104183595825737, -0.9885736822772621, -0.18906157847059904,
        1.037603454105162, 1.9754501986517754, 1.9908871433525603,
        1.0490172347848479, -0.24884292509229786, -1.1421890910133585,
        -1.2878978768123468, -0.9431875701357496, -0.6240060604465555,
        -0.5795212562487448, -0.5766270197727172, -0.1875752122068096,
        0.7019640786774056, 1.6597470036084734, 1.9965734510831479,
        1.343557943283738, 0.005191382769068458, -1.238061517643874,
        -1.7198481755775545, -1.3665198183166736, -0.663676776262428,
        -0.16881384322376505, -0.026334275391083482, 0.07963565531200041,
        0.514875495616011, 1.2346628795127708, 1.727681866670322,
        1.441989360615793, 0.3160291926734014, -1.076722134250701,
        -1.9256014044414038, -1.7950250251236601, -0.9282630309644947,
        0.008351899690994908, 0.4983964297651023, 0.5530118284254746,
        0.5748126412638963, 0.8666674666844506, 1.2670124597389936,
        1.2682938944183035, 0.5185715507715261, -0.7613807542899143,
        -1.8519354031364976, -2.0671877283026108, -1.295026224469271,
        -0.07612955742176146, 0.8436931311613781, 1.0924413150243943,
        0.8824949834442685, 0.6963466285022356, 0.7669800919022088,
        0.8482141108647971, 0.48897668806735434, -0.4520661056794173,
        -1.5488021040097013, -2.077103665210498, -1.5986826307925968,
        -0.3484559587096497, 0.9241170635270068, 1.5304472978562513,
        1.3404293721767837, 0.7847189177104079, 0.3915960031726565,
        0.2997364852716711, 0.19230860514131443, -0.30421238369980574,
        -1.15008464425512, -1.8149348378152377, -1.6947123528958505,
        -0.6614198378469158, 0.7549289843266292, 1.7358419789073267,
        1.7899834967688204, 1.0899665621164225, 0.2540478351615797,
        -0.21163418172182105, -0.30376524579152536, -0.409017957054247,
        -0.8223336865393425, -1.3707129373598688, -1.514765322179472,
        -0.85095400412124, 0.44590666897885356, 1.663541887345176,
        2.0718355963118125, 1.4834638896652292, 0.37371377291324803,
        -0.5357274000349833, -0.8545023330811692, -0.7582086830550278,
        -0.7014352619888035, -0.8992163161375952, -1.0945759534666066,
        -0.796430677118551, 0.15482554534472026, 1.3778315699274148,
        2.077716809305934, 1.81162244071549, 0.6512929650204711,
        -0.569999196512014, -1.3249781075605214, -1.220430070969699,
        -0.7891818693406886, -0.8926478149694119, -1.3066830486681078,
        -1.3577737712077191,
      ],
      [
        7.804000375753044e-5, 0.003470636180640691, 0.025065101202714317,
        0.008110930028102217, -0.07504279277050874, 0.061838430514217196,
        -0.03577758776544463, 0.019188842076849556, -0.012578448547887732,
        0.011809573579002343, -0.012949095044202021, 0.013392071254053332,
        -0.012096369507117025, 0.009342838118963172, -0.006102359108031604,
        0.0033145849565994786, -0.0014461441794058852, 0.00046469187518088614,
        -7.653494515681042e-5, -2.2142345190088454e-5, 2.383675462032859e-5,
        -1.0654326040995688e-5, 3.058616767568796e-6, -5.497007006541382e-7,
        3.5083036986080416e-8, 1.1285029678483071e-8, -3.7609538044614366e-9,
        4.867881707662972e-10, -1.296062575452414e-11, 6.262780827147131e-13,
        -2.1062074286287653e-13, -3.683415575614523e-12,
        -3.5944948241589374e-12, -2.256219164163158e-13, 3.3454944599159648e-12,
        3.87177298701732e-12, 8.70905914017797e-13, -2.923485619691574e-12,
        -4.053139206901431e-12, -1.4938215655711775e-12, 2.4273411008992385e-12,
        4.137169215945025e-12, 2.08046519760511e-12, -1.8714051687591465e-12,
        -4.117960617604831e-12, -2.6121575538979136e-12, 1.2702680541855982e-12,
        3.999685947665257e-12, 3.085131540830501e-12, -6.396996159391881e-13,
        -3.779695670893999e-12, -3.478432990762564e-12, -9.01267603890733e-15,
        3.4685374530276622e-12, 3.790963389030505e-12, 6.548010044680606e-13,
        -3.0699720823020214e-12, -4.002508109007824e-12,
        -1.2914812225142063e-12, 2.602163980128149e-12, 4.11946617828508e-12,
        1.886918990759663e-12, -2.062607407355561e-12, -4.139000326937309e-12,
        -2.4416990030368408e-12, 1.4761130182098914e-12, 4.0515416626828555e-12,
        2.9353591169674967e-12, -8.536054494609677e-13, -3.863890163786016e-12,
        -3.3537517748533327e-12, 2.0703460464108548e-13, 3.584839363477668e-12,
        3.698508093672087e-12, 4.4135281305182887e-13, -3.2165300495841485e-12,
        -3.941609413763178e-12, -1.0822898204994035e-12, 2.768559954997722e-12,
        4.09094169451128e-12, 1.6903440856366866e-12, -2.2530551378831415e-12,
        -4.141727864457416e-12, -2.262767410914444e-12, 1.6782523491871773e-12,
        4.088130219891401e-12, 2.7740988150233078e-12, -1.0625495459953772e-12,
        -3.94215484944935e-12, -3.224428213708903e-12, 4.2474624617912077e-13,
        3.691018269484058e-12, 3.592420388022882e-12, 2.2561239659022193e-13,
        -3.346236053296715e-12, -3.871321788508323e-12, -8.67180364568632e-13,
        2.927560157643682e-12, 4.053996710640971e-12, 1.490812592091419e-12,
        -2.427562907460674e-12, -4.137209251241019e-12, -2.073125014039005e-12,
        1.8727296088862483e-12, 4.120465067272213e-12, 2.612540215508954e-12,
        -1.2730448747525686e-12, -3.999966731968933e-12, -3.084150242561212e-12,
        6.395665772876521e-13, 3.782187267945592e-12, 3.4804281759325796e-12,
        3.8836666246168314e-15, -3.471668313275612e-12, -3.7900130841815344e-12,
        -6.530982892762399e-13, 3.0734472512943224e-12, 4.004988942718012e-12,
        1.286554283727838e-12, -2.6021636463401717e-12, -4.121274561586815e-12,
        -1.887621699832996e-12, 2.0640054192060207e-12, 4.138427875531255e-12,
        2.4404884382184824e-12, -1.4760917595658018e-12, -4.049082192825693e-12,
        -2.9366044200179986e-12, -1.690023443972932e-5, -0.0007495384389506757,
        -0.005397801114898849, -0.0017265834239065332, 0.01611489724908894,
        -0.013265600169198278, 0.007663755167293227, -0.004099809993095276,
        0.002676604456246658, -0.0025058286528017466, 0.0027463016572467735,
        -0.0028419319026722592, 0.002569644063944902, -0.0019875491695771582,
        0.001300707754729509, -0.0007084142606212903, 0.0003103424108978632,
        -0.0001004745184502081, 1.70009851705706e-5, 4.490168317114228e-6,
        -5.0397005101746605e-6, 2.2763470337823624e-6, -6.586465799929672e-7,
        1.1958339178741875e-7, -7.951095857476635e-9, -2.372628082702506e-9,
        8.122217607824849e-10, -1.0231533825970741e-10, 3.459811667460772e-12,
        -3.0761419115641034e-12, -3.69360903055264e-12, -3.4172722432484484e-13,
      ],
    ];
    const result = wavedec(data, "db33");

    const reconstruction = waverec(result, "db33", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db33_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5133843887419953, 0.9440726050691974, 1.2270204043246125,
      1.3282131786712792, 1.2505748501378073, 1.0310964187859588,
      0.7300777102746117, 0.4153398228965051, 0.14548831942454288,
      -0.04352082772787419, -0.145178082646527, -0.18101167019918724,
      -0.19156132198120496, -0.2223109391735661, -0.3084640261084812,
      -0.46273494538362814, -0.6695263339887991, -0.8871767916269968,
      -1.0578300091459971, -1.1224495112233988, -1.0371082582727535,
      -0.7862834174400479, -0.38959145612639995, 0.09996912179411249,
      0.6060562619105885, 1.044985776913856, 1.343847082815413,
      1.456324417680385, 1.372369843222313, 1.1194046393600943,
      0.7548414111243982, 0.3518809223575655, -0.01780534325584271,
      -0.30016437206273605, -0.4696570025811715, -0.5323779850549673,
      -0.5208509021107928, -0.4821027158296208, -0.46234515767908096,
      -0.4924380234198018, -0.5780664787971874, -0.6972962621053954,
      -0.8062073840541555, -0.851158228534973, -0.784455563761754,
      -0.5792638714905869, -0.2397266870882835, 0.1965383745814535,
      0.6644731809443892, 1.0848563637316528, 1.3816631621670765,
      1.499264668280102, 1.4152161760326338, 1.1454574400530926,
      0.7406295496925239, 0.2744250094811783, -0.1731339443093762,
      -0.5333523407986159, -0.7631285402634744, -0.8524100417906446,
      -0.823187584095864, -0.720549139054838, -0.5983350734835726,
      -0.5032843614758291, -0.4618954088121312, -0.47346198377527104,
      -0.5110859018722832, -0.5303452160207811, -0.483260824985024,
      -0.33378402688417724, -0.07059207335995915, 0.28635655590219605,
      0.6874595235819779, 1.0631355627656016, 1.3392581278636713,
      1.4545694115313457, 1.3757177336249513, 1.106104117865254,
      0.686243560639515, 0.1854576012634333, -0.31312031063709145,
      -0.7305784355690139, -1.0089072731808408, -1.1223024262935337,
      -1.0804481735195335, -0.9231829110551395, -0.7081264104068874,
      -0.49460613162964356, -0.32810763049468594, -0.22926880337454753,
      -0.1901972770093018, -0.17893889531561188, -0.1507697264070361,
      -0.06318291385938407, 0.10953845845746563, 0.36617630420402997,
      0.6757275007220653, 0.982813348469005, 1.2201452782126148,
      1.3249714871382126, 1.2553383278290875, 1.001976041943115,
      0.5926723168773039, 0.08786338630226048, -0.4316240731996985,
      -0.8817687499607922, -1.1933294694738348, -1.3262430116164008,
      -1.2769924064397329, -1.0772659548488326, -0.784416202101123,
      -0.46627409816786497, -0.1842551091594622, 0.02093900462626247,
      0.13745571726377862, 0.18234338227637564, 0.19372512240385992,
      0.21735934217645925, 0.2913088087907247, 0.4329213174040409,
      0.6317062226112924, 0.8501334531855856, 1.0322885947466889,
      1.118231487473416, 1.0603677787768921, 0.8375536846879029,
      0.4631705851406559, -0.015099894490588628, -0.5239779909022054,
      -0.9797881708170291, -1.3065194530701996, -1.45235299222768,
      -1.400628253878715, -1.1726008091646285, -0.8213944195567151,
      -0.41874512720827745, -0.03791618009396064, 0.2629228678339859,
      0.4527416426735193, 0.5322350801055522, 0.5300194586006779,
      0.49168191614257084, 0.46476215582259384, 0.48376930379836486,
      0.559288502433976, 0.6741261228929675, 0.7875677280178921,
      0.8466659043230689, 0.8015956272110323, 0.6210014402910875,
      0.30320463767363387, -0.11984147814947127, -0.5871232977784001,
      -1.0207569715518579, -1.3429186906150186, -1.4933887458823574,
      -1.4433790321373885, -1.2022099585379349, -0.8151730990943821,
      -0.35311016247925797, 0.10370192667311873, 0.48337015153674906,
      0.7375337231743857, 0.85019103250428, 0.8381998513673667,
      0.7435868568783109, 0.619889638140344, 0.5162518096515463,
      0.4635173752586416, 0.4659927616490693, 0.5010171794166065,
      0.5264021534518527, 0.49370923897900737, 0.3637739727858985,
      0.12025974069073753, -0.2224985614570808, -0.6196446518075147,
      -1.0041651109329097, -1.3015492373034407, -1.4471634274813063,
      -1.402003415189113, -1.1628375974753715, -0.7641250037957583,
      -0.271135146934215, 0.23410622315111695, 0.670631608606443,
      0.9757659496870474, 1.1176117406969275, 1.099840739613894,
      0.95780994537181, 0.7472158144794133, 0.5283690809518038,
      0.35023630351831203, 0.23838443793409986, 0.18988895874373524,
      0.17640622690995778, 0.1544501965199077, 0.08001220786020713,
      -0.0764870137530933, -0.3190239392951735, -0.6217116173192629,
      -0.9327844999830971, -1.185999765191303, -1.3166634051228425,
      -1.2782341438244926, -1.0552381918465787, -0.6691047597858766,
      -0.17528590965027177, 0.3477913032212536, 0.8153348562229209,
      1.1543495442418006, 1.3189473357406263, 1.2991229608645352,
      1.1209597538217602, 0.8383861527721557, 0.5187149893045199,
      0.22572725824117368, 0.00462122048168323, -0.12740202724451677,
      -0.1826575034413784, -0.19642192403858727, -0.2142393129923646,
      -0.2766160380556584, -0.40530375036370525, -0.594938993630832,
      -0.8123917985949012, -1.0041394556702012, -1.1098533459548439,
      -1.0787181917051372, -0.8842285733056299, -0.5335314635983524,
      -0.06872752228628287, 0.4404333222556494, 0.9108417185693166,
      1.2638968479506558, 1.4426146859041908, 1.4238048365925848,
      1.2223662816124712, 0.8867196014641754, 0.4866041100079651,
      0.09635941440118251, -0.2220987800368377, -0.4323844183632324,
      -0.5296647325222147, -0.5382969863267311, -0.5019500496387697,
      -0.4690155453040537, -0.477305785542353, -0.5421823963736181,
      -0.6513253920734763, -0.7675815031550081, -0.8391827856799304,
      -0.8146593421574047, -0.6584944553684973,
    ]);
    const expected = [
      [
        0.04834271716384709, 1.3505625182347305, 2.0963177491692813,
        1.77024915517486, 0.6165490913610672, -0.5760245054808203,
        -1.140759808539191, -1.0362922233622, -0.7420127310247929,
        -0.6877607442411771, -0.7980045009395995, -0.601224513887341,
        0.21112831975779878, 1.3446100814335167, 2.0451694782996444,
        1.7264167273373616, 0.5146019437270417, -0.837701763604871,
        -1.5173407142497801, -1.3744740003364107, -0.7701131652400688,
        -0.42192595247520376, -0.26717393735707884, -0.24807757102157596,
        0.4565339960684731, 1.1463372806042853, 2.030833071190488,
        1.4481620044871695, 0.15214627469256417, 0.5359205606117387,
        1.5563187420015963, 1.8300762742457932, 1.2411256521439769,
        0.397932102242067, -0.10811051887490061, -0.2170587595842517,
        -0.33539752080935237, -0.7978008058367633, -1.4160537443446302,
        -1.5863374382284015, -0.8728660501993756, 0.4945294205114554,
        1.7102185361906272, 2.021330571875502, 1.3323528031164946,
        0.2384134683115905, -0.5279186017851316, -0.7095513494111344,
        -0.6341321846090384, -0.7542356680896817, -1.1025399197445849,
        -1.217740681010489, -0.6247629193532929, 0.6033010211743315,
        1.77244080172429, 2.0953288453401195, 1.3518710421639786,
        0.07495136984626552, -0.9098882237738564, -1.16293549668094,
        -0.9073629680586609, -0.6802395409447803, -0.7319522705125531,
        -0.7760931866860147, -0.3331435712334222, 0.682366969685979,
        1.7324358301703335, 2.047012231199056, 1.2959068277327352,
        -0.08554954996251307, -1.2327726843420779, -1.550282035878553,
        -1.1385174587282993, -0.5804202691715642, -0.326744406942331,
        -0.28709453168994736, -0.013123231340265268, 0.7300826061783793,
        1.5945472996728391, 1.8786696793046673, 1.1649417688406196,
        -0.23681989412549717, -1.4791987670818691, -1.8484569013969212,
        -1.3128324682888097, -0.46004462608662, 0.08908793195934028,
        0.22062310519280987, 0.3179396148814091, 0.746128215196434,
        1.3687123497010678, 1.5997318319366352, 0.9638586946236177,
        -0.3734024994677298, -1.6366031760885933, -2.03952397587059,
        -1.4183079412858315, -0.3247615099679729, 0.491449413692116,
        0.7171960900583181, 0.641388342874109, 0.7313734029175136,
        1.0697547279657595, 1.2262373518919953, 0.7018256231231227,
        -0.4907641832434353, -1.6978623814961966, -2.111840564099034,
        -1.4465320024422694, -0.1803537754602659, 0.8575609121521146,
        1.1733121086913454, 0.938331155943488, 0.6877123728884089,
        0.7164040340723977, 0.779898370569181, 0.3919139073619327,
        -0.5853485945985207, -1.6615850624472246, -2.0607775774302626,
        -1.3933204733607718, -0.03252828333501368, 1.167264144532094,
        1.561966511515016, 1.190760582512387, 0.6178869993082761,
        0.33010637877008664, 0.2868202967130625, 0.050463562289290255,
        -0.654580315480433, -1.532057562664521, -1.889019235402993,
        -1.259123676862289, 0.11325139409407534, 1.4041394668425362,
        1.8600853458725308, 1.382662086853995, 0.5253133417076168,
        -0.06630257879730113, -0.22402633219549112, -0.30383839261575174,
        -0.6966740821451003, -1.3191855008991529, -1.605839761821236,
        -1.0500183749267904, 0.2528761942525197, 1.5556243263221388,
        2.0498172911225496, 1.5027162249153647, 0.4101439672534727,
        -0.44431863453054343, -0.7279939903242365, -0.6520311235615479,
        -0.6865446243273464, -1.1242140612432279, -1.0089469168644736,
        -1.0309090939819863, -1.177549379471361, -0.9769460371802324,
        -0.7105802060348421,
      ],
      [
        8.001671819343382e-5, 0.003561907020074441, 0.02575014522494662,
        0.008367542230901548, -0.07717313457438273, 0.06361761749440734,
        -0.03682656528718369, 0.01977019908752045, -0.012979404813160357,
        0.01219962115118415, -0.013379624597597983, 0.013834340182180915,
        -0.012490764602259128, 0.009641949749158548, -0.0062928374959660745,
        0.003414373277808431, -0.0014873031096489936, 0.000476531280446005,
        -7.766417282068503e-5, -2.3240719622940137e-5, 2.4647629612240842e-5,
        -1.097427689780357e-5, 3.141458933805199e-6, -5.625246770344524e-7,
        3.53686277705518e-8, 1.1679938737036621e-8, -3.8648632310849615e-9,
        5.03967307680337e-10, -6.949205853005097e-12, 1.2118251364460595e-12,
        -5.955245348362152e-12, -1.0283116732250236e-11, -4.500812700062305e-12,
        5.618439363430504e-12, 1.0329123211890267e-11, 5.101844834002844e-12,
        -5.0345696337092334e-12, -1.0325374737353999e-11,
        -5.679619652335979e-12, 4.431557249709825e-12, 1.0280570708099955e-11,
        6.232871737832719e-12, -3.811893497007998e-12, -1.0187804535091974e-11,
        -6.759728567682531e-12, 3.1730012018378933e-12, 1.0053726524887887e-11,
        7.2586786232092775e-12, -2.523817002778991e-12, -9.873625712914966e-12,
        -7.723556510177283e-12, 1.860181645454636e-12, 9.655500176919649e-12,
        8.1574621817695e-12, -1.1908241883556133e-12, -9.39510933877781e-12,
        -8.556079314595642e-12, 5.151642813193515e-13, 9.090923145713519e-12,
        8.918377690772764e-12, 1.6308416677764405e-13, -8.749431043255769e-12,
        -9.240314055895488e-12, -8.397266782037396e-13, 8.369344573511676e-12,
        9.524784848954986e-12, 1.5104963273329553e-12, -7.95228950262419e-12,
        -9.764787444729234e-12, -2.18236808613259e-12, 7.507915942032327e-12,
        9.967005502790404e-12, 2.8316646083373225e-12, -7.021508630194981e-12,
        -1.0122471247749017e-11, -3.4830574770485977e-12, 6.510774006632592e-12,
        1.024006173808271e-11, 4.111092479865839e-12, -5.977033813175952e-12,
        -1.0306741491063742e-11, -4.722490204731291e-12, 5.402920190128691e-12,
        1.0337104484379199e-11, 5.317412750590162e-12, -4.816350422289976e-12,
        -1.0319762186771144e-11, -5.884977216726409e-12, 4.207473460755542e-12,
        1.025338908897706e-11, 6.431071692696417e-12, -3.5765971976075064e-12,
        -1.0147635042522347e-11, -6.946523877214121e-12, 2.9388997279522983e-12,
        1.0000783723001658e-11, 7.432965791115174e-12, -2.280054885659128e-12,
        -9.797313484988263e-12, -7.892541547071167e-12, 1.6158223765015081e-12,
        9.560827323253423e-12, 8.309939533248373e-12, -9.399717831439895e-13,
        -9.281638933662658e-12, -8.698021139406472e-12, 2.6657985085131403e-13,
        8.965657606017907e-12, 9.042758885389468e-12, 4.093553940330345e-13,
        -8.61302621724402e-12, -9.35449191367226e-12, -1.0864852570809587e-12,
        8.2178584694288e-12, 9.617841598072843e-12, 1.760178945632559e-12,
        -7.794398901582916e-12, -9.842868116256076e-12, -2.4230846184701107e-12,
        7.32754642397386e-12, 1.00236497374613e-11, 3.083755319004442e-12,
        -6.83976243089562e-12, -1.0168375423790698e-11, -3.7207794789363e-12,
        6.3120470840748574e-12, 1.0274074902144447e-11, 2.416411773786441e-6,
        0.0003951401879337302, 0.006721557079600414, 0.018228633709544265,
        -0.026396161818453664, -0.013251337800772813, 0.03303466611177457,
        -0.036919804094691394, 0.033975741048226794, -0.028485187367190554,
        0.02204237048258474, -0.015467307652461524, 0.009510514358988092,
        -0.004831318591153599, 0.0017556584768280681, -0.00016376419745610875,
        -0.0003839114916557249, 0.0003943140841238379, -0.00024130340256888538,
        0.00010729053241115088, -3.507886458002837e-5, 7.615874545946635e-6,
        -5.273308963374464e-7, -3.478534749811953e-7, 1.6573734973335418e-7,
        -3.813865188877171e-8, 4.626137946870214e-9, -7.151332706970954e-11,
        -7.111165485270087e-11, 1.6505850613303312e-11, 9.728991795106992e-12,
        2.619033101873414e-12, -7.161841037851768e-12,
      ],
    ];
    const result = wavedec(data, "db33");

    const reconstruction = waverec(result, "db33", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db34", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49239364608158154, 0.9114634680241309, 1.198415963018704,
      1.3202546727216817, 1.2752834440627665, 1.0916929398420514,
      0.8196877371172888, 0.5191050888847886, 0.24550068860717666,
      0.03799105094649513, -0.0883250203421393, -0.14367752621933255,
      -0.1585088220485997, -0.1733257528876952, -0.22612860661818246,
      -0.34060365085379596, -0.5180731812032293, -0.735279429837592,
      -0.9486562846385675, -1.1041563191015928, -1.1503305018907548,
      -1.0515334058954038, -0.7980473554800129, -0.41060692434865764,
      0.06190018603156475, 0.5511841599889332, 0.9828653351796182,
      1.2913753329949709, 1.4330872515673951, 1.3947148697512026,
      1.1951140293477858, 0.8801480624484112, 0.5118822710648154,
      0.154671693098187, -0.13860413595710913, -0.33698675442041903,
      -0.43622120848336365, -0.4569093004653727, -0.43666347044924503,
      -0.4183244449672828, -0.43723507656114297, -0.5107674080945462,
      -0.6327325637941443, -0.7741007097044487, -0.8899098618631981,
      -0.9307193685635193, -0.8558322217132023, -0.6450426129221588,
      -0.30597576968133466, 0.124895149906106, 0.5879855836614551,
      1.0119202599032844, 1.327934290402185, 1.48409955226951,
      1.4561331055082747, 1.2523186019669195, 0.9114265666375686,
      0.49413569555011183, 0.06995359769071097, -0.2973410220753741,
      -0.5624023147125193, -0.7063087806871651, -0.7381268682571884,
      -0.6898702270744379, -0.6062461234669259, -0.5318045551883492,
      -0.49869551588796174, -0.5180571426664883, -0.5771481454472782,
      -0.642921379976089, -0.6711520895367843, -0.6188643652758871,
      -0.456971987409225, -0.1799647382854157, 0.18984896476706453,
      0.6047478968209647, 1.0002730201129761, 1.3082856811179306,
      1.4714533111949226, 1.4558304834777749, 1.258612047198468,
      0.9092348993034519, 0.4635372920281156, -0.007711886139434854,
      -0.43330505229757327, -0.7558167111770175, -0.9423502241474361,
      -0.9894473792592453, -0.9211866979856818, -0.7811044087844662,
      -0.6200170772689354, -0.48276477872023466, -0.39710711318186565,
      -0.3674434020550264, -0.3748298021062536, -0.3832184354487115,
      -0.3503185363679518, -0.24034295403457706, -0.03542807020615302,
      0.25718382936219686, 0.6041040989737938, 0.9513307815875084,
      1.2351990150126981, 1.3962693612185548, 1.3929329679632063,
      1.2115317741082197, 0.8705708379117063, 0.417956307013984,
      -0.07819294890620795, -0.5431206626972757, -0.9103402401092819,
      -1.1345179325032524, -1.19946183416682, -1.1195018354574249,
      -0.9340967710563192, -0.6970841231924667, -0.46322114927754227,
      -0.2752634114701198, -0.15464845318743342, -0.09794456113091399,
      -0.07980652874362125, -0.06159262356195247, -0.003420007658029911,
      0.12340066915655251, 0.3267065980722648, 0.5890870826991973,
      0.869965296020605, 1.113799339043842, 1.262547796217622,
      1.269483318124939, 1.1110668234744776, 0.794006312937314,
      0.35572345912002157, -0.1420203855392993, -0.6249903989717459,
      -1.0212012972148545, -1.2751892911402316, -1.3586268735297893,
      -1.2749263695326802, -1.0568790030792603, -0.7579944322201356,
      -0.43965879896095855, -0.15717458438499343, 0.052038672046660905,
      0.1753654366917699, 0.22552202428364682, 0.2347303098836372,
      0.24411023097522122, 0.2910111010325314, 0.39748852404543333,
      0.5628445442218386, 0.7621534994128816, 0.9512335766191108,
      1.0769448600380258, 1.0903775482294855, 0.9597557390975979,
      0.6799017943471424, 0.2758823315442506, -0.20019250140780687,
      -0.6786387878412387, -1.0858791583953125, -1.3592712675184164,
      -1.459734047322894, -1.3793188074949168, -1.1420385320401185,
      -0.7978287306439094, -0.41109864065830026, -0.04656841272352702,
      0.2443148280971223, 0.4332703718523335, 0.5191887662082803,
      0.5254764559284604, 0.4915664674641524, 0.46080972571142775,
      0.46780996925851065, 0.528372615753863, 0.6345804307865782,
      0.7562453013589459, 0.8484194020659231, 0.8631564842584665,
      0.7626534782599868, 0.530529730949415, 0.17840769476601528,
      -0.2539495540382264, -0.7051699590243318, -1.104114003392061,
      -1.3843920379217498, -1.4982631743664778, -1.42673459951784,
      -1.1835418888754838, -0.8120990048239468, -0.3761292534847167,
      0.05385723544108362, 0.4151307457295914, 0.6650345163216671,
      0.7882526703201405, 0.7975158532857556, 0.7277723013232101,
      0.6253978378619826, 0.5351772131334805, 0.4882868999546516,
      0.4942296763360594, 0.5386834017899287, 0.5877685958554658,
      0.5976620310992167, 0.5271652648069843, 0.3500946440895947,
      0.06437210916390695, -0.30453697795190304, -0.7068530299741619,
      -1.0777984204114852, -1.3509520297343545, -1.4726012484151831,
      -1.4137727988884996, -1.1771293245792276, -0.7970903977221047,
      -0.333098914973445, 0.14246168139222792, 0.5589612549691106,
      0.86149960256329, 1.0210282126182966, 1.0384043087880013,
      0.9416027014992607, 0.7769209813298634, 0.596413309386461,
      0.4446463665000837, 0.34798626572109037, 0.30897305251770985,
      0.3070783387144408, 0.3055751007602063, 0.26275267785012235,
      0.14464330407606096, -0.06395487380140907, -0.3529772016668614,
      -0.6868532497250011, -1.0107611719856766, -1.2620344374763688,
      -1.3841155156128284, -1.3397997066306877, -1.1206317174061702,
      -0.750182672766118, -0.28034350906490124, 0.21860981554805453,
      0.6719757186981878, 1.0154729911147642, 1.2076354833973646,
      1.2369990343975772, 1.1225487710004858, 0.9074721602915865,
      0.6478195401430575, 0.3988413613644353, 0.20227515721954192,
      0.07757869359433706, 0.0191180261909302, -0.0001414054507781102,
    ]);
    const expected = [
      [
        0.4943661225103623, 1.635701339665323, 2.11779125109758,
        1.5978873214568816, 0.3962281619838518, -0.7526414490161899,
        -1.268139579837253, -1.126138640660277, -0.7660457814300288,
        -0.6156485636204653, -0.6805205839306621, -0.5728438191376563,
        0.055079629182828764, 1.0832671419794975, 1.9154159871039333,
        1.9292316840399968, 0.9969378572232939, -0.3580816229984779,
        -1.3760048699738836, -1.5659890968694425, -1.138293300270673,
        -0.5441604949535408, -0.3227315902065846, -0.2191450570805229,
        -0.09972852276553744, 0.6749809778529, 1.3245188839131408,
        2.0679498709080852, 1.2602973193272833, 0.11070851020189436,
        0.6055546587402368, 1.5775677634094722, 1.827241000031324,
        1.2795088674174726, 0.4736872607289381, -0.045857163954135284,
        -0.17697649411173644, -0.2562239932660574, -0.6386894081644116,
        -1.2685447643621173, -1.653990040360526, -1.288675921654002,
        -0.14725366683243019, 1.1996606079864633, 1.9781915578725722,
        1.7909342737282505, 0.8943005851056888, -0.05428276637726203,
        -0.5469098910284402, -0.5905419773149597, -0.5834760818289136,
        -0.844243901131911, -1.2446919060823831, -1.2971426716458554,
        -0.6248225367014418, 0.6144648099027411, 1.7533364866215162,
        2.0965653475689714, 1.4585721454506755, 0.2977050977584908,
        -0.6645678676905337, -1.0063588258227592, -0.8679648708213669,
        -0.7094100018802515, -0.8105876252274659, -0.984559851559782,
        -0.7701482070455234, 0.07521289022701959, 1.2445410253836333,
        2.038357723023852, 1.8999605903044827, 0.8735111933814376,
        -0.4146231608862056, -1.2400360081905335, -1.3165490168442664,
        -0.9338673677189039, -0.6044236675981529, -0.5601412257316681,
        -0.5612979460613372, -0.18429134934737196, 0.6884779539499648,
        1.644157016898891, 2.012571595473642, 1.417671392340155,
        0.12630179417306298, -1.121115460157016, -1.6646226312010044,
        -1.3959634764290025, -0.7564445162647296, -0.28927108244444955,
        -0.16090820907920333, -0.0779720647605266, 0.3432032704764946,
        1.1131811755327645, 1.7584721076977867, 1.6889231003558574,
        0.7293274410566546, -0.6615389784725423, -1.6968336952350056,
        -1.846078931341496, -1.206300030094092, -0.3547720091174088,
        0.16898098653087973, 0.28786837291420697, 0.35366286266213687,
        0.7120924776936567, 1.2873723989146337, 1.5858771162887726,
        1.1324684599761428, -0.049689587492208434, -1.3596509858925983,
        -2.0369394750130785, -1.7344361215184074, -0.7612713901125159,
        0.20396319369407204, 0.6703012047781934, 0.6762435199094807,
        0.6358946335420126, 0.8584053175692624, 1.19970935698163,
        1.1770654319088514, 0.44763705334074283, -0.7894999989813876,
        -1.852725478456083, -2.076587844763261, -1.3325749466908505,
        -0.1253412962869217, 0.8168291606964794, 1.1017408795322432,
        0.9062465997647743, 0.704823351392149, 0.7663760557282706,
        0.8903004516729784, 0.6241757478849872, -0.2417838279695798,
        -1.3696017476266515, -2.06162623531675, -1.803419128606098,
        -0.6968002736123304, 0.5974424839378024, 1.364757731370652,
        1.360257195543879, 0.9122249614190696, 0.5432873206068182,
        0.4707399119866123, 0.4415415967813065, 0.04216594704901249,
        -0.8160637295334278, -1.700851365084424, -1.9576814819332145,
        -1.2602763666611683, 0.0727763207054262, 1.2825064156809078,
        1.7352955765176925, 1.3748870746474666, 0.6716192214950766,
        0.19411256580898037, 0.022771811002478375, -0.017862954557966455,
        0.1932068464984161, 0.7989664277263127,
      ],
      [
        5.5884409594278297e-5, 0.002687550008704054, 0.021809806814019752,
        0.015118778993121489, -0.0721574474089071, 0.04529659333047697,
        -0.01297814610861221, -0.004681944447184952, 0.00983486077516344,
        -0.007707343574825821, 0.002614010055225618, 0.0023961371710515354,
        -0.00556523162118763, 0.006419867594525074, -0.00549299501663617,
        0.0037668089529236315, -0.0021038365278369976, 0.0009428805745219769,
        -0.00032012776739792355, 6.696354762819717e-5, 3.3495867637502662e-6,
        -1.0192836918064092e-5, 5.0107421328834995e-6, -1.4918004224702546e-6,
        2.797217124621543e-7, -2.263378620238092e-8, -3.856037519543715e-9,
        1.5155960497804417e-9, -2.0233733297091026e-10, 7.817927484954561e-12,
        -3.831228235190822e-13, -1.3480917580720894e-12, -8.945832911982433e-14,
        1.1716831242503295e-12, 1.379977898717209e-12, 3.554197554213699e-13,
        -9.89327004216374e-13, -1.4485364982700434e-12, -6.101213270589008e-13,
        7.71871182798442e-13, 1.4636314738773478e-12, 8.437111383053816e-13,
        -5.31069286916451e-13, -1.431855730512507e-12, -1.0486461787501713e-12,
        2.715273307542577e-13, 1.348257851648058e-12, 1.2223674650649588e-12,
        -5.474745987328944e-15, -1.224567777354246e-12, -1.34655822719779e-12,
        -2.6681712102822517e-13, 1.0546517388869244e-12, 1.4304046304214242e-12,
        5.28652524085972e-13, -8.491299068314066e-13, -1.4649819448169485e-12,
        -7.646776982794322e-13, 6.129402386461849e-13, 1.4471485233710856e-12,
        9.85685400279112e-13, -3.607070500253182e-13, -1.3812733681352137e-12,
        -1.1657829291626507e-12, 9.387595993135302e-14, 1.2698618049858778e-12,
        1.3122829835049219e-12, 1.7771737630057026e-13, -1.115183249470636e-12,
        -1.4059047076152971e-12, -4.3680440704135167e-13, 9.159274684614316e-13,
        1.4587750294542195e-12, 6.936923602952031e-13, -6.996509646918279e-13,
        -1.462618355432088e-12, -9.137874291924242e-13, 4.47658734421855e-13,
        1.4063371249304116e-12, 1.109188259413581e-12, -1.8295169421416635e-13,
        -1.3138585193777919e-12, -1.2698575532600529e-12,
        -8.994066310304013e-14, 1.1729871146162755e-12, 1.3768035983343707e-12,
        3.4957852804033235e-13, -9.865533969441161e-13, -1.4460252605705232e-12,
        -6.143832759690163e-13, 7.741260503123652e-13, 1.4684452249170048e-12,
        8.432504817488096e-13, -5.33481334290886e-13, -1.4298957267067518e-12,
        -1.047788150100562e-12, 2.6825155746998006e-13, 1.3516020270486905e-12,
        1.2207788290786098e-12, -1.1431914563078676e-15,
        -1.2288948423901225e-12, -1.3453217916036085e-12,
        -2.607738068792531e-13, 1.0516372984778342e-12, 1.4315260390043824e-12,
        5.294703564100571e-13, -8.492973235698249e-13, -1.4675531135744455e-12,
        -7.637636887390929e-13, 6.174827597297354e-13, 1.4499621197061217e-12,
        9.827693654102325e-13, -3.583926587147348e-13, -1.3769893952819666e-12,
        -1.1691067177466489e-12, 9.363265231986313e-14, 1.273564526888976e-12,
        1.3090576163314007e-12, 1.769682237352581e-13, -1.113469606444063e-12,
        -1.4087196881542935e-12, -4.4328997128474853e-13, 9.226537111983766e-13,
        1.4594249371669005e-12, 6.917734245972563e-13, -6.997933061959712e-13,
        -1.4645566581273204e-12, -9.133440013128717e-13, 1.951219315575046e-6,
        7.086232682459556e-5, 0.0003839999052868214, -3.424886799667257e-5,
        -0.000659232142785098, 0.00029058454696896413, -4.82129092462247e-5,
        -2.9910144117825475e-5, 7.634472992351537e-5, -0.00014836968203764452,
        0.00023466409132953865, -0.00029506345849199554, 0.000297999917870906,
        -0.00024270761963998322, 0.00015698121775220556, -7.629346951234051e-5,
        2.2727335671216843e-5, 1.600912245035131e-6, -6.9657455742744865e-6,
        4.885648315690948e-6, -2.0906029247430355e-6, 5.692823590718016e-7,
        -6.643078003979033e-8, -1.956584844718053e-8, 1.213639302267457e-8,
        -2.9608497653641223e-9, 3.2586834607000424e-10, 1.3118961018213895e-11,
        -1.0290590710724629e-11, 1.0929143724264557e-12, 1.323652927263388e-12,
        1.2640479793586221e-12, 8.369025577236652e-14,
      ],
    ];
    const result = wavedec(data, "db34");

    const reconstruction = waverec(result, "db34", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db34_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5114061466957537, 0.9412596082672502, 1.2252202609567155,
      1.32925147796592, 1.2554976474607735, 1.0396555157183183,
      0.7406597743587648, 0.42539672309799903, 0.1523562964547746,
      -0.04166716066316861, -0.14855705767673866, -0.1879365289952629,
      -0.19876749339727176, -0.22587224681868806, -0.30506624978887936,
      -0.4509366584289467, -0.6506022515487907, -0.8652264089957078,
      -1.039026669752668, -1.1135521682989675, -1.0435904007040122,
      -0.810581055586951, -0.4299851591592697, 0.049457976662833775,
      0.554629250049203, 1.0030747771589745, 1.3206288295145676,
      1.4573754862880488, 1.3980998645357925, 1.1647337098470245,
      0.8102769364641768, 0.40577784522583593, 0.02365058408100451,
      -0.27852738141320077, -0.4697773870184193, -0.5502590317258796,
      -0.5476754163991314, -0.5067174677145321, -0.4744881910211684,
      -0.4858484621336321, -0.5526069627070265, -0.6594457589305791,
      -0.7676960078852247, -0.8260120537829592, -0.7851674406911431,
      -0.6130824232571505, -0.30607755291403704, 0.10673480278369041,
      0.5672898300953485, 0.9999234740652841, 1.3276000626236935,
      1.4891059361281052, 1.45300998240981, 1.224956826592053,
      0.8464884252528482, 0.38567510282766215, -0.07814777603724732,
      -0.47180395886516424, -0.7436293490514216, -0.8730856224900665,
      -0.8724456620790406, -0.7803797412029799, -0.649313830557934,
      -0.5299803051821173, -0.45724522342719326, -0.44091000494142046,
      -0.4638515228086263, -0.48792764975809544, -0.46603303988300926,
      -0.35706680594496076, -0.13978695874347058, 0.1782204763042171,
      0.558999040378788, 0.9407513414825669, 1.2510069844723282,
      1.4232648460358095, 1.4130064439647785, 1.2090723690684952,
      0.8375038438875186, 0.35679909379737434, -0.15434563986558958,
      -0.6138826701821802, -0.9537922408894957, -1.1338276671022753,
      -1.1483885401660254, -1.0250184636815447, -0.8151226228762233,
      -0.5794323585514538, -0.3720207931928446, -0.22697492724157248,
      -0.15108371362083756, -0.12430329634389234, -0.10772142723095969,
      -0.056786246880342006, 0.0638084696018506, 0.26762706109101514,
      0.5398197216383991, 0.8382062535528432, 1.1020362746504742,
      1.2663407032024323, 1.2783037633101475, 1.1115017493225492,
      0.7743277027325632, 0.3103347574499219, -0.20976965967621736,
      -0.7026658822006555, -1.0900516319911158, -1.3151338548466787,
      -1.3540367638005646, -1.2194451733043667, -0.95573321860088,
      -0.6269374613878742, -0.30068783332730825, -0.03216832208293152,
      0.14789698793036526, 0.23832353279608628, 0.2645185148123419,
      0.26849227195116465, 0.2946265951940102, 0.3750786729638595,
      0.5187746440609833, 0.7069985989921566, 0.8968550412222257,
      1.0318185104522457, 1.0567129147366945, 0.9332661137463087,
      0.6521720694309409, 0.2384225483785421, -0.2516638680928625,
      -0.7412062338561415, -1.148840036712246, -1.40627317091749,
      -1.4730816024268072, -1.3451683224114903, -1.0548664581912515,
      -0.6627286911902174, -0.24309071002222393, 0.13298904832874903,
      0.4132078983906216, 0.5741670489791888, 0.6238375567347919,
      0.5959706075425514, 0.5381335248941541, 0.49666114362621844,
      0.5025656131367072, 0.5621569098267156, 0.6548687404853644,
      0.7388843565030575, 0.763102371267532, 0.6823017439029564,
      0.4714902528883918, 0.13557903650775072, -0.2883195352962199,
      -0.7368135283702875, -1.1331224196276706, -1.4038934552450926,
      -1.4958630150677674, -1.3882698301960341, -1.0979448514846433,
      -0.6757968430792625, -0.19553191143852386, 0.2626448619726097,
      0.6293778550684367, 0.8603683591932512, 0.9440768203295709,
      0.9012201161563784, 0.7764421161525092, 0.6244993137362667,
      0.4946548763200799, 0.41737337730068674, 0.3967574064528716,
      0.41063662622194913, 0.41820414066359785, 0.37311209476028484,
      0.2384972785388338, -0.00012138319393267816, -0.32761090555726996,
      -0.6997560531993497, -1.0516611773736801, -1.3120918637656547,
      -1.4202656357442307, -1.3409170000632316, -1.0738331834567791,
      -0.6553935361668022, -0.15161282555457917, 0.3557090892481152,
      0.786421944606225, 1.0788543909811588, 1.2020157432469531,
      1.1603198930015948, 0.9898596840911523, 0.7473690778942294,
      0.49481631837478157, 0.28361857844834887, 0.14249547172189264,
      0.07198355554785713, 0.046874794373623435, 0.02577113952375898,
      -0.034904259376771274, -0.1662570902350285, -0.37561969273690926,
      -0.6417187384653618, -0.9177581736826923, -1.1418026828032504,
      -1.2519308398892761, -1.202346821075107, -0.9763256367009265,
      -0.5926042704667662, -0.10343723834920904, 0.41539424626014654,
      0.8803182505416361, 1.2177078744714227, 1.379361357559676,
      1.352024991975225, 1.1587356335762589, 0.8517890186429213,
      0.49920805493819986, 0.16817020625181256, -0.0904431915258786,
      -0.2525642989155014, -0.32402384933772144, -0.33564025635665745,
      -0.331811673166185, -0.355773017670825, -0.43551971590952565,
      -0.5742033020949342, -0.7476230309993288, -0.9095759121233385,
      -1.0037628189748955, -0.9792106207747449, -0.8052067952151427,
      -0.48180385127608466, -0.043025233113939076, 0.44827729189837096,
      0.9128622328295886, 1.2719270568054242, 1.4642881281330358,
      1.459750012420661, 1.265422799272239, 0.9234796242953406,
      0.5009564652589839, 0.07415071016754854, -0.2885181708926559,
      -0.5409908432124036, -0.6679217342137316, -0.6850237863721244,
      -0.6315757746722118, -0.5572528651297619, -0.5068621078177216,
      -0.5070575244826088, -0.5585518675150374, -0.6358797759690789,
      -0.6947766254974659, -0.6852302883317983,
    ]);
    const expected = [
      [
        -0.8363244842634592, 0.3245207247998018, 1.5822383590055713,
        2.118942682057657, 1.5788594752413763, 0.3628389838957155,
        -0.7210784224268635, -1.127369197146483, -0.9535103826988266,
        -0.7085215218370012, -0.7297348897940737, -0.8316634483485551,
        -0.5299799669388772, 0.3862574378825715, 1.5107896899337003,
        2.075200111718683, 1.589854536996657, 0.30900884919996513,
        -0.9801819712327886, -1.5265337657124454, -1.298949008312801,
        -0.7005334594742698, -0.4049936450483627, -0.2804359240596186,
        -0.2122017278099169, 0.5423044790434532, 1.2348042774981798,
        2.0794115759778506, 1.291244059797549, 0.11272591962928259,
        0.6342940217816406, 1.6204305779005863, 1.8104303620106101,
        1.1762410271315413, 0.3422644069385621, -0.13349938119178845,
        -0.23000029611704156, -0.35966042709307927, -0.8311551255435625,
        -1.431685035907597, -1.5621334405639702, -0.8156514697406035,
        0.553863807034342, 1.7429150130471651, 2.0206608834232576,
        1.3103340010842228, 0.20866654963536843, -0.5598246686069104,
        -0.7402302471852735, -0.6536511150707812, -0.750250736692525,
        -1.0751641427310892, -1.1862624848568115, -0.6133519122312288,
        0.5896016944475199, 1.7552280376573204, 2.101751733338097,
        1.3838918561627904, 0.10230939729199398, -0.9210382717121963,
        -1.211981704155808, -0.9527304300099845, -0.676871498887012,
        -0.6789775870548816, -0.7248409988295378, -0.3410459529008191,
        0.6110407880078723, 1.6589534641481314, 2.045024100652713,
        1.379490018324492, 0.018155953025043237, -1.1970547007007546,
        -1.6101891591898287, -1.2327804401323723, -0.6169938370437178,
        -0.2744136645056583, -0.2100537516257378, -0.009488262897423426,
        0.6302045070974471, 1.4705225718806483, 1.852710470500085,
        1.284892790288122, -0.052704336775847765, -1.3763125926511166,
        -1.905133399441045, -1.467982330082408, -0.5712726337869607,
        0.10924062119883042, 0.3212889641554144, 0.36319294752425535,
        0.6565139715509726, 1.2123891822315531, 1.5378137032360415,
        1.094937111525791, -0.12129312416901743, -1.4562026293367236,
        -2.0750437647766584, -1.6333951241657834, -0.5352304906675459,
        0.4472053511149085, 0.8308704236185032, 0.7526554309756646,
        0.69526144137348, 0.9105210348563431, 1.1230557730404385,
        0.8127749708321972, -0.19872349774165946, -1.4425996953804088,
        -2.1079887866064975, -1.707617205260627, -0.5001599115796138,
        0.7211283174905754, 1.2821359793415508, 1.1302498589779948,
        0.7466777689449975, 0.5916926336727026, 0.6389386035497379,
        0.45031026640148575, -0.2941773636501355, -1.348583083264867,
        -2.002872471863795, -1.6752458488186586, -0.4546226842493296,
        0.920247704638691, 1.6433983594246346, 1.4655014218430005,
        0.8057102776844033, 0.28086633494085567, 0.12110253234702964,
        0.027748404218944825, -0.41313412510110115, -1.1925112056168437,
        -1.7694421546824812, -1.5288636573741765, -0.38636024518683715,
        1.0417084054486003, 1.8904834859985216, 1.7289263534376293,
        0.862544907673314, -0.0010731753455629242, -0.3927498722364646,
        -0.42776153073698986, -0.5560130996944846, -0.9957828606353533,
        -1.4271887580053761, -1.2703939129060309, -0.28452449797072854,
        1.0906602148759266, 2.007215218537328, 1.8975530505732352,
        0.8996701007130291, -0.23330505524112508, -0.8727980992563662,
        -0.8785643312067842, -0.7159791631011516, -0.8055409750911439,
        -0.9224808102565255, -1.0119502509238458, -0.9019257027466707,
        -0.7200628712810486, -0.7800772244763443,
      ],
      [
        5.807338893045063e-5, 0.002795808678560949, 0.022713722235418267,
        0.015786307026083492, -0.07523124025877043, 0.047242513970567175,
        -0.013539803028786802, -0.004884002996779856, 0.010256096447564787,
        -0.008024546795757277, 0.002695009210967969, 0.0025438330772619266,
        -0.005852360078266573, 0.006736340616580691, -0.005756272080490996,
        0.003942681250716159, -0.002199121832684179, 0.0009838651271581829,
        -0.00033312255248439736, 6.919838367054733e-5, 3.7879222535657277e-6,
        -1.0716222490079903e-5, 5.23830910671544e-6, -1.5541670044472493e-6,
        2.902789472528408e-7, -2.3227117548276467e-8, -4.06416233400246e-9,
        1.5823393228688853e-9, -2.097045832510552e-10, 5.559977129950167e-12,
        -3.246474737788262e-12, -1.8229820256786746e-12, 2.391984018834349e-12,
        4.245430339559572e-12, 2.053089283665707e-12, -2.0969421469573936e-12,
        -4.248387317107542e-12, -2.3507481053113533e-12, 1.7859043375264786e-12,
        4.221951224688068e-12, 2.633482869353379e-12, -1.4621306306056969e-12,
        -4.166567376191993e-12, -2.898670763330361e-12, 1.1304155999639024e-12,
        4.083227160202679e-12, 3.144121954952958e-12, -7.898282613759979e-13,
        -3.972575817276035e-12, -3.367928325878471e-12, 4.438891413287995e-13,
        3.834268407727383e-12, 3.569125547549955e-12, -9.472771854378348e-14,
        -3.671757063110279e-12, -3.74633077992653e-12, -2.544406168799885e-13,
        3.4822169691711865e-12, 3.898082046649977e-12, 6.020668501260204e-13,
        -3.2713904184458798e-12, -4.023792581538521e-12, -9.460692478987112e-13,
        3.036421499605583e-12, 4.123626083239964e-12, 1.2850497033872902e-12,
        -2.780741157773338e-12, -4.193053228984798e-12, -1.60843724603517e-12,
        2.5089587028226617e-12, 4.237634884757122e-12, 1.9287389353820027e-12,
        -2.2191823163157466e-12, -4.247552081265239e-12,
        -2.2307980642824884e-12, 1.9128461032232777e-12, 4.2363365476708086e-12,
        2.5248057969674517e-12, -1.5928437708716357e-12,
        -4.1937980882271744e-12, -2.792396547981148e-12, 1.267348925476668e-12,
        4.118675084482169e-12, 3.0524670558786552e-12, -9.26466178759232e-13,
        -4.018285708999798e-12, -3.2795917850765357e-12, 5.863776333802533e-13,
        3.894022841295254e-12, 3.494248598911216e-12, -2.335936120855095e-13,
        -3.738646615975073e-12, -3.677832661951784e-12, -1.1119427298736746e-13,
        3.5622935886808563e-12, 3.8474435004945765e-12, 4.645998923700389e-13,
        -3.359310996346724e-12, -3.9747000764074454e-12, -8.059901805589948e-13,
        3.134280295671124e-12, 4.088627654345525e-12, 1.1509849229229964e-12,
        -2.885248419617652e-12, -4.166969558218817e-12, -1.4782700555325026e-12,
        2.6210920772797208e-12, 4.224788033646148e-12, 1.8042643715706323e-12,
        -2.3358271715156044e-12, -4.248995534645546e-12,
        -2.1112924194015097e-12, 2.0368933987002797e-12, 4.247484639530548e-12,
        2.4086890203710304e-12, -1.7218954955015771e-12, -4.213896759873303e-12,
        -2.6830223013003325e-12, 1.397668438196765e-12, 4.150946853830114e-12,
        2.947543258268355e-12, -1.0614332426435778e-12, -4.065582027410806e-12,
        -3.189006076736803e-12, 7.178013003652733e-13, 3.942575665014872e-12,
        3.409344478980734e-12, 6.836627086419517e-7, 0.00011702068459964921,
        0.0021289790684184007, 0.006715537683137393, -0.007381995593792493,
        -0.0082992745658938, 0.014170590932988784, -0.014139183045911935,
        0.012338459226802465, -0.01028831162474604, 0.00829195661902666,
        -0.006345829538268456, 0.004485475090787418, -0.0028369294164064334,
        0.0015424526215542676, -0.000672777087285573, 0.00019305545705559395,
        7.017952408609622e-6, -5.344148724494755e-5, 4.1248147979477436e-5,
        -2.051594082030563e-5, 7.378227279357483e-6, -1.8544994168183516e-6,
        2.4887905754037643e-7, 2.740244119369036e-8, -2.458146439336401e-8,
        6.5943482535287115e-9, -9.200946610645894e-10, 4.105188205397217e-11,
        1.147778038082885e-11, -3.4196904014260535e-12, -4.204418401984637e-12,
        -2.466233076562859e-12, 1.6532211424791642e-12,
      ],
    ];
    const result = wavedec(data, "db34");

    const reconstruction = waverec(result, "db34", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db35", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5054329350124569, 0.9289309019905531, 1.206527743233095,
      1.3057415413525493, 1.2313284754757157, 1.021959832112632,
      0.7388301171210849, 0.44925504564545, 0.2095656063813831,
      0.05172722219112463, -0.02291662868403671, -0.041286715032229054,
      -0.048395103733000544, -0.09222345828012851, -0.20782493177638833,
      -0.4050245467270903, -0.6631393875683453, -0.9342798800167356,
      -1.154513812558695, -1.2600727142881498, -1.20440725299286,
      -0.9716163322205678, -0.5826611796487615, -0.09260380651571339,
      0.4205941705211582, 0.8730069509144507, 1.1932300511015437,
      1.3378279712084011, 1.2999326102065352, 1.1089363890160744,
      0.8215027628308271, 0.506327770787212, 0.2266567055405359,
      0.02508449759592357, -0.08548559926776539, -0.12250848789060542,
      -0.12609863768707533, -0.14518745775634928, -0.22137539633734582,
      -0.37491892446337777, -0.5967208213829933, -0.8485973778205704,
      -1.071896026762382, -1.2023079027890227, -1.1870465193923443,
      -0.9998863039923265, -0.6500538629680812, -0.18251445029404326,
      0.33060416191361064, 0.8054288266155101, 1.1648106225651773,
      1.3552632917163094, 1.3581709445298031, 1.192529546989283,
      0.908651194468858, 0.5745637393633031, 0.2586840462554488,
      0.013253848763279008, -0.13723039159967382, -0.1997169301699821,
      -0.20764589638289452, -0.20884898148326708, -0.24968607565868933,
      -0.35978498599042297, -0.5415782309519515, -0.7675508102563535,
      -0.9860604933056386, -1.1343054279762212, -1.1550923818392154,
      -1.0130075425109641, -0.7056887178486883, -0.26712172936723905,
      0.23808066337103911, 0.7281394833376549, 1.1220311593540961,
      1.3574294160714984, 1.4042067353409422, 1.2701627033506995,
      0.9976306010659378, 0.6519393565225945, 0.3047727333646561,
      0.01673712307138525, -0.1764032569945318, -0.27037400882917567,
      -0.2903701862439327, -0.2811078366708927, -0.29177076492422316,
      -0.3600076107367133, -0.49936726591166347, -0.6936350210655915,
      -0.8996909116599584, -1.0582382701123705, -1.1096406507144185,
      -1.01071302122406, -0.7480054643697476, -0.34397880763325434,
      0.14571926963171628, 0.6433806313988176, 1.0660951571813264,
      1.3441779256448807, 1.4365783521574598, 1.3394420308457782,
      1.0857389653841232, 0.7361487517206236, 0.36361410839420394,
      0.035563987500025374, -0.20164395944531371, -0.33214352161054794,
      -0.3715683507217875, -0.35959857875264845, -0.34621836281112545,
      -0.3754978960868571, -0.4713444106779456, -0.6291243573675745,
      -0.8154866309534428, -0.9765271260857276, -1.0522023470507915,
      -0.9932101841034183, -0.775853871369129, -0.41087758733426805,
      0.0562103801697412, 0.5536236832323623, 0.9986108341567861,
      1.3158346443348319, 1.4542443049976084, 1.3982302214949733,
      1.1703003006955552, 0.8246748108389798, 0.43350606085421345,
      0.06929101103357982, -0.21202168292025886, -0.382963069930782,
      -0.4485840473823843, -0.4417633845688477, -0.4112363446903886,
      -0.40569589830389524, -0.45832827860505526, -0.5760026066270975,
      -0.7360794932959884, -0.8917658358024597, -0.9846571513273314,
      -0.9611745514896235, -0.7885291861232531, -0.4659167270075619,
      -0.027843676576518567, 0.4614936232797002, 0.9215415914155856,
      1.2731896035129702, 1.456615329512132, 1.444712328180027,
      1.2487470856918885, 0.9148667158535139, 0.5124054601593617,
      0.11701532124228614, -0.2070637100237555, -0.42110759702741096,
      -0.5188895828508717, -0.5249308519392661, -0.4847059858964843,
      -0.44958788427382096, -0.460674395138714, -0.5359018845698622,
      -0.663952756734462, -0.8066414747874847, -0.9091954954267397,
      -0.9157289064765184, -0.7857938407091517, -0.5075602095608108,
      -0.10400880587102534, 0.3696881469835587, 0.8371455320610581,
      1.217472706701911, 1.443572540960562, 1.477451675665095,
      1.3186993580502624, 1.0040216033790506, 0.597991092965615,
      0.1774024143398728, -0.18676998855158328, -0.4452425340168473,
      -0.5801637846232488, -0.6063982981401026, -0.5642476338685728,
      -0.5057375626182623, -0.4782642467884634, -0.5100523566527295,
      -0.6013645954817903, -0.7238515746062081, -0.82825108166047,
      -0.858408703016089, -0.7678847663667397, -0.5346846562349054,
      -0.1700941267661739, 0.2808945598705667, 0.7479059015902939,
      1.15031584365408, 1.4154710977841471, 1.49543411866853,
      1.3780380301144657, 1.0894678265332471, 0.6877351670876535,
      0.24872726200621093, -0.15161313720583341, -0.45446491665655336,
      -0.6303635108405877, -0.6835150220138837, -0.6472940184021299,
      -0.5723303320755805, -0.5105089332745527, -0.49924434195973416,
      -0.5502785340575289, -0.6460210211989053, -0.7444259076674864,
      -0.7911147613750548, -0.7355060905366173, -0.5466139289095024,
      -0.22421945978603336, 0.19770699671416658, 0.6564545926411681,
      1.0737026209383504, 1.3731292619159932, 1.4980992835794853,
      1.424970168142416, 1.1686472551703437, 0.7789811792609779,
      0.32892744864626444, -0.10252389029339481, -0.44833120617593125,
      -0.6677865951090618, -0.7537639647556844, -0.7311693416291207,
      -0.6472291840430675, -0.556367310342037, -0.5038039669439596,
      -0.5123029583723997, -0.5756211911422054, -0.6604101068553851,
      -0.7160547081981472, -0.6898074415471512, -0.5431399547993888,
      -0.264873243194244, 0.12254651090835106, 0.5654910705589897,
      0.989907257623883, 1.3178031928344205, 1.4853578313930265,
      1.458084224139955, 1.2391940791596001, 0.8690257479694131,
      0.4156667021489878, -0.04086242979568466, -0.4268709571328305,
      -0.6911242872996206, -0.8148392537487417, -0.8131717112958067,
    ]);
    const expected = [
      [
        -0.3370450424696586, -0.046331138209689135, 0.7523099239426252,
        1.6615125866393725, 1.9503925122273325, 1.2254104365263405,
        -0.15607845601255638, -1.3407057224614178, -1.6789571746800933,
        -1.2231333132032356, -0.5741786602404444, -0.2540072724388189,
        -0.22637720997516783, -0.025438466436222034, 0.658615477379487,
        1.54126070158308, 1.9218883712990231, 1.3158145518174407,
        -0.02455769851799892, -1.3016628283836238, -1.7488483037179872,
        -1.356154882603506, -0.6055182641267678, -0.20231443980871974,
        -0.08328264738433812, -0.024853775028173448, 0.6480775454352545,
        1.3015126658073295, 2.069976398266823, 1.11703002765531,
        0.09225017845601853, 0.7309781748167049, 1.6537534263670985,
        1.7404882838179407, 1.0857820223214218, 0.35195834157081796,
        0.02146280514041786, -0.016020489409776854, -0.24040127517281593,
        -0.895236630460783, -1.6266603199450058, -1.7522213150144574,
        -0.9179386274648453, 0.494703846405731, 1.6251113919343465,
        1.834299107036873, 1.2039113634865914, 0.38025046375505994,
        -0.06421827080727231, -0.12723875832228188, -0.26366696935190437,
        -0.8039886233765269, -1.508195161924709, -1.7230421447735051,
        -1.0099190816306325, 0.3663061839208907, 1.5803677916339849,
        1.912931061879751, 1.3276135520944772, 0.4294621673999488,
        -0.13404438049027323, -0.24312974785983937, -0.3075730672878577,
        -0.7292118707424384, -1.385951416215662, -1.673491331485464,
        -1.0847717322782178, 0.23510593264493648, 1.5156177727509832,
        1.9738361525774895, 1.4531221025620662, 0.49822634730017695,
        -0.18565076585748416, -0.3599019976611261, -0.3705972386138796,
        -0.6731371563606668, -1.2637385871034457, -1.6052437891677076,
        -1.1404042024509546, 0.10492336471217568, 1.4326858597279273,
        2.0150648203917734, 1.5766137350134461, 0.5845726872317994,
        -0.21723432095212464, -0.4737366744234643, -0.45062743668031663,
        -0.6374180261039633, -1.1453640780263525, -1.5205495165657787,
        -1.1753158268116262, -0.020452820330832924, 1.3339559187153338,
        2.035272549214313, 1.6943261533532434, 0.685988353160253,
        -0.22760914378475522, -0.5809052201103522, -0.5450269664456426,
        -0.623079851082027, -1.0345159002862567, -1.4221642801534862,
        -1.1886438751243376, -0.13738220352400707, 1.2222977252387661,
        2.0337612864749275, 1.802673944716243, 0.7994953991726053,
        -0.2162430747280398, -0.6778842191622443, -0.6507157146064982,
        -0.630488242269801, -0.9346490597617884, -1.3132647165724434,
        -1.1801901236394696, -0.2424847865830864, 1.1009785630547457,
        2.0105009492465227, 1.8983590299167572, 0.9217425015816963,
        -0.1832740958381653, -0.7614639461329142, -0.764265039606724,
        -0.6593377896104883, -0.8488791215731908, -1.197350469849284,
        -1.1504269558288391, -0.33274510951362024, 0.9735625774639837,
        1.9661303530339784, 1.9784722623822824, 1.0491081952596006,
        -0.1295060859104092, -0.8288472498821675, -0.8820033979249734,
        -0.7086614757616206, -0.7798862151608738, -1.0781364356698842,
        -1.1004826766421218, -0.40560517306174276, 0.8437997599918778,
        1.9019444802088594, 2.040557713879268, 1.177884975838347,
        -0.05655809564120105, -0.8773746819537779, -1.0007902993439322,
        -0.7757762109113321, -0.7314527177957116, -0.9571885699626026,
        -1.035093643547218, -0.45509366163282294, 0.71004699585537,
        1.8280810229743598, 2.069090985147231, 1.3283998767451224,
        -0.009368606472905178, -0.8397927305424874, -1.1447472739314135,
        -1.2190765456457762, -0.6888510740626411, 0.49687895994107356,
      ],
      [
        4.178430980591227e-5, 0.002169809139557857, 0.01966605985799085,
        0.021217395457348017, -0.06941637626083756, 0.028009634049861468,
        0.010312455022292187, -0.02852206203550546, 0.032200925660341446,
        -0.02780408359512596, 0.01974445738521305, -0.011050713465664917,
        0.003800959045290931, 0.000905017744937147, -0.0029862671774580473,
        0.0031326309781737646, -0.002317887191459497, 0.0013413250116738405,
        -0.0006159086091311146, 0.0002169016174005982, -5.1207358867908805e-5,
        2.6313724829622877e-6, 4.317932495749542e-6, -2.4149870510445077e-6,
        7.464883182000907e-7, -1.4457289093698105e-7, 1.3432524298314045e-8,
        1.2962347560300712e-9, -6.345907901628335e-10, 8.523801416059245e-11,
        -3.984043965535081e-12, 2.175085410776413e-12, 2.824707871387029e-12,
        3.465711679136421e-13, -2.4416383215170566e-12, -2.8472802533373665e-12,
        -4.785043472898255e-13, 2.3565823348549585e-12, 2.8949386386335224e-12,
        6.117800900175218e-13, -2.2695522228243323e-12, -2.9377937753760254e-12,
        -7.41395782734445e-13, 2.1738422024650944e-12, 2.972753788046276e-12,
        8.734424384637388e-13, -2.0758518842414203e-12, -3.0031910580724423e-12,
        -1.0015650133270727e-12, 1.9760837904663e-12, 3.0275329851399195e-12,
        1.1288064169772008e-12, -1.8746481640487713e-12,
        -3.0483677242975954e-12, -1.250311358250641e-12, 1.7624878212377003e-12,
        3.0582040325158934e-12, 1.3739088115053935e-12, -1.6496194613989799e-12,
        -3.066215788970899e-12, -1.4937926049547557e-12, 1.536749474989346e-12,
        3.067502399831775e-12, 1.6086174198652353e-12, -1.4210696831421962e-12,
        -3.065436366854043e-12, -1.7217761774784377e-12, 1.2931672698393495e-12,
        3.0510383506788695e-12, 1.83407756461564e-12, -1.1788554677334012e-12,
        -3.035908451049043e-12, -1.9355661685310916e-12, 1.044348075641664e-12,
        3.0092770023745053e-12, 2.0414037091157617e-12, -9.168391944188578e-13,
        -2.98649151528394e-12, -2.1429317339677334e-12, 7.955936733672957e-13,
        2.9488027641026916e-12, 2.234436711578953e-12, -6.60588790020382e-13,
        -2.907740415411847e-12, -2.322407189982823e-12, 5.297432619508521e-13,
        2.8677690911926218e-12, 2.4078696270308057e-12, -3.879552739669196e-13,
        -2.8092447882664303e-12, -2.491469703216098e-12, 2.614928538020687e-13,
        2.761450474834755e-12, 2.5674976314375993e-12, -1.2897203730021124e-13,
        -2.696368245487879e-12, -2.6346285036199734e-12, -1.436883790298231e-14,
        2.6276966007464132e-12, 2.7036319018538714e-12, 1.441643051035268e-13,
        -2.5608614741396305e-12, -2.7703510878937796e-12,
        -2.780972225584218e-13, 2.4775838252521724e-12, 2.8193420040520815e-12,
        4.0674673217928485e-13, -2.3997298075121322e-12,
        -2.8699896732815624e-12, -5.462519891062006e-13, 2.309931205365973e-12,
        2.9139839170415712e-12, 6.812096687176609e-13, -2.220586665993193e-12,
        -2.957168662843824e-12, -8.059366330229204e-13, 2.1298736196382425e-12,
        2.991091306550002e-12, 9.367840045947763e-13, -2.024994035614446e-12,
        -3.012547189524077e-12, -1.0644282026307945e-12, 1.92628294330345e-12,
        3.037147809437908e-12, 1.1932984745964408e-12, -1.8159392537797475e-12,
        -3.058135467254702e-12, -1.3121644957606518e-12, -7.2051429831418395e-6,
        -0.0003912544070205824, -0.0037041179272913876, -0.004292745011337614,
        0.013594831185973145, -0.005503193280513243, -0.0021902403093502854,
        0.0059409048255856045, -0.006724000054847555, 0.005791333326730866,
        -0.004048846235313029, 0.0021571899865313383, -0.0005903334045605656,
        -0.0003971385796771136, 0.0007913067820305219, -0.0007603277604730591,
        0.0005343227680141358, -0.00029476804365762807, 0.0001277862890293278,
        -4.123595246120972e-5, 7.918876056593474e-6, 6.032431041429249e-7,
        -1.2069145388239158e-6, 5.395047912108342e-7, -1.4640678571785779e-7,
        2.4372328109019136e-8, -1.4207083764931707e-9, -4.197684148715612e-10,
        1.2899422403117638e-10, -1.2279261168501723e-11,
        -2.8521471894067866e-13, -2.8481038757853423e-12, -2.30395147779792e-12,
        5.629624483749528e-13,
      ],
    ];
    const result = wavedec(data, "db35");

    const reconstruction = waverec(result, "db35", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db35_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.497390942978288, 0.9191721909715793, 1.2050277788146606,
      1.321722711950862, 1.268714915424698, 1.076395910370673,
      0.7975162384799087, 0.4939598257479859, 0.22210834623932996,
      0.02032419883996317, -0.0984871757118635, -0.1475566496703023,
      -0.16017439531048056, -0.17852757962139, -0.2403737297379297,
      -0.3669967498821685, -0.5555669084175018, -0.7779288465572697,
      -0.9862412289108553, -1.124179522135917, -1.141008748854924,
      -1.0050807881057462, -0.7133973885406311, -0.2947881063992835,
      0.19423548442124033, 0.6801364535106844, 1.0871399482156003,
      1.3527681020409994, 1.4405436617313931, 1.346944294328508,
      1.1010477490877497, 0.757036403265631, 0.38141153267684624,
      0.03799792295485588, -0.22569698166298652, -0.3875821737369373,
      -0.45349589759525827, -0.45271577829224763, -0.4277659466444251,
      -0.42120696731060564, -0.4628137384263729, -0.5604252888916901,
      -0.696819844038151, -0.8334573577035925, -0.9202102790743611,
      -0.9086934624782886, -0.7658764016727249, -0.48454439506441804,
      -0.08790140977506603, 0.37299743288871134, 0.828568722927178,
      1.2047234818766777, 1.4383789131288527, 1.4908597761047808,
      1.3560643736574025, 1.061494865560773, 0.6619323344790949,
      0.2272689996702294, -0.17262384728552038, -0.4824415091734534,
      -0.6720364724046779, -0.740674427483662, -0.7141303611837253,
      -0.6355398274501952, -0.5524243908963902, -0.5032130762905147,
      -0.5066659153397477, -0.5568534845403077, -0.6249436274480088,
      -0.6673377349185281, -0.6381029189694779, -0.5025545517881268,
      -0.24852449709603103, 0.10761582972407358, 0.5218494286283866,
      0.9303171956367647, 1.262331601928521, 1.4556089403572754,
      1.47015145104202, 1.297491623310008, 0.9630849318287824,
      0.5212468702975257, 0.04378807935291015, -0.3950158328723716,
      -0.7336324769404825, -0.9351569459157514, -0.9931932807180947,
      -0.9305139792314059, -0.7910200431445207, -0.627125383623587,
      -0.48576315349892235, -0.39649944896297756, -0.36467507918498454,
      -0.3712195309331532, -0.37910674232043096, -0.3447603087996982,
      -0.23147334743510734, -0.021389999910520152, 0.27707067342167124,
      0.6283618911482489, 0.9759317094253055, 1.2540043782295265,
      1.4022913379816013, 1.3801441057959107, 1.1767441938381937,
      0.8148330267944924, 0.34700076252401824, -0.1546876901737887,
      -0.6133724735754659, -0.9630102534573469, -1.1613327237956204,
      -1.197213754401869, -1.0908526550906386, -0.8869003815676038,
      -0.6423323956298864, -0.4121014717190116, -0.23609046225707764,
      -0.130514225744216, -0.08578541166172785, -0.07123985953827236,
      -0.04541063008115076, 0.030837467713909605, 0.18171199673261162,
      0.4077058311741223, 0.6829513425379858, 0.9595304104781415,
      1.1778274038842707, 1.2804974940750664, 1.2266917186771669,
      1.0030628623845832, 0.6288047085907532, 0.15337820236130456,
      -0.3526855161325019, -0.8118625230894688, -1.1553817936401596,
      -1.337023755304203, -1.3418171716071825, -1.1876936232136792,
      -0.9198324579008357, -0.5991584156408573, -0.28782221958424586,
      -0.035172451269792016, 0.13244599149367325, 0.21570993842404176,
      0.23933831014425944, 0.24303014315963198, 0.26872974091269525,
      0.3475230204849234, 0.4895467115393697, 0.6795346001307383,
      0.8792182554757075, 1.036087937731693, 1.0964216872252575,
      1.019398672852168, 0.7887957516301641, 0.4193045607526426,
      -0.04422715196129351, -0.5346367656971098, -0.9756732609598245,
      -1.2976057069728038, -1.451619993790324, -1.4196791219116456,
      -1.2175874170191352, -0.8906038303679471, -0.5027072788566632,
      -0.12210427801667884, 0.193571679678261, 0.40889353931396055,
      0.5164416043184826, 0.5355534360635681, 0.5045340320319455,
      0.4684290724121311, 0.465530341917149, 0.5160653053279517,
      0.6159552275980378, 0.7372485910332274, 0.8351624212284258,
      0.8600037867798418, 0.7710043059539922, 0.5485867562716624,
      0.20192298370352146, -0.2302436053337738, -0.6859182500216687,
      -1.091992527484042, -1.3794494899738292, -1.4981159831373971,
      -1.4275150924439812, -1.181273024712197, -0.8040483895683023,
      -0.36171361209094094, 0.07289620657580459, 0.4353238205251809,
      0.6823528820135645, 0.7994585873903997, 0.8012430979932419,
      0.7249603010656702, 0.6189021606867879, 0.5286424846237165,
      0.4846178168176504, 0.49415428929652677, 0.539916865991184,
      0.5851421561867227, 0.584314031275142, 0.49656979849695004,
      0.2984202148413608, -0.007496891054925459, -0.3899632856366766,
      -0.7938337332663097, -1.1508648979084952, -1.3942635141750412,
      -1.4735574741748694, -1.3662691091329706, -1.0835946713573823,
      -0.668695317714928, -0.18794604658199077, 0.28284930470080805,
      0.6740870907649755, 0.9362293733543662, 1.048744313548093,
      1.0221598107025036, 0.8929310056317977, 0.7125436794210299,
      0.5336396022236531, 0.3966275999615811, 0.32007397417595956,
      0.29719281004872533, 0.2992207896261352, 0.2847392137072553,
      0.2125197221492111, 0.05458357740053571, -0.19390517635695054,
      -0.5105267467533363, -0.8484718608633552, -1.145866386321575,
      -1.3394281193657132, -1.3792313397612381, -1.241033532658799,
      -0.9331560677577018, -0.496179778868185, 0.0045873709161467074,
      0.49219876852477096, 0.8937228206507494, 1.1548654877172089,
      1.250219658544399, 1.18685127890649, 1.0005268638555753,
      0.7456387216743049, 0.4813697722901008, 0.257501437032687,
      0.10329991997734289, 0.02211428874865423, -0.007117406452212413,
      -0.02197763516107884, -0.06440011740093665,
    ]);
    const expected = [
      [
        -0.7584832432570874, 0.22981661615471194, 1.4339946326454251,
        2.1013008631537873, 1.762604388233102, 0.6231820536382282,
        -0.5968798506581979, -1.2344186855459651, -1.1680693035957384,
        -0.8058983655364393, -0.6200168296669617, -0.6777979138126122,
        -0.6077371516850375, -0.023821497185082245, 1.0020717585705854,
        1.881472962169884, 1.9565788607745103, 1.053810342425956,
        -0.311414755750046, -1.3589663591199264, -1.5663807897227504,
        -1.1361377727767181, -0.545553567106616, -0.31631188394127974,
        -0.23138958775797996, -0.07156683526918618, 0.7045253167427689,
        1.377403231717917, 2.088076372160144, 1.1130599205122875,
        0.09180859486917162, 0.7145036651771668, 1.6497177312135403,
        1.7949430371392512, 1.1736456661081636, 0.37480541380323024,
        -0.0846125845312563, -0.17963583681271453, -0.29468504208890495,
        -0.7467059685203691, -1.3830449630467567, -1.6512861149236664,
        -1.0958871743877132, 0.169674392343255, 1.461274487367361,
        2.0226494400048187, 1.6026843087631308, 0.6147614522717016,
        -0.2486010976300151, -0.5919221612639102, -0.5727791696518784,
        -0.6320524519388258, -0.978288747622725, -1.327117125649621,
        -1.152350683750184, -0.22183668601818543, 1.085913791780841,
        2.001331526199091, 1.9528385101823162, 1.0179874271611766,
        -0.1562277730087065, -0.8887712569384185, -0.9817213242156098,
        -0.7750679012269369, -0.7227857230419263, -0.9075073596727857,
        -0.9557634897438085, -0.43365334356279206, 0.6528610181439901,
        1.7375669422885405, 2.0970515921146187, 1.4397147681395903,
        0.16216895059635458, -0.9583993167081754, -1.3696400502043522,
        -1.1224190466987471, -0.7104225788163807, -0.5478652804862386,
        -0.5812015063007848, -0.39199068127965025, 0.3174126056573314,
        1.3264120190359268, 1.98337411841017, 1.728406753551254,
        0.5937849414428372, -0.7719125247657903, -1.5923176472867104,
        -1.5462039252149897, -0.9463598638260022, -0.3817034356167695,
        -0.16866116686255025, -0.11554244072514523, 0.19924111843134193,
        0.9166708292408038, 1.6539160148481162, 1.7810419046051331,
        0.9845033277345658, -0.39384824080613157, -1.5658036830646742,
        -1.8906130269136374, -1.3451492882027303, -0.4719304075871394,
        0.12801412005083004, 0.2913389974324694, 0.3387365258693929,
        0.6566086629494773, 1.2294840298178908, 1.5806980888119084,
        1.1951191313499212, 0.04136930140590404, -1.2970418506078316,
        -2.028771651641541, -1.7619068695711417, -0.7879004471303118,
        0.19725915712001627, 0.6767125304645171, 0.6822712958308894,
        0.639862062045423, 0.8655090850153617, 1.2027259304792808,
        1.1521237569851173, 0.3784693680974908, -0.8813369054500055,
        -1.909026292618687, -2.0451693616664532, -1.2165935228957452,
        0.010488241315820311, 0.896479529896358, 1.1017648773543907,
        0.8712784716180973, 0.6953420644021975, 0.7872593496528094,
        0.8745221804675483, 0.49798030279715316, -0.46758579271758943,
        -1.57378888600689, -2.092150911242941, -1.603847206254962,
        -0.3674755064306123, 0.8669519208557659, 1.4414159469682195,
        1.265134162225515, 0.7816300949974083, 0.48805854126276405,
        0.4669151143025307, 0.3598881324448174, -0.20426170699236765,
        -1.1432987170427975, -1.8877820266095813, -1.8079101033714906,
        -0.8062708831241812, 0.6014929252207982, 1.5663041792216819,
        1.6866682499086696, 1.082449284120578, 0.4230820315590338,
        0.0953821518676723, -0.055926091370275245, -0.0566385578281363,
        -0.052708095466651304, 0.09295750153387304, 0.629179379244741,
      ],
      [
        4.10990495011464e-5, 0.0021320864055458374, 0.019303765203039527,
        0.02078688559848763, -0.0680682338549041, 0.027464289073892208,
        0.010087287055057079, -0.02791775052492336, 0.03151666420758717,
        -0.02721561043887819, 0.019336058909366252, -0.01083822617017113,
        0.0037501683759680296, 0.0008553480581155993, -0.002898557780788264,
        0.0030509757183142167, -0.0022617051628674523, 0.0013109719074491624,
        -0.0006030850462335498, 0.00021292774736180026, -5.0524699580046615e-5,
        2.7363472337772142e-6, 4.186000047408992e-6, -2.3599077043336235e-6,
        7.322183822143882e-7, -1.4233353065079037e-7, 1.3330838287149068e-8,
        1.2508322350038208e-9, -6.201150879186088e-10, 8.567139821244339e-11,
        -4.350552955822297e-12, -4.095143027213012e-14, 9.648638459043624e-13,
        7.193903547384206e-13, -1.5370563638266803e-13, -8.84978308995964e-13,
        -8.083241790869594e-13, 5.446352360498014e-15, 8.154411572728693e-13,
        8.781127418914516e-13, 1.4266595788194e-13, -7.238155390028557e-13,
        -9.304956418858892e-13, -2.885183635280986e-13, 6.190053303129161e-13,
        9.586357685071145e-13, 4.2444837704653833e-13, -4.999773247715467e-13,
        -9.67927195238546e-13, -5.504811559218287e-13, 3.6618461394093035e-13,
        9.51393482823041e-13, 6.689734410527997e-13, -2.2519135543225257e-13,
        -9.122563431229883e-13, -7.658439089050105e-13, 8.031461487621863e-14,
        8.499473280348984e-13, 8.483535649378491e-13, 7.027729157065411e-14,
        -7.728987870970849e-13, -9.103833320015922e-13, -2.1796914299050786e-13,
        6.723008568059616e-13, 9.476400207252657e-13, 3.5999263564080855e-13,
        -5.606017491400612e-13, -9.65620807630134e-13, -4.896744635897517e-13,
        4.3311990806913685e-13, 9.639068543466579e-13, 6.117063599984289e-13,
        -2.9277136574129673e-13, -9.337667912772554e-13, -7.225793529239911e-13,
        1.528497791711484e-13, 8.801942061214398e-13, 8.107739638367589e-13,
        -5.684852057926902e-15, -8.122598407158329e-13, -8.813458584143264e-13,
        -1.4742265034483948e-13, 7.221328283707534e-13, 9.305688735225566e-13,
        2.888183066012114e-13, -6.167354272401615e-13, -9.60321471337399e-13,
        -4.2514814043681575e-13, 4.976439164909821e-13, 9.665827878827543e-13,
        5.555151850260914e-13, -3.6643949331026143e-13, -9.456331757106995e-13,
        -6.667968593668302e-13, 2.2164494807857044e-13, 9.104353818960156e-13,
        7.65516836709787e-13, -7.361117646750701e-14, -8.531053536317761e-13,
        -8.502979095243988e-13, -7.117671585727569e-14, 7.689017807928588e-13,
        9.1012469946346e-13, 2.1861786659143898e-13, -6.727578935091663e-13,
        -9.468119304301766e-13, -3.624940371417087e-13, 5.592023009119716e-13,
        9.69536860121789e-13, 4.899483471792968e-13, -4.268351412257222e-13,
        -9.570766223521497e-13, -6.106748542612077e-13, 2.936173120134872e-13,
        9.329644139436331e-13, 7.20660820651486e-13, -1.5160666604615902e-13,
        -8.850323534746079e-13, -8.128816564725929e-13, 3.0296391019469425e-15,
        8.183367269768701e-13, 8.771807883880508e-13, 1.4537606392343827e-13,
        -7.257817217635538e-13, -9.332964575152348e-13, -2.895852971363269e-13,
        6.160272739226505e-13, -4.1893455465933956e-7, -7.694923432023299e-5,
        -0.0015334230479187398, -0.005705789384985375, 0.004308156946198537,
        0.009812227311973142, -0.013364469948315178, 0.011943830119945171,
        -0.009726281880975733, 0.007921749461988562, -0.006545872585632052,
        0.005353024487897823, -0.004175775331098545, 0.0030017594523340744,
        -0.0019282134005355357, 0.0010708944431251405, -0.0004892835495026703,
        0.00016392226905175285, -2.223709908149093e-5, -1.8032663285586082e-5,
        1.793347968215277e-5, -9.475972872033677e-6, 3.4952873845349663e-6,
        -9.037325089545447e-7, 1.3547662230178778e-7, 4.803016229387153e-9,
        -8.964605443101034e-9, 2.5359014971094566e-9, -3.651093559816346e-10,
        1.7221719417612992e-11, 3.8622548668953066e-12, 3.315891318944326e-13,
        3.72873354543105e-14, -7.947210209644404e-13, -8.91097448830376e-13,
      ],
    ];
    const result = wavedec(data, "db35");

    const reconstruction = waverec(result, "db35", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db36", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.505930781174914, 0.9303113017297095, 1.2093050486181662,
      1.3101510418466407, 1.2369322070700746, 1.0274435409438327,
      0.7421133975276711, 0.4479347639123394, 0.20159539457166525,
      0.03614132342155896, -0.0454658896421018, -0.06837553138510143,
      -0.07615697056325532, -0.11611893615471802, -0.22367296659889824,
      -0.4100217508265428, -0.6565755432867428, -0.9177264848489703,
      -1.1314027316316477, -1.2347563842154998, -1.1809503358816253,
      -0.9526629660592608, -0.5687199526055929, -0.08198884734304633,
      0.43110881208483, 0.8869727137210603, 1.2130815896054856,
      1.3636399192324458, 1.3287780621243614, 1.1351067132502548,
      0.837619648753078, 0.5051239143390613, 0.202991983585525,
      -0.022338048204454453, -0.15319970741896505, -0.202476435188173,
      -0.2070526986191198, -0.2148540761782407, -0.26906565781553793,
      -0.3938460227599962, -0.585448458735798, -0.8112282280293645,
      -1.016927757903683, -1.1404339909209484, -1.1284664273288043,
      -0.9518340794153095, -0.6152112228446555, -0.15874883497785303,
      0.34908934529643854, 0.825833646513704, 1.1929894694108256,
      1.393269311818704, 1.402827294045378, 1.2355074962736565,
      0.938138648732697, 0.5781702914221787, 0.2268675410702648,
      -0.05763031216479764, -0.24310543518995212, -0.3287539613179914,
      -0.3421492916319628, -0.32868529819132875, -0.3364671863144192,
      -0.4007920287092907, -0.5324471646199314, -0.7130318308537803,
      -0.8986427024349553, -1.031043371505595, -1.0534398436635197,
      -0.9267302423466481, -0.641915899766555, -0.22530373862362318,
      0.2650442217644878, 0.7509191734715654, 1.1508618797727814,
      1.3982034444117126, 1.4557897780447673, 1.323752298476277,
      1.0384402817168188, 0.6628622820291261, 0.2711212238238151,
      -0.06917892062275893, -0.31210985051771145, -0.44241007102993424,
      -0.47616216582201676, -0.4532058746807246, -0.42348626645787846,
      -0.431100433641379, -0.5003802898451122, -0.6277860838160665,
      -0.7818333514890408, -0.9111402167769981, -0.9585189691365721,
      -0.8774097934604279, -0.6462905501142002, -0.27717044327352136,
      0.18423197547598044, 0.6668984535133617, 1.0895668170858015,
      1.378764270080147, 1.4853564404628328, 1.3954980452927228,
      1.1332720085237826, 0.7543988102852892, 0.33264836082568594,
      -0.05758559863372714, -0.35815257116627164, -0.539251927588874,
      -0.6038476443625576, -0.5834751338232553, -0.526761091815395,
      -0.483856113027414, -0.4910146866010363, -0.5594817897869099,
      -0.6716817222598881, -0.7857576249605913, -0.8472872733259718,
      -0.8050818428126261, -0.6268603511099391, -0.3105756792913258,
      0.11174382033450392, 0.5788591979018625, 1.0128684133341863,
      1.336415563176716, 1.490310232790147, 1.4471613077211025,
      1.2176120140705047, 0.8476209728804763, 0.4074906132070457,
      -0.024580532300247593, -0.3802843110185611, -0.6158927879439413,
      -0.720254484355421, -0.7142555136029052, -0.6421205544040707,
      -0.5570318054630321, -0.5049902175287633, -0.5112597445644622,
      -0.5730169430840135, -0.6601643682496213, -0.7240915380197115,
      -0.7120489225230096, -0.5832910078716389, -0.32263858723411565,
      0.052257699750557385, 0.49206200401871214, 0.9252451499189995,
      1.273692072479704, 1.4705845648105407, 1.476090889795576,
      1.2869112725738001, 0.9372609195584212, 0.4910272427343009,
      0.027061773441009462, -0.378711647864844, -0.6699140945647201,
      -0.8209613360515757, -0.8402639218362083, -0.7647844402027862,
      -0.6475853223976638, -0.5417888168695311, -0.48525965873862015,
      -0.49008314407826004, -0.5396118354718533, -0.5938333571680647,
      -0.60159701456872, -0.5164057741300941, -0.31151032275135737,
      0.009812238684602737, 0.41168638210721714, 0.8316737052983673,
      1.1940771450314736, 1.4272663842299118, 1.4806955671760376,
      1.3373128780933392, 1.0181959982402258, 0.5781982813458619,
      0.09365691649142935, -0.35478614879198833, -0.6999809656461633,
      -0.902288704586272, -0.9564253031579026, -0.8895929647292513,
      -0.7516056359459968, -0.5997593149728422, -0.4825172931084787,
      -0.4263355307985626, -0.42908183166562286, -0.46173394575343235,
      -0.4778382487627186, -0.4281467562562702, -0.276463980837945,
      -0.012388520144576143, 0.34258070082317443, 0.73738884160244,
      1.1018347116556721, 1.3625437546414492, 1.4605208279242499,
      1.3658380824285554, 1.0856959307983909, 0.6637488586770197,
      0.17078882754634717, -0.31093837731651347, -0.7059055251101193,
      -0.9614752118421322, -1.0581162077727786, -1.0112546001370486,
      -0.864500812935344, -0.6761968312906801, -0.5029147590597278,
      -0.3842744568760346, -0.3330473740950577, -0.33308357822011325,
      -0.34551384219068837, -0.32148236259087143, -0.2179305101555398,
      -0.012130196011685912, 0.28902808878577774, 0.6476308887611024,
      1.0018037219705027, 1.2796004552952922, 1.4162709213553504,
      1.370530084944168, 1.135651120961469, 0.7424829260324283,
      0.2535232283907545, -0.2505599595865303, -0.6886550246190571,
      -0.9968096744997628, -1.1413866380447004, -1.1246002647915896,
      -0.9812187490092457, -0.7674729142498464, -0.5451863761344371,
      -0.36532548244581187, -0.25525799862107146, -0.21298771696918944,
      -0.20976676519620796, -0.20026535242424787, -0.13747888796942442,
      0.011704499665371237, 0.25453956124896787, 0.5673929816748717,
      0.8991649242337723, 1.1824626762879358, 1.3497751534933975,
      1.3505486525412556, 1.1647711040409958, 0.8095141629467468,
      0.33664604282810895, -0.17783938721509468, -0.6503043673143296,
      -1.0077126411662154, -1.203149494602651, -1.224831640003669,
    ]);
    const expected = [
      [
        -0.510999182266689, -0.5099797817073629, -0.08840637535947907,
        0.8496416825379183, 1.783489891520896, 1.9753319225760375,
        1.1397414382926883, -0.25298686759991224, -1.3407088265907225,
        -1.572873937062524, -1.1078267786100573, -0.5559231917679852,
        -0.3452110875220601, -0.3356152328107334, -0.047769618739161974,
        0.7413954611050398, 1.6449948837048745, 1.9439921464133707,
        1.2302157526694355, -0.144690781024955, -1.3553887448862154,
        -1.7074341872067078, -1.261776079772569, -0.5637016933195081,
        -0.2062003387811506, -0.1381591628704055, 0.006718478430622071,
        0.6965274024497664, 1.3997388818339191, 2.075605157711848,
        0.9644466592072078, 0.09256700363597234, 0.835124308341506,
        1.7073008170688089, 1.710381413563281, 1.0144475471416854,
        0.2896180229569568, -0.01986754027424633, -0.05998218327741606,
        -0.30515524707425573, -0.9601251477726693, -1.6421841357542768,
        -1.6838254383655051, -0.7810669297762499, 0.6409192858684523,
        1.7182110819154375, 1.846125172818283, 1.1463003279287265,
        0.28255747084058597, -0.17820956444942287, -0.24219090749990355,
        -0.360419906173621, -0.8533598262189939, -1.4830251612974552,
        -1.6187690896339995, -0.8536610643710308, 0.5269916901941325,
        1.698825635352901, 1.9582268185565241, 1.287214410725865,
        0.30783257358345506, -0.31275179129538644, -0.43234838740440806,
        -0.447472663624964, -0.7709075140669799, -1.3164536529718063,
        -1.5210636964093527, -0.8995002580909711, 0.4081689577421367,
        1.6474149524561807, 2.0416513633009687, 1.429864626962178,
        0.36288914318145554, -0.41878943853325706, -0.6230280662830054,
        -0.5633387357754488, -0.7171129923414165, -1.1499222538219371,
        -1.394058434898879, -0.9146013442266567, 0.29188999809822086,
        1.5676510311827065, 2.092734885624583, 1.5667956250363393,
        0.4437067901544639, -0.49299966661266625, -0.8067626392876567,
        -0.7036195302842626, -0.6948934406126478, -0.9908352750840926,
        -1.2424807256466728, -0.8964515785786819, 0.1854550343270526,
        1.4645334033061232, 2.10932198572192, 1.6907811729757072,
        0.5449934522379625, -0.5336002237977159, -0.9764022483935025,
        -0.8627035147991577, -0.7055977754161997, -0.8461927289720216,
        -1.0722096880840535, -0.8441309000920617, 0.09567295219998044,
        1.3441476273940645, 2.090869315896043, 1.7951724659552704,
        0.6604411596427815, -0.5404339270537911, -1.1254574090378673,
        -1.0340354994780725, -0.7489415141943095, -0.7222538564846847,
        -0.8899941795166963, -0.7583575316414144, 0.02853231329892082,
        1.2133715325509509, 2.038471548550357, 1.8742186721568868,
        0.7830307245799604, -0.5149749131098156, -1.2484101621776211,
        -1.210431371745695, -0.8230203003074351, -0.6242363463560057,
        -0.7031289903044543, -0.6414547249606016, -0.011088130941853661,
        1.0795433538189436, 1.9548085318229058, 1.9233442867637098,
        0.9053706877068555, -0.4602563597359425, -1.3409784752918692,
        -1.3844231316495723, -0.9244014485220092, -0.5560656887876936,
        -0.5191048436053988, -0.49724033988860805, -0.019654193789869642,
        0.9501013910360948, 1.8440382710495, 1.9393080845819408,
        1.0202000588861448, -0.3810196251594848, -1.3997947375602589,
        -1.5494406684759823, -1.0471505445925873, -0.5215867568150916,
        -0.3437009359386789, -0.33244895622630344, 0.006618765941610112,
        0.8296841190255058, 1.7166011175992164, 1.9090070525611968,
        1.1466689689452585, -0.33912955931422545, -1.3237017589082376,
        -1.7594104155370425, -1.7406266951257676, -0.9001612688866545,
        0.5083445334324423,
      ],
      [
        3.041594421545697e-5, 0.001698200026830222, 0.01704942020404225,
        0.025170987349684457, -0.06185163173337458, 0.008259006258439353,
        0.032293907827187864, -0.04849441945830862, 0.04989107035575527,
        -0.043907426887830704, 0.034531685947155846, -0.02411880034343636,
        0.0144229471032524, -0.006743437170994386, 0.001710912004547191,
        0.0008120648262648077, -0.0015250266496976094, 0.0012908850433861205,
        -0.0007882515900606717, 0.0003731820521738873, -0.0001359048667233014,
        3.4854889391792976e-5, -3.875962869861566e-6, -1.563734104487928e-6,
        1.0897506221032554e-6, -3.5493523695236303e-7, 7.126127363491545e-8,
        -7.375336783146497e-9, -3.5488875425158506e-10, 2.5242147592247864e-10,
        -3.564674735981695e-11, 2.895529181398143e-12, 2.0367987691722498e-13,
        -1.114014218195981e-12, -1.2178192588338385e-12,
        -1.5449798039714394e-13, 1.0586383150447988e-12, 1.247005991080006e-12,
        2.27418571871548e-13, -1.0110583124381973e-12, -1.2730661447842867e-12,
        -3.0143293730162235e-13, 9.637095213622302e-13, 1.292197608141894e-12,
        3.7182652307279646e-13, -9.091994386060561e-13, -1.3104078025107672e-12,
        -4.3917386840279316e-13, 8.55792399172526e-13, 1.3224589561950975e-12,
        5.102584718435632e-13, -7.989799063381382e-13, -1.3314794184510028e-12,
        -5.762305969615523e-13, 7.366062229044384e-13, 1.3365955527640931e-12,
        6.41721258615285e-13, -6.738405391059932e-13, -1.3362616829678786e-12,
        -7.04872656745899e-13, 6.090110712987592e-13, 1.3344879443520933e-12,
        7.655242852149065e-13, -5.432985538663818e-13, -1.3262004292223426e-12,
        -8.2729931854779e-13, 4.764753276237592e-13, 1.3186296297199128e-12,
        8.82342644011756e-13, -4.0823866240559955e-13, -1.3022340389904311e-12,
        -9.364653044152e-13, 3.35380981090629e-13, 1.2835760405500494e-12,
        9.84502504505485e-13, -2.648176849082487e-13, -1.255254757386743e-12,
        -1.0328276939083565e-12, 1.8917514435494192e-13, 1.2294657447708554e-12,
        1.0772433030791678e-12, -1.2116673867201394e-13,
        -1.2006056009406362e-12, -1.121078138866627e-12, 4.5785053721816665e-14,
        1.165127977974862e-12, 1.1580136243432987e-12, 2.84912502526308e-14,
        -1.132310401049778e-12, -1.1943401729033527e-12,
        -1.0136547246410006e-13, 1.0902194974375644e-12, 1.2290732382035074e-12,
        1.7465542857769592e-13, -1.048143553954872e-12, -1.2553978373595504e-12,
        -2.4834363230082165e-13, 1.0001729921421104e-12, 1.279417331950535e-12,
        3.1773011133679843e-13, -9.506168632083175e-13, -1.2990493230629607e-12,
        -3.938989309465209e-13, 8.947026385144293e-13, 1.308590334311505e-12,
        4.537351049965181e-13, -8.374616978753338e-13, -1.3196426718041767e-12,
        -5.282050091254072e-13, 7.792386664170064e-13, 1.32819550336821e-12,
        5.932709146254328e-13, -7.160895439576909e-13, -1.3311268773230473e-12,
        -6.570024147797251e-13, 6.517564085929392e-13, 1.3349597378297099e-12,
        7.211262082209733e-13, -5.886051744470212e-13, -1.3380809208615498e-12,
        -7.844001691948826e-13, 5.259739605743694e-13, 1.3258152469827852e-12,
        8.442654242071068e-13, -4.600313958572796e-13, -1.315394339202377e-12,
        -9.010202985660286e-13, 3.878831368403843e-13, -7.80291753379811e-6,
        -0.0004452318162475874, -0.004567333647281919, -0.006956818587707196,
        0.01687770946661976, -0.002177038447673851, -0.009117045688629788,
        0.013729483394470965, -0.014193267850263836, 0.01253272648875287,
        -0.009859063789267626, 0.006852731203495577, -0.004039796464783181,
        0.0018173964029531138, -0.0003790449803230257, -0.0003182680532267636,
        0.0004888420090266503, -0.0003933401789112359, 0.0002322572574057302,
        -0.0001063600864799436, 3.710199822482982e-5, -8.79590385297699e-6,
        6.346296162106118e-7, 5.698762560138512e-7, -3.258847243218368e-7,
        9.815769093415073e-8, -1.8299736257902915e-8, 1.6219474768605225e-9,
        1.5403451330657803e-10, -7.139007568570748e-11, 7.987095446641611e-12,
        -7.957867218871471e-13, 8.34013939591251e-13, 1.3266539956432685e-12,
        4.962101632735016e-13,
      ],
    ];
    const result = wavedec(data, "db36");

    const reconstruction = waverec(result, "db36", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db36_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5015283088196183, 0.9227921053301829, 1.2009314269373939,
      1.303632121369452, 1.2348235892850348, 1.0316410385891939,
      0.7535694833848917, 0.46665076706001407, 0.22685139399255577,
      0.06684836929544424, -0.010444691575507592, -0.030073847179802264,
      -0.03559824993809557, -0.07463274161002864, -0.18331800758218175,
      -0.3739346583997442, -0.6290555421610551, -0.9039209594312032,
      -1.136566152032232, -1.2631869005194991, -1.2348265782820342,
      -1.0310712376309363, -0.6671541666090341, -0.19251751232148362,
      0.3189644069898453, 0.7847800779265668, 1.131742773192193,
      1.311714144810219, 1.311249476143025, 1.152864782170419,
      0.8877459368507234, 0.5818765234520245, 0.29920207713684854,
      0.08615491590666685, -0.038542290698714066, -0.08628643014645354,
      -0.09275770939917617, -0.10553341007742084, -0.1685539548586697,
      -0.30765962381842604, -0.5211316610161386, -0.7778601614749301,
      -1.0237621626219775, -1.1949037755539293, -1.2340015750874311,
      -1.1060522365251921, -0.8090077691045632, -0.3766370476704517,
      0.1273187833044088, 0.6223824448819958, 1.0287723494344447,
      1.2847616405074858, 1.3597076155821561, 1.2595880943521824,
      1.0237763650649856, 0.7139974766168102, 0.39836956235725157,
      0.13464321893561243, -0.04309788297310996, -0.13095590961445264,
      -0.15342952740871235, -0.153963303799832, -0.18047859062342764,
      -0.26983003790593757, -0.4354032636704799, -0.6612410404299089,
      -0.9043721595330292, -1.1048621225259163, -1.201065670206458,
      -1.1461662782769027, -0.9216999457560995, -0.5444834849588172,
      -0.06501855583084801, 0.4424000471595667, 0.8955327436126376,
      1.2221387891521507, 1.3756110581259153, 1.3444745748162716,
      1.1534702438703188, 0.8560695683116551, 0.5204218567375041,
      0.2123708889503521, -0.020124123269727734, -0.15724406413799183,
      -0.20974121446759222, -0.21309859957953428, -0.2151260260136747,
      -0.2604042560444868, -0.37579876140792645, -0.5609732417366369,
      -0.7865166322800149, -1.00029653154517, -1.1404846666528654,
      -1.1519274481501247, -1.0016168482024002, -0.6891938338344392,
      -0.24964647690671016, 0.25266571924649306, 0.737325138486978,
      1.1252967681519583, 1.3562239296831218, 1.4013298917905956,
      1.2687798257980558, 1.000259224098325, 0.6597376866275861,
      0.3173444502041686, 0.032483876198201256, -0.1595403083024035,
      -0.2540764181661669, -0.27533451874661996, -0.2669146781394094,
      -0.2773083206712493, -0.3443237311511575, -0.4826514960733702,
      -0.6779513101980863, -0.889124661125854, -1.05828298026908,
      -1.1258858621140653, -1.0471363949019807, -0.8053415089800997,
      -0.4186758440829394, 0.06155673934946912, 0.5609126179132364,
      0.9976918134521313, 1.3008451808731416, 1.4255038053665425,
      1.3623168920142543, 1.1383418171292325, 0.8093584284499294,
      0.44563427622527596, 0.11479708634456737, -0.13384032871841733,
      -0.27958301019404164, -0.3327918084702773, -0.3290215145547247,
      -0.3165814098042086, -0.340939953841193, -0.4301992732025114,
      -0.5855671174635668, -0.7794322396679138, -0.9616463468445952,
      -1.0724504950791443, -1.0587170168619784, -0.8892683682154945,
      -0.5652196129796961, -0.12252739933330269, 0.3741000069983642,
      0.8445750813461386, 1.2108623945830905, 1.4141939453501005,
      1.4278282315950002, 1.26222644074536, 0.9614271406351913,
      0.5916149807537848, 0.22483260176235503, -0.07802103734411037,
      -0.2806320046868652, -0.377841226271884, -0.393836833219968,
      -0.3726436110966516, -0.36357706405022505, -0.40562117781653456,
      -0.514946989374215, -0.6789483919265826, -0.8584507925263849,
      -0.9975931794233593, -1.0388530610214501, -0.9393032156501524,
      -0.683818421617633, -0.291688352465793, 0.18524722720791637,
      0.6726677834240302, 1.0896721491409385, 1.3666317675495128,
      1.4605992386216957, 1.3644732272554454, 1.1076864726989004,
      0.7483158442725462, 0.3586665348028698, 0.008005935098527872,
      -0.2531976846515869, -0.403612185972258, -0.4534702311982568,
      -0.4386687258641469, -0.40827601995274654, -0.4088800053767032,
      -0.47000807903837544, -0.5945450860826813, -0.7567482287858139,
      -0.9084528838026202, -0.9918997894504118, -0.9558527788467026,
      -0.7707743591324251, -0.4390198079921745, 0.00274742507159334,
      0.4897424499675127, 0.942472020789604, 1.2841386923960076,
      1.457759639904951, 1.438769924984992, 1.2400034324484221,
      0.9078587686954102, 0.5106725610340361, 0.12227216198710333,
      -0.19513438586311277, -0.40445274181246915, -0.5002751174977711,
      -0.5070380424054349, -0.46945511207227253, -0.4379063456078444,
      -0.4527523811186011, -0.5317929390223329, -0.6642418208775693,
      -0.8128657979766197, -0.9237793046799962, -0.9413593770381785,
      -0.8243715037877981, -0.5590343655387309, -0.1654966013434819,
      0.30413721691110374, 0.7759375683652097, 1.1700487821782213,
      1.4184716614767185, 1.4803370633272932, 1.3508872584377696,
      1.0619556138359316, 0.6738708217019129, 0.26086325415930717,
      -0.1063320411366484, -0.3763112194230899, -0.5273579295375623,
      -0.5698458020538757, -0.5402813362411085, -0.48874008331487545,
      -0.46314181440440394, -0.4946019839929032, -0.5877849322032629,
      -0.7188515216120435, -0.8415863939292721, -0.9001280774904954,
      -0.844969110585738, -0.6479990092633949, -0.31256404638045954,
      0.12423434013094198, 0.5978050435275836, 1.0295029002601948,
      1.343988505079251, 1.486235627602847, 1.4339670837092766,
      1.2024329421198725, 0.8403647809271972, 0.4181555393095918,
      0.011259606087541563, -0.31701484605809793,
    ]);
    const expected = [
      [
        -0.26631924815869173, -0.22798687395195427, 0.18782440404816006,
        1.0444765047437194, 1.8174058419775279, 1.820602221822237,
        0.8521769584851545, -0.5589456378684974, -1.5565924010579801,
        -1.6501562074438705, -1.0637969314709992, -0.4379844457562083,
        -0.19258947015141084, -0.1703477101982294, 0.10811282253451758,
        0.8516599984916562, 1.670178513254023, 1.869890121655974,
        1.0858220345373755, -0.29977183835061083, -1.4649126216669965,
        -1.7476329353794982, -1.2436159065717431, -0.5145155864534584,
        -0.14837889640726054, -0.08384470473053057, 0.05092058459403879,
        0.722748119531453, 1.4062272512972975, 2.064420183740275,
        0.9576045880798297, 0.09180853254083109, 0.8273371990240167,
        1.6952671325021784, 1.7077240727880623, 1.0307440807207169,
        0.32483084186660943, 0.02910267530329485, -0.0022682810125827938,
        -0.2465493454606534, -0.9194232604814544, -1.6488143740555794,
        -1.760895556634157, -0.9217289861764958, 0.4816907824102872,
        1.6036879092482998, 1.8217985075251093, 1.2161781125753834,
        0.4161904804790716, -0.01801862843505325, -0.07994827082829971,
        -0.21492707589203228, -0.7585171168231746, -1.4910132975063086,
        -1.769343911664828, -1.1302226137775595, 0.21227168238360622,
        1.4675441013144583, 1.8982564291556432, 1.4068643244795684,
        0.5462982493923153, -0.033642871704344414, -0.1653096313794295,
        -0.2220955515993042, -0.6273954996451016, -1.321199160906449,
        -1.7311834361921994, -1.298915146709507, -0.06078632786143068,
        1.2873053713213523, 1.930025588503748, 1.5912892983636524,
        0.7102147855112507, -0.011555214107883797, -0.24724260477975665,
        -0.26304677731739895, -0.5322141619401138, -1.1508793752281796,
        -1.6521557861444274, -1.4220793056260235, -0.3255380240600259,
        1.0699189509978566, 1.9126039827920995, 1.757967436893762,
        0.9005171758273197, 0.05187316748361145, -0.3148260354093061,
        -0.33038389762586856, -0.476475359669331, -0.9912175700473668,
        -1.5403193841103844, -1.4967492665021664, -0.5705924758626617,
        0.8245200233693477, 1.8443222995692308, 1.8961786548419357,
        1.107762896510417, 0.15742898296781335, -0.3580555802359619,
        -0.41481857776814257, -0.46081407021711185, -0.852314020977614,
        -1.405517414427874, -1.522889501948614, -0.7858212050968265,
        0.5618652520991027, 1.7264638052495263, 1.9966584666135965,
        1.3210851982303322, 0.30298450570871005, -0.3685129280123971,
        -0.505791011577433, -0.482970259522412, -0.7425562122702641,
        -1.2587323768327414, -1.5033758301233755, -0.9629850953766987,
        0.2936627334562991, 1.5631955855296167, 2.0521960439699387,
        1.5288816638857046, 0.4836137743801538, -0.33993283263072527,
        -0.5921725437654688, -0.5379489247509109, -0.6680813402552529,
        -1.1113688033140527, -1.443789985798237, -1.096239806023619,
        0.031841407100883685, 1.361315502592174, 2.058101735167412,
        1.7195516601221787, 0.6918899314852835, -0.26863134430138,
        -0.6630055709220054, -0.6183575655821949, -0.6323852077914316,
        -0.97451100810414, -1.3520387694260252, -1.1824934860887255,
        -0.21217979749732754, 1.1298108568817335, 2.012524574480434,
        1.8822934715745907, 0.9180745257221319, -0.15301185641978896,
        -0.7099134543610378, -0.7116853038974233, -0.6415972427225938,
        -0.849589280991444, -1.2504661120732834, -1.2039113852809564,
        -0.4520384686239036, 0.9103179887305559, 1.8790170283916647,
        2.043320943562246, 1.1546451349778275, -0.15136373517007176,
        -0.3190534043707011, 0.6312829452550218, 1.7323004580840033,
        2.101741776961153,
      ],
      [
        3.0149620769890656e-5, 0.0016831506576382156, 0.016896519846558353,
        0.024941314290065145, -0.06129125585618313, 0.008185565163639573,
        0.03199576242889915, -0.048045987909512596, 0.049428472753553075,
        -0.043499547534401536, 0.034210854821535616, -0.023895320036722414,
        0.014290362591343494, -0.00668274492034913, 0.001697004216689717,
        0.0008029501733695802, -0.0015098869855215862, 0.00127844090206369,
        -0.0007807964198216525, 0.000369717594230504, -0.00013467268843722114,
        3.4551907847307755e-5, -3.848509110691874e-6, -1.5469506769517084e-6,
        1.0793488029813971e-6, -3.5169267693672994e-7, 7.06360593053694e-8,
        -7.315555313280923e-9, -3.5054282531765616e-10, 2.5004650837086664e-10,
        -3.545841273024462e-11, 2.803125707891824e-12, 2.6037088043018504e-13,
        -9.751890282882831e-13, -1.1385759725021515e-12, -2.144425973248618e-13,
        9.146790183209646e-13, 1.1623217530970269e-12, 2.926836935315932e-13,
        -8.627037790732935e-13, -1.1870272560785491e-12, -3.652829063285597e-13,
        8.055767516646575e-13, 1.1981703410239584e-12, 4.3862267175674915e-13,
        -7.465033106009149e-13, -1.2121677504652925e-12, -5.114556929623245e-13,
        6.83210019417926e-13, 1.2185386453957392e-12, 5.799199918366402e-13,
        -6.167758752967929e-13, -1.2182179353449375e-12, -6.462445612185522e-13,
        5.478312986523857e-13, 1.2174682282848892e-12, 7.121757656498672e-13,
        -4.800845116485459e-13, -1.208242171116278e-12, -7.731689655012574e-13,
        4.0622684697698724e-13, 1.192794341467232e-12, 8.316206301547154e-13,
        -3.328083257651012e-13, -1.1753873094516857e-12, -8.83425220110954e-13,
        2.6015507739568364e-13, 1.1520613983626602e-12, 9.41400914603002e-13,
        -1.7833104627956833e-13, -1.125376981033278e-12, -9.840953065082233e-13,
        1.0282106162467478e-13, 1.090907831202341e-12, 1.0318109845256703e-12,
        -2.6791528644460722e-14, -1.0537742926553132e-12,
        -1.070817545320439e-12, -5.504629300540949e-14, 1.0182884294895658e-12,
        1.1037460672356996e-12, 1.3009501981938628e-13, -9.733638759199236e-13,
        -1.1373701796707348e-12, -2.0617345616057747e-13, 9.206996328130522e-13,
        1.1624531945286461e-12, 2.779836486305818e-13, -8.73536740274235e-13,
        -1.180452889208819e-12, -3.5876669387019035e-13, 8.120714209970498e-13,
        1.1988227319377648e-12, 4.269554472235386e-13, -7.544537708275711e-13,
        -1.215571048369418e-12, -5.010640323363994e-13, 6.919842006312884e-13,
        1.213392233484176e-12, 5.698024824424086e-13, -6.285962599209867e-13,
        -1.2211745341103006e-12, -6.366837055625946e-13, 5.584366221598261e-13,
        1.2195439611093072e-12, 7.012670259187281e-13, -4.873550376591812e-13,
        -1.2021502581597811e-12, -7.654780258033555e-13, 4.1813572174007785e-13,
        1.196047378787909e-12, 8.265847559919254e-13, -3.3844365062389664e-13,
        -1.1798279252942794e-12, -8.768773505718318e-13, 2.6722200018621564e-13,
        1.1556658254568566e-12, 9.33777058881677e-13, -1.8848973287763687e-13,
        -1.1272445850528328e-12, -9.802487279812353e-13, 1.1198169572209596e-13,
        1.0983706199055794e-12, 1.0228911274651565e-12, -3.255637037472498e-14,
        -1.058665511328071e-12, -1.0647557053840414e-12, -6.080700122023992e-7,
        -0.00012109111662179794, -0.002666008951020837, -0.011671585933187172,
        0.004791743208866457, 0.025440536219698016, -0.028849588218227876,
        0.02243917716258615, -0.01619168884487007, 0.012312643759995094,
        -0.010287856720251879, 0.009101777452261813, -0.007967685883623173,
        0.006530726119188038, -0.004835454447072824, 0.003152381568486813,
        -0.0017634404583383462, 0.000814010747487001, -0.0002843916099335036,
        5.34528617375715e-5, 1.5384118207050577e-5, -2.0303655179151365e-5,
        1.1029629446134674e-5, -4.035872445919697e-6, 1.0274138785380023e-6,
        -1.543452044138461e-7, -2.5236114041294223e-9, 8.440554730871578e-9,
        -2.3647151835724666e-9, 3.3049781292919623e-10, -1.6556817013896654e-11,
        -2.4617931517584833e-12, 1.4406778176683564e-12, 1.0741676334328461e-12,
        8.94568520100006e-14, -9.92849097618219e-13,
      ],
    ];
    const result = wavedec(data, "db36");

    const reconstruction = waverec(result, "db36", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db37", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5015728005000193, 0.9277979430925221, 1.2181317447453537,
      1.3383349159040414, 1.2861372856818887, 1.0898947888350685,
      0.8006934254498217, 0.4798636541384292, 0.18490357150446018,
      -0.04287221212714426, -0.1861104684876747, -0.25291776426764295,
      -0.27191060148863644, -0.28221274266101404, -0.3210113789534123,
      -0.41186119452641634, -0.5567266504232765, -0.7338267912420853,
      -0.901916808810506, -1.010050732445059, -1.0105029157789098,
      -0.8717125483770203, -0.5880534652799088, -0.18393986087954592,
      0.288908260441204, 0.7606083575929283, 1.156715241933518,
      1.4132540137410494, 1.4897961942411742, 1.377617173814202,
      1.1010960517487656, 0.7120727242331972, 0.2784953651778393,
      -0.13000721092562156, -0.45631536986294946, -0.6665600140934527,
      -0.75506020407576, -0.7425039537088229, -0.6680324985746622,
      -0.5773281349976417, -0.5097296745071958, -0.487589448628445,
      -0.51049935883245, -0.5557942148967387, -0.5851833753276499,
      -0.5558420610078094, -0.4331781148417499, -0.20204811674511286,
      0.12646299868309963, 0.5145413426394208, 0.9037662832184931,
      1.2266025467722816, 1.420696506751787, 1.4426973882436114,
      1.2783830859487917, 0.9466916204527372, 0.49665140535692176,
      -0.002161070843345214, -0.4735145954005743, -0.8496479216859616,
      -1.0842379271014502, -1.1603472672838748, -1.0916779449292318,
      -0.9170307761235297, -0.6894539463742757, -0.4627818870950134,
      -0.27883163563204494, -0.15830676932101423, -0.09751498255426505,
      -0.07156374550112164, -0.04310688953299738, 0.025643799632698527,
      0.16072738843872875, 0.36719652374318396, 0.6252524975774147,
      0.8928639864294672, 1.1143952306624987, 1.2332861838189206,
      1.2058034639836464, 1.0125649408115338, 0.6650121592290823,
      0.20515540613737565, -0.3015243798952134, -0.7785330476504388,
      -1.1534354505273612, -1.372175302186943, -1.4094395120655077,
      -1.272776381148005, -0.9996227690088825, -0.6480327123396135,
      -0.2833424436048522, 0.036085324200472335, 0.27073370862097373,
      0.4067360872789491, 0.4561773662788008, 0.45103481685089986,
      0.43242987244648967, 0.4379762954340123, 0.49044419733027916,
      0.5906114601387371, 0.7161295484246433, 0.8267418399332609,
      0.8746182972190434, 0.8172901283774918, 0.62999153894312,
      0.3143080910324879, -0.09912597636226766, -0.5547440852753738,
      -0.9822235873821975, -1.3105153174932136, -1.4825772460743138,
      -1.4674572838160092, -1.2669530672226386, -0.9153124512044616,
      -0.4720368932383885, -0.009434206271518808, 0.402236113380402,
      0.7086539713319762, 0.881258809995064, 0.9208812572231339,
      0.8545474156456466, 0.7264316802425117, 0.5853008063669878,
      0.4715870291376453, 0.40726477540260014, 0.39097884416828965,
      0.3995592529841897, 0.39547652300719294, 0.3383222030860434,
      0.19739687078727564, -0.0378062360332293, -0.3519471561183269,
      -0.7045874686606663, -1.037370216513304, -1.2860955696408456,
      -1.3949446551025753, -1.329537947677108, -1.085732991796918,
      -0.6920211980803319, -0.2048517094611919, 0.30215403238013394,
      0.7527166803319949, 1.0828991040290825, 1.2532437792336908,
      1.2553757435992132, 1.111697245086798, 0.8684112539810771,
      0.5836537770356178, 0.3136250227358363, 0.10002627545865933,
      -0.0382622164367028, -0.10739406923851202, -0.13429618992132897,
      -0.15714996345782944, -0.21310472287689564, -0.3263798660600193,
      -0.4998091503012715, -0.712034428524629, -0.9211699636644639,
      -1.07416571621656, -1.1196819205202535, -1.0213895299886597,
      -0.7684500624435209, -0.38054665688055883, 0.09390776297542433,
      0.5861651901863023, 1.020363600975553, 1.3286488622934653,
      1.4648041855116816, 1.413319867503931, 1.191880305848801,
      0.8467618467718284, 0.44226615301308103, 0.04667482633589515,
      -0.28201812741055676, -0.5073383321272231, -0.620035177304566,
      -0.6371118512552556, -0.5946392466253688, -0.536290524884175,
      -0.5005342580640094, -0.5097102182597761, -0.563717244681206,
      -0.6398883738390825, -0.6990936395451942, -0.6965657783092002,
      -0.5947611865353442, -0.3750339249414234, -0.04514530856431542,
      0.3593999571395458, 0.7807371544702328, 1.1496811042909678,
      1.399986922649262, 1.4825918068629682, 1.376553496900627,
      1.0941319209726343, 0.6787962525933154, 0.19656608078638957,
      -0.27737081847179323, -0.6737422100942632, -0.942583681758055,
      -1.0619698380862106, -1.0402300740008723, -0.9113357355095636,
      -0.7247459232814158, -0.5322793789055307, -0.3752375505383336,
      -0.27488594956841483, -0.22853955859722802, -0.21210300849720373,
      -0.18832428932981043, -0.11861519749431015, 0.024589274358788882,
      0.24810461500616876, 0.5334474848049986, 0.8387567647156384,
      1.1069044810339077, 1.277996483046632, 1.3033627090116182,
      1.15772249362268, 0.8465846642635808, 0.40702025558321253,
      -0.09852532475168871, -0.5940947826056457, -1.0051441452992749,
      -1.2731999550593538, -1.3669766827166308, -1.2875056360334973,
      -1.0662190292834555, -0.7565652106703206, -0.42121754731226796,
      -0.1179297506462656, 0.11264728798093354, 0.25439600462923384,
      0.3168000802121544, 0.32959330982770174, 0.3324857509969255,
      0.3626437988464401, 0.44312683397426667, 0.5752300461731663,
      0.736713062225429, 0.8864410981032141, 0.9743794260097982,
      0.9545451490067591, 0.7977556155377163, 0.5010068295278373,
      0.09107323241639395, -0.3787352124369851, -0.8381097825851738,
      -1.2135266629207675, -1.4432042683403987, -1.48985211072385,
      -1.3483133787794381, -1.0463683914311726, -0.6385378040016021,
    ]);
    const expected = [
      [
        -1.3883342200915645, -1.6645178086771997, -1.1123675053154216,
        0.1542303367104708, 1.4601360029885282, 2.0451335643907838,
        1.6303767021452427, 0.5994953131323738, -0.3486976468308037,
        -0.7635530878789084, -0.7345801285701363, -0.6817025881626512,
        -0.8681813295801808, -1.104015782104936, -0.922588864430371,
        -0.07109669207634703, 1.1474105808714972, 2.013601185307077,
        1.9385129464860509, 0.9272056497730861, -0.3891809841800847,
        -1.2686453418232275, -1.3701896171841843, -0.9590561857285322,
        -0.5650150898788147, -0.4251219226154919, -0.3988241305211684,
        -0.014401643316568603, 0.7965607030137557, 1.577362310922473,
        2.0761679044607178, 0.819477948523897, 0.10829307678180179,
        0.926785313681932, 1.7690440425537395, 1.7487192719665523,
        1.0193241672270374, 0.19488572587286282, -0.2522523266377971,
        -0.3429305042152282, -0.4541779868418118, -0.8525359137166854,
        -1.3522800147642242, -1.4338513042988719, -0.7297935887769835,
        0.5631733132033486, 1.7386228045577972, 2.0867979303330206,
        1.4344728665249005, 0.2612942882517671, -0.7007832206735026,
        -1.0340625196113664, -0.8848115797674161, -0.7072224094508051,
        -0.7662529789815491, -0.8703775054963634, -0.5822130782418642,
        0.2927584407565914, 1.4046956966436883, 2.0511346759768077,
        1.7242424857217806, 0.5460454652097136, -0.7929908995048542,
        -1.5504210264904967, -1.4690097733173675, -0.8890173103195352,
        -0.3681026497129133, -0.1707206070777079, -0.08783625691423386,
        0.2673286990663916, 0.9831026248647478, 1.6560274599585236,
        1.6857667910904444, 0.8125722492396573, -0.5844046730332755,
        -1.713802387019665, -1.952250649557091, -1.2941171705197596,
        -0.2981509062409676, 0.40474587474881873, 0.6036993175150268,
        0.5792883707434197, 0.723176599692356, 1.0831603347131389,
        1.2707010162918393, 0.8277766337948532, -0.28108396965558025,
        -1.5156137056524268, -2.116885762622292, -1.6901981344537256,
        -0.518479180658578, 0.6634513185218162, 1.2391878220994408,
        1.1390704228002484, 0.7773528038293215, 0.5897015499240985,
        0.6112985890626896, 0.48263083859813405, -0.13269977386321333,
        -1.1195761147924386, -1.8920882883640113, -1.8350340677031762,
        -0.8338327384819029, 0.5762293152936817, 1.5882978008405428,
        1.7190991433310505, 1.1232727595016876, 0.3784127696194422,
        -0.045020602117243874, -0.1501713059925537, -0.3035612985169876,
        -0.7771427407303367, -1.3895484397570783, -1.6004688016625244,
        -0.9926756208425245, 0.28985058328069796, 1.5585191759412083,
        2.068134728285765, 1.5750275731002306, 0.49571222116462155,
        -0.45940885907640266, -0.8508515383884634, -0.7871568794556552,
        -0.6986323437283863, -0.8467884813148787, -1.0387413927059825,
        -0.8170165312959801, 0.050171506689438754, 1.2402651776884928,
        2.037938587523528, 1.8778310173969412, 0.8094540338351666,
        -0.5208179704780767, -1.3619276744061353, -1.40766857553215,
        -0.9455706680017135, -0.5068932987183473, -0.35744251429238205,
        -0.295005622064955, 0.07499198193085592, 0.8592560075669595,
        1.6579446816835508, 1.8379794135110663, 1.0777971946349687,
        -0.30045866455435416, -1.5162944778572516, -1.9086199463689224,
        -1.3976805465966577, -0.49721866975058565, 0.1854017892416645,
        0.4106741753132974, 0.43929993327371025, 0.6653343607903212,
        1.1119070896690106, 1.4320212353003838, 1.0670645523330655,
        -0.021921826740677098, -1.267041611184396, -2.238819124136922,
        -1.4830024777930826, -1.0021083074059929, -1.6655990182984666,
        -2.121356489641886, -1.6078625786255447,
      ],
      [
        2.1899177419175222e-5, 0.001309919728290833, 0.014468645044081114,
        0.027296325729805795, -0.051859629460537016, -0.010769736928573309,
        0.049740812054286376, -0.06146883885448914, 0.05967193726975675,
        -0.0524851516255116, 0.043178971341085996, -0.0330634345242411,
        0.023075772738512124, -0.014205507817972111, 0.007298425345618638,
        -0.0027338480039730433, 0.00030968961161528965, 0.0005849584501223895,
        -0.0006531228155843127, 0.0004337682286086106, -0.00021380143645737549,
        8.052023560387111e-5, -2.1971187703781504e-5, 3.300750691437601e-6,
        4.2997890402126543e-7, -4.657322493031264e-7, 1.629268230878697e-7,
        -3.403799778012314e-8, 3.8424728399028246e-9, 5.52711740733623e-11,
        -9.775515884434367e-11, 1.5197245961601956e-11, -8.067264498207616e-13,
        -1.9362384361554373e-13, -1.1223985248904872e-13, 2.06294747590816e-14,
        1.4197516102217297e-13, 1.324761783938029e-13, 5.949092180048559e-15,
        -1.2645332129055053e-13, -1.4780988893170743e-13,
        -3.363746266082001e-14, 1.0965750809080107e-13, 1.5373855336019372e-13,
        6.086451392712238e-14, -8.515305329013356e-14, -1.5831328146376178e-13,
        -8.774004831048575e-14, 6.188442163333738e-14, 1.499995325845591e-13,
        1.0973988005426734e-13, -3.175303154270923e-14, -1.4761283225148823e-13,
        -1.2613927103441005e-13, 5.848393222858632e-15, 1.3420142581616543e-13,
        1.4110189074527446e-13, 2.4623943934847874e-14, -1.192610559213579e-13,
        -1.5109331383708484e-13, -4.9126744386382336e-14, 9.471080079239252e-14,
        1.5821952334495133e-13, 7.634402846703248e-14, -7.645715415108301e-14,
        -1.5402261450090224e-13, -1.0033588853132578e-13, 4.438655081610634e-14,
        1.5042440352846153e-13, 1.2534959643738047e-13, -1.5506172421355102e-14,
        -1.408635267347945e-13, -1.3537467606239892e-13, -2.926114880093272e-15,
        1.2444343040988263e-13, 1.4223950290571328e-13, 3.938521267407233e-14,
        -1.044092200598101e-13, -1.554906854169349e-13, -6.514027120206085e-14,
        8.467914934451222e-14, 1.5845033701401366e-13, 8.840586120660555e-14,
        -5.2843508555601846e-14, -1.5550757319544917e-13,
        -1.1673247499384238e-13, 2.4150635026880236e-14, 1.446685305781433e-13,
        1.3195832878110374e-13, -7.066915799860577e-15, -1.3184740810133127e-13,
        -1.4183801387562193e-13, -2.8871648774581104e-14,
        1.1045384534708515e-13, 1.5352041814087397e-13, 5.3182491303181283e-14,
        -9.326382255831384e-14, -1.5661830410454262e-13, -7.520988875289516e-14,
        6.892114346845773e-14, 1.5506675137663915e-13, 1.0620881182196648e-13,
        -3.895181581385673e-14, -1.531744281789941e-13, -1.2520813473996852e-13,
        1.5004451454047738e-14, 1.3468090168246035e-13, 1.3896593995151478e-13,
        1.7456770299901686e-14, -1.1886806057981097e-13,
        -1.5013892276048646e-13, -4.489119082695201e-14, 1.0108045822518494e-13,
        1.5340610389252112e-13, 6.769204026010613e-14, -7.694099375193735e-14,
        -1.5407889975344937e-13, -9.26802133307971e-14, 5.0187912762938225e-14,
        1.5394157836381743e-13, 1.1473492097260535e-13, -3.1186967201023974e-14,
        -1.4449303989521833e-13, -1.320768873071798e-13, -3.708988166954564e-15,
        1.3273159269703275e-13, 1.4732701374389204e-13, 2.6974404971344858e-14,
        -1.9400887918059425e-5, -0.0011612375773286483, -0.012834774046021537,
        -0.02423514126076025, 0.04602683274032349, 0.009576642782637227,
        -0.044195105656698055, 0.05462612555848968, -0.0530410326723878,
        0.046661768198128936, -0.03839290588605757, 0.02939924405923663,
        -0.02051586811175369, 0.012625168342568662, -0.006481394143456499,
        0.002422763432039103, -0.0002691270979610744, -0.0005238996614341623,
        0.000582459636874332, -0.00038620148041739957, 0.00019011473638593545,
        -7.150065976881883e-5, 1.9469979763343965e-5, -2.908046852981434e-6,
        -3.8935000822174873e-7, 4.150085445186444e-7, -1.447325169611866e-7,
        3.016662492227762e-8, -3.3928959885957834e-9, -5.176278568834887e-11,
        8.685608026270634e-11, -1.347878953749319e-11, 6.995691843330783e-13,
        1.7966649891883276e-13, 1.225415457410869e-13, -4.8244136591522956e-15,
      ],
    ];
    const result = wavedec(data, "db37");

    const reconstruction = waverec(result, "db37", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db37_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49122747706346775, 0.9072384850355723, 1.1884091688210234,
      1.302649314043143, 1.2509271999003257, 1.0651700914533642,
      0.7991763022498432, 0.5148547018279213, 0.26721232520725546,
      0.09177129395617833, -0.002548515431759324, -0.03343299775888735,
      -0.038202926910515994, -0.061752189627267806, -0.14254843528864153,
      -0.30033111994281336, -0.5287166691997636, -0.7946934527011866,
      -1.0452637442111676, -1.21969251167834, -1.2643986391780755,
      -1.1468264656592222, -0.8648391207488935, -0.4492329578208174,
      0.041373134929866134, 0.5321734379949218, 0.947650403295994,
      1.2272673780722516, 1.3377011544335486, 1.2787737154619707,
      1.0817682083199023, 0.8006542635089253, 0.49845151988629033,
      0.2321108493411277, 0.03960999319570202, -0.06763091853187991,
      -0.10525969054138484, -0.10944980468956603, -0.1250882793530162,
      -0.19178758109970662, -0.3313531821031789, -0.5399699454153417,
      -0.7871873802768256, -1.022078584561433, -1.1851421949872603,
      -1.2230579086246263, -1.1026561200304061, -0.8206086206093981,
      -0.40635709964070743, 0.08257643646240234, 0.5719064947636243,
      0.9859240871496467, 1.2632719861382464, 1.3694547667010593,
      1.3031698617244805, 1.0950392737583412, 0.7991558279894948,
      0.4795836981552215, 0.19514826706975164, -0.013776079346441872,
      -0.1333087954126912, -0.17707796197902848, -0.1801108779865277,
      -0.18728071226703152, -0.2393409356818444, -0.3601723602342727,
      -0.5485563930618025, -0.7766499988506934, -0.995654566114891,
      -1.1473589340784973, -1.178744948058571, -1.0560422813509807,
      -0.7747082908472712, -0.36276942236517395, 0.12344065724856894,
      0.6102657392792522, 1.0219147787196603, 1.296302052033025,
      1.397820451080815, 1.324063964127047, 1.104975090633369,
      0.7947195192194869, 0.45833663825974746, 0.1564532742021325,
      -0.06822249236046435, -0.19939319517802975, -0.24868832567869026,
      -0.2499915157091636, -0.24815487824023696, -0.28506721191261486,
      -0.38669075286565596, -0.5544274237063933, -0.7630835285906234,
      -0.9660420827458349, -1.1064353134511011, -1.1315862633772817,
      -1.0071359281886267, -0.7273038927127886, -0.31864116632603606,
      0.16379772009909632, 0.6470942547748354, 1.055484240647457,
      1.326245197729151, 1.4227184799444075, 1.3414150112055332,
      1.1115780784021232, 0.787393734899882, 0.4348042678542403,
      0.11616126126006932, -0.12356029617930442, -0.2656930302545118,
      -0.3198916133373252, -0.31889981145481106, -0.3075411389398237,
      -0.32883207731115005, -0.41081903064517106, -0.5575441758278243,
      -0.7465005198723216, -0.9333018393834541, -1.0624735464698774,
      -1.081716646787738, -0.9560943783384634, -0.6785650879129559,
      -0.274144707353979, 0.20348129822872243, 0.6822396568640717,
      1.0865012258006814, 1.3529979780856891, 1.444079344669757,
      1.355192761672436, 1.114861231520178, 0.7772365566695432,
      0.40908871134066455, 0.07441386432635161, -0.17961656380393398,
      -0.3320156740832189, -0.3904895890814857, -0.3866471726668255,
      -0.3652753514580496, -0.3705085765157592, -0.4324767295648385,
      -0.5578776602751904, -0.7269238431656215, -0.8975046893596166,
      -1.0155851732670165, -1.0292787569132231, -0.903080779387574,
      -0.6286648723382172, -0.22945296870308446, 0.2423273897152174,
      0.715554620306073, 1.1148419251286927, 1.376466222828025,
      1.4618439703377766, 1.3653778172357427, 1.1148480437461166,
      0.7643155281286989, 0.38129993321332045, 0.031358494579729335,
      -0.23621494589824615, -0.39816756462570035, -0.46028556115765457,
      -0.45304889887718475, -0.4211993734490211, -0.40997752882394406,
      -0.45159251432274516, -0.5554088727632014, -0.7043866448959551,
      -0.8587314388077973, -0.9658907288792413, -0.9744226742650199,
      -0.8482635814209526, -0.5777789999331411, -0.1847388318280473,
      0.2801748842744543, 0.7468973897358805, 1.1403903921902132,
      1.3965653494630639, 1.4759638975693052, 1.3719616609448952,
      1.1115723986230557, 0.7487074018743763, 0.35155535521282855,
      -0.01285215194502165, -0.29317623795749354, -0.4639548117458768,
      -0.529084989017969, -0.5179247471907027, -0.47516154816011,
      -0.44712789951824183, -0.46810441096360744, -0.5501288730206477,
      -0.6789322693951868, -0.8170726187148651, -0.9135193826687663,
      -0.9173054335044588, -0.7918159935788172, -0.5260853985960922,
      -0.14017454795478085, 0.31686612047731855, 0.7761322726705884,
      1.1630389429526145, 1.4132206461067378, 1.4864014309215434,
      1.3749466609632917, 1.1050784265251072, 0.7304978564019652,
      0.31997944855740895, -0.05806060276883035, -0.3503189578137854,
      -0.5291838065158952, -0.5966960838607369, -0.5810994832077042,
      -0.5270171678105936, -0.4818571437871572, -0.48196000804155587,
      -0.5420388303180221, -0.6506141471663771, -0.7726282253324138,
      -0.8586085501690125, -0.8580905339952611, -0.7339154262266275,
      -0.47376358001754737, -0.09593115238128525, 0.35224743156615923,
      0.803130113158396, 1.1826885295417453, 1.426367523297294,
      1.4931297533707584, 1.3743460397783809, 1.0954203287651316,
      0.7097811838253923, 0.28670330260179583, -0.1041051338886046,
      -0.40745993160746596, -0.5936618304869953, -0.6629304007056896,
      -0.6424034156295952, -0.5766289138409721, -0.5140715221405696,
      -0.493116625651942, -0.5311500352104737, -0.6194956497972315,
      -0.7255074297572233, -0.8013034785851207, -0.7969474302156632,
      -0.6747429205449716, -0.42099404538598917, -0.05217788343675972,
      0.38616967806490243, 0.8277687445002434, 1.1992490867053056,
      1.4359517339678192, 1.4961330065172054,
    ]);
    const expected = [
      [
        -0.3022235802515478, -0.29078406475701735, 0.011998615067709545,
        0.7851938192344882, 1.6519045217771733, 1.9425542845105528,
        1.2805854109844557, -0.04236680663384667, -1.2553807719964578,
        -1.7069563928518274, -1.3488737139282385, -0.6878163222363534,
        -0.27286538956758544, -0.20366841090005008, -0.10969652574576465,
        0.3975181252469398, 1.246897880789641, 1.8704503617459347,
        1.6797633103707994, 0.6012823556862251, -0.7740991180777916,
        -1.660979601384522, -1.65316113190568, -1.019373622196541,
        -0.3854102975246491, -0.10925571923227918, -0.10106904134006396,
        0.15840935851747587, 0.835792086662183, 1.543693920871356,
        2.0263680015702707, 0.7999175998683462, 0.1065308595793255,
        0.9084447213454134, 1.722430087561268, 1.6961519894423829,
        1.0233108997213936, 0.3274999899138185, 0.024003990653297155,
        -0.00940980653867239, -0.2181587413167152, -0.8392878778604862,
        -1.5741455145093122, -1.7950439092744774, -1.1123807221421247,
        0.21861624564053447, 1.4391673955127497, 1.869499104515446,
        1.4241959165619231, 0.6125071508972131, 0.043123194046646704,
        -0.10272801414303077, -0.1518999288097716, -0.5210301531026132,
        -1.2151597714262619, -1.7359103114780288, -1.5060231823589234,
        -0.4270015556908336, 0.9515700377779562, 1.827217368221326,
        1.7674458923947536, 1.0145665916433204, 0.21466267886574963,
        -0.16697014879384325, -0.20684673448265148, -0.34451165525742883,
        -0.8563844363751475, -1.4986742216359428, -1.6749512280260823,
        -0.9880510230001445, 0.3339050004402595, 1.5459266683798392,
        1.9546011272629369, 1.4514686528081524, 0.5454673616440525,
        -0.1184679107984797, -0.30698409691868006, -0.31822289203532883,
        -0.5873586977820633, -1.1722467703960064, -1.6227624523964603,
        -1.3740173295293097, -0.305797949695994, 1.0581890755220078,
        1.91759162811904, 1.8191797723932865, 0.9898351497291837,
        0.0926530341836261, -0.35982932680386487, -0.3995724808875447,
        -0.460160512850173, -0.8576864569024291, -1.404948983783931,
        -1.5390863018838965, -0.8561191161426377, 0.4452093358846849,
        1.6382187365637448, 2.0200065453360905, 1.4604071335422693,
        0.4662176303373856, -0.28454591909489735, -0.5086073525271382,
        -0.47584510427689086, -0.6397946651019648, -1.111944148627942,
        -1.4924811881917084, -1.2305789267972058, -0.18358300059221774,
        1.1542927043973588, 1.9894977019044737, 1.8509903146443092,
        0.9498031815349456, -0.03688723476571197, -0.5523734135217732,
        -0.5854696910350848, -0.563714401300813, -0.842911396030752,
        -1.2937903529084336, -1.389052251242316, -0.718520890272205,
        0.550683772146166, 1.714637927828098, 2.065043679706249,
        1.4512937964417436, 0.37603801879376614, -0.4530831374758636,
        -0.7053698387368338, -0.6230112967145154, -0.6775810417381377,
        -1.034661783713536, -1.3464328257235556, -1.0775932639127987,
        -0.062293024379760184, 1.2382804617150627, 2.0419724100317924,
        1.862785561728228, 0.8953654399423444, -0.17219410709756602,
        -0.7423892229362813, -0.7625167165932857, -0.6539614488088619,
        -0.8120078587172269, -1.166239379791159, -1.2266048533996674,
        -0.5772965880153376, 0.6487266042998686, 1.7735441763716466,
        2.0901692487434484, 1.422989301810551, 0.27915445828289354,
        -0.626327941078592, -0.8887603351165736, -0.7670209257485324,
        -0.6879424828315193, -0.9577620063059401, -1.1633076174436987,
        -0.947649392929011, 0.09238008460525689, 1.2880345724620086,
        1.9932134757253033, 2.18192786874878, 1.5875394310353963,
        0.4017760915073754, -0.6700806286778183,
      ],
      [
        2.145036734377685e-5, 0.001283435423362266, 0.01418048349237059,
        0.026764709300950686, -0.050839672276015026, -0.010569722371391251,
        0.04879316033674121, -0.0603043067179371, 0.05854911072937475,
        -0.05150349625163186, 0.04237456081794942, -0.03244778178294157,
        0.022644107230165487, -0.013936459878533935, 0.007156477763415237,
        -0.002677068329679264, 0.00029951066233869036, 0.0005766378641391529,
        -0.000642065491216975, 0.0004259686446791323, -0.00020978665624172478,
        7.894108741854223e-5, -2.1514444665317243e-5, 3.221688884225462e-6,
        4.2605803233865293e-7, -4.5741224376389275e-7, 1.5975103196839693e-7,
        -3.3335941333401756e-8, 3.756809025655159e-9, 5.562664210756846e-11,
        -9.573950067590685e-11, 1.4888368166610827e-11, -8.986503304411687e-13,
        -3.151666349296577e-13, -1.3073990552999996e-13, 1.2843348610118993e-13,
        2.724366481016822e-13, 1.6432960816787857e-13, -9.388538574937976e-14,
        -2.687680588967558e-13, -1.9471379637494247e-13, 6.132434102967554e-14,
        2.5845684456274583e-13, 2.1543590639130728e-13, -2.3101363613108493e-14,
        -2.435280791204573e-13, -2.371493078726459e-13, -1.4022522737196814e-14,
        2.2384357004476793e-13, 2.515272812023494e-13, 4.724964243032179e-14,
        -2.0003524414443298e-13, -2.6361672194350435e-13,
        -8.395755606234763e-14, 1.7145599261436752e-13, 2.709454770370068e-13,
        1.1783923067889852e-13, -1.4749334654034996e-13, -2.722930212007419e-13,
        -1.4955474127239817e-13, 1.1262778128708452e-13, 2.7058721516049307e-13,
        1.8022397517678477e-13, -7.895917611621539e-14, -2.6268949577119137e-13,
        -2.016351104831428e-13, 4.522529552259532e-14, 2.5202293317192557e-13,
        2.2725382027508734e-13, -8.0009750219423e-15, -2.3560524565280987e-13,
        -2.4436441221703794e-13, -3.119999748916612e-14, 2.1423674102688178e-13,
        2.5880610789780427e-13, 6.297449526255954e-14, -1.8882716862501426e-13,
        -2.7214235444905806e-13, -9.948707102770137e-14, 1.6424980824862555e-13,
        2.738732751294788e-13, 1.3177715165484243e-13, -1.3175490220340836e-13,
        -2.763712073264982e-13, -1.6354278448162872e-13, 9.71664626500813e-14,
        2.6684008486838936e-13, 1.930219861073716e-13, -6.467291770347903e-14,
        -2.570955202167265e-13, -2.17613244454937e-13, 2.6440734748761252e-14,
        2.4371480060914857e-13, 2.3558513768239103e-13, 9.79131018032298e-15,
        -2.2844108336992346e-13, -2.5751881579775263e-13,
        -4.342083209192339e-14, 2.0099559632275386e-13, 2.639090473707021e-13,
        8.30359326153352e-14, -1.7830243421323043e-13, -2.69447653176923e-13,
        -1.200212875101034e-13, 1.4312980783313234e-13, 2.7516342639524616e-13,
        1.4746617935757587e-13, -1.1554448565098248e-13,
        -2.6863165797022335e-13, -1.7680258281493357e-13, 8.406859100292035e-14,
        2.606331221635743e-13, 2.0514566324102712e-13, -4.569914552256857e-14,
        -2.516155504982229e-13, -2.2360650497694525e-13, 8.015158880142824e-15,
        2.3425099377885505e-13, 2.4655665936751034e-13, 2.678935020966262e-14,
        -2.0963880447897687e-13, -2.586715418876199e-13, -6.326169982136078e-14,
        1.947783463767262e-13, 2.642413028900011e-13, 1.0034000843968767e-13,
        -1.629445204018669e-13, -2.5467721306856123e-7, -5.4893406919243944e-5,
        -0.0013302293418353515, -0.006753300754169095, 0.00044811557049222417,
        0.017484703163043173, -0.016411809505471598, 0.010183094947091912,
        -0.005383022994545188, 0.00298530053755304, -0.002324556459769222,
        0.002530226428751111, -0.002901797700355642, 0.003010649336342099,
        -0.002717867007223887, 0.002116856347205569, -0.00141365800210665,
        0.0007990882496261943, -0.0003718575936637088, 0.00013332903441297492,
        -2.9278197202864495e-5, -2.6826028090559998e-6, 6.4507119497035845e-6,
        -3.6508168044246115e-6, 1.3300747464510798e-6, -3.3373341233256864e-7,
        5.003142904358125e-8, 1.001773628935562e-10, -2.2926719554257807e-9,
        6.356435661274163e-10, -8.661912008957985e-11, 3.847671736269638e-12,
        3.0848423108238797e-13, -2.4381103476696536e-13, 1.200542537947736e-13,
        2.698407861926758e-13, 1.787561009321237e-13,
      ],
    ];
    const result = wavedec(data, "db37");

    const reconstruction = waverec(result, "db37", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db38", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4865779176315512, 0.8993944060682542, 1.1798962271611044,
      1.2964084400516218, 1.2495810242149155, 1.0704245682507876,
      0.8115265104095376, 0.5336670446396322, 0.2911351839554563,
      0.1193192610441639, 0.027548224114280484, -0.0011609653687994215,
      -0.003513851413348895, -0.024266836825525273, -0.10249026612736889,
      -0.25929339135330215, -0.49017700036974915, -0.7640349593299519,
      -1.029178496592899, -1.2250103195927653, -1.2965579316198337,
      -1.208335206586847, -0.9541216960695185, -0.5602035991278222,
      -0.08117848659341731, 0.4107901963538331, 0.8408065669696823,
      1.1467161078929515, 1.2916176284015628, 1.2705248334253838,
      1.1096973035841207, 0.8589212429573915, 0.5787052158447519,
      0.3255563037302046, 0.13892729450112457, 0.032974591659430064,
      -0.004947775461429438, -0.008811502712384421, -0.022939683434310743,
      -0.08837964881449295, -0.23012309484139482, -0.4484638674161855,
      -0.7167603835625034, -0.9862832260161752, -1.1970675777374988,
      -1.292186566123421, -1.23198457739267, -1.0047758265666316,
      -0.6313338737324069, -0.16197476900578134, 0.33318798794095184,
      0.7785957896932583, 1.1088732088267697, 1.2820927725743518,
      1.2876060168516816, 1.1466787643710288, 0.9058974893519576,
      0.6250430680820291, 0.3624382669937798, 0.161348769285318,
      0.04071711412904899, -0.007589373844254399, -0.014461181681527935,
      -0.02335819530019273, -0.07690121644554365, -0.2036896634173595,
      -0.4087351813565597, -0.6700063951079367, -0.9420666248052073,
      -1.1660247592057438, -1.2834414614056737, -1.2508258911943864,
      -1.0511705085311893, -0.6996517622404423, -0.24200920289941016,
      0.25413072402904224, 0.7130231817451667, 1.0664754346267462,
      1.2677697722373757, 1.300609864550221, 1.1810596454340945,
      0.9521280880566525, 0.6724142412067431, 0.40163696912474084,
      0.18659130962313852, 0.05092579785209439, -0.008838793102231401,
      -0.02018882320071755, -0.025297870006124434, -0.06794417120209806,
      -0.18003139304590843, -0.3711758134807615, -0.6240642052150773,
      -0.8968578080619538, -1.1321687841535786, -1.2704951152288078,
      -1.2648706309688444, -1.0931469025404217, -0.7648587553462178,
      -0.3209072447385757, 0.1739873215030509, 0.6443716711865941,
      1.0196596726798624, 1.2486138294542508, 1.3093444323566388,
      1.21254165561143, 0.9972828173600328, 0.7205363550874947,
      0.44298358210872524, 0.2146354510885396, 0.06372804943414867,
      -0.008461494222058108, -0.025719505763503986, -0.02852028423626335,
      -0.06137422941498094, -0.15915944733689674, -0.33594673758740523,
      -0.5792105112965559, -0.8509846566769493, -1.095799288532196,
      -1.253543949426783, -1.2741599048617263, -1.1305745462346546,
      -0.8266767599678049, -0.39830195512063044, 0.09313371919838112,
      0.5729441707437192, 0.9685910198355766, 1.2246199157035416,
      1.3136421265932547, 1.2408398277753505, 1.0410308646487914,
      0.7691130366838568, 0.48628564928685386, 0.24543454353534838,
      0.07922742088343349, -0.006237460706578435, -0.030779860219472335,
      -0.03277521535775765, -0.05703492475000732, -0.1410580121347469,
      -0.30318398815070374, -0.5357055055196925, -0.8047713580818634,
      -1.057226296329293, -1.23280668434181, -1.278763925463176,
      -1.1633520743822552, -0.8848498956290479, -0.47383644602014735,
      0.011950363205626664, 0.499061595508397, 0.9134618032558336,
      1.1958130234609656, 1.3133611159614829, 1.2656847403546485,
      1.0830433125825487, 0.8178360647738415, 0.5313283692893431,
      0.2789148681355725, 0.09750254115076057, -0.00196317971644977,
      -0.03510046668925754, -0.037802855210710445, -0.05474908500812575,
      -0.12568466250982785, -0.27299781748528135, -0.49379101998615293,
      -0.7585359873494062, -1.0167678255451378, -1.2085225560355517,
      -1.278781278787553, -1.1914077264872138, -0.9391461277529948,
      -0.5471662539087101, -0.0691803406749692, 0.4230607487788388,
      0.8544904023952402, 1.1622482001384813, 1.3083865597376507,
      1.2868246334682332, 1.1229956233940186, 0.8663876162517717,
      0.5778760596904604, 0.31497596797474203, 0.11860624256888092,
      0.004546505193062489, -0.03841822105882997, -0.043336098909257444,
      -0.05432047095524539, -0.11297093902435656, -0.2454720580170658,
      -0.45368882236436614, -0.7125881468841168, -0.9747474460756707,
      -1.180949389938635, -1.274337988769839, -1.2146996384701643,
      -0.989358725946714, -0.6179616212705565, -0.1498765885361947,
      0.3452920915804273, 0.7919198806248955, 1.124010363806099,
      1.298631642763783, 1.3040274035572395, 1.1605701025342794,
      0.9144425971322844, 0.6256737895467801, 0.35349119002768087,
      0.14256488919385862, 0.013456684196138657, -0.04047865269047696,
      -0.04910289088563707, -0.055535564364044915, -0.10282312855163966,
      -0.22066369420286486, -0.4155990746846414, -0.6672266824866542,
      -0.9314918080212056, -1.1503615456710816, -1.265586384622865,
      -1.233215916574901, -1.0353075366735571, -0.6859096697239089,
      -0.22975973512522146, 0.2661174122810859, 0.726016436443303,
      1.081213901759107, 1.2840384091701829, 1.3170824613044751,
      1.1954583230216596, 0.9616710407382738, 0.6744491686880352,
      0.39430843472699073, 0.16937791251485573, 0.024910827551372194,
      -0.04103817535826437, -0.05482860997380151, -0.058165491314855905,
      -0.09512324336972205, -0.19860264704223118, -0.3796989667568368,
      -0.6227374929792884, -0.8873281591450239, -1.1170477487236234,
      -1.2527037798755811, -1.2469744932874156, -1.0768400611039213,
      -0.7507164487730058, -0.30845682690215315, 0.18590741346594347,
      0.6570676855728469, 1.0340020546231705, 1.2645783882733896,
    ]);
    const expected = [
      [
        -0.22674063335973482, -0.07214146654345693, -0.036273549868818304,
        0.3172992890279647, 1.0642528385460266, 1.7523991508374899,
        1.7593326290337186, 0.8608956561782898, -0.5101042905481665,
        -1.565090545794879, -1.768097549516036, -1.2216614069420337,
        -0.5022735806981066, -0.11345170857919157, -0.062389604867708524,
        0.061502205586043406, 0.5977440715171056, 1.3943949576499077,
        1.861064511285096, 1.4814786803363458, 0.3004556449910051,
        -1.0350880474066908, -1.7642946511987423, -1.6137585076618366,
        -0.8951430285364483, -0.3000212642507549, -0.03682924876454879,
        -0.07090441799503981, 0.2685440104616852, 0.9020157408771718,
        1.6430572640590033, 1.9613130741335367, 0.6574581149623498,
        0.13721479882804513, 0.9981085857783669, 1.7469035205144352,
        1.6535612926816652, 0.9706250671241442, 0.3159835600793451,
        0.05926194400220799, 0.03726541503762657, -0.1990222883404767,
        -0.8581537079659537, -1.6131138411442483, -1.8333080365856371,
        -1.1475630100027312, 0.17424692989749058, 1.3808772284224653,
        1.8157704281077929, 1.4089834606591647, 0.6609394157758063,
        0.15254396123621644, 0.038328639240328456, -0.019045279982291573,
        -0.4315049055183015, -1.1944169336806865, -1.7995351820087664,
        -1.6541599675815464, -0.6337185988921095, 0.7410138534734926,
        1.6799089702125685, 1.732830701089677, 1.101884863827241,
        0.39489297820184954, 0.06104167343467761, 0.027766041019084746,
        -0.1401786731744105, -0.7278944322212604, -1.5016702112785125,
        -1.848638280720982, -1.3149757883193678, -0.05508591336329423,
        1.2280868920808437, 1.8169089675360521, 1.5247475395672252,
        0.7807162099560777, 0.19690170438304727, 0.024403386284248048,
        -0.007387012470450132, -0.33792345697486587, -1.0581284708399215,
        -1.7307491560283168, -1.7366564429506717, -0.8429856182293788,
        0.5278067382543971, 1.588188202389314, 1.7927649721259415,
        1.2339106752782028, 0.4886650729539293, 0.07396865241120086,
        0.013449186847092356, -0.09707913701480686, -0.6067504795366554,
        -1.3794959594524459, -1.8378167558479404, -1.4601495063710228,
        -0.28374726367884695, 1.053940018507776, 1.7917810372830796,
        1.628941939264462, 0.9088362850728715, 0.25687754167229687,
        0.015683083467899806, -0.006637117866623029, -0.2596240192643923,
        -0.9235025665947454, -1.6432269378164697, -1.7919513772431885,
        -1.0375746798986245, 0.30498405606069046, 1.4703842182744404,
        1.8306382428940218, 1.3631058897970598, 0.5960490278375512,
        0.1000373085336986, -0.002646547290387096, -0.068833771665762,
        -0.4971389856258309, -1.2502935629434602, -1.8024352559255945,
        -1.580908348985355, -0.5074430164155433, 0.8613208723290057,
        1.739588348090022, 1.7180610175850175, 1.0423563462421452,
        0.3326438689747004, 0.01498769271420475, -0.014312752306836742,
        -0.19712852724764504, -0.7938755387422477, -1.5401748800423851,
        -1.8200938906822248, -1.2140639214123476, 0.07668559560696647,
        1.327964622361759, 1.844227320633014, 1.4857632353266035,
        0.7152215110842719, 0.14075772960742838, -0.017420835885458247,
        -0.054003815101948405, -0.4009559403031515, -1.1177883875595935,
        -1.7446327561791484, -1.67573578841726, -0.7219546098633802,
        0.6535302515706188, 1.6602395361431734, 1.7889062128403994,
        1.1777345271013455, 0.42436164556959627, 0.0237323034628482,
        -0.02585616138051225, -0.1528417482728047, -0.6691357372681304,
        -1.428294558962831, -1.8199268577192795, -1.366289067790592,
        -0.16940597224624573, 1.2036418569495788, 1.8071446487487486,
        1.2636640450714405, -0.026129039457227585, -1.2639380205671173,
      ],
      [
        1.542516562903665e-5, 0.0009872622794802834, 0.011950606940803167,
        0.02767803987599089, -0.04044023474419204, -0.027072006117937347,
        0.06065491055174939, -0.06583577373869741, 0.06012999745993798,
        -0.05194403856255636, 0.04364808545807281, -0.03540427651762975,
        0.027115787020700582, -0.01909163182643212, 0.01198991311698035,
        -0.006449304888699578, 0.002751293776353149, -0.0007227128039400323,
        -0.0001148921386673632, 0.0002960054584051559, -0.0002241684822046254,
        0.00011615187431963871, -4.5145329905429386e-5, 1.2875976904283738e-5,
        -2.2584415560041346e-6, -4.180130284690253e-8, 1.8863810074712154e-7,
        -7.197560159780212e-8, 1.5606775220130486e-8, -1.8769878045308535e-9,
        1.5201210712550583e-11, 3.6671577069016396e-11, -6.119866431798792e-12,
        2.719937930446972e-13, 7.431828882049709e-14, 1.0862218994817692e-13,
        6.176149330092685e-14, -4.380301452651217e-14, -1.1062546642333992e-13,
        -7.479216781874733e-14, 3.014126008793662e-14, 1.0648956957765831e-13,
        8.488980498429587e-14, -1.1329575096095525e-14, -1.008818644260242e-13,
        -9.575574940692561e-14, -3.732458272217144e-15, 9.070570410023925e-14,
        1.0417296591393229e-13, 1.799264736964945e-14, -8.44911890874562e-14,
        -1.0994272883825261e-13, -3.4860614182651446e-14, 7.019493439733568e-14,
        1.1113283391611105e-13, 5.0688544873052085e-14, -5.907698829882286e-14,
        -1.0975267932642226e-13, -6.577406526699117e-14, 4.165897691830184e-14,
        1.0945238168954689e-13, 7.966769615930248e-14, -2.929895945873016e-14,
        -1.0841268156865967e-13, -8.60558692333795e-14, 1.0466778895125063e-14,
        1.0151587936275453e-13, 9.848703416682756e-14, 4.279789456828107e-15,
        -8.972183350198629e-14, -1.0276964056421945e-13,
        -2.1109459029312163e-14, 7.991753341471668e-14, 1.0961781645430835e-13,
        3.2093701319346484e-14, -6.623335474770367e-14, -1.1542165304841584e-13,
        -5.1276349895942176e-14, 5.152360758748868e-14, 1.1012908984173024e-13,
        7.003712627096699e-14, -4.13945161689818e-14, -1.0892849864219782e-13,
        -7.965705473109186e-14, 2.4611216322660854e-14, 1.0499859928089136e-13,
        9.050353797078991e-14, -8.864682917550677e-15, -9.667665299251357e-14,
        -9.69215349818187e-14, -1.1208578408408658e-14, 9.187147361873107e-14,
        1.0177809232272212e-13, 2.5342453753091872e-14, -7.639520757618868e-14,
        -1.1059472044022031e-13, -3.709795279354177e-14, 6.458116604561777e-14,
        1.171259075787081e-13, 5.4915152886061875e-14, -5.219984914839299e-14,
        -1.0798099883192517e-13, -7.026576508690304e-14, 4.068379239697125e-14,
        1.0819096666199453e-13, 8.284925621778671e-14, -1.937426810215351e-14,
        -1.0416186990943484e-13, -9.432995468142673e-14, 3.756437915911926e-15,
        9.45795418552268e-14, 9.8613939230432e-14, 1.1175573769903866e-14,
        -9.218198709647541e-14, -1.0623317475732749e-13,
        -2.5485874480843906e-14, 7.600384603247751e-14, 1.087074352592176e-13,
        3.951575712113728e-14, -6.373901347877306e-14, -1.1253150005597049e-13,
        -6.011247909099451e-14, 4.871636879847732e-14, 1.094232885320829e-13,
        7.614136983390619e-14, -3.5870689976417696e-14, -1.0436557389741912e-13,
        -8.362005914042e-14, -1.9138360826088088e-6, -0.00011909492191397894,
        -0.0014004929595863279, -0.003124436218700062, 0.004651235601093325,
        0.0029364588540776427, -0.006593688974440439, 0.007071417014875553,
        -0.006372447470609355, 0.0054344951053832335, -0.004518385488377702,
        0.0036410472540668428, -0.0027861414110386435, 0.001974252316199513,
        -0.0012600474596127379, 0.0006993037306516506, -0.0003177011069668675,
        0.000100350779350245, -3.5095817388163346e-6, -2.357719086566713e-5,
        2.1018236641573325e-5, -1.1841253820476333e-5, 4.9485581833260145e-6,
        -1.5404354031182919e-6, 3.195628022165008e-7, -1.8419427767503947e-8,
        -1.6384926441499983e-8, 7.731439841595058e-9, -1.8777676120505664e-9,
        2.5882202099240394e-10, -9.055212248019265e-12, -3.9416272222953e-12,
        7.561801810333615e-13, 5.209631927193815e-14, 9.557896953291666e-14,
        5.7110916559572235e-15, -9.042176595959917e-14,
      ],
    ];
    const result = wavedec(data, "db38");

    const reconstruction = waverec(result, "db38", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_db38_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5010924986092773, 0.9237770291815601, 1.206093254970917,
      1.315069967146179, 1.2524190804954096, 1.0521293454150857,
      0.7706978482053376, 0.4725339554170083, 0.21422547565633437,
      0.03158454362203322, -0.06736211709256523, -0.10181471606104157,
      -0.11038881477212398, -0.1382137559517262, -0.2223958198001365,
      -0.37971106512480945, -0.5998187964526244, -0.8458732962276159,
      -1.0625152902254182, -1.189323909382018, -1.1763847694997192,
      -0.9980414297131059, -0.6612973971921361, -0.20662751306415783,
      0.2991795695251366, 0.7765564543278437, 1.1498938566364891,
      1.3635006771389664, 1.3929888505841066, 1.249403399391845,
      0.97519707829083, 0.6331446256818396, 0.29100681678143064,
      0.005762852751298897, -0.18871785416955916, -0.28760610683981097,
      -0.3133327206853067, -0.3067477907898955, -0.31365555822121316,
      -0.37032114915914116, -0.49178872586236055, -0.6661169567927958,
      -0.8561131234123668, -1.0082167637067996, -1.0663350491466974,
      -0.9871325477117465, -0.7528574945974047, -0.3783544410339807,
      0.0896698029965653, 0.5811462822932897, 1.016996980551418,
      1.3259602719176196, 1.4598735679245995, 1.4037565061835025,
      1.1783016497696372, 0.8342342225110649, 0.43998614581133605,
      0.06574881709520763, -0.23217849488098047, -0.42295206353508624,
      -0.5059328000665976, -0.5076332307429069, -0.4718467886719022,
      -0.44565429831935016, -0.46502216485439624, -0.5437808531514015,
      -0.6688841034912074, -0.803224477741217, -0.8953301585476674,
      -0.8934844500479204, -0.7606443771993701, -0.4862841513561691,
      -0.09201933895675402, 0.37060196284844305, 0.8298056243521531,
      1.2085805361652082, 1.4413959312870492, 1.488630998335561,
      1.3452343056914997, 1.041528181911897, 0.6359877942832685,
      0.20177982234045694, -0.18964510226909997, -0.483923355285036,
      -0.6544310913300028, -0.7057500341034357, -0.6692956545039752,
      -0.5924235695952094, -0.5239515111310012, -0.4999050619816207,
      -0.5331990449144066, -0.6099298624786544, -0.6932405791864239,
      -0.7337636373219558, -0.6839405267076872, -0.512495054198592,
      -0.21525699673430054, 0.18058128402935164, 0.6200613870681442,
      1.031225957911757, 1.3405612239978868, 1.4894192191453028,
      1.4474381122466586, 1.2196824917890159, 0.8457450965818442,
      0.39100996471257593, -0.06781297613364329, -0.45938547737319313,
      -0.7326558763432618, -0.866453257607722, -0.871573095797321,
      -0.7850507489076901, -0.6582645269511072, -0.5420296778555054,
      -0.47255928669442726, -0.4619012625757772, -0.495282572124191,
      -0.5360018912535289, -0.5365627463631377, -0.45312365163435053,
      -0.25946834339629155, 0.0432101564963554, 0.42338395561828324,
      0.8240764373262569, 1.1745403162883308, 1.4059764837905941,
      1.4674891172682554, 1.3383639320418363, 1.0336232613911958,
      0.6014402331287422, 0.11298013331653733, -0.3529141336302887,
      -0.7265240203950514, -0.9615330478340025, -1.0434177008377912,
      -0.9900665861654093, -0.8446783599799866, -0.6628976878598491,
      -0.4975537453926289, -0.38491777612389977, -0.3359599041510855,
      -0.33477394822416606, -0.34448524198664143, -0.3190291676435998,
      -0.21767407156934665, -0.018444011810524297, 0.2731434423179121,
      0.6224354310549185, 0.9717157560853037, 1.2526459696457999,
      1.40209379747551, 1.3774683061371729, 1.167749632784572,
      0.7974233040853378, 0.3222527280306041, -0.18218011576591597,
      -0.6364637083215907, -0.9740676015339742, -1.154801747431437,
      -1.1718685284370545, -1.0509449041968173, -0.8417033985801451,
      -0.6040372973487433, -0.3925344616573848, -0.24312814463697147,
      -0.16524958572547616, -0.14137126020100785, -0.1339254223677521,
      -0.09769103766598325, 0.005659396852606191, 0.19471971762988277,
      0.4606566891154369, 0.7667991104293808, 1.0557912538938465,
      1.2626556424075912, 1.3305789696893737, 1.2254967496802567,
      0.9457959572104901, 0.5246232976974525, 0.024090600915310546,
      -0.47734079252586636, -0.9013342381870472, -1.1860968905374802,
      -1.298845446095293, -1.2413984570184555, -1.0476716480533987,
      -0.7738438637857359, -0.4837504516143257, -0.23320265447257743,
      -0.05714334366436985, 0.0372180221074806, 0.06969867496329765,
      0.07921248388808441, 0.11080692651059981, 0.20113630744631605,
      0.3662343702321046, 0.5948595232317528, 0.8492609769774884,
      1.0733134053870197, 1.2060706839906274, 1.1973749507488611,
      1.0215841495772315, 0.6858970064091432, 0.23105858946112037,
      -0.27590142326948336, -0.7552777917995882, -1.1314508409069377,
      -1.348815712839789, -1.3830913069618953, -1.2453520694235998,
      -0.9779115264739264, -0.6431811276251224, -0.308334638683346,
      -0.02960271239334028, 0.15994111002155065, 0.25616821519469707,
      0.28197559926467675, 0.27834191317570584, 0.2908199573009235,
      0.35507321543861875, 0.4852907589717115, 0.6685658476533793,
      0.8667885019854755, 1.025668898126562, 1.088664878390594,
      1.0122993025578375, 0.778948235261123, 0.40376440275612524,
      -0.06617090657198049, -0.5604557443199834, -0.9997941433476487,
      -1.312843124514183, -1.4514617442414617, -1.4007176320020869,
      -1.1812820590545439, -0.843704738245115, -0.45604106751621803,
      -0.08791417452686984, 0.2050678892360378, 0.3927594672528,
      0.47508822209086177, 0.47887400623076487, 0.4478712865777586,
      0.42875245387833244, 0.45675458422417375, 0.5447697218023158,
      0.6787559296974579, 0.8207123069519568, 0.9185090414690938,
      0.92008670927037, 0.7883870047286995, 0.5131426521239179,
      0.11639967396305609, -0.34981360019149,
    ]);
    const expected = [
      [
        -0.7108701956213671, -0.6746392644012129, -0.7763935042776428,
        -0.5395536809908581, 0.29884354095166654, 1.4108951302028199,
        2.0629293400468627, 1.721883490161746, 0.5351249714200204,
        -0.7617329435002397, -1.4347530952522403, -1.3118638880883653,
        -0.8213424353691396, -0.5053855196973364, -0.488682855150058,
        -0.40706562750489445, 0.14770714683184646, 1.1158954420093559,
        1.8990312152684954, 1.8448652597650603, 0.8301537844106177,
        -0.5687668073345816, -1.5184172510874676, -1.60064652292282,
        -1.0210741568127837, -0.465523001479937, -0.1919732076080947,
        -0.21416040355758684, 0.14778831411109994, 0.824952926770636,
        1.630311955532136, 1.9981958672462405, 0.6721393327351163,
        0.14209856134429905, 1.029238250860905, 1.7812655071711725,
        1.6450301446132527, 0.9012998614310203, 0.20355164376733498,
        -0.07493583500861187, -0.11853661217506255, -0.3764977773218211,
        -1.0092983975828516, -1.629879558695602, -1.611940356440304,
        -0.6903016284352098, 0.714256031929345, 1.7713326948757453,
        1.890516976853299, 1.1685474735298331, 0.24246308537993475,
        -0.29821604822083975, -0.3905392381325414, -0.43809795377592686,
        -0.8002728916607409, -1.346151020704969, -1.5215162594019964,
        -0.8809382330565851, 0.4183025768752079, 1.644992493534736,
        2.0502847056553923, 1.4635576226950373, 0.39652054117632685,
        -0.4272488587966568, -0.6778176223834306, -0.6101284923124145,
        -0.6929828639570077, -1.0597865600020022, -1.3265508223717744,
        -0.963421140502899, 0.13241909509012184, 1.4211650823590858,
        2.0966664431307374, 1.7358882876681934, 0.6399182432350463,
        -0.43893828624892256, -0.9300915670177801, -0.8624042157264573,
        -0.7057217452907564, -0.8203566492448059, -1.0612797169826425,
        -0.924458890311562, -0.09507392217489252, 1.1377635802596289,
        2.02151771933193, 1.9389957805838764, 0.9314789657678987,
        -0.33037559693937407, -1.1031015523613716, -1.150932726458109,
        -0.836130974881357, -0.6693543621445961, -0.7720311027567662,
        -0.7716516571806739, -0.22590206214835623, 0.8429470559992601,
        1.8375976291348854, 2.0382416719370413, 1.2217377499846418,
        -0.11933970733927031, -1.1662227320026397, -1.4254824447275134,
        -1.0616057468582647, -0.6330572990911109, -0.5092557654931118,
        -0.53218377722766, -0.23842134096811463, 0.5868357126757634,
        1.5763738824130629, 2.0168516492305164, 1.4614513710177732,
        0.15876131745532104, -1.107733349531691, -1.6382239757237207,
        -1.3431837264724504, -0.7180070367949627, -0.31884803863644573,
        -0.24814720312185787, -0.13134161474709233, 0.41288869751593443,
        1.2826094037258393, 1.8788012044622309, 1.6100696599033155,
        0.45698151471823295, -0.9368312491488738, -1.7519582279873631,
        -1.6322477586016297, -0.9098837740360192, -0.23425057300194896,
        0.03069960402177958, 0.0760514886220464, 0.35042781581537896,
        1.0066617509541202, 1.6481317244305163, 1.6427113557455,
        0.7249131457382473, -0.6820515938899095, -1.7465157097754795,
        -1.8788898644825562, -1.1759686003121848, -0.2707039270147817,
        0.2554955223887213, 0.3472170622015789, 0.4095530144143097,
        0.7959833907616274, 1.3643398395228004, 1.555577496263522,
        0.9150226361904966, -0.38208101576812586, -1.6293224384562035,
        -2.029639502987963, -1.4863779321393529, -0.40109962157618306,
        0.3574899114016674, 0.6745472775145683, 0.5233965787374242,
        0.7679728991611988, 0.9577534220238856, 1.5242679425438037,
        0.8605554797666873, -0.33194333733156445, -0.028138991225198508,
        0.8993341333504866, 1.2797622066893866, 1.0463684444624295,
      ],
      [
        1.5888784965782103e-5, 0.0010173745633912103, 0.01232044928492539,
        0.028550173633844347, -0.041703186706746685, -0.027940893388463922,
        0.06259965612383679, -0.06795793668794539, 0.062079691230677914,
        -0.053637715275144576, 0.04507772460265559, -0.03656710985284971,
        0.028006701853490384, -0.01971717353660657, 0.012380010974075099,
        -0.006656211233600989, 0.0028369417559908953, -0.0007429380384952455,
        -0.00012071840931280794, 0.00030663702071165734,
        -0.00023179474014558055, 0.000119975958961048, -4.6585594522603906e-5,
        1.3269730811940511e-5, -2.3210341788953435e-6, -4.6142554505363965e-8,
        1.952146514318174e-7, -7.42920506378102e-8, 1.6083044003362115e-8,
        -1.9299571252010667e-9, 1.472723179740378e-11, 3.779244233927047e-11,
        -6.357626291040786e-12, 2.9595767552176523e-13, 1.5071956322650463e-13,
        1.7352580843038337e-13, 5.00465186843006e-14, -1.2166240873137282e-13,
        -1.8011201062581765e-13, -6.902596515536113e-14, 1.0941642136239245e-13,
        1.8312968053206038e-13, 8.654629246277502e-14, -9.121450291501941e-14,
        -1.8002951122699717e-13, -9.995430724832761e-14, 7.496371645689783e-14,
        1.8268546267389815e-13, 1.166004390210571e-13, -5.77649300074611e-14,
        -1.7801328478489497e-13, -1.2963843762716102e-13, 3.763076898305036e-14,
        1.6890215885285325e-13, 1.4080817406309862e-13, -1.96410121658633e-14,
        -1.6389572800966747e-13, -1.5645205181458135e-13,
        1.7045893183819984e-16, 1.5562963052292927e-13, 1.6271531582464995e-13,
        1.7736212406897565e-14, -1.4256281746131727e-13,
        -1.7295440920807194e-13, -3.623149482065265e-14, 1.341685954603357e-13,
        1.790815806188141e-13, 5.5429825731330406e-14, -1.1746858324936753e-13,
        -1.796916369825336e-13, -7.445400013559938e-14, 9.889996886722621e-14,
        1.805605942276394e-13, 8.872829399410151e-14, -8.727482891070853e-14,
        -1.8203561122299842e-13, -1.074256946298562e-13, 7.051945691153391e-14,
        1.8366590706117072e-13, 1.1862621643006465e-13, -4.5980659301518495e-14,
        -1.7369359152332392e-13, -1.313421421955995e-13, 3.185655409045104e-14,
        1.6781237513515048e-13, 1.4984437892531385e-13, -1.9866232049052966e-14,
        -1.6277004896389542e-13, -1.5874421830708088e-13,
        -3.738837984100635e-15, 1.5283901673217968e-13, 1.631519310353189e-13,
        2.6731639330955402e-14, -1.3868866693365673e-13,
        -1.7388219120934576e-13, -4.2047504413468073e-14,
        1.2349747614712592e-13, 1.7871780671556363e-13, 5.780253772068122e-14,
        -1.1509214215680735e-13, -1.7931603997294959e-13, -7.78532124032927e-14,
        1.0048624384811688e-13, 1.838055081506485e-13, 9.63605942829492e-14,
        -7.774713240623462e-14, -1.797539524541732e-13, -1.1098096209995356e-13,
        6.144295929423805e-14, 1.7600171271806139e-13, 1.2352639390653877e-13,
        -4.809558999161814e-14, -1.7615654736414057e-13,
        -1.3646759343929063e-13, 2.6704409541468582e-14, 1.671778765269866e-13,
        1.501312646296194e-13, -6.095981487057645e-15, -1.5749140296145686e-13,
        -1.6347990073662526e-13, -8.653628677034452e-15, 1.4820322061099048e-13,
        1.6473731770472646e-13, 2.825715718753987e-14, -1.379486904667911e-13,
        -1.7023032963552925e-13, -4.68508986194915e-14, -6.608334599335794e-7,
        -0.00015102289644442654, -0.003941257304694229, -0.02250105564944071,
        -0.0058483273641618825, 0.0649392945716579, -0.048103709425103516,
        0.01807356057528008, 0.0016148637460940039, -0.009848386900686259,
        0.01038175028482921, -0.006842817921132602, 0.0020098258956393967,
        0.0021880798602676587, -0.004704170692459462, 0.005358895898300629,
        -0.004627491762499603, 0.003259532180445176, -0.0019055388244905574,
        0.0009157448236411628, -0.0003469859490256796, 9.079601014605212e-5,
        -6.006454645393782e-6, -9.326567817572248e-6, 6.3126086513281106e-6,
        -2.4382572839633104e-6, 6.385509364719024e-7, -1.0451495998634442e-7,
        3.984467299475687e-9, 3.1825024566757546e-9, -9.876740864682194e-10,
        1.4155394680775643e-10, -7.746650567089604e-12, -8.236071737368192e-13,
        2.307891130484416e-13, 1.7945535679994207e-13, 9.730767386202958e-14,
        -7.85682964862549e-14,
      ],
    ];
    const result = wavedec(data, "db38");

    const reconstruction = waverec(result, "db38", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49639615932940995, 0.9141550116710713, 1.191606944421057,
      1.296887614726888, 1.2335564036264557, 1.0377241137863078,
      0.7675497018210526, 0.4878696560546875, 0.2539167936046342,
      0.09826641711905659, 0.024274012359817965, 0.007566207184323437,
      0.005052984768117608, -0.031019033163315946, -0.137756002756874,
      -0.3291579516321414, -0.5898840822631138, -0.8770052260409049,
      -1.1294357934195662, -1.282736476398233, -1.2855607299146083,
      -1.1135477015087387, -0.7770651146202431, -0.32072758444899363,
      0.18532639219533953, 0.6603444762463533, 1.0304453802630986,
      1.2444179617041589, 1.2839997165099157, 1.1661916671915509,
      0.9371702784973714, 0.659463029650751, 0.3957276450996991,
      0.19329163447025316, 0.07336353745962931, 0.027586007392761014,
      0.022683540252484466, 0.011856396156034898, -0.050174388076811405,
      -0.19251066458416333, -0.41775005774616397, -0.6988108032081601,
      -0.983881015061531, -1.2083559403382207, -1.3107997001889342,
      -1.2488919084395693, -1.011272195884391, -0.6221924459278434,
      -0.13767631344915424, 0.3659854537020203, 0.8086480829204142,
      1.123642805364937, 1.271802700128669, 1.2487977481079495,
      1.084078864416917, 0.8318398801631804, 0.55640227151905,
      0.31580319939721757, 0.14777509315904996, 0.06164382889253983,
      0.03811453712085047, 0.036859911954608346, 0.009802478786844981,
      -0.08349192369426106, -0.2624395930215271, -0.5176938355971218,
      -0.8111859479673511, -1.0840931619959546, -1.2708128653408957,
      -1.3154437584012755, -1.1865846915446752, -0.8866400492990818,
      -0.4531735173989005, 0.04816224065451517, 0.5374780056101293,
      0.9379346316770675, 1.1922524057568178, 1.2744299513831567,
      1.1938690607715192, 0.9910148318212174, 0.7257503135305132,
      0.4615902692987848, 0.24974172080055335, 0.1170817104184716,
      0.061052919624529745, 0.05266655432232706, 0.04669444610148091,
      -0.0037310596918749273, -0.13203275641156687, -0.3466709971143237,
      -0.6263250989121141, -0.9231751217311124, -1.1735858648170523,
      -1.3135645552523278, -1.2950978199727101, -1.0991982710226145,
      -0.7422799246699539, -0.27413666931412295, 0.2321002033704714,
      0.6956345223114418, 1.045501133573887, 1.235621718311038,
      1.253775361344629, 1.1223745267145708, 0.8909996246697316,
      0.6227100701144144, 0.37769219360129636, 0.198433883109908,
      0.1001749868549755, 0.06898710741060973, 0.06784574338207157,
      0.048982634920917645, -0.030821491601125572, -0.19610680814812054,
      -0.4435731065152845, -0.7404124572208238, -1.0307233007621774,
      -1.2484954731729256, -1.333935004759982, -1.2489961447145927,
      -0.9881391611564633, -0.5815007913329671, -0.08955483833026216,
      0.40952622011081546, 0.8367636003664685, 1.1294048690211702,
      1.2539516205133157, 1.2120502250114042, 1.037913861520659,
      0.7880730243864056, 0.5261682272562023, 0.3067162787705557,
      0.16199258912322534, 0.09532589895241605, 0.0824178053231266,
      0.08021033404515923, 0.040866388259097886, -0.07289793523678506,
      -0.27524370949331434, -0.5508072315454304, -0.8562795334261024,
      -1.129715371456058, -1.305308522975532, -1.3299293403600652,
      -1.1772206269935714, -0.8556198196260296, -0.4081765337721539,
      0.09591516958610015, 0.5760713454574741, 0.9577815372022203,
      1.1885244123915206, 1.2482739621823868, 1.152102030769494,
      0.9443748829136136, 0.6861511983461759, 0.43908019298098877,
      0.2499426964108138, 0.13976270198259783, 0.10020040561590055,
      0.09803375447789954, 0.08643289984348793, 0.01996977253376281,
      -0.13066516137946066, -0.36819636770460223, -0.6654108297106917,
      -0.9699468121871264, -1.2161408461501533, -1.3410073545494112,
      -1.300323030283118, -1.0807104728538581, -0.7045857778651893,
      -0.22660843618407792, 0.27760054802185735, 0.7277652815501947,
      1.0563179228334583, 1.2225884304919021, 1.2203969148022362,
      1.0772908492438744, 0.8457728397821807, 0.5888701175871782,
      0.36379509807495564, 0.20788337041770283, 0.13036305307888513,
      0.11197227818844191, 0.11239510857546671, 0.08345552847115661,
      -0.015485196961194214, -0.2040575557819012, -0.47297716787540606,
      -0.7839073032031112, -1.0772874322624368, -1.28625610668607,
      -1.3531973995516233, -1.2447215103902391, -0.9612385245690636,
      -0.5386141068562851, -0.04137096472001309, 0.45098086092329626,
      0.8611767960208827, 1.1307931135851603, 1.2321712108573855,
      1.1728203427997612, 0.9913466274137073, 0.7460863343817064,
      0.4994420518630399, 0.30196933908719625, 0.1802742742359973,
      0.13175891459116973, 0.12745655652262705, 0.1220930117894667,
      0.06863393857935196, -0.06658753685860197, -0.29222522725897054,
      -0.5869254469434032, -0.9024381599222713, -1.1741906597636678,
      -1.3367376138942757, -1.3402109506920843, -1.1635877410273454,
      -0.8213550858472851, -0.36178719644151525, 0.14285305952154734,
      0.6118502562490282, 0.97353278751107, 1.1804645886301883,
      1.2186552132558892, 1.1086247031412795, 0.8982132089853294,
      0.6490964856862569, 0.42053091986160784, 0.2545097064740848,
      0.16610042712659162, 0.14136188465316443, 0.143258094276754,
      0.12390806723673625, 0.03986456561190699, -0.13367486990727512,
      -0.3935529437608077, -0.7068036058209042, -1.0169122546568876,
      -1.256726456092216, -1.3648198737118564, -1.3011831671106906,
      -1.058236495856705, -0.6643014064017372, -0.17854681837785913,
      0.3214413778168407, 0.7564671123446851, 1.0628113270765844,
      1.2054404423095035, 1.184162262537809, 1.0313380392461793,
      0.8018854265567512, 0.5582358379679548, 0.3541514973431442,
    ]);
    const expected = [
      [0.45250797114309416],
      [-0.0027256673040784996],
      [1.069949114441462, 0.0002432470019594346],
      [
        0.6307461229628772, -0.9173287666716703, 0.8093903150724497,
        -1.402379203369346,
      ],
      [
        1.5632843594980375, -2.2768490067530665, 0.07445082390361335,
        1.7765820718195493, -0.6833748433450147, -1.617249347207047,
        1.5879960528587367, 0.9985907596041171,
      ],
      [
        1.5574262285529492, -3.392890340989087, 2.1015174219639845,
        0.7862114235676421, -2.5940146266795723, 2.1299440099552402,
        -0.27555001548820046, -1.424135095434252, 2.0699583730432405,
        -1.4781354818291195, -0.138593067736685, 1.9757131035819755,
        -2.5920360625132686, 1.0112329955987418, 1.8307914985323854,
        -3.3684442599434314,
      ],
      [
        -0.6129059162854437, 0.3607951267959639, 0.542148304147557,
        -1.087668454573763, 0.4631175678862179, 0.8790635553228944,
        -1.5250728233488127, 0.6029498418265556, 1.1250504385146884,
        -1.8924508689620996, 0.7603524539021824, 1.2716125574442974,
        -2.161642187519986, 0.9115789732690449, 1.3194780349545665,
        -2.311474525309798, 1.0315813833340937, 1.2781116774580779,
        -2.329647714003034, 1.0966929464374024, 1.1644161139643308,
        -2.2138459559338677, 1.0872252525995063, 1.0007566228706455,
        -1.9719744863730173, 0.9897229702671858, 0.8125076910624258,
        -1.621497672233893, 0.7986512898874332, 0.625363585186608,
        -1.1879388298023414, 0.5173441911768755,
      ],
      [
        -0.8046828983813592, 0.3625851013729915, 0.30962301009022364,
        0.09069711393631551, 0.5436994927826081, -0.3388421950919298,
        -0.9130955243815532, 0.21252786626257603, 0.39426775141028386,
        0.044293769783011, 0.536215547969682, -0.12949576810159735,
        -0.9672511479997161, 0.03128444648436979, 0.4623319295629815,
        0.026547987635968488, 0.49147413342434243, 0.07356121130455007,
        -0.9627269064813135, -0.1690559873603954, 0.5027165776261964,
        0.03938681480959669, 0.41861613996149805, 0.25595069433843665,
        -0.8997208648744586, -0.37413071188516933, 0.5064859438342959,
        0.0808880095861011, 0.3289205289915986, 0.40564735997495327,
        -0.7830398381039135, -0.5685333345286011, 0.46786141744472776,
        0.14548258180911922, 0.2346091835171783, 0.5139685647300287,
        -0.6216768069777265, -0.7371597172750832, 0.3849249558460457,
        0.2245298908966521, 0.1475810215835427, 0.5762402304609929,
        -0.42801706705674114, -0.8665455462729369, 0.2599608281340414,
        0.307209396082773, 0.07819852762697313, 0.5920800059041205,
        -0.21674673563919522, -0.9460713642602386, 0.09939867711453854,
        0.3816423864607764, 0.03424426037248904, 0.565275421374051,
        -0.0035647909692568813, -0.968922799029688, -0.0866412701279553,
        0.43613453416794695, 0.02014807513313288, 0.5032731226431719,
        0.19618216503672192, -0.932716230848712, -0.2851621327130215,
        0.46041806524591583,
      ],
      [
        -0.3510050904167837, -0.19618814310082888, 0.04478192882987242,
        0.19104215880371977, 0.1654296555164363, 0.05232053116155741,
        0.0017771166131291816, 0.07547443500290724, 0.18436121500169025,
        0.17849536597221916, 0.001997048813219049, -0.23792911894004698,
        -0.35783419853162673, -0.26170085895351214, -0.027988527234413918,
        0.16194257698241443, 0.18648907885489063, 0.08480197065101025,
        0.0034665677594337696, 0.0438623881733652, 0.15926830229519356,
        0.20157507991580426, 0.07243867728068565, -0.16802251009136482,
        -0.34260464286996073, -0.3130097468981927, -0.10476486628732007,
        0.11647383964740732, 0.1947638008660711, 0.11881381335094195,
        0.01663772176827838, 0.019132494474427286, 0.12653511045883775,
        0.20753026288175336, 0.1320307684163482, -0.09111711999167271,
        -0.3065071241240332, -0.34599849554159756, -0.1798298226280599,
        0.05696515204991659, 0.1875703396915399, 0.14979954522762667,
        0.039618337912078694, 0.0042229182209402374, 0.09072299978823399,
        0.19774531176785068, 0.17706713451803058, -0.013057953742594552,
        -0.2523793830358553, -0.3579635255619476, -0.24739305333443273,
        -0.012836564092292058, 0.163606762232279, 0.17325380199435386,
        0.06947953185376823, 0.0008070662443817322, 0.05643003903040597,
        0.1749850976905551, 0.20528076612007806, 0.0604148721666099,
        -0.18445374199382103, -0.3478583193454913, -0.3021024487551478,
        -0.08806785255485172, 0.12313300347547163, 0.18519465807605384,
        0.10233510234796464, 0.009127400537461437, 0.027820370863959873,
        0.14308006912123422, 0.2160015361244873, 0.12416310816933696,
        -0.10798136676772052, -0.31639018162366633, -0.339521687987249,
        -0.16315985175683545, 0.06800382486186407, 0.18259171842061128,
        0.1337404064014181, 0.02797476804020356, 0.008203042979551836,
        0.10651498325362777, 0.2101623615512173, 0.17408547090292759,
        -0.02876816157668849, -0.2659603223982096, -0.3565295918671977,
        -0.2323218006281469, 0.0015496356052394633, 0.163707954457175,
        0.15915207257278707, 0.05481514207001109, -0.000298986233956966,
        0.06996165788873158, 0.1901548813053732, 0.20745107872323365,
        0.0473346421266273, -0.20045274162516313, -0.3516039977030643,
        -0.2900523273226603, -0.07168514004497983, 0.12832129475659626,
        0.17440384470983972, 0.08605140559321944, 0.003042226565359185,
        0.037801273182820234, 0.15954994097337138, 0.22310117889792247,
        0.11493805352697162, -0.12489146926887029, -0.3249635710144092,
        -0.331631098163483, -0.14632287981447467, 0.07780331983945554,
        0.17615212435174699, 0.11739472580713636, 0.017492791139631786,
        0.013682535336139612, 0.12271091165889929, 0.22150166735386984,
        0.1695742480597574, -0.04499794677006308, -0.27855417310093694,
        -0.3535450440425022, -0.21661807161419377, 0.015045945207871614,
        0.16224749839366504, 0.1443094211897888,
      ],
    ];
    const result = wavedec(data, "rbior1.1");

    const reconstruction = waverec(result, "rbior1.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49245256984829344, 0.9073080505664505, 1.1837080542563787,
      1.2902042318223312, 1.230316975818408, 1.0397213443183277,
      0.7758959070178371, 0.5029460862281706, 0.27549515724219475,
      0.12572586819779452, 0.05680835735161133, 0.044283962764878435,
      0.04491580717178707, 0.010591272013732, -0.09644011035099614,
      -0.291055283672843, -0.5588359103309832, -0.8575341732194401,
      -1.126191532917469, -1.29969426302452, -1.3251249452351108,
      -1.175766192059697, -0.8591624220038335, -0.4171108144940021,
      0.08253600609237495, 0.5603242188716866, 0.9424112148477981,
      1.1763482840337638, 1.2416093240967883, 1.1523652304119048,
      0.9519520481744701, 0.7005600580694984, 0.4593542839787628,
      0.2750990849006583, 0.16918419260090445, 0.13378429915980183,
      0.13602818716258033, 0.12898090840514437, 0.06648273731011528,
      -0.08210938700554093, -0.3212136756664015, -0.6252535353467111,
      -0.9429501662602794, -1.208725183765119, -1.3584173032869136,
      -1.3453779523517568, -1.152867983317789, -0.7995706345627498,
      -0.33674051234192054, 0.16240581246060096, 0.6185126352583805,
      0.9632744127293951, 1.1538094010223963, 1.1807516349527831,
      1.068180589822247, 0.865560184587017, 0.633857821429651,
      0.42945380667404975, 0.28996831994673755, 0.22559853870781482,
      0.21811141698028585, 0.22764870628417083, 0.20547833271591617,
      0.10928658579162276, -0.08305814719975596, -0.36495732512685847,
      -0.7001059945039256, -1.0295029592943747, -1.2848046846987757,
      -1.4047317250997011, -1.3504180430992134, -1.1158159511142594,
      -0.73047894559186, -0.25393693881141954, 0.23702481105900008,
      0.6651008529604787, 0.9691355928927632, 1.1166779832869127,
      1.1094172889694742, 0.9802947378026031, 0.7831794986083225,
      0.5778555590570016, 0.41421840166058754, 0.31973648010466255,
      0.2933555100076974, 0.3073393785039473, 0.3164810606473575,
      0.2722067277530239, 0.1378240938609494, -0.09914289496804851,
      -0.42085700547891347, -0.781041623616494, -1.1145162049497008,
      -1.3521092831967327, -1.4372622590372406, -1.3401649917826464,
      -1.0658452954833066, -0.6541240041304489, -0.17136966399139836,
      0.3039690804015597, 0.6985267303846862, 0.9596914770570544,
      1.0659867195544246, 1.0297124665969737, 0.8913520074085504,
      0.7073203448891209, 0.5342915662802366, 0.4141724615350115,
      0.3635807573632201, 0.37049422769603113, 0.39886763572142997,
      0.3999460235442619, 0.32726375794691487, 0.15135333456994965,
      -0.12975658289537645, -0.4871110095228423, -0.8655220259441472,
      -1.1953600351553337, -1.408586103861651, -1.4550548216596164,
      -1.315006010519637, -1.0045860927585797, -0.572964404347304,
      -0.09170085792656449, 0.36104956325350024, 0.7176307565646487,
      0.9351068432518481, 1.0031828099638094, 0.943998954284047,
      0.8040284623820324, 0.6402928682244207, 0.5045228774860235,
      0.42937497591233476, 0.4202470949663992, 0.4547663333966294,
      0.49002500187611725, 0.4756285253440166, 0.3691043151712582,
      0.14959187864625267, -0.17384719087568712, -0.5616002856260611,
      -0.9508997512916285, -1.269531538663144, -1.4525129685762561,
      -1.4576057106659406, -1.2757838985628323, -0.9340134112722716,
      -0.489605447215548, -0.017503822357008425, 0.4063790572121148,
      0.7216915363861393, 0.8960094860464743, 0.9300836823084331,
      0.8548218727859533, 0.7209500075534903, 0.5841363107598977,
      0.4894837388343807, 0.459417725061659, 0.488088561111586,
      0.5437047890902722, 0.5781513900474639, 0.541351554405986,
      0.39658779784139464, 0.13272543436904388, -0.2299499215432652,
      -0.6419532850218443, -1.0344993122785195, -1.3347313535610625,
      -1.4825510969636861, -1.4448770178909518, -1.2237712501551439,
      -0.856386869920337, -0.40671941280094526, 0.04881575806858757,
      0.43842996818991753, 0.7104478689772853, 0.8434710079584322,
      0.8488213789051559, 0.7648317952475587, 0.6446120341760275,
      0.5405566091378569, 0.4896570187830223, 0.5034377706861933,
      0.5651157450770574, 0.6346993688947726, 0.6606792120721556,
      0.5952427731525581, 0.40901301165584736, 0.10140216190415319,
      -0.2962320271606919, -0.7256185358149166, -1.1136990585907176,
      -1.388934030960997, -1.497786074459094, -1.4172977884899027,
      -1.1606315101862155, -0.7741814891697552, -0.32696378292146244,
      0.10509343530422999, 0.4560810594781863, 0.6841067436400241,
      0.7789740298454616, 0.7617773159138879, 0.6767036383359369,
      0.5773030591347996, 0.5108741911802306, 0.5050594312908637,
      0.5601438616155527, 0.6490576336005045, 0.7250765325631098,
      0.735211946904512, 0.6357918107747217, 0.4061396239792011,
      0.056712836086252716, -0.37054889620981707, -0.8099427228473545,
      -1.186011403769216, -1.4304500166531628, -1.497755834323453,
      -1.3757508908393201, -1.0883680693908948, -0.6900119505448081,
      -0.25289991665660566, 0.14947223530273684, 0.4586517658171094,
      0.6433370086384784, 0.7043668236799256, 0.6715094115459663,
      0.593054808445161, 0.5210346947576818, 0.4959835695890042,
      0.5352410238872647, 0.627855946366613, 0.7374311046230403,
      0.8121812364806265, 0.7995974741359746, 0.6618964793492766,
      0.38819551533784485, 0.00015746468939087377, -0.4505096833733078,
      -0.892251884093405, -1.2491589495062256, -1.4579773540185939,
      -1.482464797318373, -1.3215459989496021, -1.0092629568339953,
      -0.6065525823376033, -0.18691466732793904, 0.1804594863575888,
      0.44592302242306076, 0.5892489065861396, 0.6218067559938761,
      0.580673813120067, 0.5163651077913634,
    ]);
    const expected = [
      [0.19263549052082174, 0.17716825733149716],
      [1.2604447891822361, 0.8777265928711504],
      [
        0.492768161573045, -0.47334615960768023, 0.4173072106347144,
        -1.3939120219144774,
      ],
      [
        1.7124115837995242, -2.134356193314202, -0.5849063154907742,
        1.792473119821025, 0.49583186839898596, -2.345086056082491,
        0.4083691258730157, 2.475892540027613,
      ],
      [
        1.4888201832572139, -3.2959500586246717, 2.276597234646995,
        0.2287365530038723, -2.0263542467205187, 2.196839769006335,
        -1.228280353870163, -0.1955619042941299, 1.6679858555086435,
        -2.48048651237837, 1.6369774304860387, 0.8503834435226494,
        -3.1313199420733273, 2.932194038584714, -0.08128648177349196,
        -2.933412934791657,
      ],
      [
        -0.6196623448316907, 0.3385714021202872, 0.6456347792048185,
        -1.1858584695548953, 0.40266955352946704, 1.0938452793689266,
        -1.6692700675949668, 0.4744697596087765, 1.425040262090839,
        -2.0235765286269385, 0.5369188248048378, 1.6174927230545904,
        -2.213130367764819, 0.5711871763371533, 1.6636050709886911,
        -2.216672856646849, 0.5595307014441595, 1.5698578367624063,
        -2.029706639027569, 0.488164853478673, 1.3553372410836646,
        -1.665261275745518, 0.34977341634499726, 1.0490538938239087,
        -1.1529494880728595, 0.14531002950009186, 0.6863866433283242,
        -0.5363861550075109, -0.11517166132706869, 0.30506791930249477,
        0.13078946288256854, -0.42656005739093783,
      ],
      [
        -0.7992817674872681, 0.35245197815228724, 0.2979535089604798,
        0.08752430413696484, 0.5669172560665416, -0.2949452970980502,
        -0.9186551210605561, 0.1568201647720886, 0.3578155322733493,
        0.03717442030356127, 0.5824403194675243, -0.034448275691243424,
        -0.9586147973118261, -0.06592420551161937, 0.3899979396979403,
        0.005291458344006794, 0.5456458791113254, 0.22042106210288215,
        -0.91469138447685, -0.2959294132015726, 0.38570013784666834,
        -0.005364224519472438, 0.4650153610304677, 0.4469068568338894,
        -0.790258309572053, -0.5115911929126166, 0.33972628141808336,
        0.004195677740385262, 0.3528065149083019, 0.6256565517749978,
        -0.5962551675366851, -0.6916944472447808, 0.25143021682070177,
        0.029442212517664823, 0.22347866670131156, 0.7424919067265121,
        -0.35016068470354655, -0.8175899315854054, 0.12516064400773197,
        0.06305688171051665, 0.09195841344517769, 0.7896140550630715,
        -0.07431709123932673, -0.8751760044898936, -0.029867148608498595,
        0.09603692692233445, -0.028053435626441803, 0.7661328682678046,
        0.206225386698641, -0.8564713258693691, -0.20028177132056946,
        0.11903653749982113, -0.1255434921257822, 0.6778837474387436,
        0.4661258621800225, -0.7606035465144008, -0.369789915599279,
        0.12377297782222063, -0.19325768542489463, 0.536570486729008,
        0.6821873680290533, -0.5940976285481883, -0.5208135549897753,
        0.08487517676560818,
      ],
      [
        -0.3482165515524703, -0.195444316929135, 0.04234668482702886,
        0.18655275576468322, 0.1608320942731634, 0.04873203926183358,
        -0.00044678146477988845, 0.07568261626986954, 0.18934949698035414,
        0.1899694408581497, 0.017982207841308884, -0.22387267275572742,
        -0.3533036550349255, -0.27017630585790553, -0.04614652397585162,
        0.14171352019926542, 0.17055823852090962, 0.07489313857379881,
        -0.0015866684229878109, 0.044192880593052146, 0.16907226392288024,
        0.22464544207910386, 0.10584831280404816, -0.136125104549931,
        -0.3272703179597469, -0.32251622734576096, -0.13472858227528062,
        0.07959974937705894, 0.16383831220552153, 0.09863113354198863,
        0.005294194545104852, 0.015676821491551862, 0.13600826502371977,
        0.23698589682217241, 0.18052558128207785, -0.038405572853754566,
        -0.27247440964700675, -0.3471623826365873, -0.2149850263224068,
        0.005134086187983389, 0.1393815223094842, 0.11570894364909479,
        0.018654162849843586, -0.0064641454350573, 0.09502287169879507,
        0.227486229145631, 0.23580213781405546, 0.06021224665503733,
        -0.19397331746629742, -0.3413588675595598, -0.278994389872097,
        -0.07516208677775893, 0.09783561894021864, 0.12234982269476796,
        0.03577373709165749, -0.020063029220132367, 0.051394122875885795,
        0.1987747288985228, 0.2675769957871987, 0.1507735991079856,
        -0.09902946405419344, -0.3052026227828001, -0.3201428930014893,
        -0.15377881564243212, 0.041849305687926, 0.1157785489504557,
        0.0531375907946946, -0.02440878757541104, 0.010179846181041341,
        0.155218732421613, 0.27418284272405935, 0.22530669755198884,
        0.003601112466449896, -0.24166822917258624, -0.3338262603466609,
        -0.22295959221669476, -0.024094095240312252, 0.09466170371596627,
        0.0669294754652805, -0.02027334259319108, -0.024357425125657195,
        0.1023634339368612, 0.2564502035348384, 0.2775719578010344,
        0.10452434295325053, -0.1563453877254476, -0.317962908208033,
        -0.27549885002343283, -0.09406156362828955, 0.05938960415332173,
        0.07357829666373894, -0.009744463120581637, -0.04920305226104016,
        0.04627054969674671, 0.21751371782597917, 0.30362211201941847,
        0.19462051538271663, -0.05691381281489738, -0.27326143045042284,
        -0.30551058886798316, -0.16123850755553748, 0.012159913035140968,
        0.07028682360699468, 0.004111656148742815, -0.06287153111143384,
        -0.0071668202109409496, 0.1623886185974323, 0.3021196682480623,
        0.26592071447172827, 0.0475924000879675, -0.20321034184270437,
        -0.3090848833005919, -0.21862294263078597, -0.04315459607036809,
        0.055475781867878604, 0.01771382048312492, -0.0654886397242136,
        -0.052856325131087734, 0.09736930718980763, 0.2743843369719308,
        0.3123589056654497, 0.1476569098672511, -0.11378677354694877,
        -0.2847592366605728, -0.2597727553037056, -0.10134670461127065,
        0.0290853828362293, 0.0,
      ],
    ];
    const result = wavedec(data, "rbior1.1");

    const reconstruction = waverec(result, "rbior1.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4933040365663941, 0.9096313830409941, 1.1883484014227137,
      1.2975923722166942, 1.23984057902498, 1.0493768310921456,
      0.7824140628604275, 0.5024356445663848, 0.2644729391023766,
      0.10225521325412357, 0.02139844384602274, 0.00023828231522360355,
      -0.0020454256307866625, -0.03222528270477276, -0.12825002901687,
      -0.30680134760411915, -0.5564961880889769, -0.8386091375044546,
      -1.095269833139702, -1.263173470451167, -1.289412268822892,
      -1.1454545652015105, -0.8357151339931361, -0.3984737134743661,
      0.10121855505778025, 0.5850235397225971, 0.9779857096635424,
      1.2243906603084072, 1.2990176486868201, 1.211134002050937,
      1.0003772852975221, 0.7256742064914746, 0.45005232023309283,
      0.22518541969899353, 0.07953163479173408, 0.012973236550285483,
      -0.0008092741122436437, -0.004975062106782779, -0.045700870542943695,
      -0.1575622881044188, -0.3519843437303834, -0.6118462878139319,
      -0.8937574679929835, -1.1375617914235516, -1.2807717828831364,
      -1.2743487598477312, -1.0958588441422419, -0.7566457112630122,
      -0.30111964274542913, 0.20179508135868576, 0.6730717814502325,
      1.0404162515494249, 1.2534876228111926, 1.2938685426569623,
      1.177450430284383, 0.9487776348585376, 0.6688778733966867,
      0.39969929354011874, 0.18907940398525647, 0.059988737259182745,
      0.006671395714106271, -0.0014698294235604894, -0.009375749389228916,
      -0.06203774509572346, -0.19019257351792274, -0.3997911974543086,
      -0.6680672100372838, -0.9473483476831325, -1.1757752343765473,
      -1.2923144019269186, -1.2523269851511734, -1.0397661269563192,
      -0.6728754903356018, -0.2018505473827482, 0.30109306195551483,
      0.756919673909999, 1.0966108418209914, 1.275601788107234,
      1.2823750288666673, 1.1392180556219644, 0.8950910983302406,
      0.6124949861899405, 0.35169194086394107, 0.15624906311211656,
      0.043493365304865694, 0.0021872739852828726, -0.0021208764908525954,
      -0.015577180551871128, -0.08141080306817228, -0.22609506623691167,
      -0.44994849917654395, -0.7247130258935138, -0.998867377848137,
      -1.209454686178366, -1.2975236183527976, -1.223327152953937,
      -0.9774351948281932, -0.5848967938126701, -0.10129161170479586,
      0.3984869502281556, 0.8360739031161978, 1.146309341101478,
      1.290751585256993, 1.264813819214505, 1.0968920047788189,
      0.8398324961923965, 0.5569725957297408, 0.3063052456556074,
      0.12674187593743363, 0.02987197472917652, -0.0008080999824031931,
      -0.003139990582649854, -0.02388586966593037, -0.10395464282292871,
      -0.26517726980489226, -0.5021423831572097, -0.7813148103151354,
      -1.0478016078200234, -1.2381714612972472, -1.296168360850189,
      -1.1873853715525313, -0.9091769023792853, -0.49323782680404926,
      -7.913273236439199e-5, 0.4933675223501397, 0.9100810041260526,
      1.1893054711658715, 1.2990105564122458, 1.2415051414114906,
      1.0509495496909849, 0.7835131078537758, 0.5027306721345827,
      0.26377156024365567, 0.10055888856855494, 0.01891327674490556,
      -0.002662714093811386, -0.004900003861100455, -0.034581085150881374,
      -0.12976134034119274, -0.30730024321236366, -0.5560212042810402,
      -0.8373851226612339, -1.093644711227848, -1.261528237207616,
      -1.2880670015668665, -1.1445939528354545, -0.8353518596902321,
      -0.3984582661383316, 0.10114493599118948, 0.5851470720073838,
      0.97853105230662, 1.225448133671725, 1.300506021486034,
      1.2128091231843652, 1.001885143657741, 0.726635615132283,
      0.4501582180170158, 0.22427884155568517, 0.0776554777452218,
      0.010371287258873318, -0.003739062391703518, -0.007764230593450494,
      -0.047911074626115435, -0.1588786832369241, -0.3522793415462314,
      -0.6111986423292121, -0.892422724298117, -1.1359021459151175,
      -1.279163358334814, -1.2730897047868388, -1.0951011827847867,
      -0.7563676367179687, -0.30114454565995474, 0.20173849541170813,
      0.6732643972514835, 1.0410609356078788, 1.2546422026058066,
      1.2954172393549777, 1.179121819646126, 0.9502053338748339,
      0.669689183146776, 0.3996097423792568, 0.18796937711028533,
      0.057942608313627075, 0.003968747904297271, -0.0044094799301261835,
      -0.012081794070194968, -0.06408962198847751, -0.1913088828900541,
      -0.399885458630842, -0.6672572034817347, -0.9459174858851463,
      -1.1740962451532668, -1.2907548268754163, -1.2511602936176933,
      -1.0391105594560155, -0.6726755162168614, -0.2019048829218068,
      0.3010648135239815, 0.757189531450762, 1.0973571769603379,
      1.276848784332255, 1.2839730856593046, 1.140870924945234,
      0.8964236021315236, 0.61314472803271, 0.35140212983502533,
      0.1549390125561434, 0.04128856995264579, -0.0005991182675911533,
      -0.005051372810002258, -0.018183105177438874, -0.08329297402617264,
      -0.22700777984166715, -0.44984676069614465, -0.7237520846280443,
      -0.9973554350659168, -1.2077711883331548, -1.2960239391902821,
      -1.2222576143329964, -0.9768795042369367, -0.5847668257866327,
      -0.10136409517089762, 0.3984979861795839, 0.8364281728632115,
      1.1471582804124136, 1.2920849444344638, 1.2664492720550313,
      1.0985112123798215, 0.841055186040688, 0.5574504188706707,
      0.30581193569625575, 0.12523688685008527, 0.027521173378726616,
      -0.003660556966594758, -0.006042394320751543, -0.02637554101346956,
      -0.10565717008096343, -0.2658845525121531, -0.5018508950255725,
      -0.7802153622640152, -1.0462238937112942, -1.2364978004067515,
      -1.2947385299372216, -1.1864163830003425, -0.9087175574410795,
      -0.4931688838790703, -0.00015825463526342566, 0.4934282933605363,
      0.9105257703715528, 1.19025657938134, 1.3004229058531753,
      1.2431651363060463, 1.0525197497882326, 0.7846119332367806,
    ]);
    const expected = [
      [
        1.395274517771176, 1.395274517771176, 1.2446761705506788,
        0.009697318218067963, -1.2274600932908344, 0.7933188931860325,
        0.48030460972805405, -0.6108765062423892, -0.565743647808521,
        1.346637769026818, 5.539177712230468, 5.539177712230468,
      ],
      [
        0.018824793402562136, -0.018824793402562184, 0.8208924671387547,
        -3.0040413901083873, 1.0060812490416151, 1.9583218894904146,
        -1.6441573475589033, -1.195905469300812, 2.0333374398249173,
        1.1742009054790832, 0.5240674929004563, -0.5240674929004563,
      ],
      [
        -0.07455479959891903, 0.07455479959891903, 1.932832559001525,
        -3.994868663601097, 1.9940591334676088, 1.9254720039164812,
        -3.9261580301490855, 2.2961629545435214, 0.9834690168554874,
        -2.849924311372552, 2.3116585662022877, -0.5327048340771734,
        -1.1897417248661426, 2.306974228447656, -2.262974583593808,
        0.45953386180011024, 2.364773558474579, -3.163545202774172,
        0.1643801104641821, -0.164380110464182,
      ],
      [
        -0.2325009552585357, 0.2325009552585357, 0.5930223315361527,
        -0.21363670858655115, -0.4105080625510571, 0.5354117960316707,
        -0.34510068073438294, 0.1561544470284622, 0.01691060314141543,
        -0.3251759752139123, 0.6489076587055942, -0.5568833050119246,
        -0.1575794572684284, 1.0051993515715898, -1.1076783343395584,
        0.12609740151043664, 1.1859235710069485, -1.5581644983920118,
        0.47170115626870895, 1.1810092331502131, -1.844080912597871,
        0.8116471761030323, 1.0102689425759686, -1.9242951397372712,
        1.0763710091943046, 0.7194022325550874, -1.787270976426007,
        1.2062199402885132, 0.3718345790377487, -1.4528822759189315,
        1.1618279702961511, 0.037748636593016666, -0.921947148487648,
        0.9184378380666305, -8.326672684688674e-17, -0.9184378380666304,
      ],
      [
        -0.22805029141078717, 0.22805029141078717, -0.11897087060844908,
        0.2503432662718559, -0.1636741201068999, 0.06339166050430174,
        0.23093763367767053, -0.3061521286203065, -0.12609561282427761,
        0.28229634647115864, -0.10043972763350431, -0.03561579709761049,
        0.2771305096552686, -0.21292687078556988, -0.23970929082616318,
        0.26974848817613084, -0.01094386638789474, -0.11970893135269262,
        0.27799464310007005, -0.0945151961521462, -0.32404593962310446,
        0.2125311018337924, 0.0891467770027172, -0.17419489223188633,
        0.23559222752736766, 0.03114179768685834, -0.3662179167643418,
        0.11777003653809168, 0.18208343917369796, -0.18960771497828227,
        0.1589398394211255, 0.14525675455113765, -0.35976224848582666,
        -0.001183909422871221, 0.2509806672234416, -0.16327185604759367,
        0.062456103499282836, 0.23118299808724074, -0.3056751566808143,
        -0.1268413127553628, 0.28263360838992335, -0.0997440421577643,
        -0.03646197865853882, 0.27704271006462444, -0.21225229623721742,
        -0.24034158240198059, 0.2697462987916589, -0.010061328045539053,
        -0.1203368138645483, 0.2775723208824724, -0.09376058289984993,
        -0.3244547893273187, 0.2122054090426041, 0.09008195222012796,
        -0.17450823722500955, 0.2348886348398144, 0.0318433266680629,
        -0.3663325427892191, 0.11718881954178964, 0.18293082691977017,
        -0.1895583745855988, 0.1580548118398905, 0.14577858299024873,
        -0.3595628025872286, 0.065027139337142, -0.06063168911638048,
        0.06063168911638056,
      ],
      [
        0.20698399157482072, -0.20698399157482072, -0.016405516581510952,
        0.0173086883969258, 0.032277460420126775, 0.017285614781146943,
        -0.01077114296611524, -0.02349886469830506, -0.00824596301814978,
        0.019812695808493118, 0.03217312533142241, 0.014373682903170343,
        -0.019673908765591358, -0.04007167055055974, -0.028552431958516283,
        0.004550774040150959, 0.02990813770630757, 0.026355713269091294,
        0.00014740657068368357, -0.021666892147894582, -0.01731564206388526,
        0.00887848770891894, 0.03062678333913423, 0.024843850583461842,
        -0.005953052913791418, -0.03527880193992884, -0.03699444549069597,
        -0.009556447381635927, 0.02254756103165753, 0.031524395056743953,
        0.011840833725650951, -0.01529874523398625, -0.02259587047735303,
        -0.0028084691508588893, 0.0243346235447443, 0.030991793185433693,
        0.008006449040995359, -0.02574232766745009, -0.040426774450149194,
        -0.022874466043563562, 0.011189320650881865, 0.031751372102790734,
        0.02226128038347222, -0.005486702004653447, -0.023181188400909956,
        -0.013208841538641972, 0.014516464111673757, 0.032023105116398276,
        0.020096815591048478, -0.012935260441382587, -0.03831796229993134,
        -0.03336185400766431, -0.0025096088163928942, 0.026792159359272524,
        0.029541197860184804, 0.006078090183797541, -0.01897100178674779,
        -0.02052631590509773, 0.0029477233424333124, 0.027978293837282463,
        0.02853726423271266, 0.0011750723075344832, -0.030995184524407693,
        -0.03940105370619862, -0.01649047508421593, 0.017246290398624464,
        0.03230400264289744, 0.01738443260348857, -0.010686156157797791,
        -0.02350389995385547, -0.008336496209396284, 0.019717697355595018,
        0.03215593872552762, 0.014442137717447928, -0.01959170474953724,
        -0.04005774766400837, -0.028620532084421745, 0.004468299675403881,
        0.029895724663127538, 0.0264333511339606, 0.0002497237932046342,
        -0.02163099989166407, -0.017378518936266487, 0.00877335712473078,
        0.03057221920783103, 0.024883103399609294, -0.005864995916269461,
        -0.03523079530156381, -0.037034001199888755, -0.009644403482315402,
        0.022499672543408858, 0.031569601280159565, 0.011944780207145414,
        -0.015227501241585312, -0.022621348958997114, -0.0029077380686089696,
        0.024250115041578056, 0.030994047247716934, 0.008085004957654768,
        -0.025668444157281187, -0.04043102113894638, -0.022952617588699938,
        0.011115135948618987, 0.031758248890547236, 0.02235110097066763,
        -0.005391141916270978, -0.023165315369105564, -0.013286987081542518,
        0.014414407650692514, 0.0319865247146707, 0.020151872217805955,
        -0.012848189805810775, -0.038286170034522476, -0.033416748159857464,
        -0.0025967600974499128, 0.026761062254107834, 0.02960359775061215,
        0.0061832424157308025, -0.018916247942679064, -0.020571253491672423,
        0.002843518329735815, 0.027907362684034646, 0.028558504750646176,
        0.001260247893441993, -0.030932778307364156, -0.039423288388009944,
        -0.01657533148049356, 0.017183710333936772, 0.12699692354689363,
        -0.12699692354689363,
      ],
    ];
    const result = wavedec(data, "rbior1.3");

    const reconstruction = waverec(result, "rbior1.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5043998797946998, 0.9271903454034274, 1.204644923103425,
      1.3043757110212375, 1.231071296327237, 1.023205510943223,
      0.7417135564407771, 0.453671194464534, 0.21525581919528314,
      0.05839565020139703, -0.015504135468444646, -0.0332630940140577,
      -0.039833218527147746, -0.08324957732353794, -0.19876699895677302,
      -0.3965385337399861, -0.6562550791531379, -0.9303249275061702,
      -1.1549080696343446, -1.2660248634145912, -1.2165808906907722,
      -0.9898519201519569, -0.6058364173057362, -0.11868716192838849,
      0.394287760632353, 0.8494011754811723, 1.175000104379189,
      1.3269514904901338, 1.2973838310117796, 1.1145951193006822,
      0.8342957268403125, 0.5245594197762607, 0.2484362711550565,
      0.048730293918728795, -0.061176698848492805, -0.09819958350363991,
      -0.10207144363911534, -0.12166633976484881, -0.1989083994176415,
      -0.3546828150844284, -0.5806302753840054, -0.8391475872561496,
      -1.071741315359226, -1.213657187074818, -1.2110180067684557,
      -1.035990557094136, -0.6959568248281927, -0.23417242109656683,
      0.27843349985791155, 0.7583893332748308, 1.1280301281390726,
      1.3325173211755217, 1.3513154056492307, 1.2013275827846586,
      0.9310236026442731, 0.6071876086205699, 0.2977780307083295,
      0.055344065572630996, -0.09475984354585454, -0.15842205430414086,
      -0.16820314747701273, -0.17154156711931362, -0.21502942504689787,
      -0.32907908461680135, -0.5171879121697438, -0.7527857093907843,
      -0.9846368458258127, -1.1494934011008848, -1.1887522999080147,
      -1.064768040684107, -0.7725038314182635, -0.3433635781990575,
      0.15996295656840853, 0.65650422637035, 1.064699602179005,
      1.320404542699707, 1.3907399944676382, 1.2803738773599183,
      1.0287536442585905, 0.6991150858461601, 0.3621768867068256,
      0.07875424720395918, -0.1142523573781059, -0.21096951924744686,
      -0.2350816757076748, -0.23036529605485437, -0.24591315703615285,
      -0.32012278606451494, -0.4678347976029001, -0.6741623077465047,
      -0.8967733552536389, -1.0761399053633782, -1.151137984301604,
      -1.0759316427775834, -0.8336806285808727, -0.4433840616099838,
      0.04208731053222095, 0.5464593451496141, 0.9865212659971213,
      1.2905340819656153, 1.4140092477544086, 1.3489465130029836,
      1.124284935128957, 0.7975599111385341, 0.4399923732448445,
      0.11888650898740077, -0.11814597563557255, -0.2531469521979227,
      -0.29953012458193407, -0.29530899378133324, -0.28981873716805157,
      -0.3276164725723135, -0.4339702775887106, -0.6059105193595922,
      -0.8113327803333726, -0.9964987079036309, -1.1000403970030788,
      -1.069822319681946, -0.8782121958082205, -0.5316714233550529,
      -0.07200697245292959, 0.4312393242912973, 0.8955043340762574,
      1.243419520372969, 1.4200094833929149, 1.4045956163763083,
      1.2144693492792094, 0.8994944601049202, 0.529103889782478,
      0.17507696436498693, -0.10547792380477711, -0.28261875179216644,
      -0.35845139877680887, -0.36332356439784086, -0.3445418137388978,
      -0.35077695893933614, -0.41643823160573845, -0.5502829363252449,
      -0.7313905649119601, -0.9136671821477317, -1.0377713374843949,
      -1.0473624638781105, -0.9053886541314059, -0.6060650137354705,
      -0.17926732080918836, 0.31399766933690354, 0.7940857443501691,
      1.180149755325268, 1.408200272454558, 1.4452933975215174,
      1.2963199158986345, 1.001749484604358, 0.626983375877719,
      0.24609454666614655, -0.07586466075442633, -0.2974898203060038,
      -0.40893552227375385, -0.43124496108821636, -0.40749096664710527,
      -0.38826266762434014, -0.41549822123459773, -0.5090740647411922,
      -0.6598096096121646, -0.8308311078155725, -0.9670090375489383,
      -1.0100236327548353, -0.9150891544067681, -0.6648798143394516,
      -0.27687962182525583, 0.19794867160094912, 0.685046680248667,
      1.1023518531511456, 1.3786332892939135, 1.4695040903681476,
      1.3671136475217385, 1.1011230672681542, 0.7307820369057952,
      0.33018293660740256, -0.02951565942227502, -0.2963714637878661,
      -0.4483605046338266, -0.49590376508205125, -0.47577747821596,
      -0.4382202261066273, -0.4308167853310514, -0.4835585822389925,
      -0.599141560241821, -0.7511546807941782, -0.8907055191705194,
      -0.9597753665486952, -0.9077854776982673, -0.7069638860660011,
      -0.3623645685157285, 0.08625723493105084, 0.5714172420846664,
      1.0121353730268077, 1.3319507765384844, 1.4762369573193161,
      1.4244852890810935, 1.1944907165242564, 0.8374281330314084,
      0.42512059646451417, 0.032773250179400915, -0.27842984255745,
      -0.4744832870672222, -0.554234955625497, -0.5463153565069011,
      -0.4983487099074718, -0.4614791815896194, -0.47444752128057144,
      -0.5515388359911169, -0.677671281663754, -0.8119845323466427,
      -0.8990168592170344, -0.8845252240998789, -0.7317374533022913,
      -0.43366246963994737, -0.018069590236849564, 0.45637255183460934,
      0.9120200798643721, 1.269363677689999, 1.4650805316642077,
      1.4665087579090406, 1.278912809134746, 0.9437324625246025,
      0.5282968428673004, 0.10964674667072005, -0.24341530236885836,
      -0.48551763447806184, -0.6033840886215367, -0.6159281646400918,
      -0.5659793176156445, -0.5060211697868763, -0.48186388778375544,
      -0.518680428383399, -0.613178766416347, -0.7340335895956199,
      -0.8304938367380048, -0.8468951695840549, -0.7392122780902552,
      -0.4892036013116965, -0.1122856289091354, 0.3431238705052323,
      0.8048495364275998, 1.192610190562898, 1.4362169179762911,
      1.4917634688414911, 1.3517356786321846, 1.0464979054054964,
      0.6368013375756294, 0.1992361664916673, -0.19167157526464335,
      -0.4801962894190028, -0.6408062253284138,
    ]);
    const expected = [
      [
        1.4266583017300467, 1.4266583017300467, 1.2761173790185987,
        -0.26218911636035447, -1.0869081181667526, 1.4181021742502966,
        -0.37647422331914626, -1.0159931722560938, 1.3944749132396674,
        -0.3306895139748054, -2.0139360342009622, -2.0139360342009622,
      ],
      [
        0.018817615338931032, -0.018817615338930976, 0.540799024481828,
        -2.681960041691074, 1.9002576200090027, 0.8095786827294663,
        -2.762489385543653, 2.014792943477506, 0.6636639077916642,
        -2.7950473365627153, -0.21040581502826963, 0.2104058150282696,
      ],
      [
        -0.05315357286124559, 0.05315357286124561, 2.0367701362851265,
        -3.7280114393354404, 1.280098578094497, 2.5890583320281797,
        -3.9080145887516284, 1.2265602313944752, 2.7688411925666165,
        -3.9654391921734744, 1.103528032443492, 2.880638423577495,
        -3.8988473426429624, 0.949794703282128, 2.8929363551021443,
        -3.7225909857878365, 0.8258106225025759, 2.3965679144509213,
        -0.8875835064973752, 0.8875835064973753,
      ],
      [
        -0.22466235709433907, 0.22466235709433907, 0.64014708588397,
        -0.11279288821195627, -0.7621890724897378, 0.8765526239418175,
        -0.2231147442891962, -0.5350521481416907, 0.7375059353993695,
        -0.2991739485764299, -0.31105270530772816, 0.5677177550396147,
        -0.3381029563667307, -0.09741912772276623, 0.37230909821171326,
        -0.338332010609423, 0.09899190243427233, 0.15728787825189222,
        -0.2996433831720121, 0.2719312923826263, -0.07065758585988377,
        -0.2231790212491638, 0.4159724832636877, -0.30438850734484674,
        -0.1114013353740691, 0.5266980460316897, -0.5365610931829312,
        0.03199152007392167, 0.600851500108542, -0.759879072746945,
        0.20219295507590124, 0.6364491243992423, -0.9421790007280868,
        0.2421720105375577, 2.2551405187698492e-17, -0.24217201053755774,
      ],
      [
        -0.2286551572666205, 0.22865515726662056, -0.11274047432990977,
        0.25440308475811757, -0.17754710325149936, 0.10178639621655498,
        0.19960653163365594, -0.35960850854281934, -0.04734362858164878,
        0.2841067005151642, -0.15469858681370666, 0.04969125911883863,
        0.22990574101957045, -0.33149071254825513, -0.10339393721049892,
        0.30517445005045174, -0.12327996395294671, -0.0020037024692782165,
        0.25117191634738506, -0.29518458636447353, -0.1580271050649629,
        0.31679917010488856, -0.08438942829263234, -0.05145195018278722,
        0.26275405172755717, -0.25192416679460394, -0.20942556210217295,
        0.31849830160585696, -0.039384833285765475, -0.0968858567174083,
        0.26433550072013856, -0.20318086817027262, -0.2558816585215981,
        0.31013057212517214, 0.010163102800547053, -0.13667765072461746,
        0.25594482895543835, -0.1506128003364144, -0.2958564553928517,
        0.291900920335604, 0.06252492733970838, -0.16939554212880628,
        0.23795477258482375, -0.09600765587266417, -0.32803270371083726,
        0.26435349276226566, 0.1158720542534398, -0.1938530941307254,
        0.21106933848612958, -0.04122113426845879, -0.35136018660073964,
        0.22835295407476222, 0.16833978191019594, -0.20915014083648648,
        0.17629949070500026, 0.011886975464801122, -0.36509186251007153,
        0.18505475480313538, 0.21809155682392364, -0.2147038407339428,
        0.13492826085616497, 0.06151685158780319, -0.36880956416098326,
        0.13586538081486646, 0.2989717914882254, -0.4372254151568486,
        0.43722541515684854,
      ],
      [
        0.21281825051984565, -0.21281825051984565, -0.01666911376257662,
        0.019402931978391505, 0.034066251783444315, 0.01637795860831899,
        -0.013331176144040086, -0.024072309705785874, -0.004910673391578305,
        0.024264010555835307, 0.032425530129760266, 0.008307875167607975,
        -0.027746664145413255, -0.042754306707768155, -0.02263242935852213,
        0.014233250054296362, 0.0345647502892136, 0.02188919202939496,
        -0.00830945714614583, -0.024497135770626698, -0.01035076925606185,
        0.019203740222158556, 0.03282634703581926, 0.01395016304833302,
        -0.02221496033289895, -0.042645656315335595, -0.0280681361800176,
        0.008445245715313396, 0.033902654789245326, 0.02682671733349004,
        -0.0027187874042299276, -0.023768198450061118, -0.015179720389660778,
        0.013613489987564686, 0.032069978406322926, 0.018934717435091078,
        -0.016198808265648873, -0.04137781855790355, -0.03279365450369694,
        0.002230928870756245, 0.03209463106008478, 0.031013700004159317,
        0.003244706998744705, -0.02190997684422231, -0.019226542815861374,
        0.007693222996310693, 0.030190637675538264, 0.023096584393255577,
        -0.009901879211093242, -0.03899500280319543, -0.036650695571613816,
        -0.0042029091813181665, 0.029194810674608315, 0.034299044243912225,
        0.009371862093677422, -0.0189860720954935, -0.022347378519617024,
        0.001654176558400413, 0.027261240916029862, 0.026299271987172183,
        -0.003537326588772177, -0.03557961860122054, -0.03951071204865561,
        -0.010641815358987526, 0.025294931624231284, 0.03656260345768576,
        0.015447684984761775, -0.01509701640581742, -0.024430454901012012,
        -0.004288420704281176, 0.023390888993685504, 0.02843944812170706,
        0.0026795552595818423, -0.031249436181371812, -0.04127932391253922,
        -0.016871058443689607, 0.02052118328010212, 0.03771932451176144,
        0.02125876376648124, -0.010376809506412192, -0.025399938652640373,
        -0.009922769156200932, 0.01872110303011721, 0.029450495837733383,
        0.008538745931445449, -0.026153528803477558, -0.04189956729170764,
        -0.02268302238164456, 0.015029864391098643, 0.03772218298115168,
        0.026600623099736445, -0.004988301910069447, -0.025218551279655037,
        -0.015047800233025835, 0.013420942877327466, 0.029304803572969246,
        0.013842731991335816, -0.020467136762475344, -0.041353854319641205,
        -0.02788435451885911, 0.009002003711275755, 0.03656380825291819,
        0.03128477202080382, 0.0008824159914284507, -0.023888856146986538,
        -0.01948010872844093, 0.0076811767935205805, 0.02801471148441964,
        0.018413308964925802, -0.01438562999910091, -0.03966457648394689,
        -0.03230262249220255, 0.0026371285904167735, 0.0342767424917054,
        0.035145201160349415, 0.007032425670249365, -0.0214531727089256,
        -0.02306027643889564, 0.0017077031982427396, 0.025632081231834844,
        0.022097717949940997, -0.008117777324610678, -0.03689333068462454,
        -0.035792250427615156, -0.0038536037832625075, 0.030932324541897427,
        0.03804410551933468, 0.016842201522856107, -5.204170427930421e-17,
        -0.016842201522856128,
      ],
    ];
    const result = wavedec(data, "rbior1.3");

    const reconstruction = waverec(result, "rbior1.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5023988036278834, 0.927481519661145, 1.213689597462074,
      1.3273366873120553, 1.2683161401978211, 1.0681796115317723,
      0.7811949780067127, 0.4706628262814276, 0.19387633845877278,
      -0.010617857855834023, -0.13042312536263578, -0.17968719607417477,
      -0.19257628870458707, -0.2116450901137032, -0.2741851686145967,
      -0.40012806923034194, -0.5846792386667423, -0.7976645644102598,
      -0.9898782340203924, -1.1049476708239598, -1.093817564427408,
      -0.9282517416166922, -0.6099357056938897, -0.17279291135546238,
      0.32224521483897905, 0.7989485562845943, 1.181329745713097,
      1.4094244057043634, 1.4516372945306566, 1.3107895883340093,
      1.022502362616111, 0.6463778987607018, 0.2521491280517882,
      -0.09585701108733685, -0.3522386898718063, -0.49886088087025754,
      -0.5461681062684833, -0.5273659258527725, -0.4871277566598543,
      -0.46781981521333715, -0.4968229505423892, -0.5782236582205302,
      -0.6910254843757978, -0.7943749843221228, -0.8385141714066959,
      -0.7787057622076028, -0.5885925212313908, -0.2695442307190943,
      0.14650411036530303, 0.601642131137193, 1.0231028386377299,
      1.3383975235549213, 1.4909421879797191, 1.452490954370239,
      1.2294259951499225, 0.8614048500772586, 0.4126822337126407,
      -0.041837134010706156, -0.4325184431989237, -0.7091538548968161,
      -0.8500867897606519, -0.8642876229674687, -0.7860982704957598,
      -0.6641499097437872, -0.5473605184864224, -0.4715946819422053,
      -0.450354178373145, -0.47182033351192154, -0.502949279797938,
      -0.49953101012086665, -0.41960613229539184, -0.23676666123705198,
      0.05013493457181656, 0.41347822319148264, 0.8006560321191974,
      1.1444262358208612, 1.3774721746794165, 1.4477333306653106,
      1.3308260814805992, 1.0365302496039113, 0.6077138203390337,
      0.11186693689621827, -0.37282048770484416, -0.7736047903419094,
      -1.0378077669092014, -1.1425467846500719, -1.0974112812546861,
      -0.9396346193369862, -0.7231200478078436, -0.5041435532652719,
      -0.3273183571394226, -0.2152824235514299, -0.16459602858381972,
      -0.1487546419121823, -0.1274254568383495, -0.059448560439853526,
      0.08380646359559035, 0.308235649499734, 0.592675522145096,
      0.8917212687251712, 1.1451628930690687, 1.2918424834674938,
      1.284595154516008, 1.1026105330360139, 0.7581249901647928,
      0.2956906120251509, -0.2159588855098497, -0.6976446802195374,
      -1.0759291036733252, -1.2980055084607234, -1.3418559780382013,
      -1.2193796265946688, -0.9718829979089625, -0.6591510521003534,
      -0.34483724348910405, -0.08175497149053412, 0.09938273691482247,
      0.19513020411110515, 0.22728044057817154, 0.23434034724662323,
      0.2588252253004382, 0.3337198978367806, 0.4716478013222736,
      0.6595987464458937, 0.8606620582201061, 1.0224419449894928,
      1.0901342540647212, 1.0210390701911372, 0.796871905283469,
      0.43072274431345053, -0.03321871657500447, -0.5273101124973116,
      -0.9738225870414302, -1.3009715062467915, -1.4578897250636156,
      -1.4250528849051924, -1.2177416765745916, -0.8817842856482621,
      -0.48265979296121186, -0.0906130188220089, 0.23464800107548944,
      0.45605098687451007, 0.5652636600822845, 0.5815145699442352,
      0.5436459756606202, 0.49757603399551736, 0.4824589100366639,
      0.5191206264349476, 0.6037466247902009, 0.7084549183205002,
      0.7886395755128129, 0.7952466502183135, 0.6888757395981147,
      0.452100718927365, 0.09679914479740298, -0.3355229847777924,
      -0.7807179323856133, -1.1648034695524294, -1.4196523485088919,
      -1.4978852532463358, -1.3834391377983173, -1.0952907431289722,
      -0.683436515988143, -0.2180711753994401, 0.22548001223838146,
      0.5825275667911978, 0.8118028398295989, 0.902339775526765,
      0.8729915065370706, 0.7649229900344734, 0.6291246095390202,
      0.5121791774264206, 0.4438969579532611, 0.4299196237645189,
      0.45111444594420425, 0.4698528526706035, 0.4415210400583276,
      0.32827731366297347, 0.11148195802091332, -0.20047213035362765,
      -0.5710786641831032, -0.9418725061677165, -1.2445052264159422,
      -1.4159365115136726, -1.4131229475965856, -1.2236530090866056,
      -0.8697124203503751, -0.40434197315953774, 0.09921286021432081,
      0.5626118093921043, 0.9184806782605961, 1.1237022233991625,
      1.1669015908630689, 1.0685057175341235, 0.8735536304252529,
      0.6391752441223291, 0.4199154301558387, 0.2545521462288663,
      0.15763037214149156, 0.11771657099644237, 0.10267433616849453,
      0.07049296904710203, -0.01719557164927843, -0.18245446693474365,
      -0.4225706131338981, -0.7080679280117024, -0.9878790424042054,
      -1.200550312862712, -1.288822463293295, -1.2140425204244463,
      -0.9668437949443589, -0.5713883483029969, -0.08199419643269125,
      0.4272039832258506, 0.8772320827168587, 1.2004403874678078,
      1.3541114224470314, 1.328381080562011, 1.1467080621916474,
      0.8589131659090179, 0.5285816080784628, 0.21794702071228406,
      -0.026066251649379923, -0.18130823241202496, -0.2531959130823303,
      -0.2703330975487238, -0.2742466386103733, -0.30598614673306146,
      -0.39310179631955344, -0.5404037407025196, -0.7269454357997069,
      -0.9101001586767401, -1.035804550460104, -1.0524697191949302,
      -0.9250997336536784, -0.6460493205942972, -0.23962776744770992,
      0.24077239732679467, 0.722533973830989, 1.1284681423291087,
      1.3928868547671858, 1.475350138717118, 1.3688798159130613,
      1.1007431460542014, 0.7256791298305787, 0.31323611146762403,
      -0.06772485282133894, -0.36366669945035895, -0.5467185356324007,
      -0.6183803872856559, -0.6059007919515585, -0.5524446294955292,
      -0.5036853779634212, -0.4943105932140275, -0.5379136416704398,
    ]);
    const expected = [
      [
        2.6435699207511036, 2.6435699207511036, 2.6435699207511036,
        2.6435699207511036, 0.3345204371838233, 1.009390724989437,
        -1.447974291937526, 0.24197558524220364, 1.4543360286749591,
        -1.5690941691976523, -0.2637242852477566, 1.896705922188237,
        -1.2491718630227737, -0.92694109669671, 1.9398403736495728,
        -0.6179317196846346, -1.3065674111995194, 1.5702465338181133,
        -0.11167426167451078, -1.0598603411189362, -2.088354242343418,
        -2.088354242343418, -2.088354242343418, -1.0598603411189362,
      ],
      [
        0.3585668050874622, -0.05411834727110811, 0.054118347271108105,
        -0.35856680508746214, 1.9647633803145763, -2.06308067785905,
        -0.8568781521338149, 3.472786324638113, -2.2265716157914373,
        -2.0377737898826846, 4.199666666913297, -1.2118443463452184,
        -3.421404800510187, 3.860481393905994, 0.40017488373330395,
        -3.9387491612603096, 2.6032236713913557, 1.4858306652591244,
        -3.267007869370507, 0.7745004852382991, -0.1304439522260302,
        1.566672139241554e-17, 0.13044395222603022, -0.7745004852382991,
      ],
      [
        -0.054533505004338775, -0.0026401674815615126, 0.002640167481561491,
        0.054533505004338845, 0.9017047403240885, 0.2742398474465418,
        -1.4338098284571448, 1.4963316926831474, -0.438039543642907,
        -0.8562116815853313, 1.4037531260012635, -0.8844324052008417,
        -0.19550483434283877, 0.9933151572556396, -1.0018159874725434,
        0.35535884692691533, 0.39763480862740436, -0.7695296799705442,
        0.6370268724810286, -0.19703798778203208, -0.2701519845213487,
        0.5705785364020669, -0.6056680439008928, 0.3348904261636513,
        0.18069880990357443, -0.6989182566662412, 0.8528990346573141,
        -0.4116196216665844, -0.44124884798116987, 1.116675931798362,
        -1.0247001216742007, 0.0985699771199878, 1.0337992846838593,
        -1.4758903997784412, 0.8884876399657042, -0.17027930970506683,
        0.03409007868585173, -0.03409007868585178, 0.17027930970506677,
      ],
      [
        0.639728812465528, -0.7982753267129346, 0.7982753267129344,
        -0.6397288124655282, 0.23198057496119703, 0.010520912061433515,
        -0.13057099596998628, 0.13514276897347954, 0.020056549294138838,
        -0.18564583110906877, 0.09991270983563497, 0.10106756889791274,
        -0.1499219018500101, 0.05914519818567144, 0.09951233994450767,
        -0.1779905920952145, 0.015839911297706927, 0.1673700103124174,
        -0.11971920076284435, -0.03438030682272184, 0.1441013696153145,
        -0.12332919684283646, -0.07247219069373592, 0.19019619909039356,
        -0.049147585542116526, -0.1184943083585708, 0.14047350722522375,
        -0.037408211460169205, -0.13850138650611557, 0.1630523063152189,
        0.04069873580768035, -0.16901910623385372, 0.08950088613799995,
        0.054873824543331104, -0.16228466939707295, 0.09409033001987749,
        0.1230208360845786, -0.17164314431782943, 0.006022995094654121,
        0.1267842221448088, -0.1362920279478459, 0.0037099148160107363,
        0.17319745679009463, -0.1261246532810744, -0.08551527364623736,
        0.15761296121433854, -0.06764460180201627, -0.08144050509482065,
        0.17602738826573552, -0.04635860918512786, -0.158250128589553,
        0.13875846914897816, 0.02397501313781686, -0.13629945053710119,
        0.1302024150970625, 0.04371264707865441, -0.19079696865307375,
        0.07625304784207457, 0.11210593045917379, -0.14476116261041472,
        0.048695665992383175, 0.11714274044421746, -0.1735378681178461,
        -0.011014547953895941, 0.17128527628860585, -0.11322590881741697,
        0.04078043837724164, 0.0114101655218913, -0.011410165521891296,
        -0.04078043837724163,
      ],
      [
        -0.02969863512059035, 0.16361512397376934, -0.1636151239737693,
        0.029698635120590303, 0.003583514086468044, 0.006055534373400808,
        0.003001208542503301, -0.0025907149708485934, -0.005455333162310604,
        -0.002935203645315881, 0.0025653561444231245, 0.005818974356110334,
        0.003637099142824002, -0.002138611575014479, -0.0062872536150933266,
        -0.004992967785377772, 0.0006398561599596469, 0.005580199927130812,
        0.00546365041879945, 0.0005633623464534193, -0.0045073713317140135,
        -0.005074200810448644, -0.0007106328904227157, 0.00439525958330062,
        0.005347091275198125, 0.0011059680176912223, -0.00450737864799311,
        -0.0063101543887179295, -0.002537381445544436, 0.003502712057383386,
        0.0064315801892925635, 0.0037062674854808977, -0.002079660478821129,
        -0.005609304111871448, -0.0037390505387387314, 0.0016338984819478982,
        0.0053680829642552726, 0.003869198800429326, -0.0015547376938682116,
        -0.005878853676096884, -0.0050003172778503675, 0.00044744292812397887,
        0.005630065200604703, 0.005917030791201702, 0.0011097039919526763,
        -0.004393706170452182, -0.005643331108938094, -0.0016665748646194738,
        0.003684709072712705, 0.00533614199584297, 0.0017074255006680984,
        -0.0038149472541615277, -0.006010841387689891, -0.002674154146274245,
        0.0033034773275869723, 0.006547523199250914, 0.004117515705350088,
        -0.0017961303384442422, -0.005877620277035284, -0.004548659472843178,
        0.0007837031238870466, 0.005074228671092919, 0.004326011281976643,
        -0.000713587871258485, -0.005257742842862435, -0.004931632218881693,
        0.00014357500378408238, 0.005413004247294243, 0.006052821083897398,
        0.0014076693161508306, -0.004387157581576312, -0.0061773110067785825,
        -0.002489147931225663, 0.0031604532858383987, 0.005538247014320002,
        0.002525696204029643, -0.002948321645208864, -0.005649218770625703,
        -0.002913947258563681, 0.002846434431783231, 0.006338928550667833,
        0.004263088500306189, -0.0016242670485061284, -0.006085365017206006,
        -0.005177625835599536, 0.00015873591516805258, 0.004995901543353017,
        0.004963384061819056, 0.0002524515035691056, -0.004604599774480488,
        -0.004964622964402464, -0.0003994169484203688, 0.004883026926381836,
        0.0059174433973948615, 0.0015847447539582382, -0.004310801379724893,
        -0.006496180695878279, -0.003045890903287999, 0.00286760818602993,
        0.005896099288690521, 0.0034173402232552073, -0.002094372623576944,
        -0.0054011873099884585, -0.0033732862863778733, 0.0021035414227056747,
        0.005870778725614212, 0.004282647795269696, -0.0013854922067690068,
        -0.006060859757306806, -0.005507518307294505, -0.00021078822028539924,
        0.0050633124172233855, 0.0056293602106323275, 0.0011530772074514611,
        -0.004092158630120749, -0.005205081813910387, -0.0011928164932048287,
        0.004122969872800981, 0.0056628398178984254, 0.001821257768041493,
        -0.004002167997052943, -0.0064975055594953535, -0.0033232607124108254,
        0.00272383492692024, 0.006251285009777917, 0.004191660438814429,
        -0.001420520911244158, -0.005361674260784467, -0.00911733772513873,
        0.03095063658960365, -0.030950636589603647, 0.009117337725138737,
      ],
    ];
    const result = wavedec(data, "rbior1.5");

    const reconstruction = waverec(result, "rbior1.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio1.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5054189010763254, 0.929230147685939, 1.2076171184598283,
      1.3079601509458871, 1.2345942723173897, 1.0256096326224575,
      0.7416665698544079, 0.44981639752823277, 0.2065559895654494,
      0.04448210478166742, -0.034081465534577304, -0.05497279115338344,
      -0.06232991582971106, -0.10375277739327482, -0.21457026987557937,
      -0.40552574014028536, -0.6572912090516112, -0.9234180423189747,
      -1.141099480707537, -1.2470405534412328, -1.194346729457,
      -0.9660173882049552, -0.5814523769816768, -0.09414024620861355,
      0.41905794456089096, 0.8744647467224496, 1.1999179122228074,
      1.3503518470022908, 1.3168006646217565, 1.1266705785608304,
      0.8353512702701651, 0.5114301144496838, 0.21937401283366215,
      0.004139733719449312, -0.11838544351273908, -0.1627762411784843,
      -0.16712021593903137, -0.17974640049011942, -0.24330678857175697,
      -0.38057186167019763, -0.585840146438052, -0.8243740045199826,
      -1.040147654613369, -1.169983479171265, -1.1604360252022718,
      -0.9830092250874849, -0.6436662026619904, -0.1840195973812956,
      0.32629346166925, 0.8042899620750168, 1.17179611199819,
      1.3725988762204815, 1.384357588108324, 1.2223675869495327,
      0.9343382132030175, 0.5876257402243923, 0.25226042910998486,
      -0.015862732628019405, -0.18736109815392965, -0.26424297706196864,
      -0.27620948075848517, -0.2695561980068562, -0.29178610003404004,
      -0.3761567256233036, -0.5303848374046045, -0.7326214898620101,
      -0.9358800381174761, -1.0798529333392364, -1.107076793020755,
      -0.9792160536094875, -0.689146229760313, -0.2655555826041596,
      0.2313168756431257, 0.7219185322087135, 1.1246520840074,
      1.3739258179499552, 1.4345149932902934, 1.30868951821247,
      1.0343959468498725, 0.6750494754452068, 0.3036093505701547,
      -0.014966527253266082, -0.23842991750456283, -0.3554437100009859,
      -0.38533709836867713, -0.3696956608143435, -0.3582003749852327,
      -0.39262020373594536, -0.49332462634181024, -0.6519967330828637,
      -0.8325743638746789, -0.9802582199108401, -1.0362734402161133,
      -0.954517358903813, -0.715678365852434, -0.33501510851115046,
      0.13841156411580902, 0.6310726225460609, 1.060680912510898,
      1.3544310543815625, 1.4652489918877702, 1.382015334779765,
      1.1312458424782281, 0.7698753065365521, 0.37104016469560297,
      0.006510901122738499, -0.2697637429793597, -0.43287894667007076,
      -0.4902401747372068, -0.4762445124036917, -0.4399890821449879,
      -0.4294258363647, -0.4762862805409128, -0.5858676085331969,
      -0.7344657477239249, -0.8752028280832133, -0.9507590820609076,
      -0.9096667782500721, -0.7218412975115719, -0.38917078411859923,
      0.051773494364617506, 0.5358279608658267, 0.9827804777919573,
      1.3150826422706345, 1.4753465934630747, 1.4392657158877697,
      1.2207412476589667, 0.8679652122461142, 0.4514972249898507,
      0.04738919608033998, -0.2803612970780768, -0.4936254959215687,
      -0.586832005082591, -0.5850128366715558, -0.533946185944847,
      -0.4851832853739818, -0.48005587237018676, -0.5369926162820919,
      -0.6455693678210951, -0.768916814169291, -0.8538811185672531,
      -0.8462605623042272, -0.7070660194071532, -0.4254360716790142,
      -0.024664481487291, 0.4404431689668874, 0.8944301078698166,
      1.2576777711345093, 1.4644564895506673, 1.4780319906040384,
      1.2990411137304525, 0.9650424341540887, 0.5413778057573877,
      0.10567453191736498, -0.2700900892004038, -0.5354588454683793,
      -0.6713731681585181, -0.6917164957062758, -0.6363543718902187,
      -0.557706539410409, -0.5045458618495184, -0.5074053831293771,
      -0.5695123527937924, -0.6656796971397957, -0.749461090987109,
      -0.7666707558089072, -0.6716596769275189, -0.4419736047283168,
      -0.08739731448281701, 0.34918143655521516, 0.7995448848480552,
      1.1847675054278954, 1.433103758928451, 1.4966769905957018,
      1.3627708276365718, 1.0568705562882377, 0.6366829634222976,
      0.17864311244291148, -0.2396919449454314, -0.5569462845854375,
      -0.7406280796677284, -0.792156492757135, -0.7431406794960507,
      -0.644105434484498, -0.5487987578903549, -0.49832951451725044,
      -0.5093819178335149, -0.5696412832627109, -0.6416346859103811,
      -0.6739458955360822, -0.6167927240245118, -0.43777213800191506,
      -0.13349453449718213, 0.2661320039462533, 0.7023117061552948,
      1.0995499617741276, 1.382667878314591, 1.4944035998921843,
      1.409163514039845, 1.1394308957031662, 0.7331849877570906,
      0.26295523401702253, -0.19075192738269162, -0.5575068737432607,
      -0.792000449847432, -0.8823947703825722, -0.8500470263786427,
      -0.7409066578537238, -0.6110272049035487, -0.5101273625284182,
      -0.46759610733235657, -0.48464792198939344, -0.5346785860576341,
      -0.5716833832811997, -0.5444499339856047, -0.41268890729233954,
      -0.16072296799682906, 0.19503892818031132, 0.6070139648656923,
      1.0057363939685156, 1.3153249591917944, 1.4712881314339565,
      1.4361758913285358, 1.2090907766030674, 0.8266044317657655,
      0.3547951369667779, -0.12563195157546458, -0.5374357502200494,
      -0.8236419735595494, -0.9589190830337524, -0.9528084835868201,
      -0.8441991687226283, -0.6886888163317151, -0.5422848550768118,
      -0.4458025561256799, -0.41408146782803973, -0.4328314175988653,
      -0.46387887770578246, -0.45734731433254056, -0.3674556256216738,
      -0.16764025964444623, 0.13914430218839446, 0.5178521898106314,
      0.9073957928328824, 1.233956629328322, 1.428277132916774,
      1.442573830576465, 1.2627556422969564, 0.912789307902175,
      0.45003078973816035, -0.04737187194632164, -0.4978917520070949,
      -0.8345297019857936, -1.0187900407879953,
    ]);
    const expected = [
      [
        2.6422661672220937, 2.6422661672220937, 2.6422661672220937,
        2.6422661672220937, 0.3534108564026396, 0.9140440217894423,
        -1.3556545767957113, 0.46837168904126003, 0.9584571392713531,
        -1.5076925413565307, 0.5363014159460417, 1.0651669246291777,
        -1.659642364061361, 0.541784757310404, 1.2189269877813604,
        -1.7845811780908019, 0.47974942278634525, 1.3966412405314883,
        -1.8600047893473328, 0.8226607954688714, -2.1498820358849646,
        -2.1498820358849646, -2.1498820358849646, 0.8226607954688714,
      ],
      [
        0.35289180001351583, -0.05364504634733097, 0.05364504634733089,
        -0.35289180001351583, 1.9315540558294986, -1.9516173366817116,
        -0.5270677843606145, 2.7612880143733927, -2.3639159476882146,
        -0.49844924752636854, 3.0725724383310427, -2.6287588045064383,
        -0.6199218155204027, 3.4403663450191164, -2.785971037268284,
        -0.8792442453341964, 3.8044877159984827, -2.813303133275768,
        -1.0739064556637, 3.0058418188961906, -0.5041118011732147,
        2.0816681711721685e-17, 0.5041118011732146, -3.0058418188961906,
      ],
      [
        -0.054602030670705695, -0.0025516225713387722, 0.0025516225713387714,
        0.05460203067070567, 0.8073413866818149, 0.5529784592847795,
        -1.6523412751579816, 1.2831971147688344, 0.24501255447348014,
        -1.519003299832225, 1.387683131698138, -0.004483077798398374,
        -1.3454571683259966, 1.443461483304371, -0.23983444067065415,
        -1.1389894222027772, 1.448361297734898, -0.45133249759385413,
        -0.9082636807042472, 1.4023414523343747, -0.6302677652068973,
        -0.662957890173554, 1.3074922859078641, -0.7692949746619816,
        -0.41335910324358954, 1.1679480658035852, -0.8627406126512779,
        -0.1699327545611088, 0.9897138748570633, -0.9068404652601011,
        0.0571155323415036, 0.7804141665155064, -0.899897218583118,
        0.24280969255554846, 0.686921990520815, -1.563296487635704,
        0.961281578025891, -0.9612815780258912, 1.563296487635704,
      ],
      [
        0.6492575516361231, -0.7961724115364627, 0.7961724115364627,
        -0.6492575516361232, 0.2539392145534914, -0.017214276238830893,
        -0.12829569683691297, 0.17519141794389187, -0.0313667045384966,
        -0.1779941509263625, 0.16144015607824128, 0.02129044169323913,
        -0.14907014178704736, 0.15609935342906286, 0.007052272591400646,
        -0.19521129900233702, 0.1393313956639982, 0.05960247912287463,
        -0.16279983234166406, 0.13057393443979812, 0.04447521174428966,
        -0.2050566698857703, 0.11128948905525113, 0.09612167780257522,
        -0.16891254956193757, 0.09967729467458336, 0.07933123538590638,
        -0.20711536114881007, 0.07849519249365589, 0.12932290546173517,
        -0.1671550471306374, 0.06469645757622093, 0.11015698491717794,
        -0.20129845543286057, 0.04232825224388412, 0.1578199135247856,
        -0.15760365472785398, 0.027089448490061993, 0.1356578923603475,
        -0.18784674361533427, 0.0043096336339494105, 0.18042337971137165,
        -0.14066108191443888, -0.01157575310107339, 0.1547623847063978,
        -0.16732064295263346, -0.033962162807970125, 0.1961907052497459,
        -0.11703955634597848, -0.0496868651690152, 0.16666675136420506,
        -0.14057673233103785, -0.07087803164946152, 0.20446548167258427,
        -0.08773100232752865, -0.08565480969883109, 0.17086879609201078,
        -0.10873188710480738, -0.1048856368818263, 0.20490497470335192,
        -0.05396550834595644, -0.11798024768510365, 0.16718886439012487,
        -0.0731165152111302, -0.13488888347075034, 0.1784214582422745,
        0.12074586407804355, -0.5881266148112239, 0.5881266148112239,
        -0.12074586407804362,
      ],
      [
        -0.029819341097007797, 0.16583486296893862, -0.16583486296893862,
        0.02981934109700778, 0.004460344533316573, 0.006784065981688871,
        0.002572328621082323, -0.003910727636500272, -0.006257017405177873,
        -0.002165071493097454, 0.004319733455418473, 0.006751305982359612,
        0.0025800407305933398, -0.004321706246088089, -0.0073706737675890595,
        -0.0036311818875455863, 0.003341931579374081, 0.006933469869970087,
        0.0038473327700400094, -0.002745370016520341, -0.006331298047004974,
        -0.003407285724336686, 0.003113497502452132, 0.006749163030238832,
        0.003781283151358782, -0.0030851729540112924, -0.0073000291228360915,
        -0.004794590965969446, 0.0020753691030893136, 0.006795644551211887,
        0.00497479843044921, -0.0014446783493498976, -0.006118741975471928,
        -0.004489574326826507, 0.0017850416543630813, 0.006461268532580851,
        0.004810584724081575, -0.001739877437912641, -0.006945459559502286,
        -0.0057744575706204365, 0.00071384436045071, 0.006376526773307665,
        0.0059076497048282176, -6.305128486284312e-5, -0.005628273455085665,
        -0.005366725614286052, 0.0003898329588042067, 0.005899510907695703,
        0.005624716966963062, -0.0003422090805266023, -0.006321785975680762,
        -0.0065296495564711576, -0.0006854788113102635, 0.0056938309320283455,
        0.006606958486783547, 0.0013417225353365772, -0.00488045433056852,
        -0.006002118088497775, -0.0010138670315110627, 0.005087245535402511,
        0.006189461432402034, 0.0010492510552981109, -0.0054550955061863134,
        -0.00702844100508045, -0.0020638534773918284, 0.004776307351942597,
        0.007043574390038304, 0.00271088410979509, -0.003906623092037235,
        -0.006369253791131121, -0.0023674416860988198, 0.004058316866829037,
        0.006481042455766034, 0.002376183044548976, -0.004381649244471059,
        -0.007249840608727692, -0.0033634093741504497, 0.003662538488243673,
        0.007199345280137662, 0.003987164338553898, -0.0027475827172886644,
        -0.006452867778536086, -0.0036143735912252638, 0.002855641352246672,
        0.006487122660329742, 0.0035829699839808535, -0.003146363976561673,
        -0.007184470591703965, -0.004529575971219026, 0.002399323453032439,
        0.007067877304655561, 0.005117181901749809, -0.0014518922318267208,
        -0.006249567265304137, -0.004702610949327937, 0.00152941052036374,
        0.006207319536069417, 0.004619026699252536, -0.0018009314974692867,
        -0.006834959368176364, -0.005513367372402335, 0.0010397185066008553,
        0.006654802599069653, 0.006053678355226019, -7.383351973347385e-5,
        -0.005767973675343245, -0.005586747001074329, 0.00013498944692002732,
        0.0056532214629804855, 0.0054409177713743515, -0.0004016542551681431,
        -0.006215831495642537, -0.00627343338555196, -0.0003591844407186016,
        0.005977543459365787, 0.006757496858791439, 0.001328861484088107,
        -0.00502836165276832, -0.006229921216805247, -0.0012694013953768943,
        0.004847902508003155, 0.006014176199693086, 0.0009929120554743103,
        -0.005352899531831399, -0.0067777908822370505, -0.0017386483011557125,
        0.0050645828556444665, 0.006726203761493219, -0.00039609678078364116,
        -7.025630077706069e-17, 0.00039609678078364984, -0.006726203761493261,
      ],
    ];
    const result = wavedec(data, "rbior1.5");

    const reconstruction = waverec(result, "rbior1.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.2", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4831539116126269, 0.8937654924756957, 1.1741402835639065,
      1.2928527017430378, 1.2501321139467652, 1.0760461078510577,
      0.822027525221611, 0.5478675527136253, 0.307355165038762,
      0.13602995377853289, 0.04396397713351302, 0.015234538867948788,
      0.014099243502279188, -0.0037615612358776196, -0.07781207151138209,
      -0.23045193120586566, -0.45914570481271105, -0.7349437121945799,
      -1.0078793017674255, -1.2180348563652756, -1.3096621872788796,
      -1.2449648437712983, -1.014190838197083, -0.6395369339840689,
      -0.17182616639555776, 0.3193623646458915, 0.7598716703017044,
      1.0861852582181957, 1.2581704675641618, 1.2664241014860405,
      1.13258746278961, 0.9026738316354835, 0.635109691812322,
      0.38643248853178547, 0.19811438531406117, 0.08766844060137641,
      0.046119035399896896, 0.042344508627906986, 0.03310955077722266,
      -0.023791478434528612, -0.15662255291695798, -0.3703126804643645,
      -0.6430087361727246, -0.9295453720754709, -1.171103277130941,
      -1.3087969126783834, -1.297944326068944, -1.119566148068077,
      -0.7862905745167603, -0.3411561876123157, 0.15051085637633538,
      0.6143198901588571, 0.9820978145235414, 1.205699092198595,
      1.2661666553456712, 1.176179270027988, 0.975323540131272,
      0.7194351470120941, 0.4666531733451672, 0.2635871759788804,
      0.134928639180375, 0.07896549133406366, 0.06999405820030839,
      0.06692352986095006, 0.025846608792823633, -0.08662411694771588,
      -0.28264486894990054, -0.5478054405954869, -0.8426061317692164,
      -1.1105118733363994, -1.29072686317658, -1.3326548286500375,
      -1.2085624870011689, -0.921357560929221, -0.5055350651663398,
      -0.020962615609871088, 0.4591217130815586, 0.8631469887677568,
      1.1358084218640403, 1.2488619347642627, 1.2056606933582608,
      1.0384760644414806, 0.7993646176606921, 0.5468708280332388,
      0.33182449690568006, 0.18567045319989123, 0.11411510048525647,
      0.0975502353555979, 0.0980418519503741, 0.07105695959144587,
      -0.0210630707439024, -0.19730567840389018, -0.45088353382169116,
      -0.748695061406621, -1.0376122706571753, -1.256179719627675,
      -1.3489651945712091, -1.280122558151126, -1.0428770487287125,
      -0.6625893457080534, -0.19257059363955223, 0.29645805812499515,
      0.730855370347973, 1.0491540674448963, 1.214273814939777,
      1.2200608512752116, 1.090720437847381, 0.8734045059657531,
      0.6258420232281339, 0.40206247414820195, 0.23968440260728752,
      0.1518216555509187, 0.1255036913485025, 0.12689512195036715,
      0.11192539121489328, 0.03960889368245413, -0.11532793638967587,
      -0.3537316554704353, -0.6494850741392415, -0.9539041887527694,
      -1.206122198343195, -1.3470338281677618, -1.3334747563068623,
      -1.1492138442066773, -0.8100660374417143, -0.3618171123788675,
      0.12864430741082003, 0.5869769466201032, 0.9466717511310074,
      1.162438764402359, 1.218622595435676, 1.1307656431143718,
      0.9400763009344593, 0.7022479073920879, 0.47340652198559174,
      0.29662153985001827, 0.19223641203891978, 0.15431253191207306,
      0.1539633288059688, 0.14865671425811, 0.09509511114203895,
      -0.037599829241095284, -0.25775168213488836, -0.5466565168906566,
      -0.8610044054713621, -1.1417374553725899, -1.3273004193776468,
      -1.3681420477997972, -1.2389834945067641, -0.9458693394513586,
      -0.5262388854015583, -0.04190717801257429, 0.4334705947139012,
      0.829566511519693, 1.0936719206704737, 1.2008228426420127,
      1.1574695170086002, 0.997946723342043, 0.7747184059255231,
      0.5448442872996173, 0.35599295896113686, 0.2353955793627303,
      0.18438238372045807, 0.17975505040707807, 0.18155991548309047,
      0.1452504555975837, 0.03514540156914725, -0.1642357543105849,
      -0.4418660454254199, -0.7606143639765233, -1.0643990502302263,
      -1.290472797993837, -1.3839455639257974, -1.3110728120455284,
      -1.0680945211748456, -0.6834459763774574, -0.2127264584658115,
      0.27246967200258637, 0.6992969050286353, 1.0085681693962645,
      1.16638899147582, 1.169865607505523, 1.045658010644498,
      0.8418585325183069, 0.6152619923850351, 0.41717300860589857,
      0.2812107930461262, 0.21604789979574612, 0.2047861491600087,
      0.21103099187904842, 0.1900742626449604, 0.10233587342947198,
      -0.07434644059292739, -0.3367169825767544, -0.6544870843634429,
      -0.9756420250324134, -1.2375092313735125, -1.381002896452006,
      -1.3646554890522953, -1.1750583443592855, -0.831161214438116,
      -0.38132662020596586, 0.1062482344776343, 0.5575544395844687,
      0.9079981281552039, 1.11531102662852, 1.1671873938993718,
      1.0819577070243298, 0.9022762872108908, 0.683463883353218,
      0.4794062118518676, 0.3294628540714588, 0.24955618928644563,
      0.22955850880148543, 0.23753390056108045, 0.2296999104263163,
      0.1635635419494359, 0.010899618626221241, -0.23273172813309317,
      -0.544394045139897, -0.8771317042569204, -1.1695965637172756,
      -1.3597211849579234, -1.3992025528161545, -1.26532548659394,
      -0.9672576367030011, -0.5452448472595914, -0.06281552013647371,
      0.406238570686881, 0.7930990348056118, 1.0478489947099723,
      1.1488893247039993, 1.1057273232875968, 0.9546115719273436,
      0.7481944167104345, 0.5418178096760977, 0.3797989466677961,
      0.2850526125238706, 0.25453936024372453, 0.2615801290554196,
      0.26438138014687507, 0.21858278831976813, 0.09064432597370253,
      -0.1313267367688794, -0.4320926901399591, -0.770630856957905,
      -1.0881246710338826, -1.3207851845280167, -1.41448751148367,
      -1.3377305026141233, -1.0897932782656192, -0.7020832126514258,
      -0.2322779314669407, 0.2474276781928616, 0.6652606399522689,
    ]);
    const expected = [
      [
        2.7684354298734193, 2.7530814627702616, 1.9064591964256508,
        0.12165289721844358, -0.06672368430169802, -0.19544258350931487,
        0.17372150649982548, 0.09259576810083997, -0.10758291772569463,
        -0.1576327269549604, -0.10112221930885673, -0.019360174712901822,
      ],
      [
        -0.04661587889119545, -0.26043254584398046, 2.1503454233549153,
        0.29926027982127534, -1.3527354502832325, -0.11731228153266332,
        1.38527867618358, -0.10463775355686464, -1.2878091111027146,
        0.024811860153193158, -0.07932482626030138, -0.03234371135890739,
      ],
      [
        -0.015464286553877715, 0.4520151602082958, -0.6702251627630627,
        -0.6369336722974113, 2.204041884432567, -2.8941357933976253,
        2.05645088208109, 0.5284894329411299, -3.161015235979108,
        3.4242778726470346, -1.0800415960775596, -1.6501551323198282,
        2.832721182292796, -2.428867929367755, 1.043881383642319,
        1.0887053305977814, -3.1122100047728254, 2.832765296286257,
        0.4483227104511413, -2.075253439502513,
      ],
      [
        0.12127054478395871, 0.5056374587315626, -1.2640338641730346,
        -0.2426622482991827, 2.270334316116183, -2.191294424808788,
        -0.07639135187364182, 2.272102445996232, -2.208830211930453,
        0.10919063715404848, 1.7590792611531845, -1.6454421099785876,
        0.09876221606913776, 0.964888217475218, -0.6070165286135734,
        -0.22688674604898829, 0.18496051457523188, 0.6331709033628088,
        -0.8287547410357587, -0.3384416182652911, 1.7263900391682332,
        -1.5143270019555228, -0.5044020340575699, 2.3698076887259916,
        -2.008495695611773, -0.38065896747119987, 2.4110962946125762,
        -2.0631894891351075, -0.16072210570642825, 1.8966140851009239,
        -1.5621161045296816, -0.0697442620549272, 1.013098761521686,
        -0.7423414275495444, -0.9886640383741135, 2.1668859145549106,
      ],
      [
        -0.15912539673987441, 0.9113077899174805, -0.7508400642927124,
        0.09019157090264768, 0.11252178532616412, -0.29338786461815813,
        0.5973327757118012, 0.44083260801555085, -0.7333605779658663,
        -0.23555597349917556, 0.2765337726631011, -0.3112334246660061,
        0.26818482699042917, 0.7386738643906694, -0.45086675291823697,
        -0.5620042796226599, 0.28365005315293823, -0.16278860660777358,
        -0.07365915379027858, 0.8035034217727024, -0.016659477874345796,
        -0.755760163525661, 0.10596135446786403, 0.06172341742116767,
        -0.3016198854313848, 0.6306556598722559, 0.429155342819532,
        -0.7253278178281636, -0.20240159086675885, 0.24049623037770593,
        -0.3444743555051512, 0.30015367469033155, 0.7412640039510763,
        -0.45919538556810696, -0.5248077564959645, 0.27243080334139635,
        -0.21234232300377448, -0.05644083392705336, 0.823079668749575,
        -0.033228502938664306, -0.7277619768075978, 0.120895976757248,
        0.0105774278881966, -0.30832875537399457, 0.661842319399274,
        0.41590361139245663, -0.7145895787945381, -0.1688570869846012,
        0.2032476614127132, -0.37614220166022777, 0.33132952278958044,
        0.7411376101155884, -0.46576268987389424, -0.4858872211068065,
        0.2597614030796294, -0.26100441728305657, -0.0386172068102127,
        0.839697410985732, -0.04961705332547334, -0.6971423188016905,
        0.13492743132177587, -0.040730576033966875, -0.3135041319691957,
        0.6907696310354823, 0.3095403372797238, -0.5572226145388082,
        -0.5918510412578538,
      ],
      [
        0.4142279655735954, 0.011092348515991612, -0.16587298275729465,
        -0.13555718812725176, -0.022424221240304326, 0.06888201603246799,
        0.06367488274339914, -0.01688175015928179, -0.07894865192358488,
        -0.04624627392988043, 0.06585122489706663, 0.1608497485183167,
        0.1475472202721546, 0.024092664542991027, -0.11698913313399108,
        -0.16817561685817742, -0.09971067420885757, 0.017369430646563794,
        0.0779133161568952, 0.03792489830716793, -0.048092941729593476,
        -0.0810295202024469, -0.012266449696392612, 0.10765383094162553,
        0.17210024164232313, 0.1147042644956591, -0.02844876075295548,
        -0.1477625856772505, -0.1548248928359146, -0.057963766354074214,
        0.048857151525053655, 0.0728639475068853, 0.0057609653217245566,
        -0.07197138545978972, -0.0688986152327276, 0.029279600166454173,
        0.14263389522341385, 0.167423124714688, 0.07055675228614205,
        -0.07779733329975239, -0.163704107766871, -0.1280066783191953,
        -0.015557892579373067, 0.06852135163512679, 0.05508664521159561,
        -0.027928011771026214, -0.08466908884487719, -0.04337669087266522,
        0.07355242244731605, 0.16629335863977368, 0.14677816677310734,
        0.019646839637141145, -0.11883013420544654, -0.16363109303835308,
        -0.09144235499453826, 0.02232453864709491, 0.07442432485668728,
        0.027580912261923336, -0.05804790906436325, -0.08376344294265237,
        -0.00703772389882662, 0.11524025492268963, 0.1753916423419284,
        0.11198871928510465, -0.03269316375081632, -0.14741977521684527,
        -0.14824117230709574, -0.049922019326891665, 0.05119673634335367,
        0.06643613314165712, -0.005393449427696623, -0.07994642078460942,
        -0.06857378264930662, 0.03609539468114581, 0.14920936137230706,
        0.16835132138052264, 0.0665329812452555, -0.08097643067988887,
        -0.16092207149558702, -0.12001151409344027, -0.008709069763376154,
        0.06781556538040204, 0.046237682663393176, -0.0388591761259077,
        -0.09000570181367218, -0.040262238098712606, 0.08103591640717162,
        0.17113550206068187, 0.14546203446647604, 0.015133592297627035,
        -0.12021579209418815, -0.15848233661997924, -0.08288154145045262,
        0.027110461904261862, 0.07057371154779196, 0.01709889274401996,
        -0.0677535817225684, -0.08610729125630079, -0.0017061038836177125,
        0.12243960005132706, 0.17803888211720048, 0.1088573393911978,
        -0.036804351890522, -0.14651645094137145, -0.14112304215652582,
        -0.04175835656013349, 0.05325374615450229, 0.05968789145848362,
        -0.01654043564643616, -0.08757164305727094, -0.06791171021787426,
        0.0428429095124571, 0.15525796619360135, 0.16865672443185653,
        0.06226709023007754, -0.08383815923402774, -0.15753479159306608,
        -0.11160243965966396, -0.0019059121244458799, 0.06676518868790204,
        0.03716016698322534, -0.04963514128698711, -0.09494060462698248,
        -0.03691793750788877, 0.08827092224492614, 0.17535819407177622,
        0.14360751758539725, 0.010575468083967976, -0.38025329305425454,
        -0.11586355171595318,
      ],
    ];
    const result = wavedec(data, "rbior2.2");

    const reconstruction = waverec(result, "rbior2.2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.2_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48888991000979176, 0.9045194537407499, 1.1884029764523385,
      1.308233908488116, 1.263347157206193, 1.083073970846285,
      0.8185005914521861, 0.5296885116046353, 0.27146097074045056,
      0.08115861791826318, -0.02875171445126412, -0.07153973292963749,
      -0.08047536999199918, -0.09803594502981855, -0.16283099475507673,
      -0.29757213050864373, -0.5011566327261434, -0.7469256992381201,
      -0.9876448387732756, -1.1661005818833, -1.2288143721948233,
      -1.1395789645121996, -0.889519126079356, -0.5011707252768746,
      -0.025472682381392067, 0.46775953744757076, 0.903762825226559,
      1.217991877349438, 1.3690550184939814, 1.3464757538138294,
      1.1715543304799643, 0.8912284411400329, 0.5664744910885138,
      0.2580583301561797, 0.013035161733023881, -0.14482659019194016,
      -0.21850639354139603, -0.23439003490067645, -0.2330971679021911,
      -0.2568648029192595, -0.3367030447748748, -0.48258381352934304,
      -0.6791726332454355, -0.8882497053649046, -1.0573193226025177,
      -1.1323747607575565, -1.0717402689133841, -0.8576070235920322,
      -0.5023921312047789, -0.04825850563077644, 0.4402496099973522,
      0.8888625867840447, 1.228673401410711, 1.4102074832604834,
      1.4132516357412799, 1.2502112820540912, 0.9622851859826752,
      0.6094314369641098, 0.2565455217307322, -0.04086425897124124,
      -0.24814180664679106, -0.35745265202205484, -0.38697404575605354,
      -0.3736731900625654, -0.36159287760573944, -0.3886423933788602,
      -0.47523768946306005, -0.6176661805697159, -0.787882256846083,
      -0.9398530402778394, -1.020954089581366, -0.9856540375642099,
      -0.8081316379575355, -0.4906844866018258, -0.06576650317748328,
      0.4090018129918754, 0.8618310337597656, 1.2213072521453343,
      1.4311604438649432, 1.4618598654072716, 1.316372500980452,
      1.0287860407182303, 0.6561700432844078, 0.265628535261124,
      -0.08039251154917398, -0.3371025930951713, -0.4856732031651458,
      -0.5350141832513393, -0.5167691879895177, -0.4749171225097488,
      -0.45265873763158715, -0.4799042324245739, -0.5645066623951858,
      -0.689450015733994, -0.8167273016545269, -0.8969898692722479,
      -0.8826150874731692, -0.7409732602877172, -0.4645873568415859,
      -0.07559431565689323, 0.3767355733600763, 0.8250070184925052,
      1.1972518306562945, 1.4319363811008081, 1.490963262065717,
      1.3676560158563245, 1.087882443868373, 0.7040773134911732,
      0.2835861147059393, -0.10592847735548083, -0.41061107337214375,
      -0.6008103689248574, -0.6754121114663179, -0.6592457373538047,
      -0.594371724820526, -0.5275204368762291, -0.4968596853714651,
      -0.5214006938088631, -0.5956805831556509, -0.6910478058711206,
      -0.7632432549058019, -0.7644098422572231, -0.6565552122867534,
      -0.4231051495122993, -0.07561465409762397, 0.3461517563517119,
      0.7809731459120584, 1.1583149971268014, 1.4131074028550055,
      1.4997451846103453, 1.4020492277183225, 1.136858290863884,
      0.7504067965551698, 0.30833218372960985, -0.11835760072734003,
      -0.46809464768017855, -0.7009236859506442, -0.8052786394117392,
      -0.7979152743560174, -0.7171987911987613, -0.6115324084621354,
      -0.525859701622963, -0.48960536030111684, -0.5090342709119379,
      -0.565902424847109, -0.622713947426129, -0.6332644146074002,
      -0.5558374204509222, -0.3657475326796067, -0.06405264343730044,
      0.31983718894821567, 0.7324652984402792, 1.10669050020459,
      1.3757739734257928, 1.4879357399274344, 1.41797631075293,
      1.1732222852879157, 0.792373599309775, 0.3374905468119046,
      -0.11903562258934769, -0.5095170675087365, -0.7845458580342206,
      -0.9220212964619676, -0.9296404230610507, -0.840433945779781,
      -0.7025885406180024, -0.5661460526378681, -0.4698876413755811,
      -0.4316259802511808, -0.4442642542895688, -0.47854761557495745,
      -0.49177850866792716, -0.4402925128127646, -0.29255327746133997,
      -0.03955147769549339, 0.30017317056249965, 0.6822774820374835,
      1.0448821773752588, 1.3215267929839623, 1.4558205595573428,
      1.4143517778370198, 1.1947933653455887, 0.8272510378177035,
      0.36847938933537583, -0.10973671853723996, -0.5353718726984948,
      -0.850723270429564, -1.0234223792551127, -1.0514309895891016,
      -0.9609991028795533, -0.7982380523848096, -0.6164706897253194,
      -0.4625004094645268, -0.36515887900366095, -0.3288988371776233,
      -0.3339388506396037, -0.3428472813926811, -0.31186519049505995,
      -0.20409671032562904, -0.001224202063384916, 0.2892509998085878,
      0.633165137246986, 0.9756184287449734, 1.2523930860591928,
      1.4042318570994954, 1.3906184460306683, 1.1997763879259817,
      0.8524657352628519, 0.3986027774602065, -0.0925877735171419,
      -0.5466584384170681, -0.8990397690494085, -1.1077049393304668,
      -1.1605364664391098, -1.0757993900578071, -0.8957636353411137,
      -0.6751363738282621, -0.4671757865638199, -0.31087203976454975,
      -0.22227858301234438, -0.19203281149222323, -0.1895736960082983,
      -0.1729161745594573, -0.10147653109115651, 0.051310107107291836,
      0.28879731483624915, 0.5877501078827224, 0.9017597838317769,
      1.1707690672838877, 1.3345220579005417, 1.3467685468168866,
      1.1868255703671342, 0.8656880233240785, 0.42514612792519085,
      -0.06999098053210388, -0.5448414502799567, -0.9296229559945693,
      -1.1735845753518521, -1.254531036077103, -1.1818210592930487,
      -0.9922688234006246, -0.7400525419658923, -0.4831360695761076,
      -0.26950374196437654, -0.1265071684650098, -0.05582875911665669,
      -0.035174211814881964, -0.026152534332252092, 0.013712668683043439,
      0.11790698086796897, 0.30011172156689087, 0.5484304039868843,
      0.8262026055987506, 1.0793408039506553,
    ]);
    const expected = [
      [
        2.7807723549026884, 2.783339815337423, 1.9152389831056014,
        0.11398413721759049, -0.14577515250937245, -0.09902667422706923,
        0.26412615863013744, -0.10853522229928456, -0.14066610413316571,
        0.10952537947114213, 2.6874966491457424, 4.083877679527518,
      ],
      [
        -0.055357419575938704, -0.27182934804019543, 2.061651215783583,
        -0.12377461942414728, -1.1620595278091232, 0.7785562780781421,
        0.7339312829879241, -1.1825866479819183, -0.07391694164133158,
        2.4823030886495876, -0.7817613887225751, -1.4915569170802132,
      ],
      [
        -0.016852277084925316, 0.42928461817932795, -0.46526163567867607,
        -1.1406641464688172, 2.5426737496389875, -2.4136736658080107,
        0.6062081722068839, 2.1250827083267105, -3.4703050066410306,
        1.6711917145893198, 1.7995150769567705, -3.4967945157750724,
        2.029190845055368, 0.7482162603019628, -2.489907293385751,
        2.4934474120854717, -1.0204888429116488, -0.1754546663554994,
        0.05257890181369895, -1.5857563293286137,
      ],
      [
        0.1226717811407323, 0.5081799016496624, -1.3271948315439523,
        -0.07376637044095624, 2.1470424695239383, -2.377369248518429,
        0.3743024266000174, 2.03139297976051, -2.57004485091157,
        0.7976582123378062, 1.5093177842770389, -2.204798550305199,
        0.8914612677699736, 0.8772808093354385, -1.3833642257713714,
        0.49534823253852656, 0.4604041770733661, -0.3901614081051118,
        -0.33163570565602457, 0.4674984154781622, 0.43030287181973026,
        -1.3329406622282634, 0.8981274147574467, 0.8219606090447825,
        -2.163744070465262, 1.5427046582293373, 0.7262877652605102,
        -2.539500139730181, 2.0755817352174066, 0.3040298725340852,
        -2.3584508330579177, 2.200071688038965, -0.18470662339831945,
        -0.7810938250225993, -0.25356246153970163, 0.1429227024556795,
      ],
      [
        -0.1610122231917705, 0.9221524937340172, -0.7689015149879825,
        0.0766202658046316, 0.14595890458478933, -0.25563986522568377,
        0.584700531646669, 0.4060485224159474, -0.7846823123124137,
        -0.26567891858706816, 0.35988673264152427, -0.20686192127027372,
        0.2472104435892962, 0.6602998882007352, -0.5303697018074406,
        -0.6301478601403775, 0.37470873436786306, 0.029714355629217287,
        -0.05693180144263085, 0.6768974739048614, -0.12830452070313542,
        -0.8609357549939194, 0.15851635962818894, 0.32786369626469264,
        -0.1914213767744136, 0.47283453534663433, 0.2676695730153497,
        -0.85597662509276, -0.21642147078533475, 0.5315562493123767,
        -0.09989147519398547, 0.15959653961031547, 0.5086287369557838,
        -0.6119908005567474, -0.6046921593039436, 0.5246115925830906,
        0.16934486625031075, -0.1067486190127383, 0.5152988723980533,
        -0.22612554655703682, -0.8511271827977164, 0.2828513159356859,
        0.4848748205801101, -0.19498548177275146, 0.3120376627809881,
        0.14649529000576295, -0.8586285214975046, -0.1142716432710188,
        0.6905653377269352, -0.05708201845897087, 0.015124138027342388,
        0.3606142491659009, -0.6305570341400216, -0.5177276509477193,
        0.6749930097441517, 0.25031242351925476, -0.21944767438071655,
        0.3441905272840028, -0.2690131704132177, -0.7736726439012123,
        0.4212986916915553, 0.5906898793724191, -0.26562512555527446,
        0.12935768693080815, -0.05655714153903647, 0.08094653193446258,
        -0.596802014064655,
      ],
      [
        0.41917098783001255, 0.011331814653142258, -0.16841057326619327,
        -0.1397532235755891, -0.026635025266587342, 0.06764843051035926,
        0.06765839113985167, -0.008464394354433752, -0.06997920890398224,
        -0.04110618488816223, 0.0653800591572664, 0.15633479961140345,
        0.141656172667641, 0.017723174993583196, -0.1250680598172091,
        -0.178558196549163, -0.1093166017924285, 0.014905119445475817,
        0.08772023905724317, 0.05878587112683988, -0.024596021111111692,
        -0.06557509687099868, -0.010722143972282452, 0.09753726662851096,
        0.15746677423300456, 0.10096266311232502, -0.041367201124660934,
        -0.16270509757594862, -0.17106922924732956, -0.06799335875096138,
        0.05515514297813601, 0.09931111340180718, 0.04416905493666749,
        -0.03841103675015606, -0.05491853455451723, 0.0205172902143229,
        0.11997772208138152, 0.14308167595566437, 0.0503695260794102,
        -0.09633872600582156, -0.1842764277403419, -0.14665619262804974,
        -0.019836310671523555, 0.09013910757767314, 0.10123010802524174,
        0.02517663870002952, -0.04860760456900595, -0.03907729481486502,
        0.04956151912018597, 0.13054068120797635, 0.11464136186740098,
        -0.005113011472254264, -0.1417617131283358, -0.18764148007713288,
        -0.1077062623273809, 0.030414846652168454, 0.11638319141259222,
        0.09322807956298979, 0.003610876774337704, -0.05422385721624279,
        -0.019607441841599987, 0.07359362984702622, 0.12824148354947398,
        0.07498851007659245, -0.06000024126278292, -0.17315307003238645,
        -0.17245878591247843, -0.05804784579389061, 0.07780009306531471,
        0.13126070315552196, 0.07602824317789635, -0.01846311835542569,
        -0.05472840609250747, 0.0015995352008254804, 0.09030351001343595,
        0.11336297778921123, 0.02806244192271566, -0.10887526909059245,
        -0.18741884428254307, -0.1402206190717965, -0.0025742416207206464,
        0.11762874997441018, 0.13325501595880568, 0.051261422944875235,
        -0.03891491003337674, -0.05007051013581579, 0.022500433784771498,
        0.09810972439274081, 0.08742201933952527, -0.02149231281181138,
        -0.1469237119267563, -0.1831592154787381, -0.09410630621997762,
        0.0532386196643419, 0.1459439070076643, 0.12211409733826734,
        0.021311726399226516, -0.055754233063638664, -0.04068517888694943,
        0.04109705647876086, 0.09630886199722741, 0.05301490487613874,
        -0.06878580422755567, -0.17040800756582974, -0.16080586316869952,
        -0.0386686278474532, 0.1038728165131309, 0.15991561681336658,
        0.09888089721913187, -0.010912784374494361, -0.06732464176882247,
        -0.0274526965982708, 0.05562701015341522, 0.08513828303299792,
        0.013557486378189754, -0.10916527778570449, -0.1770346007850328,
        -0.1225782292582949, 0.020615752266034737, 0.1443140714060023,
        0.15812377839819483, 0.06579604420001692, -0.04226238324789436,
        -0.07246647247448222, -0.01161631763738457, 0.06473039158787597,
        0.06574673806091612, -0.056961109123289104, -0.22809938847819394,
        0.028159469592644443,
      ],
    ];
    const result = wavedec(data, "rbior2.2");

    const reconstruction = waverec(result, "rbior2.2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49282543897986686, 0.9084061082867547, 1.1860200141690553,
      1.2940060287606514, 1.235327238348852, 1.0449082494404194,
      0.7795402566034402, 0.5029845814535673, 0.27007263072991056,
      0.11380581931875294, 0.03865405663301824, 0.021642228702748137,
      0.0208099709470701, -0.011260471812455874, -0.11245101995693724,
      -0.29862755961227255, -0.5570097318981067, -0.8472316017826931,
      -1.1099624749635606, -1.2810098493213682, -1.3073978382113287,
      -1.1613680608661683, -0.8487269711083533, -0.40934642435477664,
      0.09043349384667883, 0.5717368479437492, 0.9600787390971083,
      1.2012004295007186, 1.2720011286662911, 1.1839804967067902,
      0.9784736947916038, 0.7150004247529161, 0.45574773793792256,
      0.25013703164221435, 0.12335640655608165, 0.0716909599250578,
      0.06572350015587775, 0.06045393176642036, 0.009610816955712198,
      -0.11964658713047, -0.3355405451839066, -0.6170105899497351,
      -0.9169148317483313, -1.1724222346686106, -1.3200665600948938,
      -1.3117108512175808, -1.1273938362206797, -0.7817695688507666,
      -0.3224251013068271, 0.1796266475712654, 0.6450362765203983,
      1.0031580380255933, 1.2069262507612846, 1.2419978977599984,
      1.1280256828586674, 0.9118887034103144, 0.6547050306389283,
      0.41597954018092176, 0.23891767867105906, 0.14059331084017035,
      0.10938593658023518, 0.11022389806637109, 0.0961629789778243,
      0.02320332694506272, -0.13558556710684366, -0.38039058289050787,
      -0.6820570190216073, -0.9873847160832248, -1.2311112982282089,
      -1.3516474933553473, -1.3066370245749526, -1.084410255870778,
      -0.7083904731547626, -0.23324738480852172, 0.2663615169937962,
      0.711779103176802, 1.0372091049411163, 1.203380167054224,
      1.2047488280875593, 1.068593826659505, 0.8463764904851432,
      0.5996604133251326, 0.3842157591448716, 0.23634550635490853,
      0.16486163624793682, 0.15066564052154383, 0.15392497441353295,
      0.12688368627569444, 0.028897062420559838, -0.1602957815446684,
      -0.43260447814428216, -0.7511182159607536, -1.0574123610976771,
      -1.28491280625226, -1.3750302320508796, -1.292031715977739,
      -1.0328883427159918, -0.6295591632411277, -0.1430383987678498,
      0.34946454161959717, 0.7711374729538445, 1.0619567073809175,
      1.1909071290832838, 1.1611303153159973, 1.0068702497766873,
      0.7831312878475216, 0.5507680288149182, 0.36083793073319764,
      0.2421868723344242, 0.19537318299231965, 0.1943883991790386,
      0.1956222096223685, 0.15165529580533677, 0.026220016379078726,
      -0.19363915069115617, -0.4914671663992045, -0.8230814216848208,
      -1.125767584815835, -1.332789657423071, -1.3896330683341804,
      -1.2679164473749251, -0.9734488058881863, -0.5463405468692052,
      -0.05304035341355258, 0.4278277234266279, 0.8224151834765754,
      1.0772901144588785, 1.1700079108649866, 1.1121265755411491,
      0.9440729011282296, 0.7232965712524293, 0.5088080693998165,
      0.3460665049780704, 0.2560479664326635, 0.23122100172183585,
      0.2393652352518031, 0.23414719008881069, 0.16962744772653077,
      0.014856972092356868, -0.23531404442308912, -0.5561346238036815,
      -0.8967721306750046, -1.1912413204294683, -1.3738034464892115,
      -1.3950256918086426, -1.2344786429317995, -0.9068508938823245,
      -0.4598757435930354, 0.035509887917798674, 0.5004286106885492,
      0.8650601723077533, 1.083264934364531, 1.1413298342167404,
      1.0588116007746153, 0.8814301023478746, 0.6679442180446971,
      0.47442529868958305, 0.33995693645265834, 0.27738214346549517,
      0.27139611544258047, 0.2843817523846984, 0.2683891276614471,
      0.18007589600903323, -0.00534455611860396, -0.28486061835664217,
      -0.6256491331152059, -0.9709754309144014, -1.2526676397805625,
      -1.4071316078314182, -1.3909371221700806, -1.1920683463052797,
      -0.8339787249822594, -0.3713614805621557, 0.12140314371264829,
      0.5663487226110865, 0.8986743780893098, 1.0801019220486163,
      1.105654825205828, 1.0023294821446482, 0.8201581090399946,
      0.6180549751981956, 0.4481173605432375, 0.34239878712773475,
      0.30550004601158537, 0.3148061040950539, 0.3282204856368559,
      0.29731532862843013, 0.1824159238221567, -0.034371351290961916,
      -0.341669037826772, -0.6989566266195438, -1.0444580852488354,
      -1.3089449953589898, -1.4320824520266169, -1.3772607415723532,
      -1.1411919770107861, -0.7558253441084861, -0.2820284764090603,
      0.20347974384147216, 0.6247900789856092, 0.9230207957953324,
      1.0681827789281397, 1.0638850203854655, 0.9438734596026958,
      0.7614388969430376, 0.574500593822075, 0.4302257750140887,
      0.3531178579685457, 0.339582332503949, 0.36029521285780003,
      0.36968330914442815, 0.31999023891061357, 0.17621321382141492,
      -0.07204454568831209, -0.4049904398846865, -0.7749257899270908,
      -1.1159909516269306, -1.359056293546755, -1.448107821247663,
      -1.3540563349196761, -1.0825032396388217, -0.673474796663868,
      -0.1931192072124452, 0.28065045587606596, 0.6750895336119667,
      0.9380275975754553, 1.0480430212826894, 1.0170261853131712,
      0.8846640801424992, 0.7063985780174085, 0.5380279558434893,
      0.42092978543102527, 0.37168131034639995, 0.37869477850373046,
      0.40666561746824714, 0.4076134923365978, 0.335592718119914,
      0.16119197503719845, -0.1180226952849206, -0.4739504335413311,
      -0.8523685784135249, -1.1843713334958048, -1.4020874331456885,
      -1.4548131327461495, -1.3215491008363476, -1.0167913515854443,
      -0.5880825461055961, -0.10586545979101453, 0.35191612675724704,
      0.7167306502834474, 0.943789244165463, 1.0203620474547228,
      0.9661692477306252, 0.8259268627896218, 0.6560868399860822,
    ]);
    const expected = [
      [
        2.9630114455460568, 2.874476408208, 2.8716142379104186,
        2.889985382573082, 2.362428640630979, -0.8116140288130659,
        0.22882930624399378, 0.495544869861513, -0.7957142302631698,
        0.501175824911533, 0.11446909718261611, -0.615796800444501,
        0.6946964041468481, -0.30337145572266067, -0.3262593436460792,
        0.7674488499967347, -0.6533821100299152, 0.005163396246143703,
        0.6904005628436773, -0.7924169951994762, 3.136540201466421,
        3.343127251094815, 3.367655512253577, 1.268435907360511,
      ],
      [
        0.2842241544979537, -0.011177433621755176, 0.06613388104694126,
        0.02139680194996453, 0.37850080607983655, -2.998349528972952,
        3.5356863610951006, -1.4616763388595382, -1.4400021518903414,
        3.002520019683968, -2.442479905781635, 0.38436311604805434,
        1.9060799093772718, -3.069725898284102, 2.1546563043205986,
        0.5530870859744241, -3.16291559397889, 3.3921627141477932,
        -1.0010980040125317, -1.3826046378861447, 0.2302902897156255,
        0.23925230383209187, -0.9634858981153398, 3.7147589780726515,
      ],
      [
        -0.6918056408501675, -0.17336848933816035, 0.4711869743206371,
        1.2053186129082603, -0.11824606099482668, -0.43406142854510055,
        0.6622173182231852, -0.31610959232895103, -0.6054280266245049,
        1.2522108623813282, -0.7588595059981701, -0.6688587281058853,
        1.706701962836284, -1.180098980497216, -0.6053578248443287,
        1.979123881431036, -1.519543695271358, -0.44162304774096656,
        2.0451913765204326, -1.7239478026950446, -0.2190213155002505,
        1.9055508487924084, -1.7547679835819634, 0.013084231893343179,
        1.5851827407496313, -1.59400823532475, 0.2051014296536997,
        1.1296649468434956, -1.247413330164951, 0.314951425976838,
        0.5988267330316855, -0.7445343035558301, 0.3146734361735948,
        0.04400160166810339, -0.19234918615604063, 0.1756156002665707,
        0.109631895055004, 0.13591256989690081, -1.4227295360099603,
      ],
      [
        0.9760629568775538, -0.6920046012131147, 0.375000591754979,
        -0.2525737925739605, -0.17716789198209126, 0.2919372484612551,
        -0.23629850040682993, -0.02990769183292731, 0.3967068775248102,
        -0.2324360554926087, -0.22663937399606346, 0.30401066536267607,
        -0.1459270719092622, -0.15233418803395712, 0.4065808671327361,
        -0.09827023996571599, -0.3253374873923543, 0.2698546460485084,
        -0.034547997773203915, -0.24837451339318997, 0.3654142854482012,
        0.049132368941731897, -0.38445457877271993, 0.19339239376467088,
        0.08117618742887434, -0.30549236762026805, 0.27950687529013596,
        0.19085676861562123, -0.39506666960477127, 0.08463546860704232,
        0.18400675206927825, -0.3167521004530817, 0.16102179270732375,
        0.3087122870834392, -0.354690629161618, -0.041666397008846445,
        0.2585681767982908, -0.28172425589054284, 0.026295022507265092,
        0.38766573094863793, -0.2676790995284035, -0.16804246762178382,
        0.29352667889960876, -0.2064861256705596, -0.1064128740779062,
        0.41784693905749143, -0.144684765190694, -0.2767084010366323,
        0.28320497295812636, -0.1027202941721117, -0.21941347339087797,
        0.39585422613201554, -0.0012643405294629276, -0.35203262282554804,
        0.2284083171839432, 0.01396144804614146, -0.29799314456527237,
        0.32518294183548396, 0.14418938871747483, -0.3827214925758976,
        0.13634590262997248, 0.12623474133082793, -0.332392861689237,
        0.21572027323316859, 0.27290687540247566, -0.4049088565819694,
        0.19227570852718914, -0.22111348277759824, 0.38506776565002765,
        -0.3255658509445991,
      ],
      [
        -0.10254695180370456, 0.23357103216723712, -0.08850685446835604,
        -0.04427999334796508, -0.017774707726380224, 0.006925327403650192,
        0.022703574372598324, 0.015143906914053765, -0.00761686907727984,
        -0.022836102768005864, -0.01499290277402312, 0.009241379375700905,
        0.027130920267457344, 0.02134729593262829, -0.0035283981508020465,
        -0.025119533318897002, -0.02414498718072164, -0.002383235500815317,
        0.019224531064056506, 0.020483416476770162, 0.0009977077930665278,
        -0.019652862882352552, -0.020730922381864178, -0.00026883840439134455,
        0.022832614410005905, 0.026579833475029357, 0.006737898552410665,
        -0.018989064863296996, -0.02744875334982763, -0.011658505313630548,
        0.012840069968191328, 0.022841660845874842, 0.009448212486362462,
        -0.013649657766423703, -0.0233851077009409, -0.00945083965219811,
        0.015671489788338516, 0.02835043556550878, 0.01613817695011726,
        -0.010334674971824845, -0.02719088924221515, -0.019615387027222497,
        0.004404436744658707, 0.021843395140066613, 0.016506996796600178,
        -0.005716143960848472, -0.022637357047456667, -0.017059869874029798,
        0.0066480977219866896, 0.026461379628340963, 0.023444054544985597,
        -0.0002799069843521518, -0.02335483158109143, -0.02513516079268286,
        -0.0049311847868721385, 0.01758612231356816, 0.021142592612107394,
        0.0029898393446785125, -0.018647030174479787, -0.0220817308369634,
        -0.002996273922364074, 0.021205617172272987, 0.027708581352799373,
        0.009860245202843218, -0.016407567631997154, -0.027420576689063884,
        -0.013876486367903085, 0.010628766679520993, 0.02266470545677124,
        0.011204956551306364, -0.012026082666301214, -0.02387054136306231,
        -0.011950287864844387, 0.013324761573782488, 0.028393418582501367,
        0.018756596903365466, -0.0072385933847969805, -0.026107465229308915,
        -0.021179780287368603, 0.0019162136150915991, 0.020821884629082597,
        0.01773752841684811, -0.003751623175890735, -0.02223520264745832,
        -0.019012073476752052, 0.0039061375620174773, 0.025440340370446533,
        0.025245111526776873, 0.0029589403100977046, -0.021317414972427638,
        -0.025801221408767217, -0.007349982731121307, 0.015838297838817565,
        0.02163461560895913, 0.004971912042709869, -0.017462803012668705,
        -0.023252932632255422, -0.005766902376679513, 0.019277359962825216,
        0.028483841362933728, 0.01284873360884356, -0.013644138755302536,
        -0.027057632684186626, -0.015876981012105586, 0.008384439388849765,
        0.02231589298013973, 0.012881836932570955, -0.01027589443534435,
        -0.024142809514398136, -0.014390806346147506, 0.010758736375958734,
        0.028066056229245476, 0.021131614273496177, -0.004075241700355628,
        -0.02471892640687736, -0.02245937743401264, -0.0005142809955086154,
        0.019655760243803548, 0.018834118964773983, -0.0017296844934603164,
        -0.0216203906681372, -0.020819655623899633, 0.0010471693402724774,
        0.024074144576991162, 0.026720980984671534, 0.006140031291456745,
        -0.019042734932306682, -0.026146651746426865, -0.03279948248810973,
        0.08983130100322831, -0.01692084932505057, -0.02508376575807894,
      ],
    ];
    const result = wavedec(data, "rbior2.4");

    const reconstruction = waverec(result, "rbior2.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4878857808824699, 0.9019284267949355, 1.1834340747107048,
      1.3004975509620915, 1.2534652550796626, 1.073036642819678,
      0.8115805548541861, 0.5298563055100688, 0.2824052625435127,
      0.10515743166210662, 0.008214268804058511, -0.024531663252008923,
      -0.028978355507261022, -0.04931675710724265, -0.1244261971591113,
      -0.2756535278626987, -0.4991241622282031, -0.764613424941252,
      -1.0213832676152206, -1.2096592389991783, -1.2750089767837682,
      -1.182133058901791, -0.9246772622281441, -0.5286010394427263,
      -0.04816768041357494, 0.4446130314409107, 0.8746866092952916,
      1.1793992456455327, 1.3211047764870818, 1.2940308030769845,
      1.123877169433872, 0.8603581728771885, 0.5645794632165427,
      0.2943551197242011, 0.09102693827947017, -0.02906179464483094,
      -0.07645930450961297, -0.0835354855648337, -0.09384068902416742,
      -0.14865711048494806, -0.2741955138147692, -0.47272707909831924,
      -0.7199655271074712, -0.9694666482731217, -1.1630694377754993,
      -1.244891653781849, -1.1754832320963295, -0.9426577450857561,
      -0.5662880682834408, -0.09578384615811421, 0.39928082676753407,
      0.8432751293890747, 1.1700984677450674, 1.336630106581084,
      1.330933705719551, 1.173363802085487, 0.9104180641425905,
      0.6029068282943502, 0.31135185832866924, 0.08215586113375217,
      -0.06214738632038863, -0.12628622646776344, -0.1385932555342425,
      -0.14134447606557882, -0.17762094883597718, -0.2780701537843713,
      -0.45096266399015283, -0.6781206980915113, -0.9178390754840692,
      -1.1141821602075372, -1.2104475358847542, -1.1635286969589822,
      -0.9556453969008603, -0.6005084559432345, -0.14230287628446894,
      0.35240917707418606, 0.8080618006291207, 1.1556578197626215,
      1.3469271902535076, 1.3637908025001946, 1.2209698358671042,
      0.9612181872762758, 0.6444129658291426, 0.3331902107241362,
      0.07860907003822887, -0.09072328328833407, -0.17351655010859054,
      -0.19359982780302437, -0.19135464073842928, -0.2110378399273669,
      -0.28725930010223144, -0.43407890660322407, -0.6395326972207548,
      -0.8670496246319153, -1.0635081445741517, -1.1720247047877936,
      -1.1463701539973836, -0.9634690303275253, -0.6308608034651687,
      -0.18719087430514542, 0.30453451007451093, 0.7694549997589055,
      1.1362582156175254, 1.3519054359209448, 1.392262043854923,
      1.2661885344853865, 1.0122084665362567, 0.6886383592747449,
      0.35961307641647533, 0.0803944676779848, -0.11451849728927005,
      -0.21768215753934544, -0.24800389483154922, -0.24337087554547718,
      -0.2485802522525591, -0.3016879176878253, -0.4222715283570624,
      -0.6046203576279788, -0.8176382886078855, -1.0115771012122177,
      -1.1300136507183807, -1.1241638258353583, -0.9660125787709914,
      -0.6569850140227386, -0.22993137365278726, 0.256203938492444,
      0.7278993025677356, 1.1121334708993416, 1.3515309792041252,
      1.4160541246755116, 1.3085385450345326, 1.0628366698049878,
      0.7350943208675148, 0.3903142696135842, 0.08746290552154956,
      -0.13331317001036502, -0.25834769369226834, -0.30126056978786664,
      -0.2968713886809608, -0.28987649461246495, -0.3212248855710774,
      -0.41568189080235013, -0.5737631106779892, -0.7701302076784403,
      -0.9589320523676792, -1.0848431000405891, -1.0971197881983723,
      -0.9632163370186112, -0.6785661412069505, -0.27003085688901335,
      0.20796941339497604, 0.6838707329370108, 1.0835678040854084,
      1.3458270445602172, 1.4349236183295344, 1.3475690415337453,
      1.112554309625429, 0.7832682137548401, 0.42494179129717924,
      0.09970870936161785, -0.14694092200078657, -0.29511521793288265,
      -0.3528372085734708, -0.3513184793002281, -0.33451468751971064,
      -0.3456843977283418, -0.41439548490289907, -0.5472969314284355,
      -0.7250300580642997, -0.9061235298019623, -1.0369754342837645,
      -1.0654997254456304, -0.9550775996145867, -0.6953377548529989,
      -0.30702402968717224, 0.16038182582462926, 0.6378716758445043,
      1.0508927991728112, 1.334873696886205, 1.4486795776988926,
      1.382864542266773, 1.1608225042245053, 0.8326289300362256,
      0.463101590839034, 0.11697080886916622, -0.15529063013118677,
      -0.3276284558712671, -0.40221910102792435, -0.4061642827880289,
      -0.3820471640409959, -0.37482794826381716, -0.41844101733145794,
      -0.5255107484501793, -0.6828166591922169, -0.8537036921558026,
      -0.9869017495456947, -1.029614134632387, -0.9416506901570647,
      -0.7070847884407305, -0.34047879323353575, 0.11398511975928152,
      0.5904255086846043, 1.014483862180967, 1.3188069857476126,
      1.4571855754430605, 1.4140493494471695, 1.2071177358952352,
      0.8826325661804019, 0.5043617769663026, 0.1390344590909175,
      -0.15830761460409581, -0.35557660594312396, -0.44891497049831586,
      -0.4608566246337648, -0.43199525305181913, -0.4083668797235488,
      -0.42779010354286207, -0.5086433563705106, -0.6439378572444181,
      -0.8022204249303968, -0.9351366090638388, -0.9898190079788731,
      -0.92304638120454, -0.7136458376424412, -0.37000086191328146,
      0.06931047930620665, 0.5420710082718547, 0.9747562093892761,
      1.2978174913770182, 1.4603611616856025, 1.4407915637687487,
      1.2509374452056738, 0.9327282351732773, 0.5482572330790564,
      0.1656335354947785, -0.15599422283116782, -0.37869766008481515,
      -0.4924622230070541, -0.5148449203611691, -0.48385439379140605,
      -0.4459654673115859, -0.44235757090421135, -0.49688086413066795,
      -0.6088057396781467, -0.7522114861310193, -0.8822125450265345,
      -0.9465120291956414, -0.8994307109901982, -0.7149148854566924,
      -0.39523797693870105, 0.026870652243881465, 0.49335659329303666,
      0.9321604301782058, 1.2721482879793347,
    ]);
    const expected = [
      [
        2.964656788918548, 2.8690577480969615, 2.870340100676694,
        2.8825192220693525, 2.3694277334968565, -0.8095347185082308,
        0.23884637145188614, 0.4477571392012841, -0.7555689883810366,
        0.5581752397838654, -0.017740468323675818, -0.5653643809258326,
        0.8074485460088351, -0.4488106480721453, -0.31072841699823317,
        0.8494705056505542, -0.696771123226972, 0.013144508473633021,
        0.613187458378523, -0.8836177933947553, 2.105190350533111,
        2.437584139650791, 2.6496627414461082, 0.3870655868568059,
      ],
      [
        0.2879202009101167, -0.01571550065177417, 0.06922247326731791,
        0.03061844498421129, 0.40940556744429124, -2.9719161214859873,
        3.358933488383432, -1.479033882204326, -0.9712761200793499,
        2.6188336833860784, -2.8423614843355063, 1.2082754365957238,
        1.7380223730512316, -3.7366702996480337, 2.6587678577513336,
        0.7612165661057348, -3.3712648130380045, 3.0700596125439503,
        -0.8950705471696858, -0.47451478917466905, -0.5497785666308213,
        0.5639530574191569, -0.6572559915544329, 2.664042908217453,
      ],
      [
        -0.6895164214622397, -0.17576561497955323, 0.47070447101346136,
        1.2249510429900916, -0.16401734100595472, -0.4987645106562249,
        0.9307480513903654, -0.6492306437144544, -0.5165950076292575,
        1.6030234140849347, -1.3912707739011425, -0.21330682597137565,
        1.8450067360864257, -1.9236946741785461, 0.27028098399589773,
        1.627982460339185, -2.0470114655290823, 0.6973047647850523,
        1.0729846243253764, -1.689192441949908, 0.8484314049264359,
        0.4055129080465619, -0.9327456162344463, 0.6031942965137437,
        -0.1255953817780437, 0.011639182253993668, -0.013539309617532198,
        -0.3365055810005037, 0.8757725033451635, -0.8365558538409799,
        -0.17283181342961235, 1.4243355135094131, -1.6152144298026168,
        0.3070442802530019, 1.252124004884314, -0.8760331081765245,
        -0.649708152427793, 1.4691335416258513, -1.1318092746878543,
      ],
      [
        0.9704606898033341, -0.6942144964844212, 0.3761749600261554,
        -0.23794449726869674, -0.1933115165076915, 0.28513183643999207,
        -0.19126883621149454, -0.07996930617222657, 0.38457686722468004,
        -0.14735735251370946, -0.2962670204239235, 0.26707767377224295,
        -0.022801498247425812, -0.23139617905015858, 0.3307065032185187,
        0.06891601468986502, -0.3882166657817523, 0.13984967317059643,
        0.15628158871249695, -0.28340734796512396, 0.17734057525222569,
        0.2608267627425782, -0.36060205531610584, -0.05449652084595337,
        0.2781010615557353, -0.22032978232596326, -0.019475970470293466,
        0.3658097401197902, -0.22002329877137417, -0.2492130161577241,
        0.29504918745338415, -0.06789265446165821, -0.18958041093197014,
        0.3515652959654572, -0.011945246472721695, -0.37622676254838006,
        0.19681771489950256, 0.11603455443250801, -0.2734155459702986,
        0.227131440816457, 0.1950424119785397, -0.3900455880804194,
        0.014287656963523908, 0.2620464371285046, -0.24295056903305612,
        0.03946014941242054, 0.3330569751576346, -0.28380118693943757,
        -0.19110261453013516, 0.3138896797632367, -0.11144634366347103,
        -0.14328360846835758, 0.35848622910601047, -0.09178650257091621,
        -0.3487873278783702, 0.24853864783885687, 0.07136219290760053,
        -0.25581739740375753, 0.2670188985089681, 0.12241195930158058,
        -0.4037785174691938, 0.08458316207109723, 0.23696347184175942,
        -0.2587531812889388, 0.097057032170744, 0.367694619036446,
        -0.8491360985946415, 0.8692335517403301, -0.48311623336036125,
        -0.0833159680869389,
      ],
      [
        -0.10008877599691804, 0.22995020943163505, -0.08726112997390903,
        -0.04229630491658032, -0.017665748643289424, 0.004781096483237442,
        0.020619620284130148, 0.01585051838246749, -0.004247563425553464,
        -0.020172163739192655, -0.016308788902219772, 0.004530262228201552,
        0.02349908550353461, 0.02289919535202784, 0.002450699152654376,
        -0.02024660032674599, -0.02553462186205327, -0.009401019596613193,
        0.013055717830697797, 0.021518130883500228, 0.008974520185123278,
        -0.012049372693110688, -0.02120550689933267, -0.0092082878593606,
        0.013448435872657902, 0.02596905672635745, 0.01629129000409256,
        -0.007732045208915968, -0.025266917714730615, -0.021268338723651692,
        7.271663058056044e-6, 0.019042816395429554, 0.018922653342564415,
        0.000678945283576201, -0.01788056850265637, -0.018734913595606216,
        -0.0003884985870089893, 0.020584382701976076, 0.024645290265021543,
        0.0072471266645381255, -0.016801459814155012, -0.026604757271255892,
        -0.014016203376721284, 0.009114801506577841, 0.021861905941371308,
        0.013301418089888533, -0.007680320845225481, -0.02077486316510894,
        -0.013099936456484346, 0.00879586484167232, 0.024804933678641235,
        0.019668546903306425, -0.0029168668277759977, -0.023432048578026596,
        -0.024102939709297916, -0.004909494062600564, 0.0165429547930806,
        0.021135752056966814, 0.005595991589242811, -0.014740223802138682,
        -0.020230248403965055, -0.005145653304759719, 0.016914219537912435,
        0.02540956972119633, 0.011733116550617845, -0.012711509981424937,
        -0.026664404807405805, -0.018179131197296933, 0.004654469003665708,
        0.021189650743116954, 0.01704480491148393, -0.0029286788878491775,
        -0.019345414362680488, -0.016289969043385446, 0.003906047749924346,
        0.022681540626663124, 0.02224160507284595, 0.0019845278264017316,
        -0.02069935698462481, -0.02604901669900337, -0.00975940803538329,
        0.013227248749908285, 0.022396410790934955, 0.010294963578115513,
        -0.010884193163307698, -0.020730634135397694, -0.009538488281555858,
        0.01264450030718955, 0.025158568266515177, 0.015716435490663594,
        -0.008151970748763122, -0.025711547084716478, -0.021712392697650566,
        -0.00013470252838543306, 0.01953084280295321, 0.020046103314878716,
        0.002003925322955219, -0.016977468561224535, -0.01864222792715851,
        -0.0010128963494034585, 0.019688651597446604, 0.023899803589362487,
        0.006762233319966074, -0.017186052040432054, -0.027023904483229035,
        -0.014335520599322901, 0.00923769489705406, 0.02265182919294844,
        0.0145765445087686, -0.00647605277038791, -0.020214330932571932,
        -0.01337982711713328, 0.007956681605777886, 0.023902096956335134,
        0.019026278311484117, -0.003318076413641683, -0.023787322228174007,
        -0.024465412234445087, -0.005048111872457628, 0.016957018702448028,
        0.022178370699446615, 0.0069081471406719575, -0.01377134581482793,
        -0.020056275137767563, -0.0057516133037026854, 0.015953101154448035,
        0.024571478894773704, 0.017377847379960322, 0.015713127718738267,
        -0.10979604690012258, 0.02905836689017895, 0.0203829445563037,
      ],
    ];
    const result = wavedec(data, "rbior2.4");

    const reconstruction = waverec(result, "rbior2.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.6", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.484306043406588, 0.8948945829061667, 1.173406181765361,
      1.2885935400519926, 1.2417421722721034, 1.064563429488423,
      0.8101856216302932, 0.5395288343277724, 0.30644334115136934,
      0.14525402613744487, 0.06372199844242016, 0.04306700955289969,
      0.044928357892705675, 0.023413143387439384, -0.060885063538887396,
      -0.2285051066059492, -0.4735779393849002, -0.7631294445478096,
      -1.0435270692421892, -1.2525876880713231, -1.3344386973893092,
      -1.2535088659961309, -1.00419794614918, -0.6137946405148591,
      -0.13783313717406537, 0.3510965159406028, 0.7784855328318971,
      1.08343786227288, 1.2309507112633422, 1.218091328456005,
      1.0727002306411133, 0.8450614009510694, 0.5946747919486999,
      0.37543162745250586, 0.2228447530943618, 0.1464407357272947,
      0.12911396055820487, 0.13349869950332, 0.1136633256045006,
      0.029103297232069003, -0.14256661859777864, -0.39750302600513465,
      -0.704256486480713, -1.009604768365326, -1.2502792279218622,
      -1.3677869812757917, -1.322733453334767, -1.1051317645063943,
      -0.7381296117423921, -0.274161528492444, 0.21564014973197657,
      0.6563146613543958, 0.9847296547181547, 1.1623485375278158,
      1.1821398142514496, 1.0680869517425364, 0.8675533878982198,
      0.638482734444622, 0.4346472083359947, 0.29259731119129856,
      0.2235071317385106, 0.21186744118530393, 0.22126035817565692,
      0.20567885658963075, 0.12346832556833542, -0.04969248796615755,
      -0.3121245558972119, -0.6340865324168766, -0.9629737054490772,
      -1.2346291332967856, -1.3880875327144555, -1.3801936790071547,
      -1.196528007649413, -0.8559374134325577, -0.4074990183907964,
      0.07943416302740773, 0.5297890253700613, 0.8785062647055659,
      1.0837535023939322, 1.134541342521172, 1.0510336267034859,
      0.8776204049586859, 0.6705738095986542, 0.4834046321883658,
      0.3535643879396951, 0.29376691856047016, 0.29002858783767566,
      0.3068377731852058, 0.2980794561059759, 0.22089951112696546,
      0.04895128019267597, -0.21839242662609765, -0.5532894729103567,
      -0.9039729943220999, -1.2056136750799755, -1.3949451867265947,
      -1.425140805568208, -1.27732909641822, -0.965920670345142,
      -0.5363963958992836, -0.056019650376313956, 0.4003612758001635,
      0.7660757961564537, 0.996247670827894, 1.0760898422841128,
      1.0220062557254688, 0.8753834036436346, 0.6907277810038418,
      0.5211643351721014, 0.40492353770224193, 0.35616267121162976,
      0.36236192872033907, 0.38888169350477975, 0.3894724050926319,
      0.3200355730123491, 0.1521121359762737, -0.11737418416014711,
      -0.46267730878037266, -0.8330999908165375, -1.1633739149449096,
      -1.3881258611632297, -1.4569732277455805, -1.3466011432223426,
      -1.0668742368494049, -0.6594592799811406, -0.1892335182057297,
      0.26951150254609324, 0.6488131569281306, 0.9010146666981296,
      1.0077088491946193, 0.9816202309866571, 0.8611232960635543,
      0.6988853690252599, 0.5475393284682192, 0.44598780060247073,
      0.40974771952164823, 0.42771176341830985, 0.4660870588862445,
      0.4784708731805922, 0.4194821467109321, 0.2584669721292387,
      -0.010241704698881082, -0.36319432392288836, -0.7510045767929958,
      -1.1082144757054813, -1.3675599135980536, -1.4752442288138314,
      -1.4035456408745945, -1.1577000987918462, -0.7753653089160742,
      -0.31875209659002035, 0.13872875284421446, 0.5281426419102241,
      0.799324383062961, 0.9304392623248927, 0.9306318621556177,
      0.8352767354189604, 0.6951485137644334, 0.5622999056016047,
      0.47621455824227205, 0.4536986189769518, 0.4850175097884167,
      0.5372103185930038, 0.563712188385135, 0.5178299220140591,
      0.36663904522811797, 0.10174348482202628, -0.2559055504547867,
      -0.6584814928778705, -1.040600234924266, -1.3333434224891865,
      -1.4796677892025887, -1.4475094510872, -1.2374209268386773,
      -0.8828804156200003, -0.44317045301843194, 0.009492458135025195,
      0.40551991580279145, 0.6925166210719972, 0.8454256248187106,
      0.8699281115586055, 0.798429900902709, 0.6797785578990385,
      0.5653763102836915, 0.4952125128599734, 0.48732602022708754,
      0.5333278205903522, 0.601085964851496, 0.6438758141242009,
      0.6136729993313984, 0.47521561431401627, 0.21724606068430674,
      -0.14198367227727543, -0.5564608163094007, -0.9611509825707064,
      -1.2857373752607009, -1.4701223728557973, -1.4779929655164512,
      -1.305192109275324, -0.9808739824587275, -0.5611513970894272,
      -0.11674599432685867, 0.2824136253757715, 0.5819838669065368,
      0.7539011047903917, 0.8005146716807005, 0.7513103680265215,
      0.6531923739046822, 0.5568593313453283, 0.5027467006237012,
      0.5100837974758647, 0.5718132880422881, 0.6566420681241306,
      0.717700802412947, 0.7056272289382568, 0.5827660714402132,
      0.3348737288536934, -0.02269453314825981, -0.4459967040032501,
      -0.8706341095110905, -1.2251647726426178, -1.4466526426251791,
      -1.4946563355209541, -1.360312111624115, -1.0683326834139644,
      -0.6714419391203207, -0.2385813107994612, 0.16028687566890532,
      0.46915342712157426, 0.6571713693918376, 0.7235025388358796,
      0.6947771698620108, 0.615956486482156, 0.536998817896253,
      0.4987414749584584, 0.5215763183010146, 0.5997775725726712,
      0.7029146140646039, 0.7840024987420527, 0.7923482978518794,
      0.6878603322357933, 0.45319480951189156, 0.10061856676269132,
      -0.32825454313216346, -0.769955418751968, -1.1522056851792586,
      -1.4094690823705125, -1.4973236914039614, -1.402231031767015,
      -1.1443728382117573, -0.772888667848177, -0.3546717318908278,
      0.0405788062554574, 0.35546915087295894, 0.5565975590517328,
    ]);
    const expected = [
      [
        3.1533638146325744, 3.453330631589015, 3.439592051419829,
        3.2763740150424208, 3.3370086077418906, 3.4640170982895278,
        2.086611473311343, -0.7308622514524077, 0.053176173983280894,
        0.6710751046910862, -0.9067372043329824, 0.5459268562972588,
        0.08875627575416867, -0.6120519352788444, 0.8030199697790326,
        -0.5692523707150654, -0.03903200815468644, 0.7012415593579024,
        -0.9318141726114723, 0.5097453310638511, 0.25212505871873603,
        -0.9565359771974421, -0.7866943860037819, -0.44783303556531406,
        -2.239350692957809, -1.0092158997508598, -0.6731815127753769,
        -1.219351582336882,
      ],
      [
        0.2168614971675205, 0.5725930812285472, 0.2800372689153027,
        -0.6699146264090895, -0.15529466723502813, 0.12456303444662914,
        1.0078595094316594, -3.652670165736722, 3.812456508281142,
        -1.234013223565508, -1.8865677787180735, 3.3217687212467943,
        -2.7404953992880294, 0.9998910584345986, 1.2250914390816825,
        -3.1844596036873227, 3.4643653415847617, -1.2053331293068135,
        -2.21128385347834, 3.98038515156615, -2.675728948015958,
        -0.44262281211117444, 0.4831482157433982, -0.9859698604170647,
        0.9040835834683901, -0.26977970824725006, -0.366353341043649,
        2.6046015061826857,
      ],
      [
        1.1323985092318907, -0.41121779922311835, -0.8951612948427903,
        1.5892330643165464, -1.0932246842721653, 0.1980560918017548,
        0.4293104820274161, 0.10602122700881103, -0.6320635762464516,
        0.7389367301693878, -0.5819647477538068, 0.25646509368157594,
        0.31513860532747484, -0.9573360205002043, 1.0912442383984347,
        -0.29677553516089406, -0.9967754176123426, 1.6568341290537294,
        -0.915844571663843, -0.7204215077770029, 1.8109428940626993,
        -1.3468344449387315, -0.2444685067342103, 1.5228786150065694,
        -1.4395158402437318, 0.25760109269374426, 0.8807171349923402,
        -1.1359960042468413, 0.6104983164799668, 0.0648928640799381,
        -0.49173910852860664, 0.6923857283247615, -0.7039331516970309,
        0.33643896236936555, 0.46386079976263456, -1.201075266058723,
        1.2043273320214891, -0.12024028766671288, -1.6383400868300864,
        0.6890094758866638, 1.6535720211491005, -2.0260092505745853,
        1.4851062413039124,
      ],
      [
        -0.26062191418511294, 0.15756736752629852, 0.12164696193039035,
        -0.5499919432214458, 0.8167765419723373, -0.47997144890090193,
        0.19634909841671416, 0.05857838098910881, -0.2076466250979459,
        0.13415347403286415, 0.11928971715012894, -0.2253607285913829,
        0.05494262452020175, 0.15484310170484802, -0.19717638612698515,
        0.020826867100701554, 0.20406570170112232, -0.1754590050709026,
        -0.06368095546755022, 0.20543109938290405, -0.12750658756625619,
        -0.09655559788051414, 0.2299203162034272, -0.07425419372473985,
        -0.16549616530629496, 0.19363627954916898, -0.01996253911650613,
        -0.18353330248111033, 0.18968315526948912, 0.0490949706642759,
        -0.22004661417002144, 0.12258717035057848, 0.09291163723235256,
        -0.2148717439109482, 0.09548005041427829, 0.1588590972556173,
        -0.21063480972691195, 0.013185643196511963, 0.1770694177985788,
        -0.18196064380081853, -0.024880921507292746, 0.22320558305069732,
        -0.13933114670316932, -0.10205866731513501, 0.2071130079756755,
        -0.09527535611483755, -0.13612436701967182, 0.2235294395911306,
        -0.02645311547940567, -0.188659803506575, 0.17386745513997864,
        0.018815261443838962, -0.20589583341287024, 0.15989949395163663,
        0.09534301597362792, -0.22040304161921032, 0.08713037234458969,
        0.12593869311718006, -0.2142577258109945, 0.05101695764785127,
        0.19062409306199757, -0.1871726137100852, -0.02722034244185348,
        0.1939619525887748, -0.15949468808612696, -0.07237615722692961,
        0.21590376725791963, 0.0076967829120384995, -0.3728049783725033,
        0.519885174264057, -0.23777429899252958, -0.15285095896105474,
        0.1316477835654088,
      ],
      [
        0.01160625696395931, -0.07558918463680829, 0.16345804911235912,
        -0.11434917985527422, 0.005569204625792309, 0.0002565665038582639,
        0.0015828366087899618, 0.004682711642362747, 0.0033767757177396145,
        -0.0010881305836531628, -0.0045426379107153195, -0.0037503750586103893,
        0.0005967932928722008, 0.004507252528426556, 0.004364813055996976,
        0.00026434862643076595, -0.0040669499779728766, -0.00469220737983895,
        -0.001080013784203306, 0.003416527143912289, 0.004655791350473792,
        0.001524006743357011, -0.0030450530601553684, -0.004785195139594708,
        -0.0020427668142740177, 0.0026874071342241797, 0.005053485779264198,
        0.0028555039534101647, -0.0019224997896166857, -0.004931046735868635,
        -0.003450845204868138, 0.0011138412301036052, 0.004538946323071952,
        0.003677641383617536, -0.0006418581674848189, -0.004387801981263315,
        -0.004052738932189415, 0.00010082150708613097, 0.004271289297732853,
        0.0046152728092327495, 0.0007896421171791632, -0.0037260059806952326,
        -0.004825155590739807, -0.0015458023792604884, 0.003055127315158369,
        0.004727334085018964, 0.0019466508508247313, -0.0026843207237586585,
        -0.0048443131217947594, -0.002488636058810824, 0.0022535242962309914,
        0.005031393682667358, 0.003277626647234311, -0.0014238808906643727,
        -0.004789988985478416, -0.0037737958996696633, 0.0006405245043687783,
        0.004356118687280327, 0.003945966974071028, -0.00018810580733556043,
        -0.004191443178664508, -0.004319699233763016, -0.00040274729963186854,
        0.003986133546864359, 0.0048146771562739, 0.0013047973846881762,
        -0.0033468617886471975, -0.004905883338937616, -0.001989991791243701,
        0.0026700503547287965, 0.004757507429036943, 0.002353258925539335,
        -0.002296646255321325, -0.004858192590419006, -0.002915267274871489,
        0.0017904132114342293, 0.004952807627262984, 0.003662687504592969,
        -0.0009124522430752945, -0.004599234641031017, -0.0040543237506130685,
        0.00016732757234759477, 0.004136521873103182, 0.0041801833029985165,
        0.0002700805892747087, -0.00395402147260859, -0.004547434200031927,
        -0.0009083472063425935, 0.0036544279953702767, 0.004960139590142265,
        0.0018032964348808807, -0.002934832313162602, -0.004934906713753394,
        -0.002408945273725229, 0.0022650612535200353, 0.004746671171087286,
        0.002741014885976027, -0.0018843747624339843, -0.004825255321248211,
        -0.0033173909870885766, 0.0013030401335007834, 0.004818109341254975,
        0.00400579069459331, -0.00039477183023875484, -0.004362197915715729,
        -0.004290836383253159, -0.0003016411962386929, 0.00388247583367319,
        0.004378794345421734, 0.0007294805367057643, -0.0036763689370258573,
        -0.004732317039690048, -0.0014100838898856863, 0.003279626102490574,
        0.0050496137259201206, 0.0022789731073126255, -0.0024955354766433256,
        -0.004913399250788458, -0.002799552495982633, 0.0018437814847482611,
        0.004695266319976217, 0.003107055519089145, -0.00145018301909938,
        -0.004744306971294035, -0.0036897495898495503, 0.0007969398035470639,
        0.004628582721213449, 0.004302735686239818, -0.0029248582649189798,
        0.0045542314217355915, -0.01997592016209221, 0.014723901467559834,
        -0.0057830434110867175, 0.0019298866417206757,
      ],
    ];
    const result = wavedec(data, "rbior2.6");

    const reconstruction = waverec(result, "rbior2.6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.6_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5079857722279555, 0.9365748972822255, 1.222734783339821,
      1.3323329847583063, 1.2659525638372062, 1.056732825782458,
      0.7609185437482942, 0.4435572229806443, 0.16292678882314615,
      -0.04247448355170569, -0.16124523011006608, -0.20904765903325825,
      -0.22143946289108357, -0.24159173781704713, -0.3061984287123587,
      -0.43332675880023735, -0.6154511527554059, -0.8195832457466707,
      -0.9945916220523058, -1.0839535584202593, -1.0407626001447834,
      -0.8411881745834082, -0.49290766659465557, -0.03623114804990585,
      0.4625806658512812, 0.9243840890900699, 1.2736003275880368,
      1.4541840952822687, 1.441343349962148, 1.2462538963965337,
      0.912700489711856, 0.5065223139452648, 0.10046539390048032,
      -0.24187691779363701, -0.4791855773450064, -0.5995288438772879,
      -0.6199252091071946, -0.5787113447545806, -0.5228604569586534,
      -0.49363491508254426, -0.5143366984608418, -0.583348088740365,
      -0.6742788381377206, -0.7432016468148797, -0.7411265731039548,
      -0.6284976688626849, -0.387936635763438, -0.03185165392443934,
      0.3972200723919864, 0.8338693430154732, 1.2031057930295441,
      1.4365900832854297, 1.487942562827448, 1.3434405050335427,
      1.0255022052318683, 0.5880856733952501, 0.10507660581494424,
      -0.3455751542065983, -0.6982043228099543, -0.9124149831339963,
      -0.9797119601724866, -0.9223754391896166, -0.7850931787082929,
      -0.6216373706418601, -0.4800618048901863, -0.39020685563990815,
      -0.3566613685746343, -0.3589053498102391, -0.3585050555584088,
      -0.3114184578274886, -0.18214980337863856, 0.04400108161044858,
      0.3538908461694326, 0.7066855013425013, 1.041401513101681,
      1.2901474364627161, 1.3939098206621359, 1.3170341265305074,
      1.0568108512039815, 0.6457290894992945, 0.1457223853124128,
      -0.36432932399068324, -0.804941348590754, -1.112379411118151,
      -1.251204810874135, -1.2201265334742373, -1.049918106984895,
      -0.7940915892457624, -0.5147707255644194, -0.26733832933713386,
      -0.08767173935560396, 0.014929856992066892, 0.05749985252774044,
      0.07608660227639574, 0.113407875871955, 0.20479445809283064,
      0.36616954091999737, 0.5872895174700247, 0.8321308952597919,
      1.0464833534821953, 1.1709580331989795, 1.156207877345766,
      0.9765394500131281, 0.6384316804512975, 0.1816874019336054,
      -0.32726879010480675, -0.8085096336540344, -1.1851222411954974,
      -1.3992555262544555, -1.4239270700583786, -1.2678376786072723,
      -0.9721325663764447, -0.5999930008909161, -0.2216615068208207,
      0.10142591032884746, 0.3295672654505064, 0.45173459806897903,
      0.48501153094193283, 0.466907475877931, 0.44270996724924505,
      0.45126296034875923, 0.5129245999148402, 0.6228738036272365,
      0.7515494479128448, 0.8521678234965601, 0.8734354589987043,
      0.774215415381414, 0.5363587952746811, 0.17231984443722972,
      -0.27456495972188155, -0.7374475684407735, -1.1394008794773094,
      -1.4098010446322242, -1.4997813054976983, -1.393063930645585,
      -1.10957002267237, -0.7009405193420337, -0.23904871564660665,
      0.1997348012829382, 0.5507635209801008, 0.7739861048865067,
      0.8604958708399888, 0.8313754483106769, 0.7293679844306057,
      0.6056709751911561, 0.5053257940932305, 0.4549749693605605,
      0.4561094486356577, 0.48549561987094536, 0.5026180928284563,
      0.46216547734722124, 0.3282774093853481, 0.08679161393900037,
      -0.247797819708935, -0.6326512973799338, -1.0043246468445577,
      -1.2922243420855946, -1.4345964181678752, -1.3931832240921735,
      -1.1629510355444568, -0.7744521446137115, -0.2881532370311406,
      0.2179978010028421, 0.6648607673842601, 0.9884178350309722,
      1.1522973275369648, 1.1536354980152133, 1.0210477930062605,
      0.8054128068223008, 0.5659144712561024, 0.3549106192802317,
      0.20542362246897616, 0.12432934904501541, 0.09283814992601594,
      0.07398965283049358, 0.02509193385510311, -0.08822567577921142,
      -0.2800921021731237, -0.5378170847804792, -0.8225153908842769,
      -1.076960508342959, -1.2388446736782943, -1.2562154576777682,
      -1.1012513937754487, -0.7788863530155683, -0.3280128936266572,
      0.18521073339774724, 0.6804997557529039, 1.0799979789491003,
      1.3243754605433098, 1.3846986460077544, 1.2673275016164252,
      1.0107871615049477, 0.6755045577707812, 0.32901370184405215,
      0.030294790087318724, -0.18293733276577673, -0.3009733167260184,
      -0.3413915536792604, -0.34128778574704455, -0.3446318278384232,
      -0.3881452747267747, -0.4894454748859848, -0.6406034893445101,
      -0.8088683895189269, -0.9444678954771168, -0.9935688811652905,
      -0.913130060677201, -0.6838444214030689, -0.3177884143279763,
      0.14133181608625722, 0.625633545770314, 1.056602202678799,
      1.3615982191452616, 1.4894362996702195, 1.4213396538812804,
      1.174671395569186, 0.7985823386808314, 0.3626608127551063,
      -0.05865390805459636, -0.4021398660305676, -0.6285202260216505,
      -0.7288996857611251, -0.7235486585779021, -0.6535858290178181,
      -0.5678661239779309, -0.5085461601568175, -0.4990848588154663,
      -0.5377752055726246, -0.5984628190896937, -0.6382512209931356,
      -0.610189278240255, -0.4776371318747002, -0.22654071032809148,
      0.12766878975579116, 0.5405138628389103, 0.9463847391162534,
      1.2721866053355018, 1.4535166861188058, 1.4494898945821428,
      1.2526094794922071, 0.8912476147074558, 0.42407399309196336,
      -0.07228839874266008, -0.5194706916606323, -0.8536011787832207,
      -1.0377764082684144, -1.0679035364504426, -0.9707012313132035,
      -0.7945749255406868, -0.5958167649722168, -0.4236922141345359,
      -0.3081910094516819, -0.2534907275221018,
    ]);
    const expected = [
      [
        3.188429463190708, 3.556288202747931, 3.53714348134592,
        3.35493930933626, 3.4391463102862163, 3.5724196583546135,
        1.8459201325938248, -0.28188629827448963, -0.41607352223031324,
        0.6125129795175188, -0.03561452056816372, -0.6028804603955648,
        0.48748348779593037, 0.24959499171528665, -0.675993751917991,
        0.24768650672055048, 0.49044432501298596, -0.6038970813803123,
        -0.03900102217455392, 0.6173009696881735, -0.41567209197665456,
        -0.4717941136366792, -2.3279362942845583, -2.116335226002833,
        -2.5057299861171654, -2.372908675368479, -2.121877415344015,
        -2.036773730408925,
      ],
      [
        0.18589648950563087, 0.5847790899775532, 0.2958206052684705,
        -0.7022226286311043, -0.0870531969901506, -0.15737609992847534,
        1.8922613814368416, -3.583299280666917, 1.0124350219737868,
        2.861865945556132, -3.180399119009049, -0.5677125011882863,
        3.667229269807686, -2.1236621242413554, -2.132429618692081,
        3.672843195128451, -0.5589371391004209, -3.2022552332959813,
        2.86610640514372, 0.984139093938713, -3.20519637189576,
        0.6076993949151392, -0.5853078451553357, 0.16798115172517175,
        0.004995054603664142, -0.07635968526164084, 0.3081678677545581,
        0.7622946563501448,
      ],
      [
        1.203373001351707, -0.43785265264348355, -0.9057972360394496,
        1.6100479533257068, -1.0710851218251418, 0.15604040696289095,
        0.39582024764207424, 0.44442813081601534, -1.2034251455067124,
        1.0494126537394093, -0.14373408314073033, -0.7541222501442505,
        0.9935951460158641, -0.5008636954584599, -0.2596024403369849,
        0.7180609315218602, -0.6267841070557214, 0.16077781642673636,
        0.30819372104110826, -0.5105253111384056, 0.4083362445678072,
        -0.1228579362456601, -0.19617330997816962, 0.42582476638975625,
        -0.4590269574692459, 0.2271360380040178, 0.20969967815511045,
        -0.6067354360924379, 0.6448542694774713, -0.18913502525784212,
        -0.5154644395842681, 0.9421113372925407, -0.6762680300348091,
        -0.18911175660592575, 1.0187989219172773, -1.130789178967505,
        0.5757312711486948, -0.02173437708100157, -0.5725426541608082,
        0.09831414345069668, 0.8742455692157273, -1.3079505476299025,
        1.8398848800177559,
      ],
      [
        -0.2698971096843525, 0.15953111909601478, 0.1462504518265035,
        -0.5967526619896494, 0.8666123886450362, -0.506394120171001,
        0.20168313574947244, 0.05514705276108278, -0.20191892540637427,
        0.1547882366228554, 0.09728217677978539, -0.24575978575179538,
        0.07927950321453894, 0.15067301537378772, -0.19894056813690786,
        0.05755055741452244, 0.1733317044476722, -0.22091646165603426,
        -0.019675772392883865, 0.21661846733795706, -0.15038443976361843,
        -0.04950533954880424, 0.2114258682827987, -0.15300257762586056,
        -0.11654348929207119, 0.238445682521826, -0.06643063807244773,
        -0.14432240279773373, 0.20290815081414915, -0.056380547589336444,
        -0.19026340954533055, 0.2121196505194037, 0.03513371903066888,
        -0.20749237793690645, 0.1490386648295256, 0.0486502283665359,
        -0.22461348376585902, 0.1436999235635008, 0.1326741690085678,
        -0.22633409215134204, 0.060747049716987134, 0.14013799286303683,
        -0.21166003716351917, 0.04804277051776442, 0.20528590460891305,
        -0.19754905037784692, -0.0436606408752, 0.19910795362037043,
        -0.1534579035910817, -0.05435173946481254, 0.23722088956807702,
        -0.12789412856198482, -0.14235715960260334, 0.2135585580443694,
        -0.061640468892898204, -0.14168110040664955, 0.22122939623657484,
        -0.0327301007634261, -0.2145973352101707, 0.18098086859709808,
        0.045014621327725365, -0.19545261178148982, 0.16010948406101888,
        0.06724649737450168, -0.24509714540746164, 0.10774008256460006,
        0.12694846130233262, -0.10690667004023985, -0.09340528996701723,
        0.1896926045941105, -0.08072209582323417, -0.03830924528056667,
        -0.06179195208849787,
      ],
      [
        0.012125504642788217, -0.07956380533188574, 0.172034350784749,
        -0.12003311415080303, 0.005693823039685776, 0.000259065858452711,
        0.0016732350322216536, 0.0048600868535610565, 0.00338942236070113,
        -0.0012780553633972855, -0.004687392152604898, -0.0035768697641520896,
        0.001053987514858958, 0.004867143271713758, 0.0042408732873840185,
        -0.00033089764366430515, -0.004674029166785602, -0.004805077133371478,
        -0.0006306049661763944, 0.003973778272264354, 0.004776128515593262,
        0.001120820690044386, -0.0034857928364887907, -0.004676074864919556,
        -0.0013183992070020176, 0.0034204022512500957, 0.0050411981422929285,
        0.0019349319360084747, -0.0030876900451047113, -0.005395350128939823,
        -0.002844218813525131, 0.0022232459172664854, 0.005154425666900437,
        0.00330869165951732, -0.0015041331687420845, -0.004738306205019279,
        -0.003371675075145102, 0.001271600366312845, 0.004771194539465859,
        0.003762351784903479, -0.0008945649287289488, -0.004894302264074484,
        -0.004494712932247057, -1.3270608505472695e-5, 0.004453590070338681,
        0.0048307083757398, 0.0008423926203692947, -0.0037518408095845706,
        -0.004677960393176715, -0.0011340138221695465, 0.0034788412250011413,
        0.004758455086627277, 0.0014393531123561341, -0.003405511313158989,
        -0.005226825276737099, -0.002254280459260926, 0.0028305381669718813,
        0.0053715212392725555, 0.003059835653862127, -0.0019282030792834408,
        -0.004968421139449985, -0.003297354499763887, 0.0014286177359101367,
        0.004707259678623552, 0.0034200342205988115, -0.0012395958149375662,
        -0.004878214390244285, -0.004017084821966893, 0.0006363610024424692,
        0.00482168432059535, 0.004679785449150027, 0.00034263448684174885,
        -0.004189812440631123, -0.004770616503890454, -0.0009540690799109052,
        0.0036155349615431616, 0.0046298191902995126, 0.0011512706161388754,
        -0.0035140292043144145, -0.00492008456891037, -0.001658141282798059,
        0.0033006075149761365, 0.005358328873204087, 0.002574807376328628,
        -0.002515439791402589, -0.005251555745982142, -0.003172486548530748,
        0.001711515166628988, 0.0048156302698291915, 0.003268698205069415,
        -0.001413446357760916, -0.004763726059843208, -0.003562182217445124,
        0.0011312136786647924, 0.0049487679636068755, 0.004289424372253249,
        -0.0003082324388210683, -0.004647025068192508, -0.004763285215431639,
        -0.0006032342545388523, 0.003942349967046577, 0.004673137641591633,
        0.0009889913769400033, -0.0035729720880501707, -0.004668891420032379,
        -0.0012283409689716291, 0.00353273137187173, 0.00511600198293977,
        0.0019562584858281657, -0.0030923535890764854, -0.005394201856413693,
        -0.0028386309269397576, 0.0022000936349375775, 0.0050764674762540235,
        0.0031948534362930946, -0.001592314072537846, -0.004741437559257553,
        -0.0032814557277662222, 0.0014031022910946708, 0.004871028689936531,
        0.003790657303357408, -0.0009224858801789946, -0.004934121368050317,
        -0.004519652629572, -3.6155446761978495e-5, 0.00440256107730695,
        0.004746801497315274, 0.0006634477382121509, -0.00595580655714751,
        -0.0007074212034241731, 0.006057671134179892, -0.0066479540883185645,
        -0.002515046343394119, 0.0031259591333720957,
      ],
    ];
    const result = wavedec(data, "rbior2.6");

    const reconstruction = waverec(result, "rbior2.6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5028551208062615, 0.9282207432061269, 1.2144163836457131,
      1.3277209143612523, 1.2680889621250904, 1.0672088683151728,
      0.7795168015987335, 0.4684599848204362, 0.1914108020851173,
      -0.013095630516239243, -0.1327573174000996, -0.18186246983657756,
      -0.19470737748677164, -0.21390872697844626, -0.27671223716664367,
      -0.40288910707075304, -0.5874026611163522, -0.79982161630915,
      -0.9907523822628806, -1.103782823024435, -1.0900153520116016,
      -0.9215700240253724, -0.6006340840803431, -0.16167913244099966,
      0.33389262520016794, 0.8095761240766736, 1.1893870704116973,
      1.413664376839863, 1.4513688190668588, 1.3060209002625478,
      1.0139371222277238, 0.6352613265449407, 0.23999870955321934,
      -0.1075718292947902, -0.3623890683644709, -0.5068503177820942,
      -0.5519751664103314, -0.5314282420647508, -0.49009990151413707,
      -0.4702728041457252, -0.4989715072780894, -0.5797633371875139,
      -0.6911353594374516, -0.7918988333834883, -0.8322844549039655,
      -0.7679327749260102, -0.5732172789617801, -0.25045512468904996,
      0.16746315793124578, 0.6218961654740115, 1.0397700098440557,
      1.3488278039441297, 1.49325217457945, 1.4459707258779901,
      1.2147189205894162, 0.840411571502117, 0.3882040901094176,
      -0.06663775337201072, -0.45471851671277275, -0.7265928898336607,
      -0.8616927262138954, -0.8701335441208862, -0.7871846700078257,
      -0.6619761493472323, -0.5434027773454799, -0.4668321628663636,
      -0.4449736753428721, -0.4651835895288293, -0.49383872611901886,
      -0.4866145540539198, -0.40199977900152284, -0.21454128315702625,
      0.07565006735704022, 0.4396976977504548, 0.8240755449468251,
      1.1612398356858211, 1.3843403174044204, 1.4425275088054952,
      1.3131721822561648, 1.0080129423782553, 0.5716796050708981,
      0.07285639744064192, -0.4098926356923921, -0.8043418888153928,
      -1.0590966495942737, -1.1530263031117878, -1.097544205808005,
      -0.9313784975554183, -0.709289537540466, -0.48763126796529715,
      -0.3103745072049936, -0.19903665932114623, -0.14894146547091802,
      -0.1326194213149623, -0.10935485570533696, -0.0383364921289856,
      0.10804189894554272, 0.3342299361432599, 0.6175868124304347,
      0.9116317349607916, 1.1558422033787064, 1.2897058128035226,
      1.267629336154569, 1.0710377114915068, 0.7146261253289684,
      0.2451098645006205, -0.26738667277252337, -0.7433868005221554,
      -1.1103321630481178, -1.3172968894192048, -1.3447475119634826,
      -1.207143210364798, -0.9478918152425911, -0.6280061336960401,
      -0.31129641335706154, -0.049725583947902274, 0.12754583488781723,
      0.21885987682415245, 0.24752428183915665, 0.25286909097466737,
      0.2773209216789478, 0.35290117797413306, 0.49068305558283565,
      0.6759866975489983, 0.8706399399467873, 1.0218435793729572,
      1.075498277534678, 0.9906926166272215, 0.7517072707368948,
      0.3744476132876592, -0.09445693274379627, -0.5858767706247002,
      -1.0219350953276882, -1.3321367699792932, -1.468120030276615,
      -1.413585751505279, -1.1871010415648946, -0.8371724767009974,
      -0.43082555979022924, -0.03846247480040249, 0.2813732527484528,
      0.49372545958937847, 0.5927512440828389, 0.5999010993935806,
      0.5554293607433003, 0.505547827646011, 0.4885877773235056,
      0.5237461318267722, 0.6053108544393894, 0.7038592515064237,
      0.7741490675612003, 0.76771631599408, 0.6469793099999502,
      0.3972279319267409, 0.03335767800100914, -0.4005259137191717,
      -0.8387646204423431, -1.207408017464921, -1.4400196250767505,
      -1.49230984442149, -1.3521178762520722, -1.0423524323625983,
      -0.6161717635869638, -0.1455308664653885, 0.2942021827123428,
      0.6399409679428143, 0.8532273621167014, 0.9264170121949433,
      0.8814127151272081, 0.7614780098625509, 0.618340223643846,
      0.49791221535962293, 0.42825249750432287, 0.4127763445527263,
      0.43037913398866695, 0.4423739663163001, 0.4044152403698747,
      0.28030756761628495, 0.054101228763827724, -0.26272378887721815,
      -0.6309803879888767, -0.9906894888919957, -1.2736786959146391,
      -1.418918157509574, -1.3869236187085288, -1.1697281636669685,
      -0.7939527025965238, -0.31614229569585844, 0.18861732018974411,
      0.6421814415728031, 0.979329615458002, 1.1605479438617914,
      1.1786965899817092, 1.0581374005115143, 0.8467206513082037,
      0.6027429677020324, 0.3801723340237574, 0.21580344405565782,
      0.12147127467891211, 0.08314856933348405, 0.06700813431536964,
      0.03077608022119721, -0.06262825652957249, -0.23274686769804748,
      -0.47379379115439046, -0.7535464769442003, -1.0193681038915992,
      -1.2100137854987252, -1.270398012333599, -1.165713371234951,
      -0.8913892680305849, -0.4763440701355476, 0.021418295906541075,
      0.5259748583937922, 0.9588854278885212, 1.2552727126979617,
      1.3768527786716118, 1.318917609546024, 1.1097238679638002,
      0.802562338769195, 0.462526718056391, 0.15124350108852952,
      -0.08673465146581028, -0.23263558756715413, -0.2952917883201596,
      -0.3058295345724671, -0.306749169288158, -0.3383103415553482,
      -0.42579152385019, -0.5709554574539075, -0.7499815142879227,
      -0.9184880435316433, -1.022468623368898, -1.0124519872835456,
      -0.8573426954021148, -0.5544222196228733, -0.13288637663672265,
      0.35015200480454617, 0.8204358832257096, 1.2016935249157545,
      1.4316250215395419, 1.4750100022025725, 1.3308693770076738,
      1.032025681732207, 0.6372178881316808, 0.21769616751868054,
      -0.15848070768079137, -0.440712553030831, -0.6053553564057821,
      -0.6583211098990329, -0.6303664284836273, -0.5664569710570913,
      -0.5120381204207922, -0.499774855765388, -0.5401671734428974,
    ]);
    const expected = [
      [
        2.2365255730648714, 2.3510303620126285, 2.587749683782854,
        2.2115555576836416, 2.608240857889485, 2.1452251313985022,
        2.7535935716370434, 2.090071828370977, 1.4072679382846456,
        -1.4306118889612225, 0.032022235475480665, 1.4334298542781183,
        -1.5216774126216632, 0.10604466218298281, 1.472523134754179,
        -1.6748763470902772, 0.25157046063468147, 1.4803539009213478,
        -1.8622268371392932, 0.47669070975954125, 1.4180657831330734,
        -2.0412168193983256, 0.7653076938892528, 1.2636022600952554,
        -2.1668710854675353, 1.0812957569376753, 1.0183899750843024,
        -2.2045684204699145, 1.3784127114077918, 0.7073263700792465,
        -2.1399401731222882, 1.6131284318178052, 0.3720715124142319,
        -1.9830166952048507, 1.7567019602185234, 0.05956059208099618,
        -1.76543433690375, 1.8030533505564486, -0.1909784256793503,
        -1.5596593267818257, -1.6346084001639343, -1.5383956939854997,
        -1.5722089663490677, -1.568303436707993, -1.6148333913755046,
        -1.3974588722087984,
      ],
      [
        1.387685723717866, -0.032824600643800265, 0.7607303855265443,
        -0.2838827031022644, 0.07684242976034672, -0.6673323547067244,
        -0.34052213882416155, -1.0803525266995797, 0.14599835181892148,
        1.25671748558529, -1.8177151464169543, 1.0322301832044314,
        0.49123299098026985, -1.5675493790242818, 1.4131766651952133,
        -0.2308051529168955, -1.022243806175951, 1.4258300836130435,
        -0.7803500824623454, -0.3328357818189825, 1.080601052855277,
        -1.0110263906048345, 0.30082989288435946, 0.48988625058981305,
        -0.8686252878039112, 0.6962635929521171, -0.1642331071206196,
        -0.40651356751993456, 0.740582515601524, -0.6822360128254841,
        0.22976040880466284, 0.4228228526824124, -0.904392347149991,
        0.8442557612704149, -0.16293753482669782, -0.7564746301591133,
        1.260254394654022, -0.9733614728898027, 0.3123431721365123,
        -0.07938111609820608, 0.002332205057746814, 0.04865755416331349,
        -0.07542158340848551, 0.16848061744161777, -0.6053271547438669,
        1.41878671038284,
      ],
      [
        -0.4417980287651885, 0.8192778188351642, -0.6457336615563902,
        0.5352957388485663, -0.42435975866465964, 0.2516968522522367,
        -0.30276375492573326, -0.015941373920247626, 0.1506508740636169,
        -0.09725487029702201, -0.05250544073152208, 0.14587982896443263,
        -0.06661466737733836, -0.09465566095473281, 0.13813163444720314,
        -0.02437785546046446, -0.11263470638216012, 0.12688409432661985,
        0.008751465572859819, -0.1395538015703895, 0.10059968138247083,
        0.05276758094577616, -0.13930935643900078, 0.07197355723249438,
        0.08079887352793859, -0.14570089250012325, 0.03391659845940627,
        0.11566389996248543, -0.12491858074611296, -0.0032456248062477156,
        0.12881782036950323, -0.11130629731322711, -0.04271349362803565,
        0.14638624221262606, -0.07361839561166804, -0.07735624283315827,
        0.1389855433102416, -0.04617449298527523, -0.10723673017697365,
        0.13621156378354063, -0.0001415586908945568, -0.12926009876761477,
        0.10832402114917475, 0.031101285639945943, -0.14106397528336323,
        0.08811512913767287, 0.07442043334644152, -0.14421672865780116,
        0.04555311944177975, 0.09846127512460826, -0.13439345214721554,
        0.01591819906003436, 0.12865576680268517, -0.11806208302606735,
        -0.03140512426242935, 0.1366936887560421, -0.08901780380895967,
        -0.05966908841475456, 0.14696252002992438, -0.058399486791992854,
        -0.10055662823234487, 0.1349338407945582, -0.01781199293275949,
        -0.11697682947306196, 0.12401575018638018, 0.017578048947261476,
        -0.1429121113136137, 0.10315014924102887, 0.01869876201940152,
        -0.04424411389544523, -0.03713950191465323, -0.05459550514941281,
        0.0942626232965142, 0.05383588975968747, -0.1294807225344228,
        0.14690764583197702,
      ],
      [
        -0.003835938557483987, 0.02180726577285869, -0.06106151933202054,
        0.14109200977645214, -0.1274708343376531, 0.029831844883545032,
        -0.001677137093222557, -0.00040649437297321945, 0.0009983350259018756,
        0.0007152132681552937, -0.00023018592617620446, -0.0009599638802359257,
        -0.0007960920812631136, 0.00011260485308745182, 0.0009271299380585721,
        0.0008927036794724754, 3.617511882231196e-5, -0.0008573977003935402,
        -0.0009677597425641626, -0.00019523191173419067, 0.0007478975501860692,
        0.0009945398609580585, 0.00032210342121744093, -0.0006434713214184605,
        -0.001006853763865165, -0.00043076215662577063, 0.0005522382342181918,
        0.001031472666514134, 0.0005595529750125484, -0.0004333301261290178,
        -0.0010349447917703172, -0.0006917634335242745, 0.0002806697935838091,
        0.0009886220517575034, 0.0007839481944642191, -0.00013919341610756867,
        -0.0009249782148484892, -0.0008468001742612376, 2.1772935538640244e-5,
        0.0008752846729511803, 0.0009207892322397884, 0.00011108850672325945,
        -0.0008102740886143658, -0.0009941827577594098, -0.0002692441578168408,
        0.0006995784703511289, 0.0010235171811767431, 0.0004087430767074048,
        -0.0005738831004258361, -0.0010166068580256095, -0.0005127702712463516,
        0.0004684263194231302, 0.0010161000242436167, 0.000619790492573307,
        -0.00035806492420802896, -0.0010157005084234444, -0.000744047880595842,
        0.00021057959693101592, 0.0009725905120290424, 0.0008436779164006437,
        -5.409690656704865e-5, -0.0008918041841554309, -0.0008987482560750219,
        -7.305507417742661e-5, 0.0008178499091929794, 0.0009469690165142765,
        0.00019226855690762263, -0.00074990711742592, -0.001007428661744577,
        -0.00033796550838355234, 0.0006460857106802332, 0.00104126289553899,
        0.000485519678885594, -0.000508385538324755, -0.0010260642827689644,
        -0.0005945685905742685, 0.0003824663526239844, 0.0009988201446233089,
        0.0006832625542403522, -0.00027261001130349813, -0.0009835835424755203,
        -0.0007886082189253646, 0.0001377840985391732, 0.0009450576863809972,
        0.0008903888897132169, 2.3590623476100727e-5, -0.0008586818775565708,
        -0.0009472307925944127, -0.0001657108275094324, 0.0007603975246582376,
        0.0009744802486678496, 0.0002798652823042312, -0.000678923283519139,
        -0.0010119372327756322, -0.0004065190082665163, 0.0005826859591937108,
        0.0010444680130254163, 0.0005515101115444809, -0.0004449372428056284,
        -0.0010304829932325876, -0.000670021639156942, 0.0002998920515520833,
        0.0009827137333494372, 0.0007496983593856528, -0.00018024099221916764,
        -0.0009436290804605873, -0.000830753951857534, 5.792674786991506e-5,
        0.0009034703998496054, 0.0009238950882639519, 9.630189801335641e-5,
        -0.0008208746467682504, -0.0009863307198545704, -0.00025088865707227105,
        0.0007058025845329501, 0.0010027502880467604, 0.0003701303544389476,
        -0.0006028657125927729, -0.001013257341005548, -0.0004789949140610296,
        0.0005075451164504047, 0.0010337710798866747, 0.0006096686613433498,
        -0.00037877303283107575, -0.0010242870027887309, -0.0007342528122949855,
        0.00022325050972730854, 0.0009669604119099343, 0.0002783524441109524,
        0.00391488083333859, -0.01309434385664951, 0.026606841913025932,
        -0.02261140472994012, 0.0037560970133382427, 0.0004934838055660302,
        0.000897718012944928,
      ],
    ];
    const result = wavedec(data, "rbior2.8");

    const reconstruction = waverec(result, "rbior2.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio2.8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.502251749375918, 0.9255294638037945, 1.2075077067827689,
      1.3151847424897165, 1.2505969161932824, 1.0483100851578984,
      0.7654568318010416, 0.4669160627256187, 0.20939915788210772,
      0.028423688313851392, -0.06862877087511843, -0.101758438750644,
      -0.11026564830348196, -0.13958659061859047, -0.2265873397635224,
      -0.3872452699617168, -0.6100296982091745, -0.8568274188496352,
      -1.0713153136498939, -1.192754128087681, -1.1717542629012185,
      -0.984008649672562, -0.6384435595677826, -0.17759452930450143,
      0.3300669195421073, 0.8041301767574848, 1.1692612223598209,
      1.3711707291575843, 1.3877164035467768, 1.2325177861350927,
      0.9503068761685395, 0.605269638160497, 0.26534312155977685,
      -0.013606445970890613, -0.19982574919922116, -0.29104093436117434,
      -0.3119763268511354, -0.3048596015646423, -0.31552970047412415,
      -0.37887111542169155, -0.5074517618807981, -0.6864039518988303,
      -0.8759721443746267, -1.0211673626391635, -1.0661199436932298,
      -0.9694793568964761, -0.7168894930554559, -0.32725467620870796,
      0.14896399030906224, 0.6392018916954382, 1.0638344373124535,
      1.3532412051854603, 1.4627952575328083, 1.3821745926793632,
      1.1367812651863414, 0.7809913614641841, 0.3849609122945232,
      0.01827829350568444, -0.26550784163592556, -0.439726820744336,
      -0.5082404769688411, -0.5012026316857578, -0.4642157770330511,
      -0.44383976577377304, -0.47330996736831144, -0.5622387266429416,
      -0.6930272499993972, -0.8249719853498979, -0.9050530233279661,
      -0.8826491574493357, -0.7243783027515934, -0.42518045624684725,
      -0.012667248067821213, 0.4565684436055695, 0.9079762341162064,
      1.2648484447341892, 1.465118890590336, 1.4750995562994862,
      1.2968232998926534, 0.9672204154843393, 0.549357871777203,
      0.11791190300662197, -0.25755806056247044, -0.527461719792852,
      -0.6715963013461062, -0.7009678381019441, -0.6517799735479122,
      -0.5733267726206632, -0.5130450527456925, -0.5026662947083452,
      -0.549087863196773, -0.6323417524782264, -0.7111928502468728,
      -0.7349170343914506, -0.6581957701342401, -0.4552288041817683,
      -0.1293239240882164, 0.28466438451388676, 0.7258858304089908,
      1.119856854802031, 1.39472231825801, 1.4974894169035509,
      1.4062705002694393, 1.1355252154226347, 0.7329994946160128,
      0.26909299698296074, -0.1787609619723879, -0.5429112745158952,
      -0.7794470467701097, -0.8759912339681122, -0.8515894552951297,
      -0.7489429618142227, -0.6211462908117023, -0.5164432718643837,
      -0.4649708874815383, -0.4709071262364999, -0.5120194511338172,
      -0.546686552706833, -0.5265266004108142, -0.41130289764765443,
      -0.182164619124573, 0.15032659278685184, 0.5456312371492846,
      0.9404909933147385, 1.2623849297597383, 1.4459614439370743,
      1.4484306282727895, 1.2601112936849328, 0.9074905970775674,
      0.44798273868252536, -0.042390340344956784, -0.48543838901879693,
      -0.8174050486690272, -1.0017606866528517, -1.0351855759000979,
      -0.9454558711698139, -0.7819670115659456, -0.6014523966005716,
      -0.45262212792889106, -0.36366617128769324, -0.3357867327962638,
      -0.3443463841996947, -0.34724331513439644, -0.29825467146892015,
      -0.16179802885244465, 0.0748223338341138, 0.3949951504057749,
      0.7540463157824604, 1.0880351306338127, 1.3280540774369682,
      1.4165521430485501, 1.3216389024394888, 1.0457778579048227,
      0.6266330882305672, 0.12975544806169856, -0.3651973108769581,
      -0.7814208595714437, -1.0610434553342345, -1.1764955200250224,
      -1.134523973209969, -0.9720402114538139, -0.745015887280701,
      -0.513348416014975, -0.32558103201897615, -0.20734115401421443,
      -0.1563650583140549, -0.14526138195719707, -0.13116695362758676,
      -0.06967303970878602, 0.07070160553083576, 0.29736307046334304,
      0.5888494486698195, 0.8978009647920215, 1.1611112758534365,
      1.3148234694861665, 1.310085341876187, 1.1261537696667814,
      0.7771231996295669, 0.31057976810203775, -0.20163063206310816,
      -0.6783823578478982, -1.0464364049989157, -1.2556908530103212,
      -1.2888910308804968, -1.1635515472152116, -0.9257717220959853,
      -0.6376242679895492, -0.3613637001866172, -0.14444468946254668,
      -0.009077902244323144, 0.05114798684250782, 0.06687853574900177,
      0.08213550616085485, 0.13993961038720276, 0.2682621924330404,
      0.4700658550792078, 0.7201432137625277, 0.9697156833075011,
      1.1577531918081196, 1.2262283994563892, 1.1354694296500811,
      0.8756917941857101, 0.4716981160687097, -0.02059164712528523,
      -0.5250951707346638, -0.9614614740023747, -1.262121925466438,
      -1.3864198360912934, -1.328455723247833, -1.1168351588632552,
      -0.8065016906657987, -0.46477877165915576, -0.15514627432733408,
      0.0772103113738769, 0.21454167400182206, 0.26821699396502563,
      0.27271365144280424, 0.27364426218974436, 0.3130633006188362,
      0.41597534375820894, 0.5816432610782201, 0.782050498662986,
      0.9680229013948134, 1.0815313562538467, 1.0710806883177861,
      0.9062539333446582, 0.5876391305508543, 0.1494820503081877,
      -0.34579530553461524, -0.8200442697959308, -1.1958938510884405,
      -1.4133683517207922, -1.442627061377494, -1.2897776006553467,
      -0.9944144882312568, -0.6195663818380959, -0.2365907467146709,
      0.09123021453453978, 0.3223659412920046, 0.4446946259032063,
      0.4754033234789662, 0.4533720151425914, 0.4261857783540259,
      0.43526663324515097, 0.5030691033374455, 0.6257284772228631,
      0.7731304699423185, 0.8964465790364435, 0.9412396320655452,
      0.8627817206798178, 0.63961446870182, 0.2817774381695939,
      -0.16856211101128943, -0.6444529588735781,
    ]);
    const expected = [
      [
        2.2240233517496897, 2.329511347623574, 2.5581200406947664,
        2.1949161324176325, 2.5800511304155065, 2.129262211824392,
        2.7198704919887904, 2.0747985099074984, 1.4549846916393325,
        -1.4177528079339756, -0.08470260518399586, 1.5251445023692862,
        -1.4205576837851697, -0.15366193842585707, 1.6162192390782668,
        -1.464551701256924, -0.19346507752420405, 1.713069818021439,
        -1.5447600479706682, -0.19501491599633403, 1.7996718118444548,
        -1.6508167806532013, -0.15487690313622382, 1.8614872202766695,
        -1.7684987613682395, -0.07578774522561854, 1.8876162585306293,
        -1.8818304491906863, 0.03374921817389126, 1.8724107061300128,
        -1.9754480454481886, 0.16072207998627852, 1.8163100460842196,
        -2.036873107222302, 0.2895356841056866, 1.725776648672476,
        -2.0583591421852203, 0.40431925616386594, 1.6310513109870841,
        0.6140287903930304, 2.0443851077844215, 0.49524524275462656,
        1.3079302093468401, 1.085274076920742, 1.6493513872564183,
        0.8095617038363028,
      ],
      [
        1.3491350577381624, -0.019475793209671265, 0.7450902549739851,
        -0.27353443019661877, 0.06903094861977402, -0.6529987309150235,
        -0.3559906718515047, -1.0288153391943382, 0.024387530322284447,
        1.3688319274173257, -1.7507255447036727, 0.7207415371081739,
        0.868257608442569, -1.6840529390375085, 1.0835189397413272,
        0.3710221777837086, -1.4435262306985597, 1.2880539844254606,
        -0.11673615365471092, -1.056279041261688, 1.3049217030256093,
        -0.5232807990034645, -0.5800152703070796, 1.1324708744637892,
        -0.7889024870635912, -0.08560457304605222, 0.797068294377008,
        -0.8747559711302106, 0.35340615178128454, 0.34919647513026353,
        -0.7686089332656861, 0.6716774957519063, -0.14401769688206417,
        -0.48665226605265094, 0.8216676482414432, -0.6193032763485061,
        0.02714289547638543, 0.355059695410478, 0.3458735940015757,
        -0.8508791152401423, 0.019967025628925508, -1.3072959385995313,
        1.9479814280460326, -0.8066243518965357, 1.295776651396466,
        -0.7599183135209852,
      ],
      [
        -0.44875850020511165, 0.8215574042887042, -0.6465597689738649,
        0.5286966209380892, -0.4146755132978747, 0.24992723235337097,
        -0.307488349172864, -0.012098334728411144, 0.15751634026725897,
        -0.11452206850402447, -0.0402026637339531, 0.15424867531583278,
        -0.09278373701417635, -0.0758815817238273, 0.15246792285286884,
        -0.0629215665078094, -0.09280552921090746, 0.15273497465393024,
        -0.03891318092852942, -0.12218285727761402, 0.13963334420754991,
        -0.005171646201566342, -0.13107943512155276, 0.12890303374329734,
        0.02040741588977684, -0.15099547966613572, 0.10585041636585288,
        0.053655464021571043, -0.1493601422282712, 0.08627406479725533,
        0.0763931627207692, -0.15805507662308993, 0.056124746252355584,
        0.10485918277925774, -0.14494240970018207, 0.031151140328764863,
        0.12075275434656758, -0.1423165744913961, -0.0021785538533099142,
        0.14086712472390595, -0.1184803613826655, -0.028313639080199668,
        0.14691555628589983, -0.10610886554956128, -0.06042487822956527,
        0.1563557867236785, -0.07389067768823059, -0.0833256267730133,
        0.15100403669758947, -0.05479014004189722, -0.10998802027498489,
        0.1490384072478548, -0.017772940374615975, -0.1257492066083505,
        0.13240762838972642, 0.004045107418216212, -0.14352682203371983,
        0.12000339848876791, 0.041567082819147685, -0.1493118353060233,
        0.09387309133923442, 0.0616900367587204, -0.15607164096383458,
        0.07355326443519544, 0.09534666317820066, -0.15075847529209477,
        0.033901373461746986, 0.17601294841713036, -0.40693166107452,
        0.7185678333162031, -0.5364818032953741, 0.385059804072817,
        -0.30155902253017985, 0.21310977610316642, -0.2591628519152825,
        -0.029991429134415055,
      ],
      [
        -0.0037978850695287317, 0.021726898102200735, -0.06128213085898367,
        0.1413825261446465, -0.12746273144333398, 0.029646414720208018,
        -0.001689935414916083, -0.00032038374912632655, 0.0011105211468771764,
        0.0007268527772758978, -0.0003459070621093922, -0.001089332791431663,
        -0.000796797221555714, 0.0002578410777377116, 0.001078270969011225,
        0.0008869100163334423, -0.0001398604580865186, -0.001037134774088729,
        -0.000961630943164322, 1.286398231114508e-5, 0.0009658591754699111,
        0.0009996870474443282, 8.679437410876508e-5, -0.0009054131507834715,
        -0.001035324177073201, -0.00017778022085731014, 0.0008570374170110097,
        0.0010889756323859568, 0.00029451687804399166, -0.000780886564962591,
        -0.0011256532214273527, -0.00041651045287398217, 0.0006767732977384876,
        0.001124054336412426, 0.0005072360693297814, -0.0005859651234573927,
        -0.0011185630076103953, -0.0005850484776038333, 0.0005104368281118016,
        0.0011303818458634832, 0.0006847098060186005, -0.0004106084239004508,
        -0.0011251492538880453, -0.0007862816303358074, 0.0002860643580438983,
        0.001081571772836154, 0.0008532168878334443, -0.00017824953190143794,
        -0.001034189077092929, -0.0009036961255731939, 8.974766799926012e-5,
        0.0010049775911636061, 0.0009729483746951953, 1.8883476971969654e-5,
        -0.0009601990737552705, -0.0010417178375272268, -0.0001484267546942552,
        0.0008785497488232276, 0.0010735555706417538, 0.0002574093139768156,
        -0.0007946841171367972, -0.001086571395602213, -0.0003427869262900224,
        0.0007312991157418143, 0.0011165516032126117, 0.00044400972744422355,
        -0.0006552199274197703, -0.001145008289293841, -0.0005623793609451945,
        0.000545058000808153, 0.001135665382253753, 0.0006565514042993601,
        -0.00043548897455311067, -0.001106616614400704, -0.000723170913509812,
        0.0003498266823733342, 0.0010942441215950585, 0.0008018372143131458,
        -0.0002553526056966502, -0.0010808589943649507, -0.0008945122311689454,
        0.00013047538954789862, 0.0010303768321184938, 0.0009601208860348797,
        -9.758489049063084e-6, -0.0009608726458590266, -0.000995126539064275,
        -8.300636698290137e-5, 0.0009093048548094718, 0.0010393930067789554,
        0.00018021923793257958, -0.0008587562141581261, -0.0010956529983209352,
        -0.0003038180036824943, 0.0007732947247457618, 0.0011232061233673965,
        0.0004195052388700842, -0.0006709168319976601, -0.0011184232461403545,
        -0.0005031655480905025, 0.0005890817560439514, 0.001121504169206948,
        0.0005870280642273303, -0.0005115625298029646, -0.0011360155005943993,
        -0.0006935249199217185, 0.00040248869979108413, 0.0011216864626372395,
        0.000788776940577086, -0.00027966961997893936, -0.0010748316568738412,
        -0.0008484921138732456, 0.0001809444068553612, 0.0010360032360154595,
        0.0009048634218381459, -9.065329463142652e-5, -0.0010096080326960127,
        -0.0009809466977850022, -2.714094601720591e-5, 0.000955802003960273,
        0.0010434096991917185, 0.0001549575169227733, -0.00087082145510377,
        -0.0010679023315594862, -0.0002547265145074148, 0.0007955289565073369,
        0.0010866828867150875, -0.00029787395470489114, -0.0015474984414955736,
        0.02471342289868287, -0.10787264009884309, 0.12062824335561086,
        -0.05242321202622041, 0.01822927130579948, -0.0033124119643821322,
        0.0008186670673842294,
      ],
    ];
    const result = wavedec(data, "rbior2.8");

    const reconstruction = waverec(result, "rbior2.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.1", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48767963293851446, 0.9000180363466008, 1.1776095110841402,
      1.289123031041938, 1.236783870178484, 1.0539747180009083,
      0.795667381231838, 0.5241461071118825, 0.2936155435095937,
      0.13752084266316972, 0.0616886578743317, 0.04490751414934267,
      0.04667804491381736, 0.020050428859746117, -0.0738185328450735,
      -0.25319165901775964, -0.5086409007551178, -0.8032292156458867,
      -1.0800726821896425, -1.2754994358779765, -1.3345889002900813,
      -1.2252393328478162, -0.9472348486415338, -0.5339869840368882,
      -0.04641311787906688, 0.43965832273753, 0.8495763524088548,
      1.125613171553316, 1.2386191610527417, 1.1928506979861189,
      1.0229174876979243, 0.7837324941207511, 0.5360563684879209,
      0.3312858633474379, 0.1992810149435842, 0.14222532578402874,
      0.13596892507277503, 0.13840403968491688, 0.10264088753158063,
      -0.00846407239718433, -0.21022245805736456, -0.4896562786824567,
      -0.806439747906024, -1.1011467727572173, -1.3088596924899167,
      -1.3748219458004876, -1.2682665262623587, -0.990963147252481,
      -0.5783002244851696, -0.09253847592470316, 0.3902101160390469,
      0.7961866258162569, 1.0695047088099274, 1.1832939360181887,
      1.1438612496577156, 0.9869893269422463, 0.7674251243475354,
      0.5442758624217919, 0.3660105918315387, 0.2588212310126805,
      0.22121630665599823, 0.22612567798484107, 0.22988528621667242,
      0.1857254976791937, 0.058241749358072636, -0.16493137384898193,
      -0.4673268296611582, -0.8053428177535357, -1.1171562902513763,
      -1.3367511252926807, -1.4096500569966661, -1.3064744210587573,
      -1.0309538306056285, -0.6203475924700232, -0.13808984517282052,
      0.33962747732434234, 0.7401374603010928, 1.0095555625817425,
      1.1233848343792758, 1.0899998122005838, 0.9463020052466601,
      0.7467682832368331, 0.5487290200680952, 0.3976148753341784,
      0.3158771413022156, 0.29832767412032984, 0.3150021796606951,
      0.3207368689319295, 0.2689425047148142, 0.12598876491410238,
      -0.11755590841826924, -0.4418054574989963, -0.8000040134734188,
      -1.1280845081859618, -1.3590848540628997, -1.4389246210139173,
      -1.3396668555289248, -1.0669736257061553, -0.6598671566526229,
      -0.18278405068061976, 0.288206740837266, 0.6817277704559157,
      0.9460529025312309, 1.0591490818072475, 1.0314728501756343,
      0.9009903184070441, 0.7218074325949311, 0.5493609696924671,
      0.42594189536217086, 0.37019909506185883, 0.373236357529327,
      0.40222944261914173, 0.4105758811865872, 0.3519272859738402,
      0.19445890438697522, -0.06834644207122348, -0.4132625432302693,
      -0.7905102238936452, -1.1339386229342927, -1.3757969642723848,
      -1.4625211998585237, -1.3676691514618184, -1.0988063044202363,
      -0.6966082117196903, -0.22634247928186285, 0.2362465632153738,
      0.6212652734071865, 0.8792982429554367, 0.9908624752501696,
      0.9685081221475207, 0.8512115693567451, 0.6926103820771414,
      0.5461378745317446, 0.45085363688358443, 0.4215532930607772,
      0.44563159942885067, 0.4874467413216553, 0.4990231583386635,
      0.4343140354720292, 0.263327715801186, -0.017564974433147695,
      -0.38188501822114185, -0.7769690854911485, -1.1347495891303243,
      -1.3868487214652787, -1.4803400962436846, -1.3903289909876984,
      -1.1262538218444569, -0.7303326217058029, -0.26849256434202873,
      0.1840463686092063, 0.5590649434895937, 0.8096059941278974,
      0.9188181220912292, 0.901353696713983, 0.7971449396717968,
      0.6592670749744498, 0.5390471632258549, 0.4722315591748866,
      0.46972285781184214, 0.5152163497880617, 0.5703032277270011,
      0.5857049951838598, 0.5157374593785925, 0.3322659225277975,
      0.034516196745636885, -0.3478753529071523, -0.7595083275699505,
      -1.1305718416553838, -1.3922266679815454, -1.4923068054386093,
      -1.4075171910132025, -1.149137371047318, -0.7608161042963948,
      -0.3089692400235102, 0.1319047940615188, 0.49544743753112075,
      0.737301957280506, 0.8433251003696283, 0.8302768726275306,
      0.738990754486109, 0.6218892632116951, 0.5280976515606949,
      0.48997716593118207, 0.5145088162642211, 0.5817085904675792,
      0.6504594986530854, 0.6702548396882329, 0.5958344741502294,
      0.40094101035483737, 0.08761585249942527, -0.3114504662939787,
      -0.7382750189737234, -1.1214829058346274, -1.3919426017539307,
      -1.498372351007146, -1.41912837141365, -1.167298348863615,
      -0.7878494496026052, -0.34751635772133227, 0.0801181429081495,
      0.4307374984889921, 0.6627217704829916, 0.7647070463867904,
      0.7555630079822881, 0.6769696440937931, 0.580610072894078,
      0.5133195548006111, 0.5040124718843488, 0.5557309903464056,
      0.644842583751704, 0.7275891076324186, 0.7523149550579232,
      0.6742458992471219, 0.4690188365127041, 0.14144527847190025,
      -0.2728405617448252, -0.7134347202753226, -1.1075828980051377,
      -1.3860334374675758, -1.4985135028625254, -1.4250815136515185,
      -1.1805992278441646, -0.8112396672138329, -0.3838880575164506,
      0.02897885391473287, 0.3652623452691236, 0.5862093129029591,
      0.6833006763627903, 0.6775142638749516, 0.6113216060188119,
      0.5355834622778316, 0.49476439043187015, 0.514280363689507,
      0.5932287912003112, 0.7043700391451272, 0.8013800142164031,
      0.8315380423325439, 0.7506181363667727, 0.5361652528573055,
      0.19570973260601945, -0.2322878949438547, -0.6851705458457119,
      -1.0889939191441926, -1.3745609509315315, -1.4927328766223993,
      -1.425320407008936, -1.1889243299099597, -0.8308110556784098,
      -0.41785008771577575, -0.02122600622295112, 0.2993500566154338,
      0.5081150751178763, 0.5994542491173098, 0.5964482683589998,
    ]);
    const expected = [
      [
        2.79590170205359, 0.8337151771791955, -0.014328593523176126,
        0.012890747853130838, 0.3813583731857657, 1.6841176815404875,
      ],
      [
        1.1102230246251565e-16, -1.6588870493661765, 0.030089870558421102,
        -0.03688934852139981, 0.8457813831361363, -2.7755575615628914e-17,
      ],
      [
        5.551115123125783e-17, -1.880938396446105, 0.6095898845028704,
        0.24139234930607534, -0.6113768689554437, -0.1664226355999591,
        0.6821750769372936, 0.008908907101486896, -0.18199159295752124,
        2.7755575615628914e-17,
      ],
      [
        -1.1102230246251565e-16, -3.020543176480201, 3.393278728141445,
        -2.5918251581390024, 0.08308179805995342, 2.2783286482037655,
        -3.0512006427614926, 1.9802099790367134, 0.23264541965189145,
        -2.385968865173177, 3.1710213264055938, -1.863951576836858,
        -0.8729441198910552, 3.117490182977361, -3.143138539566986,
        0.9467119269037232, 1.74074103279167, 4.9873299934333204e-17,
      ],
      [
        0.0, -0.05498367111687691, -1.9098996218938227, 0.4460938284714754,
        1.8542387346992029, -1.8294548140560558, -0.8274310607245587,
        2.952015616026733, -1.674989027860888, -1.9095052720404035,
        3.727397889556194, -1.4281739344064535, -2.6789353465743235,
        4.052988126413092, -1.0643170755484068, -3.070853912270964,
        3.8621280387458685, -0.5650431361685034, -3.080678333777328,
        3.1625957410558847, 0.06853842297253529, -2.75740133400185,
        2.0381725272831024, 0.8058363172577643, -2.1883656665983504,
        0.6374377237458015, 1.5830391936598098, -1.479176786837205,
        -0.8485073639218146, 2.307415770285033, -0.7331042134770716,
        -2.2156324946515915, 2.8794921326262797, 5.551115123125783e-17,
      ],
      [
        0.0, 1.2856623720516511, -1.1629913725131051, -0.5788453677178866,
        -0.6684717777740573, -1.2649735797271604, 1.4537851599124587,
        2.092738837707391, -0.6813159702762278, -0.7725419428902163,
        -0.43613331767497215, -1.5282110468024874, 0.6235592168688049,
        2.4298457358419414, -0.019598289921719136, -0.903555252714231,
        -0.25876599496432606, -1.5376996314426328, -0.25727885844754456,
        2.4122989793530754, 0.7278310821925682, -0.9055979854515835,
        -0.17224592945587103, -1.3299915967679767, -1.0497803507672852,
        2.0356768948865613, 1.4407668181730822, -0.7332195046068446,
        -0.17923645859650628, -0.976397681216302, -1.636755056833081,
        1.3557103080831745, 1.994510475366554, -0.37569941492140535,
        -0.2501628736392772, -0.5654226307373112, -1.9422952324165057,
        0.47899239891056095, 2.2833439548556216, 0.13609638746571978,
        -0.3321357418189133, -0.18294928215491027, -1.9428970392349936,
        -0.4556260168826029, 2.2414792915312582, 0.7317773898505677,
        -0.36369911762304336, 0.1055853873960998, -1.6683411193269335,
        -1.3014582494134144, 1.8572500920642123, 1.3124147852386885,
        -0.29197666632354735, 0.26733531193340043, -1.1925489349351763,
        -1.9296072930748065, 1.1775554170213653, 1.7685412692879912,
        -0.08823085189163934, 0.3061424715788649, -0.6166018660367479,
        -2.2509750708722054, 0.30143509198761975, 2.001693572213908,
        0.3456397751209346, -0.34563977512093447,
      ],
      [
        0.0, 0.8536987572289234, 0.23734265162144363, -0.36836130484935886,
        -0.5568193654600548, -0.32906683139674076, -0.04991686994127127,
        -0.07021884828461053, -0.3771745429816061, -0.6048046820360256,
        -0.39514539226796913, 0.23204178881650794, 0.8550935562816445,
        1.0047201264025998, 0.5752565733489069, -0.08485319312471112,
        -0.48590585849124357, -0.423826721258087, -0.12957166283229443,
        -0.011412383276065183, -0.24110268621107592, -0.5785113298724103,
        -0.6022161481405988, -0.12904929041422908, 0.575737604867963,
        1.0035466299057068, 0.8414474225776025, 0.24361324335979623,
        -0.3134196289029757, -0.45623467177141247, -0.22791028716365255,
        -0.00502322675566709, -0.10619446108803592, -0.4675997077634436,
        -0.6951824437958501, -0.446570368851341, 0.21754995810825234,
        0.8486000113961343, 0.9876998406007341, 0.5628611216347822,
        -0.057773673021829286, -0.4030055956503586, -0.3126237789194286,
        -0.04782201953719359, -0.004306669768946475, -0.30658523571829643,
        -0.6713064688912876, -0.6722891546559349, -0.15948851722191548,
        0.5646732559789471, 0.9851516625903776, 0.8164962151093196,
        0.2436101717167627, -0.25766590842728004, -0.3508620756284529,
        -0.12139362193922071, 0.0450271602474471, -0.13566420733036932,
        -0.5492826224816094, -0.7768753183097746, -0.494121268938321,
        0.19853677689951243, 0.8301154128170387, 0.9565884123181637,
        0.540482308101442, -0.03364051068318635, -0.31755239567474636,
        -0.19689734873788525, 0.03847651671494173, 0.008277281351664362,
        -0.36399986507579807, -0.754220221547248, -0.7347918551545363,
        -0.18952354172487096, 0.5452616998594223, 0.9531164296081682,
        0.7789326667940186, 0.2368543036704547, -0.2022952308854989,
        -0.2423866995704248, -0.011086344510198548, 0.09943433533366114,
        -0.15837067488708997, -0.6211445132389187, -0.8485235279324295,
        -0.53661023951018, 0.17587801214962806, 0.8002722542994913,
        0.9117737634177228, 0.5080505178952467, -0.01324265550029008,
        -0.23104137602580732, -0.07839760193782983, 0.12801519691424593,
        0.0259903838939069, -0.41270972420041885, -0.8260474400302719,
        -0.7884650011065015, -0.2181193596755756, 0.5183138558629822,
        0.9080721030230048, 0.7290611014529478, 0.2230148804916781,
        -0.14844896001903357, -0.13252196714224343, 0.10135618550291908,
        0.1572688694935272, -0.1742231342079701, -0.6822898558107735,
        -0.9089188226121339, -0.5729086624849584, 0.15051834764688687,
        0.7598824517067693, 0.8538677647539626, 0.4656873475104154,
        0.0027411191133419888, -0.14494426993688606, 0.041080517040302716,
        0.21938815001890025, 0.04833859086340661, -0.45226088700083233,
        -0.8857674498428014, -0.8321738804192571, -0.24424962513373577,
        0.4847606078462974, 0.8508549527472328, 0.6674003847697506,
        0.20191990408560215, 2.7755575615628914e-17,
      ],
    ];
    const result = wavedec(data, "rbior3.1");

    const reconstruction = waverec(result, "rbior3.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.1_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4951343253250647, 0.9139790559321648, 1.1960786068932217,
      1.3089285482860455, 1.2535652405863662, 1.062406469690961,
      0.7900022840857501, 0.4990646573308438, 0.24526284004485782,
      0.06452499304037629, -0.03408346026638115, -0.06825929837297445,
      -0.07531765944653998, -0.0999537408664698, -0.1801348728192248,
      -0.33481314293414216, -0.5566881641639407, -0.8119776620363678,
      -1.0473864075575858, -1.2026409524604955, -1.2255323576341133,
      -1.085737367231859, -0.7839397986745801, -0.3538894721140473,
      0.14325704834005806, 0.631090863036206, 1.0337893809200351,
      1.2919228237592495, 1.3745127439948759, 1.284533586740973,
      1.056638567428452, 0.747773483220291, 0.42305363403315693,
      0.14039958354655513, -0.06231676071718767, -0.17453321519395468,
      -0.21300802717883377, -0.21474860621320685, -0.22479966737132767,
      -0.28211234327415957, -0.407185947586222, -0.5947181710928581,
      -0.8132314730657555, -1.0118788509412922, -1.1328100539176336,
      -1.1260533846918626, -0.9631945243549862, -0.646382340524201,
      -0.21030414995481383, 0.2835229188868946, 0.7589212086160129,
      1.140872752954253, 1.3712760666471229, 1.4209261404307294,
      1.294911657902556, 1.0302145386341768, 0.6861806016366402,
      0.3302434777990475, 0.022406382029607486, -0.19775626029618287,
      -0.31848343722771877, -0.35592991514355776, -0.347145526332355,
      -0.33786675093861107, -0.36834038374712036, -0.4608739486776427,
      -0.6123561745826294, -0.7937265069630053, -0.9566103289321887,
      -1.045515053006794, -1.0125552894855385, -0.8309992303611187,
      -0.5041737507809254, -0.06737487146235521, 0.41786863882889,
      0.8759564722597464, 1.2329958112515684, 1.4324873192690109,
      1.4472085994710984, 1.284493311250197, 0.9836957872142643,
      0.606515684818055, 0.22257193998169233, -0.10626069011854589,
      -0.33898056443219005, -0.4629492339879374, -0.4940643382282023,
      -0.46976668825541434, -0.4368123872153439, -0.43702951412980684,
      -0.49475842633199046, -0.6092277568079583, -0.7538572611564011,
      -0.8827183208093508, -0.9425616356787663, -0.8873932632494822,
      -0.6919013573310326, -0.3602778126716077, 0.07191550060834406,
      0.5434883516938366, 0.9797522536214485, 1.308236300231588,
      1.4742828350064232, 1.4528186163652534, 1.2535048811268594,
      0.9180616080643001, 0.5104466119549836, 0.10228584199190516,
      -0.24292356959437092, -0.4830564170818353, -0.604934981645387,
      -0.6245502297323455, -0.5800736619100143, -0.519587652932214,
      -0.48675500914568043, -0.5081325111830655, -0.5853903721105385,
      -0.6944417367026751, -0.7917276008731642, -0.8260811144930074,
      -0.7531650495356679, -0.5487943105896023, -0.21769338807723848,
      0.20465978542119534, 0.6577576683615792, 1.0681394759307776,
      1.3650230450302088, 1.4957926259300383, 1.4376445809385574,
      1.2026004721448218, 0.8346888214953602, 0.39998241047356253,
      -0.028105649934795973, -0.38473789757272725, -0.6269912478345202,
      -0.7414966223358963, -0.7446855794352858, -0.6757841082432023,
      -0.5844799155963416, -0.5164865271377432, -0.5007158845353106,
      -0.5413321521803651, -0.6167044270335854, -0.6855185290343839,
      -0.6984861055465634, -0.6126569211701959, -0.4046548570295483,
      -0.07939205275939826, 0.32808694222569645, 0.7582882442553159,
      1.1392694944409945, 1.4021686258877541, 1.4965685551954655,
      1.4020070986470785, 1.1328483563187897, 0.735323140664061,
      0.27743147599606377, -0.1658832057321219, -0.5287521714071819,
      -0.767795405834349, -0.869802889201627, -0.8519836249756704,
      -0.7549192430588092, -0.6301484496324873, -0.5256095371975587,
      -0.4726606079148188, -0.47796175480865055, -0.5222508532283253,
      -0.566287946593492, -0.5624203553739542, -0.46878573652775796,
      -0.26248121983602113, 0.05174370096722675, 0.43961969733486805,
      0.8429774477165989, 1.191652541126279, 1.4188940719104888,
      1.4765936565629179, 1.3466523232134944, 1.0457087571138826,
      0.622042867453688, 0.14535356659712204, -0.3081738830941916,
      -0.6719691245086223, -0.9025443329865334, -0.9871941858142601,
      -0.9442245669055732, -0.8158449880841071, -0.6556523182941811,
      -0.5139380990338303, -0.42454796077875623, -0.39658946731915584,
      -0.41303417537987175, -0.4365034904273174, -0.42070376122507636,
      -0.32453828013020997, -0.12523072700303373, 0.1729804089700115,
      0.5369281414951047, 0.9100520866529691, 1.2241887061268784,
      1.4148450606705514, 1.4362824872306885, 1.2727364394997283,
      0.9430034824145646, 0.49721567179201603, 0.006506569689982394,
      -0.45201087360927794, -0.8114080579375308, -1.0284393834853973,
      -1.09123789551519, -1.0195017319452775, -0.8573059534823214,
      -0.6604699415086368, -0.48171872980854624, -0.3573763521466315,
      -0.2988999576536741, -0.291314574410191, -0.2988522756717387,
      -0.2762737280874288, -0.18290914905085082, 0.0042416896878222365,
      0.28179048082203567, 0.6179781830297444, 0.958105284113044,
      1.2361908116475415, 1.3900992867549569, 1.3764725066448662,
      1.1818016193128513, 0.8268780379318239, 0.3634493532296479,
      -0.13621085141351166, -0.5943952009464561, -0.9441668274530368,
      -1.1428660248522386, -1.1797789704515975, -1.07626122442089,
      -0.8784515451056225, -0.6445099427196215, -0.42962527752539686,
      -0.27254055754489254, -0.1869172397841184, -0.1596122490358788,
      -0.15618501410271698, -0.13212408200041093, -0.0468384768478301,
      0.12324286624212466, 0.3759047639462506, 0.6810738491173272,
      0.9861257359187208, 1.2273987026202737, 1.345164846026433,
      1.2984066605727942, 1.0757439501705826,
    ]);
    const expected = [
      [
        2.782099492094529, 0.8229522353450691, -0.0036585584972788758,
        -0.004757868050729994, 1.8715817850151417, 6.430827035262968,
      ],
      [
        -5.551115123125783e-17, -1.6741850393395474, 0.08216070806293865,
        -0.07620308721525117, 3.763487058230706, 4.440892098500626e-16,
      ],
      [
        0.0, -1.7352171448433156, 0.5936694016501023, -0.18359375167140723,
        -0.42966742463661706, 0.46450556981874297, 0.12115072870922802,
        -0.5765510541664314, 3.639149302099264, -2.220446049250313e-16,
      ],
      [
        0.0, -3.1301046909154215, 3.282995275871995, -1.6688768780956014,
        -1.3904175627094588, 3.0626125505787964, -2.0084497327888386,
        -0.6449000719690818, 2.6245523770666637, -2.4259337775910654,
        0.2628991153277107, 2.1848097699221696, -2.899159190024018,
        1.0928102744254002, 1.8371271519087997, -3.2359136166485167,
        4.682927810303794, 3.3306690738754696e-16,
      ],
      [
        1.1102230246251565e-16, -0.15464916509099846, -1.9310788316633438,
        0.9022952852539483, 1.3384641881767734, -2.079699331335367,
        0.2609881233311835, 2.200879688679807, -2.439169623470489,
        -0.13145132389546843, 2.950967322670831, -2.9122311351758836,
        -0.2534564002206238, 3.465358181159269, -3.3642619722122338,
        -0.15367131843662446, 3.672923648863656, -3.656941304336768,
        0.06213765822677128, 3.5717276574353045, -3.6829461269690027,
        0.2583888515150027, 3.2288772092201685, -3.393055660137672,
        0.30441211729559875, 2.7633163186637892, -2.8089236101947725,
        0.10795484075083756, 2.315845053215291, -2.018338077709613,
        -0.36087093100176354, 2.0179721123284895, 1.2452783640671001,
        1.1102230246251565e-16,
      ],
      [
        -5.551115123125783e-17, 1.3021261466704945, -1.2440092845869186,
        -0.692848463878126, -0.590763051702892, -1.0385680740836685,
        1.5927375703803395, 2.0388161405659626, -1.0138471798657096,
        -1.14252189970535, -0.29363132562468186, -0.9946501362095196,
        0.9559238160900798, 2.377714765465305, -0.5276253007820226,
        -1.5936984646886043, -0.2223170118406724, -0.7266843756197208,
        0.3565545375498793, 2.432786563785741, 0.13160165752109138,
        -1.9125684783946824, -0.4098712824836977, -0.3387903097487149,
        -0.07987966609790337, 2.2037078146688014, 0.8372627974799787,
        -1.9948451576190585, -0.8210384015027591, 0.03588594167227094,
        -0.2715650924025015, 1.75668453711969, 1.4502452797585306,
        -1.791993425956864, -1.3608710588744812, 0.268719428947607,
        -0.20035370812943032, 1.2078853375477554, 1.8529974456239187,
        -1.323645500925985, -1.8982288173211177, 0.26801512752586654,
        0.08410234550411205, 0.6945140448679481, 1.978293594513715,
        -0.6731140258678524, -2.298322556807827, 0.002219864035514274,
        0.47709299184562876, 0.3407100699613772, 1.8255193057873753,
        0.032887438704350236, -2.456219607863011, -0.49183513916818183,
        0.8452981875272321, 0.2267488117179768, 1.460436453996066,
        0.6552833767832842, -2.3229848900092733, -1.1177141120717595,
        1.0603650308957928, 0.3691938350640143, 0.9984912246621749,
        1.1002278017414642, -0.02867890087528069, 0.028678900875280577,
      ],
      [
        0.0, 0.8671295707979776, 0.23975728520618173, -0.38622263495105547,
        -0.5974898540341467, -0.3801977605158088, -0.08569079425316478,
        -0.06568449902088642, -0.3255410845081782, -0.5227080964206894,
        -0.3108859770906705, 0.29630819110033957, 0.8906523958893132,
        1.008044461240407, 0.5366311884781246, -0.17862285496849845,
        -0.6321800514809985, -0.5862100461740092, -0.24397198291527927,
        -0.01961803745799935, -0.12882614718744367, -0.3866869295455682,
        -0.40094157156449584, 0.024379038675004572, 0.6597963121983803,
        1.020632538278456, 0.7896996041485006, 0.10712283291594837,
        -0.5405254684567549, -0.733842321747499, -0.46287734640559997,
        -0.09253506922409234, 0.005453864249393869, -0.1951933332859433,
        -0.3676415659777639, -0.17166535792924842, 0.3839623337287087,
        0.9048366439263926, 0.9456259839986162, 0.41356082362158963,
        -0.3312573933830897, -0.7755058135549326, -0.6830630786445763,
        -0.26859792501992474, 0.03501232038985058, -0.009066211604184804,
        -0.2334285839214416, -0.25452911674160916, 0.12597887979812977,
        0.6909067519324756, 0.973950714673878, 0.6774954908251208,
        -0.042116720627520865, -0.6889701369883499, -0.8433901183725804,
        -0.5047396673611639, -0.0551058882604378, 0.11287306811863301,
        -0.04593903945894992, -0.2159324446166575, -0.057199230016237335,
        0.4318654465469311, 0.8745537326398161, 0.8455260032662896,
        0.26934186885781275, -0.48303741640099185, -0.8961960988733179,
        -0.7413556399866729, -0.24871201354703887, 0.12859483531803695,
        0.13401384315945586, -0.078512435723771, -0.12855069030679772,
        0.19033590097614675, 0.677596484434197, 0.8871593089089829,
        0.5398681450622325, -0.19551666520796412, -0.8192366878899632,
        -0.9171243390223728, -0.5024168288863109, 0.023452594862016174,
        0.24773007652440537, 0.10996694238673976, -0.08007794577985533,
        0.02300497325523984, 0.4359587686131535, 0.8022432810105232,
        0.7160515599235748, 0.11600034986722335, -0.621328183438972,
        -0.9842751536430661, -0.7563509786446828, -0.1860415622083069,
        0.25338485751114725, 0.2886550188772026, 0.0653293848075866,
        -0.03341865810197936, 0.21205043660536363, 0.6208750489557104,
        0.7674159654458972, 0.3882721441187161, -0.3402879688955167,
        -0.9205092395339779, -0.9489995468305351, -0.4561973639908785,
        0.13659249599633277, 0.3989111220813344, 0.2597193013790752,
        0.028736899563087004, 0.06227527185381386, 0.3958089339939928,
        0.6938226139464163, 0.5679402775748921, -0.03368286629393408,
        -0.7346110774357504, -1.0324656510532542, -0.7268951831816993,
        -0.08585451314667342, 0.3990550280764483, 0.4421414899475707,
        0.1862812646513283, 0.023007438308679254, 0.18925171913369276,
        0.5253442827206916, 0.6246049557443467, 0.23531783762407427,
        -0.3314241398906836, 0.3314241398906837,
      ],
    ];
    const result = wavedec(data, "rbior3.1");

    const reconstruction = waverec(result, "rbior3.1", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5082406793019209, 0.9349983842611275, 1.2162576641950396,
      1.3186964396921204, 1.2455004881295193, 1.0334668107263603,
      0.7422861774465692, 0.43884626565021906, 0.18061201876433763,
      0.002311583835441444, -0.0907550583060133, -0.12122349211484273,
      -0.13057269121476803, -0.16499910106946752, -0.2601291148016746,
      -0.42873684350801206, -0.6548418742109694, -0.8958873911637397,
      -1.0925750768663676, -1.1839084502906692, -1.1235947858728488,
      -0.8935418810869566, -0.5108705592939404, -0.02647543942491988,
      0.48470489475331324, 0.9394452755830696, 1.2642184225953301,
      1.4110271829105228, 1.3672340389376272, 1.1570397711757134,
      0.8343560947784272, 0.46896676790597436, 0.12953035220100984,
      -0.13227585894408744, -0.29252432373393655, -0.3581293515625755,
      -0.3616839614158509, -0.349606052994125, -0.36688328604657056,
      -0.44256895672055996, -0.5799612734947044, -0.7541541373718879,
      -0.9177012667064632, -1.0129907957503244, -0.9881393545272796,
      -0.8122468354355782, -0.4859585938163573, -0.04443774684827598,
      0.4482368281952715, 0.9120498988387423, 1.268318798549165,
      1.4570486181872457, 1.4501180706176258, 1.2570666590857158,
      0.9220982031023012, 0.5131086954980146, 0.10552919919131681,
      -0.2349574779351269, -0.46653540083035544, -0.578777740195008,
      -0.5918677156643513, -0.5479619208273147, -0.4971571817602582,
      -0.4818904571592309, -0.5239703819318358, -0.6177164576833452,
      -0.7310564510364175, -0.8143256756969469, -0.8144689721861469,
      -0.6908965127394179, -0.428764690346204, -0.04607040993217609,
      0.4074942496203178, 0.8598779057740444, 1.2320403878743444,
      1.4556317881648848, 1.4886249349181129, 1.3250224559084176,
      0.9962223399272588, 0.5637036479340584, 0.10485778224032338,
      -0.30451052457421557, -0.6066864665178351, -0.7735237868946705,
      -0.8101868439459726, -0.7504409082126066, -0.6449385250401649,
      -0.5457242417796264, -0.4911119376684141, -0.49494186191044637,
      -0.5430396891035871, -0.5977859101318682, -0.6095567161384146,
      -0.5319730960204108, -0.33686585390939683, -0.024898493549581846,
      0.3711186526150089, 0.7913196448948758, 1.1612071862000815,
      1.4084274437409934, 1.4797540265572684, 1.3540324594200093,
      1.0478122773855683, 0.6122064512902006, 0.12170640097318078,
      -0.34231208918242756, -0.7093424044446652, -0.9344228673716657,
      -1.0062080343568192, -0.9466078640561575, -0.8023181864102751,
      -0.6306176717178229, -0.48323424994512304, -0.3925241847792552,
      -0.3635506278582937, -0.3740684166540844, -0.3823284525142618,
      -0.3405502051596077, -0.21040893507720193, 0.023665950516650935,
      0.34703980248233124, 0.7154255370063232, 1.0635243070213958,
      1.3197278368258631, 1.4232527650366804, 1.3393956337040898,
      1.0690162799656386, 0.6497741843532925, 0.14869760442434402,
      -0.3521642740210383, -0.7735238235881143, -1.055737596459639,
      -1.1706990861964233, -1.1259290822302233, -0.9600337049063522,
      -0.7308804111175382, -0.49966277053002345, -0.3150216458375936,
      -0.201311751925337, -0.15397313932555406, -0.14308153786119718,
      -0.12399820120312445, -0.052175572416898075, 0.10191863010677299,
      0.3418367118081169, 0.6411995010700786, 0.9479869282926578,
      1.1961439837865206, 1.3216453899969922, 1.2789571785978457,
      1.0536667350099935, 0.6679721091790427, 0.1774950088100804,
      -0.33994130578315296, -0.8009033673584646, -1.134286913528746,
      -1.29624356003994, -1.2784967361758994, -1.1081190147977313,
      -0.8389935068912933, -0.5372636867434895, -0.2645581212993006,
      -0.06328286344029316, 0.05232068177601473, 0.09719351497291195,
      0.10847710839300015, 0.13254627833924487, 0.2096282762857296,
      0.36020233285884995, 0.5769024809243501, 0.824202895046054,
      1.0461220410350598, 1.1800673510320623, 1.173302812982707,
      0.9977831386645533, 0.6594543352350943, 0.1994845573991881,
      -0.31308518763044985, -0.7956104491560307, -1.169612610741785,
      -1.3777286298738167, -1.3957146379674246, -1.2366133064070859,
      -0.9461599532487719, -0.5906947335947733, -0.24070901802194083,
      0.04579010425949098, 0.2359288734123652, 0.3275397903084681,
      0.34642961198774697, 0.33627572059941846, 0.3439903145122032,
      0.40455163451768406, 0.529417309567705, 0.7016786112055112,
      0.8793340690833549, 1.0059171526775856, 1.0257601789424957,
      0.8999211527732676, 0.6185688364182729, 0.20647770868807408,
      -0.2799875372158028, -0.763859496003094, -1.163951918700479,
      -1.412671181813482, -1.4708957506537432, -1.3362775480029772,
      -1.0429565759636763, -0.6528246823575652, -0.2405795996430029,
      0.12365969558550066, 0.3898389440559484, 0.5377570206526291,
      0.5788593736851012, 0.5498151856709169, 0.49977305030899055,
      0.47480221052020727, 0.5037215932818141, 0.589120438225313,
      0.7059875243240372, 0.8083507328770294, 0.8422067552635669,
      0.7613416062352371, 0.5418419119587696, 0.19138442101733474,
      -0.2493035488314522, -0.7134296182937373, -1.122018850154451,
      -1.401358924630522, -1.4997282309002993, -1.3992665443678451,
      -1.1200395909100276, -0.7152905774911364, -0.2590695078725621,
      0.17067492438915555, 0.5093477348853085, 0.7190690978480283,
      0.7949412719389313, 0.762855670911064, 0.6696463849795513,
      0.5683439133206638, 0.5025073358400575, 0.49380259406438637,
      0.5361036491941846, 0.5976548460588853, 0.6306977006619859,
      0.585986384875693, 0.42830593714993426, 0.14880599422362606,
      -0.22924895047356497, -0.6530344154283234, -1.0506108835833858,
      -1.346796685664791, -1.4805762743029691, -1.4197075549444582,
    ]);
    const expected = [
      [
        3.018756266153949, 3.3194845919613547, 3.0187562661539484,
        0.7715961828451536, -0.03844918421066992, -0.0056307470208893165,
        0.04677612699918038, -0.053417716124478334, 0.019773761503921506,
        0.029162995048000667, -1.7393276229144934, -5.930758620306872,
        -6.506062425646936, -5.930758620306872,
      ],
      [
        -0.2950340053782337, -6.938893903907228e-17, 0.2950340053782339,
        -0.22264987180573576, 0.6179768730259776, -0.5126891499128602,
        0.2875579771247534, 0.16230817632679798, -0.498089587116251,
        1.0940944897225349, -1.2019808998275923, 1.0404817224453164,
        -5.551115123125783e-17, -1.0404817224453171,
      ],
      [
        -0.8328878337005002, -1.3877787807814457e-16, 0.8328878337005001,
        -2.747978990825746, 2.484653985417547, 0.7431332358803294,
        -2.992003190969227, 1.8757342395278653, 1.3938215050817615,
        -3.1257111065998675, 1.3180331456980474, 2.0193505640757383,
        -3.093733792978517, 0.6459845528428345, 2.56623360738036,
        -2.8752902626601315, -0.09921676106771055, 3.5498795737015296,
        -3.656395023571868, 1.0063816507715921, 1.6653345369377348e-16,
        -1.0063816507715921,
      ],
      [
        -0.2940087377325986, -8.326672684688674e-17, 0.2940087377325986,
        -0.8464782209788129, -1.0528804498053304, 2.6270266037784804,
        -1.7429782624954555, -0.6696513281526597, 2.3846598102388956,
        -1.8892106790943675, -0.27835732173023614, 2.0959751839710448,
        -1.9452331088889552, 0.056136088475252324, 1.7838345765819905,
        -1.9196384016805326, 0.32108296490132243, 1.471316604687659,
        -1.82627452860095, 0.5095630666569098, 1.180030450232809,
        -1.6830967142322737, 0.6208432544552152, 0.9285540666046895,
        -1.5107297622496434, 0.6602807737992782, 0.7311104915163479,
        -1.3308468693633857, 0.6387772008103164, 0.5965784115466495,
        -1.1644844724478722, 0.5718246541700356, 0.5309413680411971,
        -0.5440430506472992, -0.3877095743407246, 1.2268753739292089,
        -1.2268753739292086, 0.38770957434072495,
      ],
      [
        -0.7504403918236722, -8.326672684688674e-17, 0.7504403918236722,
        -0.09940957854125758, -0.45540664743926856, 0.4002418886951449,
        -0.5054400435424778, -0.12374727204648713, 1.0286483006173475,
        -0.2380376178328359, -0.6515539545432204, 0.4055622158646207,
        -0.2987565162745164, -0.2568818238697726, 0.9896789992507066,
        -0.08781134603679257, -0.814243468267892, 0.3625855620384442,
        -0.07439811439283638, -0.35653539459241895, 0.8969590773784828,
        0.07188745894934216, -0.9329967575321949, 0.27516242703706884,
        0.15335601588845846, -0.41414831711013145, 0.7564253804860173,
        0.227324793095035, -1.0003603597737685, 0.15059149045118314,
        0.37000258649835194, -0.42441103250817147, 0.5772975523655953,
        0.36506601590504784, -1.0124352531288807, -0.0009231576250353091,
        0.561847234052006, -0.38566397433078314, 0.37141774632890023,
        0.47297953660794284, -0.9691494198679953, -0.1670288726430325,
        0.7169786240520332, -0.3000290754354486, 0.1524013568073206,
        0.5411453560358956, -0.8742537656109647, -0.3341400727154968,
        0.8261128587134381, -0.17326318889141906, -0.06533947768896547,
        0.5626019513985905, -0.7350417995397788, -0.4884456925664814,
        0.8832469061223694, -0.014344015122862014, -0.2676285976909929,
        0.5338767811767047, -0.5618135907364565, -0.6169348324694669,
        0.8860736845749368, 0.1651813428703239, -0.4415396918798614,
        0.45526146992494665, -0.3499669879924801, -0.34682334868270237,
        0.38400043833192155, -0.3840004383319217, 0.34682334868270237,
      ],
      [
        -0.3013568227880694, -1.3877787807814457e-17, 0.3013568227880694,
        -0.003770516332632909, -0.09538264212513992, -0.09297846374392615,
        -0.010319854618398822, 0.06421759879556559, 0.05506082817388127,
        -0.02683382177668249, -0.09510839931394494, -0.073124836964657,
        0.029322223516213393, 0.12228012268751504, 0.11973895942371851,
        0.021376878044470186, -0.08636491748508307, -0.11112275965183656,
        -0.04028689903776117, 0.04997686742648763, 0.07017341569314198,
        0.004256022797911471, -0.07588222625564121, -0.08187382498494465,
        0.0030459552067197138, 0.10487701040319455, 0.12786975135220946,
        0.045967305028381054, -0.07105347902538936, -0.12217165724046719,
        -0.06904726534502308, 0.030117020792759207, 0.07849634131855779,
        0.03412714297324218, -0.051015495199003676, -0.08355847321754856,
        -0.02167324090458863, 0.081798065221629, 0.12829364179110556,
        0.06801947635445582, -0.0507766013072137, -0.125496426666844,
        -0.0945967798101111, 0.006103239279674037, 0.07954527372578055,
        0.06079545909034779, -0.022109921619560297, -0.07788579369504345,
        -0.04295119069201245, 0.05469707210872268, 0.12084815877892435,
        0.08572776307776268, -0.027222071786213352, -0.12101779000441258,
        -0.11514430178814586, -0.020273859576031665, 0.07338407910863223,
        0.08251863426423142, 0.008934649436248901, -0.06511377288913604,
        -0.05917607973994474, 0.02549862029344301, 0.10592739533254208,
        0.09759611467069088, -0.002311728869421152, -0.10920981778865639,
        -0.1292414759189673, -0.04702922160685084, 0.060618545123598204,
        0.09792076369042273, 0.040056350716768885, -0.04603435994055235,
        -0.06912665713309162, -0.0037416124122214758, 0.08445499601216792,
        0.10254949127227919, 0.021941006224757198, -0.0910636648412122,
        -0.13588774715752744, -0.07212878697000522, 0.042350409767216976,
        0.10609028205288075, 0.0691792820810321, -0.021917338673028426,
        -0.07206171036788503, -0.0309858799757421, 0.057818716169085085,
        0.10001465815594879, 0.04358019035572134, -0.06801380876020027,
        -0.13460298947050792, -0.09363874109485665, 0.020095067433896312,
        0.10664397910497367, 0.09436261992510614, 0.005580843328861024,
        -0.06777428339018081, -0.054361839072229495, 0.027771302747280853,
        0.08996442439786598, 0.060852118996205, -0.04183218578651177,
        -0.1254624570626394, -0.10986769383956084, -0.004331025672888376,
        0.09975248473687101, 0.1139400021003901, 0.0345366582074314,
        -0.05660668306649601, -0.07229773221365256, -0.003695101075441104,
        0.07292207240084567, 0.07233520808536545, -0.014497956593849781,
        -0.1090915107149994, -0.11949140789185768, -0.028945013967471626,
        0.08612539392727007, 0.12663905122093783, 0.06289878960317394,
        -0.03942518102668158, -0.08363544316726648, -0.03449189649179703,
        0.04992562710129794, 0.07704550511227881, 0.011947591498853542,
        -0.08662050124106348, -0.12165096707211176, 0.04530526040758171,
        6.938893903907228e-17, -0.04530526040758165,
      ],
    ];
    const result = wavedec(data, "rbior3.3");

    const reconstruction = waverec(result, "rbior3.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49494861950597646, 0.9121967555486227, 1.1906341099168731,
      1.2983333620021464, 1.238146022253668, 1.0450460662887595,
      0.7760174019964943, 0.49512330799873, 0.25756591756561903,
      0.09674895296325925, 0.01754861580492756, -0.0026167029880242443,
      -0.005336467029003367, -0.037690258002863075, -0.13727270421411114,
      -0.319744386410831, -0.5722452442612896, -0.8545045926104019,
      -1.1075049225508518, -1.2676069661859375, -1.282616488729945,
      -1.1257326580197005, -0.8038034921131045, -0.35770624333278,
      0.1453793189703413, 0.6260192602956053, 1.0095330424838447,
      1.2418587347016734, 1.300459271405723, 1.1976904171807758,
      0.9759289515399616, 0.6958051200376609, 0.42058193426964535,
      0.20064894734341243, 0.06201899713701303, 0.001656331509247544,
      -0.009305418809674325, -0.015426582907094144, -0.06265125488427348,
      -0.1836369976013676, -0.3866295727403404, -0.6508796982505288,
      -0.9299212225394711, -1.1620086212901077, -1.285159572644635,
      -1.2530364739855648, -1.0476385536526678, -0.6855332131585543,
      -0.2159432251571905, 0.28897310279210864, 0.749366997757955,
      1.0948085622033101, 1.2791332961060156, 1.2894631162161319,
      1.147291942900576, 0.9015010703522269, 0.6151697665740772,
      0.3495687972304903, 0.14938700468565613, 0.0328794426938383,
      -0.010665503242043933, -0.01563370278671989, -0.028471756619122213,
      -0.09287609143115033, -0.23572621981868175, -0.4575124456934164,
      -0.7298565019766736, -1.0009034497660938, -1.2073365050840466,
      -1.2900479783489893, -1.209526471288459, -0.9570419891783398,
      -0.5587244862452632, -0.0713843920516371, 0.4290244808349414,
      0.8635649570801547, 1.167210061820128, 1.3023966389905601,
      1.2659984782220144, 1.0881185641495907, 0.8231343311820309,
      0.5353461217590796, 0.282895693525972, 0.10400883326756827,
      0.008979254877936327, -0.02018584275789928, -0.022513606928998037,
      -0.045214000850600344, -0.12866975999392777, -0.2932601173235514,
      -0.531540082433008, -0.8079240126462217, -1.0660949425322772,
      -1.2423687783778672, -1.2816911917100164, -1.1522299588103615,
      -0.8548305457693194, -0.42485403565876756, 0.07419923665040407,
      0.5638333899509681, 0.9673326605738997, 1.2261257484769998,
      1.3117970560239853, 1.230888403370659, 1.0214306648419083,
      0.7421988622631246, 0.4574796755085687, 0.22122606022659397,
      0.06457837270410544, -0.010168145147714969, -0.027742955081000872,
      -0.03084155013637266, -0.06629909387552502, -0.17018670096185073,
      -0.35579501891946996, -0.6077291998476787, -0.8837717732647864,
      -1.1241730696408956, -1.2661096163903225, -1.2596971679389495,
      -1.0815019987890715, -0.7420769961545688, -0.2855137712304994,
      0.21901884038483238, 0.6917836842489428, 1.05955547138196,
      1.271152582331632, 1.3076859514078885, 1.1851073140698516,
      0.9485559507024284, 0.6600373006899374, 0.3826067333322809,
      0.16506574084046866, 0.030998228898596658, -0.02516995880269257,
      -0.034222258888253226, -0.04147498713386205, -0.09225845260044646,
      -0.2174229091351655, -0.4227285617397223, -0.684982615120928,
      -0.9560547552520421, -1.1738748907932617, -1.2777083064183814,
      -1.2238736114196698, -0.9979067150692019, -0.6200237466459972,
      -0.14238570866554684, 0.36129652169181214, 0.811368719686204,
      1.1393010308760223, 1.3020998252610223, 1.2906079445180398,
      1.129760415243997, 0.8708634987200484, 0.5779400609340238,
      0.3116370510157577, 0.11475715753469395, 0.003016539035519794,
      -0.036736584799853006, -0.04053319347211182, -0.055209895959812405,
      -0.1234933977058526, -0.27021138717696985, -0.4933078513538604,
      -0.7621083309581264, -1.0234187196250495, -1.2140224408956084,
      -1.276478000930693, -1.174235277357578, -0.9022110125096425,
      -0.4900641899214737, 0.00278476561719029, 0.4992938411635808,
      0.9212149504785829, 1.2058324008229686, 1.3189888010870718,
      1.2612876231963766, 1.066061003374269, 0.789737457918785,
      0.4971220549389308, 0.24533931919823954, 0.07047697961564564,
      -0.0197629306575155, -0.0456620606532783, -0.047585604823068256,
      -0.07275955461626915, -0.16026214741128292, -0.32822106101989,
      -0.5666409180522856, -0.8378408879541113, -1.0845262090241274,
      -1.2435468133546337, -1.2619117057024762, -1.1110076104634299,
      -0.7953746331794651, -0.3537212988012598, 0.14821680054855813,
      0.6313396438571288, 1.0201031121087696, 1.2586176839262921,
      1.322048894709145, 1.220613219120943, 0.9953061258903175,
      0.7065509100891458, 0.4187013052512564, 0.18432976133142048,
      0.03223730861713631, -0.03786768032442722, -0.05280278370761245,
      -0.056266140323476516, -0.09473505192705745, -0.20266982227985775,
      -0.3909592032178757, -0.6417112652567301, -0.9108645801386976,
      -1.13808266800952, -1.261510568097122, -1.233695177489545,
      -1.034626627442568, -0.6785367137601004, -0.21262384379199467,
      0.29212265041699315, 0.7558566714395567, 1.10698661155552,
      1.2973359631063444, 1.3117098884497926, 1.1696175350002633,
      0.9188510676996577, 0.6226403934094527, 0.3436798534541269,
      0.12906404593803017, -0.0001096696057214519, -0.05194065053226865,
      -0.05905495835118664, -0.06741514430054008, -0.12162794325991866,
      -0.25066168371529945, -0.45777734031264566, -0.7173952437504608,
      -0.9798380910686664, -1.182862183950323, -1.2671280200039545,
      -1.1917164633870667, -0.9457350210111564, -0.5529990750430449,
      -0.06848066247224038, 0.4327363891208422, 0.8713864773621267,
      1.1810067983836696, 1.321879469580223, 1.288590802814372,
      1.1094565041862383, 0.8380831617841428,
    ]);
    const expected = [
      [
        2.987766944364242, 3.277078337481605, 2.9877669443642416,
        0.7704321513487479, -0.00950596100485391, -0.040945168261220584,
        0.03745063962188975, 0.014358666191678759, -0.041105923767111835,
        0.007695340180817786, 1.6772680645261433, 5.654267254019008,
        6.141823808288782, 5.654267254019008,
      ],
      [
        -0.33472755497615503, 2.220446049250313e-16, 0.3347275549761547,
        -0.36429435816606615, 0.9131535337572425, -0.3562192536039065,
        -0.42268602919650106, 0.5971918414021116, 0.06405479637300798,
        -1.2129073105082926, 1.3788272031741182, -0.9080247126591638,
        3.0531133177191805e-16, 0.908024712659164,
      ],
      [
        -0.8412159361030828, -4.163336342344337e-17, 0.8412159361030827,
        -2.809442387466671, 3.3049944612763578, -0.8248227681952106,
        -2.272387382668911, 3.53102200845266, -1.8105727413613455,
        -1.4256239853334742, 3.4056969275494495, -2.529249329360475,
        -0.330606033509529, 2.7747378554409687, -2.956047045550042,
        0.8973906234129583, 1.76888279157642, -3.6482600507766776,
        3.291159917029905, -0.9234620813931852, 1.1102230246251565e-16,
        0.9234620813931851,
      ],
      [
        -0.2522649686440608, 2.7755575615628914e-17, 0.25226496864406067,
        -0.6955895077218566, -1.0674533625433968, 2.1734891323530756,
        -0.9911834595694389, -0.9212023582598924, 1.5349836742502962,
        -0.47943574897732644, -0.7930256732903141, 0.8390128020790751,
        0.1513495201851504, -0.7560223280809717, 0.15276798030069513,
        0.849871941288124, -0.8187803262931007, -0.4617578354473153,
        1.5529239435866424, -0.9700753573334893, -0.9551468791204191,
        2.1929169881044923, -1.1804688997956727, -1.2961488251579598,
        2.7061167493835696, -1.40655643086609, -1.4747698708482202,
        3.0405067332957714, -1.5972851580341703, -1.5024785018664975,
        3.1622450995183495, -1.7014762562428984, -1.4209533143736033,
        2.5847761538053007, -0.7528912806435325, -0.1760211219519513,
        0.17602112195195146, 0.7528912806435324,
      ],
      [
        -0.7205034678009822, 6.938893903907228e-17, 0.7205034678009824,
        -0.08873225726955603, -0.4284285885021609, 0.42516298150333887,
        -0.49856234317477544, -0.2507956719219003, 0.9860755835332442,
        -0.08094016331086833, -0.6022802280238925, 0.39797249373474597,
        -0.2954664717534966, -0.48506729227681855, 0.9024185420189798,
        0.21426158842248688, -0.7067581602189363, 0.2885311877264669,
        -0.07117259279980773, -0.6448650230128286, 0.7256197459099306,
        0.5011009588906844, -0.7229103678304443, 0.11273597429185432,
        0.14048658370105838, -0.7137198366245201, 0.4778412395910892,
        0.7443184220043186, -0.643451684409117, -0.10371679778746566,
        0.3080826482438236, -0.6875288661072844, 0.18994768306804768,
        0.9137673487532827, -0.4739059789659599, -0.3288528405193274,
        0.406912830720884, -0.5749435653364967, -0.10256707894319106,
        0.9883875380069655, -0.2320270244954089, -0.5288115532103896,
        0.42239132053521283, -0.3960432371060048, -0.36425179144750747,
        0.9589830618211994, 0.05442925123465783, -0.6725141751378245,
        0.3520522233044388, -0.17947751909830556, -0.5643427561604007,
        0.8294325194199929, 0.3512865639819206, -0.7359769435215017,
        0.20589343311516942, 0.04153283444801091, -0.6807611149367575,
        0.6161697546976519, 0.622407142775559, -0.7056848775135706,
        0.0050147791084621945, 0.23379431807903778, -0.702929238533943,
        0.3460048092793712, 0.7698484401913235, -0.8691209671043325,
        0.5122459326647361, -0.5122459326647361, 0.8691209671043325,
      ],
      [
        -0.2915934334497602, -1.3877787807814457e-17, 0.2915934334497603,
        -0.0033326388132467744, -0.09108905377087598, -0.08922068765335352,
        -0.009301364527966774, 0.06479874241477357, 0.05842706238733408,
        -0.022007213943811724, -0.09519883288377796, -0.08325765145489744,
        0.012342479320906964, 0.1096682459878421, 0.12175354639989222,
        0.03765411578382749, -0.06731311051620295, -0.10181276256896937,
        -0.04295775748313847, 0.04449127497000832, 0.0717522027381545,
        0.011625759715726703, -0.07539150305945742, -0.09930928672901036,
        -0.027801926987533067, 0.08072225230760226, 0.1300856143165558,
        0.07576780003233963, -0.03348970576257705, -0.10116703886590839,
        -0.0726274616361908, 0.015526944862613627, 0.07254972014243283,
        0.04134337627836142, -0.04667455841637924, -0.10180203291270572,
        -0.06262473399775953, 0.04348073248403092, 0.123813790886606,
        0.10618249266464407, 0.006298281884211581, -0.08685589338499183,
        -0.09388766207498475, -0.017958273831563717, 0.06069955797221806,
        0.06288601014526299, -0.013356091421880135, -0.09091620794346958,
        -0.08789718893061396, 0.002673420457219945, 0.10374851384533534,
        0.12502876664936785, 0.0471193423526349, -0.06029167242036475,
        -0.10340356395970016, -0.05114310549781488, 0.037874594543627,
        0.07317661317998787, 0.01969006199348642, -0.06862170055730246,
        -0.10071092114657694, -0.036562759322405845, 0.07246480062572182,
        0.1299071344221709, 0.08384333440567043, -0.024552985253456477,
        -0.0993920356518088, -0.07917955247116291, 0.0073131185811714655,
        0.07074030262889502, 0.047692351737735526, -0.038396952162628846,
        -0.09985356608917845, -0.06936349036949685, 0.03395981486385856,
        0.12020650379801293, 0.11182009773956567, 0.016013707112182248,
        -0.08187742701612657, -0.09785719927377384, -0.026622090409569685,
        0.05590562699417644, 0.06663370062433865, -0.004745848192221121,
        -0.08595561760445625, -0.0917782493097721, -0.006878104946625656,
        0.09718494525280114, 0.12749575940502347, 0.056364115424460105,
        -0.05270464577826288, -0.10418349834407804, -0.05903859903359303,
        0.03076034605132337, 0.07379979404729713, 0.027422014617020582,
        -0.061389270265392516, -0.10128704757548698, -0.044917745508365886,
        0.0638019519102321, 0.12888412624572343, 0.09142154751566128,
        -0.015307214090521942, -0.09680154008970349, -0.0851828083233772,
        -0.00113232607073456, 0.0681494690129406, 0.05346388268075164,
        -0.02993337738013495, -0.097123687042618, -0.0754637370762481,
        0.024324708006819948, 0.11582996668891164, 0.11674864379011962,
        0.025739010405802953, -0.0761886289565028, -0.1010918443221038,
        -0.035218753323278215, 0.05045721343903017, 0.06963836988566953,
        0.003749902113020978, -0.08036254675418135, -0.09487475955114386,
        -0.01623881108031644, 0.09002889082023553, 0.12913542044136167,
        0.06531691364027514, -0.06441637907444187, -0.30441608119230684,
        0.3044160811923069, 0.06441637907444199,
      ],
    ];
    const result = wavedec(data, "rbior3.3");

    const reconstruction = waverec(result, "rbior3.3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49111955216891867, 0.9083045227740618, 1.1925629818274337,
      1.3113705822216835, 1.2641726653378578, 1.080688331600467,
      0.8125448704928921, 0.5203392673905799, 0.25928071319441665,
      0.06686199534039677, -0.04452944495168365, -0.08838542669518663,
      -0.098193310874403, -0.11648570585874779, -0.1816531696068252,
      -0.315892909325984, -0.5173834272573472, -0.7587344242782663,
      -0.9922155641504714, -1.160592017935404, -1.2109960666801165,
      -1.108482971080657, -0.8459474806711607, -0.44791108056310036,
      0.032868960780589915, 0.5253147676203122, 0.9542575121736776,
      1.2557374470942535, 1.3898664667720073, 1.348316222602107,
      1.1547636591778248, 0.8582882439142264, 0.5213723260143847,
      0.20541087236267858, -0.042810465190977975, -0.20048964486938198,
      -0.27189710451800647, -0.28459079356940914, -0.27985012688551175,
      -0.29982738088124933, -0.3747054282639974, -0.5131350569434578,
      -0.6984081374947491, -0.8914034330356755, -1.0396647712603961,
      -1.0904441608323325, -1.0045368842129907, -0.7674974968032964,
      -0.39541553151171716, 0.06629207172905194, 0.5509544646157534,
      0.9838256365540139, 1.2973771231356248, 1.4451924324682166,
      1.4112660675012039, 1.212586624628209, 0.8944637989310134,
      0.5197644326471698, 0.1546444071356155, -0.14583878098911113,
      -0.348863011858967, -0.4491800823291327, -0.46753538254679516,
      -0.44273539139436624, -0.41946793760084683, -0.4349980004955451,
      -0.5081140250707665, -0.6331266782286467, -0.7804639310874567,
      -0.9037694682677578, -0.9517936929552466, -0.8821616019036109,
      -0.6736035252672167, -0.3335663733526321, 0.10079287960330346,
      0.5686528627571096, 0.9973436103530039, 1.317266992652289,
      1.4764910038927395, 1.4516388313298358, 1.2525515698466776,
      0.9196629237116991, 0.5147358093283234, 0.10716442279810401,
      -0.24093076854694226, -0.48733761782522594, -0.6172204691528704,
      -0.6437963851331852, -0.6022452114419881, -0.5385120406636147,
      -0.4958808299473451, -0.5027118421650261, -0.564420743502418,
      -0.6617117991610906, -0.7555215148990431, -0.797460887556697,
      -0.7431699454647593, -0.5652523055994534, -0.26252289316045563,
      0.13683468947482907, 0.5791500449025162, 0.9954402173906337,
      1.3156014963558293, 1.4833533825420124, 1.4684564293204614,
      1.2733439418606265, 0.932610298815131, 0.5054744745898213,
      0.0629848538237916, -0.3270438783815492, -0.6138618100094176,
      -0.773209625926257, -0.8102478635435828, -0.7554729854392208,
      -0.654790659321687, -0.5563091371595429, -0.49717868084252104,
      -0.49375427974895075, -0.5375126466423775, -0.5977177886026548,
      -0.6301522019992397, -0.5897209061856257, -0.4437605063796116,
      -0.18268321508958985, 0.1747928302985759, 0.5832791016946974,
      0.979010861159169, 1.292971237855408, 1.465825027373228,
      1.461169972269464, 1.2739768045429434, 0.9322034721979333,
      0.491167888100418, 0.02196447488754022, -0.40339475414605075,
      -0.726677910868634, -0.9145968859497906, -0.9639306045871787,
      -0.8995607609154991, -0.766072528348164, -0.6151032682086548,
      -0.49161575303564, -0.42249122601412087, -0.4102315763561343,
      -0.4332782979913595, -0.45281120049235873, -0.42428212384321057,
      -0.31075905953179406, -0.09469127653077958, 0.21492971088517276,
      0.5819320310078302, 0.9491849481425542, 1.2503415953184853,
      1.4244018695998721, 1.4296749720657433, 1.2538210695223484,
      0.9175497735024514, 0.47103591113267185, -0.016174345071350432,
      -0.4694619288886902, -0.824348674693764, -1.0391363978095813,
      -1.102110909153236, -1.0317583156551973, -0.8701112988529077,
      -0.6709739434725672, -0.48597325034222394, -0.35186656502688723,
      -0.2821834949059277, -0.26518620096156315, -0.2685606071108077,
      -0.24958534497626556, -0.16816986329763067, 0.0005626183910145133,
      0.2573734762895461, 0.5760254017620571, 0.9072890395301062,
      1.1890238522160383, 1.3600172881716337, 1.3743174452891485,
      1.2126286273901248, 0.8879995362687316, 0.4443641093868975,
      -0.05182279787239919, -0.5249817981763831, -0.9057760578328522,
      -1.1449271344046696, -1.2223349271701955, -1.149481041102116,
      -0.9646947772365547, -0.7225520710276665, -0.4800538928965393,
      -0.2829623381521351, -0.15558622713820996, -0.09642751178739584,
      -0.08064078569631593, -0.06857575737091856, -0.018175218646421798,
      0.10194788552810802, 0.302100975687273, 0.5664667822672448,
      0.8548067919868724, 1.1106396221628227, 1.2740201771093378,
      1.2958907205449757, 1.150547714047393, 0.8431746694172091,
      0.41053640209872677, -0.08545946228362603, -0.569938178943594,
      -0.9702120463326194, -1.2304452718293772, -1.3224773598911035,
      -1.2503653233746297, -1.0476951139647346, -0.7684224137669405,
      -0.4735219704197082, -0.2166891356519291, -0.03251746481381779,
      0.07006818008728954, 0.10765402783703783, 0.11564375655071728,
      0.1368194557167693, 0.2081064343629389, 0.34892563403331106,
      0.5541228973929915, 0.7933367668715766, 1.0170794856613172,
      1.168144632306993, 1.1956229620374956, 1.068130018366806,
      0.7829917174327923, 0.3690660654906523, -0.11762165213525523,
      -0.6045459218517842, -1.0172614755127753, -1.2945683192575017,
      -1.4007834745756138, -1.33232015934149, -1.1171187581771926,
      -0.8071602808631944, -0.46591760059519327, -0.15377341746764045,
      0.08512353288764885, 0.23148469522106757, 0.2930403679339536,
      0.2998722816616946, 0.29422891504947085, 0.3174720009205989,
      0.39749068427176143, 0.5397904175155595, 0.7245492182578491,
      0.9104568762114642, 1.0444719690027597, 1.075155629235278,
    ]);
    const expected = [
      [
        2.930327443311777, 3.114429283476885, 3.0769546662435783,
        3.1144292834768854, 2.9303274433117767, 0.3304838877054107,
        0.2663136547320143, -0.30506499673271603, 0.08938271665111014,
        0.21402809258798328, -0.3415577316407161, 0.170609063875316,
        0.14899010339023172, -0.33250722528497656, 0.2297096276775749,
        0.05575773918171788, -0.2851425998013233, 0.2837550241770743,
        -0.05532352047066165, -0.22019081429860396, 1.9286555001763,
        3.0434800659789274, 3.23418864318, 3.23418864318, 3.0434800659789274,
        1.9286555001763,
      ],
      [
        -0.8817576943765596, 0.11626783628753883, 4.5102810375396984e-17,
        -0.11626783628753899, 0.8817576943765595, -2.38379002952784,
        1.7630594563414257, 1.0048789479190734, -3.279979516032039,
        2.8257477111179043, 0.24326210064324746, -3.1986284297160266,
        3.242515768930608, -0.43792378252697944, -2.5261770051137638,
        3.2057938693433328, -1.3766279610172267, -1.4075608513386544,
        3.2778343926224736, -3.0707138702734356, 1.3249428458462413,
        -0.995816818708416, 0.17649031476633345, -0.17649031476633334,
        0.9958168187084161, -1.3249428458462413,
      ],
      [
        -0.7718249299227129, -0.8664943096594871, 1.3877787807814457e-16,
        0.8664943096594871, 0.7718249299227128, -0.6597276665453279,
        -1.1899172307920616, 2.506313956961726, -1.7695855075273004,
        -0.36948030155693334, 1.9303894403338915, -1.6761057774397163,
        0.15746442178388723, 1.06278808653963, -1.0501027270926753,
        0.2592058541107438, 0.2453432487644792, -0.07794303549441034,
        -0.1547735441960543, -0.21218785659963496, 0.9131160988101652,
        -0.9538889510911557, -0.15800831142622523, 1.5883019347853156,
        -1.8394499999581169, 0.33990966955997454, 1.7417935476504907,
        -2.4671496709872884, 1.0227944196824499, 1.3800579579261585,
        -2.5885653115671654, 1.548861164604408, 0.7177330110030015,
        -2.1508664606084458, 1.7451805931019178, -0.39016894252397166,
        -0.5532931443287776, 0.5078870285976662, -8.326672684688674e-17,
        -0.5078870285976665, 0.5532931443287776,
      ],
      [
        -0.8268961471883681, 0.8205864247105503, 1.3877787807814457e-17,
        -0.8205864247105502, 0.826896147188368, -0.5552458303904908,
        0.14508727280930894, 0.21210495273139346, -0.4172473131037996,
        0.12628738017746943, 0.4120120017035464, -0.35994462969203944,
        -0.11610981010902086, 0.3612915358991734, -0.276903595805758,
        -0.15207967592346358, 0.4868606271960816, -0.13527232732680827,
        -0.3559965538509184, 0.33995112040146935, -0.02535946642125033,
        -0.3492312787113598, 0.3832495435428504, 0.14979660475083992,
        -0.4665438510551032, 0.15570730483353776, 0.23034203992160934,
        -0.3862110132052807, 0.14482912874427428, 0.3810417751957403,
        -0.39969113067635464, -0.11618935521225977, 0.3815751287574852,
        -0.25042696285627014, -0.1296604525925415, 0.4662654671970746,
        -0.18019641620711055, -0.3638671103859714, 0.36297672951401067,
        -0.0007872511637387614, -0.3271021344865921, 0.3732339560770481,
        0.10451132889179962, -0.4849451936247389, 0.17945378770472195,
        0.2566445472663314, -0.36663115064219526, 0.14290482610284597,
        0.340309271882855, -0.42874380815566865, -0.09578208189768506,
        0.4124373543253421, -0.23295874231887634, -0.12751111822287295,
        0.4333577929743372, -0.21719170123876025, -0.3513436067815997,
        0.39897194609333336, 0.017346337396095764, -0.32466987672205067,
        0.34871375243973457, 0.06418767917710952, -0.4835415926142545,
        0.21838612769433133, 0.2792074940251995, -0.35180650698303095,
        0.15310420038615027, 0.12023065432224665, -0.47273447946775254,
        0.47273447946775254, -0.12023065432224672, -0.1531042003861503,
      ],
      [
        0.041833645564117936, -0.09892890169627394, 1.3877787807814457e-17,
        0.0989289016962739, -0.04183364556411791, -0.017231151506359812,
        -0.016501107248942225, -0.0011577273233089186, 0.014443876559667201,
        0.015917134659478045, 0.001954990181162581, -0.014491899397765804,
        -0.018036648450882792, -0.004934370008155419, 0.0133850283578449,
        0.020569076714768576, 0.010109221986554449, -0.008756928550730625,
        -0.019361468598532543, -0.012612598143661932, 0.004892730087757407,
        0.01697496609586456, 0.012626387628578165, -0.00399083189276011,
        -0.017376106793850543, -0.014861361230945901, 0.0017621974968449515,
        0.017743543100179858, 0.018669369440080907, 0.0035179559911234174,
        -0.014367385713053217, -0.01928030297955968, -0.007267120116575831,
        0.01041529327979603, 0.01760344569770138, 0.007921835800767057,
        -0.009470527230447327, -0.018285327415055223, -0.010012126388704749,
        0.008229528469714956, 0.020050087321488528, 0.014617667770403239,
        -0.0034876373614905086, -0.018339626362169133, -0.016986348981435702,
        -0.0010664039545288315, 0.014782791111177765, 0.016253820614330384,
        0.002330657124186077, -0.013871153922584015, -0.017126837552707042,
        -0.004048970626116648, 0.013728391282352655, 0.020045087574292214,
        0.008883535531795567, -0.010098670110519768, -0.020210171088581634,
        -0.012732573773174955, 0.005286739408767116, 0.01749545098149725,
        0.013072313847260156, -0.0035210720553125845, -0.016702726855418105,
        -0.014041429114964024, 0.0023447304531714836, 0.017634012929498823,
        0.017735968321640254, 0.0021304967351970052, -0.015550837588847477,
        -0.01975663329762864, -0.006998512608639831, 0.011068009564422514,
        0.018238131871578953, 0.008411211001578371, -0.008978253245505071,
        -0.017652528097268763, -0.009386194840329954, 0.008440645541977931,
        0.01950703484097469, 0.0133953924196831, -0.004860927614201109,
        -0.01921298081306627, -0.017024293233746213, -0.0004363119391218931,
        0.01561420528945403, 0.016917041561939235, 0.0027900795653167127,
        -0.013429860441897356, -0.01661941946474153, -0.003693099982895148,
        0.013548456940967905, 0.019142824026030833, 0.0075289175796009935,
        -0.011283634539084614, -0.02066033004591547, -0.01232179076411933,
        0.0062034221573364304, 0.018399392176052656, 0.013671646239760015,
        -0.00316189948529131, -0.016377130392810385, -0.013724423150578724,
        0.0023918401025909415, 0.017093954066917442, 0.016593620532229097,
        0.0008159243689081367, -0.01639730581072421, -0.019723906454000937,
        -0.0061863141729955815, 0.012157541362679535, 0.019095889823567008,
        0.00886025244861616, -0.00877612063097881, -0.017489268959078996,
        -0.00929649045476151, 0.008181817885445593, 0.018683427395681285,
        0.012161153282868407, -0.005969257402113804, -0.019613900164876925,
        -0.016510318943457856, 0.0006777957210654072, 0.016738195828268937,
        0.017612987692656595, 0.0030207080163950732, -0.013419465338974628,
        -0.016640475587365217, -0.0038351391415323184, 0.022186870126410962,
        0.007856491809596093, 3.2959746043559335e-17, -0.007856491809596116,
        -0.022186870126410956,
      ],
    ];
    const result = wavedec(data, "rbior3.5");

    const reconstruction = waverec(result, "rbior3.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.499486834332464, 0.9197686621942065, 1.1986509331188855,
      1.303832858550717, 1.2385750218709766, 1.0388759960779237,
      0.7630099070506537, 0.47617810718043563, 0.2342215695904437,
      0.07052538720507978, -0.010620634499688308, -0.03263611967152123,
      -0.03775662720958964, -0.07309406152485431, -0.17541585556198885,
      -0.3587370432727632, -0.6080903794120671, -0.8812391740481325,
      -1.1180353203793234, -1.2551294619180058, -1.2423233340765454,
      -1.0563808299726447, -0.7087086572944112, -0.2448315604197464,
      0.26436190756477723, 0.7375594924821435, 1.100548741629666,
      1.3020675184891277, 1.3241427055310302, 1.184461396483287,
      0.9303163165981787, 0.6257718234312042, 0.33537480424831184,
      0.10856153274342689, -0.031320171434377486, -0.09068163457722783,
      -0.10127190499707195, -0.10897631187189566, -0.1588973225537002,
      -0.280735614937497, -0.47840605778998246, -0.7267229096654804,
      -0.9761529917999527, -1.1645351608978831, -1.232837628201369,
      -1.1409407589780503, -0.8793719636012275, -0.4739003306846339,
      0.01832505064809064, 0.5202876411920371, 0.9515334842730094,
      1.2455410761183925, 1.3638095525034428, 1.303262645045502,
      1.0952400070822745, 0.7964518796569973, 0.47427369184923673,
      0.1901470755042643, -0.014718001141279302, -0.12778430515009234,
      -0.16575579182534111, -0.1673025123033524, -0.17999700900636378,
      -0.24500586360252935, -0.3836508891562591, -0.5894620098228525,
      -0.8279147752321003, -1.044046075119061, -1.1760844885694914,
      -1.17164464061289, -1.0023262248799243, -0.6729123619521545,
      -0.2226919118192999, 0.28159980346673413, 0.7596174974139938,
      1.1347015538597138, 1.3504332902144451, 1.382425948854106,
      1.2425162464486075, 0.9744217342291744, 0.6420591539649692,
      0.31353828496007213, 0.04489394165346544, -0.13236789867303417,
      -0.21685524073631657, -0.23474426353773709, -0.22994388561005163,
      -0.24968829427533978, -0.32944435527662386, -0.4811847634136765,
      -0.6881952600191751, -0.9078819083698231, -1.0819588218063567,
      -1.151462787310038, -1.0727555725068156, -0.8303688541980997,
      -0.44330223708308036, 0.03698765567599145, 0.536581828558282,
      0.9747354073726848, 1.2813809543143508, 1.4122391267567094,
      1.3578655426383484, 1.1444752463471153, 0.8264393849729561,
      0.4724218559013263, 0.14869139859848945, -0.09618935419175395,
      -0.24149824788357738, -0.29687576171656327, -0.296774607379642,
      -0.28845702244100346, -0.31681382503600425, -0.4100840002183911,
      -0.5703043392856442, -0.7710803157020086, -0.9633598974792374,
      -1.0878011585718665, -1.0905889018998332, -0.9386212761154901,
      -0.630096437189759, -0.19765727402162184, 0.29688559914895596,
      0.7751085414673765, 1.1588178096689479, 1.3870941830852193,
      1.4293840881424396, 1.2914603830493883, 1.0128538251224601,
      0.6564828715816119, 0.293145708819406, -0.0152060122113023,
      -0.22923393394148056, -0.3396437938440666, -0.36655738651257663,
      -0.35118436772027867, -0.34212952710910544, -0.38003841537507244,
      -0.4846931403811421, -0.648017435224219, -0.8349040588882041,
      -0.9917350966513592, -1.0604508430772457, -0.9945530515727704,
      -0.7728819305566998, -0.40752622477944206, 0.056317402493993335,
      0.5486946262942216, 0.9895340186322573, 1.3060558783371574,
      1.4487088363125553, 1.401743564910928, 1.185863513189592,
      0.8523670578488259, 0.47031329442715314, 0.109968218806626,
      -0.17331693382867763, -0.35080263080509355, -0.42481028377367547,
      -0.4249797560709891, -0.39749818856148367, -0.39025985200119145,
      -0.4379444699922018, -0.5509988233117364, -0.7114756663032346,
      -0.876890284865561, -0.9911588347062739, -0.9998219303415448,
      -0.8656099638102149, -0.5802694256990946, -0.16948038647608105,
      0.3105752109966505, 0.7843256314183542, 1.1729807274398798,
      1.4118436714456917, 1.4645321012716204, 1.3306326123566226,
      1.044943943594281, 0.6685589581017157, 0.27406270928468035,
      -0.07142991515957398, -0.32117349843781934, -0.4579752554246474,
      -0.49550129739930193, -0.4715766640689685, -0.43540069396160846,
      -0.43214604673543583, -0.489058124660161, -0.6067576365314451,
      -0.7580802679046512, -0.8948157248713542, -0.9606399377828754,
      -0.9069000539963477, -0.7071324077861649, -0.36647115291475696,
      0.07662807199408389, 0.5569898479394791, 0.9961746038229788,
      1.319566098755319, 1.4729259401598513, 1.434356975362955,
      1.218748191048777, 0.8736429509625495, 0.46760647774699804,
      0.07402669599258638, -0.24560539002769283, -0.45480384361000165,
      -0.548411814394015, -0.5507259297141703, -0.5061106550908315,
      -0.4647074567056736, -0.4670805229637151, -0.5318848832518002,
      -0.6498335461555811, -0.7855866898114827, -0.8871128217409584,
      -0.9001113979740849, -0.7837422643282739, -0.5235257872896688,
      -0.13795916567524924, 0.3230320381094661, 0.7876220286018994,
      1.177374694099732, 1.4245962762507123, 1.4875007262706093,
      1.3594589611223402, 1.0700662989745409, 0.6777970966915658,
      0.25610653221113344, -0.12354307575342272, -0.4075189915835458,
      -0.5708370017390922, -0.6203926241757354, -0.5899884312141143,
      -0.5286384952371731, -0.4853363304879464, -0.4943519421797594,
      -0.5649539693325996, -0.678279977251166, -0.7922037993699513,
      -0.85295481260347, -0.8104678166555763, -0.6334403688378138,
      -0.32010583957439753, 0.09821005200692873, 0.5618619051850803,
      0.994982241401004, 1.3220248589316959, 1.4847204888571728,
      1.4552734292788534, 1.2425436811595731, 0.8896979355076772,
      0.4639344187279375, 0.04085356786906402,
    ]);
    const expected = [
      [
        2.926589160970837, 3.1175232915194466, 3.071461352375615,
        3.1175232915194466, 2.9265891609708365, 0.3197897480702326,
        0.260203014698409, -0.26636876478136373, 0.03876646320070838,
        0.22752977938655553, -0.29732381790744344, 0.10119352862000439,
        0.19282441686316504, -0.319060932311991, 0.15518716474674996,
        0.15549857945309273, -0.3275018396014549, 0.19861934707757797,
        0.11363477954179446, -0.28821368058447194, 2.5630703972916433,
        3.6508379721690813, 3.5928402698978466, 3.5928402698978466,
        3.6508379721690813, 2.5630703972916433,
      ],
      [
        -0.8683247491838125, 0.12025770782234727, -1.0061396160665481e-16,
        -0.12025770782234715, 0.8683247491838129, -2.3577060771575473,
        1.4581010449000251, 1.3696279358782573, -3.145124788981002,
        2.1698499892826053, 0.7758150161434394, -3.138042908575471,
        2.7310144377617154, 0.2100485082060591, -3.0604991850529784,
        3.141900720808324, -0.29244612160177, -2.8627924911861444,
        3.5339340851524033, -1.6470155643753126, 0.18073378134991422,
        -0.06986479812691022, 0.05779541884765885, -0.057795418847659,
        0.06986479812691015, -0.18073378134991414,
      ],
      [
        -0.746670784391609, -0.8636921968832975, 1.0408340855860843e-17,
        0.8636921968832975, 0.7466707843916092, -0.5356334440072793,
        -1.4026765363375957, 2.5822827175141394, -1.4686740450781413,
        -1.0128112127599103, 2.499903784814721, -1.6192010479304357,
        -0.727704024203116, 2.2923092201509596, -1.6630727289964837,
        -0.4429006035450131, 1.979916723711749, -1.5859842748271107,
        -0.19458121088072255, 1.591116735499584, -1.3850756082924716,
        -0.014715867271681, 1.160782914548826, -1.0692954541188573,
        0.07211403959170477, 0.7268997448904417, -0.6586171664068071,
        0.051168469732234684, 0.3268948155785822, -0.18218198462512503,
        -0.08096363862824013, -0.005967211816709854, 0.3244501450908082,
        -0.3019085014894797, -0.11028387208160982, -0.0948987220850033,
        1.361929368822707, -1.4424005849577892, 1.0755285551056204e-16,
        1.4424005849577892, -1.361929368822707,
      ],
      [
        -0.8324575900888307, 0.827866063622355, -5.204170427930421e-17,
        -0.8278660636223549, 0.8324575900888306, -0.5906459790410523,
        0.22014470506921677, 0.15340530073943778, -0.46706411179560736,
        0.2781936166573988, 0.32247820379968833, -0.46758540521509906,
        0.10030205362450978, 0.27106977084340017, -0.45277680792068026,
        0.13650602608848014, 0.43135201075492813, -0.41939576288936786,
        -0.04129440164305148, 0.3574289724078989, -0.39455133527425085,
        -0.013751352585119364, 0.5032256406143509, -0.3299296547433665,
        -0.18345383331626938, 0.4038427913559784, -0.2985674558822803,
        -0.15823508914490897, 0.5313044826169365, -0.20739654472386504,
        -0.3120161116814762, 0.40560453895377946, -0.17467749265271804,
        -0.2832007199170236, 0.5130170069722679, -0.06323467301105887,
        -0.414110416000102, 0.36240096884152373, -0.035442453010574845,
        -0.3768389064938346, 0.45026391419076034, 0.0889990641142,
        -0.47941187168696364, 0.27834395829358743, 0.10509562638820497,
        -0.4304228108795587, 0.34923200063758614, 0.2349457142107979,
        -0.5011504479301968, 0.16157075794648718, 0.232785491795093,
        -0.43915494342788153, 0.2197908801785406, 0.3608391285461365,
        -0.47677381102411753, 0.023451743984180127, 0.3347489775891405,
        -0.40263101705221216, 0.07453133361162573, 0.45484323747099326,
        -0.4081995356381475, -0.12251715607095183, 0.40063911985704737,
        -0.32487565132503865, -0.07159801610998406, 0.579384846010747,
        -0.5355518396430231, 0.03400863293194961, 0.34717013799496527,
        -0.34717013799496527, -0.034008632931949626, 0.5355518396430231,
      ],
      [
        0.043915066587044804, -0.10318650724505071, 3.469446951953614e-18,
        0.10318650724505068, -0.04391506658704462, -0.0202694417438829,
        -0.017383906303084028, 0.0016903539368496971, 0.018252506444004453,
        0.016234834110123067, -0.0023859443524089745, -0.019489583871225586,
        -0.01820650545447774, 0.0008308755833872335, 0.019937723724932375,
        0.021138090464697473, 0.003262802637121736, -0.016927937334066227,
        -0.020670987238560472, -0.00498541318120178, 0.014635105920940673,
        0.019153871391176656, 0.004250669843717111, -0.015550822373313417,
        -0.02083016020011259, -0.005951079821880497, 0.01540056613565354,
        0.023151518597119596, 0.009929999050468524, -0.011901553709652353,
        -0.02198482998590706, -0.011281655105900353, 0.009447841535494238,
        0.020062311798694082, 0.010365594979269182, -0.01013966072795692,
        -0.02139090805400662, -0.012052098857434133, 0.009505504441203409,
        0.02305601662385079, 0.015742110352633572, -0.005666912925290783,
        -0.021184234057004515, -0.016575059649525988, 0.00320016327128151,
        0.018868894971041297, 0.015354201894586628, -0.0037960329011608833,
        -0.019847467136023256, -0.01688825601721159, 0.0028220603906630396,
        0.020863049023477725, 0.020141455115503436, 0.0011812609575614051,
        -0.01833374732735754, -0.02033921094687767, -0.0034940271810749712,
        0.01568832306590061, 0.018722539382966377, 0.002849748979833187,
        -0.016363697800627557, -0.019999587436606313, -0.004004579976197249,
        0.01678717540639776, 0.022706977815000175, 0.007987971361445164,
        -0.013697489049636205, -0.02219595757652174, -0.009976221634561723,
        0.010830100154248179, 0.02013551699899435, 0.009138496629763366,
        -0.011292529293307855, -0.02109480520333229, -0.01031636700494937,
        0.011225142061022843, 0.023195203014222895, 0.014101654140080452,
        -0.007713533110480266, -0.021952343713251707, -0.01560750498792306,
        0.004768385403479181, 0.019449604427821718, 0.0144464559055695,
        -0.005141468317602763, -0.02007957515808263, -0.015506432229864397,
        0.004717236441810877, 0.021563899786299377, 0.01893755316427178,
        -0.0009513459934266093, -0.019619504987068798, -0.01983085492075849,
        -0.001904203304277232, 0.01672686162412844, 0.018246159993363025,
        0.0014769496791286882, -0.01706560438311728, -0.019078139031078294,
        -0.0021053308761600125, 0.01797615161026453, 0.02203459377142605,
        0.005943575410739883, -0.015411687540761634, -0.022225472443539868,
        -0.008534335165467196, 0.012228932613695065, 0.020157896881451566,
        0.007904938933732212, -0.012359653985395808, -0.020693387432381666,
        -0.008581891239616557, 0.01278443564466422, 0.0231002146435887,
        0.012312474106220132, -0.009725484985920909, -0.022547850268751765,
        -0.014471636369945976, 0.006391587712026366, 0.019986776852457942,
        0.013503647454159735, -0.006433548333645234, -0.0202054681700561,
        -0.014086642697218692, 0.006496262535142006, 0.022038791620932877,
        0.0175473977116025, 0.0017806611970409142, 0.024306749821068153,
        -0.239873898866831, 0.23987389886683103, -0.024306749821068206,
        -0.0017806611970409701,
      ],
    ];
    const result = wavedec(data, "rbior3.5");

    const reconstruction = waverec(result, "rbior3.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.7", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5036710644439707, 0.9306576817452734, 1.219591034014527,
      1.336260134595054, 1.2793308995687895, 1.078741736271527,
      0.7873019202641013, 0.4676084349680322, 0.17746854329170453,
      -0.042685735572292105, -0.17744668705323682, -0.23744576366403697,
      -0.2536831243633535, -0.2667657748619164, -0.3138917419907926,
      -0.4169579951524472, -0.5748765261775397, -0.7621286114244185,
      -0.9340295013318552, -1.0374949743263473, -1.0247081097417954,
      -0.8663207571963916, -0.5608787753898522, -0.13802412775879472,
      0.3455051267012177, 0.8163364742009863, 1.1990891706964677,
      1.431850397948622, 1.4789549795580545, 1.338134382269672,
      1.040411438187347, 0.642813134121114, 0.21564886246540982,
      -0.17264506076323088, -0.46956087640411864, -0.6482536110073062,
      -0.710811777883003, -0.6845042937362228, -0.612144363061818,
      -0.5391194227797707, -0.5004122561316893, -0.5108965227953806,
      -0.5613434925016775, -0.6211343898795872, -0.6469877678861625,
      -0.595495876736043, -0.4362890411041168, -0.16245230556538726,
      0.20454575724643204, 0.6168378541707504, 1.0088061781011148,
      1.3105118574741228, 1.4628318544921934, 1.4307689815990654,
      1.211786091456268, 0.8371576209500486, 0.36595863511005705,
      -0.1269658287664994, -0.5663025461870801, -0.8913420427667736,
      -1.0673999040787152, -1.0910583145742665, -0.9881854348484465,
      -0.805412995274776, -0.5972962266021541, -0.41237426848961733,
      -0.28155663011595955, -0.2116361353868912, -0.18542678401904814,
      -0.16836552322099438, -0.11980558898809021, -0.006059084451512875,
      0.18819661803928645, 0.45314161260871866, 0.7535250152448794,
      1.035126049733801, 1.2365496462891925, 1.3035975335416932,
      1.2027725190744905, 0.9306207084654943, 0.516562720178248,
      0.018385913556506615, -0.48869882541875126, -0.9270058644488931,
      -1.2319452391890153, -1.364678732220356, -1.3190125301113007,
      -1.1210382968035357, -0.8217426089904794, -0.4844500548745324,
      -0.17015383290237096, 0.0757637487794735, 0.23231392151431027,
      0.3052198527696882, 0.32240764173098246, 0.32398470523849915,
      0.3493641443260508, 0.424877502033524, 0.5550772021368466,
      0.7199996837439602, 0.8791685806037939, 0.981428676105248,
      0.9782284866258395, 0.837072987459911, 0.5517694962090829,
      0.1468170076379836, -0.3253301428389884, -0.7936909325159744,
      -1.1828312472653064, -1.4283996082786152, -1.4905609021582094,
      -1.362231022522257, -1.0702207005994016, -0.6690526433560928,
      -0.2289260794611997, 0.17934228401611846, 0.498895492904481,
      0.6975881652783626, 0.7725269127734612, 0.7475328216681171,
      0.6643719213235024, 0.5700907503713751, 0.5037044427818866,
      0.4855962528069388, 0.5122763803418491, 0.5577903229895668,
      0.5813956026186924, 0.5395494469302254, 0.3991544864979443,
      0.14866356643181783, -0.19586494887457873, -0.5914601123807205,
      -0.9757406841006038, -1.2796190842595194, -1.4423046157203154,
      -1.4250987862855689, -1.2207105082645675, -0.855840884704693,
      -0.38635340752294955, 0.11391874938760677, 0.568186869817144,
      0.9121139525176423, 1.1061147321817655, 1.1418066510454263,
      1.0412750834830233, 0.8495285728563127, 0.6221271984778595,
      0.41108345499731536, 0.2524938246868847, 0.15887798706231432,
      0.11800224874744042, 0.09833910156425243, 0.0596629028168954,
      -0.0339944986481025, -0.20239363708841634, -0.44126674321274995,
      -0.7207364508294964, -0.9905437819006283, -1.1909639263988485,
      -1.2668580190781307, -1.1814897866702982, -0.9267301654436029,
      -0.5270866577051673, -0.036434765653134575, 0.4719483838474632,
      0.9198568601433392, 1.2398669964771596, 1.388715647288628,
      1.3553192042904358, 1.1616687030231112, 0.8565124803061013,
      0.5034262184936891, 0.16616640982750963, -0.10520188240652106,
      -0.2841580425584618, -0.37133782178180963, -0.3912312718701705,
      -0.3829911951172529, -0.38780996674066304, -0.4361445215494225,
      -0.5380815504540157, -0.67933631479198, -0.8239649648953231,
      -0.9231874482562168, -0.9281773393857, -0.8036534524990994,
      -0.5388574640670699, -0.1530866724812269, 0.30576664669909565,
      0.7695458050848, 1.1632480745890692, 1.4205045671750491,
      1.4975675279866374, 1.3825693306618647, 1.0979080526163945,
      0.6952172746761421, 0.24410923759402542, -0.18267372203604276,
      -0.5242498841735485, -0.7432911249948916, -0.8318068113832547,
      -0.8098519734345905, -0.7177034099953838, -0.6036095819065396,
      -0.5102576025278316, -0.4633647412110744, -0.46523203196864354,
      -0.4948356883103423, -0.5143877619398014, -0.4806731358479182,
      -0.358262742493957, -0.13120861075129375, 0.18983255059582815,
      0.5670046779518408, 0.9415578391622101, 1.2457328268625694,
      1.417516456284182, 1.414815115999436, 1.225676932199469,
      0.8720866965930676, 0.4063506917388565, -0.09917603851397679,
      -0.5667053309935604, -0.9286454833813483, -1.1406920266449638,
      -1.189446327139678, -1.0929409736027889, -0.8941394903606406,
      -0.6491362142660244, -0.4130119488658537, -0.2268084960291823,
      -0.10875185906297741, -0.05176493780995389, -0.027733733744497162,
      0.0026881106229554863, 0.07732369619804441, 0.22008414386438518,
      0.4321760843261064, 0.689248116682811, 0.9453501825297352,
      1.1428863990487526, 1.226236825179976, 1.1557749743890329,
      0.9188495235402648, 0.5349734013541467, 0.0538123101144084,
      -0.45373483237101725, -0.9094274592834984, -1.243419778808621,
      -1.4082636472628296, -1.3879975759183365, -1.2002942138718014,
      -0.8912695951428937, -0.5242755598605882, -0.1653904845037631,
    ]);
    const expected = [
      [
        3.036076184435776, 3.4988441102994785, 3.489342339081123,
        3.230267688429151, 3.489342339081123, 3.498844110299479,
        3.0360761844357764, 0.010235044096215729, 0.21930134498203846,
        -0.007375309141205846, -0.2059697882165171, 0.17681397100233695,
        0.05504136721862046, -0.22263938726020083, 0.133205302245718,
        0.11461900446332081, -0.23402989248938239, 0.07652952944206368,
        0.17989052471715028, -0.2254008124106731, -0.004686836810401392,
        0.18547567347879212, -2.663757825738524, -3.5812971878281252,
        -3.581297187828125, -3.2336147156364805, -3.2336147156364805,
        -3.581297187828125, -3.5812971878281252, -2.663757825738524,
      ],
      [
        -0.48267469296905047, 0.35220519247754967, 0.4038709643124955,
        3.686287386450715e-17, -0.40387096431249536, -0.35220519247754967,
        0.4826746929690508, -1.0026741626218545, -1.546473133843781,
        3.0517328724926265, -1.2551378955767165, -1.857804180811186,
        2.8016607639686635, -0.5660328651739203, -2.3538949355167484,
        2.629672647320436, 0.20594014627704568, -2.951944556719703,
        2.2338164595013574, 1.3269798665339176, -3.6320162234077453,
        2.2843871153209077, -0.36100201143307437, 0.4965659037000244,
        -0.6098986214042214, 0.8730115814581142, -0.8730115814581144,
        0.6098986214042212, -0.49656590370002446, 0.3610020114330746,
      ],
      [
        -1.631312070821834, 1.0241685982826771, -0.7762563378073012,
        -7.979727989493313e-17, 0.7762563378073015, -1.0241685982826767,
        1.6313120708218343, -0.33154477133811, -1.1147162515096787,
        1.8513254164492574, -1.2448234064224346, -0.4298235525927646,
        1.9323891234417534, -2.0177709215022137, 0.5062710597209107,
        1.486101986564014, -2.3927191387967928, 1.4598395388923948,
        0.6144991212630837, -2.216534400338244, 2.105167222103855,
        -0.3988170078708524, -1.543483703749546, 2.231295117384053,
        -1.2169072622145671, -0.614207114031162, 1.8241668004414722,
        -1.5808764220605525, 0.23863018731094668, 1.0712540540036495,
        -1.410419863049395, 0.7207780579354436, 0.28685908377976904,
        -0.8338871803120383, 0.696150153940158, -0.1984775386868187,
        -0.36662889176456065, 1.0852109252257869, -1.4917863043234316,
        1.2906160974458967, -0.1633707345380692, 0.16337073453806925,
        -1.2906160974458964, 1.4917863043234314, -1.0852109252257869,
      ],
      [
        0.22286305661835215, -0.7074970576965267, 0.5010508651841475,
        1.205632815803881e-16, -0.5010508651841478, 0.7074970576965268,
        -0.2228630566183523, -0.18203272755525818, 0.27400751738894524,
        -0.09993034712082283, -0.1896973438584004, 0.2759872424940631,
        -0.0038343622799042977, -0.2665874108167863, 0.19574922843084755,
        0.07875874332559721, -0.26335641181323904, 0.16022356593104795,
        0.16176112968034384, -0.29000086941744396, 0.04619619765764976,
        0.22556230921305545, -0.22769349944743983, -0.012887142990110269,
        0.2637671622884482, -0.20458129650119672, -0.1272444170485402,
        0.28358404640891083, -0.09624583882253607, -0.1755477826564997,
        0.2608596941032336, -0.0445153769855845, -0.25549353950324927,
        0.23096849419096674, 0.07948481299104622, -0.2642250916995761,
        0.15315080766023337, 0.1267007255035908, -0.28718171538321263,
        0.08950160656505213, 0.2303530131872961, -0.24471255885526164,
        -0.01782877680372214, 0.24133514077015314, -0.20894692947463273,
        -0.08401572644383859, 0.29685970851914434, -0.1256131510439756,
        -0.1854988649334987, 0.25416186781716854, -0.050731440595842704,
        -0.220215132996508, 0.25263864239025174, 0.045080060497937266,
        -0.2844893830306053, 0.16031353012920918, 0.12601391852563293,
        -0.2645671737446756, 0.11486761669623394, 0.1989549399092773,
        -0.2764247536808442, -0.0028022414638836216, 0.252562123726167,
        -0.1989271537939612, -0.06250542565520296, 0.27514579086511354,
        -0.1493355366744935, -0.28328376325324967, 0.605616360665884,
        -0.674178767085078, 0.5078223554819209, -0.507822355481921,
        0.6741787670850782, -0.6056163606658839, 0.2832837632532496,
      ],
      [
        -0.005290156025529566, 0.035124310184208925, -0.02690801239695117,
        -1.6479873021779667e-17, 0.02690801239695119, -0.03512431018420899,
        0.005290156025529561, -0.0033422825768443017, -7.249288390605811e-5,
        0.003195884432278119, 0.0034775770439858067, 0.000525630728438829,
        -0.002946636669955901, -0.0037408856678221524, -0.0010933542688762923,
        0.0026190033675977014, 0.004031167103856592, 0.0018466684406234835,
        -0.0019801221815751243, -0.004011980037167727, -0.002442129819449235,
        0.001274445775778365, 0.003751679567230628, 0.0027530191618030274,
        -0.0007795142422458921, -0.0035914021090870346, -0.003086696118530661,
        0.0003006375788854234, 0.0034942707231203803, 0.0035715693908184333,
        0.00042622137981882685, -0.0031249601157192788, -0.0038910192343710698,
        -0.0011974661587916486, 0.002506667578885741, 0.00387552417234326,
        0.001702325022241363, -0.0019940533616323785, -0.0038167652688684303,
        -0.00208959893918195, 0.0016136481321778514, 0.003901052608267056,
        0.00265354917930174, -0.0010373176328312035, -0.0038498182053610403,
        -0.0032426089825343253, 0.00023909942554193892, 0.0034573199868946657,
        0.0035266086373582244, 0.0004261154221872447, -0.0029933237641698142,
        -0.003610162489040946, -0.0008738251016910095, 0.0026975919570191584,
        0.003815301730839844, 0.0014217461044748311, -0.002336226501594289,
        -0.004051024986382378, -0.0021499481238845147, 0.0016710717548263183,
        0.003980267884298484, 0.002718320888667599, -0.0009406081761010442,
        -0.0036639793165585185, -0.002992491622735903, 0.000428625752569356,
        0.003446033585234215, 0.003277390871066183, 5.2037675252859274e-5,
        -0.003299848362993826, -0.0037107429763899003, -0.0007704216131809497,
        0.002890746357499289, 0.003981254617711997, 0.0015306449823768603,
        -0.0022340646933363085, -0.003912900906192554, -0.002017772192352614,
        0.0016853295001802928, 0.0037940722292823773, 0.002373198938320784,
        -0.0012808565077167156, -0.003819986120282005, -0.002895810462108411,
        0.0006939497549364904, 0.003718792358369784, 0.003443256802422489,
        0.00010988224680123955, -0.003279065209536366, -0.003683272379102975,
        -0.0007771382856484356, 0.002765983457691866, 0.003713174530508719,
        0.0012145893634260905, -0.0024270506681718525, -0.0038588401824434363,
        -0.00173798264901872, 0.00203578164030357, 0.004039400003126973,
        0.0024365084569024404, -0.0013487996127237354, -0.003917409125812411,
        -0.0029737265645623043, 0.0005983475720193121, 0.0035463610878517463,
        0.0032077965075743894, -7.416120809099148e-5, -0.003272606372364739,
        -0.0034410918810536995, -0.00040337991264213606, 0.003079831945622345,
        0.003820625194154443, 0.0011082497064668886, -0.0026341779081134865,
        -0.004040694088324899, -0.0018525327039762853, 0.001943035320013919,
        0.003918924635519031, 0.002317457564859594, -0.0013624636678139226,
        -0.003740234066880387, -0.0026370230770498423, 0.0009384392669340342,
        0.00370861020580885, 0.0031146294354530367, -0.0003458206143787237,
        -0.0035590853712117185, -0.003617325415002713, 0.00481637875586623,
        -0.016436140341580485, 0.015055539818944814, 1.0842021724855044e-17,
        -0.015055539818944749, 0.016436140341580346, -0.004816378755866314,
      ],
    ];
    const result = wavedec(data, "rbior3.7");

    const reconstruction = waverec(result, "rbior3.7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.7_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4919126214417567, 0.9073405464584277, 1.1859964058895867,
      1.2961181954033163, 1.2400159356926017, 1.0516002912462252,
      0.7866319731017608, 0.5082136105093759, 0.27119203517353263,
      0.10936436523519127, 0.028632446450531313, 0.00771760196510618,
      0.0061178143591006096, -0.02285195783719457, -0.11738571255616442,
      -0.2947425387463592, -0.5443317893767563, -0.8282232749251518,
      -1.089090359750628, -1.263695179047608, -1.2985938346549892,
      -1.1641366026424615, -0.8632178378481797, -0.43250030562744723,
      0.06431613133969505, 0.5496508170771989, 0.9485057412117499,
      1.2043007054158943, 1.2903009863637154, 1.2139491280818993,
      1.0131656637834487, 0.7456614758062763, 0.4740139039380442,
      0.2502740727507722, 0.1039428184680341, 0.03626255416599583,
      0.022148266890244947, 0.019132039229100645, -0.019087637825688453,
      -0.12806967600399266, -0.32086664887479216, -0.582200720687249,
      -0.8701996888453536, -1.125390718721041, -1.2847938432480714,
      -1.2976362595064923, -1.1387555093046555, -0.8162911982953245,
      -0.3716508494129631, 0.1283684904482593, 0.6054875616271187,
      0.9865767378308395, 1.2190352375311693, 1.2812519049400541,
      1.1856994646184287, 0.9740341001238099, 0.7055401769940974,
      0.44188521688433163, 0.23202840231571825, 0.10103991986413347,
      0.04556287461321412, 0.03694410568309767, 0.031104765674395574,
      -0.017492053435753108, -0.14146027063450556, -0.34948656294758196,
      -0.6216385291565178, -0.9123196885864404, -1.1602602353267057,
      -1.3031318461806005, -1.2931725002158652, -1.109907137583563,
      -0.7667302203098342, -0.3096094763661176, 0.19189487599475663,
      0.6592065180704978, 1.0214345346118774, 1.2302057165102067,
      1.2690979676647267, 1.1554820365067204, 0.9344541362447116,
      0.6664877554292119, 0.4119640039375, 0.2164753973100052,
      0.10055676030478433, 0.05634235166436391, 0.05187244192350174,
      0.0418227909222923, -0.01820275221970674, -0.15758236663084246,
      -0.38050604622782325, -0.6624502921015595, -0.9543374173848652,
      -1.1934633169194038, -1.318543198577879, -1.285148768470357,
      -1.077665022478827, -0.7147195173883902, -0.24662819746515685,
      0.2546362186352297, 0.7106036198196624, 1.0529784863782345,
      1.2378377386419284, 1.2539826695861254, 1.1235209438763138,
      0.89467365875161, 0.6287138147702807, 0.3843698100072537,
      0.2036159834227531, 0.10237736673604819, 0.06839956042113957,
      0.06669954422528519, 0.05108143975183943, -0.0213413204576397,
      -0.1764414664963624, -0.4138109851899055, -0.7044292313682636,
      -0.9960042206395718, -1.2247714007834953, -1.3308770775551604,
      -1.2735308452147207, -1.0421218262613279, -0.6604576419999212,
      -0.1829643125196472, 0.31633812253426524, 0.7594882708351576,
      1.081126864263679, 1.2419765629418846, 1.2360650420122195,
      1.0900478673735452, 0.854938348486969, 0.5924165889871889,
      0.3592045613371164, 0.19343169192344767, 0.10636950327036276,
      0.08152405398082876, 0.08119217971897316, 0.05868593389597182,
      -0.02701254249775281, -0.19802360523598156, -0.4492700548583404,
      -0.7473579816878828, -1.037070198236579, -1.253964401835983,
      -1.3399988068614888, -1.25830434728263, -1.0033888236631072,
      -0.6041559169136824, -0.11887887875115946, 0.37675237769231706,
      0.8056844618204481, 1.1058172978536087, 1.2426867699410844,
      1.2155186145530634, 1.05530059420541, 0.8154901401104098,
      0.5577817212251501, 0.3365519690054914, 0.1858848363130159,
      0.11238557552124812, 0.09549776747339025, 0.09511916448753306,
      0.06445269884013782, -0.03530366656860606, -0.2222953741926857,
      -0.48673549598748406, -0.7910099275150574, -1.0772857668044489,
      -1.2808321091770827, -1.345790737669128, -1.2394748711250407,
      -0.9615952714703585, -0.546037187161683, -0.05463515609973838,
      0.43563843363311927, 0.8490317955358233, 1.1270070969510153,
      1.2400518007289425, 1.1925302880048818, 1.019521507904076,
      0.7765657073228445, 0.5249811237709501, 0.31647704863411025,
      0.1809188111467261, 0.12026363244645771, 0.11009647050133109,
      0.10825290116560785, 0.06821059975930732, -0.046283781720711514,
      -0.24920406842869902, -0.5260439972303637, -0.8351505999691307,
      -1.1164032220936795, -1.305175522711639, -1.3481530243481616,
      -1.21706801270022, -0.9168876664368247, -0.4863345004251974,
      0.009502961031325745, 0.4927648252478403, 0.8893864148410191,
      1.1446734509891878, 1.234173379179114, 1.1672991251772455,
      0.9829560513070006, 0.7383949832450618, 0.4941719262652923,
      0.2990257592922513, 0.17845851111404404, 0.1298284593617493,
      0.12509125880994748, 0.12037089399306666, 0.0698020987804649,
      -0.06000330985643132, -0.27867795676360235, -0.5670176767841819,
      -0.879539125121239, -1.1541782916706846, -1.3268081214370797,
      -1.3470042903315693, -1.1911292633668127, -0.8694288961354922,
      -0.425289724084047, 0.07327251579582414, 0.5479105418932887,
      0.9266218276867982, 1.1588135048806554, 1.2251708210197416,
      1.1400350672789141, 0.945851172414909, 0.7011997252392583,
      0.4654955187498344, 0.2842247638359009, 0.1784108677047499,
      0.14089275521454503, 0.14025007576859227, 0.13125723175564197,
      0.06908432625208527, -0.07649361608372052, -0.31062667281109463,
      -0.6094651573744041, -0.9239297145466081, -1.1903716681769783,
      -1.3455570554210712, -1.342282179865244, -1.1617237823992808,
      -0.8193972880383782, -0.3631521075648688, 0.1364130548687618,
      0.6008663311972605, 0.9606296239221079, 1.1694443108673767,
      1.2131802341191429, 1.1109575839443941,
    ]);
    const expected = [
      [
        3.032168499398809, 3.4115478951098344, 3.404845908156474,
        3.182502656963562, 3.404845908156474, 3.4115478951098344,
        3.032168499398809, -0.01096014179919419, 0.35040840533263895,
        -0.25072465470698335, -0.025167168348096444, 0.27987415573241864,
        -0.33542171078191907, 0.1468743493948854, 0.15895290594997266,
        -0.3563805554992268, 0.284564728856041, 0.012334243797240893,
        -0.30348648493771785, 0.35702877552447126, -0.1346273091175498,
        -0.14643619113487202, 1.173705408617926, 1.8819298518016483,
        1.8819298518016483, 1.6375414956393617, 1.6375414956393615,
        1.8819298518016483, 1.8819298518016483, 1.173705408617926,
      ],
      [
        -0.6645104842768258, 0.4053654559472434, 0.3698960909387529,
        3.122502256758253e-17, -0.3698960909387527, -0.4053654559472433,
        0.6645104842768257, -1.8139774054772657, 0.0342770947143297,
        2.44311888745978, -3.358137759029314, 1.9737187240737377,
        0.8127901963404531, -3.13844196241667, 3.2622555421218493,
        -0.8634583255767712, -2.3701585001890337, 3.8388179678110563,
        -2.248317998620066, -1.1353803328209344, 3.58256586845385,
        -3.2671768066764217, 0.5985679015341093, -0.36522310844417943,
        0.3434948050073423, -0.5096664652039088, 0.5096664652039089,
        -0.34349480500734214, 0.36522310844417943, -0.5985679015341092,
      ],
      [
        -1.4315785863737345, 0.9679691294297026, -0.7564879689426661,
        -3.903127820947816e-17, 0.7564879689426656, -0.9679691294297026,
        1.431578586373735, 0.030672337110069562, -1.4101750063445675,
        1.6498476228601653, -0.40013254516816676, -1.3684003915760439,
        2.008289275813824, -0.8110562644646606, -1.1850928129870222,
        2.1283405941677827, -1.1383738663788012, -0.8400880137443647,
        1.9725999321685268, -1.3024590986244649, -0.4148528358138946,
        1.5650135797207427, -1.2508354022029047, -0.0016053289592045752,
        0.9694175438299848, -0.9687700173778182, 0.31403730362826127,
        0.27857245369292605, -0.4831511823206961, 0.4689981963457011,
        -0.40173914139201256, 0.14111019691399734, 0.4343805146898072,
        -0.970740360913252, 0.8080820934921322, 0.24446481942846585,
        -1.4733383740573334, 2.0269025413628126, -2.777602786712793,
        2.988431629812, -3.084773597044204, 3.084773597044204, -2.988431629812,
        2.777602786712793, -2.0269025413628126,
      ],
      [
        0.24380428022620768, -0.7009680002370302, 0.4846423140425315,
        2.5153490401663703e-17, -0.4846423140425315, 0.7009680002370303,
        -0.24380428022620768, -0.16637081602167839, 0.3027982266814646,
        -0.14957023686773463, -0.17238480119735877, 0.3106611044612084,
        -0.07608003713259234, -0.22978734428367045, 0.2691037213627913,
        -0.0283002344601219, -0.2606964213912112, 0.26163502355847734,
        0.05397144755741528, -0.2907082768909318, 0.1974752722168385,
        0.09696607871826418, -0.3019356643560515, 0.1671735845542145,
        0.17554340849038313, -0.2997136165178721, 0.08907157764279486,
        0.20356084123268178, -0.2890580535731275, 0.04405576383982574,
        0.26703612144603284, -0.25484115652918643, -0.036496488764249435,
        0.2722290448080689, -0.2247176792423355, -0.08587118137596618,
        0.3121691571200091, -0.163792624896126, -0.15648006541446383,
        0.2905870456449056, -0.12077370268619807, -0.19959575483509198,
        0.30289299313777096, -0.04257099621790548, -0.2490817724969457,
        0.25534582325401406, 0.0038518613031837, -0.277052015307236,
        0.24082955852105625, 0.08737119396385473, -0.29737721134842804,
        0.1729003540500461, 0.12658030674346618, -0.3046993393759357,
        0.13698365628283685, 0.20296232173162845, -0.29236494340512176,
        0.058179481535192985, 0.22523514842682735, -0.27793146683463166,
        0.009776872002480851, 0.28363520438015755, -0.23459749160445487,
        -0.068037392994481, 0.28202574258350044, -0.20380093538554284,
        -0.11580713647151125, 0.3721639630821173, -0.4795535916132556,
        0.6263417192061013, -0.9470420313872575, 0.9470420313872576,
        -0.6263417192061015, 0.47955359161325567, -0.3721639630821171,
      ],
      [
        -0.004564678788614504, 0.034631496835548704, -0.02710547071488867,
        -9.540979117872439e-18, 0.027105470714888696, -0.03463149683554876,
        0.0045646787886144775, -0.003538809055870282, 0.0003481182456672254,
        0.0038653417662046566, 0.0036961865813389494, -1.3843352424146652e-7,
        -0.00373813947708968, -0.003982763693249042, -0.00047526296994467076,
        0.0035165853964240277, 0.004260681534684323, 0.001061204372586757,
        -0.0030886925654965976, -0.004314839421510982, -0.0014944830140775618,
        0.002696514896442482, 0.004303330250782722, 0.0018108348710305553,
        -0.002432035144588782, -0.004420177474701563, -0.0022585873863346976,
        0.002051110699525371, 0.004483293177701126, 0.002763343016487612,
        -0.0014986511938586715, -0.004318626219603456, -0.0030753285956683822,
        0.0010348384434170025, 0.004128521795073014, 0.0032880656999218836,
        -0.0006954822897931407, -0.004065673004998182, -0.0036321362537630585,
        0.00022705945329750635, 0.003913198719420471, 0.003980065237637144,
        0.00036637593257180835, -0.0035470459022482028, -0.004108954600029429,
        -0.0008205588567321322, 0.0032032756992715575, 0.0041658075397434935,
        0.0011583507562593024, -0.0029852039613758657, -0.004352037514400991,
        -0.0016302498646041848, 0.0026521006532526183, 0.004494080178716019,
        0.0021739467529867823, -0.002136000955486498, -0.004407761945539152,
        -0.002535405434318421, 0.0016941362460672136, 0.004286275326814481,
        0.002795657478265552, -0.0013746867460251706, -0.004291699331083447,
        -0.0031899220046725752, 0.0009250050696979512, 0.004213483564968069,
        0.0036014928676134776, -0.000336187355065856, -0.00391575761106184,
        -0.0038002823086353233, -0.00012720635501866544, 0.0036279469040447496,
        0.003921895730508476, 0.0004752272996793442, -0.0034643715430614256,
        -0.004174683500405634, -0.0009600500472204265, 0.003188216792589126,
        0.00439405611209416, 0.0015317200211589182, -0.0027187151029992476,
        -0.004386182015300697, -0.0019326690135594952, 0.0023094165283777234,
        0.004334630017088918, 0.0022313438493830043, -0.00202064551367305,
        -0.004410457181159358, -0.002667121825217621, 0.0016011347573497603,
        0.004409934270786167, 0.0031344386723566237, -0.0010289268067706255,
        -0.004185668831147538, -0.0033966577403783645, 0.0005681100263326684,
        0.003959840746163014, 0.003577723084582971, -0.00022134689906221083,
        -0.003857434427356096, -0.0038924695196303565, -0.00026471777395889733,
        0.0036460581613415514, 0.004185730012370754, 0.0008527256528834916,
        -0.0032322578505927495, -0.00425452195990347, -0.0012823223462524523,
        0.002865191938276828, 0.0042723620773406235, 0.0016093146359300765,
        -0.002617083152619378, -0.004418874862043325, -0.002076759254081911,
        0.002238553193575381, 0.004497645015669325, 0.0025905916692181077,
        -0.0016945335419818672, -0.004350100239742953, -0.0029082967785424504,
        0.0012478795638754684, 0.004190600850884213, 0.0031419372238209835,
        -0.0009138421264828684, -0.004154446895476951, -0.0035123801171045403,
        0.0004383841717754248, 0.0034024014692213282, 0.00010975832394720256,
        0.03950729440055463, -0.12601228031806122, 0.12601228031806122,
        -0.039507294400554685, -0.00010975832394722598, -0.003402401469221314,
      ],
    ];
    const result = wavedec(data, "rbior3.7");

    const reconstruction = waverec(result, "rbior3.7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.9", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48960527914527086, 0.9059777973680754, 1.1905896348062481,
      1.3109810630643182, 1.2662302485604573, 1.0853673142153555,
      0.8192298939802478, 0.5277896791791559, 0.2660202095784346,
      0.07167866528587025, -0.04213081260140844, -0.08793356187977543,
      -0.09830649195570886, -0.1152498369189891, -0.1772392755481767,
      -0.30724923905501883, -0.504797193330641, -0.744074825782154,
      -0.9787425820067043, -1.1523279875700714, -1.2117804305197295,
      -1.1209311940169697, -0.8705833214643552, -0.4827202076414024,
      -0.007694194905396481, 0.4850897266221375, 0.9209394299600504,
      1.2349755163860023, 1.3851264047998106, 1.3600681784057986,
      1.1803441797427427, 0.8924990612535754, 0.5576946798653513,
      0.23755210381419734, -0.019418114877390258, -0.1876214672834349,
      -0.2681876269601972, -0.2860186328172432, -0.28095828716754023,
      -0.29538517293988703, -0.3613888677364578, -0.49077652880492095,
      -0.670454835442847, -0.8644102031533827, -1.0218873930295411,
      -1.08983489024246, -1.0266149591742482, -0.8136268517254761,
      -0.4619500265974772, -0.012273231046776911, 0.47204074363436777,
      0.9172740370975612, 1.2542882887815812, 1.4326708900451115,
      1.430858011370415, 1.259934044355772, 0.9602850443023601,
      0.5919531829903852, 0.22100265752207715, -0.09488293436195672,
      -0.3182111281991611, -0.4381976429683979, -0.4705871154574937,
      -0.4509993000155635, -0.4235823857743241, -0.4278756897583052,
      -0.4871969154094953, -0.6014764667213466, -0.7463588990831053,
      -0.8788461509434957, -0.9481420789008778, -0.9090633136075695,
      -0.7347210367185661, -0.4253132261600131, -0.010767447250539908,
      0.4535734828291129, 0.8973734570614498, 1.249517735273915,
      1.4528831316537973, 1.4762695090232492, 1.320745671438297,
      1.0189613738037733, 0.6276183374116129, 0.21488627196892396,
      -0.1542840029576094, -0.43153581576474215, -0.5941051772725571,
      -0.6474527095851071, -0.6210806145498673, -0.5587235505749906,
      -0.5054424119174599, -0.4948722568541212, -0.5398081377737307,
      -0.6284735056926107, -0.7274089016855594, -0.7902840553001047,
      -0.7704692967523089, -0.6342572129175259, -0.3714321511159869,
      -0.0004922763227784843, 0.4329072966579068, 0.8641031068246927,
      1.2223906813858711, 1.4458652360899762, 1.494713688706401,
      1.359871000093969, 1.0650226791676194, 0.661484332820805,
      0.2171499632347663, -0.19792189046697428, -0.5259484917760757,
      -0.7325795506346188, -0.8122693937737548, -0.7867616730282228,
      -0.697233927306528, -0.5921564803950103, -0.5139236256707231,
      -0.4875757584947272, -0.5143887288804394, -0.5718939133227462,
      -0.6203031136385, -0.6137305713489895, -0.5134124237892375,
      -0.29961034183173807, 0.020823727834175076, 0.4132187863999087,
      0.8206723110539255, 1.175290505272691, 1.412541392208789,
      1.4854035735563915, 1.375003563452, 1.0952321768823636,
      0.6902271253897538, 0.2252728805568919, -0.22679596725903167,
      -0.6005605247471606, -0.8509254677022511, -0.961053420396759,
      -0.9436093790376537, -0.8351973649055351, -0.6854867164349473,
      -0.5437710200929918, -0.44628174869281667, -0.40735472940198125,
      -0.4165770818338915, -0.4425609786984363, -0.4423567451933009,
      -0.3741261086698944, -0.20988310998717696, 0.05492764335037903,
      0.3974975959189116, 0.7704926322151132, 1.111152712934776,
      1.3546162427246253, 1.448385593707764, 1.3645353652386145,
      1.1067604933257111, 0.7105513644106445, 0.2363853321388953,
      -0.24254276251769166, -0.6552532632004304, -0.9471661200248555,
      -1.090319080413589, -1.0873549293841052, -0.9684973930065441,
      -0.782395422506547, -0.5831547352128681, -0.4167506143693164,
      -0.3101197431122998, -0.26553926786446974, -0.2615867603048046,
      -0.2603535098909536, -0.21904718685946295, -0.10303917240616683,
      0.10295226162690635, 0.38841077006346963, 0.7170298905745307,
      1.033340765684137, 1.2745047160880172, 1.3845404023025334,
      1.3276283608201798, 1.0973102774202497, 0.7193376186370779,
      0.2474024819481586, -0.24734884429220383, -0.6906594555111891,
      -1.0200986883567613, -1.1971960111134128, -1.2140457078096036,
      -1.0929680079561432, -0.8794524047244143, -0.630185521366196,
      -0.3991031800179941, -0.22483425815830177, -0.12252283490094829,
      -0.08191947473081962, -0.07208796182792343, -0.05145342137284545,
      0.019387696258000353, 0.165351201489444, 0.3881811514116366,
      0.6636557970259667, 0.9455071062654444, 1.1752360990364714,
      1.2955530524685588, 1.2642576687097247, 1.0652216013757072,
      0.7137839774808021, 0.25516729726073084, -0.24384182906957913,
      -0.708115437522898, -1.0693202490634848, -1.2795236051280245,
      -1.3201864099103418, -1.2045483256705307, -0.9729664805051066,
      -0.6824215556898018, -0.3927604335043832, -0.15298040946577862,
      0.009197120090142619, 0.09204885548472175, 0.11785979645370072,
      0.12485396655413075, 0.1551568514139547, 0.24186177117913976,
      0.39848472683552943, 0.6135051224579702, 0.851444894312283,
      1.0603361233186817, 1.183853666262271, 1.1752247316518971,
      1.009553887799284, 0.6915363123593193, 0.256596957057897,
      -0.23496398908392876, -0.70958615403048, -1.0952232442725258,
      -1.3359189671742, -1.4028639776075773, -1.2994351062627416,
      -1.0591293371446444, -0.7369691832857934, -0.39647676164595347,
      -0.09532924685670213, 0.12692194065526885, 0.25622354253896196,
      0.3048531417958609, 0.3056764894245063, 0.30138749059252035,
      0.331497195300416, 0.4203710792689505, 0.5693440948907791,
      0.7549363094042344, 0.9336916851897292, 1.0525308673522071,
    ]);
    const expected = [
      [
        2.0581302147938256, 2.2676586726900245, 2.517522146988978,
        2.1578704567527924, 2.4312437774602946, 2.1578704567527924,
        2.5175221469889775, 2.2676586726900245, 2.058130214793825,
        -0.09002800636273861, -1.54315557177975, 1.529429994583663,
        0.09294499350146862, -1.5651394432013754, 1.3233669605649327,
        0.3184606733553473, -1.5436232672825525, 1.0346964993497214,
        0.5984561836147344, -1.5199365948078962, 0.7090086723407185,
        0.9143218289059462, -1.517355935675317, 0.39715846269599275,
        1.222521726301334, -1.5300316091491528, 0.13446478559108727,
        1.4719423333714086, -1.5258762258401453, -0.0726752311867252,
        1.6250362314070848, -1.4620767217062847, -0.24665746742488254,
        1.6730690676462878, -1.306052376369683, -0.4251696258900378,
        1.638489144354142, -1.0521546572561111, -0.6406332673883061,
        1.7027869631842516, 1.4938299595485436, 1.4938299595485434,
        1.7027869631842514, 0.7122880216045224, 1.7027869631842514,
        1.4938299595485434, 1.4938299595485436, 1.7027869631842516,
      ],
      [
        -0.4782536694624287, 1.0356913278959625, 0.2577731050287263,
        0.5917385446088861, 3.0466081046842675e-17, -0.5917385446088861,
        -0.2577731050287264, -1.0356913278959632, 0.47825366946242864,
        0.4440016348550548, -0.7018747147319033, 0.3811721262749951,
        0.3866133782169906, -1.1825744752287801, 1.3261034841109733,
        -0.44700758351588665, -0.977099266680062, 1.8365348363824896,
        -1.3215925876760712, -0.27328824933154905, 1.702178084053135,
        -1.816954032260457, 0.5623924520645017, 1.0077638968611924,
        -1.683365237336306, 1.1024656464433018, 0.09043524017119078,
        -0.9557325592955227, 1.056842361972079, -0.616288852074752,
        0.061796076601809836, 0.40779159653460195, -0.7828519741670672,
        0.935343887769124, -0.5808363398630564, -0.3353033854527705,
        1.3035159460777819, -1.5364419430090586, 0.7640881263550119,
        0.2955024675832062, -0.549579701246257, 0.6656540218952082,
        -0.6324261812000692, 7.37257477290143e-18, 0.6324261812000691,
        -0.6656540218952081, 0.5495797012462569, -0.2955024675832062,
      ],
      [
        0.3917690347014348, -0.5777517134312554, 0.7461374840593997,
        -0.33204327066181055, -5.4752209710517974e-17, 0.3320432706618106,
        -0.7461374840593997, 0.5777517134312553, -0.39176903470143476,
        0.13281677532039546, 0.10536577602934913, -0.17239636841914338,
        0.026556033867279484, 0.1554022485042227, -0.14528557906584136,
        -0.03968905852841546, 0.1725944921695784, -0.10208782740422716,
        -0.09239114316270204, 0.17934635161220347, -0.04501881067456324,
        -0.14237607474676145, 0.15438314139163578, 0.01479490319365397,
        -0.16777286545014766, 0.12168911390349474, 0.07631641367602296,
        -0.18021686506446435, 0.06373301708578352, 0.12446094147925035,
        -0.1649437900142786, 0.009084092669172967, 0.16291489770837753,
        -0.13559443580178976, -0.057550623920091394, 0.17611609293638203,
        -0.08537329592775342, -0.10648967452573367, 0.1749892244889374,
        -0.028928987075103444, -0.15349263439882116, 0.14575310406356645,
        0.03403701676750501, -0.17171592379929135, 0.1071265817104952,
        0.0907412138391634, -0.17978016194823365, 0.04723534833176471,
        0.13798796372958463, -0.15654565749560714, -0.009217544980460728,
        0.16838558624519484, -0.12421365426152035, -0.07409701539088906,
        0.1783080692078653, -0.06806311198904615, -0.12023951552719667,
        0.1683721459106495, -0.01233868182864094, -0.16234781205522741,
        0.13618965690150853, 0.052785795494270524, -0.17462048608957975,
        0.09090600921927681, 0.10434051235598445, -0.1768578685143022,
        0.030940883501897047, 0.15222356237627813, -0.16307342592916532,
        0.010110950293521563, 0.15453059157384436, -0.2071692929205632,
        0.19532457109186055, -0.19532457109186055, 0.20716929292056305,
        -0.15453059157384444, -0.010110950293521546, 0.1630734259291654,
      ],
      [
        0.002617873598257468, -0.010457443536933371, 0.019322567952610923,
        0.008383581620020814, -1.1736488517155585e-17, -0.008383581620020846,
        -0.019322567952610895, 0.010457443536933257, -0.0026178735982574663,
        -1.3953190038798642e-5, 0.0006529145824749194, 0.0007277143095146332,
        0.0001430791359304306, -0.0005729268634344419, -0.0007731849171783724,
        -0.0002753997188636426, 0.0004730892727238273, 0.0007982821596999878,
        0.00040702219020987513, -0.00034868683845576994, -0.0007888748654394799,
        -0.0005183549250444592, 0.00021738290807080314, 0.0007539238062446509,
        0.0006072757122889191, -8.967300178083098e-5, -0.000707143883449625,
        -0.0006866712652411185, -4.509309972501523e-5, 0.0006402188196825325,
        0.0007516766439745427, 0.00018825528142066847, -0.000543281545511379,
        -0.0007849987106194638, -0.0003206096905275585, 0.000429925934327329,
        0.0007893842736370419, 0.0004340384958658153, -0.0003145423994345177,
        -0.0007797411693502694, -0.0005404008070217407, 0.00018899506902170216,
        0.0007513806384900484, 0.0006394140549382961, -4.6999118994981554e-5,
        -0.0006905209281720451, -0.0007126182695702857, -9.477736939761942e-5,
        0.0006051617362418229, 0.0007561878349265374, 0.00022306054671995346,
        -0.000511984551123022, -0.0007844460520292472, -0.0003471632731364778,
        0.0004064454743914762, 0.0007968985914632745, 0.00047131769170287734,
        -0.0002781818628694382, -0.0007775153661690702, -0.0005779985498007209,
        0.00013947854782929696, 0.0007278082765622817, 0.0006571931661465992,
        -7.321455089286425e-6, -0.0006648468875287753, -0.0007208950588306246,
        -0.00012382611472384984, 0.0005883084895858838, 0.0007728362235884943,
        0.0002620894396519731, -0.00048508574872766164, -0.0007966331697675333,
        -0.0003928444113100357, 0.00036174108266314505, 0.0007871486143226042,
        0.0005009807229177722, -0.0002370840723585843, -0.000759857092680152,
        -0.000594660071199912, 0.00011013860277736705, 0.0007187554180381895,
        0.0006813362019828201, 3.0022363992004497e-5, -0.0006496235638741069,
        -0.0007461715908840559, -0.00017328376460775004, 0.0005526192125925426,
        0.0007779681960853709, 0.0003011105500138578, -0.0004462556309833488,
        -0.0007887738502902707, -0.00041675879811803264, 0.00033435208707057276,
        0.0007864554513948646, 0.0005304281833078168, -0.00020460042798454552,
        -0.0007574108937409292, -0.0006305095518215351, 6.153693123184202e-5,
        0.0006954401903459574, 0.0007010143842220495, 7.494696223664312e-5,
        -0.0006166504918793731, -0.0007491004403213455, -0.00020269269200424392,
        0.0005293034172213356, 0.0007855586428391456, 0.0003333224927780277,
        -0.0004212803059936649, -0.000799024991752078, -0.0004597282683628599,
        0.00029112259743492943, 0.0007777069763881334, 0.0005629375740076692,
        -0.00015784824210209977, -0.000733448681597489, -0.0006442995478537105,
        2.8903626929513556e-5, 0.0006780463711790634, 0.0007161997677430732,
        0.00010725194221644962, -0.0006010955635576882, -0.0007708293799716483,
        -0.000248732562144854, 0.0004954192079969641, 0.000792193253575239,
        0.00037571829030271653, -0.0003770234965670799, -0.0008036651678238399,
        0.00012689163738724928, -0.0024004609577109827, 0.004149071503701698,
        5.925164872633282e-17, -0.0041490715037018604, 0.002400460957711087,
        -0.00012689163738719968, 0.0008036651678238139,
      ],
    ];
    const result = wavedec(data, "rbior3.9");

    const reconstruction = waverec(result, "rbior3.9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio3.9_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5121808519141926, 0.9419347338915223, 1.2244526752489284,
      1.325891362124172, 1.2492592335275785, 1.03153195275833,
      0.732892094250736, 0.4209505989007045, 0.15402895631027846,
      -0.032247870379295995, -0.1317159210571735, -0.16622871149988566,
      -0.17659661641905045, -0.20848851692787806, -0.29718220219876423,
      -0.455338905632543, -0.6671742404209332, -0.8907110234693689,
      -1.0676657897967927, -1.1384928403093713, -1.0587135792136158,
      -0.8122587137017726, -0.4182545590085486, 0.07068403423101036,
      0.5784482118132728, 1.021403822658762, 1.326489811344776,
      1.4470401027249513, 1.37247602634234, 1.1295445994351627,
      0.774891813785417, 0.3809203082151709, 0.018536943680109108,
      -0.2588728601189806, -0.42628369812734623, -0.4901044925513065,
      -0.4829419423719563, -0.4516599177270437, -0.4420629906101482,
      -0.48437923144261674, -0.5834736635842492, -0.7164547971177018,
      -0.8383725469237872, -0.8945561648155558, -0.8363633137706694,
      -0.636168198671569, -0.29755505458801856, 0.14212814473557622,
      0.6177645433599569, 1.0497322973298053, 1.361279646602965,
      1.4957685717513873, 1.4295342157551092, 1.177177354411269,
      0.7879866433388032, 0.33439772750758356, -0.10462563565600685,
      -0.4611610650534535, -0.6925286891524715, -0.7887094213072009,
      -0.7713310619769893, -0.6847434325301381, -0.5817213519923172,
      -0.5076814032725918, -0.4876312115914347, -0.5193063957786057,
      -0.5742911995960758, -0.6067956027846986, -0.5677254662772417,
      -0.420261434452374, -0.15272655950660807, 0.21481256138099053,
      0.6321695279148265, 1.028725855966326, 1.3289252286202249,
      1.4697837661763153, 1.4160532928733078, 1.1692137555966173,
      0.7679878496526135, 0.2801805756910095, -0.21218844328436975,
      -0.6308234437148931, -0.9177782029812561, -1.0467486443505796,
      -1.0263906073856621, -0.8950597763899371, -0.7085464049565533,
      -0.5241327973962655, -0.38518851908674895, -0.31031318936589686,
      -0.2897970527913947, -0.29021916708771134, -0.26584844454884426,
      -0.17371243198804687, 0.011780778067384257, 0.28868626051538365,
      0.6247024174057759, 0.9626535206971775, 1.2330698523800063,
      1.3707848321507803, 1.3313735883427005, 1.103229410366354,
      0.7121256157525092, 0.2169754374020664, -0.30229307985569975,
      -0.7618489998000434, -1.0919071086827108, -1.2511600795351994,
      -1.2342382759259507, -1.0705085790943087, -0.8147084318705323,
      -0.5319549291038115, -0.28104984352026413, -0.10036960327126432,
      0.00010513609447959649, 0.03870867972330286, 0.05417110884549678,
      0.09212943306072346, 0.18979344270402443, 0.3629701105588507,
      0.599030064188695, 0.8578400110015424, 1.0805893599886358,
      1.2043499047416666, 1.1786658451516465, 0.979878890717373,
      0.6194071705225377, 0.14368998391760565, -0.37439643981906356,
      -0.8506886071973084, -1.2078160683010972, -1.3918220118738,
      -1.3832882832900166, -1.2003038807608684, -0.8926605896034187,
      -0.5288518263364024, -0.1792318772545365, 0.10039038645936005,
      0.28062719477883874, 0.3629830974763994, 0.3759959757564919,
      0.36429200798155476, 0.37363047876707517, 0.4360362067011107,
      0.5590673375943966, 0.7221591660278865, 0.8811083321341159,
      0.9796027492873287, 0.9648208413435431, 0.8030080272867336,
      0.4908807641719474, 0.05972826914021634, -0.42907907166051473,
      -0.8962776295923416, -1.261721757382814, -1.4620889872219582,
      -1.4649375473421897, -1.2756632143822308, -0.9356672799274358,
      -0.512238939596287, -0.08271519516354287, 0.2831150785763917,
      0.5380048635872003, 0.6659995450408247, 0.682940951788729,
      0.6288564093026756, 0.5544464008499683, 0.5053787398847954,
      0.5086211612740614, 0.5644661142692707, 0.6463738485796118,
      0.7086800683411242, 0.7001222841056148, 0.5795775180011197,
      0.3297794312838501, -0.03474010024138052, -0.46778098111245364,
      -0.8999047491367317, -1.2532471560457088, -1.4591256790644302,
      -1.474089945275264, -1.2904050740345343, -0.9383225053401625,
      -0.47953398799496105, 0.006597628475603079, 0.4406424382520064,
      0.7602194467329222, 0.9324637085747302, 0.9588984040585721,
      0.8717188383707163, 0.7226850370150458, 0.5676841145600646,
      0.4510861356025017, 0.39400826273184864, 0.38952839165469255,
      0.406032228706271, 0.3977195007733143, 0.3193954818263416,
      0.14152592475728626, -0.13856465108517918, -0.49249210784780356,
      -0.864944291628814, -1.1853125883487432, -1.384020781427398,
      -1.409485360618298, -1.2414139910091242, -0.8970203702399585,
      -0.4284851822538759, 0.08782096151189246, 0.5677732241963078,
      0.9375933244971385, 1.1492175708992964, 1.1892422049943503,
      1.0793937484636988, 0.8686193848438998, 0.6189996377969353,
      0.3892143775146585, 0.2198547575236286, 0.12432856801948322,
      0.08759996072007437, 0.07292886294404342, 0.03466877426121545,
      -0.06641072206885645, -0.249476568822025, -0.5054272617388309,
      -0.7964776863345233, -1.0638404572430684, -1.2416763884487212,
      -1.273811784507725, -1.1289396522036963, -0.8103414096509531,
      -0.3575081780085825, 0.16093407943056037, 0.6613999750548925,
      1.0632277750215189, 1.3059340190168907, 1.361656202359248,
      1.2398099455507086, 0.9829451479258596, 0.6549915891308288,
      0.32497525475386413, 0.0503809584248634, -0.13564164617122498,
      -0.23008331914959065, -0.25759640040824994, -0.26060525963598585,
      -0.284806445627539, -0.364047275966391, -0.5087154700406029,
      -0.70083599533151, -0.8972977816657726, -1.0404819071155462,
      -1.073591740431507, -0.9567060769463229,
    ]);
    const expected = [
      [
        1.9832635013562088, 2.2488044212877694, 2.4205878407808563,
        2.1656851746446, 2.316185949923173, 2.1656851746446, 2.4205878407808563,
        2.24880442128777, 1.9832635013562085, -0.34840319743259657,
        -1.1561685015467078, 1.6400948207070887, -0.6747341409108369,
        -0.8877674937505714, 1.6667755137426037, -0.9732100145629392,
        -0.5808900257488685, 1.6225322916998997, -1.2308742269308868,
        -0.24866639997556766, 1.5090929936606896, -1.436515980490885,
        0.09462333880049689, 1.3312221553172088, -1.5811767723479422,
        0.4341833842007693, 1.0965167026076768, -1.6585558517275119,
        0.7553616453153362, 0.8150718213991968, -1.6652953122078897,
        1.0443039188293914, 0.49903232912664464, -1.6011312373564681,
        1.288572133887416, 0.16205041856590413, -1.4689037481022797,
        1.4776977481287643, -0.18285718284524316, -2.235184614770357,
        -1.6223587573509377, -1.6223587573509377, -2.2351846147703567,
        -1.214111416666317, -2.2351846147703567, -1.6223587573509377,
        -1.6223587573509377, -2.235184614770357,
      ],
      [
        -0.49555698122961866, 0.9908209258583841, 0.37921694260240013,
        0.5708905412366904, 2.1982199047143602e-17, -0.5708905412366903,
        -0.37921694260240013, -0.9908209258583838, 0.49555698122961844,
        0.15719765271986355, 0.0405163120228458, -0.46149910427000845,
        0.5439586415533483, -0.18545450821350887, -0.3096650692982894,
        0.539507516704946, -0.3311601684935367, -0.13398636432647612,
        0.47821749563758315, -0.43282661643336146, 0.045267249429119125,
        0.369058017145244, -0.48240139858638853, 0.21152246251847653,
        0.2232039138312842, -0.4763144701017637, 0.3494991766186217,
        0.054808837185196406, -0.4157299382913964, 0.44641590086905747,
        -0.12013396030105788, -0.30643590717409847, 0.49300108362322576,
        -0.2850689304294891, -0.15838710089349445, 0.48060276556967796,
        -0.3983251551620926, -0.051015830664289004, 0.4544733964352142,
        -0.4488336305828118, 0.6437879642307396, -0.6747031112768934,
        0.39190404678126906, 4.607859233063394e-17, -0.3919040467812692,
        0.6747031112768934, -0.6437879642307395, 0.44883363058281167,
      ],
      [
        0.44182593618579974, -0.6217852757438938, 0.7979789758360045,
        -0.36291917812922486, -2.7647155398380363e-18, 0.36291917812922475,
        -0.7979789758360045, 0.6217852757438936, -0.4418259361857998,
        0.18669940731138301, 0.08175502021939003, -0.21845629560716817,
        0.11725746732172264, 0.11808806704500514, -0.22089880804727205,
        0.08267483333284815, 0.13619030167445273, -0.213116355214589,
        0.06452170953686648, 0.16196959635047017, -0.21008485739087607,
        0.027310318797591923, 0.1764890420955888, -0.1934612836492042,
        0.007487499576384704, 0.1948031206900704, -0.1849338128927804,
        -0.030052829699005152, 0.2046363066015474, -0.16045846306377232,
        -0.04993636349879539, 0.21431341907455584, -0.1471901316473921,
        -0.08547566413528414, 0.218726198111604, -0.11635327861210601,
        -0.1038193874983034, 0.21913749251752213, -0.09945820653072945,
        -0.13514740017262486, 0.21781781684394178, -0.06415649377022349,
        -0.15047862785280797, 0.208919052243133, -0.045023111501484726,
        -0.17564715999763467, 0.201998755803902, -0.00743834125291242,
        -0.18673076014366713, 0.1843339874267982, 0.01237515867333212,
        -0.20417915849943155, 0.1723780664423386, 0.0499159388057155,
        -0.2101097178843836, 0.14704502393791483, 0.06879845267800516,
        -0.21876518020141839, 0.13100921860964534, 0.10397236398306749,
        -0.21903499747737787, 0.0995886424965424, 0.12038061096558365,
        -0.21838111686043998, 0.08074837801681525, 0.15098469398095296,
        -0.21565848763069387, 0.06417693143069855, 0.1188497142153478,
        -0.17831713477972028, 0.015714776985539067, 0.14834923875015568,
        -0.15373535938461305, 0.15373535938461305, -0.14834923875015577,
        -0.015714776985539008, 0.17831713477972033, -0.11884971421534779,
      ],
      [
        0.0028495876558623187, -0.01075733822946668, 0.0207551939563819,
        0.007844895767685657, 9.486769009248164e-20, -0.007844895767685711,
        -0.02075519395638195, 0.010757338229466675, -0.0028495876558622987,
        0.00016011803511589858, 0.0009778408353356407, 0.0008485848416873469,
        -0.00010251682255262137, -0.0009579514661274934, -0.0008914183665564747,
        3.6113416026790543e-5, 0.0009342061128378601, 0.0009392376172244656,
        4.53118850209951e-5, -0.0008897666738728804, -0.0009692898047681128,
        -0.0001196813411260677, 0.0008395391497134997, 0.0009849537089368292,
        0.00017797662776066283, -0.0008021649374202735, -0.0010090624937165102,
        -0.00024079587063963122, 0.0007649494621570446, 0.0010403143926637345,
        0.00031866965852799114, -0.000708331163937927, -0.0010555532144164432,
        -0.0003915027932053977, 0.0006434199487118779, 0.001053588559964588,
        0.0004461865991390216, -0.0005913137193673369, -0.0010573369400013483,
        -0.0005009541916942505, 0.0005434714125276221, 0.0010702180868210221,
        0.0005702276562259015, -0.0004783966699787237, -0.0010696150878443506,
        -0.000636718535820654, 0.00040294599423542526, 0.0010498184728192962,
        0.0006837681150011298, -0.0003398105034950526, -0.0010328986740519254,
        -0.0007265118127512575, 0.0002849426629798602, 0.001026858716686754,
        0.0007826850596096082, -0.00021577714230480778, -0.001010539563008399,
        -0.0008385154971682573, 0.00013463117136356317, 0.0009739440986075066,
        0.0008744778571497252, -6.485992045813244e-5, -0.0009373994038461672,
        -0.0009020018551367941, 7.065870691986935e-6, 0.0009131652569589952,
        0.000941422317932269, 6.147695987869131e-5, -0.0008823976936111241,
        -0.000983048194306576, -0.00014309292500724327, 0.0008312153334036558,
        0.001005286091671082, 0.00021471957858240024, -0.0007773732890227856,
        -0.0010154009297541984, -0.0002711372805046107, 0.0007368865843010247,
        0.001035505747322253, 0.0003343181832585522, -0.0006939874604574443,
        -0.0010603885019682627, -0.00041114225937567824, 0.0006314693978995001,
        0.001067268244925915, 0.00047978475102645226, -0.0005637894485339977,
        -0.001058953218181109, -0.0005306291504409413, 0.0005100620221128122,
        0.0010584392846790973, 0.0005840096986475464, -0.00045823000448927317,
        -0.0010652071703377705, -0.0006510906592930004, 0.0003884542214927208,
        0.001056215067199098, 0.0007121791639277762, -0.0003112999270574753,
        -0.001029701505750442, -0.0007536600462513616, 0.0002481977158962521,
        0.001008611763465485, 0.0007934112923794398, -0.00019128350389500406,
        -0.000997140327291693, -0.0008464352319003407, 0.00011888361312900137,
        0.0009729196157981176, 0.0008959774689096677, -3.723468504643747e-5,
        -0.0009296887834844225, -0.0009249836073799977, -3.0794759671883996e-5,
        0.0008894089653012406, 0.0009481554969218896, 8.856453550502928e-5,
        -0.0008608157892536935, -0.0009837300407030396, -0.0001587109042602768,
        0.0008231214452107056, 0.0010185770552686667, 0.00023958745769968662,
        -0.0007658166421500552, -0.0010329003981923253, -0.0003078248542229242,
        0.0007089826998207464, 0.0008490833216001472, -0.0007423284733173033,
        0.013937300041991545, -0.05807318494501455, 0.13236377069818037,
        -0.13236377069818048, 0.058073184945014615, -0.013937300041991538,
        0.0007423284733172907, -0.0008490833216001433,
      ],
    ];
    const result = wavedec(data, "rbior3.9");

    const reconstruction = waverec(result, "rbior3.9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio4.4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5028950645182508, 0.9272311670631836, 1.210820658627578,
      1.3203526256404656, 1.2571171365901854, 1.0546977234355872,
      0.7693463069531086, 0.46553154288837106, 0.20029982568432564,
      0.010324962156367246, -0.09520720754848194, -0.13424282037089338,
      -0.1443052458519658, -0.1698423812383496, -0.24786516345584736,
      -0.39569205464115653, -0.604070768242114, -0.837572971014902,
      -1.0422961113062699, -1.1590272072351404, -1.138599769969615,
      -0.9555669212638485, -0.6166773373982802, -0.16188900746991194,
      0.34251957938616595, 0.8172335557181101, 1.1864880707858447,
      1.394035499275579, 1.4147081997899278, 1.258859618943481,
      0.9687017772158342, 0.6075289811304333, 0.24453685563567024,
      -0.06101316394585937, -0.2724269561544932, -0.38200176142438313,
      -0.40982575021911205, -0.39546959400101955, -0.38487432864066334,
      -0.4159358996207013, -0.5065925286580095, -0.648561407065023,
      -0.8084134331010414, -0.9357863037262351, -0.9766930020998487,
      -0.8885493960223303, -0.6530586745327943, -0.28357706883971834,
      0.17507353311174226, 0.654517431885311, 1.0767118002786402,
      1.3705591358262659, 1.487293689136997, 1.4109612026807443,
      1.1614909513546714, 0.7896556505116114, 0.365183050166598,
      -0.03906487918677937, -0.36300214487916826, -0.571501005690827,
      -0.659997806635453, -0.6523410264556161, -0.5916474060386192,
      -0.526672030277879, -0.4972966493607073, -0.522924388244536,
      -0.5967948792089728, -0.6876985486026204, -0.7486598804469865,
      -0.7303582091899615, -0.5958152927371638, -0.3325151621392996,
      0.04127228208373418, 0.47776573458362964, 0.9084544233524126,
      1.258411395567675, 1.4627552520069604, 1.4813027163401697,
      1.307858028327939, 0.971869556366333, 0.53203208904629,
      0.0633672090690569, -0.35911030219598844, -0.6762249543392053,
      -0.8562166868782081, -0.8993898569553889, -0.8349008568305024,
      -0.7107044543183908, -0.5793632565264393, -0.4834197917582766,
      -0.44409056153365933, -0.45615449859201884, -0.4903001768661991,
      -0.5022729315477434, -0.4464095306398251, -0.290006208582998,
      -0.02472425056718608, 0.3280413971789316, 0.7193997750570031,
      1.082463876964269, 1.346926828327792, 1.4552193600233025,
      1.3763081187236832, 1.1137269179255567, 0.7058145479791043,
      0.2180220764790332, -0.2709184815661168, -0.685682103985327,
      -0.9699313524523068, -1.097120142501685, -1.074047304482391,
      -0.9364851242463078, -0.7381605185246205, -0.5359868109285153,
      -0.3753300933179756, -0.2790279687444746, -0.2428806044280145,
      -0.23865804090922574, -0.2237365431678995, -0.15477675971976718,
      -0.0018154728968641787, 0.24097690507325337, 0.5507881839730318,
      0.8792436554665564, 1.162484717018142, 1.3358671150996453,
      1.3496925158389086, 1.1820708810954401, 0.8456682677864402,
      0.38656508459140326, -0.12462998048569288, -0.6073715586802528,
      -0.9880393013759505, -1.215081645903164, -1.2688821008840345,
      -1.1640910666441104, -0.9440184120346019, -0.6686230778513454,
      -0.39918371490827526, -0.18350558949032791, -0.04532497655961232,
      0.019534342978620667, 0.039436491975536905, 0.056757385688235185,
      0.1140142974636813, 0.23999497978705225, 0.43957791437058813,
      0.689994718724984, 0.9446432771494413, 1.143628549578772,
      1.228473109231624, 1.1573385929779871, 0.9169116344756164,
      0.5278845312106808, 0.04251169364487764, -0.46533630129868536,
      -0.915350805517167, -1.237629171666252, -1.3871982942139294,
      -1.3527916992079785, -1.15785700111564, -0.8536671526722049,
      -0.5063284857328261, -0.18094503398582007, 0.07315041579151849,
      0.2325112390678222, 0.30266310895320664, 0.3135820937064189,
      0.30891242665349117, 0.3318467147378364, 0.4114201047620074,
      0.5528456117565914, 0.7344729471887635, 0.9122513340319285,
      1.0306465377913963, 1.0372899203279617, 0.8976448501131443,
      0.6059154735002485, 0.189313622742964, -0.2955777816223243,
      -0.7736550408756501, -1.1668737062074204, -1.4108852021469993,
      -1.4687705653271461, -1.3386013473380467, -1.0530532966050006,
      -0.6712295051483355, -0.26473745068601945, 0.09855893077594885,
      0.36916532093694676, 0.5254673099224345, 0.5759459411558134,
      0.5537654250152244, 0.5053137828028895, 0.475780139919094,
      0.495569386371633, 0.5711083934211824, 0.6824521141329117,
      0.7883424428945006, 0.8374502977457651, 0.7829266445949419,
      0.5965063057138806, 0.27847360263778775, -0.13920189766655816,
      -0.5975653535964275, -1.022265470500884, -1.3393535053700942,
      -1.4915364144439596, -1.4509761783857438, -1.2255414946850507,
      -0.8569981694650931, -0.4115796291099926, 0.03477551660713152,
      0.4129531806926464, 0.6749989742010237, 0.8028794065749096,
      0.8097026001871072, 0.7333209964476628, 0.6241311358290924,
      0.5303095648935143, 0.4843251774839251, 0.49419929491532893,
      0.5417412210971835, 0.5881836357571472, 0.5857339020324097,
      0.49202519619376783, 0.28368197966321174, -0.03459688139581385,
      -0.42793201548736853, -0.8368880371090602, -1.1896370278666053,
      -1.417807231112957, -1.4722013856628737, -1.3345509160036704,
      -1.0224056464463118, -0.585914476809206, -0.09722084995582281,
      0.3650100863213651, 0.7322424793099354, 0.9599456072618249,
      1.035451715852615, 0.9780584335511806, 0.8315623250364905,
      0.6512728021908951, 0.4888934085774398, 0.37913894630824363,
      0.33146525953818473, 0.3289506144431783, 0.33452206969383286,
      0.30283231681290707, 0.19463766560338563, -0.010127281151535605,
      -0.30407235488343104, -0.6511666893259425, -0.9931519184124725,
    ]);
    const expected = [
      [
        3.478473454066429, 2.914407734669822, 3.129102705781188,
        2.959348570739809, 2.5260520743483794, -1.0070013513109104,
        -0.09490709726217646, 0.7655354926522896, -0.5969584512015981,
        -0.19806448484426578, 0.7537261404907454, -0.5033672967904995,
        -0.25406320224649426, 0.7227475434291333, -0.443013892718055,
        -0.2784483723228997, 0.7094801025685447, -0.4186003898377616,
        -0.3378848588690244, 1.2153637578573324, -2.3557399539443686,
        -2.548028669322105, -2.9301091787522924, 0.12448920879851422,
      ],
      [
        0.328255326575564, -0.11683646643449068, 0.15682528838086773,
        0.029682184906363943, 0.6483661747057289, -4.161948751848234,
        3.3090243903396095, 0.9242741277542685, -3.970156309210869,
        2.660279377136652, 1.328541641432528, -3.6959301521890904,
        2.1894119301975516, 1.4030272488611033, -3.443398256795082,
        2.039491322837451, 1.365601696915127, -3.4726297293148884,
        2.321186456974505, 0.41537515246281853, 0.030315529124718965,
        -0.2943286897207099, 1.011908016137169, -3.2405776540422995,
      ],
      [
        -1.024030888147795, -0.23225565886127594, 0.6758395057289652,
        1.6096039084972502, -0.039687050178048536, -0.40712789504815744,
        0.5333079237670683, -0.2806772824327709, -0.37568074856357475,
        0.9553249268691022, -0.8340271561245127, -0.10366338729455214,
        1.1755361442094279, -1.391089645456636, 0.37516446819987986,
        1.1420709701418872, -1.8398271373191013, 0.9735922883473517,
        0.8511897274326259, -2.0883552426356937, 1.58122691606617,
        0.3480983825878239, -2.0823938637581247, 2.085429984675757,
        -0.28160297797387995, -1.8155843719959794, 2.3926826126255674,
        -0.928136209324071, -1.3307153123246667, 2.446323749303376,
        -1.4783490078776302, -0.7116240259907254, 2.237152459968519,
        -1.8720748323413918, 0.10806747766862682, 0.8416800355007592,
        0.025740144783322486, -0.47071002790337285, -0.052616031368406126,
      ],
      [
        0.9957285056996773, -0.6847815359632724, 0.36243229054397,
        -0.28103368767451653, -0.18939843710976834, 0.27942152068168713,
        -0.19777217663130997, -0.0331336682575704, 0.36520701188775584,
        -0.22115520630712293, -0.24848399023514145, 0.2990966612119947,
        -0.07247830128883852, -0.15724082140291631, 0.34752520379380986,
        -0.08797790916903951, -0.352543634003709, 0.257144670107337,
        0.074508762367714, -0.23758320822745915, 0.26969022977655877,
        0.05366121754636889, -0.40360789858092155, 0.16094303726864717,
        0.21587352267922283, -0.25899771368672847, 0.14581745569748505,
        0.17632576052947824, -0.3918895518950041, 0.029404143293085296,
        0.3253453588237242, -0.2175375301802642, -0.0012559306954256777,
        0.25620205645917216, -0.31947800622511874, -0.11184255836997883,
        0.3826815762083802, -0.1212207086500698, -0.14430223622361102,
        0.2776188790016509, -0.19994322658038208, -0.2353150876815292,
        0.37750680950706, 0.011491540666641268, -0.25686758443942204,
        0.23602215398355203, -0.05576145969562475, -0.316895001790348,
        0.3112803053778956, 0.1551980763043766, -0.31828939218409413,
        0.13884028995433756, 0.08594878660990045, -0.34040529880992615,
        0.1970178246108105, 0.28237789413304876, -0.3176150111366418,
        0.004075936882201633, 0.19857147852675563, -0.3006815656938714,
        0.05682093192168181, 0.36861249634187, -0.2556780331241858,
        -0.14310863656659709, 0.26327560124426863, -0.2784261528247866,
        0.34227777329401793, -0.5826052144915027, 0.6602616728883065,
        -0.3313434181410294,
      ],
      [
        -0.0867272614851527, 0.2012591278427462, -0.07104595733927338,
        -0.043777492019674485, -0.016353968696410644, 0.0050062877185997265,
        0.019322131356441737, 0.013831619049645954, -0.005201077512104116,
        -0.018661384028623215, -0.012847574849476118, 0.007391129276988408,
        0.023036418511096085, 0.01874003210810027, -0.0026041124119667858,
        -0.02226398132203711, -0.02288028905908348, -0.004446732156173819,
        0.015839621831332695, 0.01967522860748358, 0.004612544361995784,
        -0.013958242222659553, -0.017580687398375712, -0.002317183403509851,
        0.017412704072388336, 0.02237851705868125, 0.006764446777204881,
        -0.01606338262176524, -0.02573962649438834, -0.013707539053774621,
        0.008900342586299542, 0.02165725255195783, 0.01378041815870052,
        -0.006081843608299749, -0.018300637986199585, -0.010940168745095048,
        0.008923304418187804, 0.02188232189921257, 0.014603767041635358,
        -0.007350975307265292, -0.02439554178859896, -0.02100698275152978,
        -0.00015218690999164314, 0.01943604772026119, 0.020595647331255112,
        0.003495245552029654, -0.014865619872273049, -0.016854610588628048,
        -0.0008484845070929926, 0.01731104319616518, 0.019394200960169805,
        0.002199015472288835, -0.01910738638178619, -0.024946410263746232,
        -0.009572397433084745, 0.013467714849248719, 0.02379704253662266,
        0.012976372459770116, -0.007923926121055413, -0.01895282603812265,
        -0.010077107186782976, 0.009497268669094503, 0.020195297865890638,
        0.010754876903240427, -0.01088108303709353, -0.02476307528597804,
        -0.01754393853903575, 0.00491947096275195, 0.02280833217677193,
        0.020581634201699506, 0.0012090458025860867, -0.016852795089552633,
        -0.017041048170740952, -0.00011130505382443527, 0.016824321856529323,
        0.016675000368700194, -0.0012782598703953828, -0.02047489763351187,
        -0.022524379436798674, -0.004551902711364346, 0.017847421598945555,
        0.02488553986736364, 0.010800367425027366, -0.010970602089953575,
        -0.020449389085652275, -0.009726462462769883, 0.009891002292501283,
        0.018819399965765843, 0.007880048172634033, -0.012877106553607413,
        -0.023537939977070356, -0.01311450074628535, 0.00988497080038233,
        0.025087431962304237, 0.01902837769546471, -0.0024414444090417597,
        -0.01968666372005365, -0.01755866770138075, 0.0006819231728606872,
        0.016766051404295466, 0.014858912007519945, -0.003391404683316144,
        -0.02036071006901939, -0.01910896074917647, 0.00046015012165573355,
        0.021163358662596738, 0.024328321688112126, 0.0070958040927445246,
        -0.014929553657503543, -0.02215651380154965, -0.009083513356493954,
        0.010891003985246929, 0.018338679217726455, 0.006203728501039691,
        -0.013563214603644425, -0.021363392739412616, -0.008611468172248097,
        0.013870581442119254, 0.025689249595068603, 0.015809598693175213,
        -0.007113283347491506, -0.022682017242315757, -0.017579247142251658,
        0.002297065463938236, 0.017665347573185858, 0.014110422836216822,
        -0.004402247593610024, -0.01941581712728117, -0.05018537106612947,
        0.12112979080468156, -0.03437945151984022, -0.030366048462330056,
      ],
    ];
    const result = wavedec(data, "rbior4.4");

    const reconstruction = waverec(result, "rbior4.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio4.4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49092217204505906, 0.9051279486593677, 1.1822986509351145,
      1.2909620040702645, 1.2340265067496412, 1.0461564763945674,
      0.7837674502332667, 0.5102424412795027, 0.2801300686055971,
      0.1262960810429577, 0.05321010264902931, 0.03796139222643698,
      0.03861384446529001, 0.007633477953298273, -0.09317401521275598,
      -0.2801648374383263, -0.5411269348886987, -0.8361770892253538,
      -1.1061953613355158, -1.2867722923747957, -1.324213473559149,
      -1.1895823792743554, -0.8872106055729176, -0.45545478660850264,
      0.040606013560018084, 0.5228397348507661, 0.916823335447348,
      1.1676560804749685, 1.251022762039717, 1.1768919668179358,
      0.9850691265354663, 0.7338458628016478, 0.48468849454242363,
      0.28686315732516954, 0.16586494841814814, 0.11851430231783283,
      0.11586133398172702, 0.11303487816380606, 0.06339470038737022,
      -0.06675724938608502, -0.28679862457353417, -0.5767891737482007,
      -0.8902778809380492, -1.1643458583858086, -1.3344579699304533,
      -1.3504431808025288, -1.1895941228919924, -0.8635561862584614,
      -0.41719715977030425, 0.08037041478461213, 0.5504972176009449,
      0.9218981095097883, 1.1456692166168436, 1.204820787252345,
      1.116097795593329, 0.9237831880559202, 0.6871688792894304,
      0.46493744177950724, 0.3004326777819699, 0.21152732995081086,
      0.18759197137049083, 0.19423694390087526, 0.18450347086793664,
      0.1135260037649582, -0.047205887875403585, -0.2997647910656594,
      -0.6166038160796334, -0.9452439487180422, -1.2197899557747751,
      -1.3764794885248839, -1.36941289312513, -1.1825208396375944,
      -0.834728805515764, -0.3769472860823711, 0.11846367339969657,
      0.5732438950638997, 0.9200455997219648, 1.1164538767360628,
      1.152866167276601, 1.052420530594181, 0.863146392723679,
      0.6444419133426342, 0.4513744087837543, 0.32080590323231095,
      0.2628401057235135, 0.25970024951951, 0.2722316456148881,
      0.25226392000853065, 0.1575617158516739, -0.0345794381348733,
      -0.3187027580110103, -0.6598819291431699, -1.000232221266611,
      -1.271743200512902, -1.4123086768518156, -1.3809834794531382,
      -1.1686468576190603, -0.8013636962802446, -0.3355301162792547,
      0.1540802511302677, 0.590497935060817, 0.9110555725697346,
      1.080225568181659, 1.0957468252918365, 0.9866730954478776,
      0.8039922622547643, 0.6063091778217395, 0.44429177721982005,
      0.3478492144210865, 0.31927656030114676, 0.3340510600625655,
      0.34899343044872067, 0.3156137279295605, 0.19512459652382996,
      -0.028836041899216402, -0.3431632056558164, -0.7058808457824911,
      -1.0543944624687294, -1.3194658697741097, -1.441500740846623,
      -1.3851168448918425, -1.1483497594021101, -0.7641580809869201,
      -0.29378571670118414, 0.1864501698426232, 0.601754778433557,
      0.8948173116608107, 1.037296490849076, 1.0341202007469743,
      0.9196932549156791, 0.7471282469757912, 0.5733444962117624,
      0.4438849844517916, 0.38132994648338714, 0.38023381154690894,
      0.4098222488448931, 0.4236868998334219, 0.3739135134110721,
      0.2259311210729918, -0.0298331510965128, -0.3726145377990354,
      -0.7538147879132058, -1.1068893765299448, -1.3622735069632537,
      -1.4637005755014478, -1.3818764277700266, -1.1220949392479111,
      -0.7238611609438044, -0.25255721396269765, 0.21485007308738907,
      0.6065944187277443, 0.8713212805457474, 0.9880711636718725,
      0.9687039413265404, 0.852331717765573, 0.693324237612224,
      0.5460431183963266, 0.45024970585556107, 0.42091964804463367,
      0.44504132545689146, 0.48616920936830105, 0.4955050714758191,
      0.42659602409412545, 0.24979542813835706, -0.03732963887897511,
      -0.4064505193916134, -0.8028661056238132, -1.1568946159943059,
      -1.3995466723995598, -1.4786478009460915, -1.3714262520878648,
      -1.0904289109354517, -0.6812633663287078, -0.2126786966079726,
      0.2386136234556248, 0.6046874778703967, 0.8406593451335642,
      0.9330407372996652, 0.9002657387818526, 0.7854400569358756,
      0.6433016138291183, 0.5248146573708661, 0.4633804597615107,
      0.4661987061182788, 0.5129703957590719, 0.5622368284963948,
      0.5636807811592079, 0.47317412147431664, 0.2666318760673957,
      -0.050989315674550006, -0.4439989785233641, -0.8521969717894805,
      -1.2036185215994424, -1.4307397697324864, -1.4861804510716088,
      -1.3540285488805348, -1.0539714615109248, -0.63718501995437,
      -0.174963246106698, 0.2571410876202358, 0.5957999912701493,
      0.8030235525030154, 0.8727760739423438, 0.8296124533789994,
      0.7198586190340247, 0.5977229855051345, 0.5099772475034331,
      0.48317065490939404, 0.5166622709460404, 0.5832444532806219,
      0.6371715826389652, 0.6274975178078769, 0.5132476247643563,
      0.27645617132640166, -0.07038580014928325, -0.4845314488271912,
      -0.9009613656100712, -1.246311426743667, -1.4553888223707285,
      -1.4862372621653157, -1.3300399803925618, -1.0134067627434027,
      -0.5924645762962638, -0.14019126770131746, 0.26990797250561194,
      0.5797968341504651, 0.7587034834718196, 0.8079196929199355,
      0.7575786818471036, 0.6564045953665002, 0.5571827728531449,
      0.5017530075520447, 0.5094140797505813, 0.5717273964094794,
      0.655050058268273, 0.710133612154852, 0.6862995375204353,
      0.5465089161799738, 0.27938505292118604, -0.09500867567211224,
      -0.5272736149357965, -0.948317174368311, -1.2842763655410372,
      -1.4731180891596138, -1.4788585289658656, -1.2999065208582523,
      -0.9694735669120079, -0.5479466033269921, -0.10909928734596969,
      0.27647258954303755, 0.5566437402793615, 0.7080822166008085,
      0.7391766966132525, 0.6850149316364008,
    ]);
    const expected = [
      [
        3.4042067651296386, 2.82870158945382, 3.0186080869926473,
        2.8513817109235995, 2.7281049336733463, -1.3788014480494462,
        0.3901947206856992, 0.54185503125193, -1.0430352167564843,
        0.8098206023576662, -0.052350439446542565, -0.7195706478472382,
        1.0191999372593155, -0.6401688996768422, -0.2055815680383375,
        0.9550765876036035, -1.041013934344786, 0.34831726525067197,
        0.6214905224959574, -1.4506628264194865, 2.8419339781303012,
        3.2926299550038487, 3.4559563597501626, 0.057431562844572084,
      ],
      [
        0.32677743580193275, -0.1014272243421902, 0.11878215763575961,
        0.12468282773636491, -0.005111940498633921, -3.303353814465566,
        4.125822909342748, -2.089682428576786, -1.123035593273909,
        3.2662183692053146, -3.2561375490711297, 1.302397562946948,
        1.5390897997756912, -3.633094105896348, 3.370631284242331,
        -0.49693203140116593, -3.058656243509149, 4.394998170678096,
        -2.4614821945921888, -1.1465774903164243, 0.10747694725061067,
        0.17825299361235095, -0.8546494911135281, 4.230415580082089,
      ],
      [
        -1.017126399620415, -0.2240803568757389, 0.6528473889131681,
        1.567053030499502, 0.05381913727397843, -0.6355774059966264,
        0.7712336346189589, -0.22191035012838933, -0.8463463665656195,
        1.446942761876405, -0.7324119501537781, -0.9044615522547089,
        1.9440696383429363, -1.204965966803325, -0.8050924884661351,
        2.2037610176512086, -1.5647568202677187, -0.5818246209925804,
        2.1986612625414765, -1.7489404824685426, -0.28696751529876946,
        1.9362441785985338, -1.7166631504194085, 0.017602578262322754,
        1.457216918603318, -1.4561078780383465, 0.27094473397588437,
        0.8293456262629246, -0.987451267858141, 0.42324448721178665,
        0.13762962047991284, -0.36120399856432966, 0.4441251226781484,
        -0.5384713018686406, 0.3433662771423846, -0.15520148031974002,
        -0.0925932340178864, 0.5052657333185016, -1.4988820684856767,
      ],
      [
        0.9685417092723762, -0.6684731598039448, 0.3528923313939521,
        -0.2790063279323395, -0.17043154874266397, 0.280087697671906,
        -0.22476696853944622, -0.03642475404345561, 0.3755198246617956,
        -0.21202591758829853, -0.21543140017696916, 0.28874876010974715,
        -0.13553934674740323, -0.1569697802623726, 0.38234883436648587,
        -0.0774678323473218, -0.3091285844932785, 0.2519714817328194,
        -0.025704666772170287, -0.24997972755723855, 0.336395794894259,
        0.06878651497568175, -0.36073745395633594, 0.17338447902634038,
        0.08714202202076773, -0.30234789573500553, 0.24498102874172875,
        0.20623994176756905, -0.36173011081881923, 0.06434494551835646,
        0.18501632056473408, -0.30726102337492617, 0.12185521833573747,
        0.31560078393110363, -0.3108862387324507, -0.05892483304411135,
        0.2523054702402263, -0.26514202494292366, -0.01485650814031969,
        0.38156847191622373, -0.21455199441974895, -0.17775011818594277,
        0.2781662230481985, -0.18350383034256346, -0.14533629916015603,
        0.3950391283452966, -0.08578408231041991, -0.2738052956903659,
        0.25819755284439283, -0.07574207117612748, -0.25098334490535074,
        0.35440826667347164, 0.05750005739092541, -0.3318860509094438,
        0.19513514116183878, 0.04094736573557744, -0.3171217207680024,
        0.26578058110441277, 0.19509752479650286, -0.3422365495297633,
        0.09846148443068226, 0.14820974848694773, -0.335107880698231,
        0.14205771363920333, 0.30701274018660785, -0.31226683424453605,
        0.10036220727862101, 0.1317309273639744, -0.050551547390533615,
        -0.23688853892298936,
      ],
      [
        -0.08508736993479499, 0.19636900444101438, -0.0696376244423206,
        -0.04311144266747207, -0.015646234229193912, 0.0060363608453863765,
        0.019957409793173585, 0.01340476412383625, -0.006596528118492349,
        -0.02012514161271922, -0.01343290658680678, 0.007831113516960274,
        0.0237910698294785, 0.01906631067541333, -0.00262590955444654,
        -0.021798162384024017, -0.021352966686487763, -0.002483136958196311,
        0.016644795773327323, 0.01813383572927134, 0.001218951306997472,
        -0.017168071087156546, -0.018626075795155465, -0.0009192484526614163,
        0.019699921293694744, 0.023725460352783348, 0.006829363521439258,
        -0.015921185279362364, -0.024075901530440792, -0.01086192409759864,
        0.010647619273836312, 0.020027168040247408, 0.008818086845761675,
        -0.011580441625409502, -0.020877924439847432, -0.009309196502687172,
        0.012900259785618722, 0.025020045115871845, 0.01533451874543322,
        -0.007725507591093632, -0.023369465816669273, -0.017840760621382575,
        0.002840485202720587, 0.018759878159808466, 0.015011991933294833,
        -0.004253235626062104, -0.019900237214981156, -0.016112816464003813,
        0.004411952432661087, 0.02279470817247387, 0.02168122878022063,
        0.0016318063833141716, -0.019287110636038024, -0.022353024076496288,
        -0.0056165193376941855, 0.014490210583378203, 0.018827505557532848,
        0.0036626427763173965, -0.015894014758897033, -0.02035464894534418,
        -0.004510630722378876, 0.01740298212243282, 0.024973307160193144,
        0.010820043368714678, -0.012377088632620513, -0.02368538740703475,
        -0.01345025552908977, 0.007838188630013496, 0.019655652725452694,
        0.010931922134765348, -0.009515571875866125, -0.021452111819264798,
        -0.012564559994154744, 0.009653089569360365, 0.02475652585399911,
        0.01852831807997931, -0.003605180267762166, -0.021586939673974383,
        -0.019464957888054968, -0.00020550138101636112, 0.017345195503160916,
        0.016422833756394264, -0.0017745772599096106, -0.01929864470927795,
        -0.01859035316707494, 0.0006873030462751437, 0.021083604558345678,
        0.023656485645894065, 0.005784448454553011, -0.016310304562416625,
        -0.022722259940584518, -0.008426923497786924, 0.012227148408037757,
        0.01927906128912167, 0.006120489812873164, -0.014275464555215587,
        -0.021741622868774072, -0.008187165030307702, 0.014504893034595755,
        0.02547539311824183, 0.014449890723425417, -0.008578367932945717,
        -0.022683892978659914, -0.015570677396744961, 0.005066466723546222,
        0.019049939122121086, 0.012946169069699622, -0.007190479629365672,
        -0.02160733954193765, -0.015690651645605055, 0.005986238633988443,
        0.023732883777864283, 0.021147101444291157, 0.0005187482961507422,
        -0.019295611945448633, -0.020528934401731445, -0.0030519746216358928,
        0.015759333918747963, 0.017649503829504053, 0.00084623766899488,
        -0.01826879054924852, -0.020758427606249186, -0.0032337275692204508,
        0.018689967470810597, 0.024911658245287967, 0.009681469722469638,
        -0.012999589196630662, -0.0258820240041759, -0.014059691005045482,
        0.051806273964158586, -0.029339672182475122, -0.020375494213201686,
      ],
    ];
    const result = wavedec(data, "rbior4.4");

    const reconstruction = waverec(result, "rbior4.4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio5.5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.50862022509277, 0.9374690275222742, 1.2232819937696877,
      1.3319320926091374, 1.2642574835961424, 1.053825991960668,
      0.7573415225091463, 0.4401768803833744, 0.1606695436745244,
      -0.04294122334196543, -0.15978147784391225, -0.20616370823348507,
      -0.21821629937825832, -0.2394015452413376, -0.30629119216343553,
      -0.43639736923162714, -0.6213190260153201, -0.8270957660017899,
      -1.0018070170570708, -1.0885819053880024, -1.0407664007936004,
      -0.8353886331195854, -0.4814269053815236, -0.020631448791638668,
      0.47952731632974993, 0.9392667123115056, 1.2831555030755266,
      1.4561064320257087, 1.4349082482852538, 1.2325773329931367,
      0.8945464206367859, 0.487683203636304, 0.08485590317388614,
      -0.25118979344436454, -0.4807646511813063, -0.5939475269063835,
      -0.6096297492493878, -0.5673796703131061, -0.5144074373572055,
      -0.4911150317033989, -0.5190343073598571, -0.5943093456316226,
      -0.6884340449704341, -0.7560769969480111, -0.7479876126536622,
      -0.6256443076645791, -0.3738150425705745, -0.0076792122873522994,
      0.42750872238152765, 0.8643800467890427, 1.227290172463898,
      1.448793600859832, 1.484814510057192, 1.3248440438288014,
      0.9946753654010871, 0.5509851591049935, 0.06904119661617308,
      -0.3735278419937159, -0.713031401120861, -0.9122365632420956,
      -0.9662255495571725, -0.9003770535480252, -0.7612109152606183,
      -0.6025875040434694, -0.4708677678463144, -0.3928420635915559,
      -0.3694792582951799, -0.37702593364464065, -0.37508393122420225,
      -0.31949280274054026, -0.17659636392235806, 0.064905441654322,
      0.38773000510775907, 0.7472130331622753, 1.079862643690687,
      1.3173178292050018, 1.4023614756408596, 1.303064089380534,
      1.021535208910505, 0.5950398012787306, 0.08908170612227265,
      -0.41599100053665183, -0.8417270076984434, -1.1277175234912826,
      -1.2433626862814182, -1.1925594735059601, -1.010353886173543,
      -0.7525658031815732, -0.4810961043080066, -0.24864133315366316,
      -0.08662209959341205, 0.0007377577736072949, 0.0348415425839237,
      0.05424185030574327, 0.10159944913899899, 0.2095842122932341,
      0.38949004854636704, 0.6256418770482813, 0.8771927899274247,
      1.0870157904831994, 1.1955634952429026, 1.1562626777853684,
      0.9485596877889741, 0.5852551278612923, 0.11213587208570051,
      -0.40020854084760354, -0.8705760960649092, -1.2240529750069975,
      -1.4076470901211102, -1.4009714660119579, -1.2194931681342702,
      -0.9096695468459293, -0.5372594315991246, -0.1717357981117194,
      0.1293663568379516, 0.3323795046081759, 0.43290673881497355,
      0.45356636510962384, 0.4348843066940502, 0.42186024488520074,
      0.4498036854725965, 0.5331904923494382, 0.660492324497399,
      0.7963834149173769, 0.8908220617382024, 0.8927191947151538,
      0.7646943228744061, 0.49508768902147227, 0.10403370899003822,
      -0.358150651209416, -0.8201074080052536, -1.2040731982189812,
      -1.4425832722094476, -1.4932674003257451, -1.348189867138668,
      -1.0354900398835338, -0.6129383634825989, -0.15497544366217575,
      0.2636339474984889, 0.5836107659481791, 0.7726929432946853,
      0.8302441772133434, 0.7840386080942608, 0.6802690826105188,
      0.5694965867421736, 0.492233271841144, 0.467890560940781,
      0.4899211478926269, 0.5283693183969154, 0.5391261472116069,
      0.47744881412644, 0.31218512253391706, 0.03692850817406029,
      -0.3249278209528627, -0.7227505016019954, -1.0884376798987008,
      -1.3511695722537982, -1.4536162352179662, -1.3656604132847683,
      -1.0922501172424681, -0.6733951146323675, -0.17621895680020902,
      0.31909584610873687, 0.7361543301860325, 1.0180086550708671,
      1.1379661381650634, 1.1030928325272091, 0.949766417835888,
      0.7325837371713235, 0.5095396564796884, 0.32726597698628507,
      0.21003830960507075, 0.15525008418663194, 0.13637313678645607,
      0.11249792872700626, 0.041858784790744674, -0.10427454912206957,
      -0.3310602939636993, -0.6157788531963384, -0.911052156227633,
      -1.1549616274794787, -1.2856611412626833, -1.2568957691236362,
      -1.0505439093660756, -0.6829776167409638, -0.20351922119910548,
      0.31480454509180344, 0.790123490291692, 1.1487318034211205,
      1.3402427212728736, 1.3473394767886908, 1.1878915929026963,
      0.9090677615013514, 0.57501927935717, 0.2512500014711498,
      -0.010450609011984191, -0.1828406891601839, -0.2672711049577596,
      -0.2901316805110242, -0.29281935197064834, -0.31798379613633876,
      -0.3957342585940815, -0.533481148999051, -0.7121414569707994,
      -0.88979680535235, -1.0119704736543753, -1.0259697314424003,
      -0.8956568818638051, -0.6128419853807875, -0.20227948185590822,
      0.2811933808694278, 0.7629019167058091, 1.1636534045906397,
      1.416544417779874, 1.4812721917366842, 1.3525482015451669,
      1.0606315890092013, 0.663906200074115, 0.23534603369061907,
      -0.15382529660728883, -0.44933513903722977, -0.6243121763936395,
      -0.682600551808132, -0.6543558022653667, -0.5852723438598253,
      -0.5223686318423053, -0.5000843749933845, -0.5303196682009628,
      -0.5990031016373596, -0.6700795637772318, -0.6958871470222837,
      -0.6312312441033539, -0.44748240335663664, -0.1429722223166628,
      0.2531450770781868, 0.6847796668281311, 1.0798164519750237,
      1.3655473268989695, 1.4849565711011254, 1.4099263958645774,
      1.148138319014941, 0.7419549210557347, 0.2595034009823804,
      -0.21993191219555733, -0.6227329707649731, -0.89599992947237,
      -1.0173125555340157, -0.9970122801956003, -0.8726750319720352,
      -0.6973690009128028, -0.5248017349455936, -0.39518318715565054,
      -0.3253890404029013, -0.30586696453611295, -0.30497754435399976,
    ]);
    const expected = [
      [
        4.599703726583827, 3.440175123600333, 3.5676834785793665,
        3.6089233456117418, 3.884244891933866, 2.290773699718282,
        -1.1012902079695364, -0.3260033301552333, 0.7601775799205691,
        -0.17708686235097837, -0.6266658153954451, 0.645025126689438,
        0.14194213925682264, -0.7454870203523442, 0.41605466837641364,
        0.4239587359251007, -0.7261671900419122, 0.12875281652977252,
        0.6255688309101199, -0.6847612492459182, 0.5281016559269572,
        -2.3312331591075677, -1.2589372686599036, -0.6817821460753093,
        -1.6413916411667275, -2.0477300496233175,
      ],
      [
        -0.41309021550797415, 0.07211277678369027, -0.054682090746752135,
        -0.03136484491975555, 0.27607743448722355, -1.2705442185684286,
        5.213220815127286, -2.1866670624394042, -3.389179268501609,
        4.710296386908642, -0.08590644015079864, -4.623132557645678,
        3.4843921994155322, 1.9947745872336242, -4.885675074955191,
        1.6504113075832434, 3.5357397084098534, -4.221041475479417,
        -0.24223812056105545, 4.305094075661365, -0.9255672031689577,
        -0.24931158526437866, 0.20437698644853766, -0.09651653807743583,
        0.6558961850972657, -1.1935618082887558,
      ],
      [
        -0.37800922848827534, -2.100170643571172, 0.9225387439088927,
        1.7667989516544649, -1.2820425111986276, -0.573787029114056,
        0.016445388710605927, 0.5854293244563973, -0.7077472782420829,
        0.36633473924709953, 0.1078053269134652, -0.4116779515851455,
        0.45011366979019857, -0.2877351747856934, 0.016597370518947496,
        0.2860147665787154, -0.5021543640187048, 0.4635506373150528,
        -0.08312861965030308, -0.4755314862062103, 0.8112617875266771,
        -0.5696266930549454, -0.19948701499757582, 0.9611893014561558,
        -1.0583461201362618, 0.280709393941107, 0.8542193942413652,
        -1.429559403184583, 0.8745151560066291, 0.483114040900011,
        -1.5828293273478722, 1.4633837044191538, -0.10506605744240202,
        -1.4579340425544354, 1.9252174353166984, -0.9785197918238537,
        0.213131255453834, 0.29299746906716, -0.23575056257741245,
        -0.16594227433953254, 0.7427887245404523,
      ],
      [
        -0.2972761593956119, 0.2812884621011788, 0.3386314673085719,
        -0.9386483326432742, 0.5427026581909535, -0.02398373990950846,
        -0.19026461966247687, 0.23804801162110348, -0.11934517007234138,
        -0.2541095619289473, 0.3305156580039954, 0.0770454443063425,
        -0.2833313009032107, 0.16673210834798288, 0.021423047275198046,
        -0.29284038106912036, 0.24882189685346448, 0.1983596631313106,
        -0.321722097959404, 0.053620850357334215, 0.14898241090024208,
        -0.2742519759704954, 0.12988256036921902, 0.29018700344540577,
        -0.3009487210462971, -0.08043585697393785, 0.24033148922481934,
        -0.19979756115125813, -0.0029662911927305757, 0.3334154891090608,
        -0.2270322392412153, -0.21018104216384917, 0.2796840181891298,
        -0.08174359136017277, -0.12413817542958122, 0.3179695726969859,
        -0.1159925443137945, -0.3107671074390664, 0.2614250717499808,
        0.059102368627238555, -0.21069667392632535, 0.24480503799376532,
        0.009286312439634906, -0.3625095430134027, 0.19111330998621984,
        0.1973049815328503, -0.24673342284046473, 0.12580114018538124,
        0.12349480987621206, -0.35466864205350046, 0.08434029675266555,
        0.3076096822224832, -0.22638657945601873, -0.018432197074846474,
        0.20378938294553087, -0.28753527166811244, -0.03633203183721108,
        0.36972882805601853, -0.15492334184734918, -0.1624156908816165,
        0.2341991202128559, -0.17242057470437788, -0.1457669720567601,
        0.372191679973065, -0.04769450413175, -0.2794230527114961,
        0.17391681172042117, -0.017411190560188854, -0.05467230980564322,
        0.016069254789406785, 0.12749125230332797, -0.02905047558639179,
      ],
      [
        0.041949241411929315, 0.05681265275729998, -0.17030621212494976,
        0.07145996671092972, 0.020428421060478333, 0.005621990502157802,
        -0.012165332958769315, -0.016648144399662335, -0.004549695036798928,
        0.011590321151303538, 0.015508104071273994, 0.002779832682068448,
        -0.014818981901105033, -0.020304659719902744, -0.007540009090642945,
        0.012731377788441738, 0.022606221482196726, 0.013487322742013239,
        -0.006046962686455312, -0.018290596952851707, -0.012831111609627969,
        0.003994907309355342, 0.015386631546770564, 0.010116217796394215,
        -0.006792835638814335, -0.018797087027795485, -0.013533885818947128,
        0.005277431477343528, 0.020975973062647722, 0.019296641076042665,
        0.0016106511112497016, -0.01630181487124218, -0.018813100211534248,
        -0.0047629305080301165, 0.011793545354279643, 0.015009036248381388,
        0.002188513589749943, -0.013775844567044681, -0.01673512156125305,
        -0.002754232172525479, 0.015870277058723233, 0.0219040313249152,
        0.00926239526186183, -0.011165452137510433, -0.021448208087608896,
        -0.013070753623916624, 0.005405307285691122, 0.01656660997344414,
        0.0104937653667764, -0.006097020883924774, -0.01643900075620291,
        -0.009773161014125101, 0.008266350773486204, 0.020757668264170442,
        0.01535294604390005, -0.0039683007838855686, -0.020319700757167575,
        -0.01938490834844368, -0.002546769765423895, 0.014552604113822636,
        0.01663059177429447, 0.0028741356466564748, -0.01262085602419992,
        -0.01440083002444232, -0.00040090695617819166, 0.016007353708154953,
        0.018617694148200324, 0.0038114910712278294, -0.01571799654801441,
        -0.022524075070415008, -0.010512386007839263, 0.009428920757441964,
        0.019527463126127083, 0.0115204639745446, -0.005943835429183038,
        -0.015735659245113665, -0.008512634104943014, 0.008478469295741907,
        0.018328361446004447, 0.01059094954701823, -0.008582322441669581,
        -0.021894226897700854, -0.0169198760731685, 0.0022644761816718872,
        0.01873476194395201, 0.018278497603383945, 0.0023654180934754056,
        -0.013526073660445906, -0.014574181714552888, -0.0004827717395553821,
        0.014436190940302058, 0.01498860699441419, -0.0003188554325794992,
        -0.017602007740981602, -0.02047862102457256, -0.0054725826214136325,
        0.014506862486095506, 0.021934118131636305, 0.010749491130294941,
        -0.008218481196239663, -0.017498858780467384, -0.009263292579176415,
        0.007585176321069021, 0.01609191086473812, 0.007469783933297719,
        -0.010434853330238582, -0.020428341916363765, -0.01219935491842055,
        0.0077496236310547265, 0.021851833292570143, 0.01761688643475228,
        -0.0008709974766272846, -0.016813054666697066, -0.016287896823096806,
        -0.0010073456642673822, 0.013634443682923006, 0.013291888676644315,
        -0.0017116379152868864, -0.016687501710227464, -0.016524808023031613,
        -0.0001565174734427452, 0.01809393650682863, 0.021645970248407316,
        0.0070505475867021355, -0.012743608099610254, -0.02031664290730265,
        -0.009780042551037042, 0.008048957310560774, 0.0150426611084548,
        -0.003316630031470688, -0.00995746744288198, 0.00897226784329507,
        0.014119955702619556,
      ],
    ];
    const result = wavedec(data, "rbior5.5");

    const reconstruction = waverec(result, "rbior5.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio5.5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4872309183840261, 0.8989475481301882, 1.1756954810943303,
      1.2862956411808073, 1.2333219380436737, 1.0506126325884275,
      0.793550438889103, 0.5246191870586872, 0.2978857266086279,
      0.14628178042101442, 0.07481774063848473, 0.06133728773431919,
      0.06450158329658656, 0.03685698143660587, -0.06044872891404035,
      -0.2451561414183478, -0.5068895768335343, -0.8075666261093969,
      -1.0892528052066608, -1.2875986084060993, -1.3475623124913767,
      -1.2375086007187346, -0.9581363760156268, -0.543940767142501,
      -0.0567437797685871, 0.4272199694303538, 0.8335877709440933,
      1.1056202635646524, 1.215653762572354, 1.1695561084870456,
      1.0032218200346887, 0.7721074895077804, 0.5365155707206279,
      0.3463590128561683, 0.22922677133716274, 0.18470175330818245,
      0.18627807105216973, 0.19028744205350706, 0.14946190215461766,
      0.027579379448638974, -0.18864330778912602, -0.48355760511628626,
      -0.8141524109194607, -1.118935872102163, -1.3320227065367434,
      -1.3989823693724617, -1.290522563971138, -1.0105812966549528,
      -0.5967567580750226, -0.11288118427656198, 0.3645245266152022,
      0.7626750909769128, 1.0278815651392768, 1.1361799773556704,
      1.0967402307405194, 0.9473603442323609, 0.743307998686641,
      0.5424043715733056, 0.3901478090609741, 0.3086235221373581,
      0.29195557651213977, 0.309379196902019, 0.3150671505904039,
      0.2621223517586446, 0.11708242604410268, -0.12886098805177643,
      -0.4549082797425808, -0.813370184094569, -1.1395300211626593,
      -1.3663091155725824, -1.4401600589355072, -1.3342664964685145,
      -1.0557596639975717, -0.6451155793332813, -0.1678116181264283,
      0.2997792662518653, 0.6868670735879917, 0.943134455916575,
      1.0484851469038692, 1.0153858967752423, 0.8833799292439932,
      0.7072887335304465, 0.5421695929123321, 0.4288725060068809,
      0.38385006611224515, 0.3957674245648814, 0.42971602746106746,
      0.43789305511130794, 0.37395652502903265, 0.20731915976017434,
      -0.06635911959696045, -0.42127789205722693, -0.8053472420399634,
      -1.1509786093357712, -1.3902529746128327, -1.4707784402880568,
      -1.3683398139004668, -1.0932039746022477, -0.6884887298835369,
      -0.22094599335221207, 0.23363102610822983, 0.6068549357818029,
      0.8520849172184347, 0.9532428236219024, 0.9260733685035906,
      0.8117016741345344, 0.6642523873647905, 0.5357549153568733,
      0.4622053416733803, 0.45432767255451917, 0.4953596074988472,
      0.5463881080468582, 0.5578304768616256, 0.48408259897886735,
      0.29753340229403746, -0.001718928350438631, -0.3830506909729008,
      -0.7902740980097155, -1.1533000492813625, -1.4037309857511495,
      -1.4906019135380557, -1.392415773029549, -1.122506262715282,
      -0.7263876039695073, -0.2717123528591486, 0.16673281990662508,
      0.5233574328426748, 0.7554839103086035, 0.8511838843067392,
      0.829447202434792, 0.7328130888209883, 0.6144663760473724,
      0.5231644688232819, 0.48987318141773284, 0.5195254631340032,
      0.5899946181490537, 0.658526209227509, 0.6739651109361369,
      0.5916258860839514, 0.3869604240617128, 0.06445226488987632,
      -0.34065512097502215, -0.7684022473492552, -1.1465870712441615,
      -1.4067020594201025, -1.4994780993725123, -1.4062444367722726,
      -1.1433220202204903, -0.7583682487930551, -0.31956133881770243,
      0.09973782819694876, 0.43711455198152893, 0.6541211057832667,
      0.7430907103540549, 0.7262113444200518, 0.6472645602598956,
      0.5582610583799555, 0.5044630506521139, 0.5116597894144757,
      0.5789645837269306, 0.6789808558459792, 0.7652991030239538,
      0.7854102728295729, 0.6957259639379121, 0.4748334367585588,
      0.13152649981679781, -0.2945596585557597, -0.7400414088577228,
      -1.1310053693464335, -1.3992072945836243, -1.4973390538452542,
      -1.4096550272029376, -1.155373605854184, -0.7840357519165096,
      -0.36397145646094453, 0.03329341900733579, 0.3488810676118811,
      0.5488183263918219, 0.6297909623283586, 0.617123733318523,
      0.5556652759577538, 0.4960273932745123, 0.4797757867611021,
      0.5274075722888791, 0.6322218979349714, 0.7616779407830576,
      0.8659200186576413, 0.8913139337454059, 0.795543722237313,
      0.5603901473979918, 0.19886084581251182, -0.24526828510534812,
      -0.7055562688493346, -1.1067916466538819, -1.3813692958005963,
      -1.4842018084477424, -1.4025576453224855, -1.1584531122773598,
      -0.8030482179929145, -0.4044540855371653, -0.031964748733428916,
      0.2594200138376327, 0.44042275826966265, 0.5121509997011914,
      0.5029904565222649, 0.4586786364456277, 0.42821405125865236,
      0.4492872376405049, 0.5370187805911713, 0.6789331727784124,
      0.8375015767023142, 0.9596527260095116, 0.9908654873566309,
      0.8902682685106952, 0.642879317912143, 0.26580323510755655,
      -0.1933156374968621, -0.6653627587337866, -1.0742510783858084,
      -1.353390834643473, -1.4601682310585198, -1.3849443416202583,
      -1.152424664075715, -0.8151202978913109, -0.44055819389285766,
      -0.09541848687893778, 0.16949613022329874, 0.329799987324064,
      0.3910689994286399, 0.38465950403498983, 0.3570171927614796,
      0.35532400269901954, 0.4132399559411637, 0.5404561585883029,
      0.7187957315384574, 0.9059279234643033, 1.0458171980937636,
      1.083302192864898, 0.9791236350061491, 0.7215672741302961,
      0.3316984084458449, -0.13926188044523324, -0.6199239008989422,
      -1.0337542174786993, -1.3155528683445472, -1.425424208925016,
      -1.3568895267851435, -1.1372261244787898, -0.8200262370757132,
      -0.47187471028758865, -0.15647265405576366, 0.07986933692638482,
      0.21782691879700133, 0.26746782946068953,
    ]);
    const expected = [
      [
        4.517095559494742, 3.290655427444904, 3.2476454046158794,
        3.42961977236324, 3.5493679059365677, 2.9233504189289783,
        -1.992255993508419, 0.4445999196457041, 0.8547986706263954,
        -1.5026147988309921, 1.1818483749059054, -0.1476226504764881,
        -0.9482459327420524, 1.4643525416727154, -1.091818290919973,
        0.020779731863878208, 1.1084749681838557, -1.5495002175823316,
        0.9742337960999573, 0.2496912261221177, -1.1562712742630898,
        -0.23074502081410897, 0.518331524153385, 0.7716229541003727,
        0.6569736851688331, -2.2843382675542174,
      ],
      [
        -0.44380843060876835, 0.15172422618993625, -0.11470722607194166,
        -0.005850090153092874, 0.14950666809176116, -0.01096011222168175,
        4.110809566255368, -4.700454809821928, 2.233653087005654,
        1.4185972040255235, -3.7530177218999357, 3.74887941262538,
        -1.7970327281597793, -1.1453485051860388, 3.7259874201309726,
        -4.258638541966218, 1.8636697356843348, 2.1413260071980074,
        -4.743112106391224, 4.048308326656891, 1.0965586304410209,
        0.4648871353665829, 0.20264399172149217, -0.48052052870875184,
        -0.07339616364596253, -4.037758783579332,
      ],
      [
        -0.33660782104668924, -2.0125075117797855, 0.8775624016284596,
        1.7162609604949133, -1.2528862335579716, -0.6216564290613195,
        0.3528836253995904, 0.029805886182821515, -0.4517761825296561,
        0.8856044972167191, -0.8948735387977715, 0.06704590633262053,
        1.1855799259015434, -1.6782632342504564, 0.633904149545245,
        1.2421869061172082, -2.191811377370608, 1.139491671380987,
        1.0648851190279123, -2.352067203976647, 1.479417604431833,
        0.7069635518278248, -2.1350630601754634, 1.5748057046096775,
        0.2533063875375591, -1.5801037817668184, 1.3887539379454987,
        -0.1974883120792971, -0.7825778833125189, 0.935389303760606,
        -0.5530721783092545, 0.12288642589673313, 0.27958299596398095,
        -0.7465444552906412, 0.9711400240880582, -0.5655959233259903,
        0.18271984642459663, 0.9783775248267126, -0.34118304213609923,
        -1.2072826705949642, 1.622846226801655,
      ],
      [
        -0.2798068376502775, 0.2661336123022714, 0.3286848916823187,
        -0.8963668274997078, 0.5200067978655404, -0.04273667227244196,
        -0.1811299446482441, 0.2673244621953894, -0.10718935428249532,
        -0.27695499432867277, 0.2915468083508938, 0.06315481754783742,
        -0.24512996763667655, 0.22144854825920662, 0.02821151180846174,
        -0.343001561950774, 0.18839916024977282, 0.1852129107650881,
        -0.26028803123045735, 0.13353087117414233, 0.154844662400552,
        -0.34826618038044665, 0.05045612487879893, 0.2760876332864113,
        -0.22371374267474295, 0.02118361187667958, 0.249790000905655,
        -0.29234755896456255, -0.09789255837562084, 0.31807776981788327,
        -0.1418292669901885, -0.09348426091012502, 0.29635090264135233,
        -0.18581196854354048, -0.2302051491572385, 0.3022912629523487,
        -0.029906678437604202, -0.18811746776822094, 0.28704923119598486,
        -0.048209224633029554, -0.32277380398217265, 0.23042270736022458,
        0.09077706475329243, -0.2443895033699671, 0.22488086697731446,
        0.09553274167842396, -0.35893049343109656, 0.11458024027935654,
        0.19694971734834665, -0.25149387207534296, 0.12261373727336765,
        0.21966772207639415, -0.3320840004628148, -0.02482223142482124,
        0.2677662605423442, -0.2081927426296593, 0.00027545640821413295,
        0.3023062295980481, -0.24693042109367946, -0.1627319804391491,
        0.2888111021755684, -0.12303759604872788, -0.11868644753573804,
        0.3293492283880156, -0.11863223627182598, -0.271578718567741,
        0.198845174602338, 0.11793163010695366, -0.3474403862102778,
        0.19031802280832721, 0.14989985481583618, 0.006967843349424935,
      ],
      [
        0.040291954038893636, 0.05473715162541454, -0.16266633870477223,
        0.06867613915096252, 0.019454021393010786, 0.004587336256275443,
        -0.01284105149256641, -0.016623121515868783, -0.0037352879759882038,
        0.012951537713435313, 0.016932207232136662, 0.0037533489806032437,
        -0.014636677387891688, -0.020995437867160613, -0.008957238361344266,
        0.010899747577219433, 0.0208038140040938, 0.01225349378190311,
        -0.006197955843107304, -0.017093204217209314, -0.010481020166956588,
        0.0068144643430162535, 0.017743916989219996, 0.011222812529751613,
        -0.007271699892869523, -0.020684395337787716, -0.016308654792346132,
        0.002265160731387668, 0.01839376346388897, 0.017804376641067605,
        0.0017762641982455689, -0.014233721348108054, -0.015190467232557757,
        -0.0005870961944347067, 0.015173457803332324, 0.016457135319562645,
        0.0012671847797507858, -0.016692497073382016, -0.020740185430817078,
        -0.00682348370337596, 0.012618280695973545, 0.02017388550001058,
        0.009592835437514852, -0.008553020583878843, -0.0169408236905753,
        -0.007817318194777951, 0.009756473744612592, 0.018524981773296388,
        0.009408364204244582, -0.009775569306511068, -0.02146781413957245,
        -0.014733035163832876, 0.004491288848286687, 0.018872687529334797,
        0.015772543148620755, -0.0011040104394936315, -0.015374900880776289,
        -0.013479349719404267, 0.0025607755441449907, 0.017095974634744313,
        0.015672723949760402, -0.0012128636129770352, -0.018378777934520057,
        -0.020039324075697397, -0.004535444038115309, 0.01408478180953572,
        0.01912373054467053, 0.006711234125635404, -0.01077117376258659,
        -0.016481048621791436, -0.0050191414630842215, 0.012495932672266466,
        0.01894470988288007, 0.0074300210451872795, -0.012049955773392402,
        -0.021786648619290458, -0.012835455006393832, 0.0066399173593684885,
        0.018968751963424055, 0.013404121212426566, -0.003993453458961949,
        -0.01624255904516137, -0.01152786009718226, 0.005639408956126666,
        0.018674120679071433, 0.014589209259631253, -0.0036403165280795603,
        -0.019661937297688295, -0.018904065618278752, -0.0021337663889225214,
        0.01527621475725293, 0.017680386363893272, 0.0036706226893174917,
        -0.012806616011369988, -0.01572492813377598, -0.0021471391833120038,
        0.01497175369824295, 0.018988396345454316, 0.005322542652118789,
        -0.014051608493440369, -0.021633743449062985, -0.010650268820029667,
        0.008673706551661123, 0.018686447195080343, 0.010752150035469771,
        -0.006830783432042544, -0.016818967762694433, -0.009377892889665302,
        0.008581881695166969, 0.019869886282040332, 0.013222309394776123,
        -0.005970709309037835, -0.020517650234833408, -0.017355438040276283,
        0.0003378528798800712, 0.016174808632708766, 0.015879103997912758,
        0.0005369522594655916, -0.014616081205292853, -0.014688293810850584,
        0.0007374701548974651, 0.01712857940854779, 0.01864874565331237,
        0.0031226035347695982, -0.015743801789300495, -0.021012586505652305,
        -0.008218624581676756, 0.010556997538783038, 0.01666849213416649,
        -0.011229620301201669, 0.0070221676023338375, 0.01668696841760353,
        0.0015855783672643342,
      ],
    ];
    const result = wavedec(data, "rbior5.5");

    const reconstruction = waverec(result, "rbior5.5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio6.8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48707531835681656, 0.9008256409801002, 1.1828738256815552,
      1.3012964043647668, 1.256067374785487, 1.0772657767963594,
      0.8165938594564865, 0.5343341972037816, 0.28493579345639863,
      0.1047067114189596, 0.004537294387275959, -0.03067971882577361,
      -0.03592097185063896, -0.05483464666282417, -0.12635486042762234,
      -0.27254526193510675, -0.4907857379706115, -0.7523486431875621,
      -1.0078384153732356, -1.1982730772248626, -1.2691804353899543,
      -1.184308512715016, -0.9355987874733016, -0.5469330795991683,
      -0.07063437691299787, 0.4225747633576522, 0.8578905625927928,
      1.1717334225682339, 1.3245118328793122, 1.307920358667029,
      1.1451488553356504, 0.8840653977997451, 0.5850985230042597,
      0.3067850941616919, 0.09247076452031683, -0.0386725868371493,
      -0.09423313280645118, -0.10425214185962908, -0.11122137952807781,
      -0.1569773977025991, -0.2698419273612815, -0.4552925280416594,
      -0.6925769295564699, -0.9382198922608012, -1.135669029574491,
      -1.228800057617989, -1.1760242192711612, -0.9615505518746532,
      -0.6010020187658908, -0.13991352237713117, 0.3546678404064729,
      0.8076119184238661, 1.1510895394270162, 1.338363879533993,
      1.352816132415668, 1.2101645786907853, 0.9534532355219646,
      0.6420988092654243, 0.3376805427903199, 0.08990155061622318,
      -0.0739349186837659, -0.1534818107267728, -0.17296329602366314,
      -0.17258082483367204, -0.19596175139820576, -0.2768655761589164,
      -0.42853708266122226, -0.6384387723871395, -0.8697670301002085,
      -1.0694804291893176, -1.1809523064572367, -1.1581969108705195,
      -0.978193240438405, -0.6482488200181067, -0.2065085934582782,
      0.28465729761562686, 0.7509510556148309, 1.1213294461188514,
      1.342572005470827, 1.3898742478578454, 1.2710456858029238,
      1.023410016040993, 0.7042337068499345, 0.3770333589703692,
      0.09706536148887784, -0.10054438208912614, -0.2072521159985297,
      -0.2406965376856313, -0.2376994800874028, -0.2425325194434068,
      -0.2934665787206024, -0.4110317599205081, -0.5909845106540366,
      -0.8038139334585717, -1.0010022506199603, -1.126579601488335,
      -1.131188356604186, -0.9852204120336598, -0.6877730002975536,
      -0.2691430104249692, 0.21388683882459586, 0.6889935833798726,
      1.0830179055622275, 1.3370434369278423, 1.4183668488491352,
      1.3266054024673717, 1.0925772840838521, 0.7703018686198635,
      0.42409006770592567, 0.11383895899312207, -0.1179641509697325,
      -0.25447708742349906, -0.30611300916238576, -0.30529063731976813,
      -0.29576656788484823, -0.3193088029504219, -0.40310878433064806,
      -0.5511343166968947, -0.7416460116657602, -0.9315740303685964,
      -1.0667513960275339, -1.0955390848920494, -0.9825128450272788,
      -0.7188244431593931, -0.32661731378768843, 0.1437149595456945,
      0.6229282344670888, 1.0368861769064648, 1.3218749717050409,
      1.4377328438108827, 1.375760549737748, 1.159611936992096,
      0.839025341588814, 0.47794717073355286, 0.13991197468399746,
      -0.12583634510938735, -0.2942172146655872, -0.36791896147880565,
      -0.3740194373779077, -0.3546110058072943, -0.35387615931034166,
      -0.4049137778863033, -0.5196602789892011, -0.6844749498258338,
      -0.8625537839519525, -1.0026433531388852, -1.0519578585093425,
      -0.9701408587020405, -0.7408180047251237, -0.37783251968296533,
      0.07548849489206655, 0.5540237186386586, 0.98381777675554,
      1.2973510943671263, 1.4475888310925202, 1.4175526351638494,
      1.223212377087018, 0.9090744507131059, 0.5375687390731767,
      0.17479295317221916, -0.12398899868264562, -0.32567873204969267,
      -0.42489094576279657, -0.44252886180056705, -0.41790368683087464,
      -0.39648264992744187, -0.41640292458042905, -0.4971713683378184,
      -0.6334151153577403, -0.7952915631481996, -0.9355144535718185,
      -1.001307873819695, -0.9483629440082343, -0.7533449073543312,
      -0.42181151883549955, 0.010516394552528063, 0.4836040188698755,
      0.9248312756943792, 1.263938436883043, 1.4477365644251712,
      1.4511665161829228, 1.2821438558663005, 0.9790936897946888,
      0.6018065842180185, 0.21781892153381172, -0.1124394087260383,
      -0.3482290744775174, -0.47589963578415123, -0.5094661561703915,
      -0.48439583798790276, -0.4462857260897825, -0.43734382358168883,
      -0.4841015802459495, -0.5894618594679077, -0.7311031683106471,
      -0.8666824813693633, -0.9445899529378267, -0.9176207303103086,
      -0.756180699182049, -0.4577181024259022, -0.049955764543585024,
      0.413022611289887, 0.8610604650969547, 1.2222766925626138,
      1.4381668131021745, 1.4759462722579966, 1.3352625165395047,
      1.0477281153581308, 0.6694226151981314, 0.2681682984420194,
      -0.09139379835692674, -0.36140919450892284, -0.5199318177742412,
      -0.5735091704385269, -0.5527763753588303, -0.5023026940389506,
      -0.4673200144617596, -0.48070148432676346, -0.5534721360599943,
      -0.6712445276118517, -0.7974983644817313, -0.8829230560975245,
      -0.8785303861339315, -0.7492896245368053, -0.4848732444000011,
      -0.10477003159187967, 0.3436361108432072, 0.79373228040022,
      1.1731661602103982, 1.4190595417225693, 1.4914079767073607,
      1.3815376667559254, 1.1136497295705987, 0.7391129461894883,
      0.32487689165995054, -0.061243301297627784, -0.36494250077531454,
      -0.5561101193492458, -0.6333921033328354, -0.621697433002559,
      -0.5634298496120872, -0.5057390863590826, -0.48703334531416126,
      -0.5261478154627051, -0.6168872420953095, -0.7293198700146254,
      -0.8175224936803642, -0.831870621354876, -0.7328253201402506,
      -0.5027683231767947, -0.15287862905678798, 0.2767778558335747,
      0.7241429107134355, 1.1175521610324193, 1.3907804059977116,
    ]);
    const expected = [
      [
        2.381420526357252, 2.2645708387397603, 2.6959645786899284,
        2.0991257581777614, 2.9849032038665997, 1.9082128061750068,
        2.9612220240204543, 2.002990603111611, 1.9528590181413557,
        -1.7441611135340662, -0.8560745355603133, 2.634075906755022,
        -1.3576491568135354, -1.6009283951318833, 2.8559570678632267,
        -0.8897602298548881, -2.1537283602677797, 2.856608095615296,
        -0.4022429465907615, -2.4804733499449183, 2.592708300796613,
        0.13337354498479687, -2.5968608605323054, 2.070475783462527,
        0.7336469296978846, -2.55278787993896, 1.349382454073019,
        1.3823909130570264, -2.40674764754252, 0.5280416267060196,
        2.0231458000217644, -2.2002955320880546, -0.28278733645610965,
        2.5687798132437982, -1.9427562392272122, -0.9902339819092923,
        2.925631590336743, -1.6340736903946276, -1.405818489559538,
        2.225228045976891, -0.799436773385829, 1.891545210312027,
        -0.38341201912939904, 1.407884057518685, 0.08294169648013144,
        1.2220919388557003,
      ],
      [
        1.6276698913912035, 0.11795930991679998, 0.9243332181354125,
        -0.40479402663074854, 0.17588732820536976, -0.8845847194869689,
        -0.563040563898495, -1.2667203675635448, 0.19503722214836988,
        1.1354214508775158, -1.632453820887303, 0.9852758872770807,
        0.227879419268874, -1.0975581484523222, 1.1524309326133153,
        -0.5638808404873589, -0.20504954017636723, 0.791499491919353,
        -1.0073485812920049, 0.7359653834282087, 0.02017639049848452,
        -0.9389135373234202, 1.3890897043244825, -0.8766302850729959,
        -0.4029991533914571, 1.5307176937776554, -1.5573891529515689,
        0.36646241422810705, 1.1356175149320245, -1.757163833113581,
        1.0392228961815735, 0.38490253899514754, -1.3913248040342183,
        1.3199600858634155, -0.4066608242925207, -0.5860322248568477,
        1.0391716984091504, -0.8063519157506147, 0.018559076027639898,
        0.9687356887606938, -1.369559239223191, 1.8608297504654396,
        -2.248546630960659, 2.3818967995315705, -2.419233823813838,
        1.3257342810398636,
      ],
      [
        -0.37361985711810447, 0.77710936675168, -0.5849179494662082,
        0.44814249126476835, -0.3373283361486338, 0.20458922457602222,
        -0.3142287643548418, -0.02625251342515155, 0.14455058593869066,
        -0.08494503124385279, -0.05791818205974895, 0.1336916060528777,
        -0.04687815192276898, -0.0969973686204456, 0.12046785485119281,
        -0.004802949458071141, -0.11591340912498314, 0.10361712952309907,
        0.036394301436773184, -0.1331187287117714, 0.06705985914435576,
        0.07391116037371924, -0.1276769383344854, 0.03372103615122367,
        0.10540564685285937, -0.1178546485285754, -0.013471592038777973,
        0.12354033872148344, -0.08868849483201756, -0.04850504685355256,
        0.133342272300659, -0.05703748139310004, -0.08963767328804183,
        0.12440824594960327, -0.014398896078007841, -0.11079340364330478,
        0.10947304426647907, 0.025688214702280988, -0.13160246633103004,
        0.07597010207287225, 0.0658719732020688, -0.12874876841553304,
        0.043341107929327986, 0.09812002356275216, -0.12287486905514823,
        -0.002960852587373146, 0.12043872705875469, -0.09540790470994603,
        -0.038988050600893484, 0.1321040833488527, -0.06677435431155901,
        -0.0815755667646392, 0.12768244784737465, -0.023963861738360643,
        -0.10515112790413943, 0.11455395025274537, 0.014863551361321612,
        -0.12913546760952874, 0.08453802423879092, 0.05741244128330145,
        -0.12917649819705668, 0.05256452084638843, 0.09023514713106388,
        -0.1270145147113016, 0.007709706877723206, 0.11660813674249196,
        -0.09997451054013774, -0.0399059408270469, 0.153830102836951,
        -0.13090765623801026, 0.048359613439896865, 0.023634800474997063,
        0.10829073271105408, -0.2644940744262171, 0.12093841511729361,
        0.0784756631061749,
      ],
      [
        -0.003738549658496115, 0.01980773515065576, -0.04971316360092864,
        0.11492787668441613, -0.10047574063811561, 0.017175646322724763,
        0.0010662693856398847, -0.0006321273213413317, 0.0008932612300108255,
        0.0006713750847430794, -0.00016358114337738667, -0.000848932209618742,
        -0.0007582787419094226, 2.8010976521981548e-5, 0.0007953840538742,
        0.0008448706815802659, 0.00012907952777355212, -0.0007041087853027522,
        -0.0009000370285612378, -0.00028288468897202826, 0.0005850048859976865,
        0.0009148532213926334, 0.00040872773944180445, -0.00046998885397414483,
        -0.0009188183413953603, -0.0005268812244727093, 0.00035073405854678646,
        0.0009155954388684719, 0.0006521883688459546, -0.00020276735570504828,
        -0.0008749178313095362, -0.0007557782492456926, 4.4530556725457275e-5,
        0.0007978769335670127, 0.0008204413333408878, 9.434019056839488e-5,
        -0.0007167609737899409, -0.000872084627004013, -0.00022826598548821695,
        0.0006297329032621624, 0.000920520187687578, 0.0003772347743203607,
        -0.000509143177834185, -0.0009355796060950103, -0.0005166004806589266,
        0.00036569236946647915, 0.0009094133633644045, 0.000622097370833484,
        -0.00023189302173231598, -0.0008725684201813474, -0.0007145524064510606,
        9.983503508549706e-5, 0.0008296773064073242, 0.00080940762842254,
        5.4604074742993676e-5, -0.0007514725826574516, -0.0008785285547675235,
        -0.00021276383096022569, 0.0006400574180580639, 0.0009056324003455097,
        0.0003450438998698134, -0.0005285850369545991, -0.0009176024353612919,
        -0.0004660827670597842, 0.00041592359852708717, 0.0009251953080107382,
        0.0005961539620051642, -0.00027508371937444214, -0.0008992561221148128,
        -0.0007110435702077163, 0.00011733883733900481, 0.0008330329794071886,
        0.0007871507576103303, 2.445676832606115e-5, -0.0007580971899190857,
        -0.0008460854679809634, -0.00015806936890056802, 0.0006799819917338045,
        0.0009040862587450878, 0.000307555092172695, -0.0005703069484845999,
        -0.0009339170870154337, -0.00045432376058513976, 0.00043203383670598517,
        0.0009203438798284864, 0.0005690970401354503, -0.00029899069673757113,
        -0.0008913048878492946, -0.0006670067400581958, 0.0001705287667340522,
        0.000858535077690424, 0.0007688708486370426, -2.007032701512013e-5,
        -0.0007938810531956575, -0.0008511430936994427, -0.00014080717195098607,
        0.0006916308232992399, 0.0008910934814875299, 0.0002791900565246104,
        -0.0005842780255056114, -0.0009112859435759019, -0.00040298919768716967,
        0.0004781131273618348, 0.0009288875146279995, 0.0005364816915595995,
        -0.0003454614207500878, -0.0009176503311600708, -0.0006614268660489783,
        0.00018992852638534245, 0.0008634340489413, 0.0007491322799694526,
        -4.577448089673839e-5, -0.0007952309219656547, -0.0008154647412691625,
        -8.743085920565985e-5, 0.0007257075400175883, 0.0008820002072337975,
        0.00023613300107724932, -0.0006276208744290812, -0.0009260402065043268,
        -0.00038873812858110726, 0.0004961653121485537, 0.0009258676465039926,
        0.000512561672682725, -0.0003645842019498367, -0.0009051006299891854,
        -0.0006159408979310667, 0.0002397181740162297, 0.0016631614165901819,
        -0.003805892306656783, 0.010687181809184501, -0.02612300653298856,
        0.021389861425484342, -0.003577157365161543, 0.000545139728915801,
        0.0008407485509856674,
      ],
    ];
    const result = wavedec(data, "rbior6.8");

    const reconstruction = waverec(result, "rbior6.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_rbio6.8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5011497238992355, 0.9221854534574814, 1.200349294286179,
      1.3033482337833187, 1.2350461844799687, 1.0324494171981726,
      0.7548951974033625, 0.46831018616433634, 0.22861897771993295,
      0.06854546318705751, -0.008877464376218114, -0.028548933616182305,
      -0.033913251562902424, -0.07255786901415062, -0.18071496879437132,
      -0.3708695043761555, -0.6258652273248967, -0.9012031169058794,
      -1.1350818498169606, -1.2636916232952835, -1.2378681194251229,
      -1.0368074397371227, -0.6752435881022818, -0.2021209911998737,
      0.3090604537496108, 0.7759400466583061, 1.125207991640763,
      1.308345415683016, 1.3113520853586715, 1.1561432199771162,
      0.8934029004379476, 0.5888325544671795, 0.30637876077977116,
      0.09274543120309786, -0.03289034322205853, -0.08142895561807822,
      -0.08816803493982173, -0.10054363738288535, -0.16265730947417284,
      -0.3007861950669285, -0.5138121911073699, -0.7712188033383929,
      -1.0193233699829674, -1.1942494782155877, -1.2383589096277534,
      -1.1159169634936643, -0.8239063881223108, -0.3951007549276591,
      0.10754607423876811, 0.603939132527292, 1.014166653428114,
      1.2758721456772335, 1.3574182850023317, 1.263648487276066,
      1.032922553796728, 0.7263031740782886, 0.41173736227580854,
      0.147308572874413, -0.03218176664164196, -0.12195358547423521,
      -0.14572237890571207, -0.1464841235568678, -0.17218823383879867,
      -0.2602007718230826, -0.42476696534287844, -0.6508922704093301,
      -0.8963790837246683, -1.1016164607255843, -1.204675927540337,
      -1.157846776212653, -0.9413178783630147, -0.5703934286202865,
      -0.09424572129646945, 0.41365329633779097, 0.8711658449407442,
      1.2053840528664361, 1.3684002394753068, 1.347094448170664,
      1.1645907966222704, 0.873135795493681, 0.5403083521652456,
      0.23213140754328693, -0.0026042729622641203, -0.14285942898451387,
      -0.19813852247178776, -0.20301110308183926, -0.20497330222472449,
      -0.24898740605801167, -0.36289160089526645, -0.5476336500720151,
      -0.7750137110454272, -0.993650833311607, -1.1417243241287485,
      -1.1632447101252992, -1.0236450631570357, -0.720603646661768,
      -0.2871859002733403, 0.21367170866648333, 0.7021162674134931,
      1.0986549937138814, 1.3415277628766682, 1.399912312785304,
      1.2797444047611233, 1.020796407048687, 0.6858584810975411,
      0.34484398110521614, 0.0578898506836803, -0.13827379516726318,
      -0.2373017237105202, -0.2619290278474432, -0.25491496002467673,
      -0.2647778287688395, -0.3302071701572154, -0.46736903187430834,
      -0.663551849480537, -0.8789332732658821, -1.056113586634942,
      -1.1350111114404695, -1.0692800096911834, -0.8399639335910087,
      -0.4627586830927098, 0.013142850241494697, 0.5145182544021509,
      0.9596728452852312, 1.2763036548022642, 1.4172854761270728,
      1.3705062117394873, 1.1603742134670665, 0.8407170005339223,
      0.48095247827888943, 0.1490880913173922, -0.1041366394235983,
      -0.2559947690266569, -0.314793956496367, -0.3145866245078145,
      -0.3031386012989955, -0.3264683602033632, -0.41414444031749337,
      -0.5693130880465342, -0.7661784045408682, -0.9556969357272631,
      -1.0780847609097604, -1.0789276317026295, -0.9247021214746516,
      -0.6136144893169747, -0.1788221582871521, 0.31697444038729,
      0.794386495774726, 1.1745497968944696, 1.3964826639452743,
      1.4303195205010142, 1.283179871594693, 0.9962839687617966,
      0.6341270681334997, 0.26851134345963185, -0.038499166370823734,
      -0.2484116391935393, -0.3535097857906944, -0.3757577599504591,
      -0.35788964766669457, -0.34919325182076494, -0.3898589879059202,
      -0.49811703834554033, -0.6636389784312492, -0.8490279654664524,
      -0.99909188856056, -1.0555376060046986, -0.9732740082341058,
      -0.7340438808104168, -0.35374329594276416, 0.11862852744689667,
      0.6103210925292986, 1.040297527159862, 1.3370513995631326,
      1.4543947731973033, 1.3813304570251559, 1.143603144646235,
      0.7966155580731363, 0.4115621954724978, 0.05832127631935008,
      -0.21057537771942292, -0.3709012341553649, -0.4299742280357688,
      -0.42154235743234986, -0.3938461952948002, -0.3941452550793107,
      -0.4538918327177252, -0.5785431236933953, -0.7447714219264634,
      -0.9058821641336928, -1.004085146005365, -0.9864456070261629,
      -0.8203405005849111, -0.5043223254795989, -0.07143191837040624,
      0.416087532890063, 0.8795296499807014, 1.2408586311703793,
      1.4400381853210829, 1.4482815255917565, 1.273960683695614,
      0.9597548951010885, 0.5718179214507964, 0.1837406358444834,
      -0.14063170242631257, -0.3612246029320971, -0.4691544489490522,
      -0.4858274555572831, -0.4541613067334501, -0.424404957948344,
      -0.43841261525180814, -0.5166028353694279, -0.6511081168428569,
      -0.8069831999425143, -0.9312155976298804, -0.9672195304210301,
      -0.8710285306693462, -0.6249132174121997, -0.24476827451700645,
      0.22081934712253376, 0.6997914905541457, 1.111975712067809,
      1.3868400433098351, 1.479270210993272, 1.3794690929405884,
      1.1145459120104744, 0.7414484149900162, 0.333062080000839,
      -0.03899832653333524, -0.32058155817048617, -0.4861608332211314,
      -0.5422767442772614, -0.5225845678663164, -0.47599742824943525,
      -0.4511877291371932, -0.48162703244417776, -0.5751743613555731,
      -0.7110106195816073, -0.8447770491705987, -0.9206106160351397,
      -0.8869393756164614, -0.7118805515438347, -0.3941392080026442,
      0.03357503984663984, 0.5096972735041296, 0.9564154699774611,
      1.2967098695959565, 1.4716393216653707, 1.4535968914710873,
      1.2522524204519807, 0.9117308242842167, 0.49977408883001984,
      0.09164026017423604, -0.24720775015064764,
    ]);
    const expected = [
      [
        2.366500534213359, 2.246770542723489, 2.626583033681191,
        2.108908549699654, 2.890336690360908, 1.9377132488869444,
        2.855351969273198, 2.035361658209896, 1.8841341599762924,
        -1.996505958390165, -0.25751847668984307, 2.331880698169431,
        -1.9479625135813192, -0.5094112483145058, 2.457110156096307,
        -1.8250886265890909, -0.7518258780071565, 2.575216350738465,
        -1.7064009639016107, -0.9802415080494836, 2.6820535891202724,
        -1.5914335401677908, -1.19118860787263, 2.7733716452837203,
        -1.4788302678983158, -1.3821202366155643, 2.845083961578065,
        -1.3664857766091842, -1.5515219209597155, 2.893533456849873,
        -1.2517401765153775, -1.6989532698015442, 2.9157340244130205,
        -1.1316142847285167, -1.8250188306658464, 2.909575814336966,
        -1.0039591466555429, -1.8527300042237373, 2.6144584789681553,
        1.2708941102200446, 3.752653567613174, 1.2203828870122642,
        2.491805294777153, 2.0039766393344585, 3.0127084978957956,
        1.788661380719243,
      ],
      [
        1.6142571948375282, 0.21412084811446425, 0.8780915922478767,
        -0.3430943894319639, 0.11653293519687173, -0.8731459405504957,
        -0.6276991167064391, -1.2549821485030055, -0.03247046293472776,
        1.5063432121531715, -1.7337765192511427, 0.47521446926603467,
        1.1688383364110602, -1.7346745133252075, 0.7525607562142903,
        0.8557583811952325, -1.6508179322861776, 0.9736839064839935,
        0.5120834009779972, -1.4760555649758627, 1.1214928141191811,
        0.16169618808004632, -1.2207349166473491, 1.1839472277706975,
        -0.17121553478552787, -0.9005607465562073, 1.1548433468633268,
        -0.4638007228542351, -0.5355389293817121, 1.03424493355287,
        -0.6960957088677433, -0.14862923146612, 0.8284891899585879,
        -0.8523789183824472, 0.23592150219514996, 0.5389818660952824,
        -0.854605177844657, 0.40675351332899345, 0.757146266945664,
        -1.0889768592216336, -0.02739399553079878, -1.5533857971210827,
        2.3358896513268093, -0.9607591959082354, 1.875138330575312,
        -2.3142548556845854,
      ],
      [
        -0.40112116543094306, 0.8127007833078249, -0.6149873208354208,
        0.4676052485067021, -0.3465183601080091, 0.213621833525838,
        -0.3343879233803556, -0.01921622164044921, 0.1606827672438274,
        -0.12378637830481361, -0.026935218051503604, 0.15193280382675098,
        -0.1096397617360212, -0.053593502227002085, 0.1523459777540741,
        -0.09113449710065338, -0.06545749566051796, 0.15836826505192636,
        -0.07662162640851926, -0.09006975742152747, 0.15308458368587616,
        -0.05573351854060003, -0.09936090296834021, 0.15420212848259782,
        -0.03848843145127304, -0.12065595893526639, 0.14330346920178755,
        -0.016482037007717443, -0.12631327645229834, 0.13972909194110641,
        0.002189698644329864, -0.14327530061784313, 0.12365388270116245,
        0.02394355789431592, -0.14449113819326698, 0.11594182761015577,
        0.042670448340260486, -0.15638995521235166, 0.09545692856430081,
        0.06278697404450033, -0.15266700998358565, 0.08446362208776646,
        0.08022514498297173, -0.15910535527721906, 0.06061406126243073,
        0.09739896441133669, -0.150292604639925, 0.04743826816201328,
        0.11232366641225906, -0.15123086995248222, 0.021478229664841475,
        0.12541701865815957, -0.1375359653469009, 0.007384673449278231,
        0.13680588679548944, -0.1332927638040817, -0.019305592912568278,
        0.14492561601519832, -0.11527003532276496, -0.03297395694856996,
        0.1520280378877156, -0.10649855900807592, -0.0589796818383238,
        0.15458617454090356, -0.08501971419894952, -0.07090750518399642,
        0.151683144292746, -0.03868047919836101, -0.19892134471931783,
        0.460022896174823, -0.34372973081942826, 0.3706512128168816,
        -0.382575814762573, 0.18139551204606305, -0.06688565257852327,
        -0.1454566168793588,
      ],
      [
        -0.0037647448558186074, 0.020277897887591437, -0.051825877254785706,
        0.11931425043728779, -0.10371112607584027, 0.017315007590939763,
        0.0010900153730158395, -0.0004646124762267955, 0.0011505319005522714,
        0.0006952663654964468, -0.00043177471145399837, -0.0011412825429053157,
        -0.0007463502440398065, 0.00037530484378819423, 0.0011442781683851419,
        0.0008183953523790127, -0.00029238391720565345, -0.0011233438333216298,
        -0.000878685962544114, 0.00020353311121319002, 0.0010812140175007106,
        0.0009113951257758426, -0.00013883881273115631, -0.0010541336821795523,
        -0.0009493614360485023, 7.732280694971706e-5, 0.0010382546504421053,
        0.0010067879019529844, 9.683901512605366e-6, -0.0009977239422658045,
        -0.0010499269172860272, -9.949941128283577e-5, 0.0009379906861061397,
        0.0010654545461784711, 0.0001636255765422169, -0.0008950370990945574,
        -0.001087287907917417, -0.0002251281471276376, 0.0008624637958462195,
        0.0011272320397112958, 0.0003110076118196132, -0.0008049223649447066,
        -0.0011506986337634839, -0.00039656274412666614, 0.000730537381334117,
        0.0011469477021229673, 0.000455056094715146, -0.0006748248813091824,
        -0.001150802278978214, -0.0005115378434505795, 0.0006288561682789379,
        0.0011716137321095461, 0.0005912156632211222, -0.0005579629242841977,
        -0.0011741439490457395, -0.0006675206218035063, 0.00047288749110236403,
        0.0011502991145657681, 0.0007156381105204094, -0.00040847481072262904,
        -0.0011356257067350272, -0.0007624877912236217, 0.0003532985519230845,
        0.0011369737193575322, 0.000831368215850502, -0.00027353889967059847,
        -0.001118644417719829, -0.0008940024455333173, 0.00018248108157481696,
        0.0010752330126811067, 0.0009276483699341281, -0.0001140946789660465,
        -0.0010428178280556524, -0.000960967676333845, 5.4498098864510375e-5,
        0.0010257078748272539, 0.0010152408716326985, 2.911843782636009e-5,
        -0.0009879301899219598, -0.0010606487316315262, -0.00012101731407593839,
        0.0009267922892959768, 0.0010766568571257884, 0.00018830560871325314,
        -0.0008787047564023751, -0.0010935285680605746, -0.0002472660680753769,
        0.0008454045222238765, 0.00113042431148301, 0.0003295433443070959,
        -0.0007908272973899777, -0.0011561524421156333, -0.00041705173557929354,
        0.0007149968625799823, 0.001152505387233542, 0.0004781708938966212,
        -0.000654450017391133, -0.0011511946579090856, -0.0005315178048176652,
        0.0006083297410903271, 0.0011691652897589892, 0.0006074228046778775,
        -0.0005406594796559872, -0.0011740255998497, -0.0006855682908324663,
        0.00045416460425870287, 0.0011499965849938404, 0.0007357945993135915,
        -0.0003852975123612625, -0.0011300717189589745, -0.0007789722317848736,
        0.0003305955558451744, 0.0011288919719176132, 0.0008439733725564737,
        -0.00025434510265870164, -0.001113039214924293, -0.0009083746342877365,
        0.00016194087098707875, 0.0010692465382013345, 0.0009436550397326575,
        -8.953783458851526e-5, -0.001031611035303943, -0.0009728432359266158,
        3.106740264845686e-5, 0.0010123880014414827, 0.0010232143065735866,
        4.874960634677558e-5, -0.0014127109638776693, -0.0005676498280499714,
        0.008984384175782336, -0.044527038235393154, 0.0500563090833003,
        -0.020012654470945506, 0.008623812063937626, -0.0028976669205741786,
        -0.0005317877740791594,
      ],
    ];
    const result = wavedec(data, "rbior6.8");

    const reconstruction = waverec(result, "rbior6.8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym2", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4846548014834592, 0.89742513008752, 1.1808313675385447,
      1.3029414442317573, 1.262755865599972, 1.0886908627534098,
      0.8306307145842408, 0.5475164590536803, 0.29346105857602695,
      0.10568943579154533, -0.0028751491524695583, -0.04470287642864318,
      -0.052291306798296786, -0.06776965071196939, -0.130116056796501,
      -0.2632051079047519, -0.4676999386693486, -0.718871967467053,
      -0.9709940579901071, -1.1673539782186226, -1.2535573324084353,
      -1.1909633762697467, -0.9670226650898068, -0.5999827442987307,
      -0.13673349258342704, 0.35583148817691646, 0.8040373840287351,
      1.142253711823153, 1.3259608638797677, 1.3401048901541333,
      1.2008905449557674, 0.9506974210388103, 0.6474068878462658,
      0.35071884795430835, 0.10871187397299426, -0.05219997135282106,
      -0.13160886706142055, -0.15284093841995783, -0.15475936471634993,
      -0.17976081474461586, -0.26099669082665616, -0.4120311992412527,
      -0.6215530261271853, -0.8545291243404912, -1.0596219787462478,
      -1.1811611281859995, -1.1728327622182295, -1.0097990135462527,
      -0.6962915537017633, -0.26676550070858307, 0.2197963651643688,
      0.6912289654133588, 1.0766457821901723, 1.3207403854396187,
      1.3946826888980595, 1.3011561958004507, 1.0724504478408945,
      0.7621424064866775, 0.4323878909272741, 0.13984757807304465,
      -0.07644497767728953, -0.20246809505387478, -0.2502095853023229,
      -0.2521859129252493, -0.25095276186967674, -0.28627759619566795,
      -0.38319850721964815, -0.5439685995637185, -0.7459358728470151,
      -0.9459626606069867, -1.0903926847677423, -1.1282103162290833,
      -1.024233175417222, -0.7691298778409081, -0.383773867560375,
      0.08323713145353945, 0.5644607271606139, 0.9869414232937171,
      1.28698863778865, 1.4230427321240113, 1.3837077168139453,
      1.1891534652443732, 0.8856353526818692, 0.5344792624564847,
      0.19815611916945158, -0.0732789102277785, -0.2522341176764675,
      -0.337839151835181, -0.3535432724826952, -0.33878920670191837,
      -0.3369175691181382, -0.38235237359082025, -0.4902763509468396,
      -0.6513887239402519, -0.8330959918584363, -0.9869160417481269,
      -1.060354011254002, -1.0103999907420804, -0.8153706310017814,
      -0.4821736000539908, -0.04713293120939405, 0.42997576019392864,
      0.8774269976716018, 1.2260147952883664, 1.4232057165975118,
      1.4437493388578104, 1.2943370592097292, 1.0112839885758136,
      0.6518314793045743, 0.2811454309390959, -0.04193150428835207,
      -0.2770588929873782, -0.40972180291879373, -0.4520964312166065,
      -0.4374137869311544, -0.40933524601603655, -0.4090405355469485,
      -0.46326141770634494, -0.5762468739230282, -0.7276782833077414,
      -0.8770983362092765, -0.9738241628383999, -0.9699655917078416,
      -0.8333878212293141, -0.5574329394633131, -0.1649549618553192,
      0.2944460005267207, 0.7534988064141512, 1.1406546113929974,
      1.394771835937839, 1.477741378352146, 1.382165221763272,
      1.1323464012242215, 0.778402721082283, 0.38491272366838014,
      0.016762543208606207, -0.2745111540066268, -0.46074071120261356,
      -0.5412633173246122, -0.5403485783525185, -0.49870131053152095,
      -0.4612337528977116, -0.46417870172452247, -0.5247506565437382,
      -0.6359249697381377, -0.7676488840423329, -0.8742248072272023,
      -0.9060926999366571, -0.8231483320468491, -0.6063297590061925,
      -0.2645844419874563, 0.16459454202615292, 0.621357628001043,
      1.0351099658370049, 1.3389435672000758, 1.4836008337225717,
      1.447765960915124, 1.2423223512296584, 0.9076129342336172,
      0.5043653303093647, 0.10041054086608164, -0.2437145109798074,
      -0.48696032263341077, -0.6149880659181957, -0.6408614233939343,
      -0.5992123599231102, -0.5354409576092047, -0.4926818650148666,
      -0.4997813029926406, -0.5632583764744321, -0.6652388802317133,
      -0.7678859499928226, -0.8232611346971171, -0.786213458286112,
      -0.6271337617154334, -0.34141064338670685, 0.04681505348140008,
      0.4876576818151358, 0.9147110161513168, 1.2584576825860792,
      1.460819456801084, 1.4875072986852866, 1.3353214350689657,
      1.0327164363428403, 0.6335089721353876, 0.20519704473384437,
      -0.18539745710819666, -0.4858496945263341, -0.6680844740318158,
      -0.7323476672767499, -0.7044199653363729, -0.6269072323466268,
      -0.5468430537669983, -0.5026977116692984, -0.5140004279119155,
      -0.5761232649154839, -0.6615046882035804, -0.7270137016631597,
      -0.7256501091292131, -0.619704155879735, -0.39211750309937243,
      -0.053190137335429266, 0.3591299050154467, 0.7856144292858774,
      1.1574303382688025, 1.410492609555313, 1.4992030199468531,
      1.4063967020719739, 1.1471839100794703, 0.7657871117354521,
      0.32609971261693643, -0.10185244443424274, -0.4564262523024554,
      -0.6965301847440025, -0.808704673562169, -0.8075962821945795,
      -0.7298834010275206, -0.6232622332117267, -0.5332594759011785,
      -0.4911277083404814, -0.5057861793259883, -0.5617655392634594,
      -0.6236418595798711, -0.6458567094754206, -0.5854972741513903,
      -0.4148711452573922, -0.1307327875501308, 0.24220088678587154,
      0.6544547906429472, 1.041124017128257, 1.3352572711808375,
      1.4822365149225225, 1.4518248242544634, 1.2450721441037271,
      0.894452166614945, 0.4571735411683863, 0.0031936515883662087,
      -0.3993118198999897, -0.6976949326123283, -0.8646778999354086,
      -0.9021154961219049, -0.8379519570471173, -0.7172599386506852,
      -0.5896405306484354, -0.4961027526808851, -0.45863009917382835,
      -0.47496148764613905, -0.5198289742152687, -0.5523136637069114,
      -0.527483704765999, -0.4094234253742199, -0.18240402532714317,
      0.14262905001606613, 0.5279689406655997, 0.9156495297419924,
    ]);
    const expected = [
      [
        2.34637228324477, 2.350135854560361, 0.13134285182627162,
        0.06164088309180582, -0.30613022220785885, 1.1182975071478438,
      ],
      [
        0.003192258522746766, 0.024610303162330843, -0.7521245075843048,
        0.6913072801109801, -0.9350456666559618, 1.0055894635989144,
      ],
      [
        -0.4851880098447803, -1.6251366654816854, -1.802669080974408,
        2.0758634760873136, 0.747274011755247, -1.9454238475382417,
        -0.4837862779503835, 2.4757656822079905, -0.4631229675589116,
        0.689725939415671,
      ],
      [
        -0.30450443207217937, 1.9492090368554007, -2.878568530868692,
        0.47090829218270147, 3.1170781430326207, -3.938919222440032,
        1.0885214409082875, 2.0323380610405244, -2.793060343669465,
        2.01223481035431, -0.7633011477882152, -1.3898748306824396,
        3.5410079403122103, -2.8944319668668093, -0.799887372686664,
        3.7059703441098106, -2.4374760893673257, 2.0920037928377573,
      ],
      [
        -0.1419169048425017, 1.3861159482400958, -0.2780724308468838,
        -1.3054557111999758, 1.5270950186129442, -0.5274256309633143,
        -0.47278406577473, 0.6255695039189504, -0.24831838095246556,
        0.153554411808282, -0.47767808869495615, 0.5066199143065289,
        0.28956781235212, -1.3389317883635776, 1.4160599225217005,
        -0.06807912790044579, -1.6381757192289843, 2.049778726227901,
        -0.6451311636326136, -1.3342144889395393, 2.0863574923237227,
        -1.0367056717652279, -0.6776978465505322, 1.4775084524287179,
        -0.9224457274434195, -0.07596262220146029, 0.47492335844795636,
        -0.23915288979731475, 0.12062422810324827, -0.49425430644423823,
        0.7780973151191631, -0.19892466151430022, -0.5288474425051668,
        1.102964532383901,
      ],
      [
        -0.17294120872008661, 0.29256847108037615, 0.22509873099750116,
        -0.21989279859407979, 0.1587309875779009, -0.06358648358655507,
        -0.49250668929217567, 0.19514278941602042, 0.4504654256527403,
        -0.1748186980585714, -0.02322472021457595, 0.13327770346891848,
        -0.4358129020474658, -0.11486312225682102, 0.533405698601128,
        0.028524923545866443, -0.20742216209840747, 0.1779238635802754,
        -0.23231240495932748, -0.3642248886588857, 0.4215627959104376,
        0.2997061990528823, -0.27495550119047885, 0.06032823064650593,
        0.0030227663250097375, -0.4497415953139945, 0.15665794415465767,
        0.507629141354262, -0.16739694275989017, -0.14135324415437728,
        0.1451947292125389, -0.3504608433279661, -0.1457493094276154,
        0.547088658310014, 0.0815747582357415, -0.30208793044108817,
        0.12349523918733935, -0.13676123985530736, -0.3539752340259511,
        0.39253884184091964, 0.36187562207118806, -0.31554283180025955,
        -0.042446162273636706, 0.06708431342819701, -0.3859590854943791,
        0.11155551312839514, 0.5421205428415214, -0.1502509420762936,
        -0.25332459935280094, 0.1475982923580347, -0.24950548060980632,
        -0.16892652956830623, 0.536010964383466, 0.13251010699198945,
        -0.38203033811609, 0.06084768476563837, -0.036548040347999355,
        -0.3263773488414034, 0.34608328419510737, 0.4084071051247281,
        -0.3400989716794987, -0.1448699729638832, 0.1255037430537524,
        -0.30388204120732515, 0.48737037760995605, -0.06627178844228437,
      ],
      [
        -0.2967892412559991, 0.07178059363332455, 0.09925604163933165,
        0.05789181244221653, -0.01079210921714388, -0.04683181376095241,
        -0.025172695465301615, 0.023656565784199404, 0.043641115274837244,
        0.006499318490270155, -0.060417691870092396, -0.09718028772769999,
        -0.06498393912842113, 0.017630058372415325, 0.08885589910946975,
        0.09600948899130457, 0.04000579023167841, -0.02726335239144201,
        -0.04985738385736981, -0.01685640934530555, 0.030146305306148678,
        0.037279813395950656, -0.010431366602731848, -0.07353383863097053,
        -0.0926935716115398, -0.04256009308881689, 0.043500304402621405,
        0.10046569056350704, 0.08695862372944288, 0.019952039660100396,
        -0.041640711095546165, -0.04948884760427342, -0.007472507017075681,
        0.03447957207403126, 0.02815940258981694, -0.02710229221418639,
        -0.08227827512295881, -0.08246439336472414, -0.017431090208629277,
        0.06673272154512379, 0.10592870670956028, 0.07271235098789333,
        -0.0009989553188743672, -0.05306146405281017, -0.04583995017626059,
        0.0022801556869321005, 0.036301857055893325, 0.016829655333620734,
        -0.04243043527698666, -0.08603410697405184, -0.06706691240715854,
        0.008879447629927595, 0.08591294697233084, 0.104942240121605,
        0.0541924864019854, -0.021539709042268762, -0.060868051984037795,
        -0.03924071000100992, 0.011685003103518395, 0.03543594669010051,
        0.00400386185715168, -0.05539766842192735, -0.08448910391418632,
        -0.04740051788226711, 0.03476863977046214, 0.09987444231428949,
        0.09759899997419158, 0.032574152961053954, -0.04040770391329955,
        -0.06464624903681496, -0.030211068739058697, 0.02005863614738794,
        0.031896545744446544, -0.009486232982365353, -0.06511799439825877,
        -0.07765958117200424, -0.024636847340808038, 0.0586526735569379,
        0.10776994290348793, 0.08437957652876829, 0.009211038425689544,
        -0.056463469495574195, -0.06424709497756503, -0.019422313469446784,
        0.026799014138679855, 0.02589153174510163, -0.022744307328474433,
        -0.07089733828300514, -0.06589380868042832, -0.00014941438023045178,
        0.07906433553919263, 0.1091232456010637, 0.06612107660320302,
        -0.01444972303806305, -0.06875991525851485, -0.059791429956603345,
        -0.007649028788668008, 0.031427595263923525, 0.01780964215131922,
        -0.03486866766799003, -0.072281899969944, -0.04985448939593107,
        0.024569894854027146, 0.0947437050738132, 0.10385814864603884,
        0.04396397228469126, -0.03695767335568362, -0.07659866869451781,
        -0.05165701099154743, 0.00428506837636429, 0.03362254097398318,
        0.008195329674020757, -0.04501288929129814, -0.06909175687352745,
        -0.030481172125067874, 0.04800234369970447, 0.10471637266362957,
        0.09230277228395095, 0.019280545436652557, -0.056948517586392244,
        -0.07957003990631481, -0.04044931345367876, 0.015563693144738697,
        0.0332407178414679, -0.0022875889192026724, -0.052443848447219055,
        -0.06143731793083303, -0.008934746706768568, 0.23740490660462016,
      ],
    ];
    const result = wavedec(data, "sym2");

    const reconstruction = waverec(result, "sym2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym2_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5079967228041986, 0.933414450061204, 1.2117644750211116,
      1.3102561711920981, 1.2335934033530198, 1.0206378748030893,
      0.7329567066290509, 0.4383347971932017, 0.19358521859970096,
      0.031110305438489527, -0.04737456538991083, -0.06846726475447161,
      -0.07687058718650452, -0.12024076333740874, -0.23328981266886967,
      -0.42553181913536503, -0.6760935287647987, -0.9371316560167419,
      -1.1451055886356367, -1.2370468692543648, -1.1675999926574914,
      -0.9223438609512082, -0.5238133463234307, -0.028492436752633,
      0.4846354098865181, 0.9312189997586305, 1.2401223611522156,
      1.3688457252252808, 1.3119768727332812, 1.100649691609776,
      0.7932867876168388, 0.4601213182936522, 0.16555468714346622,
      -0.04709198288337868, -0.16456003649957196, -0.20418545445326108,
      -0.20604513028112295, -0.21899837030798341, -0.2845101783261717,
      -0.4227168382210585, -0.6245872771057981, -0.8524056594646947,
      -1.0485792079706826, -1.1505437376637593, -1.1078844452439105,
      -0.8971475499345607, -0.5303614430501591, -0.05487643435994949,
      0.4556416467754083, 0.9169452367892063, 1.2528009881671047,
      1.411828514992036, 1.3783981014577091, 1.1749166643562559,
      0.8550295565051973, 0.489578807450856, 0.14898630988976214,
      -0.11339957109562254, -0.272766199056373, -0.33628607723563586,
      -0.3378628469109722, -0.32577998130622615, -0.34671944490016,
      -0.4305567012628084, -0.5801109319654796, -0.7686962968338136,
      -0.9462322748511981, -1.0523771959917136, -1.0332520165852381,
      -0.8573208845773405, -0.5261566761883444, -0.07710531833733755,
      0.42305985814073455, 0.8920730260569796, 1.2503044154036667,
      1.4385817051843044, 1.431257224414059, 1.241274473780945,
      0.9160241661608202, 0.5251246941843203, 0.14330666800305564,
      -0.16720350019746322, -0.3703329948428876, -0.4624614057230646,
      -0.4699406729069622, -0.4387210973120302, -0.4190340541653562,
      -0.44936061547162043, -0.5440737436331677, -0.6881406314673094,
      -0.8403754077678539, -0.9444395817267863, -0.9447010732242397,
      -0.8027316366572614, -0.5099987768727635, -0.09325423649403294,
      0.3890068744435303, 0.8583305596558484, 1.233497093076961,
      1.4488621106152233, 1.4692556748135177, 1.297704709182084,
      0.9740638237201636, 0.5649521240931119, 0.1475995830845218,
      -0.20826555682961623, -0.45590167517084695, -0.5805567095687751,
      -0.5998605056270134, -0.5557439311961538, -0.5002356057815074,
      -0.47907012524394554, -0.51758199244974, -0.6127181790372814,
      -0.7333498553144555, -0.8288355467455591, -0.8435698289992632,
      -0.7336271979805289, -0.4810083453377766, -0.10157684940872302,
      0.3556102408011774, 0.8176438531170148, 1.2035778013190113,
      1.4428114352738477, 1.4914313883276433, 1.3423908567929608,
      1.0269579326640839, 0.6070819950327228, 0.1606344063016344,
      -0.23672118862356326, -0.5284482424722704, -0.6886255807119863,
      -0.7252320562255665, -0.6746114584325207, -0.5888020633938753,
      -0.519259377713041, -0.5014082751118645, -0.5441972411222227,
      -0.6274648726805349, -0.7078267885935852, -0.7315028031533042,
      -0.6506314492721582, -0.4386548643279048, -0.10055708612547515,
      0.32494631851134037, 0.7720809443409609, 1.1620445818882204,
      1.4209511417399887, 1.4971849780631077, 1.3737689520130734,
      1.0725939801933964, 0.6494198821898126, 0.1809030599643963,
      -0.2530720913566896, -0.5873076860179041, -0.7849795788981034,
      -0.8437550302824894, -0.7929859775114507, -0.6829474712314597,
      -0.5691456736924732, -0.49597016141416095, -0.48408724305230727,
      -0.5249361639509722, -0.5837726265653097, -0.6104089834942013,
      -0.5547313573909913, -0.38277514435129034, -0.08895453302553508,
      0.2989798887928946, 0.7237923357231165, 1.1106516316182808,
      1.384167095441948, 1.4862961624653703, 1.390571502609682,
      1.1089974657484674, 0.689816281663005, 0.2066648050906506,
      -0.2581686822321654, -0.63218835774182, -0.8682308455954353,
      -0.953278939764709, -0.9084905806971447, -0.7806690968838568,
      -0.6276100176840895, -0.5013188077711795, -0.4335983819435637,
      -0.42782707482389176, -0.4590680461909118, -0.48241283349942143,
      -0.44725365792901084, -0.3135816830304651, -0.06584219875615366,
      0.27950692677667244, 0.6749493227048556, 1.0513593468379252,
      1.3336844083724402, 1.4589299952230048, 1.3918634741439917,
      1.1343882197534638, 0.7261285106057581, 0.23599749607456916,
      -0.25318295143962116, -0.6631761048557957, -0.9373265273356359,
      -1.051858914024131, -1.018771855444278, -0.8798007115318899,
      -0.6932271055184835, -0.5171378398951778, -0.39360968955531717,
      -0.33799414431541597, -0.3360809048052427, -0.34979947841404546,
      -0.32983225229245133, -0.23166069770535797, -0.030635607568351653,
      0.26810212643043174, 0.6276819095673553, 0.9862788954884713,
      1.2710331753446147, 1.4156327256045387, 1.377069346208625,
      1.1472315602433798, 0.756282556086485, 0.26685390518522895,
      -0.2395724484459651, -0.6807280571314827, -0.9915740741873221,
      -1.1378059870503425, -1.1215621025510871, -0.9780705498662747,
      -0.7643039284969201, -0.5427525344644477, -0.3646463830013924,
      -0.2570385038341765, -0.21709001349558577, -0.2149555649224647,
      -0.20436720316075344, -0.13795987398954357, 0.016887588320555647,
      0.2660726263300013, 0.5840180241547405, 0.9176128433494943,
      1.1980060453014052, 1.357317401731459, 1.3459904926245143,
      1.1462828762463844, 0.7783331658305283, 0.2971215601733951,
      -0.21903640295939233, -0.6856562506942088, -1.0306567293738946,
      -1.2097304894898404, -1.2147393699201507,
    ]);
    const expected = [
      [
        2.493704726863073, 2.553107272318119, -0.21084253069003317,
        0.37111634059602533, 0.2659273902218548, -2.803119310005269,
      ],
      [
        -0.01742671872879148, 0.16402131601471606, -0.452555537578847,
        -0.6369116491326429, 2.306299138074861, -2.3893731099406565,
      ],
      [
        -0.5138697332417924, -1.594395419519089, -0.339014898551417,
        1.4734397032564817, -1.2910438851057062, -0.09665024557453274,
        1.4737078677094755, -1.5856971723543758, 1.180440997111881,
        -1.6999628460944178,
      ],
      [
        -0.32447770532567743, 2.057907745640405, -1.5503088470010802,
        -1.2724566683780807, 2.8301700663854312, -1.4467068987405518,
        -1.5082003288919605, 2.9541686071577438, -1.3019117223406145,
        -1.7948393728052838, 3.0743591677624433, -1.0980344305479683,
        -2.1264337043329946, 3.1676765316180724, -0.8226602415823927,
        -2.489473798635587, 3.800538303724484, -3.4705735053940154,
      ],
      [
        -0.15451506903159196, 1.4661489552337565, -0.1038212945326043,
        -1.8406030909451707, 2.051331490567994, -0.3481484590793208,
        -1.6614595277835873, 2.101096975636767, -0.5794479722359669,
        -1.4619631169399205, 2.1157550235754865, -0.7928559345808947,
        -1.246951048085695, 2.095729746543322, -0.9840054411316116,
        -1.021614445179597, 2.042328981906183, -1.1491421047800894,
        -0.7913579325917303, 1.9577061693126665, -1.2852227595587542,
        -0.5616535444602047, 1.844799219534859, -1.3899946467362896,
        -0.3378929813372341, 1.707248059241862, -1.4620529225384427,
        -0.12524226297585106, 1.5492931206789489, -1.5008749213809125,
        0.07149724023256637, 1.3768026560283955, -0.9771861651516911,
        -0.4134678116772351,
      ],
      [
        -0.18233318254731729, 0.3382650840436327, 0.18967002175941639,
        -0.21892876131351718, 0.2088401612620077, -0.2375948983712601,
        -0.4265864118365581, 0.4644310494924411, 0.2520868187556679,
        -0.2618606217050329, 0.16518203354505026, -0.1724252083987463,
        -0.4418624290612998, 0.43615532604460333, 0.31318879536520655,
        -0.2954744240103333, 0.1134787462247833, -0.10810608834501743,
        -0.4469942224786715, 0.3995342803802731, 0.3712511309548602,
        -0.3191335697803479, 0.05491534200095225, -0.046347855884685304,
        -0.4415518742232002, 0.35580231722464556, 0.4246161926337131,
        -0.33248014512622637, -0.009123844579277243, 0.011225652417118093,
        -0.42539080079318314, 0.3063777768815602, 0.47173922969114157,
        -0.3354438936711418, -0.07709253867433842, 0.06312145198315045,
        -0.3986565825300766, 0.25282335937261163, 0.5112310160179272,
        -0.3282432789252634, -0.14732435654597992, 0.10801814200655929,
        -0.3617818390017512, 0.19680262023147005, 0.5418962691306527,
        -0.3113786094523193, -0.2180779701828201, 0.1448018806438777,
        -0.31547523352085804, 0.14003373407201597, 0.562766790232612,
        -0.2856174181346857, -0.28758436691614203, 0.17259661684634442,
        -0.2607029060873175, 0.08424179695189928, 0.5731284145384201,
        -0.251972499522117, -0.3540949081694956, 0.19078774986598676,
        -0.19866284189240385, 0.031110978556380474, 0.5725410308921423,
        -0.2205217737688283, -0.15365416896839723, -0.3797172994157277,
      ],
      [
        -0.3110831904689956, 0.08171475431697811, 0.10786849064388107,
        0.053727293690408656, -0.023188288175804372, -0.0512112006916688,
        -0.013555591956599899, 0.038177355420831074, 0.03841457650573699,
        -0.02427228982082237, -0.09296022465146787, -0.09677723425020429,
        -0.021125688998297837, 0.07510590472470224, 0.11295116499559123,
        0.0663700710454026, -0.01530270966772651, -0.05656896490692043,
        -0.02831303114931142, 0.02681945195419819, 0.04015465023614939,
        -0.01192537016718595, -0.08203948658224651, -0.09711682415786141,
        -0.030986347709487577, 0.06695547739346994, 0.11583330364650347,
        0.07822584362110976, -0.0061092445027020326, -0.059875159461893014,
        -0.04231970625951106, 0.014180873428790264, 0.039878434702101465,
        -0.0002854436248111089, -0.06973949527483915, -0.09526400224489404,
        -0.039941798473289256, 0.05753485705532761, 0.11646207980174157,
        0.08896693286953128, 0.004109625498780023, -0.06108879877071723,
        -0.05524699428736288, 0.000561786699833984, 0.037568560569148285,
        0.010331633683440797, -0.0563665805637444, -0.0912191785657322,
        -0.04769036615319307, 0.04714863840816455, 0.11484381895822474,
        0.09829324070297016, 0.01504075801394425, -0.06022765876382855,
        -0.06679566432771138, -0.013708993105988956, 0.033266236873443,
        0.01964110210861237, -0.04225406570976388, -0.08504170345183085,
        -0.053963831948650634, 0.03612612935753379, 0.11104375623775742,
        0.10594050359033322, 0.026349042533740152, -0.057367639388625144,
        -0.07670392973052752, -0.0282828979379674, 0.027070184640612407,
        0.027397096559765688, -0.027753215326079897, -0.07684838935671379,
        -0.05853495937141533, 0.024812181041013105, 0.10518418455870723,
        0.1116875716536247, 0.037686702851600445, -0.052640527979622216,
        -0.08475447345532089, -0.04280104990805851, 0.019133983354583176,
        0.03339936801936229, -0.013223697660061637, -0.06681045832669981,
        -0.061223893681133845, 0.013557596764153251, 0.09744104466421144,
        0.11536251285515578, 0.0487029540364865, -0.04623022534947356,
        -0.0907802542195591, -0.05690399323782974, 0.009661902960007698,
        0.03749874404177879, 0.0009761772318906473, -0.05514899844908715,
        -0.061903258620356234, 0.0027093835209520637, 0.088039050777419,
        0.11684737459631381, 0.05905374844959713, -0.0383675386649612,
        -0.09466893450843436, -0.07024144823930355, -0.0010966643157222788,
        0.039601178431773645, 0.014499175746039879, -0.04212905355609812,
        -0.06050181005894098, -0.007398885923965539, 0.07724548583225052,
        0.11608147188257434, 0.0684113429012824, -0.029323684526842808,
        -0.09636580934196183, -0.08248181988051392, -0.012854019569459862,
        0.03967027905750711, 0.027018548973186216, -0.028052507978252837,
        -0.05700654578276097, -0.016456335468332587, 0.06536283672822692,
        0.1130631116360202, 0.07647342393676951, -0.019402681087972648,
        -0.09587515584811021, -0.024944756457212697, -0.08471507819416058,
      ],
    ];
    const result = wavedec(data, "sym2");

    const reconstruction = waverec(result, "sym2", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym3", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4994061922831837, 0.921110764655103, 1.2036300804612907,
      1.3140846846938183, 1.2538632953029494, 1.0563230561299843,
      0.7772315309434531, 0.4804180595418943, 0.2222430931213929,
      0.03873301602521678, -0.06149106634010948, -0.09685603280183859,
      -0.1053093279435473, -0.13169685247180474, -0.21340760877267106,
      -0.3680797233712308, -0.586634699532042, -0.8335506013950753,
      -1.0544404353444405, -1.1891319576449224, -1.1870191807170174,
      -1.0208332806065958, -0.6953204901637995, -0.24853578826518694,
      0.254737532354094, 0.7359975747003977, 1.1194303458123265,
      1.3478350030497606, 1.3942970505970174, 1.2668729306596163,
      1.0052544534431673, 0.6703345711126557, 0.3293131667714061,
      0.040038091196496206, -0.16158713045889567, -0.26811196972336887,
      -0.299505620956269, -0.29503469611826716, -0.300289892033572,
      -0.35281218023116995, -0.4701064508280245, -0.6432094105155308,
      -0.837555550713957, -1.0010176406780584, -1.0771554148154407,
      -1.0203511579685687, -0.8089854913719848, -0.4532455731280668,
      0.004544958690026107, 0.4973503809159218, 0.9469611640445541,
      1.280484058475472, 1.4458745168336224, 1.422815988684252,
      1.226374332142643, 0.9026111984292492, 0.5172929920096607,
      0.1404983847972185, -0.16910451408392047, -0.37650813682403855,
      -0.4762479313807935, -0.49064238561291884, -0.46104039265557606,
      -0.434474179187022, -0.4492517385615527, -0.5232631291241312,
      -0.6480617730262483, -0.7902953745057056, -0.900175163030069,
      -0.9248608208764748, -0.8233572497541657, -0.5790915591751091,
      -0.20687444100245508, 0.24768131970216312, 0.7163502595247621,
      1.1222640412294953, 1.3963828384343846, 1.4925421757291848,
      1.3974687799168382, 1.133368341236846, 0.7524885136598247,
      0.3250064490964294, -0.07679996895328295, -0.39426207978680816,
      -0.5941494985719555, -0.6738570291504035, -0.6588650142817916,
      -0.593321877056811, -0.526304544959698, -0.49736796206858974,
      -0.5251372279637471, -0.601891913324328, -0.6955453746144238,
      -0.7585217442263644, -0.7412574195957864, -0.6068490074287353,
      -0.34303979819331876, 0.03163280100527993, 0.46927082956101474,
      0.9014880894514774, 1.2537157193673312, 1.461558507853312,
      1.4852735763313436, 1.3188668570061832, 0.9915935276060903,
      0.5614877858725386, 0.102480033854909, -0.3117926376494473,
      -0.6235964094869882, -0.8024236248600457, -0.8494120506554226,
      -0.7939735392709104, -0.6836814153665862, -0.5701264036254055,
      -0.4944228383948317, -0.47609009524956336, -0.5081408548038904,
      -0.5596042485269181, -0.5848018635698558, -0.5369581849404317,
      -0.3826009549599249, -0.11297505192304552, 0.25058397762388246,
      0.6588723675993521, 1.0442914067579925, 1.335397566410448,
      1.4730561977919032, 1.424282026793291, 1.1903755652662358,
      0.8073321038423076, 0.3383717684715134, -0.1396479250641599,
      -0.5526951202255398, -0.8449786072921432, -0.9896756740605172,
      -0.9925121404151196, -0.8875115432834649, -0.7261642847376533,
      -0.5628765484878921, -0.4404437717919604, -0.37923658717915715,
      -0.37280603261198386, -0.39095791195717794, -0.3894305222171647,
      -0.3236169316691096, -0.16272799281015982, 0.09934159601003123,
      0.4393695989180237, 0.8077538591823987, 1.1385080054356733,
      1.3639724078796513, 1.4306889838741637, 1.3125477640019014,
      1.017938693999284, 0.5890816372277895, 0.09360566674401956,
      -0.38966438976486967, -0.7873480814908671, -1.0466294763202084,
      -1.1453007160899416, -1.0944350881982232, -0.9332163283720365,
      -0.7173764758210652, -0.5042469776727192, -0.33822249604848564,
      -0.2402791453600468, -0.20412171920198496, -0.19982781314529188,
      -0.18393989617925433, -0.1133106207255824, 0.040954976516919095,
      0.28315266056548655, 0.5890203148089953, 0.9093496921236011,
      1.1804324046866739, 1.3388579724224288, 1.3370465750310232,
      1.1556612869780016, 0.8097670360002132, 0.3471098808274692,
      -0.16119167646393173, -0.6353969916707903, -1.003857727864102,
      -1.217741651963314, -1.2603056335524192, -1.1486010919152967,
      -0.9273532713799519, -0.6566671107115485, -0.3967030949184789,
      -0.1931678494549195, -0.06720508489862398, -0.012121240850450687,
      0.00237240429734549, 0.019632918583953884, 0.0821005228616325,
      0.21755739086040288, 0.42927092250841337, 0.6926776456935159,
      0.9596037090493457, 1.1690979148332337, 1.2622550309269953,
      1.1973575999126036, 0.9615290757401403, 0.575907410890571,
      0.092916216662025, -0.4138575306175769, -0.8648537805857052,
      -1.1912223448437254, -1.3490506240212947, -1.3277860907519983,
      -1.1509235017266501, -0.8689167033049302, -0.5461659367094207,
      -0.24535531901774882, -0.013020184016016345, 0.13013692037546942,
      0.19189589372350258, 0.20364319440485554, 0.20938473569741495,
      0.25160129091893246, 0.3576883752600321, 0.5305630108030632,
      0.7459531450556853, 0.957179677823151, 1.106324171843639,
      1.1390287509092267, 1.0192127642699371, 0.7399572296153993,
      0.32771489842363694, -0.1613718661124745, -0.6523237817689845,
      -1.066853577139855, -1.3399119224024252, -1.4333244996219614,
      -1.34329338311965, -1.1000280185606275, -0.7596866968406603,
      -0.3906739076422499, -0.05769087525050115, 0.19255751338013294,
      0.34055879117582527, 0.39596381107905243, 0.39203633838167684,
      0.3741779464938896, 0.3856049961749175, 0.4539527170737061,
      0.5823243737815443, 0.7471570404933119, 0.9035281386688169,
      0.9966176407485547, 0.9764495369053621, 0.8121634973120262,
      0.5021350036237389, 0.07725613748105822, -0.40363540546450116,
    ]);
    const expected = [
      [
        3.2965868510216727, 3.4009537614778114, 3.2590036654306274,
        2.747513948344024, 0.14040453142845916, -0.4646571531336069,
        0.22389229001921762, 0.2813178295287105, -0.45758052016412926,
        0.16955337969607243, 0.09518574746976727, 0.3725756276929566,
      ],
      [
        -0.09867202024177231, -0.8194334482195024, -2.1235926637944433,
        1.8782042835660095, -0.3228190281713106, -1.2100069844160042,
        1.2890388531621293, 0.17486838420359052, -1.6331956640914942,
        0.3194330636799978, -0.11544199659839116, 0.5435196635587843,
      ],
      [
        0.21332112750646334, -0.35930496699370196, 0.5236119844272136,
        2.856217049398402, -3.715333106863486, 1.1149239878826784,
        2.1827890178498315, -3.1228170796025023, 1.316783136097403,
        1.3912203095040971, -2.8617849036687426, 1.9855689864317128,
        0.7293523158713455, -3.1214904394855956, 2.746649214490613,
        0.5521045326811229, -3.7125205086471915, 1.6274841734549457,
        -0.8133812609158944, 0.7446000040693362,
      ],
      [
        -0.4566662700896502, -1.1493614262952745, 0.4882192993821556,
        0.3602334180273517, -0.926843216920623, 0.9045329780895853,
        -0.020665051317421947, -1.1032918916668024, 1.436954963001902,
        -0.5043465150811102, -1.0292365518647824, 1.8210203411221868,
        -1.0534751322754423, -0.7249086870255638, 1.9830019196003739,
        -1.5557729251698564, -0.25676599796136307, 1.8936026821549783,
        -1.9082079196608124, 0.27584736016700157, 1.5738313367533747,
        -2.0376696917732593, 0.7606392572041363, 1.0907840814357759,
        -1.9156412548420596, 1.0949061051196864, 0.5441789846681278,
        -1.5639233533826955, 1.2061454288142566, 0.04634487562076074,
        -1.05026257500388, 1.0666085486915529, -0.30632892511768073,
        -1.3214645414182482, 1.841209272392242, -0.18440336949644442,
      ],
      [
        0.5625103972057587, -0.16341445320392156, 0.2775336950504225,
        -0.29641934348178567, 0.12093253352828878, 0.007449527157083449,
        -0.26929990714236096, 0.2669887564140992, 0.22111052084156968,
        -0.3147982056820854, 0.013644040285286083, 0.12063650308527624,
        -0.264009281363131, 0.14350013809983567, 0.3209828022693578,
        -0.2740735814458559, -0.11579922445164739, 0.19409233132991072,
        -0.20198849969641702, 0.01053246726743266, 0.372176015205545,
        -0.18180649025880283, -0.2412145836865921, 0.21267914294896478,
        -0.09629418290413863, -0.10545267802754849, 0.3648098020177932,
        -0.05589685080162333, -0.3372099787784525, 0.17228318359573078,
        0.03125102154058361, -0.18141876782190464, 0.3007390676779282,
        0.07900759769146044, -0.38427912497271044, 0.08064059516981696,
        0.15443774321240017, -0.20237641185910593, 0.19318144577769694,
        0.19645633008595628, -0.3727156951643123, -0.0442145122778818,
        0.24792939590160146, -0.16439076703746056, 0.06406483307282772,
        0.2735027993192032, -0.30456114596043754, -0.17756830243862481,
        0.29234656117186064, -0.07537082094696144, -0.06037278672569096,
        0.29530812157279146, -0.19319535215808656, -0.29298576410366345,
        0.2781560600524535, 0.04651781897874062, -0.15484832892221892,
        0.2581179481431139, -0.060652189092214155, -0.3676146329176332,
        0.20758436538624228, 0.17649815467016974, -0.2001069774615714,
        0.1700152115738102, 0.08892111803810822, -0.388343474559817,
        0.4009761229424174,
      ],
      [
        -0.11246277190245338, 0.13075072676883626, 0.007987781321287017,
        -0.024976367981171595, -0.032913019914649996, -0.011738725574069991,
        0.015842055632472662, 0.022345923106337453, 0.00166792876170667,
        -0.02520171070884429, -0.03025110220277078, -0.005415351092568514,
        0.028991759257441053, 0.04250645243558959, 0.02255653965132038,
        -0.013795947004006024, -0.035391487689955196, -0.025367138157974832,
        0.003954468754560996, 0.023374763740641947, 0.014604188761422339,
        -0.01259536044030613, -0.029956193192115725, -0.01789877649915175,
        0.015265228716960302, 0.040320789694724614, 0.034000088834304124,
        0.0007042712233683024, -0.03121257012781682, -0.035227305123395995,
        -0.01057520708418884, 0.017828575974137697, 0.02318931570734717,
        0.0019586714597076317, -0.0232350951929033, -0.02549058520367043,
        0.00031556244740123945, 0.031935850699026345, 0.0400619354163805,
        0.015670605653660963, -0.021157642583264025, -0.03929748235160983,
        -0.024813615528922257, 0.006808070998702179, 0.025661679818749436,
        0.015484567177910837, -0.011493717857701036, -0.026711351472454018,
        -0.01287637031132019, 0.01904535463308634, 0.039564112260777676,
        0.028155292310195194, -0.007186754779303681, -0.03671652371494519,
        -0.03588416727323072, -0.007485874757575964, 0.021487521157911735,
        0.02521338718078194, 0.002854376120060908, -0.021361157235754043,
        -0.021684058993144444, 0.004245324380260523, 0.03264350397250719,
        0.035707906124448394, 0.007954602920051311, -0.02795671179983881,
        -0.04154424917514425, -0.022193818635773122, 0.011468083706178512,
        0.029138711608000696, 0.016872308066833423, -0.010559664662758556,
        -0.024362345502345416, -0.00948681734673678, 0.02072434696369305,
        0.03686699167308033, 0.021286332579335286, -0.014729035573229896,
        -0.04063522680376327, -0.034371494464572265, -0.0024211219732341313,
        0.026419280588809498, 0.02768922462865088, 0.003478587656550139,
        -0.020397572056877287, -0.019389678611562627, 0.006232422085791904,
        0.03145325655578513, 0.03019163582768363, 0.000360078894708335,
        -0.03331494684120747, -0.04158057682566211, -0.01742667537407247,
        0.01754784316723251, 0.03307639121361594, 0.017888577789935085,
        -0.01061062550713602, -0.023471980413018255, -0.007891712545960284,
        0.020605497851755587, 0.032942024316998615, 0.014331707293166768,
        -0.02102608743137463, -0.042377929304501065, -0.030569692575837606,
        0.004252335049222221, 0.031894443679379415, 0.029729714751343846,
        0.0030077978177247035, -0.02091211313370438, -0.01878277808204857,
        0.006552053012323381, 0.029044089564881463, 0.024432107240685393,
        -0.006206706995535487, -0.03660516847495067, -0.03924351362352838,
        -0.010850786067511033, 0.024322056622598877, 0.03657591670848408,
        0.017696652405887754, -0.012222995788207295, -0.02422572523562136,
        -0.007836366110141523, 0.01933845244114237, 0.02868521455128105,
        0.008198929774831453, -0.025420442255422178, -0.10468584861089668,
        0.12218678351326544,
      ],
    ];
    const result = wavedec(data, "sym3");

    const reconstruction = waverec(result, "sym3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym3_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49155199226162083, 0.907072959552881, 1.1865212689916707,
      1.2980392995230186, 1.2434916161781646, 1.056119620325907,
      0.791016104981364, 0.5108709078412985, 0.27057120459981865,
      0.10447781852088095, 0.019486022293958183, -0.004503848187812229,
      -0.006962019644960071, -0.03401599434546365, -0.1239972604592644,
      -0.29503541846768827, -0.5379705692161831, -0.816512217154429,
      -1.0747398172132288, -1.2501747302013855, -1.2892226147522123,
      -1.16114820280644, -0.8670625946771604, -0.44160043526268267,
      0.05325469367908057, 0.5408146013866861, 0.9458290282227835,
      1.2102941556941675, 1.305176497028512, 1.2353053835147147,
      1.0363641006505164, 0.764843583384571, 0.4835340300663911,
      0.24619526313768536, 0.08520373077596916, 0.0051866068418620626,
      -0.01587947612672226, -0.018521543773941163, -0.048772966899414405,
      -0.14374668033892535, -0.3195595565795945, -0.5647948412221647,
      -0.8412908327252223, -1.0921898078907681, -1.2553351714085013,
      -1.2787290505417932, -1.1342024408922842, -0.8258479990767831,
      -0.3910255577706896, 0.10643854124951835, 0.5893236694954014,
      0.9832825957404637, 1.2324416987399591, 1.3106339368617272,
      1.2256375276925144, 1.0155093925137015, 0.7380361867011613,
      0.45599783551599693, 0.22193519514758575, 0.06618949010330627,
      -0.008879381019560817, -0.027168526373371388, -0.030177864056007503,
      -0.0637526819943865, -0.16370982586543859, -0.34411455842503746,
      -0.5913053351014306, -0.8653113803896044, -1.1084360237581714,
      -1.2589553696760534, -1.2665635610381516, -1.1057137559448522,
      -0.7834810315137455, -0.3398939286486523, 0.1594807979675661,
      0.6370157287969722, 1.0193873820203907, 1.2529410805898273,
      1.3144136736452952, 1.21451144005505, 0.9935928158001894,
      0.7106358276981535, 0.428299894121663, 0.19781782179485258,
      0.04744870071239643, -0.022709737141684838, -0.038374875656548436,
      -0.04193381366249538, -0.07895016460380117, -0.18386957807635462,
      -0.368670687786736, -0.6174635049776811, -0.8885338733031204,
      -1.1234462734067292, -1.261019778898703, -1.2527334520932574,
      -1.0757141754161674, -0.740015273946282, -0.2882729639831064,
      0.2123109216643858, 0.6838285261852828, 1.0540990931438778,
      1.2717718537813107, 1.3165200711904839, 1.2019523597557824,
      0.9706528092929195, 0.6826847289480347, 0.40047739106890307,
      0.17386915352081384, 0.028994074871159514, -0.03630290450785209,
      -0.04950258351563044, -0.05379188962432424, -0.09435970904391594,
      -0.20420796276197295, -0.3931975712284351, -0.6432307075471169,
      -0.9109189774172898, -1.1371898033298011, -1.2615149140936435,
      -1.2372483831081913, -1.0442379438231177, -0.695505958715354,
      -0.23623083146564533, 0.26485867364653287, 0.7297011106569631,
      1.0873754795576192, 1.288915960733851, 1.316959783245266,
      1.1879873231899098, 0.9467288628191511, 0.6542253544244947,
      0.3725670731255598, 0.1501143612397136, 0.010837431641297246,
      -0.0496579521346579, -0.06055586022159372, -0.06575422414007892,
      -0.1099748670379862, -0.22470616393206988, -0.4176642383749316,
      -0.6685682626929752, -0.9324280794482284, -1.1496373568616463,
      -1.260429385567914, -1.220120365316678, -1.0113214815970042,
      -0.6500098931085785, -0.1838363535597305, 0.3170542191327449,
      0.7745739186830446, 1.1191763910824504, 1.3043577498989667,
      1.3157417308775428, 1.1726451110057805, 0.9218614483226836,
      0.6253003414332166, 0.344605196434124, 0.12657774958866924,
      -0.007010302398512969, -0.0627745526475243, -0.07153903441848806,
      -0.07782255672319943, -0.12578843748064855, -0.24534453932376876,
      -0.44203916392680714, -0.693437514924067, -0.9530233543586358,
      -1.1607612312354922, -1.2577539300772103, -1.20136375649564,
      -0.97700334052692, -0.6035853814121805, -0.1311589095997526,
      0.3688282270737915, 0.818388857406178, 1.1494638286553367,
      1.318083988243258, 1.312877076545017, 1.155956192795364,
      0.896091949983674, 0.5959524329910935, 0.31662747584744627,
      0.10328273225973877, -0.024539090465387214, -0.075652958595299,
      -0.08245652056875019, -0.08999820726279462, -0.14179245794333062,
      -0.26610263794159245, -0.4662903113487538, -0.717799895535612,
      -0.9726678322343507, -1.1705353326539292, -1.2534814389095015,
      -1.1809952520955591, -0.9413241558553687, -0.556292144565854,
      -0.07826833697136254, 0.4201119692026747, 0.8610893855387831,
      1.1782019927328946, 1.330083870057953, 1.3083791949081793,
      1.1379526695664945, 0.869462593507995, 0.5662244107657324,
      0.2886690358835084, 0.08025180943866089, -0.04173978094874237,
      -0.08829397757131423, -0.09331278628605758, -0.10228205007073399,
      -0.15797819795773738, -0.2869592196164173, -0.4903851781663746,
      -0.7416169853885777, -0.9913254644367018, -1.1789352292678166,
      -1.2476069828313692, -1.1590338727891154, -0.9043265950898378,
      -0.5081912375392401, -0.025234831523243864, 0.47083741816440683,
      0.9026205918415211, 1.2053573282900616, 1.3403490220945322,
      1.3022636404481625, 1.11866821410272, 0.8420163747093573,
      0.5361590286853637, 0.2607643633717679, 0.05750654737070221,
      -0.058604100881953, -0.10069894621043353, -0.10411231963947687,
      -0.11467448898568527, -0.17433615411114717, -0.3078922765660591,
      -0.5142908428030979, -0.7648505782018011, -1.0089611889127437,
      -1.1859382019623226, -1.2401278338400077, -1.1355009484424903,
      -0.8660553035998237, -0.4593449645527872, 0.027871152637566607,
      0.5209373445753557, 0.942929271065201, 1.2308985663533276,
      1.3488735050319136, 1.2945481119558977,
    ]);
    const expected = [
      [
        3.2876236235645084, 3.3507566034046588, 3.218370963237581,
        2.631075144877308, 0.2493639379904593, -0.26621647591955705,
        -0.23845703272773983, 0.42187822151273907, 0.07500251127224827,
        -0.2730073182322216, -1.2632833679797515, 6.619203174800421,
      ],
      [
        -0.09401433426671806, -0.8782797723434372, -2.5734536130564765,
        1.6762043344645832, 0.9456770742082949, -1.6777820205598173,
        -0.4213955329381921, 2.122235274150303, -0.8010288677598072,
        -4.4008873011663345, 3.1506006533148296, 2.115013574714113,
      ],
      [
        0.20953202597590936, -0.3454830739711745, 0.7425070761328931,
        2.208069288216636, -3.512248819210054, 2.262195249374749,
        0.17209942720076327, -2.145823719516038, 2.8821629354680387,
        -1.9322195053865179, -0.6558824298450037, 3.318236373775136,
        -3.537172594041855, 0.5366221388446166, 3.170706998934704,
        -4.064531553359197, 1.3774147606835212, 0.8639979943342037,
        0.6432167296422142, -3.364440197866258,
      ],
      [
        -0.4499368194334668, -1.13176740739802, 0.46367382750217295,
        0.4419771200474402, -1.071193787119836, 0.9747938404668378,
        0.13204557995574762, -1.3995999395472158, 1.5653412559542732,
        -0.25386002562051074, -1.458601892618609, 1.9575812159658466,
        -0.6754822552498334, -1.2642695934942172, 2.0739400331930344,
        -1.0200229414247626, -0.8832710358375032, 1.8881966306047644,
        -1.1877267187736518, -0.41763230864392814, 1.4310711066873953,
        -1.1141386524613965, 0.017736106608456807, 0.7841791180294047,
        -0.7850431908310078, 0.3199802341171849, 0.0636010752858736,
        -0.2408817983878541, 0.42043795995277616, -0.6035202754371243,
        0.430346986785817, 0.29921697633590877, -1.067322478401829,
        0.646350397365062, 0.34428229096220075, -0.46477944583716707,
      ],
      [
        0.554048796794499, -0.16165205705600524, 0.2704005311538822,
        -0.2891688617053851, 0.1305112337673154, 0.00843477096303952,
        -0.28492892832411265, 0.24928530336740276, 0.22907827581187892,
        -0.2892525699051549, 0.029136192292134336, 0.11508027918906258,
        -0.29529286599985705, 0.11173584456580245, 0.3355099745454977,
        -0.2279525487630792, -0.09083260445211706, 0.18361496958396725,
        -0.24607293454110765, -0.03780182237547314, 0.3860945774214376,
        -0.11482776697034075, -0.2020312722662952, 0.19869328303620248,
        -0.1508189999755429, -0.17041531194544687, 0.3708296822376653,
        0.02949669651598036, -0.278437960357726, 0.1569072741564566,
        -0.03246789188958617, -0.2611781076069338, 0.2927942434533116,
        0.1775062017954402, -0.3009623765496253, 0.06751341038974819,
        0.08161149805044235, -0.2942388193810901, 0.16750861139603973,
        0.3004351250328282, -0.26159891947526687, -0.049533078412132114,
        0.1654829099551544, -0.2659922690800619, 0.019719678828315455,
        0.37419101267627, -0.16526495539700536, -0.16782277519091388,
        0.20018088932401998, -0.18567461033456592, -0.12171640999864329,
        0.38432683113540583, -0.028930900046950474, -0.2601222862798279,
        0.17775588577503182, -0.07326543570703763, -0.2297840252612119,
        0.32902215269267215, 0.12178322012894319, -0.3042045740220493,
        0.1029744405101414, 0.044855253783725714, -0.2848471170957846,
        0.21714857423814368, 0.12945221746007537, -0.11127440169734888,
        0.15960174416007866,
      ],
      [
        -0.11059159521904494, 0.12845063433899204, 0.0075833915060477056,
        -0.02474653323098909, -0.032181353055081977, -0.01079437153434791,
        0.016729138067763032, 0.02295804222313582, 0.0017679794289834226,
        -0.02586163286743533, -0.03174005948540918, -0.007392428582360798,
        0.027278630877457744, 0.04187365571694246, 0.023395072175657415,
        -0.011771018757356349, -0.03294199577398643, -0.02325714208092025,
        0.005301677454790214, 0.023835279689223395, 0.01407622349401654,
        -0.014309508507008687, -0.03288862072890517, -0.021498385850240814,
        0.012218415771083693, 0.03920357753842048, 0.03551695882689308,
        0.004381685455311856, -0.026771360849241928, -0.03151291397871395,
        -0.0084347076759652, 0.018289889106194536, 0.022139056368467448,
        -0.0005949438054043415, -0.027314449437700013, -0.030564397200349223,
        -0.004300935230858078, 0.029711617994697403, 0.04153840091417106,
        0.020576369535462817, -0.014652774291461099, -0.03353851071239535,
        -0.021399847742031124, 0.0075412748123009285, 0.02416462921661177,
        0.012173233547104879, -0.016492005637758076, -0.03299073285709273,
        -0.019037718706866102, 0.015299471531932667, 0.04026318994497871,
        0.03362249050873606, 0.0011665608941202315, -0.028599352904826396,
        -0.03062705359995175, -0.006033440848174226, 0.019695068195519583,
        0.02113658930599565, -0.00297345818823495, -0.028581622764079054,
        -0.029166806293641545, -0.0011625106939307794, 0.03195726882973825,
        0.040933503029936945, 0.017632721225294974, -0.01741855363924567,
        -0.03389744406972993, -0.019404029985484128, 0.009704126161278043,
        0.024295459444609604, 0.010160374026818212, -0.018571164949558412,
        -0.03285943171343676, -0.01643008067190383, 0.018293016092618596,
        0.04106221352764956, 0.03151293057426294, -0.0020403696304613916,
        -0.030219150638569864, -0.029531702068505833, -0.003608848534228333,
        0.020934233469698048, 0.01995819768514822, -0.0053494607677649735,
        -0.029652511718701972, -0.02755557631757278, 0.0020017899203020953,
        0.03400019749857922, 0.04006303854476739, 0.014584078494809818,
        -0.02005020308863735, -0.03401793047307911, -0.01728531806521587,
        0.01177404417760964, 0.024226884437563507, 0.008052844332593265,
        -0.020530714636693755, -0.03249395612987405, -0.013692539005778704,
        0.021178667668572272, 0.04159509757208492, 0.029202610593554057,
        -0.005217620194471568, -0.03162089681174668, -0.028236245919771072,
        -0.001179293093980311, 0.021998231993125887, 0.018612796203495763,
        -0.007704789274903998, -0.03051784312275012, -0.02574054293003421,
        0.005170654413179827, 0.03582635910313339, 0.038932868050015876,
        0.011451055265086676, -0.022530565943759698, -0.03390079060240167,
        -0.015060153256714781, 0.013735601988489356, 0.023959547616332018,
        0.005866610429205009, -0.022355182470562184, -0.031895213466820935,
        -0.010843139521980266, 0.023936720329299145, 0.041858078133668694,
        0.026707194121320013, -0.07368383637991067, 0.0674085212569589,
        -0.004424268168801121,
      ],
    ];
    const result = wavedec(data, "sym3");

    const reconstruction = waverec(result, "sym3", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym4", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5015706336754854, 0.924599370404882, 1.2070218080295714,
      1.315814402370233, 1.2526966988548285, 1.0517180353666413,
      0.7694696434006958, 0.4704632298443238, 0.21137382367954488,
      0.028071499216715756, -0.07138940679480499, -0.1062002399815404,
      -0.11496713970047201, -0.14279028454212295, -0.2267163636451227,
      -0.3834353914875837, -0.6025145358534225, -0.8470429030848023,
      -1.061660232814405, -1.1860390472792908, -1.1704650637174616,
      -0.9895759743542978, -0.6507247239203175, -0.19473211423045542,
      0.3113375241881343, 0.7877709194191599, 1.158980190959428,
      1.3694681108001103, 1.395183058422821, 1.247589887823097,
      0.9695693374767849, 0.6242585389828323, 0.27966021613919745,
      -0.007148208327890038, -0.2023300412077449, -0.3011759690668156,
      -0.3262625961664907, -0.3185514214397883, -0.3238828273625506,
      -0.3784746397839294, -0.4972689787820022, -0.6682267639395034,
      -0.8541351725436507, -1.001557369939771, -1.054705209861147,
      -0.970722076411642, -0.7324531752713591, -0.3553610547337906,
      0.11332729920340423, 0.6032345017858126, 1.035267414534589,
      1.3384704874820275, 1.465273132130305, 1.4014796777768215,
      1.1686280386159256, 0.818207406182285, 0.4192117550496751,
      0.042120080157682926, -0.25676500224629845, -0.4468285068208759,
      -0.5277943098467367, -0.5265561961056358, -0.487205076003645,
      -0.4569750996451729, -0.47183949610115566, -0.5455449186453176,
      -0.6649683827456869, -0.7930434224331216, -0.8785462379832739,
      -0.87025301584962, -0.731826809088134, -0.4535594697835733,
      -0.0578429692384253, 0.40321013131792666, 0.8576211734555512,
      1.228622064390016, 1.4513746911446286, 1.4873113292093407,
      1.3326292938475754, 1.0188890251863187, 0.6055898471410613,
      0.16655258605691942, -0.2265635201567457, -0.5196127998420852,
      -0.6865112311160542, -0.7325412646090503, -0.6898053890569874,
      -0.6061892692433459, -0.5308076070235118, -0.49975821868705256,
      -0.5258903683882665, -0.5952349989738404, -0.671016237951927,
      -0.7042029753852188, -0.6478623671462018, -0.47157344842981325,
      -0.17210389569515055, 0.22253707535875938, 0.6569080868985897,
      1.0590711781856388, 1.3561127249066443, 1.4905277627552451,
      1.4334868754697991, 1.191735927083909, 0.8064200897173581,
      0.3440919682849831, -0.11793081009762926, -0.5083247634270259,
      -0.7766114489766265, -0.902581509756361, -0.8981484872122258,
      -0.8013869349261353, -0.6644538799406217, -0.5385969732737603,
      -0.46014135490787494, -0.4410504082457663, -0.466451185857509,
      -0.49970944738381984, -0.49368908587507077, -0.40522940301816,
      -0.20902643204398286, 0.09277337373854905, 0.46789604008511615,
      0.8590709507988726, 1.1958848564431863, 1.410556308789976,
      1.4538015269100977, 1.3068884122456366, 0.9868752911899872,
      0.5436830360507603, 0.04964290181300951, -0.4159987753784502,
      -0.7839119999643909, -1.0088356154567448, -1.077721091174909,
      -1.0100434992579275, -0.8504040204345975, -0.6554517318403535,
      -0.4785352971826048, -0.3560133972413808, -0.29867977930837597,
      -0.29041722445904383, -0.2943251541250442, -0.26464096461634995,
      -0.16128181387794432, 0.036851072278479835, 0.3233658009097129,
      0.6630249063528444, 0.9980842009075663, 1.2609056969784265,
      1.3898077449512263, 1.3442516665766013, 1.1155739004149432,
      0.7305323531944996, 0.2466833250050939, -0.2593937191374567,
      -0.7082508720592853, -1.034261278161448, -1.1988771164905416,
      -1.1973483796926887, -1.057418209102817, -0.830492673440974,
      -0.5776284235341234, -0.35393043116245826, -0.19529418651495256,
      -0.11078030258270327, -0.08244063742660379, -0.07249617031139666,
      -0.035882820057823894, 0.0651923697590982, 0.24855917844002046,
      0.5046603073364281, 0.7964600088385514, 1.0668781959662383,
      1.2520115261772948, 1.296899080112882, 1.1698948766183426,
      0.8720009583945176, 0.43872396949608206, -0.06615462086776612,
      -0.5635143960568763, -0.9755014789980896, -1.24185855205509,
      -1.3321005659350735, -1.250681920375751, -1.034028021306681,
      -0.740302493319556, -0.43455243274757, -0.17297702502374013,
      0.009773263733733606, 0.10717553277003936, 0.13978497269723367,
      0.1470038764508883, 0.17394445443477707, 0.2569039927869179,
      0.41131602390819844, 0.6254018236354183, 0.8612843792002376,
      1.063411067796302, 1.1722453760255185, 1.1398088643281215,
      0.9431321999353142, 0.5921434985470617, 0.1298694094435194,
      -0.3752853853531592, -0.8434529925516028, -1.2001416776282796,
      -1.3919928541800917, -1.3977021600852477, -1.2315326956581332,
      -0.938663986596253, -0.5836169929048222, -0.2346760010791214,
      0.0518253039501152, 0.24350742458705885, 0.3373717846070913,
      0.3574731241380995, 0.34563198124261707, 0.34773988285742513,
      0.39931235268600884, 0.5141151982443267, 0.6788862715641713,
      0.8556017680303413, 0.9907908668697663, 1.0295768188851053,
      0.9308784813601146, 0.6798599447721823, 0.29435797125863716,
      -0.17651033926631768, -0.6614208486614818, -1.0815418991547023,
      -1.3673898111644414, -1.4738105247716702, -1.3894955434189908,
      -1.138768214073162, -0.7752639037824789, -0.3691047175848277,
      0.009256182562799309, 0.30456496939535144, 0.48792184795961735,
      0.5609460342103045, 0.5521166850369772, 0.5064301131315587,
      0.47118696053623843, 0.4816753817711418, 0.5505099951448698,
      0.6634251899563668, 0.7826495130161827, 0.8570284003717261,
      0.8363110690376225, 0.6859174073916466, 0.39833198532936825,
      -0.0019195198508272227, -0.46117131078516865, -0.9068900850695468,
    ]);
    const expected = [
      [
        2.555225884816682, 2.3904487848764044, 1.5826798443434158,
        -0.03682108594322336, -0.2844983213803794, 0.2689464885363217,
        0.06375730407423824, -0.31329297842916065, 0.20739595763579446,
        0.2056201632041394, -0.2626525866870243, -0.7750955687434945,
        -0.8356907199373439, -0.7650198056622585,
      ],
      [
        -1.9590593188719463, -0.027547266417914232, 0.4450917469271966,
        1.9128351283872491, -1.2030210436144402, -0.17601087655066475,
        1.1871550291841524, -0.9333467150067707, -0.3213800941179524,
        1.3175999238998604, -0.9541756697744899, -0.05130842372305111,
        0.022136533646833958, -0.03597034454527892,
      ],
      [
        -1.8402176347560977, -0.12531424143672912, 0.7409433260150822,
        0.3291149965332377, -3.5790906174091486, 3.0927584240726844,
        0.3668554710729763, -3.153400619975752, 2.7375789149020173,
        0.14587379092273273, -2.7151306038133813, 2.757528881663978,
        -0.29080920154129153, -2.5460914227569953, 3.1246946660231187,
        -0.6279360004673883, -2.773842910122739, 3.6087557777941712,
        -0.3703715216383378, -1.6990740269087503, -0.446601147963823,
        0.9367956399186363,
      ],
      [
        -0.37056312276535036, -0.15893177758125074, 0.6209437786466271,
        -0.5479246068341328, -0.6732253490412129, 1.25854347968372,
        -0.8244264957419085, -0.4077354585111023, 1.4496981562685645,
        -1.3362723357594608, 0.030605967981962537, 1.423578096078012,
        -1.7436097142439115, 0.5576895664432754, 1.1838782259901863,
        -1.977197140160269, 1.084818020089362, 0.7703677466636865,
        -1.997214368387421, 1.5232822584086338, 0.2522515504743678,
        -1.8000064368494442, 1.799385354151071, -0.283550402557377,
        -1.418702688875511, 1.8669239379052045, -0.7471239633433674,
        -0.9176059420885514, 1.7150132562618554, -1.0607887733049868,
        -0.38130206390161225, 1.369930608155682, -1.173812067009394,
        0.10577956882856512, 1.5088508168220358, 1.3233788894020275,
        -0.7662163874107526, -0.9429244439454647,
      ],
      [
        -0.11282723825170124, -0.38756143224547046, 0.7465244092566379,
        -0.34216648460716664, 0.18003198023422126, -0.007671786601286229,
        -0.16346111489584247, 0.23663418147182494, 0.028116704273602702,
        -0.2744620551815887, 0.12732796524966425, 0.09041669854707968,
        -0.19327672261546303, 0.16495162537014157, 0.1204947154485825,
        -0.2844967566459231, 0.04353667104387382, 0.1744051746458178,
        -0.18262794523668754, 0.07183535449439521, 0.19122515212945235,
        -0.254089377766462, -0.05411364617989043, 0.23012371617807276,
        -0.133298205436655, -0.02697877222998564, 0.22827450424038417,
        -0.18840966726203556, -0.14905014295012536, 0.24819018696892814,
        -0.0536223416812257, -0.11479018168441532, 0.22531360551526733,
        -0.0986008156575377, -0.225159309346003, 0.2255992126305518,
        0.04292499359271428, -0.17676202303128263, 0.18278955445828088,
        0.00010777563352082353, -0.26951598249540254, 0.16623117358354136,
        0.14001142361075153, -0.20243396094051702, 0.10784999535799489,
        0.09097977296829264, -0.27457237610417157, 0.08019501471451651,
        0.22121292605527693, -0.18749375455357922, 0.013132583253617283,
        0.158606405772563, -0.23943638818227397, -0.0178838254346671,
        0.27279543312309146, -0.13450758450149897, -0.08537534883582981,
        0.19151612344165128, -0.1700226905550427, -0.11134040666695913,
        0.28604085624010545, -0.052485438527996295, -0.1710444299523344,
        0.1841174378295689, -0.09672326423522096, -0.22157110289380597,
        0.5662632922585091, -0.4754500296181298, 0.266647410050124,
      ],
      [
        -0.0651818043817837, 0.1847590346027833, -0.1029245828676921,
        -0.017000929614660328, -0.009481256107094299, 0.005382796314087182,
        0.013662655154079023, 0.008032198417102766, -0.0054643963865401,
        -0.013299510970539843, -0.007411543536945215, 0.007025495740574126,
        0.01637151712945257, 0.011368260525087243, -0.004025668046079053,
        -0.016158040605666293, -0.014303883097300796, -0.0005703471920075198,
        0.012183069266023666, 0.012426181020375751, 0.000679838757236278,
        -0.011175337285833972, -0.011298844463023237, 0.0007858202639102752,
        0.013646131371869138, 0.014713087706980085, 0.0022321565942972355,
        -0.012884514430917853, -0.017101268664152465, -0.006808884167105275,
        0.008376014475219976, 0.014640303818017425, 0.006842606923143535,
        -0.006851696613349799, -0.012875014656731881, -0.005205397930556174,
        0.008872718925908296, 0.015640102760439673, 0.007977002319675942,
        -0.007736509599513226, -0.017400138068638014, -0.012275354394495355,
        0.002888297896923589, 0.01430221665780003, 0.011982700159430027,
        -0.0010591065437571337, -0.011872624621483294, -0.009934374918894609,
        0.002857669700388095, 0.013989665674420768, 0.012233385940822732,
        -0.0015876360395775183, -0.015150352099673203, -0.016043039454877298,
        -0.0033486220315370047, 0.011471819286853036, 0.015232106520979935,
        0.005223117944173905, -0.00846097179888082, -0.01260111888011995,
        -0.0033823521236829093, 0.01003865505840039, 0.014277918836902131,
        0.004519001069332663, -0.010733398716754938, -0.01747291340368079,
        -0.009276389055931145, 0.00663111651052295, 0.016043017965475317,
        0.01093272288937647, -0.003217408081279044, -0.012754918056984782,
        -0.008792592010148322, 0.004453575617520824, 0.013761821416729499,
        0.009547463472729695, -0.004897783567836696, -0.016321869353016237,
        -0.013888994244983507, 0.0006025849069898614, 0.014280607961994977,
        0.015104420444644065, 0.00297044148531124, -0.010370674039177089,
        -0.012458840032771201, -0.0018223221228751314, 0.010769993145275839,
        0.012644428214208497, 0.001367738243776991, -0.012783892516891202,
        -0.01640315549741951, -0.005590123347664386, 0.01024586583551454,
        0.01703337162434706, 0.009055008398056855, -0.005853152431834346,
        -0.01376226296116427, -0.007728792244240841, 0.00580663393352431,
        0.01328370796458298, 0.007001619455777982, -0.0074572065813366464,
        -0.016390975647576432, -0.010895548102471689, 0.0046246205829687526,
        0.016394558982200075, 0.014006198695929735, 3.156899125646151e-5,
        -0.012484210837151705, -0.012268158404217473, -0.0002901479221830098,
        0.01135536709366343, 0.011049306148654878, -0.0012429575471545606,
        -0.013852411963016453, -0.014412498461372741, -0.001628612423835843,
        0.01329783205558474, 0.016985851440400476, 0.006285844590137771,
        -0.008843247818162314, -0.014674281914111638, -0.006490279103733593,
        0.007184340632367427, 0.012824902668783139, 0.004807405874773546,
        -0.00921528347441676, -0.01554268015190377, -0.04432986519462688,
        0.14048567156676073, -0.0692026167438881,
      ],
    ];
    const result = wavedec(data, "sym4");

    const reconstruction = waverec(result, "sym4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym4_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48754632285931887, 0.9005975236729941, 1.1801678846123522,
      1.294648768405696, 1.2452782447203996, 1.0640099171006452,
      0.8044188870745157, 0.5279594272254429, 0.2889911682531426,
      0.12224975109534397, 0.03579290205227764, 0.011065194425376235,
      0.009938392018347592, -0.01315898116990688, -0.09717864601009008,
      -0.2620941049003406, -0.5014604741225298, -0.7818805269376836,
      -1.0496400160319894, -1.242977576352633, -1.3070283517964831,
      -1.2077793917268922, -0.9415740522225468, -0.5377558223308763,
      -0.053692594198448365, 0.4367334816463446, 0.8584997052653023,
      1.1510708279674204, 1.2806111265112814, 1.245941761562394,
      1.0769243809789069, 0.8257871801889205, 0.5536104826652396,
      0.31533898565933216, 0.14700663415012283, 0.05827189183876491,
      0.03201344669854053, 0.0309633524917462, 0.009594838788853699,
      -0.07182964529864427, -0.23468418555867804, -0.4741472168912743,
      -0.758198733115357, -1.0338296532716067, -1.2390388834622612,
      -1.3177305342704018, -1.233867307443547, -0.9813750769435714,
      -0.5872966811470677, -0.10731571211058205, 0.3853833554320291,
      0.8153362276166372, 1.1205281600493004, 1.2649369190531974,
      1.2449711729579307, 1.0883704287604519, 0.8459604546737108,
      0.5783813482102032, 0.3411020897881513, 0.17141356135934316,
      0.08056124749592308, 0.052872524741685994, 0.05197565910647067,
      0.032433249350093674, -0.04623961588824449, -0.20679867333429486,
      -0.44605450720160555, -0.7334017887495234, -1.0165957855105001,
      -1.2334634717500574, -1.3267381531219675, -1.2583955387706007,
      -1.0199478728654379, -0.6361044440821734, -0.16079996839765565,
      0.3335626719549948, 0.7711640638232999, 1.088581660566423,
      1.247649757496072, 1.2423716895455146, 1.0983370907860455,
      0.86491547017985, 0.6022410741589688, 0.36624598396051034,
      0.19543544257158052, 0.10262664692804746, 0.07360876069722119,
      0.0729412686959224, 0.05532071861992155, -0.02044591224508302,
      -0.17847565361672546, -0.41721840980623015, -0.7075195925051276,
      -0.9979573325022835, -1.2262548283087848, -1.334036251670459,
      -1.2813299915532728, -1.0572412744583386, -0.6841155843813901,
      -0.21407615949578532, 0.28133874227463895, 0.7260414535780529,
      1.055274893363224, 1.228775337052901, 1.2381506751078595,
      1.1068154165412867, 0.8826307247131404, 0.6251600925738721,
      0.3907371886543518, 0.21903788130926405, 0.12443420027272434,
      0.09418871073845195, 0.09382617534122678, 0.07822154474377638,
      0.005513677451953136, -0.1497539818971526, -0.3876761556627181,
      -0.6805836219726877, -0.9779351562230666, -1.2174186213882714,
      -1.3396121026736498, -1.3026386178407574, -1.0932057440676501,
      -0.731267587351446, -0.26707535420286743, 0.2287793723594389,
      0.6800278256742618, 1.0206531468070497, 1.208341399184925,
      1.2323176322856009, 1.1137984817893738, 0.8990864792671627,
      0.6471102544699556, 0.41454328642774624, 0.24218722364377365,
      0.14595050046509983, 0.11457920652976814, 0.11459646287539324,
      0.10109990971187546, 0.031600985902976886, -0.12067323034164551,
      -0.35746609329169704, -0.6526268948011897, -0.9565520373439358,
      -1.20696269722642, -1.3434552288029438, -1.3222914605934073,
      -1.1277934382493875, -0.7774990326482325, -0.3197289839053343,
      0.1759527740586215, 0.6331837190008115, 0.9847633719589213,
      1.1863776914317095, 1.2248841854439192, 1.119281392934718,
      0.9142647799639385, 0.6680648649121395, 0.4376329651989005,
      0.26485060586642956, 0.16714267299690483, 0.13474740624103326,
      0.1352183572869941, 0.12391993343160729, 0.057777521966103695,
      -0.09127363319287696, -0.32662763843527803, -0.6236839276099013,
      -0.933832649042905, -1.1948970739455782, -1.3455574201483946,
      -1.3402606956677008, -1.160958271917377, -0.8227496751519182,
      -0.3719689323253581, 0.12292747557530181, 0.5855707021335643,
      0.947654118612886, 1.162915924628996, 1.2158640607201008,
      1.1232612886170417, 0.9281494776773287, 0.687998715976311,
      0.4599760598250465, 0.2869960008881271, 0.18797842479743448,
      0.1546608450401441, 0.1556582789449735, 0.14664572798707087,
      0.08400452654464402, -0.061596031075900504, -0.2952012220825756,
      -0.5937906927310683, -0.9098035281866731, -1.1812339325174466,
      -1.345912748726171, -1.3565206710204045, -1.1926559802155072,
      -0.866960524322274, -0.4237276246700461, 0.06977223155951334,
      0.5372512916311969, 0.909375469291444, 1.1379897275752753,
      1.2052730632839235, 1.1257373385393703, 0.9407262451175025,
      0.7068881175327444, 0.48154359192445073, 0.3085922633024347,
      0.20842609216525232, 0.17428748498818986, 0.17588289456616962,
      0.1692414520056243, 0.11024302900218064, -0.03168181428486405,
      -0.2632282369313407, -0.5629845728383226, -0.8844930439164286,
      -1.1659876048038682, -1.344517579964934, -1.3710479430767604,
      -1.2228441780315114, -0.9100739219284992, -0.47493811606441194,
      0.01655593294066575, 0.48828886914450675, 0.8699789712870092,
      1.1116345992114411, 1.1931290518463293, 1.1267107395371356,
      0.9519825913588211, 0.7247109258140094, 0.5023078078884408,
      0.32960917304888415, 0.22845468768058463, 0.1935957642628916,
      0.19585916884778337, 0.19167136505106064, 0.13645390402439717,
      -0.001572865129680967, -0.23075098235735014, -0.53130431351909,
      -0.8579313636753054, -1.1491745586846942, -1.3413705811516066,
      -1.3838213102114958, -1.251482417071768, -0.9520336180503624,
      -0.5255341791516148, -0.036652483381525214, 0.4387475974502981,
      0.8295175668422996, 1.0838878583811795,
    ]);
    const expected = [
      [
        2.5396948794592444, 2.264765769031356, 1.5535781757836815,
        0.018691267384487766, -0.12445080471471934, -0.13951606596430405,
        0.2779560410441863, 0.028595564412845755, -0.2779506539524457,
        -0.1827231159287111, 1.5679903205177463, 2.8140654717323326,
        3.1054079742968743, 2.69169884579497,
      ],
      [
        -2.264925993902049, 0.03449599696652335, 0.4616858570973883,
        2.3985538830915707, -0.6279548275565888, -1.6329546320346757,
        0.8573656784249798, 1.5551483916394864, -1.4668885504696698,
        -1.0622982791026678, 2.1167583215444576, -0.019019821841496823,
        -0.23383642734839585, 0.3343418907069996,
      ],
      [
        -1.5823445555985065, -0.1609118347399603, 0.7875282401808481,
        -0.08149567919992055, -2.723529389700845, 3.2809028323396636,
        -1.9607529522482052, -0.13955635505100744, 2.317094845982151,
        -3.5264923223459532, 2.3427861078209653, 1.0704800132332963,
        -3.987576290001002, 3.6225790131727384, -0.34275747646162813,
        -2.7775095814538524, 3.435780464868846, -2.0194135523267005,
        -0.17866073221082604, 0.20752638921929184, 0.11078876715085191,
        -9.549652837431699e-5,
      ],
      [
        -0.3336422909465048, -0.16479866573119423, 0.6033977602878854,
        -0.500515823208842, -0.8007585978711231, 1.4733244550637608,
        -0.9435929176176946, -0.5549495826992038, 1.760988751643765,
        -1.5025684887288702, -0.10131892938913838, 1.6499498811528295,
        -1.762380211294708, 0.3876280846023148, 1.1927964327565586,
        -1.632475606768144, 0.739015032986279, 0.5291784669839239,
        -1.1226141171383879, 0.820721432562803, -0.15402174262431706,
        -0.34231169271390627, 0.5810041407997871, -0.6749332577699947,
        0.5270150908433838, 0.06528995985406724, -0.9066864124821924,
        1.2796599933913635, -0.5947349098160071, -0.811273682199956,
        1.7399650920922212, -1.2168232785405058, -0.44425397803852035,
        1.7861915448762156, -1.9175104091745903, -1.0722966891234986,
        0.3402495889277844, 1.524401550660129,
      ],
      [
        -0.10618548768200534, -0.3796399931098188, 0.7252412854726397,
        -0.32883167496780547, 0.17344344622296953, -8.734774721126659e-5,
        -0.17736205318525625, 0.2152175952689044, 0.06837820109473869,
        -0.26044837914013275, 0.09204373964008553, 0.10691215300569179,
        -0.20543188432933915, 0.11682288465260188, 0.18533732044531276,
        -0.23897150627030783, -0.02571373312513095, 0.18172298573159376,
        -0.17105151117135672, -0.0061217168277806905, 0.2541109857198485,
        -0.15514730385999514, -0.14437860341611175, 0.20140852617165067,
        -0.08576635160019822, -0.11938787746676416, 0.2574539224865767,
        -0.03022114845608906, -0.23051017589105544, 0.15876258866820359,
        0.024426042142704912, -0.19209727760416498, 0.1959156726239657,
        0.10328114840825856, -0.25910433273267874, 0.06445861481549857,
        0.1265041021043124, -0.20527122202782516, 0.08756619021346818,
        0.21043097878935746, -0.22064415015577557, -0.0558258853237691,
        0.1898147483645743, -0.15701492091186509, -0.03711562581478535,
        0.26344528673087264, -0.12387901968582599, -0.1685163149478131,
        0.19479701818748876, -0.06290014479926762, -0.14375969077986758,
        0.24925967983099312, 0.006452661860319384, -0.24150266778435844,
        0.13859069938859, 0.048548491645859754, -0.20365291900918836,
        0.17302954144390342, 0.1363357215931494, -0.2531463720219377,
        0.0359539516929152, 0.14399138110768223, -0.20165920525726183,
        0.05636150218683085, 0.24616517792578657, -0.21310968595384264,
        -0.18424208721350097, 0.4554014601664872, -0.4512980503688861,
      ],
      [
        -0.06304413741665753, 0.17887992449837298, -0.09989789349520493,
        -0.016098279746981397, -0.009125355619202531, 0.004979266407433569,
        0.01317765776516254, 0.008207988006395613, -0.004782710926867068,
        -0.013129743196374808, -0.008513703298634132, 0.005204641662121484,
        0.015452535638163928, 0.01253637606785718, -0.0013471912795597757,
        -0.014019083355866012, -0.014411618031438433, -0.0026374993059171264,
        0.010230548893102862, 0.012437480332420564, 0.00237373107009756,
        -0.010042705221659488, -0.012681157801472526, -0.002566999358007761,
        0.011238790464289841, 0.015941759743252168, 0.00684440677003198,
        -0.008227612419228647, -0.016013946997233255, -0.00990828072742033,
        0.004081733473004806, 0.012974604212828617, 0.00882234667843236,
        -0.004011926440712842, -0.013013918243743488, -0.009240710902274116,
        0.004263789841466574, 0.015173005576191848, 0.013229498106039711,
        -0.0002345386159101348, -0.013414779167995841, -0.014785506955134316,
        -0.003588934778969044, 0.009589046223749176, 0.012658213084916298,
        0.003173426065655568, -0.00950178024197714, -0.012993029842895343,
        -0.0035101171258827392, 0.010513147144267765, 0.016130878534831472,
        0.007843348168803901, -0.007246125999633771, -0.01585859537222526,
        -0.010645996850307725, 0.003168873294276134, 0.012717201422845784,
        0.009399413805993802, -0.0032239772755358973, -0.012843027676364017,
        -0.009929795206882246, 0.003302061556485698, 0.014825633811545336,
        0.013864028261195288, 0.0008790109622453246, -0.01275129005807795,
        -0.015093363100080661, -0.004522435935609456, 0.008908209771525386,
        0.012825613393661242, 0.003959827460274533, -0.008920394628147477,
        -0.013250315919195144, -0.004440334057537158, 0.009739606070394417,
        0.01624830268189722, 0.008807502011434085, -0.0062328449335254665,
        -0.0156330347602374, -0.01133537133905193, 0.0022446652410576945,
        0.012406669875391893, 0.0099368494606904, -0.0024221004059979817,
        -0.012617660586361034, -0.010577881629678418, 0.0023236279277827282,
        0.014411842848546352, 0.014437067705734885, 0.00198845325371709,
        -0.0120316552605549, -0.015333961374218556, -0.005433984998313893,
        0.008191050093552366, 0.012939088653505737, 0.004729700541833262,
        -0.008300896189890236, -0.013451772587745273, -0.005353565192651623,
        0.008921484997252583, 0.016293408689765802, 0.00973252329179021,
        -0.005192338109356542, -0.015338387526104218, -0.01197349326521482,
        0.001313124631738341, 0.012044449284277711, 0.010432479342849077,
        -0.0016095929188357679, -0.012338635590700227, -0.011182061968421027,
        0.0013327457534234198, 0.013933355053705979, 0.014945991894836558,
        0.0030888035087142385, -0.011259162230496125, -0.015506378398549459,
        -0.006319672371198619, 0.007440722497476807, 0.012998270754310537,
        0.005479878717105688, -0.007645794875277497, -0.013596389507516548,
        -0.006245786660457641, 0.008062308021394928, 0.01626589701135458,
        0.010614241930137658, -0.00104992352500545, -0.003860875310255238,
        -0.032451759324381345, -0.0005894146017539625,
      ],
    ];
    const result = wavedec(data, "sym4");

    const reconstruction = waverec(result, "sym4", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym5", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.500596175015037, 0.9221624111646127, 1.202490543551839,
      1.3089668174142268, 1.2442583859944767, 1.0436452961057183,
      0.7648081595175412, 0.47274587940715335, 0.22367818765996617,
      0.051988720523813425, -0.036561249624424086, -0.0637574984521714,
      -0.07043887416852468, -0.10293770431860899, -0.19810775239538736,
      -0.370952327189509, -0.6081926718428461, -0.8695837625056381,
      -1.0967816153856464, -1.2276035927799338, -1.212101842230191,
      -1.026353900398267, -0.6803982860035851, -0.21817748300604567,
      0.2906643002046094, 0.7652463127964748, 1.1307261958288477,
      1.3342217161062346, 1.3555475045970016, 1.2102239226102403,
      0.9441367856695897, 0.6212962927446044, 0.3078395706923811,
      0.05631732217491525, -0.10582225322229655, -0.1807538173688204,
      -0.1968171862529493, -0.19815338572052626, -0.23027561380208522,
      -0.3254508816589829, -0.4918054582886012, -0.7090985661418281,
      -0.9323813154979126, -1.1027120806901922, -1.1622572322428355,
      -1.0699380175587727, -0.81359037573559, -0.4154374976279075,
      0.07067277732012783, 0.5697581239353199, 1.0014720900782905,
      1.2973737836062929, 1.4155265214170334, 1.3489089646005117,
      1.1256553192379681, 0.8011671064509032, 0.44414720964677823,
      0.12009176219560991, -0.12363576361738227, -0.2674767083436326,
      -0.3218001897934963, -0.3211290402802164, -0.31214387163600243,
      -0.33872451239314955, -0.4280311676691581, -0.5813419054208308,
      -0.7721224083303755, -0.9519252436633252, -1.0626785450351193,
      -1.0522480376673582, -0.8892704607896635, -0.573389012779467,
      -0.1381423559513725, 0.3544132186101673, 0.826194823017022,
      1.1997479228517727, 1.415053443680757, 1.4424157795165669,
      1.2883204362637233, 0.9928883720291961, 0.6196329896721545,
      0.24012157600585654, -0.08262116719224255, -0.3078635689655008,
      -0.4247347388337288, -0.45187615034022277, -0.42947386154152284,
      -0.40590919840992634, -0.4226247484466587, -0.5012353244801615,
      -0.6363117472344995, -0.7957836353887442, -0.9289244606056908,
      -0.9799041194852995, -0.9034264375827681, -0.6783872894024165,
      -0.3159444532688392, 0.14022943443414035, 0.6217818990347556,
      1.0498345085507048, 1.3520802671644843, 1.478684415771315,
      1.4131203949085525, 1.1753143918171833, 0.816371401379853,
      0.4062348688019651, 0.017367311084239445, -0.29150536656089515,
      -0.4876064549864149, -0.5693612453298912, -0.5635635344134198,
      -0.5153913120377756, -0.4740173496993945, -0.4776601013833218,
      -0.5420318047685349, -0.6552377139911072, -0.7804947370414597,
      -0.8660001388870187, -0.8594117265319549, -0.7231777769249761,
      -0.4466916488007023, -0.05201251283835884, 0.408501807926155,
      0.8622663062259074, 1.2319061079861537, 1.4523447615464935,
      1.4853807158475296, 1.3281853442665166, 1.013647641261829,
      0.6025032066240382, 0.16921175783133396, -0.21492187619372655,
      -0.49723798342048875, -0.6540697794948526, -0.6935268609585402,
      -0.6502245871659333, -0.5735115631672631, -0.5123812449456894,
      -0.5010662325398711, -0.5491009318214554, -0.6384565996693986,
      -0.7285052171136578, -0.7675272548166236, -0.7077645740452624,
      -0.5200716434639482, -0.2042796280571725, 0.20755412296747827,
      0.6560503921062353, 1.0665392045274102, 1.3653703721364723,
      1.4965440536529306, 1.4345819266189657, 1.1904646789438642,
      0.8091654790290658, 0.3593834763253921, -0.08199594520033787,
      -0.44690028115417285, -0.6903858698312884, -0.7988386112845964,
      -0.7901946919054175, -0.7063423012053516, -0.5998356801690321,
      -0.5184690503643387, -0.4917627048102103, -0.5228813672209194,
      -0.5880739552293155, -0.6437605324553031, -0.6393980832950308,
      -0.5327411084481187, -0.3034635866758143, 0.03850691840291981,
      0.45226963153665767, 0.8732452059471458, 1.2268416226256995,
      1.4452082558504398, 1.482975127958941, 1.3280850480770496,
      1.0050172730741045, 0.5695741615275736, 0.0964859440993735,
      -0.3371413650643298, -0.6684990638087522, -0.8618356526639601,
      -0.914280831342228, -0.8534745506096085, -0.7278103229440753,
      -0.5919511098594399, -0.4914388242213083, -0.4504024210664601,
      -0.4655311448388248, -0.5078348712068445, -0.5316833834332086,
      -0.488719318111647, -0.3429598660385258, -0.08306752034258408,
      0.27153264713767566, 0.6724579150685306, 1.051846923937504,
      1.3372966315955328, 1.468622379513636, 1.4122989025739545,
      1.1699758029456355, 0.7789074085763263, 0.3041310817806331,
      -0.1757319162090058, -0.5856067058513519, -0.869871184920116,
      -1.0032156215029027, -0.9939198137810301, -0.878927746336294,
      -0.7121582917659783, -0.5491716483503575, -0.4321908963133316,
      -0.37933622991111626, -0.38080551642992166, -0.40291755329769613,
      -0.3988882672665618, -0.32345743973710495, -0.14747178589297055,
      0.13148173039205008, 0.48530602501088593, 0.8596553439025111,
      1.1853397659039713, 1.394140651677512, 1.4351430993299474,
      1.2875091332391488, 0.9664621882546225, 0.5209184795157064,
      0.023265684445467755, -0.4462659575053644, -0.816860451829784,
      -1.0418325485701105, -1.1072900996301278, -1.0327591301034478,
      -0.8638076740741107, -0.6587014170699688, -0.4725947776754946,
      -0.34333525107909324, -0.2824944481381788, -0.27385775501155224,
      -0.27965996507955765, -0.2528432233391429, -0.15204921439003333,
      0.04466111746186713, 0.3310559909666013, 0.6713823962510959,
      1.0069560371525197, 1.2691869519517196, 1.3958626910200997,
      1.3466349023406021, 1.1138020619089053, 0.7256173422687016,
      0.2411919332046837, -0.26185272415917127, -0.7040303169646366,
    ]);
    const expected = [
      [
        3.234538791931937, 2.625799157555288, 2.4730302663983696,
        2.4555330877125545, -1.3327799213573517, 0.9738460363813863,
        -0.5310297526131789, -0.26430203229985505, 0.8229074830067573,
        -0.635604478466633, -0.15704291007453391, 0.8362291431435396,
        -0.7402993117472966, -0.08217537608242899, 0.8580713480898149,
        -0.8137975253036263, -0.03412484571360796, 0.9280427124769417,
        -0.9294813133898967, 1.939462731295818, -0.22995386245259922,
        0.4188217645129046, -0.0229226032519053, 1.9295308719965933,
      ],
      [
        0.6373881114049592, -0.4233043279663394, 0.428078564139559,
        -0.932258170976159, 1.963406311502532, 0.38895242686738724,
        -2.878982599444545, 2.963994563593507, -0.41140951319347174,
        -2.6735100728842816, 3.465148825357291, -0.9696181902321479,
        -2.685255026978523, 3.9293975502517995, -1.28750723856207,
        -2.799521791571388, 4.197860409067816, -1.408894376721425,
        -2.4450912371632527, 2.2225972904370783, -0.17559883755027147,
        0.0219311449998867, 0.5917436533256907, -2.528534411255472,
      ],
      [
        0.2729429688698204, -0.23828782781790747, 0.23895115115125065,
        -0.4842358589948428, 0.8607704217933569, 1.0598588109468403,
        -1.9263289955784468, 1.1949986263083845, 0.5911815164871949,
        -1.8575097469770372, 1.4953101898063885, 0.15631776409937734,
        -1.6322863379923789, 1.6600872229305392, -0.2707729610107662,
        -1.2809248620192002, 1.6666608579567557, -0.63514016948009,
        -0.8464293857236354, 1.5114675927313241, -0.889510550902847,
        -0.38173562415613216, 1.2104877817445416, -1.0000317232090785,
        0.05671379546931766, 0.797312472890494, -0.9503870593002154,
        0.41581932554036355, 0.31907318546009433, -0.7437822005969452,
        0.6522684287337723, -0.1692714215866284, -0.4047254181330642,
        0.6928378416863002, -0.1653577443895013, -1.6067784277450414,
        0.356128757092501, -0.6292759337768346, 1.2893589974369224,
      ],
      [
        0.7453579003767877, -0.9162592187262439, 0.8818144210832141,
        -0.6523156856396203, 0.26207657481664737, -0.05992464923476114,
        -0.11415076488289691, 0.19273428852764748, -0.05802962298585334,
        -0.1772696698842097, 0.1792380759404505, 0.014687949885657662,
        -0.15634576679405204, 0.16390942747635973, 0.012030022056849972,
        -0.2102230025534566, 0.13784486619513694, 0.08278396069852541,
        -0.17717685698222663, 0.11536438950471413, 0.0784141591403385,
        -0.22008085894472162, 0.07948859238183162, 0.14301319223572598,
        -0.17406234121334063, 0.05311503950939532, 0.13313886885566656,
        -0.20569786951917693, 0.011127243511943795, 0.18799138549657277,
        -0.1473318905523863, -0.01516024492303076, 0.1696398898644107,
        -0.1688651629849458, -0.059066193028294134, 0.21218056576694053,
        -0.10018663762845798, -0.0810526925862712, 0.18356909098207758,
        -0.11409289522183089, -0.12269533821733693, 0.21256130531888132,
        -0.03831077991889894, -0.13644389645022564, 0.17332198345391797,
        -0.04806280843860562, -0.17215914127719983, 0.18899934434331148,
        0.03081817424614782, -0.17449133022557908, 0.14023225481311527,
        0.0211827417145736, -0.20157408121964748, 0.14426207652691764,
        0.09883680845036691, -0.1904590206283912, 0.08840971606029219,
        0.08521687107942447, -0.20748793206572874, 0.08368289816266504,
        0.15751072729505974, -0.1822925642189928, 0.024241329355219554,
        0.13625090596479159, -0.19230792302378774, -0.03868411250681757,
        0.577184882186982, -0.9169481373690694, 0.9031244862352823,
        -0.5336614589894816,
      ],
      [
        -0.03581199952499302, 0.17138294409429614, -0.15710471958248343,
        0.02152958326667699, 0.00451672979399137, 0.0071728361052440966,
        0.0030604136087434286, -0.0037294935643731597, -0.006623144346222687,
        -0.0028412086712047363, 0.003953067886341669, 0.007152253431827869,
        0.003521641165898051, -0.0036764149937856955, -0.007732179239166637,
        -0.004828354281426073, 0.0023432032720256497, 0.00712090570845476,
        0.005161451432191606, -0.0014860002308449832, -0.006375926319579214,
        -0.004823629496065361, 0.0016342948202790145, 0.006715952628591424,
        0.0054002419136247905, -0.0012523907403139134, -0.007057261591441693,
        -0.006544689618542699, -0.00014390114444050826, 0.006209462068599455,
        0.006673427165629124, 0.0009979599293075056, -0.005287883734592717,
        -0.006164401184495033, -0.0008522072374438179, 0.005461485587909293,
        0.006587448204264414, 0.0012642126755144784, -0.005592986812323383,
        -0.007523853130618128, -0.0026455374743794245, 0.004545987535075867,
        0.007410202086813471, 0.003419472046370678, -0.0034909527391318793,
        -0.0066991573719271625, -0.0032019204646702142, 0.0035442278641775165,
        0.006941863984470222, 0.003569505008633579, -0.0035170953937861543,
        -0.007648600749698562, -0.004860826454216606, 0.0023292277025450513,
        0.007279640452730215, 0.005483072186902457, -0.0012032465747972634,
        -0.006361476010607374, -0.005127000427851178, 0.001199991388734785,
        0.006423233433636263, 0.005385366845258992, -0.0010814074971229187,
        -0.00690525268932413, -0.006523564382859524, -0.00017492156911659692,
        0.006294797037600698, 0.006936608377203023, 0.001297414771895579,
        -0.0051909436819791085, -0.006391214784234897, -0.0012836005381878166,
        0.005097320415628485, 0.006493198635093662, 0.0014187377526705541,
        -0.0053853504471996945, -0.0074345238980894415, -0.0026656765122769393,
        0.004572338879848533, 0.007601845549268217, 0.003707221259344723,
        -0.0033283543982455706, -0.006838618159183003, -0.0036020260788745886,
        0.0031279212148945454, 0.006760446113951754, 0.00368032412475822,
        -0.0032745444165896524, -0.007485626667944166, -0.004843861834928358,
        0.00231839276199778, 0.007396100178598361, 0.005733243956760205,
        -0.0009986255610888797, -0.006412483197347671, -0.005470828469706961,
        0.0007569799063779463, 0.00615668299467222, 0.0054294315187383545,
        -0.0008300607146287647, -0.00667305440674114, -0.006448211936350284,
        -0.00019646403736189953, 0.006342279021141272, 0.007128985991843313,
        0.001516495605948017, -0.005162190299420574, -0.00666014448674913,
        -0.001724780424363092, 0.004757299136418768, 0.006454477773606294,
        0.0016505181366918593, -0.005097707071513587, -0.007287071446767097,
        -0.002670034605905678, 0.004566103636895507, 0.007724298808420828,
        0.0039126228036164695, -0.0032372398932099707, -0.007022607368975262,
        -0.004013146395790937, 0.0027343466050896645, 0.006631894819513574,
        0.0038653698886536667, -0.002952952643848845, -0.007261647921633899,
        -0.004805170528110017, 0.0022808575228630695, -0.017107715696942617,
        0.10748749542630892, -0.09853863384859005, 0.008184459388317907,
      ],
    ];
    const result = wavedec(data, "sym5");

    const reconstruction = waverec(result, "sym5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym5_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5082625887277983, 0.9366566975110293, 1.2219056205755696,
      1.330005335202928, 1.2620458326469357, 1.0519086675743516,
      0.7565637866985091, 0.4414842659107526, 0.16485579666132288,
      -0.035506897293607786, -0.14936622843420624, -0.19374834114891532,
      -0.20539598761749422, -0.22811499278778802, -0.29843303981463287,
      -0.4334064592069571, -0.6238491415848728, -0.8348600018837903,
      -1.0136446225502862, -1.102737794498863, -1.0553143516509569,
      -0.8486863390608139, -0.4924775953949418, -0.0292482102192248,
      0.4728062612661162, 0.9334937841051744, 1.2774340268279971,
      1.4500609059716323, 1.4290177059976372, 1.228253637989507,
      0.8939038208845878, 0.4930299966126417, 0.09802144836339438,
      -0.2295221196717797, -0.45153301661090633, -0.5598444892427148,
      -0.5748186242109046, -0.5368232259764187, -0.49293961716879237,
      -0.4824606949757836, -0.5250076635061363, -0.6143896767658432,
      -0.7198330698701462, -0.7942953734675504, -0.7877375134513904,
      -0.661921769303624, -0.402864959332914, -0.02761973004263535,
      0.4165512292874478, 0.8606494056624359, 1.2281824095481082,
      1.4518246325587223, 1.4885026025924533, 1.3292537594318263,
      1.0014557095622738, 0.5628685847523808, 0.08891826397956082,
      -0.34371970213432923, -0.6733011023983047, -0.8651230298520365,
      -0.9167706080546898, -0.8554342455489179, -0.7282064069834893,
      -0.5879973015370825, -0.47876298651595733, -0.4238561963491483,
      -0.4204644616043619, -0.44150824749315254, -0.44443756034763116,
      -0.38457808148167255, -0.2294894777375604, 0.029489635997639208,
      0.37164885131083897, 0.7489130855739609, 1.0951759570529636,
      1.340816222148787, 1.4289075180579962, 1.3291488541222156,
      1.0460494427186653, 0.6192744139891897, 0.11595851653379959,
      -0.3832485493993153, -0.8011151856735635, -1.079732479112445,
      -1.1916535374873487, -1.1437192804548917, -0.9728318749166638,
      -0.7349157769202375, -0.4899613995327479, -0.2869668156717841,
      -0.15255242015421533, -0.08603701603233682, -0.062083286956865734,
      -0.04007156453355845, 0.02236467339993542, 0.15527484592195973,
      0.36557107282409274, 0.6323998587800588, 0.9100739331773486,
      1.137994819756243, 1.2551897862504342, 1.2158674011126633,
      1.0020740931681156, 0.6301953055006844, 0.14952808383164326,
      -0.36691014430468977, -0.8372613148176322, -1.1879127642933076,
      -1.3687551584003166, -1.3630188255798958, -1.1894197679091625,
      -0.896225718985877, -0.5488186763867918, -0.21389495304685535,
      0.05578038409445524, 0.23235037472174896, 0.31698560944001847,
      0.3363201199919745, 0.33233231130865704, 0.3484545193812586,
      0.4156344454987793, 0.5420610026735504, 0.7093103389323547,
      0.876007482299988, 0.9881549119712568, 0.9935429141285737,
      0.8565676613550184, 0.5696191659700591, 0.1580080772524007,
      -0.32302064357888965, -0.7986806054819722, -1.1900878465185114,
      -1.4311233875332068, -1.4826984991867427, -1.3410141762052368,
      -1.037855873728587, -0.6328969881543058, -0.19992022751137428,
      0.18967528225490526, 0.4820923591456293, 0.6514589257833759,
      0.7028967519926058, 0.6678127595372282, 0.5928394031657336,
      0.5254249830124489, 0.499880648632907, 0.527528810725817,
      0.5935117138663741, 0.661085338762193, 0.6822816269896176,
      0.6121626825148994, 0.4229344500591025, 0.11417801645771708,
      -0.2836003190198038, -0.7132378376720339, -1.1021765542902733,
      -1.3781156694336112, -1.485315535070567, -1.3975985391380257,
      -1.124858958969825, -0.7114542339342483, -0.2268180467665096,
      0.24947722948274043, 0.6446431640210479, 0.9075600420971108,
      1.0181357927957597, 0.9890425797336719, 0.8596334546667919,
      0.6837727678880228, 0.514795847059716, 0.3914776249124095,
      0.32857397359713847, 0.31428719252171944, 0.315206946066825,
      0.2873456977682564, 0.19031174242563204, 0.0008416849725395581,
      -0.2779440461999201, -0.6141284961370475, -0.9522629006742175,
      -1.225186510218739, -1.3695893105367969, -1.3415093983793405,
      -1.1279083561365384, -0.7513839718438559, -0.2667353610633125,
      0.24991929055875425, 0.7169508735954779, 1.0642276294756676,
      1.2473101056734246, 1.2555193839520586, 1.1120778918903247,
      0.866470093010556, 0.5810682797802873, 0.3154447321382364,
      0.1123052611342053, -0.011493343116884769, -0.0667150376739536,
      -0.08603810709766649, -0.11251713834102989, -0.1853456270919649,
      -0.3267349652881324, -0.533435113729784, -0.7752314052236201,
      -1.000961036305068, -1.1506537032966537, -1.1708033374579574,
      -1.028926800599669, -0.7236787591536475, -0.28784606237395616,
      0.21672003200688683, 0.7111906997773901, 1.116082658520473,
      1.367974581615902, 1.4326587944723446, 1.3116302822427486,
      1.0404370995788026, 0.6793973326842296, 0.2990356403360635,
      -0.03615124164658812, -0.28163579451979404, -0.4211745352689238,
      -0.46761771345861225, -0.4562458323417219, -0.4325506151204946,
      -0.43776537370707874, -0.49599146344498196, -0.6063294871547763,
      -0.7421186393763916, -0.8575457965166969, -0.8999735111883662,
      -0.8248368830920525, -0.609253759140971, -0.2607620911658294,
      0.1812211254288847, 0.6518259956294846, 1.0736793315305329,
      1.3733710835061057, 1.4975221324007957, 1.4245950520789266,
      1.1696012057448888, 0.7805744253129466, 0.32767789999450647,
      -0.11240864340925061, -0.4730512492672303, -0.7112146243671909,
      -0.8148361994208225, -0.8024192570538944, -0.7151940652567985,
      -0.6040417789217097, -0.5146551679719726, -0.4748048341232445,
      -0.48699401649761725, -0.5283702543964717,
    ]);
    const expected = [
      [
        3.237946751329937, 2.708261714045082, 2.5317705813113274,
        2.4296805082830057, -1.2817892643598983, 0.7580945245895234,
        -0.16087076346932108, -0.4887238250907525, 0.5534382056508946,
        0.03463499681047258, -0.5888326678315097, 0.45125952870714336,
        0.23074657838515805, -0.6536908611994057, 0.296754919840749,
        0.4343829083686691, -0.6594108703786133, 0.029921446109963053,
        0.5488746160468592, -2.830035489473258, -1.9146292869546797,
        -1.9110009817267892, -1.9022826077326107, -2.078547730471445,
      ],
      [
        0.6538638351176126, -0.44203340137848524, 0.45427427434225837,
        -0.934999492757686, 1.6719688049775872, 1.3649135653250273,
        -3.2949784350322626, 1.487065322969832, 2.0307122606528103,
        -3.2146531850031543, 0.6434939061714119, 2.76687706937216,
        -2.9930561283014767, -0.386125114614837, 3.45530330262773,
        -2.434480901999866, -1.6466118510440828, 3.9120494500825758,
        -1.5938746216700506, -1.7355719108188596, -0.012487908346539518,
        0.0025546568447546436, -0.3890518712467234, 1.1529068830047744,
      ],
      [
        0.30105172258107876, -0.2480808665300564, 0.2483164919392533,
        -0.5233816395171039, 0.984585736467337, 0.9239753566986191,
        -1.9480132523911062, 1.4834178037370351, 0.19926036270371933,
        -1.733715281418093, 1.8656651847117247, -0.48213021982600623,
        -1.2913165266743152, 2.011902834413402, -1.100647913706306,
        -0.6898455988574829, 1.9009745741044828, -1.5637465952055831,
        -0.021858599756983933, 1.5541458520765734, -1.805157865335426,
        0.610057174887966, 1.0312879366957488, -1.7961299301740419,
        1.1109533401249625, 0.42032650782819403, -1.5500789439268554,
        1.4097988521492986, -0.17817887293788376, -1.1198431212721818,
        1.4715015404007319, -0.6685994104287779, -0.5873603522943566,
        1.3251688275031028, -1.0704007488589233, 0.2505451232021615,
        -0.09002832569121112, 0.10925487523441624, -0.3801808654172666,
      ],
      [
        0.7574878812654106, -0.9317652540265315, 0.8966821518484689,
        -0.6630215749358184, 0.25989816998625925, -0.0483217131521756,
        -0.1156229399247111, 0.1810005221242713, -0.05002476476880518,
        -0.1826494093102403, 0.17402902192971806, 0.041761055705118594,
        -0.16388631784883423, 0.1345327575732692, 0.030605244041614667,
        -0.20890689088782277, 0.12263958849582113, 0.12108763462625319,
        -0.18051137339506568, 0.06300694298637032, 0.10201580846460682,
        -0.2005443267107302, 0.05109756004632772, 0.18282001571949844,
        -0.16309403768646183, -0.021538560388184802, 0.15151171619590229,
        -0.1584680577276874, -0.027334078110666942, 0.2160217441787367,
        -0.11532240974675578, -0.10470191769099724, 0.17039835959233507,
        -0.08949683340290432, -0.09824027924288821, 0.2146870238621128,
        -0.04630486118853719, -0.1722497231515342, 0.15551886739037454,
        -0.005174415805165519, -0.14862254642654468, 0.17880797492294548,
        0.031062903285538797, -0.2126214770457621, 0.10980712796509591,
        0.08025317551684354, -0.1692141188504775, 0.11438368877546609,
        0.10240209868578387, -0.21896373443265582, 0.04175898252491629,
        0.15233833212876602, -0.15613142188493057, 0.032369237035668116,
        0.15441782227313033, -0.1903341983683525, -0.036084498644696476,
        0.19896840004096286, -0.11156907194978422, -0.053249648818520526,
        0.1772736082953257, -0.13186287811459474, -0.10937274437448292,
        0.21247394363521202, -0.04325115488149917, -0.10360143050832121,
        0.06817999589407542, 0.09732935391741755, -0.06610342227888188,
        -0.09971846118817605,
      ],
      [
        -0.03633897213964479, 0.17380303920793944, -0.15930912837400216,
        0.021841629974702972, 0.004295158647349225, 0.007048507226143204,
        0.003257641542711888, -0.0033050206097980823, -0.006344748545514025,
        -0.002994696607714598, 0.0034876797225162383, 0.00681202812884315,
        0.003621284256897804, -0.0032883339012153463, -0.0075372713859656534,
        -0.005124304424153441, 0.0018118097525259675, 0.006965343141601493,
        0.005727979333162103, -0.0005478764864593061, -0.0058733569942606405,
        -0.005275682938689367, 0.0005387212005147132, 0.00588888272275803,
        0.005518118537844129, -0.0004023747991187161, -0.006384241932364615,
        -0.006757160733053335, -0.001010151929888771, 0.005682934062098917,
        0.007260278948014648, 0.0024029255936421634, -0.004272210449272918,
        -0.006564882730273669, -0.002496323578720573, 0.0038813387377730733,
        0.0063568957521662715, 0.0024573324015950745, -0.004187213072449434,
        -0.007244355545629766, -0.003653924981211033, 0.0034439329589353238,
        0.007592876487755917, 0.005025865923326836, -0.0018328680454100486,
        -0.006648844857923917, -0.005097429150337972, 0.001129903355698944,
        0.0059808228379307875, 0.004785166762314368, -0.0013257210257629128,
        -0.006484117346003245, -0.005634233661324171, 0.0006587919518183556,
        0.006673812922755266, 0.006854408308680667, 0.0010021517274553145,
        -0.005528838804629777, -0.006821142185825836, -0.0018914398249937348,
        0.004450985764737729, 0.006172706130506621, 0.0017054737640077632,
        -0.004594415407452318, -0.00658378005985932, -0.0021673440558923115,
        0.004669815569018198, 0.007559662459114221, 0.003718047608434293,
        -0.003420123783763834, -0.007378554506830878, -0.004658731640405145,
        0.0020357073882445627, 0.0063809170834975395, 0.004383606299331887,
        -0.0018925963116960057, -0.0063187935226115925, -0.004524445283615694,
        0.0019366551483998191, 0.007008771855686418, 0.005819278913319572,
        -0.0007133073799288495, -0.006685940581796133, -0.0066904544846541625,
        -0.0008368766563257961, 0.005382265188678908, 0.006250020565392502,
        0.0011602584573263235, -0.004872056255400676, -0.005988195347606756,
        -0.0010438697237817318, 0.005288685214594027, 0.006917756422357075,
        0.0020953486468868214, -0.0048791108057703834, -0.007632515241392926,
        -0.0036546306900441285, 0.0033652970266720853, 0.006990883106357367,
        0.004040420025626802, -0.002487542944954124, -0.0062953311395501955,
        -0.003749163593107134, 0.0026910952513936673, 0.006802053292956954,
        0.004492319952111757, -0.0022889542259713277, -0.007320757189302016,
        -0.005912198187037695, 0.0007008919699984153, 0.006492222604590019,
        0.006253706249945347, 0.0004223905253741139, -0.005390379476730919,
        -0.0057081937782461605, -0.0003387992742068229, 0.005475367288995085,
        0.0060382432539098745, 0.0006174864694926362, -0.005809939489372862,
        -0.007200672658918158, -0.0021238300480479703, 0.0048595677657056364,
        0.007422477179484965, 0.003349702055724678, -0.0034355123625800198,
        -0.006584632488948104, -0.003857183159671266, 0.008849187146446478,
        -0.0015521805662512007, -0.007527467275034411, 0.004063087644359052,
      ],
    ];
    const result = wavedec(data, "sym5");

    const reconstruction = waverec(result, "sym5", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym6", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5036859704682074, 0.9315149056491887, 1.222513813985559,
      1.3421598624700346, 1.2880853170798565, 1.0887438328461747,
      0.7954939920284414, 0.47007060794366257, 0.17045287234829526,
      -0.06154236927819429, -0.20808564460076737, -0.2768673459401809,
      -0.29616943375416827, -0.30487651106351327, -0.340044517170536,
      -0.42522166698180297, -0.5625138755237608, -0.7304557032327488,
      -0.8883127474226985, -0.9858484055481496, -0.9762213528688128,
      -0.8288705112776185, -0.539189426461502, -0.132509100925645,
      0.33877009876877884, 0.8044434967270775, 1.1901884179421305,
      1.432628642185583, 1.492376395378942, 1.3620910611001311,
      1.0677290414296237, 0.6627229460822194, 0.21645186577322767,
      -0.2003348681364505, -0.5298061758424621, -0.7378289423570239,
      -0.8188859950866828, -0.7941929565041248, -0.7036953019339862,
      -0.594068290164256, -0.5057618748773018, -0.46231336810729573,
      -0.4645528327783429, -0.4910966676233466, -0.5049614630809919,
      -0.4646105228471388, -0.33663634436682865, -0.10685218095374527,
      0.21307991041405233, 0.5853010890524857, 0.9519978754625622,
      1.2469475422207545, 1.4097752812221889, 1.3996335345034807,
      1.2050924541473245, 0.8478713088892325, 0.3794477471223183,
      -0.12877602442741476, -0.5995815255885981, -0.9651630815448143,
      -1.1800759816672317, -1.2290487394517888, -1.128015363780839,
      -0.9183107484410348, -0.6555593212137354, -0.395998530986544,
      -0.18352953030870756, -0.04055056697930154, 0.03533476763909446,
      0.06809791833404633, 0.09451455610435625, 0.15215644980623505,
      0.2672454842298351, 0.4454984012713033, 0.6683567993695876,
      0.8956763468109976, 1.0743597041892885, 1.1509420349836308,
      1.0851324380430274, 0.8610236000103595, 0.4931794418259927,
      0.02598210132053852, -0.4738106003332762, -0.929749756785629,
      -1.2708309243234215, -1.4456946871329008, -1.4327029783985399,
      -1.2436450470053848, -0.9202945350210502, -0.5246847875839097,
      -0.12540498051673438, 0.21689296374661393, 0.46145461209801764,
      0.5941789931747159, 0.627773676265754, 0.5955047107485293,
      0.5402659800567334, 0.5017929515425312, 0.5052564986145878,
      0.5540977727392267, 0.6288977015505166, 0.6925732761513013,
      0.7006200452554836, 0.6138559721773884, 0.4104720360655081,
      0.09431853814510704, -0.3027734434838528, -0.7254242982266911,
      -1.1050637187859973, -1.3739500013153636, -1.4796758215312331,
      -1.3968198138848282, -1.1330259011344463, -0.7280589329977623,
      -0.24599816328216484, 0.23769084642589594, 0.6512926779692529,
      0.9407836338770164, 1.079482054826154, 1.0713399023521066,
      0.9473132634049912, 0.7558725574999828, 0.5500691381430034,
      0.3743432487171737, 0.2542594921421271, 0.19159420585978643,
      0.16586073392013884, 0.1417673346035931, 0.08064200654469267,
      -0.04711943916827449, -0.25178558202329676, -0.5188839981143791,
      -0.8101622445072629, -1.070866679973565, -1.2417365359354207,
      -1.2729292332541016, -1.136570105077809, -0.834884673678841,
      -0.401865803283954, 0.10208144548706947, 0.6014394370701804,
      1.0203518936481468, 1.2975825936840193, 1.398317668581933,
      1.320199328841708, 1.0923162919154676, 0.7675057963343785,
      0.4098587610723281, 0.08040104895557448, -0.17570351002252382,
      -0.33750307403785584, -0.41034449205907575, -0.42141011047394805,
      -0.4100006976272803, -0.4151171873988903, -0.4635246069795239,
      -0.5613367309672805, -0.6912764057783688, -0.8163580875709372,
      -0.8891458873883584, -0.8643468628663233, -0.7116425049446984,
      -0.42555018257097593, -0.029771197371853242, 0.42523239551147785,
      0.8710884527203826, 1.234912567324658, 1.4542679813608852,
      1.4902946162175357, 1.336003068735904, 1.0178256722023873,
      0.5900630181131425, 0.12349628995190914, -0.30923140446871983,
      -0.6481415022849104, -0.8570919586616115, -0.9291568914147925,
      -0.8851656418007445, -0.7659756052362823, -0.6205223886557043,
      -0.4926579968834532, -0.410025020426122, -0.3776693465833864,
      -0.37790020815177894, -0.3763537966755205, -0.3326801197081754,
      -0.21312296073056824, -0.0017774248915262691, 0.29239313011940515,
      0.6346885856091977, 0.9703772757686213, 1.2358004305721764,
      1.3723682333726919, 1.3401947474973115, 1.128143604726463,
      0.7578493407439875, 0.2806560097903697, -0.23194885990261194,
      -0.7023173449067741, -1.0619279989612163, -1.2645642559888188,
      -1.2944701396170069, -1.167745695574673, -0.9268206551147604,
      -0.6294470245031442, -0.3349008975010489, -0.09068688701980354,
      0.07714416916247724, 0.16787400052332685, 0.20343624926484885,
      0.22002277071764953, 0.2562086996311067, 0.3406644115168504,
      0.4826097886437578, 0.6674844375823914, 0.859021348844653,
      1.0073308167977124, 1.0611072054517907, 0.981024220167226,
      0.7510390927226256, 0.3847693526791746, -0.07476407809252536,
      -0.5621831773398027, -1.0021407689797663, -1.3243274242083183,
      -1.4777323438572305, -1.4409381688671317, -1.2261296024839043,
      -0.8759393317599286, -0.4539016654713947, -0.030746129775234998,
      0.33030419246157616, 0.5858796651943725, 0.7197091945949499,
      0.7432598692284391, 0.6898536995742998, 0.6038933615151834,
      0.5279723028028036, 0.4911110253259926, 0.5010423003375468,
      0.5424432822651393, 0.5815307181664473, 0.5758547902729493,
      0.48682922838184534, 0.2918340181677582, -0.007206853765400423,
      -0.38104981019515244, -0.7770550490833185, -1.129094299662487,
      -1.3712714560199504, -1.4523317608033366, -1.3474169809620546,
      -1.064396349372736, -0.643233808203298, -0.14845224200833415,
    ]);
    const expected = [
      [
        3.3429013598742356, 2.737566611468555, 2.9505831263983793,
        2.99878598931973, 2.27076386366691, -0.31796927380777273,
        -0.3602095679857587, 0.5468369544458962, -0.05411029911230908,
        -0.48943302092383895, 0.41229059007097846, 0.16074126808683917,
        -0.5188944388992668, 0.247777787335308, 0.3135333476632666,
        -0.4986578952745781, 0.08352189073911431, 0.44855805296583273,
        -0.5125308355017499, 0.3946754219851379, -4.16575769233848,
        -4.169448325609352, -3.8463466031639597, -4.142136856819595,
        -4.419207801563484, -2.380258739543949,
      ],
      [
        -2.125236863559158, 0.5026090952820743, -0.04677044802947845,
        0.003360224116766848, -0.010452945107298987, 1.0807450725820762,
        -4.408388415803969, 1.797496972725539, 3.0674960812496006,
        -3.7455782687538126, -0.2592268942441903, 3.561040047149463,
        -2.377813025634259, -1.3759252628993097, 3.321384333335696,
        -1.5186784012440342, -2.0324377924537753, 3.42269020145693,
        -0.7661601178388175, -3.000145910590609, 1.5914825871288225,
        -0.7376688993090947, -0.27469902637570953, 0.0868274911516544,
        0.4139050506694881, 0.3556931196332829,
      ],
      [
        -1.3556984832377412, -1.0384051847732583, 0.04882030836325031,
        0.3317488891876621, 1.6163019636754596, 0.27235375593747807,
        -0.6354222630725511, 0.36881587147861633, 0.12132594402656795,
        -0.6224908497762296, 0.9030998045109877, -0.7213227623375059,
        0.0371549574243545, 0.8283218479455795, -1.3019801650527305,
        0.9473414112332783, 0.13823653390686458, -1.276334969115163,
        1.634247722198177, -0.8548342205367017, -0.6023158670532582,
        1.725997571000291, -1.6772992568523535, 0.4366399139890812,
        1.1402575452096926, -1.9308437629928397, 1.3715628507082724,
        0.1269774013735158, -1.491631468553839, 1.7810774133425522,
        -0.8552211069243738, -0.5722798870816511, 1.5003464493007508,
        -1.3748300054330433, 0.41004803200053885, 0.9745376473853257,
        -1.7446168086398326, -0.5857668568454595, 0.8602083087711583,
        -0.899931431252298, 1.4651776304624713,
      ],
      [
        -0.3131648617032839, 0.7741511481793836, -0.634139824973379,
        0.43721212252553854, -0.44693783148392624, 0.024095718950050922,
        0.12850929630219596, -0.09762774090634374, -0.033318135175997764,
        0.14566818481206273, -0.07593564169445384, -0.10348471116914462,
        0.13574804751695965, -0.005711123660829608, -0.11249535775258775,
        0.1143502751333461, 0.023263591300468317, -0.15258448461124385,
        0.0771295475301507, 0.0939326868550326, -0.1297926356428359,
        0.025802390724383818, 0.1054486077972941, -0.13031387584680248,
        -0.01968005994067445, 0.15208490902867913, -0.07719547099573076,
        -0.07678502306900606, 0.12891366796393827, -0.04708222295737797,
        -0.10492457635001198, 0.13995340201446976, 0.01806511618976641,
        -0.14313646609233904, 0.08163544158859637, 0.05630246588871086,
        -0.13471560873876784, 0.0637566936537294, 0.1072037433317187,
        -0.14105926441433267, -0.012686760478313894, 0.12906271895070348,
        -0.09308922203909553, -0.038400152890443115, 0.14438827271615146,
        -0.07254596551387876, -0.10651644020383297, 0.13587530613221796,
        -5.311308223383132e-5, -0.11563202819569554, 0.1097709425238813,
        0.02726288011981265, -0.152330147105944, 0.07454037078697108,
        0.09841322584731015, -0.12978029902023086, 0.019490405525311318,
        0.10773384345445879, -0.1264704943207605, -0.022963773748164502,
        0.1533915065117969, -0.07452760739963851, -0.08237356119363276,
        0.1281578173700872, -0.03996256439680325, -0.13685079802222044,
        0.25672027840507633, -0.3512233122276633, 0.42082022063434005,
        0.10046754414422385, -0.6965945695981056, 0.5230333157193083,
      ],
      [
        0.009212758795839085, -0.05319652668809409, 0.13796551389324108,
        -0.11473276820026648, 0.017388115792979473, -0.001633440934214747,
        0.0010550217762365227, 0.0026981388733106557, 0.0018564829555718608,
        -0.0006614643671198151, -0.0025399909313308334, -0.002050252444335765,
        0.00038600119209138226, 0.002569849884166327, 0.0025021073160248868,
        0.00018861090844746534, -0.0023493626654130916, -0.0028733623625168837,
        -0.0009253999087538989, 0.0017645414269482837, 0.0028258300414611207,
        0.0013622467159068261, -0.0012597530394736136, -0.0026524013854494002,
        -0.0015593058905739917, 0.0010151773798420562, 0.0027139204183332906,
        0.0019556335236897444, -0.0006298974662419477, -0.0027525377223029087,
        -0.002508386825058429, -8.806338689596946e-5, 0.0023862425004883524,
        0.0027510312959944296, 0.0007267948205703519, -0.0018447846814600086,
        -0.0026607163008613155, -0.0010220493520396341, 0.0015483653995973295,
        0.002687380533352506, 0.0013283187014344515, -0.0013291097034260567,
        -0.0028897528491372976, -0.0019153784237376185, 0.0007739168523321488,
        0.0028201912597603292, 0.002427881320648517, -3.647388759728601e-5,
        -0.002377289023213377, -0.0025357104224951743, -0.00042532302080880695,
        0.002006182094745731, 0.0025401960271671173, 0.0006885869965281583,
        -0.0018657136012305, -0.0027850377897206957, -0.0011877438495411716,
        0.0015444656959686005, 0.0029917522681484465, 0.001858572064370222,
        -0.0008646310958346087, -0.002782707834469291, -0.0022313474863273897,
        0.00024560060807148195, 0.0023981510973513677, 0.002297055951110096,
        6.441046575690786e-5, -0.0022448514030562012, -0.0025016809386324366,
        -0.0004296756177006814, 0.0021337962182884055, 0.0028801660107621134,
        0.0011036805906361538, -0.00165501248746696, -0.0029761799255264305,
        -0.001716539146080852, 0.0009768204292243052, 0.002700587163483887,
        0.0019480501334322529, -0.0005502312015484758, -0.0024977630853503636,
        -0.002108522059798705, 0.0002793581891922074, 0.002503845315417139,
        0.0025246672361071802, 0.0002667875105127702, -0.002296205389835335,
        -0.0028982006493581624, -0.0010045074329002382, 0.0017098924096319197,
        0.002856514735980909, 0.001463287764387644, -0.0011693223896157246,
        -0.002649643048815273, -0.0016493869081914726, 0.0009043884755251027,
        0.0026696032186443322, 0.002005268188691868, -0.0005396899938368378,
        -0.002705576219233133, -0.0025428943944767086, -0.00016348277127574765,
        0.0023501211172163895, 0.002798521362089825, 0.0008231573879563157,
        -0.0017844105309498433, -0.0026956193965480685, -0.0011312854021671304,
        0.0014501345620909272, 0.002676919470478098, 0.0014081738165617466,
        -0.001230946526086167, -0.0028551256782744575, -0.001964300179528408,
        0.0006980730627544861, 0.002796250648743231, 0.002483063932127726,
        4.7385757210385154e-5, -0.0023473308593045146, -0.0025981728128996046,
        -0.0005367844915373926, 0.0019357155401141563, 0.002569387945064521,
        0.0007934285891269977, -0.001770981294932316, -0.0027733355885583774,
        -0.0012571598278323694, 0.0014654244366779229, -0.00884018407629352,
        0.05166036755318165, -0.13490508963282022, 0.11171718505829517,
        -0.016935624682041427,
      ],
    ];
    const result = wavedec(data, "sym6");

    const reconstruction = waverec(result, "sym6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym6_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5058857270424572, 0.9338084658968059, 1.2215964518733093,
      1.3350289848086518, 1.2736063462410745, 1.068704235876346,
      0.7747069474695853, 0.45537740797588855, 0.16882651139799737,
      -0.04527723069312872, -0.17322744520972358, -0.227844723880743,
      -0.2421495207489703, -0.2579234966703766, -0.31220413107649253,
      -0.42525817636349206, -0.5931942763285512, -0.7871998777273269,
      -0.959713228265031, -1.0560818203967317, -1.0288496546551718,
      -0.8511071410186115, -0.5255076329225488, -0.08656607886031603,
      0.4045361921633492, 0.8716024821095678, 1.2389128872490756,
      1.446989883397332, 1.464974453052392, 1.2967380091326925,
      0.979336685439036, 0.5742298768239209, 0.15339371733168383,
      -0.21635169338093846, -0.4871017311131049, -0.6385295641333606,
      -0.6795501142187792, -0.6428169967216073, -0.5736404421491832,
      -0.5162643985224797, -0.5010550403595069, -0.5358826610546126,
      -0.6038940182963752, -0.6682426703765483, -0.6825746500971378,
      -0.604594526334762, -0.4092278142113796, -0.09795202420587396,
      0.29822034709772277, 0.7230791586069514, 1.1060464572554172,
      1.377056796423754, 1.4820151112516147, 1.395166972792539,
      1.1254132439907116, 0.715021218007971, 0.23098379494860716,
      -0.24897929115861683, -0.6525215432089657, -0.9271374267411432,
      -1.0496869368915944, -1.0288835655289632, -0.9003653401074757,
      -0.7157583980081728, -0.5285723691876494, -0.3804892838083934,
      -0.291449623372594, -0.25594368802353124, -0.24633231699385355,
      -0.22224101076134578, -0.1435360629619722, 0.016519860346809245,
      0.26139642930941287, 0.5673673242950563, 0.8867095943977219,
      1.1574350855714592, 1.3173103871188743, 1.318813507327274,
      1.1413827024932415, 0.7979118672368142, 0.3337954980694284,
      -0.18140164608994802, -0.66780990629151, -1.0514862115168468,
      -1.2792743490651637, -1.3288869005686024, -1.211950107431844,
      -0.9694396324841615, -0.6607495347894292, -0.34913771483425615,
      -0.08711502201470733, 0.09470517838191472, 0.1926879256843651,
      0.22811732416921263, 0.23871436252143793, 0.26604630498138576,
      0.3421548140236764, 0.4789098196679047, 0.6628998687941058,
      0.8572699645106275, 1.0101609009861705, 1.0677243699801438,
      0.9885018203313847, 0.7555576274922723, 0.3832505410677098,
      -0.08320520426095734, -0.5755035870035543, -1.015671573410017,
      -1.3321035816093203, -1.4744972772373153, -1.4242183304555085,
      -1.197695269738714, -0.8420968460595344, -0.4243727465221201,
      -0.016300462443815555, 0.3209015611606938, 0.5487820924234853,
      0.6578958832562767, 0.666773514923296, 0.6141159454438312,
      0.5463621689731367, 0.5038896325579107, 0.5094040174732021,
      0.5614876436279486, 0.634951715896518, 0.6879057307768678,
      0.6737467324079239, 0.5550056651190602, 0.3154822774157934,
      -0.03251848916895855, -0.4478577071688645, -0.8674629529841383,
      -1.2189961457337821, -1.4363849751428346, -1.4745695621414066,
      -1.3199542144807896, -0.9940451967580572, -0.5493608581712844,
      -0.058531416286735166, 0.400882048531638, 0.7623173429255552,
      0.9832072324672307, 1.052095619445002, 0.9883687137307613,
      0.8348888667343255, 0.6455250251807534, 0.4707777299059949,
      0.3451065141502998, 0.2790870857346111, 0.2582771304439353,
      0.24896364439334656, 0.2092239676726363, 0.10238771190206464,
      -0.09062971734033448, -0.36338617970558346, -0.6825460382909485,
      -0.9936349143436359, -1.2326795741063123, -1.3410033363502945,
      -1.279614315520598, -1.0396593864368802, -0.646316883015262,
      -0.15504972463775657, 0.3590374029899391, 0.8163409243863928,
      1.1489250748747648, 1.3139909308123985, 1.3015758038801617,
      1.1347969905076738, 0.8627385776652309, 0.5478291030808258,
      0.2508465369561899, 0.017203875379038447, -0.13220839816250513,
      -0.20352065191386584, -0.22529988389480343, -0.23822869266072144,
      -0.28181644435560094, -0.38163894026827205, -0.5404559829471369,
      -0.7355723856257492, -0.9232307233780301, -1.049043463316817,
      -1.061928607083309, -0.9280895127547504, -0.6415071495918021,
      -0.22821386600339238, 0.2569005777319835, 0.7401975489259911,
      1.1440761070513212, 1.4030484765968474, 1.477376488662429,
      1.3611006749295598, 1.0826173523063178, 0.6977259425512555,
      0.27685014475311004, -0.11049957929162352, -0.41033809751217887,
      -0.5944855670914968, -0.6642083590486106, -0.6465639559804969,
      -0.5845868054163779, -0.5239500244272834, -0.4995733973416966,
      -0.5256185249474776, -0.5914276028111136, -0.6644438011625043,
      -0.6993752323899947, -0.6512709994657263, -0.48916194845288496,
      -0.2067336062110609, 0.17280688148472512, 0.5991019868406732,
      1.0039110951847285, 1.3152240710405434, 1.4729500761842311,
      1.4424775670510337, 1.2228660519885783, 0.8476827771329981,
      0.37823556997910657, -0.1092447448768345, -0.5394899243097153,
      -0.853455965760364, -1.0194498266819507, -1.0376350974273802,
      -0.9370474169776766, -0.7660634168032944, -0.5788333464116582,
      -0.42112610065867273, -0.31911974289512723, -0.27388441841559896,
      -0.2628451133502616, -0.24774138205640445, -0.18695815366838514,
      -0.0489923950900466, 0.17648060496272316, 0.4728948482446999,
      0.7980646269752156, 1.0923284447343378, 1.291728016665551,
      1.343096191983826, 1.2173980672452416, 0.9180329741885623,
      0.48197702181262825, -0.02665626607758013, -0.5292480018849464,
      -0.9486246588948488, -1.2246570833139558, -1.3259234306447683,
      -1.254799009594425, -1.0449137392540526, -0.7517417189005304,
      -0.43871363341437414, -0.1622768900437535,
    ]);
    const expected = [
      [
        3.335224899858323, 2.739725162206592, 2.945475507412185,
        2.997324747035525, 2.2852708241031205, -0.34046734307746634,
        -0.35690500524612406, 0.5829652030401826, -0.09660192547318489,
        -0.4994964952670764, 0.4707969918751349, 0.1275887352235802,
        -0.5519354253442311, 0.30233715054450416, 0.2963978269089534,
        -0.5260881730370652, 0.13201149434298265, 0.4135618069316961,
        -0.5505034664990427, 0.5291317758056504, -3.7708273811030115,
        -3.6171148905007287, -3.1978553267222334, -3.6430347405918644,
        -3.8663211774400073, -2.0017899971407522,
      ],
      [
        -2.06780766465951, 0.49393371594912994, -0.04471199805293185,
        0.000434593220881279, -0.01721956419191708, 1.0048174851592595,
        -4.341567240110387, 2.063421697869084, 2.8147901286590127,
        -4.049126602809622, 0.22180795390554592, 3.6931626794130583,
        -2.924699922702366, -1.2731728457350577, 3.6895755429695383,
        -1.6771435295593837, -2.1210435280844147, 3.3220787399051868,
        -0.7690534614477958, -2.4471678727068196, 1.287408042706828,
        -1.0414867535333519, 0.07269203404505871, -0.050879443221044075,
        0.2540672385860938, 0.8187896592257524,
      ],
      [
        -1.342272075050276, -1.0317529754372539, 0.045113493798164324,
        0.3360548857897586, 1.5989219289553724, 0.31644643276514833,
        -0.6038318944194976, 0.1869188658149919, 0.3760548759097796,
        -0.742252351571124, 0.7107656715616777, -0.24868489462896992,
        -0.4348254422528153, 0.9330699766351559, -0.8628580602411517,
        0.16389416842512153, 0.7612022555986405, -1.251773032936172,
        0.8639907198246005, 0.22828534707698842, -1.26824032914547,
        1.4397485882847672, -0.5182831910661861, -0.878365282593153,
        1.698888134277667, -1.2612989540257171, -0.1728167165878735,
        1.5417482913844216, -1.7796592515242247, 0.6599163621988968,
        0.9923479643157304, -1.9156216334581673, 1.3898940191186855,
        0.18508539522892808, -1.6165130518000526, 2.0739222183428168,
        -1.0502972098084205, -0.12060129856679282, 1.247656671014723,
        -1.6958320549336519, 1.1738519052122607,
      ],
      [
        -0.32090099914162334, 0.7793613444654797, -0.6336127694356966,
        0.436817406422079, -0.45464889262743563, 0.03103574026976429,
        0.13169449373047415, -0.11404338134088808, -0.017889324743350928,
        0.1512991355394909, -0.10285943316692774, -0.08276318894507693,
        0.15004279707582152, -0.04586731481816552, -0.0931615447011723,
        0.14467514369391785, -0.026187539002320865, -0.14261100193573956,
        0.12506424850456102, 0.038987644437468084, -0.13679353731204594,
        0.09413402500436734, 0.05544307598966263, -0.16204116544289168,
        0.06205238134185705, 0.11513519700908731, -0.13579768207786388,
        0.014452313974083544, 0.11685025610177957, -0.13475910369818103,
        -0.01914021770207966, 0.15958292091929754, -0.09089147642736387,
        -0.07069175927346018, 0.13912678756189192, -0.06863002519937263,
        -0.09313988997259198, 0.15889665360092395, -0.016265360193566836,
        -0.13591995716456617, 0.11541281286415508, 0.016705259560707966,
        -0.13681050050709542, 0.11329394744635324, 0.06476127766705972,
        -0.16187531858199308, 0.05299019032509926, 0.09580371806060758,
        -0.13632818366481733, 0.036577450932847935, 0.12687048508435939,
        -0.14110867238628869, -0.028940045788250077, 0.14516135079849782,
        -0.09141386327575662, -0.04807145745251834, 0.15048718802567862,
        -0.08033556151404914, -0.1051192021662965, 0.1503618574010527,
        -0.0154321107315065, -0.11515595744770141, 0.12776993005583845,
        0.0015999315254480728, -0.15167427671723088, 0.09424564946171925,
        0.14497372103263684, -0.40351457934486784, 0.2302567043398971,
        0.041092551974410974, -0.16109644480634952, 0.1264771304798276,
      ],
      [
        0.009057528715798041, -0.05369801155596937, 0.13909357835430544,
        -0.1154384762159293, 0.017228721935649022, -0.0016525193670420255,
        0.0012906652776459148, 0.002945047743213171, 0.0018234362113403162,
        -0.0009879172718592127, -0.0028443341249632524, -0.0019929551623104934,
        0.0008014665084678484, 0.0029550814449659417, 0.002446395171074688,
        -0.00031208447894572056, -0.0028377407373870803, -0.002846833332477521,
        -0.00034480827286601477, 0.0023826256305459655, 0.0028683333777783024,
        0.0007221969960956205, -0.00202594917622099, -0.0028099514266120415,
        -0.0008995498096474683, 0.0019250609532334914, 0.0030178549936488476,
        0.00131538812717601, -0.0016681244695669842, -0.0032195135579869702,
        -0.001914468323440225, 0.0010725891455281127, 0.003041833599073545,
        0.0022388661770008558, -0.0005470399276504344, -0.0027235797638765057,
        -0.0022892629152020255, 0.00032498733048243883, 0.002661268901798081,
        0.002511525495973441, -3.3881228396746756e-5, -0.0026559005243771776,
        -0.0029344512921768914, -0.0005777054132409497, 0.0022992866466701144,
        0.003105904840334694, 0.0011440432397273777, -0.0017619189643427943,
        -0.00294950685914247, -0.0013651604790459425, 0.0014772840125617769,
        0.002905622889897965, 0.0015645551791159532, -0.0013254308619066735,
        -0.0030874405998578816, -0.0020567005519814864, 0.0008750578493729576,
        0.0030641928519049653, 0.002532775839914417, -0.00022144765684491662,
        -0.002685610119774348, -0.0026382227009138885, -0.00018059048378260296,
        0.002372758131040554, 0.002639159566181256, 0.00036996111103278564,
        -0.0023196483917826832, -0.0029049268691689577, -0.000789207344470506,
        0.0021305349339846603, 0.0031953480690714506, 0.0014234835434667331,
        -0.0015855540528736216, -0.0031142730480905566, -0.0018135579261461029,
        0.0010720449512042346, 0.0028631785798621592, 0.0019183084022872804,
        -0.0008574505088343731, -0.0028554106462493224, -0.0021795185597642897,
        0.0005924036247083892, 0.002927934169094294, 0.0026654736379463015,
        7.102874857081026e-6, -0.0026562262742272184, -0.002929445485415537,
        -0.0006017865426981425, 0.002170757762752048, 0.0028535952770717167,
        0.0008614063407964868, -0.0019153669287457803, -0.0028665128672649763,
        -0.001079826730110132, 0.0018089151476187839, 0.0031190115394369913,
        0.0015982692121723277, -0.0014113875177710657, -0.003192626571349005,
        -0.002138717946340291, 0.0007769473973912207, 0.002897690568259049,
        0.0023210516072834954, -0.00036425323878073405, -0.002636581354051565,
        -0.002376383636955774, 0.0001750752074110417, 0.0026382725780229937,
        0.002694286348382466, 0.00023372062127695672, -0.0025262343463162773,
        -0.003068981359519779, -0.0008880120506603584, 0.0020449473929908916,
        0.0030845605252218036, 0.0013312306646784825, -0.0015571509548937285,
        -0.0029035680699242006, -0.0014809713668371017, 0.0013618364896592437,
        0.002952763025191002, 0.001771467696886673, -0.0011354962813231477,
        -0.003106370328106779, -0.0023100780345615534, 0.0005636739002047343,
        0.0029269490487708015, 0.001077644512518715, 0.0005721393251734361,
        0.024337662884622233, -0.036678568045273016, 0.01056748043459642,
        -0.0009302035827734173,
      ],
    ];
    const result = wavedec(data, "sym6");

    const reconstruction = waverec(result, "sym6", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym7", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5052399274480213, 0.9286400655045317, 1.2062946083036818,
      1.30572443870332, 1.231628457395675, 1.0225796203225366,
      0.7396676676420914, 0.45013582824403325, 0.21030430746244894,
      0.05219866169333076, -0.022722292459019966, -0.041246043427498984,
      -0.04828140269770226, -0.0917801998777914, -0.20686292355765312,
      -0.40351315793775855, -0.6612606989303554, -0.9324229010983844,
      -1.153202101424374, -1.2598384884252951, -1.2056426728307978,
      -0.974442607727758, -0.5868549467142712, -0.09760737088899041,
      0.41557369326815297, 0.8688292001517515, 1.1906240794463308,
      1.3372171238227555, 1.3013297580476026, 1.111940958705089,
      0.8254045652052566, 0.5102933703201791, 0.22995009061649568,
      0.027262131190229244, -0.08446073719844893, -0.12226896969723312,
      -0.12599474201511868, -0.14449959596039513, -0.21955988822045874,
      -0.3718176751672492, -0.5926717314477159, -0.8444065884522101,
      -1.0686695122157663, -1.201178985789857, -1.1888669477030769,
      -1.004962651878677, -0.6580035319158296, -0.19228748107561508,
      0.32053317613070564, 0.7967394444228425, 1.1589626343629187,
      1.3531639128138095, 1.3599694626109244, 1.1975950848590875,
      0.9157427108908288, 0.5821509672629519, 0.26533718804659434,
      0.01799981171332865, -0.13468059208012761, -0.19893227019768592,
      -0.20764309940717443, -0.20842085248544673, -0.24780217696613416,
      -0.3559538564003078, -0.5360672002135518, -0.7613948114968208,
      -0.9808464980296874, -1.1317799662079167, -1.1566898491925528,
      -1.0194227658296562, -0.7166108223604224, -0.28120839143949966,
      0.22296985156387208, 0.7144991768444778, 1.112161256610225,
      1.3529168036781423, 1.405569413381184, 1.2767489576728825,
      1.0078016810057495, 0.6634910509186004, 0.3154884505420436,
      0.024929427489142064, -0.17150418704090115, -0.2684874891033538,
      -0.29032320913523535, -0.2812421900997444, -0.2904891162187089,
      -0.35630888897014823, -0.4932213492602383, -0.6860867606234848,
      -0.8926541427255253, -1.0540235346892306, -1.110333996558503,
      -1.0175675671335944, -0.7610098765145876, -0.3617257015384986,
      0.12581688483168413, 0.6245664166473464, 1.0515626606878512,
      1.3363535355906206, 1.4365742655628282, 1.3468192918413924,
      1.0986431164431392, 0.7517855175284948, 0.378944478487366,
      0.048040349143711636, -0.19349068891390425, -0.3284177082775807,
      -0.37109773562210935, -0.36037102637434776, -0.34604824150419755,
      -0.3727400687014845, -0.46545845121248625, -0.6209287790205754,
      -0.8070236666225229, -0.9705622768078449, -1.0514823826308386,
      -0.9996720275428497, -0.789995947396041, -0.43146865884205476,
      0.031993616609097275, 0.5296487828306515, 0.9789575726409313,
      1.303881578568304, 1.451902146818012, 1.4055166920695386,
      1.1853664172188514, 0.8442780571743778, 0.45381114198033684,
      0.08679392699667215, -0.19968304176657425, -0.37651953475154176,
      -0.44709095289960954, -0.4430084257200985, -0.4124865212748556,
      -0.40457945543985746, -0.45360968189959183, -0.5680346891782582,
      -0.7268009573436016, -0.8842328606074648, -0.982223550773641,
      -0.9665325047163341, -0.80286570498789, -0.48841735564885547,
      -0.055689501068416025, 0.4326153241775184, 0.8965264196525038,
      1.2564248706683658, 1.4509798966112952, 1.4509202158180168,
      1.2652032073612771, 0.9380739156722279, 0.5378212595741411,
      0.1401410212773535, -0.18963915127755965, -0.4109748771368459,
      -0.5155824175470004, -0.5262402699839881, -0.4874552780776279,
      -0.4506556348598862, -0.4579860545321157, -0.5291169492301662,
      -0.6546538799358816, -0.797963643308687, -0.9049835637368323,
      -0.9194407931998614, -0.7994401282580137, -0.5309684994972498,
      -0.13462242248242506, 0.33640309178999406, 0.8067683277109623,
      1.1953937346649457, 1.4337617376552558, 1.4815399361901331,
      1.3356074935692392, 1.0302341654994867, 0.628408426856389,
      0.20655615832979712, -0.16344629752140521, -0.4304101733163858,
      -0.5740955843267671, -0.6071321804304962, -0.568326692677104,
      -0.5093318778012126, -0.47836829493760247, -0.5054308812709317,
      -0.5929853850439086, -0.7146792919350122, -0.8224469800731208,
      -0.8601420398026887, -0.7800703212243623, -0.5579876150217662,
      -0.20248049893810602, 0.24392149694077686, 0.7124197397955006,
      1.122638953974791, 1.4007307713546455, 1.4963654673764768,
      1.3943385813004372, 1.1178714154878229, 0.7227905903752228,
      0.2840872003890461, -0.12171830675654233, -0.43394114045211984,
      -0.6204784784330638, -0.6828250996349468, -0.6522793995033264,
      -0.5785594543369716, -0.5140139876040994, -0.4977337880528207,
      -0.5438552450776141, -0.6372055242269415, -0.7374694118051036,
      -0.7907778940067236, -0.7456260636461842, -0.5688459771173645,
      -0.25730017447586295, 0.15795756916800302, 0.6163653050675193,
      1.0403915035124627, 1.3528832485443836, 1.4948988722536236,
      1.4395340478331655, 1.198243842154856, 0.8180606450306379,
      0.3704189112564286, -0.06557557432650185, -0.42120158986527095,
      -0.6529737969731565, -0.7506284203233045, -0.7363903857031304,
      -0.6559443662119785, -0.563681759794802, -0.5062602895718287,
      -0.5089129673153222, -0.5681770722958179, -0.6529845112141041,
      -0.7138167449182924, -0.6974674692295044, -0.5634410725523136,
      -0.2975429212885076, 0.08108520021956389, 0.5215439412780434,
      0.9511898983534084, 1.2916961278004704, 1.4771708803836485,
      1.4697703956738102, 1.2688444802103243, 0.9112811043049962,
      0.46294834763197723, 0.0033914107012116834, -0.3923553683292586,
      -0.6702761565765201, -0.808107628085591, -0.8177302007747872,
    ]);
    const expected = [
      [
        3.4474179274185484, 3.9225829033969077, 3.6760459429360304,
        3.6620451565486594, 3.639129996898796, 3.514179122025982,
        3.399877872989026, -0.9585432378856115, 0.549476489577649,
        -0.5413051432349285, 0.06916886402456779, 0.4630947313768116,
        -0.5412642536469148, 0.09190192346056202, 0.44716407966194716,
        -0.5508775572580403, 0.11614404654044737, 0.43562371520949544,
        -0.5649361684587297, 0.13546442136821987, 0.45438797720191343,
        -0.842098848042878, 0.3414634666498721, -2.971949470550622,
        -1.0652576320119902, -0.4284977172960618, -2.571338961853727,
        -0.635081918857389,
      ],
      [
        1.0324436278126696, 0.5567571693308045, 0.08783922232697951,
        -0.5496297295668465, -1.0891201401481885, 0.11016959470907069,
        -3.0841794189665523, 1.2978273056680525, 2.104879094533813,
        -3.562553794105296, 1.5865755425897987, 1.9111562123318593,
        -3.5500930533553228, 1.7492236681405617, 1.7590832757331134,
        -3.5820726451123788, 1.9266921797584409, 1.6399605720367056,
        -3.6534114084774973, 2.111660876130949, 1.3575634648564772,
        -2.483344643020659, -0.039030931063312124, 0.43734883099800825,
        -0.7692152539551109, 0.44211428096909156, 3.021942695173734,
        -3.315739135984143,
      ],
      [
        0.6646629085644563, -1.0239305418007316, 0.5668595238650345,
        -0.12480344769939229, 0.09427041009287933, 1.626509013555201,
        -0.055639393456924216, -1.4055989352160314, 1.6733370144983801,
        -0.4464599926752796, -1.1981370662939634, 1.751092583788904,
        -0.6863105290747227, -1.0248281450461179, 1.800305275551686,
        -0.913804314367716, -0.8229613032175472, 1.8049084108293845,
        -1.1206836969740877, -0.5992096169658992, 1.7647709888408432,
        -1.3001261024793365, -0.3609637046840304, 1.681218302687503,
        -1.446201996174005, -0.11608593989438602, 1.5569887753823135,
        -1.554068004575974, 0.1273456211105297, 1.3961447723227745,
        -1.6201246622779957, 0.36130033608647805, 1.2039410538157382,
        -1.6419998044207007, 0.5781862766552177, 0.9762027229266083,
        -1.6321839852237505, 1.3884117451050901, -0.029687100258070163,
        -0.11992757321633957, -1.1478124957115154, 1.7218628471998902,
        -1.4385887099530208,
      ],
      [
        -0.7414653367095849, 0.39788839090584877, -0.27141627704988835,
        0.1579362696963331, 0.18371430851482773, 0.002329947088109972,
        -0.14923594398368858, 0.14132647353337013, -0.028040999928354904,
        -0.11237509607875691, 0.13813560408548167, -0.008158800504089797,
        -0.12417557410291419, 0.12171155632343905, -0.0014615363900613368,
        -0.12658961703581784, 0.12544336551408125, 0.018070460190216735,
        -0.13626826343764212, 0.10701294455122572, 0.02456645485269976,
        -0.13661372394605717, 0.10883776700117263, 0.043816153918158005,
        -0.14398984510764024, 0.08865701036068263, 0.04968885616740913,
        -0.14212218522915546, 0.08885945657645342, 0.06824084687034672,
        -0.14708759717364603, 0.06724175765107833, 0.07308640392965698,
        -0.14293684135577103, 0.06615891633239394, 0.09055012197563597,
        -0.14545938522966084, 0.043464838222232, 0.09399601689790014,
        -0.13903240717235674, 0.04147527717017024, 0.11001845185760438,
        -0.13915698884807817, 0.018100830248792867, 0.11173564873398838,
        -0.13053729532745165, 0.015612246382138314, 0.12601282815326034,
        -0.12838441526847738, -0.008023988627386028, 0.1257265013331352,
        -0.11772943398168549, -0.010588067925091784, 0.13801337762111537,
        -0.1134912552506509, -0.03405855198262993, 0.1355118755072986,
        -0.10102721501259075, -0.0362725830662243, 0.14563029360165888,
        -0.0949612974822958, -0.05915472263240931, 0.14077204508220983,
        -0.08097586751828117, -0.06060977526134634, 0.14892514481273106,
        -0.08026345912275769, -0.007911942819900061, -0.1878074939750895,
        0.11562080731931434, 0.06444942571881333, -0.05214639559151014,
        0.14657333902556424,
      ],
      [
        -0.011858773554896122, 0.06571059108011149, -0.06886854052614651,
        0.03575825071363376, -0.024458105439796676, 0.0029406323218337683,
        -0.0015698494976700349, -0.00018280103956312948, 0.0013647129867039687,
        0.0015586118262665375, 0.00020978436400088105, -0.0013616446421651559,
        -0.0016138473556833797, -0.0002880763226273293, 0.0013358074199797227,
        0.0016828894043654729, 0.00041539953231726524, -0.0012383692599951088,
        -0.001678777010667464, -0.0004899462031078806, 0.0011586606400105248,
        0.0016544085962593835, 0.0005140748934370714, -0.001145383994691124,
        -0.0016964492253813892, -0.0005892746013052479, 0.0011092468949681375,
        0.0017515877983380226, 0.0007124881343041375, -0.0010021290607973056,
        -0.0017333024852145612, -0.0007819370477373131, 0.0009137551673563827,
        0.0016951903863409146, 0.0008007763418395894, -0.0008921531226494083,
        -0.001723531262251652, -0.0008704818077337351, 0.0008476757232969233,
        0.0017643738154102676, 0.0009872215195969834, -0.000732913358861493,
        -0.0017316413275902964, -0.0010492572875211953, 0.0006379753842184516,
        0.001679626927386052, 0.0010605450810711702, -0.0006102080250320467,
        -0.0016942202288854806, -0.0011225460166560486, 0.0005596102710253892,
        0.0017208330643568154, 0.0012306581667874002, -0.00043948149794039793,
        -0.0016738388459078687, -0.0012831940749068068, 0.00034030570471098266,
        0.0016082231019415548, 0.0012849146936370136, -0.0003087398613165035,
        -0.001609479544554551, -0.001337264495769738, 0.0002544297180529251,
        0.0016223855675739545, 0.0014348757928848124, -0.00013138152796588615,
        -0.001561768775036603, -0.0014761217659982587, 3.044353199411435e-5,
        0.0014833025010435397, 0.0014665717120915496, 2.42439187209947e-6,
        -0.0014720779075079538, -0.0015076508565278906, -5.792940810237391e-5,
        0.001472239512873452, 0.0015932293702877105, 0.00018136076067022102,
        -0.0013990722522757347, -0.0016217502772014492, -0.00028151657235481273,
        0.0013089317483108791, 0.0015995938085076765, 0.00031314199177827644,
        -0.0012864991219147552, -0.0016281625903586297, -0.0003672968505233765,
        0.0012752867673113792, 0.0017005675454056035, 0.0004885683621701988,
        -0.0011910392312984212, -0.0017153299445882265, -0.0005854116538077034,
        0.0010907880560097746, 0.001679642676506403, 0.0006132847645177183,
        -0.0010587960663125822, -0.0016948815797499825, -0.0006635998533540738,
        0.001037943556007769, 0.0017534004104417709, 0.0007802445052241028,
        -0.0009444361964750569, -0.001753806214019563, -0.0008713413579156605,
        0.0008359743264854703, 0.0017041053240451289, 0.0008930689656655434,
        -0.0007963935595177857, -0.0017056417053387578, -0.0009371912167807678,
        0.0007679414948479387, 0.0017500131643946577, 0.0010468982329567963,
        -0.0006672857888016983, -0.0017359191239844094, -0.0011299903706853704,
        0.000552787821019733, 0.0016721791751097813, 0.0011433739232062706,
        -0.0005078465444710011, -0.0016600993928358348, -0.0011791634922528374,
        0.0004740757827671933, 0.0016905219611563155, 0.0012798535092139003,
        -0.0003686055205148805, -0.0016622443411377546, 0.00020392450076950038,
        -0.009922806824329708, 0.015094879972891996, -0.011071110718357704,
        0.005379730334455179, 0.0011416449209524213,
      ],
    ];
    const result = wavedec(data, "sym7");

    const reconstruction = waverec(result, "sym7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym7_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.510498980537285, 0.9391334134856055, 1.2215061974044523,
      1.3239298166356794, 1.2492829528606317, 1.0341797647663993,
      0.7383278538093889, 0.428893375338116, 0.1639051504840996,
      -0.02109230858939437, -0.11982497132698972, -0.15394197301286486,
      -0.16409251639980393, -0.19595686174291344, -0.28506745784350424,
      -0.4445606962357019, -0.6592248137989163, -0.8875554992346867,
      -1.0714246653399802, -1.150953389851322, -1.080778151782366,
      -0.8434744582988608, -0.45656760681201547, 0.028849461963080913,
      0.5377603067282059, 0.9869067683436767, 1.3027430330197398,
      1.4373026258700556, 1.378125111183301, 1.149867841585572,
      0.8073032281191759, 0.4215457586438203, 0.06302042720972428,
      -0.21454722663054854, -0.3851618594875193, -0.4539788930758942,
      -0.4524709617523304, -0.42683165083208374, -0.4228428285586839,
      -0.47132143901313317, -0.5780790290064546, -0.7211217855611496,
      -0.8559030037605612, -0.9273091376524283, -0.8852659416929438,
      -0.699857690369246, -0.37191947811363274, 0.0638228774603421,
      0.5441112016383925, 0.9898924336651546, 1.323419638774203,
      1.4855597472455393, 1.4490593100070193, 1.2245033704710577,
      0.8575136153042541, 0.41791044734093197, -0.016444127558858768,
      -0.37710576363238274, -0.6195128674601194, -0.7309704557668115,
      -0.7303530541345765, -0.6598578997376272, -0.5711674511769138,
      -0.5097855896717358, -0.5017366243465058, -0.5461545253608608,
      -0.615715357193975, -0.664786936752184, -0.6431241750915409,
      -0.5114556193451827, -0.2547709706193376, 0.1103281823936656,
      0.5363504880300924, 0.9537785077568465, 1.2860394149648466,
      1.4669494752761618, 1.4563171011000646, 1.2498023197558845,
      0.880536901238973, 0.4120533434161373, -0.07576668918885304,
      -0.5042826843677917, -0.8129222149832551, -0.9711700262216251,
      -0.9828998745815909, -0.8821893234585618, -0.7219197235713273,
      -0.5582753104096216, -0.43525499440235266, -0.37324543686477685,
      -0.3645954891439047, -0.37726904973159925, -0.36551837823342836,
      -0.2846648440349704, -0.10597853055193607, 0.17240401363648178,
      0.5215779993554603, 0.886230822131724, 1.1963658572701814,
      1.3835604384759945, 1.3977111253777086, 1.2200304585100352,
      0.8689523205211527, 0.39735374142544144, -0.11833449508311208,
      -0.5945282561901347, -0.9584263115147071, -1.1631349294812634,
      -1.1963575345582038, -1.080661004273864, -0.8654576294667304,
      -0.6129186757756849, -0.38153278098209387, -0.21156043766265387,
      -0.11608133704779316, -0.07983144945250395, -0.06597066377206112,
      -0.028840951810009896, 0.07079374141746136, 0.2521867997079698,
      0.5064554979964146, 0.796156212018387, 1.0628912489243958,
      1.241140246843972, 1.2748520617174464, 1.1325582375271037,
      0.8170800033160819, 0.36722246154874727, -0.14915200188595445,
      -0.6491123538621939, -1.052368186809658, -1.2984145931723867,
      -1.3589642158527688, -1.2427004509846187, -0.9913126961193224,
      -0.6679549596757388, -0.34114800196158307, -0.06824534725992831,
      0.11737217840397385, 0.2122267815087999, 0.24046726101055285,
      0.2441969444603793, 0.2691356498487437, 0.34954606321042603,
      0.49652974449858733, 0.6929030476592903, 0.8961302283467253,
      1.0486675198679507, 1.0931065419376336, 0.9882066440950708,
      0.7216115501569995, 0.31583615980779567, -0.17421380229445044,
      -0.6717898282427566, -1.0944655558033682, -1.3720265525766007,
      -1.4617313851508777, -1.357228268359978, -1.0889879187833156,
      -0.7162275100467412, -0.3124151691003192, 0.05197803951946739,
      0.3251707448377953, 0.484355900714172, 0.5381555335738342,
      0.5208599271127103, 0.48018314618821206, 0.46192206033228334,
      0.49567510262269104, 0.5854645032751047, 0.707794715332195,
      0.8177101820110338, 0.8612969562042568, 0.7913530016713728,
      0.5820770181860342, 0.23882415859651715, -0.19979803822716424,
      -0.6682799760885494, -1.0876333470489672, -1.3826882864128363,
      -1.4990419580178576, -1.4154802789377836, -1.1487977895765493,
      -0.7498244402121502, -0.2916540340501312, 0.14699827143562927,
      0.49919334250131936, 0.7236600252354457, 0.8118549998441618,
      0.786633472600673, 0.6931242863279167, 0.5843833392282141,
      0.5057027961677161, 0.481748773524775, 0.5099148479683334,
      0.561618539980558, 0.5911632674981656, 0.5497836316413186,
      0.4011058875721085, 0.13384750598887918, -0.23174232786772286,
      -0.6456072590694654, -1.0375802214288847, -1.3327911971141286,
      -1.4690215575383596, -1.411688007117909, -1.1626841467105442,
      -0.7608147053977032, -0.27364506114568177, 0.21727353809763233,
      0.634198167469531, 0.9196695208193392, 1.0476927270916518,
      1.0270122311439425, 0.8958845955159167, 0.7099037415899896,
      0.5261698775846708, 0.38797410119770437, 0.31397368795684544,
      0.29461353366749754, 0.2966246684373393, 0.2742994001569096,
      0.18445524991200057, 0.0010182420959620742, -0.27476546018182807,
      -0.611360859001048, -0.9522156175449634, -1.2281223404233252,
      -1.3736557330184467, -1.343564406955118, -1.1249423427259215,
      -0.7420186415785185, -0.2522312435465825, 0.26557294564483414,
      0.7279964986743775, 1.0649274810014777, 1.2340349926760545,
      1.2284578864590305, 1.0759427261281667, 0.8298402377316273,
      0.554404254370499, 0.30823558277758506, 0.13012128248471855,
      0.030837780362947986, -0.0071062123666394555, -0.02190103715472458,
      -0.05920359293735933, -0.15688061771507728, -0.3318942088764451,
      -0.5729364179218002, -0.8409178696456433, -1.0773582606712664,
      -1.218644794314867, -1.2125558410227997,
    ]);
    const expected = [
      [
        3.3941573086757693, 4.0054772240275245, 3.73570264898604,
        3.7160717959585585, 3.6980021083998516, 3.561799027035046,
        3.4359814204639227, -0.9903693260906137, 0.46926856096199326,
        -0.3181668687463379, -0.14986978327699946, 0.43301277022562845,
        -0.20008005524717576, -0.2688761639841152, 0.41678324747030293,
        -0.06967867924159393, -0.3592608882292057, 0.3610503255854984,
        0.06536159854100715, -0.4247594959386825, 0.21934380900649394,
        -0.03749645400953042, -2.61272264908023, -4.477317396602852,
        -3.1939352212959826, -3.1537071401232684, -3.611923489438162,
        -3.5901869823827366,
      ],
      [
        1.041503115398851, 0.5759698301655309, 0.08970422990950304,
        -0.5677190387902171, -1.1310331857905238, 0.19383923607599007,
        -3.0114752229661437, 0.42722001925278213, 3.0425976137181765,
        -3.010096161014235, -0.5606575705611864, 3.4405966624530664,
        -2.232307537808756, -1.60975958816236, 3.5311148608922056,
        -1.2673714044746935, -2.4937584810994964, 3.299098553373386,
        -0.19048728958717265, -3.1262728726179176, 2.678977109507138,
        -0.0834807835033891, -0.5127949459243879, -0.4895258408346308,
        0.4873350543801586, 1.0450257452326996, -1.3484106215936948,
        -1.468403637052319,
      ],
      [
        0.6821003036354141, -1.042690652391118, 0.5789908368194965,
        -0.12809217278652615, 0.08807020159680029, 1.6861694699149747,
        -0.1788608809100767, -1.3070336752780254, 1.7706092921522594,
        -0.7673276204056885, -0.8939109010458565, 1.800007184292206,
        -1.1629387104764428, -0.481873382609818, 1.7246824650384305,
        -1.4908327308438039, -0.02888952698026271, 1.5333556880237578,
        -1.7260739794212618, 0.433694325112722, 1.2380080929838622,
        -1.8510741768427021, 0.873567996870306, 0.8583129967555906,
        -1.8561739006445226, 1.2598821203789279, 0.42019281186730095,
        -1.7403952890493748, 1.565562225921537, -0.04610320431587609,
        -1.511534929848041, 1.7693390926405361, -0.5082425457074755,
        -1.1851240709396238, 1.8647784572278567, -1.0153533247018365,
        -0.41004884759938526, 1.0667082873258347, -0.16377484258217823,
        0.042456666605724745, -0.941209998466993, 0.6932909885155178,
        0.38052593833443954,
      ],
      [
        -0.7472237811293394, 0.40428348473163667, -0.2743284327997574,
        0.1578053534873488, 0.18363228023320982, 0.0058441479247201234,
        -0.1491379075712947, 0.13265048635029908, -0.018167426912971685,
        -0.1132498492285607, 0.12786259701211572, 0.007793427683181779,
        -0.12993477000543116, 0.10439773595644972, 0.022298611080457702,
        -0.12902270523269518, 0.10398683536973945, 0.04520310416678418,
        -0.14227472673905212, 0.07680763728935149, 0.0604075341591313,
        -0.1344828684966425, 0.0722807781566553, 0.07915933542571568,
        -0.14370489001607928, 0.04289911469991442, 0.09372700106043562,
        -0.12916554668792063, 0.035210675804059385, 0.10695069356740952,
        -0.13414718002072756, 0.0053476208679010175, 0.1197015701904135,
        -0.11345679048324928, -0.004345563395907056, 0.126347511139864,
        -0.11437639557944264, -0.032878140293057384, 0.1363510655108495,
        -0.08856412118182161, -0.04332301271634801, 0.13577797309430434,
        -0.08595880288256522, -0.06874946050402501, 0.14242410803471883,
        -0.056422617756008805, -0.07870879394424882, 0.13445268412032704,
        -0.05112898535322133, -0.09941577564638777, 0.137494621900207,
        -0.019543798635102375, -0.10777687914513717, 0.12242791576392215,
        -0.012614611560998055, -0.12242904104776338, 0.12199380041649832,
        0.01918088069687783, -0.12830027384971782, 0.10060254061835808,
        0.02657715096284736, -0.1359367321048668, 0.09717506856892703,
        0.05671148272016569, -0.1385682313514566, 0.07347997521131691,
        0.038643814828728806, -0.020715777620728158, -0.15106156927239026,
        0.120481466412004, 0.0075831489592362075, -0.023157546517355153,
        0.09126164872050609,
      ],
      [
        -0.012069868197060197, 0.06645796678671086, -0.06944998229643143,
        0.03592976627035651, -0.024680053977196283, 0.00308214346372534,
        -0.0015137531304551988, -0.00024303203165901722, 0.0012392095005933977,
        0.00150333139404823, 0.0002969115069678352, -0.0012132926590181898,
        -0.0015636545318752193, -0.00040240918355795177, 0.0011683641786238077,
        0.0016469618107447597, 0.0005716729113617496, -0.0010354208286690112,
        -0.0016465919612053195, -0.0006905685242440348, 0.0009035016907306087,
        0.0016010788387356618, 0.0007363190089438652, -0.0008499105418962562,
        -0.0016201366996968164, -0.0008201343656980873, 0.0007929704745274968,
        0.0016743436322048256, 0.0009731609607537485, -0.0006494195198202394,
        -0.0016514771966643482, -0.001085862963680212, 0.0004948825478766406,
        0.0015715668528861562, 0.001116981926248262, -0.00041996056787430545,
        -0.0015486358517336045, -0.001171725355669125, 0.0003576565736420382,
        0.0015724321787137605, 0.0012993840576015477, -0.00021277433487909363,
        -0.0015283375836318575, -0.001398134870137898, 4.536496701813787e-5,
        0.00141730891593492, 0.0014094245871019788, 4.325617826870967e-5,
        -0.0013544561279171165, -0.0014295109846184084, -0.00010354300391927657,
        0.0013489793784836764, 0.0015244584259526699, 0.00023996765728428982,
        -0.0012870897383636315, -0.0016030478554291691, -0.0004097752345609911,
        0.0011506336703585832, 0.0015911002894496988, 0.0005038230441454304,
        -0.0010525473198779935, -0.001573223000982455, -0.0005546267120042426,
        0.0010212090779790507, 0.001630403346979746, 0.0006730149294778994,
        -0.0009468539377568695, -0.0016846118940911313, -0.0008347635768947656,
        0.0007927125472963585, 0.0016481467538479108, 0.0009260100623419878,
        -0.0006663415054069437, -0.0015915854032142326, -0.0009604417296863801,
        0.0006144761300303915, 0.0016085591054438918, 0.0010521435623616323,
        -0.0005344505255989441, -0.001636433775512527, -0.0011961318695783182,
        0.0003718938723191135, 0.0015764612786555456, 0.0012770621727279997,
        -0.00022592420410677853, -0.0014831979921521984, -0.0012894316602234822,
        0.000160289882117363, 0.0014602753087305834, 0.0013473858494983647,
        -8.229484556831774e-5, -0.001462217872804273, -0.001465344125576096,
        -7.85258810734879e-5, 0.00138201170400128, 0.0015297553672036926,
        0.00023431691626778954, -0.001256644944271244, -0.0015161011715700752,
        -0.00030614342485149707, 0.0011968153944908653, 0.0015353846774001643,
        0.00037414433324048087, -0.0011754780139956607, -0.0016210376806745422,
        -0.0005229189269171874, 0.0010803591265256744, 0.0016645208565742855,
        0.0006783818041983932, -0.0009298199345052255, -0.001623004776547816,
        -0.000748667191220902, 0.0008384845165664027, 0.0016012291130660795,
        0.0007991237998328465, -0.0007984829611739584, -0.0016507038517102539,
        -0.000926125922651788, 0.0006954300179439294, 0.0016709711515701417,
        0.0010714757339150304, -0.0005285207278924401, -0.001602104245999371,
        -0.0011329951626501, 0.0004130488174477636, 0.0015396272854771894,
        0.001159424653169443, 0.001485265388742545, -0.014266959294952928,
        0.042001748583626514, -0.04088815800284035, 0.011588997370923908,
        0.0005696438827391499, -0.0008705564570348026,
      ],
    ];
    const result = wavedec(data, "sym7");

    const reconstruction = waverec(result, "sym7", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym8", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5020351716939011, 0.9235667841643185, 1.2015810048545537,
      1.3037510310344533, 1.2341421331262141, 1.0301289215544391,
      0.7514560446243534, 0.46435094827030615, 0.22481866135517015,
      0.06540244550835161, -0.011255306489243333, -0.03052170549018481,
      -0.03621145983715615, -0.07602276556982873, -0.1859459450001994,
      -0.3778864716554662, -0.6339018708196087, -0.9087191035372508,
      -1.1400242204543503, -1.2639629065721438, -1.2318918749302061,
      -1.0240413379614075, -0.6564897575616049, -0.1795263465142724,
      0.33234411646314194, 0.7963749484170348, 1.1396262531019743,
      1.3146533462307193, 1.3089971258168178, 1.1462120874143573,
      0.878312965153102, 0.5716871885501693, 0.2901518731608731,
      0.07951366454170061, -0.04245406490705922, -0.08815116896109709,
      -0.09401929639749991, -0.1079167969571222, -0.17347226251269304,
      -0.3156734756781335, -0.5316202119807723, -0.7890135527883808,
      -1.0329224310217262, -1.1991866171952534, -1.2310500858994844,
      -1.0947286053127392, -0.7898338655944692, -0.3518509249234544,
      0.15412904768089022, 0.646997073640446, 1.0472447012873458,
      1.2942886217257394, 1.3592456075761281, 1.2500532073100423,
      1.0077710896037932, 0.6951275175219271, 0.38032305132542515,
      0.1202703684455742, -0.052462139574192934, -0.13574368904470188,
      -0.15559387555335252, -0.15629457981194608, -0.18566404261403674,
      -0.27951256345511327, -0.44950410430486626, -0.677748898204604,
      -0.9196822959158334, -1.114603318376144, -1.201218470809874,
      -1.1341889008296873, -0.8973632987840046, -0.510180277764813,
      -0.02543920924237761, 0.4811716967832441, 0.92729930151607,
      1.2419371166688973, 1.3807945249446343, 1.3352561878361946,
      1.13278540428377, 0.828789002209267, 0.4921124952183068,
      0.18792126112420243, -0.03765922913944142, -0.16727899836651142,
      -0.21410826059735882, -0.21532377841690753, -0.2192254630498428,
      -0.2695267381872575, -0.3910883447124619, -0.5809755173975689,
      -0.8073145157577336, -1.0163705479472118, -1.146097820458255,
      -1.1426872511093318, -0.9758070392274582, -0.6485138007629656,
      -0.19913812781777193, 0.3055206121766516, 0.7841409255221452,
      1.1585893464536658, 1.3710441821773418, 1.3963184224614644,
      1.2463764403703423, 0.9660118129131675, 0.6208838170653251,
      0.28102594630389005, 0.004050662895019208, -0.1777021786688659,
      -0.2628925343589568, -0.278480510150313, -0.2694998496673249,
      -0.28416130665062794, -0.35834783563510475, -0.5037062844174923,
      -0.7025846979074826, -0.9112587986275844, -1.0707040921034239,
      -1.1221687958447848, -1.0235073006883835, -0.761982135007768,
      -0.36010306685879023, 0.12717360026108243, 0.6233640750830951,
      1.0468956724443323, 1.3290446222656351, 1.4289535656389551,
      1.342036157460556, 1.0997435318095437, 0.7608475930056002,
      0.3965299953749466, 0.0731064599707778, -0.16322988617586637,
      -0.2958343479810309, -0.3389407512344015, -0.3307508389537477,
      -0.3202821526498935, -0.3515875249067673, -0.44962650277130395,
      -0.6116180778021849, -0.8062529997367796, -0.9810694960269515,
      -1.0761366641762113, -1.0405058048631082, -0.8471197173402296,
      -0.502215932001033, -0.04663623404285103, 0.4514904652600167,
      0.9110196281257639, 1.2555564327424524, 1.4303440660282574,
      1.4141070307967114, 1.2229470133014289, 0.9053928305820349,
      0.5299345958000461, 0.1682541860470968, -0.1215822841225635,
      -0.30774699152225554, -0.3899894563198263, -0.3965068744809546,
      -0.3733666227310828, -0.3694303404524652, -0.42088193024186377,
      -0.5395422767928642, -0.7081421599015393, -0.8838849131925357,
      -1.009439478605227, -1.0285312874126502, -0.9020556364749177,
      -0.6204502900174415, -0.20898295604901324, 0.2755988965251681,
      0.756403506520318, 1.153012411251833, 1.3993087237877144,
      1.4581122381404445, 1.329008024854662, 1.0474669458283723,
      0.6755509176366159, 0.2866102065401056, -0.052127117570688775,
      -0.294683481796617, -0.42542349525739115, -0.45994891321218834,
      -0.43777586417938075, -0.40890380295839546, -0.4179572458765109,
      -0.49018892836929906, -0.623121110552374, -0.7861045162732144,
      -0.9279809069293461, -0.9908889981678919, -0.9266117055921413,
      -0.7111528529797024, -0.3536402323787346, 0.10292296259279998,
      0.5894598481997306, 1.0253823048130273, 1.3363754896501878,
      1.4710176912886095, 1.4121189074552498, 1.179982112258604,
      0.8268243938464183, 0.423819884108487, 0.04407251051202077,
      -0.25417831075050706, -0.4399248703299538, -0.514318696747283,
      -0.5070927039248729, -0.4656202434337011, -0.4396520332316767,
      -0.4658715694263517, -0.5564275819700182, -0.6945356681478168,
      -0.8383682264155707, -0.9322586735621874, -0.9223020718374961,
      -0.7722449596481891, -0.47543285554064924, -0.05955998479554908,
      0.4172067884681147, 0.877948486635362, 1.2437552467202002,
      1.4514106290547217, 1.467615890754782, 1.2962243040393822,
      0.9767100313662654, 0.5743024315218992, 0.1643094867199414,
      -0.18540271613899467, -0.42938240976737857, -0.5533237423141878,
      -0.5745053335164719, -0.5340400922039918, -0.48315566521744235,
      -0.46725274355636354, -0.5120357808758207, -0.6154380282273846,
      -0.7475204188720233, -0.8584127951174632, -0.8922344239196818,
      -0.8033323463839435, -0.570526904918676, -0.20552468406158061,
      0.24686849444352932, 0.7170056257892069, 1.1252180875611704,
      1.3995843515813817, 1.4922503980264499, 1.3902411962442698,
      1.1180768922347188, 0.7315677159925793, 0.3043802019631656,
      -0.08922437930538674, -0.39114313751814217, -0.5715153986524161,
    ]);
    const expected = [
      [
        3.815996774529141, 3.3792810223810177, 3.48723075664569,
        3.1213076228575085, 3.4557173735581794, 4.006706618891846,
        1.9236179464926622, -0.16953824293923983, -0.3811191898853368,
        0.5956377978871837, -0.2852183816980343, -0.2935270879733208,
        0.6008424740626636, -0.3402084824556125, -0.2451215815350969,
        0.5993494733497304, -0.38549531540322235, -0.19170144552471916,
        0.5854308094810421, -0.43166825517339413, -0.13049391248573142,
        0.5941300097721359, 1.342894569851492, 3.1882487864579128,
        1.1485974603765647, 3.41347134938968, 1.3418611901518298,
        2.9296961365657643, 1.8231682648981054, 2.001470540335249,
      ],
      [
        -2.230511893359285, 0.34134921115322847, 0.434147569502327,
        0.44889236754277345, -0.9032791363449018, 0.04620373005214368,
        0.2286156281745024, 1.3552371453314012, -3.860217931517421,
        2.473842931399632, 1.4019270949539293, -4.052673619843391,
        2.866220713407494, 1.1039948608767352, -4.065172311575558,
        3.1394391776663464, 0.8015302626360356, -3.9604455610142004,
        3.3151652265904468, 0.46316856099650616, -3.7399069391357225,
        3.473114670329362, 2.0551113526701315, 3.325796979522733,
        2.105739835297596, 1.8044623818866161, -1.1697670109632174,
        -1.718751267728203, -3.3398737631618127, -2.409872676838721,
      ],
      [
        -0.669664002749381, 1.155006255276663, -0.30236908187000455,
        -1.1747664283187023, 1.8512694043319773, -1.1300381314032997,
        -0.08015335916598312, 0.7414558625617182, 0.30612064380598064,
        -1.2803543606571048, 1.1815446097994964, -0.09649917142191033,
        -1.0117514688693967, 1.214088862561665, -0.3971469430143394,
        -0.7024333335088384, 1.1663598531789836, -0.6553256815380804,
        -0.3614383927721281, 1.040257766830619, -0.8560063539937871,
        -0.007623208177141457, 0.8421811849373226, -0.9875928084092915,
        0.33943748492726056, 0.5827660177816356, -1.0425862898773388,
        0.6605884768749352, 0.27626855741599127, -1.0180220897698102,
        0.938207211957721, -0.06026273798809563, -0.9156414162446979,
        1.157156607924965, -0.40863778821316715, -0.740788096928233,
        1.3401641508088729, -1.09085220277142, 0.8095370134024987,
        -0.2774108571042953, -0.10961080699024972, -0.5835764109281545,
        1.6790564832149522, -1.8688042770404534, 1.4512834309745133,
      ],
      [
        -0.09923557439365115, -0.16437094628875376, -0.04909321728930108,
        0.32707095609980386, -0.5798627794284748, 0.6581463933335276,
        -0.28048502465545505, 0.15685169404762325, -0.015086000885357094,
        -0.09779802989512192, 0.10413553195888998, 0.004933082635887049,
        -0.10895918549860786, 0.09214105115426881, 0.019304436734868403,
        -0.10999163869359745, 0.08703037583794575, 0.03321009252791439,
        -0.1178417052356441, 0.07225775437245971, 0.0465240880997266,
        -0.11568656544724096, 0.06495693118071567, 0.05955199421295819,
        -0.11996637396546121, 0.04804373892837375, 0.07102538440965883,
        -0.11452384973425726, 0.03921470964071523, 0.08243066161466447,
        -0.11520498310875546, 0.020907436806374104, 0.09137167456406428,
        -0.10657580338586564, 0.011308135103863179, 0.10051988480734342,
        -0.10383047682906613, -0.0075718840996177005, 0.10636864351545729,
        -0.09231078925057523, -0.01713259588461159, 0.11277267638254361,
        -0.08650105275941487, -0.03573619982945028, 0.11513398373923897,
        -0.07256589238195035, -0.04444658516229952, 0.11848229589196639,
        -0.06422179899393483, -0.061945404230466926, 0.11714887251742871,
        -0.04849808884017117, -0.06903909268693109, 0.11732343398272282,
        -0.03828610432004791, -0.08467293960730188, 0.11228825317197008,
        -0.021516759639830192, -0.08947453681138716, 0.10937115477651166,
        -0.010200258134070939, -0.10259480772040211, 0.10082815437757342,
        0.006798514809141253, -0.10456827986474927, 0.09504281642910176,
        0.0158283737570436, -0.09747134459340927, 0.03928346736715793,
        0.05428226083770135, 0.004801469472280173, -0.0915825829792993,
        0.05344973113379033, 0.033978396314241356, -0.05093543404698611,
      ],
      [
        -0.0030186208342931208, 0.01708913195369778, -0.04382785883110318,
        0.11686894124412085, -0.117054341335768, 0.03324413501828963,
        -0.00488924655194567, 0.0004422390348457043, 0.0007914327059512275,
        0.0003727365055507994, -0.0004070008509231126, -0.0007921008162065928,
        -0.00040828126895432607, 0.00037538888247840116, 0.0008023661638950169,
        0.0004589227685683156, -0.0003260802233577987, -0.0007979334965900701,
        -0.0005037785524346873, 0.00027094859517442864, 0.0007784331298959671,
        0.0005303208684122752, -0.0002312854351101518, -0.0007682056481453992,
        -0.0005595186487452617, 0.0001949132138221093, 0.0007669499377612901,
        0.0006029996605832805, -0.00014124336626838074, -0.0007504115142834954,
        -0.0006391883003356116, 8.34137136099017e-5, 0.0007197136590389014,
        0.0006568567169658148, -4.197139993705485e-5, -0.0006991961226347088,
        -0.0006776878436126961, 3.519790911048139e-6, 0.0006871480713234656,
        0.0007120515672950061, 5.173130748082743e-5, -0.000659439571778879,
        -0.0007377626179897062, -0.00010943627109744449, 0.000618679658070476,
        0.0007449392143822524, 0.0001498750521837719, -0.0005891167518400162,
        -0.0007559067129396511, -0.00018762529640854297, 0.0005676321066001874,
        0.0007797453747827179, 0.0002416179805227658, -0.0005303015245522406,
        -0.0007937440301490546, -0.0002963604762395815, 0.0004812051887255718,
        0.0007894063682591891, 0.00033303974467339265, -0.00044440799240689057,
        -0.0007896242586311051, -0.00036737205574416344, 0.0004153881454164153,
        0.0008021590782160569, 0.00041737115883074645, -0.0003705057621012824,
        -0.0008038572327281036, -0.00046646194169678397, 0.00031529054127403403,
        0.0007876401304743766, 0.0004968145494126368, -0.0002735306103161324,
        -0.0007768859687560914, -0.000525236789075683, 0.00023930941285853148,
        0.0007780103929855709, 0.0005687696641827372, -0.00018934745376023368,
        -0.0007675001225476859, -0.0006098230472878141, 0.00013059577580165743,
        0.0007397191512568306, 0.0006316219011290878, -8.647223307682497e-5,
        -0.000718447748403455, -0.0006520134305589688, 4.967761642495159e-5,
        0.0007087314397920764, 0.0006870125581701226, 2.6333935369878686e-6,
        -0.0006867789515298049, -0.0007180838283066902, -6.212252649957426e-5,
        0.0006484142796330168, 0.0007295733864081935, 0.00010583513632382493,
        -0.0006177317943127363, -0.000740310376727647, -0.0001424366556512552,
        0.0005983851488391477, 0.000765232248375037, 0.00019426646393011287,
        -0.0005663855553151038, -0.000784929466140095, -0.00025163845791251064,
        0.0005190270723722059, 0.000784929834052552, 0.0002921526772043572,
        -0.000480626986526133, -0.0007849815050605293, -0.0003258195325312899,
        0.000453428258168208, 0.0007988948566042231, 0.00037440241343493,
        -0.000413323815107195, -0.0008064585273821136, -0.00042691135148271693,
        0.0003590807280996744, 0.0007944360777630268, 0.0004615902029200371,
        -0.00031514543688369433, -0.0007834262473462397, -0.0004897678088501196,
        0.00028233472653444174, 0.0007860645030247824, 0.0005325629252485723,
        -0.00023650130335652183, -0.0007814104783466611, -0.0010058955571696187,
        0.002007012072118095, -0.001438937723818238, 0.007521056402732659,
        -0.009643251482303439, 0.004290635417956582, -0.0011403298646586381,
      ],
    ];
    const result = wavedec(data, "sym8");

    const reconstruction = waverec(result, "sym8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym8_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5065180380939527, 0.9309940347908116, 1.2093157465856892,
      1.3087996173711658, 1.2339647770470803, 1.023267260070375,
      0.7377879290991198, 0.444907553580585, 0.20124688559679593,
      0.03927869248160132, -0.038996781659988405, -0.05981316199830074,
      -0.06760829267822449, -0.11003376188665553, -0.22214011241105763,
      -0.41408793800427124, -0.665800554805511, -0.930135582632675,
      -1.1438911713052888, -1.2438693812484263, -1.1838428439494602,
      -0.9479736165856876, -0.5570967220704078, -0.06608459937503135,
      0.44721316521761634, 0.898797802400421, 1.216973590319474,
      1.3578565786318706, 1.3141202955394569, 1.1148862894193303,
      0.8169265394209937, 0.48955096238440554, 0.19713608052728582,
      -0.01619735550510032, -0.13586868094721818, -0.17781847587149505,
      -0.18112457015399408, -0.19439683771237615, -0.25972745335891007,
      -0.39860696448226124, -0.6036864218533919, -0.8387111457195224,
      -1.0467793445022044, -1.1648572270068531, -1.1407933786077855,
      -0.9483626836052983, -0.5963236517050401, -0.12897867861619758,
      0.38210369935950894, 0.853273831689465, 1.2071779587347735,
      1.38977792535964, 1.3817982287643378, 1.2018012224692451,
      0.9002235873364447, 0.5460038509515759, 0.20929792936693653,
      -0.05526434600262187, -0.22052848690428392, -0.2910165893742962,
      -0.2984841575348584, -0.2902132558293225, -0.31332513559835257,
      -0.3994272303569782, -0.553802296798767, -0.7521307526805633,
      -0.9457299482283871, -1.074021802897548, -1.0809981200781618,
      -0.9313505621162843, -0.6219608526318677, -0.1856028666545399,
      0.31430545686139577, 0.7967601090262819, 1.180877548204567,
      1.4038737512097899, 1.4348479491482764, 1.280959608877316,
      0.9845193229070135, 0.6118225429598696, 0.23664270648056318,
      -0.0773718050429299, -0.290925580396594, -0.39638686865489525,
      -0.41647889537247057, -0.39491879400058083, -0.38167716904001786,
      -0.41692543821554173, -0.5180579292906509, -0.673339490735001,
      -0.8439572054257123, -0.9740111516150048, -1.0058518013635735,
      -0.8967184115949447, -0.632236080813767, -0.23309624014126037,
      0.24701994189320792, 0.7319621748007973, 1.1395748769071763,
      1.400050186481012, 1.4716020559270844, 1.349553755953002,
      1.066596685318355, 0.684218987535108, 0.27753894606291674,
      -0.08256732127529454, -0.3455080478585656, -0.49117822881463813,
      -0.5318708766628211, -0.5056279581668037, -0.46299842714705614,
      -0.4508790617366752, -0.4978497741256821, -0.6049887576252659,
      -0.7446777785816708, -0.8677713396779658, -0.917265286004499,
      -0.8448473753826573, -0.6259048334375267, -0.2689160546537458,
      0.18342285107503634, 0.6618588813389815, 1.0852738232813612,
      1.3788123711357851, 1.4909340101551833, 1.405118027454706,
      1.1432929446700817, 0.7601576900318505, 0.32987043564240587,
      -0.07149432340208911, -0.3832758103471507, -0.5730037910027838,
      -0.6415040013660669, -0.6192334063244062, -0.5550360686260786,
      -0.5004737827232707, -0.4940125093207887, -0.549344477897763,
      -0.6509995693891344, -0.758444777885639, -0.8175998685094634,
      -0.776705956509774, -0.6022940830887237, -0.2909264535333129,
      0.12655347769770475, 0.5895986935159295, 1.0204098113681055,
      1.3412466947415935, 1.4922970520939516, 1.4456143111482125,
      1.2116094777521573, 0.836461227565202, 0.3911100109876865,
      -0.04536921192605309, -0.40381463539216667, -0.6399229257812971,
      -0.7424127032048251, -0.7325130665408899, -0.6551471727865074,
      -0.5643314419092209, -0.5067900295906272, -0.5082086879591861,
      -0.5658143014542414, -0.6492617545478354, -0.7095859835084866,
      -0.6938170555540029, -0.5613262199073652, -0.2974730812272759,
      0.07920884675881773, 0.5183901243534699, 0.9477650615517962,
      1.288982918688397, 1.4757430530388924, 1.4695026946729455,
      1.2688158752558214, 0.9099206942036799, 0.4584075959744003,
      -0.005938637725514784, -0.4073098539911958, -0.6905078414039276,
      -0.8319240831015546, -0.8422412391361299, -0.760389899730485,
      -0.6405575355660498, -0.5358269200194481, -0.4828572059797179,
      -0.49169760658739625, -0.5434289382727607, -0.5962291390140789,
      -0.5982058118568394, -0.5035223719757622, -0.28744101624628937,
      0.043846248161825696, 0.4513901010322212, 0.870371842505982,
      1.2241374928605098, 1.441920648660835, 1.47579490160226,
      1.3125447742027314, 0.9774072499705357, 0.5286894375475623,
      0.04458159235049569, -0.39453930806797716, -0.7238924109827215,
      -0.9077499119910679, -0.9452998350485905, -0.8676250180554573,
      -0.7268066129001965, -0.5801807053160044, -0.4739955455588587,
      -0.43082007529356037, -0.44401871205441495, -0.48070633169589094,
      -0.49233005434692795, -0.4299849884813988, -0.2602940166216871,
      0.02249754452717817, 0.39159412842705293, 0.7914070757515339,
      1.1492400303132329, 1.392052718567564, 1.4640886367210826,
      1.3408741306228729, 1.0359809095583714, 0.5987650981345851,
      0.10358386627148014, -0.36684577312569544, -0.7398015477192941,
      -0.9680653166417523, -1.0387858976808837, -0.9736242836342344,
      -0.8203633091762799, -0.6383544504075771, -0.4817346001336464,
      -0.3848723522913532, -0.3538631715979625, -0.36625653175058104,
      -0.3789957705799124, -0.34236028848826233, -0.21609371804322225,
      0.01669822221249878, 0.3417320550044202, 0.7140819437516381,
      1.0671454868629549, 1.3278939921819737, 1.4345816507956008,
      1.3523940825436518, 1.0829928022627955, 0.6654384991554476,
      0.16815969431308925, -0.32608981176231056, -0.7385601111489911,
      -1.0115714233858764, -1.120111684243331,
    ]);
    const expected = [
      [
        3.821182165809245, 3.388309580443905, 3.5008856117883185,
        3.1312945998950505, 3.464051158722778, 4.04459381031005,
        1.856538991529921, -0.11083576354792937, -0.37851216661087045,
        0.4936955604583166, -0.13230449627752597, -0.3641088587165019,
        0.4874910987652336, -0.1046101873572744, -0.3911869172891972,
        0.4838734251784447, -0.07279286540365185, -0.41731652022647353,
        0.476700849207175, -0.034259598359447495, -0.5268955495133698,
        0.8401368929068403, 0.05584735572651973, 0.553541717354333,
        0.09714809365517067, 0.7695767016972633, 0.17786704494695166,
        0.4917902352383908, 0.1472025576796477, 0.8736804742753449,
      ],
      [
        -2.2585965788952413, 0.3659031868184488, 0.4264748753636632,
        0.4485494063883049, -0.9027350035117462, 0.05274178405627768,
        0.20867949282791198, 1.5249849917596472, -3.8385522370468097,
        1.9111850833667496, 2.1132895647763568, -4.011985091945183,
        1.7529284746733536, 2.3715741586020043, -4.075210334149767,
        1.5381740323031807, 2.6392544108622022, -4.0988408055268755,
        1.2813355729271316, 2.904570399870576, -4.12036337215299,
        1.1559784670881463, 4.552148987024593, 3.8110824994728305,
        3.1646757145441815, 2.066138166064454, -1.0618638498559325,
        -2.9631209003346966, -3.8082133750223623, -3.832424738117227,
      ],
      [
        -0.6684797237584448, 1.1618045284254082, -0.30859602789271157,
        -1.1744616149492693, 1.8522657287092528, -1.1245892082183975,
        -0.08636943996476207, 0.7269779177344651, 0.385130294236934,
        -1.3753446278889843, 1.1816007098151482, 0.0498738456298292,
        -1.2032362232346938, 1.2571822045620575, -0.1967479477051062,
        -1.0062288387351643, 1.2853372494793716, -0.42400651397645556,
        -0.7833504422147348, 1.2655313052492465, -0.6241035341211412,
        -0.5425645514667518, 1.1987824591663176, -0.7902017045521412,
        -0.29244846374164485, 1.0877369918352708, -0.9166501082632182,
        -0.04189597323927178, 0.9365774798332783, -0.9991798779631618,
        0.20019085305736867, 0.7508776840315627, -1.0350530371155817,
        0.42511857496398764, 0.5377951946872473, -1.0254015472219034,
        0.6478704314822341, 0.020068087800109633, 0.3501494574198395,
        -0.3689759234830927, 0.8553368846034411, -1.1899202679545922,
        1.4158885062370596, -1.8816839448096228, 1.6469687637212178,
      ],
      [
        -0.1000658389869455, -0.16606337847596234, -0.050676295793905,
        0.33404079616653887, -0.5897899350967312, 0.6666637138774929,
        -0.2847218364457067, 0.16085923643845118, -0.018666890810874536,
        -0.09753647753126848, 0.10958706292075233, -0.0020101005165099263,
        -0.10840407176951292, 0.09969434957927803, 0.010031466337378607,
        -0.10840344833224445, 0.09734943754805547, 0.020384028138591595,
        -0.11747336262173416, 0.08582724379186892, 0.03230252345451371,
        -0.11546190747361118, 0.0818020109654233, 0.04205728149773843,
        -0.12255917737400997, 0.06891720019908971, 0.05347070416664734,
        -0.11843505958271455, 0.06349042851456821, 0.062256558047637994,
        -0.12348616970269985, 0.0495515242444043, 0.07280517060932408,
        -0.11721913642307949, 0.04304736047535497, 0.0802798237517657,
        -0.12022298482380707, 0.028402627455002112, 0.08963858778160402,
        -0.11185553139633776, 0.021179259340569086, 0.09550043064983793,
        -0.11288334502161304, 0.006204735429587255, 0.10339023689779853,
        -0.1025293662761993, -0.001358108987035262, 0.1073888242388504,
        -0.10172211006863842, -0.016271545311358805, 0.11358612855345537,
        -0.08956307946254126, -0.0237858420732941, 0.115530887738266,
        -0.08712644899560842, -0.038245920663249854, 0.11987541903068799,
        -0.07340525784415385, -0.04532887919805236, 0.11964228783313317,
        -0.06960242900239356, -0.058955437863454724, 0.12204256111906209,
        -0.05461538632772629, -0.06524567693627838, 0.11988566134582998,
        -0.05448063276153511, -0.05608039416543392, 0.08659635627262037,
        0.0333206469179154, -0.02628168607015869, -0.06735743956063421,
        0.09217160842799772, -0.06561593784066491, 0.034710569473507626,
      ],
      [
        -0.0030382596583805434, 0.017231492483981103, -0.04429786992448313,
        0.11806717170884987, -0.11818892084205629, 0.03352553324867256,
        -0.004930119927654996, 0.0004681200485133012, 0.0008169180295407225,
        0.00036643911871430453, -0.0004417990059750925, -0.0008177941133024116,
        -0.0003928261862005687, 0.0004209420800920001, 0.0008312053097562875,
        0.0004366918607628474, -0.0003817715990167424, -0.0008310447732671079,
        -0.0004766537621588196, 0.0003351180741781222, 0.0008146135757606562,
        0.0004972103651546163, -0.0003050484832623516, -0.0008079892576597135,
        -0.0005193994145035459, 0.0002812010107317899, 0.000814231451018967,
        0.0005588676083106878, -0.00023952319114035805, -0.000807325190465836,
        -0.0005946554151005571, 0.0001902123520798775, 0.0007838947771473055,
        0.000610712966820616, -0.0001576140405391323, -0.0007699474411742065,
        -0.0006276670662751112, 0.00013201418108902438, 0.0007692489891286645,
        0.0006617275897904611, -8.909984387495216e-5, -0.0007558941964719698,
        -0.0006923747838985072, 3.8425278857641214e-5, 0.0007258323421848482,
        0.0007030238117180674, -4.594682553046327e-6, -0.0007049812232328583,
        -0.0007138779217717858, -2.1454186767002e-5, 0.0006978092734883277,
        0.0007417005766906644, 6.428034917687437e-5, -0.0006785382846374263,
        -0.0007664280373384015, -0.00011498218719282571, 0.0006424442380861344,
        0.0007709538507554899, 0.0001487170481048669, -0.0006153359456609387,
        -0.0007750449833413808, -0.00017389177319420898, 0.0006023799422535221,
        0.0007960080720273327, 0.00021529696708984356, -0.0005779417488654122,
        -0.0008142508633857885, -0.00026469275659177184, 0.0005366257880186258,
        0.00081215855349077, 0.00029701838763854585, -0.0005041119624819754,
        -0.0008090489390665441, -0.00032002216564317744, 0.00048625945359901225,
        0.0008227605573676311, 0.00035871155474241547, -0.00045759370212592864,
        -0.0008341872908429284, -0.00040551699047665563, 0.00041204937852964713,
        0.0008252191115907855, 0.00043518002181826103, -0.00037515725381664184,
        -0.0008147115715403746, -0.0004547876194319349, 0.00035346283928657093,
        0.0008210229475196598, 0.0004895490768073044, -0.00032166721789866773,
        -0.0008255470482078217, -0.0005325730540664, 0.0002730372511547882,
        0.0008096915773056325, 0.000558423748852805, -0.0002329341434792404,
        -0.0007918365689967647, -0.0005735242441959466, 0.000208582637812271,
        0.0007908469858226336, 0.000603270247367084, -0.00017487478092510257,
        -0.0007886294729516807, -0.000641455815597447, 0.0001244117843386529,
        0.0007661222348765359, 0.0006624879806500722, -8.236473698379227e-5,
        -0.0007412163252724809, -0.0006721235479711534, 5.662982399957765e-5,
        0.0007332694578335228, 0.0006959287659833076, -2.2305053975973672e-5,
        -0.0007247131431134801, -0.0007283894333652627, -2.8671548390362712e-5,
        0.0006960286725031339, 0.0007437753497160386, 7.133956651220663e-5,
        -0.0006646044929527336, -0.000747174743330119, -9.713975499265216e-5,
        0.0006502762852798683, 0.0007643080141037592, 0.00013075338515862846,
        -0.0006360115902288137, -0.0007054431147542433, -0.000767332825034117,
        0.0009592158707609892, 0.008180971079349134, -0.011088967488941365,
        0.005231168034231488, -0.0013704173339652054, -0.0005607766886716438,
      ],
    ];
    const result = wavedec(data, "sym8");

    const reconstruction = waverec(result, "sym8", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym9", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4954035670034481, 0.9111206638549418, 1.1850767299819813,
      1.286040890370316, 1.2192229140575155, 1.0229400183007589,
      0.7573440002274129, 0.4882198733119748, 0.2701005214767516,
      0.13307046041225223, 0.07662530893706576, 0.07207648824783941,
      0.072733335801719, 0.029045942003320557, -0.0954144210559269,
      -0.31148394494790904, -0.5988728647439456, -0.9091784778112364,
      -1.1768041708121697, -1.3350524788806695, -1.3332716986254898,
      -1.1506135754173488, -0.8027907673843104, -0.33999435296122793,
      0.16361360964341673, 0.6262625850340586, 0.9767238273142544,
      1.1697286309792354, 1.1948440138059464, 1.0766820267043462,
      0.8665458321476799, 0.6278059282227026, 0.4188866691080958,
      0.2783170273634145, 0.215714276299785, 0.21098005172936382,
      0.22181090074248636, 0.19742827352030118, 0.09478901470005424,
      -0.10712445811577537, -0.39884191836247274, -0.7401581786069263,
      -1.0683357261857371, -1.3127677097898331, -1.4123955468729557,
      -1.3314151753606187, -1.069202059360126, -0.6618376481927881,
      -0.17475487459482247, 0.3117141207601366, 0.7202944100250939,
      0.9937480906854474, 1.1066618972853524, 1.0691748700855859,
      0.921858836463888, 0.7232380375912018, 0.5333118869559725,
      0.39744103536469594, 0.3348155326447108, 0.33448460422816284,
      0.35991538294189185, 0.3607885260583073, 0.28882164089326373,
      0.11333711075966685, -0.16765992371287103, -0.5239666995615287,
      -0.8983327929195455, -1.2191070080761293, -1.4172363433258153,
      -1.443303251014424, -1.2802325420303018, -0.9483755631040613,
      -0.5016102009556267, -0.015382389424236614, 0.43033301735333923,
      0.7688873469668651, 0.9611752853816138, 1.0027162634170148,
      0.9219544808763823, 0.7703995049226516, 0.6073239842727596,
      0.48311422764152984, 0.4256771439639077, 0.4334660540260856,
      0.4769195646143516, 0.5078744441786629, 0.47439834333195685,
      0.3370434052131309, 0.08212491464954136, -0.2716150159879345,
      -0.6748853937129575, -1.057966493256822, -1.3466125849499837,
      -1.4797456465599046, -1.4244445107025845, -1.184391305676903,
      -0.7995878978304158, -0.3373736050752019, 0.12301143969076708,
      0.5084371553190424, 0.7679524183659501, 0.8829225783904522,
      0.8687975169781206, 0.7682445249249861, 0.637609442463051,
      0.5303773695485453, 0.48204878595964207, 0.5004369316479768,
      0.5639369445183452, 0.6281975236276087, 0.6393954537245798,
      0.5505545444104929, 0.33652298545370435, 0.0035440645491370826,
      -0.4092569936140084, -0.8370520576988268, -1.203478230583718,
      -1.4382832756968165, -1.4940030021010346, -1.3574377209756572,
      -1.0530005442067165, -0.6370728906394804, -0.1847894218593613,
      0.22740515764236544, 0.5390272785699866, 0.7183304555305999,
      0.7674524010962762, 0.7187915818620177, 0.6237476309795862,
      0.536929343866771, 0.500085850314932, 0.5300533906727007,
      0.6139245676894569, 0.7127236405275378, 0.7726129135832074,
      0.740651271591797, 0.5808999579031917, 0.28654395872699046,
      -0.11529493789447087, -0.5674952213395752, -0.9947960016913077,
      -1.3206874979410044, -1.4851119548367286, -1.4585141564142727,
      -1.2486896257215645, -0.8987039473888815, -0.4764271662878615,
      -0.05835622435925464, 0.28816400933154773, 0.5198348833220163,
      0.6257083318076804, 0.6269298089985995, 0.5681818713051345,
      0.5032438520174886, 0.47859689290473834, 0.5194855859574873,
      0.6221740642589974, 0.7544827016598863, 0.8644933346562202,
      0.8951400663180062, 0.8008262043826176, 0.5616382151106579,
      0.1913154410258786, -0.26327067240452084, -0.7311845592723325,
      -1.1328820813866625, -1.3982262563247603, -1.4825503793215138,
      -1.376732006323838, -1.1087574181711062, -0.7364209189472013,
      -0.3330572362143081, 0.030033974570578437, 0.299999220125086,
      0.4535480441805723, 0.500052678381004, 0.4760111735246117,
      0.4325075801335977, 0.4191190001169922, 0.46862738919766417,
      0.5866589285298993, 0.7490582981700378, 0.9077532007638979,
      1.0036116859379818, 0.9829293495802045, 0.8131929623195642,
      0.4939117995585596, 0.059553034911381975, -0.42635810985941397,
      -0.8846333182050659, -1.2380276235234882, -1.4286708251351334,
      -1.4309620474139424, -1.2567128010477464, -0.9512975839512509,
      -0.5818610874640968, -0.22064551728015375, 0.07227976038702777,
      0.2624945495271688, 0.3475437166603022, 0.3546174672172066,
      0.3303848151786256, 0.3258164231347913, 0.38013137480229936,
      0.5082147957291041, 0.6949253609731663, 0.8978862875848762,
      1.0581068028070069, 1.1156995538672663, 1.0265866370148125,
      0.775782536464686, 0.38368833796433, -0.096388931067211,
      -0.5890250328460707, -1.0131656347651077, -1.300224945309267,
      -1.4092810355322758, -1.3355859987546732, -1.1103139915239746,
      -0.791706149773657, -0.44996013536654816, -0.1497880178295275,
      0.06487692717569593, 0.18014768943058299, 0.2131531706205586,
      0.20462427554156948, 0.2052088863259181, 0.2592658794820467,
      0.39053968099280834, 0.5936128443570541, 0.8335066717694546,
      1.0536474031664822, 1.1901993350945046, 1.1890647531351142,
      1.0211087156717347, 0.6915802968465374, 0.2411664545752949,
      -0.261747468814182, -0.7357785262152973, -1.1045827016193255,
      -1.3137377852792824, -1.3422730496377189, -1.206015160023162,
      -0.9520135966964833, -0.6455857273919487, -0.3533926895760786,
      -0.12693933586134537, 0.009267346460194392, 0.06192238495088165,
      0.06453369497848388, 0.06574663713295681, 0.11360204270152757,
      0.24001221648059878, 0.44967896925273, 0.7165080375787499,
    ]);
    const expected = [
      [
        2.488247049219375, 2.3176527706130607, 2.5316402245671914,
        2.516825612212339, 2.4202477366496025, 2.645633132978656,
        2.300101542884488, 2.0456685374236403, -0.5150330114297832,
        -2.2746303800651844, 2.797180708954732, -0.2091591418695283,
        -2.6053346513439593, 2.4767952305544365, 0.43872346940351203,
        -2.83852243855883, 2.0221097007920665, 1.059287713657792,
        -2.90622232102353, 1.451543071857595, 1.6154239584571768,
        -2.8037776260176095, 0.7988490492943245, 2.0736139791916526,
        -2.5365607460215998, 0.10249275536440619, 2.4062272525334807,
        -2.1196486181888425, -0.5966189103802313, 2.5931761097217785,
        -1.5769595123836093, -1.2575459016326183, 2.6231199495057758,
        -0.9398241338584917, -1.8423796619511157, 2.4971814138274615,
        -0.2316708852454074, -2.3379464791623152, 1.641393183879352,
        0.09678319843010293, 0.8162375281276025, 0.4091097399104432,
        0.5480264697129136, 0.731362310648974, 0.31820156525572435,
        0.9370688249317097,
      ],
      [
        0.7138038210338313, -1.0533000813566755, 0.9448077029749804,
        -0.7810779473691287, 0.8320971240653259, -0.9948570525142,
        0.8669797897065308, -0.18970632690192693, -0.9627769874382388,
        0.16682091295154822, 0.8089580089905063, -1.1372176765306121,
        0.5300752234808589, 0.5322434538478309, -1.1710804262576722,
        0.8271952379581831, 0.2512693011693612, -1.1637641765933653,
        1.0917756151852847, -0.03513618386514852, -1.1145346641642635,
        1.3122929653414888, -0.31535965809200456, -1.0244601516740754,
        1.4789806813778148, -0.5783146832704135, -0.8960403105271946,
        1.5843221698835264, -0.8138819049820825, -0.733169399589262,
        1.6234034846999814, -1.0132942713887034, -0.5410510558140399,
        1.5941192719786992, -1.168938735699326, -0.32956992494318815,
        1.4987635693318615, -1.277947255890509, -0.16939293916511364,
        0.23290035456521158, -0.4470046608182934, 0.6127831719506479,
        -0.5816649133193333, 0.4161033600921156, -0.21216601195191526,
        -0.14981817688586865,
      ],
      [
        -0.27047971667917003, 0.6303610443073957, -0.6876287715496026,
        0.5341953620842783, -0.5620284891173752, 0.6814212131188115,
        -0.521029877054546, 0.18466286979311194, -0.06968177283526038,
        -0.05773025461743963, 0.09885273306979349, -0.029015279174872774,
        -0.07293087026866624, 0.09592438835545165, -0.01807027814228137,
        -0.07777434861684893, 0.09317386792367977, -0.009182563154911436,
        -0.08546233295330449, 0.08786847357591078, 0.0016530723653124207,
        -0.08868455722471096, 0.08371803444639196, 0.01100738128776017,
        -0.09462065229261667, 0.07637321109819958, 0.021304194609233284,
        -0.09613122461953581, 0.0709638117314791, 0.030770468409471383,
        -0.10004695220687292, 0.06189321152071566, 0.0401158690360298,
        -0.09982083809520846, 0.055408928005307945, 0.049326508320404895,
        -0.10152989944717025, 0.044999461790028235, 0.05735401419672653,
        -0.09960638351322484, 0.03766193454428517, 0.06594264238130253,
        -0.0990139001038482, 0.02635675939048804, 0.07234624378059358,
        -0.09549324506027394, 0.018418439236366473, 0.07996237355360175,
        -0.09260112693957176, 0.0066975197800868205, 0.08450800623326457,
        -0.08763917339948736, -0.001566136649802066, 0.09083158679513662,
        -0.08254730713614773, -0.01320700908971967, 0.09336529595552483,
        -0.07634831284600233, -0.021506212801772933, 0.0981205233316796,
        -0.06925144772106291, -0.03257699318423983, 0.09857305850259908,
        -0.062059509027975045, -0.04062803983030661, 0.10168379441647554,
        -0.05213213623118996, -0.07099983334189304, 0.19720976920852593,
        -0.34975678170405294, 0.24059297704921462, -0.030549191175043997,
        0.09229030917257576, -0.3218298820271889, 0.33430116351203704,
        -0.15243371318132404,
      ],
      [
        -0.002122269110814324, 0.014921507103447694, -0.05588884332287413,
        0.13868633666993616, -0.12218695116044499, 0.03506561133126976,
        -0.010529938616860312, 0.0020485820964055994, 0.0001326067401681948,
        -0.00024819500511925104, -0.00038685942078648837,
        -0.00014852988209740348, 0.00023511492735926384, 0.0003909707327442399,
        0.00016707404484058596, -0.00021962982497412734,
        -0.00039390655657063145, -0.0001866597617565652, 0.0002008457021154663,
        0.0003924927790538695, 0.00020262251590500298, -0.00018372973172727837,
        -0.0003907381092032175, -0.00021701928229169712, 0.00016865659593641718,
        0.0003913257711463911, 0.00023417554197130216, -0.00015070193132430218,
        -0.000389922701260218, -0.0002514214924803174, 0.00013018185479554863,
        0.0003843811949906706, 0.0002646739102687355, -0.00011207519856021498,
        -0.0003793085969769651, -0.00027702007144245785, 9.555414811035609e-5,
        0.0003763088693258598, 0.00029209025363799185, -7.583732141625086e-5,
        -0.00037060178880227125, -0.0003062814737379735, 5.4433120972186694e-5,
        0.0003611932273917392, 0.00031633259723442696, -3.6038401848498924e-5,
        -0.00035301677884387746, -0.0003261778495459967, 1.8672729960629445e-5,
        0.0003465024710201886, 0.0003385368631927267, 2.018527708042635e-6,
        -0.00033670595716920584, -0.00034908595658684853,
        -2.3422982152215615e-5, 0.00032384579718484083, 0.0003555783792773279,
        4.140266135180796e-5, -0.0003128903298870529, -0.0003625619894792242,
        -5.897251687740374e-5, 0.0003030706011560265, 0.00037168434665799875,
        7.9801878283266e-5, -0.0002895710618159538, -0.0003781563360992134,
        -0.00010032795422206648, 0.00027381050583028107, 0.0003808780347157397,
        0.000117215487453779, -0.00026049862611584684, -0.000384741477302715,
        -0.00013433464354247935, 0.000247713529687564, 0.00039022430689133054,
        0.00015445143973812656, -0.000231053925993233, -0.0003923549435493046,
        -0.00017326250362362044, 0.0002130555420857957, 0.00039124506664473804,
        0.00018843166366251944, -0.00019789148263397693,
        -0.00039184124819383796, -0.00020445443873117353,
        0.00018260130424185524, 0.00039342275886532126, 0.0002230290041482137,
        -0.00016345906601155312, -0.00039112949806109, -0.00023936508955949113,
        0.00014396818300477427, 0.0003862780340029132, 0.0002522629391836235,
        -0.0001275190938026909, -0.0003835767970102813, -0.0002665766409866943,
        0.00011028874429534221, 0.0003811493082149934, 0.00028283524633767763,
        -8.94477905103747e-5, -0.00037453448489570707, -0.00029604415984327205,
        6.926094536600295e-5, 0.000366175983343943, 0.00030621024089064544,
        -5.2136294074463826e-5, -0.0003602656896191883, -0.00031825825387532596,
        3.3615223030068774e-5, 0.0003538825560440928, 0.00033151611569042427,
        -1.1933267823152106e-5, -0.00034322863930072575, -0.0003410796840467914,
        -8.134920525271921e-6, 0.0003317303949225813, 0.0003481613799842568,
        2.530512855865221e-5, -0.0003228155027088656, -0.0003574647029983487,
        -4.440683331364116e-5, 0.0003126915007394971, 0.00036715561804408735,
        6.603429217977058e-5, -0.00029844865677729963, -0.0003727100083277063,
        -8.518441224859477e-5, 0.0012161753520406068, -0.008066018376905702,
        0.03202529222423386, -0.07973625498162411, 0.07043510629878574,
        -0.020261463558200483, 0.005562541779158342, -0.0011729896814904792,
      ],
    ];
    const result = wavedec(data, "sym9");

    const reconstruction = waverec(result, "sym9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym9_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5063572267689087, 0.9327424554953629, 1.2160037042109344,
      1.3226191422502378, 1.254483386590307, 1.0463975076670948,
      0.7560398448793988, 0.4490379322138855, 0.1829371118987249,
      -0.005923683116746181, -0.10941374988647509, -0.14687507479750841,
      -0.15703178238097107, -0.18481381943029102, -0.26666198570137134,
      -0.4182615325153734, -0.6280181494769157, -0.8581046278935993,
      -1.0529464877353327, -1.1530787692176376, -1.1108870253728953,
      -0.9042061380182067, -0.5442316261491058, -0.07558236060183524,
      0.43170487587211226, 0.8964572082217072, 1.2435570602864696,
      1.4199346456703434, 1.4055325830819656, 1.2166453722035124,
      0.9009120060270059, 0.5252892320430167, 0.16004251281155152,
      -0.13726571475861288, -0.3338689108905419, -0.4270886773361391,
      -0.4417000758783098, -0.42026880847842135, -0.40914069116232143,
      -0.4438516286355904, -0.5378462047239604, -0.6775166261473917,
      -0.824925299035796, -0.9275737822333363, -0.9327377180680914,
      -0.8026715596278506, -0.5267099564453894, -0.12702851200157791,
      0.3436071773326907, 0.8117718198334481, 1.1987215091471524,
      1.4374969185011501, 1.487665387383178, 1.3441316234303429,
      1.0378905904709925, 0.6285700758163271, 0.19062021501151716,
      -0.20345018091303763, -0.49870051632974965, -0.6684912071870106,
      -0.7178333093062749, -0.6787471508279315, -0.5990401088861774,
      -0.5275587324598922, -0.49982830032961295, -0.5278492468805324,
      -0.5967141987121523, -0.6689248232896796, -0.6952793553447351,
      -0.6294812383966263, -0.44262559387214895, -0.13370797860854428,
      0.2667247542836505, 0.7009429835275369, 1.095554820418938,
      1.377484699078042, 1.490554850932401, 1.4086140714067559,
      1.1419727358756386, 0.7355308398390498, 0.25902023654493533,
      -0.20828608772014087, -0.5946995477412003, -0.8509552838203864,
      -0.9592477774229711, -0.9344209028131343, -0.8172449527333461,
      -0.6616881771568854, -0.5195688458363525, -0.4265850916819334,
      -0.3933129877085547, -0.4034453422466686, -0.41965187743390336,
      -0.3954580191737802, -0.2899695266681588, -0.08151365607022287,
      0.2234817851474712, 0.5888539649231752, 0.9549575615315201,
      1.251428256302365, 1.4133958682553485, 1.397162261697399,
      1.1914342513633338, 0.8212607396792457, 0.34360327432281884,
      -0.1644750058527344, -0.6222006199520109, -0.9621380339412147,
      -1.1438256351891223, -1.1607949110136757, -1.0394256509053192,
      -0.8301221394856436, -0.593191170567497, -0.3830865535907465,
      -0.23503618817632005, -0.15740231248636916, -0.13161574556419123,
      -0.11955650225565259, -0.07632711514303825, 0.03502901953250592,
      0.23081962305453646, 0.4994531404402055, 0.801697828918982,
      1.0785729845118435, 1.265021526146482, 1.3059971172770906,
      1.17092718435378, 0.8628596311411434, 0.4198827461489578,
      -0.09169464190595497, -0.5908777234121635, -0.9990432039761294,
      -1.2564513489786013, -1.3342781732950508, -1.2393443809987497,
      -1.0105265410964481, -0.70788841083345, -0.39735134476214373,
      -0.13478660833238065, 0.04650511376502897, 0.1418770122588313,
      0.1736099202343635, 0.18201691635410655, 0.2118556902797517,
      0.2977203674709772, 0.4523350432387258, 0.660914839148963,
      0.8831895718442739, 1.0626995076791304, 1.14107719037239,
      1.073706833675907, 0.8427417238341176, 0.4640687386995016,
      -0.013712127853308831, -0.5182463986278629, -0.968293080388803,
      -1.2909870679597852, -1.4373657858841864, -1.3924414819970732,
      -1.1774370482435226, -0.8437299201406732, -0.46008260850248683,
      -0.09637029374222755, 0.19216198615745184, 0.37627091037889826,
      0.45702520830733495, 0.4621829285040642, 0.43578690447149215,
      0.4238453497252505, 0.45993927356146524, 0.5545870612333459,
      0.6912040765118589, 0.8297752485154503, 0.9173494891876486,
      0.9026781713457284, 0.7512114864672954, 0.4565205849456233,
      0.04507074530384564, -0.42708190546776303, -0.8850741619596116,
      -1.2510143196039687, -1.4609911616116176, -1.4792053944518841,
      -1.3057962570986816, -0.9764722933250586, -0.554063083568228,
      -0.11408538315815964, 0.2721321074036066, 0.5526583112734712,
      0.7048601737686128, 0.737720139794262, 0.6862249841801557,
      0.5994787213998991, 0.5257567667106104, 0.4984553045427417,
      0.5266153830488363, 0.5924883137404259, 0.6567679011564419,
      0.6701152445898867, 0.5879528673537491, 0.38462740741353796,
      0.06315932061689278, -0.34211326694655747, -0.7709043968241232,
      -1.1492404189490082, -1.4057231266482049, -1.487859117808163,
      -1.374451372623638, -1.0809845576184056, -0.6566417357118601,
      -0.17364054717998664, 0.2885418526576306, 0.6602447375114139,
      0.8958992710424247, 0.9821320361055934, 0.9378900818575417,
      0.8067851657905574, 0.6437930116408345, 0.4998278799024799,
      0.40819680604313396, 0.37640295582469085, 0.385353011547721,
      0.39609106438416725, 0.36222359498937, 0.2447152685078881,
      0.025101806311749797, -0.2864534456642418, -0.6505331448693022,
      -1.0056530463442108, -1.281642549427784, -1.4159907844238253,
      -1.3691269729303774, -1.134811709770665, -0.7429868040834235,
      -0.2542741407796564, 0.25263237212535344, 0.6976880524301742,
      1.0163311613590478, 1.1724160767969578, 1.164217314283045,
      1.0222083188792475, 0.799363283427488, 0.5565724065290553,
      0.3469390008949998, 0.2029471495842362, 0.12969992783289463,
      0.10583423543478254, 0.09172586797073444, 0.04271456619967329,
      -0.07621778739250651, -0.278262428892104, -0.5484051967894576,
      -0.8446799247853125, -1.106916128444753,
    ]);
    const expected = [
      [
        2.6260575730802205, 2.3625715311468083, 2.58812536778307,
        2.5991020592964182, 2.4918932413681683, 2.712324293436928,
        2.3421414173585973, 2.022040089531622, -0.9522372133344602,
        -1.653557935900132, 3.0257513240706975, -1.6357905790410243,
        -1.269802930160858, 3.000843012860386, -1.9477911570825517,
        -0.9118835593966605, 2.9220841976858773, -2.218938010426598,
        -0.5379278568931231, 2.7842325093960683, -2.4393876640403653,
        -0.16269359917177947, 2.5951161888652137, -2.603653245158002,
        0.19969751481972364, 2.3658012656442025, -2.710778107043342,
        0.5373146803502942, 2.109232073415925, -2.764216115741601,
        0.8416295887773557, 1.8386539012460155, -2.771140265948486,
        1.1082346630491167, 1.5666429834620939, -2.7483560935419775,
        1.3646167168586512, 1.2460901586965283, -2.215321558708288,
        0.22290703342950022, -1.0818533303252198, -1.0399272205215992,
        -1.1090642460378795, -0.6996293443342408, -0.255037385644074,
        -1.7474063018953354,
      ],
      [
        0.8244483556993697, -1.0931416171363881, 0.9728541995168718,
        -0.8222900737106508, 0.8701714348644802, -1.0233105729629486,
        0.9179643007813664, -0.2890363160488929, -0.8973714262914009,
        0.23172495308727808, 0.6428596879799193, -1.0525825946412588,
        0.6895090730164029, 0.17931403197551718, -0.9119916287883602,
        0.968449278512882, -0.30096779517293526, -0.6052491048339784,
        1.075575663056267, -0.739807680191267, -0.17679350919714062,
        0.9937349485385198, -1.0715699527019402, 0.31122650709735644,
        0.7323995911288167, -1.2455230751415052, 0.7879950768118869,
        0.3264209354911317, -1.2329308659579254, 1.1838879110597207,
        -0.16878875506135232, -1.0310916950305613, 1.4401696614180879,
        -0.6849152853142915, -0.664246405814852, 1.5231498312545322,
        -1.185571385273544, -0.018704451272467938, 0.9389296968734144,
        -0.08273996891079556, 0.6706165227754659, -1.593296347941553,
        1.3371825050246657, -0.39650192875013474, 0.3329413426358479,
        -0.9646731753950061,
      ],
      [
        -0.26546840695964263, 0.6391576678151352, -0.7041759942171711,
        0.5571075443271142, -0.5830749690665314, 0.6949283472610873,
        -0.5272927398076328, 0.17809794255896585, -0.060414063556668035,
        -0.05859866325909491, 0.086855550955612, -0.012673445968861986,
        -0.0781209526895863, 0.07994206712375014, 0.007220054462966833,
        -0.08388517923658269, 0.06959520724518849, 0.021556297665092698,
        -0.09131762380625977, 0.057646489075243876, 0.04054797188139712,
        -0.09114763556252059, 0.04254190241110445, 0.052609602043816456,
        -0.09198933111913182, 0.027391485605451384, 0.06842845860780263,
        -0.08563247208403381, 0.009541442829465062, 0.0761859479278329,
        -0.08002918955533282, -0.0066070331375945954, 0.08699929589470684,
        -0.06811915558703989, -0.02484779769921772, 0.0890111665037301,
        -0.05708096544019729, -0.03961455064438146, 0.09368747739729673,
        -0.04105277432400387, -0.05587405620255539, 0.08930447065014004,
        -0.026311249931475846, -0.06703487155830223, 0.08756607012467692,
        -0.00820470320638951, -0.07925107299930366, 0.07702548418027787,
        0.008029579272114782, -0.08504785308043072, 0.06948277786576113,
        0.02585071048230104, -0.09175242667911691, 0.053879838757511164,
        0.04119671237971067, -0.09113947994299754, 0.04194237451894938,
        0.05637085110845137, -0.09165887537004788, 0.023082562192517583,
        0.06860883276074659, -0.08445075549500729, 0.008759314485127324,
        0.0791026423130517, -0.07898624561935923, -0.011404441768395716,
        0.0882626299554007, -0.06669591990955717, -0.04494176529385433,
        0.16560716389633845, -0.05072581104767899, 0.07178772101057962,
        -0.08889841192913427, 0.11827155323205829, -0.2128807743235479,
        0.034241871179870785,
      ],
      [
        -0.002122650320848719, 0.015295039334951296, -0.05705410184677698,
        0.14139447990802417, -0.12455022723749132, 0.03579729246170138,
        -0.01081267280671637, 0.0020472579426823773, 0.00013881396863147874,
        -0.00019765652237304287, -0.0003453958854553645,
        -0.00016450058181489632, 0.0001734221730565261, 0.0003477793959354961,
        0.00019262386778885797, -0.00014603144455800813,
        -0.00034817369882198315, -0.00022251992410801907,
        0.00011245628085994244, 0.0003405268884104087, 0.0002467732728493093,
        -7.926800967361235e-5, -0.00032856799434564455, -0.00026520398589470516,
        5.036327253924626e-5, 0.00031864724936166166, 0.0002848057183072796,
        -1.9912310217592034e-5, -0.0003075255173338623, -0.0003057588625201297,
        -1.575091362559719e-5, 0.0002888759676958688, 0.0003207435115656996,
        5.044224531842653e-5, -0.00026584261421124054, -0.0003288922965574432,
        -7.960887511607498e-5, 0.00024521196507860016, 0.0003372304610585456,
        0.00010863820707296293, -0.0002245384537552938, -0.00034680265322422585,
        -0.00014182806294524546, 0.00019727739494278132, 0.00035048842530467617,
        0.0001734893386046094, -0.00016593236244725703, -0.00034675927291162676,
        -0.00019850191815273094, 0.00013762578409007244, 0.00034260395563075457,
        0.00022178430312669176, -0.00011070944034583701,
        -0.00033992923267968557, -0.00024825137222663326, 7.846956248463652e-5,
        0.00033190307174613473, 0.0002728087378715442, -4.27112574350047e-5,
        -0.0003163567544183215, -0.0002898606817301171, 1.0779521183159279e-5,
        0.00030016158805288326, 0.0003038307576793413, 1.819009547036291e-5,
        -0.00028606083949403514, -0.000320222959137124, -5.1036803982690065e-5,
        0.00026758296919496207, 0.00033462322148259315, 8.670988985618453e-5,
        -0.00024193389013423623, -0.00034104920124307424,
        -0.0001177625264182266, 0.00021577455112555747, 0.00034339998654604135,
        0.00014430163959880328, -0.00019263645355423458, -0.0003477238454315936,
        -0.00017324916303463445, 0.00016646387605006454, 0.00035035388887410455,
        0.00020435709010608, -0.00013384737994658297, -0.00034500300355302547,
        -0.00023019852447264056, 0.0001011356511597956, 0.0003350101615397483,
        0.00025015645556232557, -7.258033698940962e-5, -0.00032690407765501164,
        -0.000271189188818891, 4.258217373182417e-5, 0.0003178101711855124,
        0.0002938865558023421, -7.124535843673965e-6, -0.0003012085870241438,
        -0.0003109580220469916, -2.786242643014079e-5, 0.00027983550196937663,
        0.0003210983483469209, 5.7490256623851286e-5, -0.0002606171525799255,
        -0.0003312480946788712, -8.687220119705413e-5, 0.00024149377852695272,
        0.0003428519945585352, 0.00012062151844623701, -0.00021577424408255946,
        -0.00034886139347504216, -0.00015333144813066673,
        0.00018554328065901928, 0.00034731627631247883, 0.00017956960575389624,
        -0.00015802461390301397, -0.0003450745450495436,
        -0.00020394020198525437, 0.0001319744230314602, 0.000344431322252877,
        0.0002316353280289877, -0.00010058240748625469, -0.0003386702751023458,
        -0.0002578688045214926, 6.523015433228556e-5, 0.0003252048767147127,
        0.0002767606278259111, -3.332566092371925e-5, -0.000486114767943374,
        0.0005699026072447549, -0.000913561488834502, -0.004036066576800872,
        -0.006362812479947019, 0.009587218192979639, 0.0024515933525789085,
        -0.001357630699013611, 0.0005434146905523136,
      ],
    ];
    const result = wavedec(data, "sym9");

    const reconstruction = waverec(result, "sym9", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym10", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5051413824811727, 0.9304600175118072, 1.2129817825262552,
      1.3194007641083854, 1.2518437337515094, 1.0453068032078459,
      0.7575539265486736, 0.4541196860222468, 0.19223703913259266,
      0.007720554163227422, -0.09197163513224729, -0.1268899865060645,
      -0.13636496141329357, -0.16569936519502282, -0.25138221582314,
      -0.40879649606462454, -0.6257438389184513, -0.8636043719055041,
      -1.0659726016456494, -1.1726637652176246, -1.1355657569151751,
      -0.9322828399477907, -0.5740169929791872, -0.10553863854546626,
      0.40294138419994885, 0.8701653971301262, 1.2210816658429353,
      1.4028222365790148, 1.39557363370934, 1.2157649916213915,
      0.9108943004860793, 0.5473725315979983, 0.1944705060765644,
      -0.09162259428220348, -0.27970664438895854, -0.36859253118136504,
      -0.38416840051226, -0.3694778782707219, -0.370555356927174,
      -0.42183002164656974, -0.5349967039891597, -0.694337617333217,
      -0.8597983522958302, -0.9771027567530601, -0.9923491645807629,
      -0.8673351731170388, -0.5916164647088455, -0.18808216920799828,
      0.28956815716113204, 0.7670354934337514, 1.1649723916420254,
      1.4161663466102035, 1.4802100530736313, 1.3521100361990752,
      1.0627684039579643, 0.6712703382366889, 0.2509210569543429,
      -0.12750410351762814, -0.41118433956224104, -0.5756236538129289,
      -0.6275519776673932, -0.5998530304342208, -0.5400369676476956,
      -0.49539763107331175, -0.49880609206535315, -0.5588906663647624,
      -0.6571924765493543, -0.7530622607604789, -0.7950438321946072,
      -0.7357877808155944, -0.5465904309364157, -0.2277015601687527,
      0.18841909152208874, 0.6419517889584619, 1.0576807159303805,
      1.361266251484277, 1.4959012945415302, 1.4352879378628973,
      1.1897489558435932, 0.8039658060259047, 0.3468910052229196,
      -0.10369799235826016, -0.47823522381224165, -0.7298672335898934,
      -0.8429662871991017, -0.8337350204212055, -0.7429830524614568,
      -0.6231207308891642, -0.5228472572367292, -0.4735498383932059,
      -0.48094382682757947, -0.5240979228004772, -0.5620581925310371,
      -0.5463025533929999, -0.43572907635351876, -0.21019729350987482,
      0.12102224131044903, 0.5182615309459386, 0.9184136824533881,
      1.2482906064314214, 1.4411824947867196, 1.452566318990289,
      1.2710709325091727, 0.9219456972750395, 0.46211389139015,
      -0.032038213786180075, -0.4812002251965714, -0.8200147502165027,
      -1.0102454957678209, -1.0471398490993162, -0.9576071858541068,
      -0.7908845849215225, -0.6042274469981472, -0.44737413299746287,
      -0.3497879274592998, -0.31391598943185617, -0.3161209157818188,
      -0.3149411420736188, -0.26443150977592644, -0.12901036909339442,
      0.10416748269510134, 0.4186771200945808, 0.7700108876705344,
      1.0943934167496163, 1.323164732137354, 1.3992149719676683,
      1.2913783535096834, 1.0031488359574297, 0.5734546854938678,
      0.06918036666206145, -0.4288377150117284, -0.8430022342433956,
      -1.1152110798629382, -1.218301502303195, -1.160014120232134,
      -0.9786767229287806, -0.731864154736472, -0.4810176499697555,
      -0.275971369141645, -0.14329563671619705, -0.08133947689995491,
      -0.06310354445821778, -0.04604548918151913, 0.013870171169083845,
      0.14766112670030712, 0.3622612001573963, 0.6359229948350468,
      0.9214505097015732, 1.1566021576734333, 1.2791396354739646,
      1.2427642762224358, 1.0298960713385066, 0.6579882572226263,
      0.17764985899078037, -0.3371258067779289, -0.804366107466151,
      -1.1514915455199992, -1.3304955284931916, -1.327313190989015,
      -1.1632027448049733, -0.8879416815574406, -0.566658424486865,
      -0.2636708074072035, -0.027397878379359253, 0.11992053393522906,
      0.18523306959212724, 0.19983610306032024, 0.20812254635242733,
      0.25299888620216104, 0.36189329754831295, 0.5371131558978923,
      0.7531797503197115, 0.9619595749845198, 1.1043857548182605,
      1.1258361455864332, 0.9912475020788138, 0.6960518803896472,
      0.27002460149030477, -0.22711737368789944, -0.7174714580322883,
      -1.121319531714345, -1.3742036263561688, -1.4406030428316114,
      -1.3209362850967796, -1.0502548410091823, -0.6890429394442891,
      -0.30847391315116734, 0.026185964274713203, 0.26992603439013435,
      0.40661317231051886, 0.44989872315362467, 0.43640235243049164,
      0.41313156494979136, 0.422550649256303, 0.4892881009512584,
      0.6120229829682352, 0.762734053747082, 0.8935772652541996,
      0.9496665393311308, 0.8844774095081764, 0.6738709377888725,
      0.32503306266117327, -0.12212953985793104, -0.6017142675720265,
      -1.035201893952053, -1.3483353275495877, -1.4874360722458462,
      -1.4312029063627212, -1.1951321955686047, -0.8275091410952317,
      -0.3979902403791804, 0.018390318557619023, 0.35785788428309073,
      0.5811329053114733, 0.6801186471283354, 0.6765757897743735,
      0.6133544195896409, 0.5406289910725903, 0.5008223732920063,
      0.5161989326669633, 0.5823820424761716, 0.6694951847148952,
      0.7306356119797237, 0.715473126883584, 0.5854129973680162,
      0.32631774097753974, -0.04463674008942259, -0.4799337562252415,
      -0.9105062601937729, -1.2603465892400214, -1.4634392444108981,
      -1.4788932187752288, -1.300555139276576, -0.958722351085848,
      -0.5135116746896212, -0.04148931533205352, 0.38118396360450857,
      0.6950039216660964, 0.8688693698826151, 0.904583146458468,
      0.8332036659252323, 0.7043925813298718, 0.5716482041754887,
      0.4773138454221491, 0.4412552008438609, 0.4561136748597828,
      0.4903169774363131, 0.4980052809204063, 0.4332266912532636,
      0.2646301069167393, -0.013275341902649895, -0.37537466500696526,
      -0.7691497380430646, -1.1252398620639716, -1.3728786403417086,
    ]);
    const expected = [
      [
        2.084810444749996, 2.4036736843341977, 2.5284952803992,
        2.213958151575548, 2.9654357017518618, 1.9719157942490124,
        2.8203940634767, 2.1239768773955223, 2.324994101993624,
        -2.1605074618769398, -0.13821767229908852, 2.321076468809156,
        -2.265814844376058, 0.011533910891076509, 2.268676350213895,
        -2.362541245363109, 0.16224217118697243, 2.217505801301415,
        -2.4708998421902653, 0.33088972372240144, 2.1555858154326772,
        -2.586138976423744, 0.5207911683485307, 2.074554202402942,
        -2.7014284573357568, 0.7321514768227484, 1.9671650392039641,
        -2.8081400449884635, 0.9618854643480924, 1.828333747638718,
        -2.896945480039913, 1.2038925733236252, 1.655905589940858,
        -2.959019653771203, 1.4497052716133936, 1.451813625251821,
        -2.9933406508048965, 1.7176335003307186, 1.1303858808073861,
        -2.6920642539962754, 1.6745222854918815, -2.219762714326852,
        -0.22280948256695524, 1.5658867561645529, -2.642261139937087,
        1.1159332159582815, -1.2899544201456976, -1.3141348327232185,
      ],
      [
        0.5453513194165857, 1.7217593954275316, 0.18240458867778384,
        0.4900532634027811, -0.535841574724635, 0.5253732918342237,
        -0.8074767004034137, -0.7675674657149943, -1.3192515038414352,
        0.23760945464838384, 1.1702581479520437, -1.6753941904580916,
        0.8214927988185802, 0.6927130268854215, -1.6210650934733255,
        1.2113188547991094, 0.17916040718562143, -1.3968262492780952,
        1.4546367917347571, -0.33449836405007566, -1.0251506553487548,
        1.5209840508922998, -0.782892142021608, -0.5551253110730034,
        1.4040507897146326, -1.1093625225762513, -0.0485537630592669,
        1.1214942314219445, -1.2733532147884883, 0.4281558276667092,
        0.7126091771895341, -1.2557204597469798, 0.8127055264557179,
        0.23315721494353422, -1.0612505886307346, 1.0555249675532408,
        -0.2550665268999779, -0.7063259423609553, 1.1136361239887942,
        -0.49889574961266014, -0.593307766306804, -0.6354888161690005,
        0.8001364113526089, 0.2923489315771182, -1.1084364980702748,
        0.7527279888142867, -0.17530935487989469, 1.3555183393373034,
      ],
      [
        0.11162442324751877, -0.25491169344265574, 0.6943104733099272,
        -0.6176900145507954, 0.47960361931148443, -0.36218636225810125,
        0.28446647214084253, -0.431670448028119, 0.10542622834413395,
        0.047858095017947855, -0.06492235187800499, -0.005810260679636053,
        0.07202796638298206, -0.05782311949904956, -0.02123516210128061,
        0.07552539726736919, -0.04661076658660195, -0.03302593376117268,
        0.07735662395112922, -0.03570632135681939, -0.046375398426181075,
        0.07588262714202947, -0.021699653229949583, -0.05556407061943118,
        0.07254852912287131, -0.008965023273603875, -0.06551288054311936,
        0.06626057001637925, 0.00612247024140567, -0.07072759701219995,
        0.05823695006978787, 0.018887506521679566, -0.07613415686797881,
        0.04792815706551638, 0.03320843218047811, -0.07652860943700612,
        0.03629389896988129, 0.0441920237841743, -0.0768429893759868,
        0.02329751952452278, 0.05600731742814927, -0.07220833980404377,
        0.009592861659428771, 0.06362404410374857, -0.06754360440392258,
        -0.004392605797942252, 0.07153045990438811, -0.05833672069809867,
        -0.01836827783713243, 0.07463015818599529, -0.049453276231441724,
        -0.03150195271665858, 0.07774364913112539, -0.03673757338741881,
        -0.04392625696449584, 0.07576315129067546, -0.02494259192987832,
        -0.0544664975519523, 0.07383407865752448, -0.01024923678525967,
        -0.06373315815737016, 0.0668719465693683, 0.0027756394000360567,
        -0.07026622503155681, 0.060316172245275204, 0.0176446040454667,
        -0.07492272045272941, 0.04657855622911756, 0.04138442977278302,
        -0.10040302619446026, 0.11645958142252166, -0.09842105911213554,
        -0.03894408241574841, 0.10951874690431816, -0.14003636874485725,
        0.22545355189880964, -0.15998841575047168, 0.01888478264891687,
      ],
      [
        0.0008041002268640868, -0.005755618496733294, 0.01982048725825255,
        -0.036116225240129494, 0.10444797292280784, -0.11716953566663171,
        0.04268352147511604, -0.00999260263581615, 0.0011466085953343872,
        0.0001662437111880769, 8.536080262920337e-5, -7.649846031112075e-5,
        -0.00016568380235630793, -9.747616082768639e-5, 6.355832461975845e-5,
        0.00016474600656679866, 0.00011003194099864504, -4.893219568692788e-5,
        -0.0001616903213422018, -0.00012153624428648774, 3.338887642926778e-5,
        0.00015627193892065318, 0.0001307799013752491, -1.8709473212254104e-5,
        -0.00015027372747068528, -0.00013903367502359306, 4.428090966268093e-6,
        0.0001440786714592639, 0.00014739193049105782, 1.101053777556669e-5,
        -0.00013601226135375312, -0.00015448026461930067,
        -2.6951704195669868e-5, 0.00012574537999693466, 0.00015902974372802089,
        4.157052250324737e-5, -0.00011507458662838644, -0.00016226382768782046,
        -5.52110911745656e-5, 0.00010454646700259573, 0.00016541171613487787,
        6.947002776546866e-5, -9.255345309749832e-5, -0.00016723178378582904,
        -8.382600863245278e-5, 7.867522300594544e-5, 0.00016640878315387692,
        9.643573734752025e-5, -6.470274135032188e-5, -0.00016411783709479753,
        -0.00010753520942335815, 5.1332415448011566e-5, 0.00016172053924596512,
        0.0001187691190696264, -3.70202071619365e-5, -0.00015811723218504912,
        -0.0001297669493870241, 2.1244010605988976e-5, 0.00015195450175872955,
        0.0001386907876009412, -5.766150596968854e-6, -0.00014435269664631717,
        -0.00014568062640419344, -8.585095777964092e-6, 0.00013679694383392867,
        0.00015243307116115335, 2.3296929436634117e-5, -0.0001283322568689587,
        -0.00015874194658804168, -3.900576802378643e-5, 0.00011756969746003822,
        0.00016279497172816502, 5.400282561295153e-5, -0.00010556306476846493,
        -0.0001646448278365525, -6.734811088897916e-5, 9.390600474414826e-5,
        0.00016603931128986724, 8.047997819608148e-5, -8.178481081077098e-5,
        -0.00016694464547624117, -9.416156141236975e-5, 6.777273502552993e-5,
        0.00016558939206613396, 0.00010676218799897668, -5.2840745110125796e-5,
        -0.00016194292007966989, -0.00011725033383622521, 3.86708588852396e-5,
        0.00015779786527863628, 0.00012702267441161284, -2.45822887105196e-5,
        -0.00015329447191210344, -0.0001369792068505424, 9.104537522431851e-6,
        0.0001467114964648324, 0.00014558945065675118, 6.893554167338974e-6,
        -0.00013793372016272966, -0.000151748452152494, -2.166522972494125e-5,
        0.00012878629176645744, 0.0001568155781166402, 3.576998373080477e-5,
        -0.00011957846552754101, -0.00016183366464733078, -5.072985687843025e-5,
        0.00010864263649148224, 0.00016539012143770002, 6.579848367321665e-5,
        -9.577264332472432e-5, -0.00016632083347236683, -7.918942655040537e-5,
        8.280828752814948e-5, 0.000165947867345485, 9.135371912515457e-5,
        -7.021677653725763e-5, -0.00016545726353892661, -0.00010387251268623214,
        5.6382401282508256e-5, 0.0001635662835370072, 0.00011614114073641731,
        -4.0997571003629986e-5, -0.00015906090159285342,
        -0.00012635775641877095, 2.589452018212702e-5, 0.00015322058847818797,
        0.00013487683147947062, 9.589267919940856e-5, -0.0011079669377178107,
        0.003449257994540754, -0.006931613125628879, 0.019323441547732953,
        -0.02078193808106, 0.007315616006458341, -0.0018014315102963345,
        0.00011931140019051786,
      ],
    ];
    const result = wavedec(data, "sym10");

    const reconstruction = waverec(result, "sym10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym10_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5062807907852416, 0.9333602263124718, 1.2184506411606537,
      1.3277332466410723, 1.2621425318916104, 1.0551250349426418,
      0.7630748726488359, 0.4509201400405822, 0.17648222813653458,
      -0.022527849756598828, -0.135731737422365, -0.17987764924201674,
      -0.19145640582991044, -0.21421084352438985, -0.28489733044651494,
      -0.4210900147526566, -0.6142872354267572, -0.8302193610787618,
      -1.0164103364219292, -1.115175990029429, -1.0788214772122564,
      -0.8831872691934746, -0.5360454253512877, -0.07808181110069687,
      0.42398890921999133, 0.8906895797504224, 1.2463575136419671,
      1.4351261259314452, 1.432528474829876, 1.2499927628742893,
      0.9312222964396645, 0.5414181933908845, 0.15202581005621685,
      -0.17526005813576295, -0.4013692922692187, -0.5165758708067497,
      -0.539601087084666, -0.5095610390534295, -0.473009061332438,
      -0.46953500056753367, -0.5197140773676077, -0.6185680351062729,
      -0.7362707253567115, -0.8259602172798296, -0.8366811635144153,
      -0.7281380058142031, -0.4834314038667529, -0.11640788166709337,
      0.3284348662018729, 0.783702618722483, 1.1728220355963992,
      1.426517539161893, 1.4981222084059733, 1.3740416262302955,
      1.0768429121889238, 0.6602194827398985, 0.19704594065586542,
      -0.23659877470052793, -0.5776092154820666, -0.7883939229917734,
      -0.8628766698439436, -0.8247010621865016, -0.7183224152045753,
      -0.5954246080344031, -0.5002296523568426, -0.45749451052792856,
      -0.4662601870908738, -0.5009185807994001, -0.5192718859209399,
      -0.47545400860251563, -0.33431844240360675, -0.08349177266940777,
      0.26014958712539316, 0.65143735817352, 1.0252965573144397,
      1.3106703109510611, 1.4466732951321184, 1.3970540979461588,
      1.1594086001658328, 0.7668327232791556, 0.2815270502668445,
      -0.2181829917411712, -0.6543524521107587, -0.9655442212100347,
      -1.1187894690746099, -1.1146356786235176, -0.9842485575760288,
      -0.7794878149002594, -0.5585868416697151, -0.371108975804563,
      -0.24597187275624655, -0.1855012765711998, -0.16690802055189102,
      -0.15067311530994057, -0.09355582973625642, 0.037246183267632405,
      0.25255912453561846, 0.5354362404950785, 0.8427692648008045,
      1.1140922211747986, 1.2855191442885994, 1.3054186707450097,
      1.147932018336216, 0.8209150095929206, 0.3662157138428671,
      -0.14794092170021242, -0.6407618726375189, -1.0356704205549163,
      -1.2761169731582103, -1.336704592578886, -1.2270647646134583,
      -0.9876912402452703, -0.6788973541877285, -0.36571994780624567,
      -0.10254125891640342, 0.07879329701357435, 0.17451573550258329,
      0.20692280873063904, 0.2155226238749964, 0.24378464595907384,
      0.3250418338574809, 0.4712952804781114, 0.667920677916186,
      0.8757615798717732, 1.0401977447100634, 1.1049750455632403,
      1.0273306339431603, 0.7905605501292619, 0.41075776423151616,
      -0.06414417660052471, -0.5630009922162779, -1.0058440906677002,
      -1.3206722784776372, -1.4586826175970395, -1.4043334677485977,
      -1.17787847241779, -0.829834683652698, -0.42879964859369735,
      -0.04562830625208397, 0.26217288350782936, 0.4620869486671837,
      0.5515497162065472, 0.5552208614488062, 0.5154837014589708,
      0.47878332885291475, 0.4814328839208956, 0.5386162263504459,
      0.6394698545087543, 0.7495520552457107, 0.8201001702066923,
      0.8017180992665018, 0.6589693498959744, 0.3820716937623874,
      -0.007428695569718924, -0.45865011312595616, -0.9007786598194302,
      -1.2577693694358278, -1.4648870096719557, -1.4831312024390422,
      -1.3080683016477388, -0.9709296007687641, -0.5317023283868136,
      -0.06587501856692513, 0.35197632785070176, 0.6638367807829443,
      0.8394405055931395, 0.8804397909745799, 0.8167553310836861,
      0.6962492447334035, 0.5705021948945302, 0.48040704804736395,
      0.4452843060676841, 0.45828462452546914, 0.48921006272486617,
      0.4939706841793049, 0.4281792892850941, 0.26130633752659593,
      -0.01235731231776932, -0.36890434365018165, -0.7576187648566013,
      -1.1109115131901288, -1.3590975065454476, -1.446474380349636,
      -1.3447828002904159, -1.0607198291630415, -0.6355970825562849,
      -0.1371343620456476, 0.3547125314158104, 0.7645464056260112,
      1.036978407530131, 1.1471160306612516, 1.1037088293372517,
      0.9443849125824694, 0.7243509205514949, 0.5015120757587992,
      0.3218050594334321, 0.20842024737799575, 0.1575547511928671,
      0.14164671214536792, 0.11912083980910755, 0.04800845443275009,
      -0.10018870257832396, -0.33009283825219865, -0.618334521956349,
      -0.9169653162036281, -1.1637190120156204, -1.2966814659177737,
      -1.2697691081643203, -1.065150513989914, -0.69944486516993,
      -0.2220256052742049, 0.29432176631378687, 0.7682679007472419,
      1.1268571175879105, 1.3204919068241803, 1.3324734416457849,
      1.180918604538601, 0.9127352015615319, 0.5912662746341255,
      0.28073390614929133, 0.031347661428068885, -0.1312860189801231,
      -0.20994798068134532, -0.2320250117116353, -0.23932665313164192,
      -0.27428041435340217, -0.36619123294851513, -0.5212194305167737,
      -0.7187716427374402, -0.91535307973049, -1.0550111526320298,
      -1.083792831436376, -0.9645718037773314, -0.6884473486407354,
      -0.27971770680648006, 0.2070093941075929, 0.6970737776596936,
      1.1110670678278871, 1.3816008815464143, 1.4675704142619415,
      1.362534811510328, 1.0952561287002889, 0.7223384037968734,
      0.31481727428600836, -0.05800337593764682, -0.34354447851995606,
      -0.5161959565804511, -0.5804597491510282, -0.566438367853544,
      -0.5190362867386257, -0.4838035980591844, -0.4931655721371972,
      -0.5566464911019979, -0.6576479227588086,
    ]);
    const expected = [
      [
        2.104464294548121, 2.4098198694713227, 2.5470832132844174,
        2.2243269445576863, 2.983713275614543, 1.9819916628162983,
        2.833514860135289, 2.1557597545634994, 2.2770722519092432,
        -2.2120185988225236, 0.04101067330946942, 2.1877171403053137,
        -2.3875986859730065, 0.35636785511565583, 2.0246784300465563,
        -2.5333152367548584, 0.6771461830774793, 1.834318941757936,
        -2.664148942878052, 1.018399463101453, 1.6002540878606286,
        -2.7666866563856694, 1.3770214027776944, 1.3123370288864284,
        -2.8241904781086666, 1.7423660435814898, 0.9660165594992884,
        -2.819243294331388, 2.0971741887116124, 0.5643970883290335,
        -2.7372841952761147, 2.4199200662374665, 0.11886911376071518,
        -2.5697664598410324, 2.688044982918637, -0.3516427997536017,
        -2.314802416632078, 2.877691004385058, -0.8615978634170476,
        -1.5398994226966845, -0.9603966211760532, -1.5183201083512927,
        -1.4358973393315677, -1.1654144037444294, -1.7380830637587021,
        -1.0158059227824514, -1.180804347649776, -2.3033756920002766,
      ],
      [
        0.48547164208583127, 1.7598744715404864, 0.1755111499277352,
        0.49536418599788645, -0.5418330287575884, 0.5322892372875886,
        -0.8167230391517364, -0.7653616977583175, -1.3398942025118357,
        0.2996767496583845, 1.1039843146483328, -1.7033450205492395,
        0.9892471353463467, 0.4821428871245418, -1.5576410676807826,
        1.4070915231911705, -0.1713546921658462, -1.168205990918835,
        1.575327400212347, -0.7643355480840582, -0.6040834868521423,
        1.466353403406754, -1.1872067256276728, 0.02494806457001282,
        1.1073672693378693, -1.3641796922799008, 0.597396426327326,
        0.5739113989954977, -1.267971671492048, 1.00386210232237,
        -0.02505011717137149, -0.9250176889577056, 1.168452380469486,
        -0.568600110097882, -0.410183236394669, 1.0636690028566065,
        -0.9465699540072191, 0.1665969532084695, 0.7041464443245288,
        -0.5452948555406879, 0.5219720358263497, 0.16554309194993075,
        -0.053285701902970314, -0.10199142567270282, 0.13630414251312964,
        -0.023266771177938888, -0.4043535318733776, -0.29306660510051785,
      ],
      [
        0.10841248237484322, -0.25229775327458587, 0.6938104399425078,
        -0.618086021511132, 0.4845887197906597, -0.36880353292217105,
        0.2862501917240071, -0.43075138716088196, 0.10424308576177715,
        0.046021643169101296, -0.05986197420746354, -0.010018647181903461,
        0.07056336061370964, -0.05061321782502261, -0.027592742532295225,
        0.07324734321205267, -0.03631542049616399, -0.04067306040696965,
        0.07293274530767276, -0.02245452606551751, -0.05453203955334729,
        0.06854856452905568, -0.005106969001566454, -0.06295983861454628,
        0.06100024004095072, 0.010004074873814038, -0.07089126565649585,
        0.05038582961328753, 0.02721556396831952, -0.0727721760969555,
        0.03709762233780969, 0.04038269023534942, -0.07345112919319892,
        0.022342194924640617, 0.05431773447138156, -0.06819412757790201,
        0.005897472938622261, 0.06271137833762018, -0.061698386334441135,
        -0.01006023645120576, 0.07088731946744636, -0.050136028826840796,
        -0.026495115253133868, 0.07260243045044205, -0.03792677606655696,
        -0.040444415404094644, 0.07367674708818107, -0.022155610404489517,
        -0.05374035585576251, 0.0681115942730838, -0.0067871034502570695,
        -0.0628302268028516, 0.0621403718645745, 0.01024049286503459,
        -0.07050766066017645, 0.05011970513404142, 0.025625234354454806,
        -0.07280845251322576, 0.038541526943340225, 0.04067774822705983,
        -0.07352148853435736, 0.02215982610409731, 0.0529662054559789,
        -0.06840637770617189, 0.007508762126857639, 0.06315302055993435,
        -0.06200246228309451, -0.012826885142738454, 0.08568611575241303,
        -0.11058589719735731, 0.20591635989728835, -0.17758868492042718,
        0.25299737160062, -0.1759067746695056, -0.0015647586250926064,
        0.04399960233144841, -0.15493393615351797, 0.07621203499478282,
      ],
      [
        0.000795878460870067, -0.005768877948425953, 0.01985845037751517,
        -0.0361226289747248, 0.10454113541916028, -0.117335853266705,
        0.042772377591449674, -0.010014245692411806, 0.0011407649448836239,
        0.00015608066326307043, 8.532209802485373e-5, -6.537191757324508e-5,
        -0.0001546727158590859, -9.878294807352128e-5, 5.0056340499622906e-5,
        0.0001524516863794763, 0.00011237432784460925, -3.288915838166605e-5,
        -0.0001475799539363366, -0.00012450104696973784, 1.4672013356587942e-5,
        0.00013970353798991355, 0.0001337108485440757, 2.544264868672942e-6,
        -0.0001307571827043767, -0.00014122484262987371, -1.900678022664714e-5,
        0.00012139406237579294, 0.0001483429771417342, 3.6366212162651295e-5,
        -0.0001099316906452785, -0.00015373709889942303, -5.407303292523705e-5,
        9.584672690581335e-5, 0.00015586070621222457, 7.002779385681499e-5,
        -8.106772433094634e-5, -0.00015582449010006333, -8.423500404406831e-5,
        6.656622196990827e-5, 0.00015518685051859682, 9.841055253045775e-5,
        -5.0824291142018195e-5, -0.00015292634099245926,
        -0.00011230545900236746, 3.3133169543175434e-5, 0.0001474419770289849,
        0.00012384870157050424, -1.5349288918027962e-5, -0.00013971879678898954,
        -0.00013283755512886563, -1.28772836039911e-6, 0.0001315455785188144,
        0.00014105385575644415, 1.813620039108787e-5, -0.0001222245140993462,
        -0.000148585132299672, -3.611254868351415e-5, 0.00011012387298953781,
        0.00015345685700974524, 5.3505108462186305e-5, -9.607316354319918e-5,
        -0.00015528835408851722, -6.886794602245483e-5, 8.204225460304074e-5,
        0.0001559153674989015, 8.341232684084269e-5, -6.765135514885941e-5,
        -0.00015577861454492197, -9.828329700348033e-5, 5.124659346780091e-5,
        0.0001530522596051284, 0.00011198463746878065, -3.3460167599071145e-5,
        -0.0001471953361856688, -0.0001229287118292658, 1.6376440495438323e-5,
        0.00014006858941461166, 0.00013219210192095117, 9.070765580234535e-8,
        -0.00013245940134075395, -0.00014116021879804163,
        -1.7619549220302343e-5, 0.00012272312191173162, 0.00014861219963599497,
        3.582299386256627e-5, -0.00011016215493254553, -0.00015287765973058455,
        -5.257913603555226e-5, 9.661581194011322e-5, 0.00015490346979545825,
        6.771682693601622e-5, -8.318816490361072e-5, -0.00015631109748640438,
        -8.294517291800545e-5, 6.842838894841849e-5, 0.00015619688798004376,
        9.816808283008962e-5, -5.14731610000644e-5, -0.00015285426685863963,
        -0.00011130466089881354, 3.407941701451646e-5, 0.00014709286045218707,
        0.00012196678582460465, -1.7617994949100367e-5, -0.00014074556694486807,
        -0.0001318973241482813, 8.281281254298887e-7, 0.00013324529862084665,
        0.00014132673802241368, 1.7336512835546623e-5, -0.0001228796925457061,
        -0.0001482863361375262, -3.527059119575132e-5, 0.00011029916226258825,
        0.00015220717787436515, 5.139976535663206e-5, -9.75023140986765e-5,
        -0.00015485826780303432, -6.680866397929178e-5, 8.425471418259293e-5,
        0.00015681454115166286, 8.274512443450622e-5, -6.885230901991545e-5,
        -0.0001562758207332331, -9.782459627443081e-5, 5.175159004816782e-5,
        0.0001984499787610804, -0.00021307971005809384, 0.00047619465623027063,
        0.0021542631512663788, -0.01715793836471869, 0.01811020391455229,
        -0.005421150523438787, 0.0024083444480759745, -0.0005983036345434203,
        0.00023335767811362722,
      ],
    ];
    const result = wavedec(data, "sym10");

    const reconstruction = waverec(result, "sym10", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym11", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5047447762222672, 0.9330798257644765, 1.2236734642158438,
      1.3419698141274525, 1.2859196470410772, 1.0845558013643197,
      0.7898943613226574, 0.46418689326538787, 0.16560131371600673,
      -0.06427843139073608, -0.20824106972175743, -0.2748158778641963,
      -0.29309253553580555, -0.30246366875110964, -0.33998930289237905,
      -0.4286461027491975, -0.5694883639322394, -0.7397705517000193,
      -0.8975999858959295, -0.9920620737115835, -0.9763837332043532,
      -0.820908242838444, -0.5226414065838356, -0.10890210520400279,
      0.36601186965976956, 0.8305771915932203, 1.2101160692132307,
      1.442034261317675, 1.4887655056190914, 1.345467977672869,
      1.0407222677602679, 0.6300971785398173, 0.18409607725221705,
      -0.22671767034746373, -0.5459964084994596, -0.7420535522951963,
      -0.812196516900466, -0.7801456898534577, -0.6873934369790834,
      -0.5807907016147489, -0.49951795962619044, -0.4646962260224102,
      -0.4742022887567485, -0.5039404899129802, -0.5152104887311815,
      -0.46628808571506053, -0.3252739130558989, -0.08092117913805225,
      0.25138600613300094, 0.6301765492268968, 0.9950570587018711,
      1.278981223207516, 1.4228421352994707, 1.3889956753807515,
      1.170518672724373, 0.793964410304951, 0.31487480894186376,
      -0.19301113683445323, -0.6524482765949223, -0.9979697085771828,
      -1.1883344577374446, -1.2133895102148538, -1.093920737783433,
      -0.8747165798056662, -0.6126502925880711, -0.3627250141899936,
      -0.16545185262512824, -0.038547073248587804, 0.025162933421859712,
      0.05328317433889711, 0.08410680899160916, 0.15415150519191684,
      0.28620372088033325, 0.4809714272252704, 0.7145573045004647,
      0.9425300787459557, 1.1097382733219079, 1.1635737260714556,
      1.067500782355507, 0.8115396054715094, 0.4170637648434885,
      -0.06541367319012772, -0.5651465064090446, -1.0048514439020408,
      -1.316146777759553, -1.4532558988663768, -1.4018849791849703,
      -1.181298329493238, -0.8391921037973691, -0.4406328047605689,
      -0.053686357268362905, 0.2649050213381851, 0.480708235688608,
      0.5868029633498814, 0.602177728301284, 0.5639406984180928,
      0.5154490581507939, 0.4934205579201963, 0.5172999741674822,
      0.5835641111538017, 0.6664064581937872, 0.7246489481975478,
      0.7131703398398623, 0.5959969486478798, 0.3577505462548015,
      0.010502189537006934, -0.40584244939559583, -0.8299574733624161,
      -1.1910020514941055, -1.4233649806089728, -1.4808752795501796,
      -1.347181226959672, -1.039858824245699, -0.6072506141815016,
      -0.11871637428017107, 0.3495001004491119, 0.7295801734540394,
      0.9751600607442068, 1.069191211543088, 1.024983204294035,
      0.8804007314388239, 0.6867966712938186, 0.495480356824779,
      0.3450553089303167, 0.25268961612691915, 0.21137439103471622,
      0.19372774081961255, 0.1612772713135571, 0.07679691605035055,
      -0.08348745597562135, -0.3209899316704738, -0.6115240815157312,
      -0.9087185985823167, -1.1534433802654425, -1.2871084822533794,
      -1.2657102367052486, -1.0712557885286689, -0.7177623086139153,
      -0.25026930619782806, 0.263071870724381, 0.7441443855863121,
      1.1203276175355694, 1.33880379062999, 1.376504287068056,
      1.2435079653789765, 0.9792317150078071, 0.6424283418892442,
      0.29743087192739087, -8.162781318343804e-5, -0.2144694315604282,
      -0.33608107803947296, -0.38052807038744774, -0.38168062569677597,
      -0.3803018611485424, -0.41128271393300914, -0.4927570448389172,
      -0.6198910391346144, -0.7649721125145822, -0.8838539166348628,
      -0.9272261785445435, -0.8539564912468822, -0.6431935133628811,
      -0.3021655182201256, 0.13239995887422784, 0.5998054364990049,
      1.0267741877813288, 1.3422006148069245, 1.4919277696489979,
      1.4501731023174214, 1.22497557798552, 0.8564112008743937,
      0.4079945281229443, -0.04674510378736019, -0.43942445260832685,
      -0.7202478807045274, -0.8667207697817331, -0.8857798753920297,
      -0.8090672717455594, -0.6827044245830662, -0.5542111937036864,
      -0.4598544400512936, -0.4155521784619854, -0.41354400552019577,
      -0.42559091673125593, -0.4118395471666628, -0.33307236467949103,
      -0.1632094668267547, 0.10116213431194643, 0.4367558373701545,
      0.7962506532134165, 1.117227535442468, 1.3354089747035571,
      1.3991521285628687, 1.2817862756600693, 0.9888387904574042,
      0.5583560062908745, 0.05412214560737133, -0.4467677564735363,
      -0.8692090822082592, -1.1548249201744143, -1.2728428897398132,
      -1.2247299440869386, -1.0416732821679586, -0.7756693743094331,
      -0.48646271266923574, -0.22751021755992368, -0.034316598345867366,
      0.08214556043716692, 0.13549358154354343, 0.15764384612250046,
      0.1879014646173191, 0.2602844645105133, 0.3923594891997886,
      0.5784857198496789, 0.7892726797923744, 0.9775199248041274,
      1.0892946386587292, 1.0775076783065836, 0.9146849880865101,
      0.6017633963974667, 0.17064036859919512, -0.32033584295107465,
      -0.7970824922437629, -1.1843732105385927, -1.4210348699334074,
      -1.4723123516410472, -1.3366032609920415, -1.0450636961696906,
      -0.6542363062682388, -0.2334616004077339, 0.14997868087189897,
      0.44455166250922395, 0.6238912141204621, 0.6898987195075676,
      0.6690175692487607, 0.6028129944767308, 0.5353408768727661,
      0.5005291190043252, 0.5127477486868401, 0.5629237650770409,
      0.6211645741089608, 0.6452281745531658, 0.5927136979398335,
      0.4338983069377739, 0.16194714055598824, -0.2021770057754605,
      -0.6115199939258582, -1.0014598718778367, -1.3027649457448545,
      -1.45643188104911, -1.4268732568040288, -1.2103614813631878,
      -0.8367103107608789, -0.3637333062306307, 0.1343086628933654,
    ]);
    const expected = [
      [
        2.168845996584253, 2.5108969783286543, 1.8285126752297438,
        1.981961247054927, 2.454577273778422, 1.3837493203240399,
        2.3799227081267547, 2.1446037677837073, 1.8091575358969456,
        2.2130155894571013, 1.3388605152531603, -1.658428302656698,
        -0.5865630604746394, 2.7072343637166796, -2.554689259595152,
        0.17865032915143972, 2.3821914887826456, -2.9017998137785743,
        0.9153057078318788, 1.8663962408788588, -3.0389790826932033,
        1.5933676097550518, 1.210507684348011, -2.944943538284342,
        2.126161568144554, 0.5065782581922956, -2.653471243016865,
        2.4676267740161966, -0.15387331740692373, -2.2375894560311016,
        2.6245944267708845, -0.7115550376988725, -1.7787686137982124,
        2.646377708550823, -1.1557593857147574, -1.3344838814204187,
        2.5966277180946222, -1.5136749211383278, -0.9174539537285111,
        2.53623467103209, -2.1782269377297627, -2.5899899128767014,
        -2.6471817643126347, -2.45307379547414, -2.319316580284402,
        -3.249125526472113, -1.624486108277311, -3.3782399309849294,
        -1.5969840180862913, -1.6815717117437365,
      ],
      [
        1.475745652494335, -1.211654557418888, -1.0189462249432977,
        1.600126947711731, -0.16099493001735657, -1.3874764504234183,
        0.8475523086109471, 1.378620646224833, -1.3717656013538635,
        -1.0288352641728455, 0.5449460787224458, 0.2727599631378446,
        -1.0106083260705363, 1.1724572570968363, -0.6615079210426948,
        -0.1960250522390152, 0.9080640407146296, -1.0918575334940555,
        0.6583852843855168, 0.1550084491046761, -0.902517715348007,
        1.1517997919857919, -0.7221552562587977, -0.1808416971004697,
        1.0373629915944913, -1.2973539548548623, 0.7360706959083946,
        0.3506651802250078, -1.2817589227428194, 1.4165429586644764,
        -0.6058453560833602, -0.6574192904175917, 1.5328783036397038,
        -1.401074436675333, 0.31338113988047084, 1.0126336860239773,
        -1.6731644568779973, 1.1967146824886346, 0.1478963590052744,
        -1.4517714045324792, 1.358985399052904, 1.2323170648810804,
        1.209798848802613, -0.6300841909554449, 0.7736883823961465,
        -0.7382968764842137, -1.7064692529280652, -1.1736446683496682,
        1.0736706595195227, -0.3303232532410204,
      ],
      [
        0.43499005796345325, -0.6439778686818567, 0.19480975819758742,
        -0.08253487576453243, -0.03457004444106407, 0.048141106129436374,
        -0.040085347209249014, 0.35869762964343344, -0.10334029718595902,
        -0.05312211691707743, 0.05464310682836245, 4.8526808797234226e-5,
        -0.048515894650938834, 0.03585870482756732, 0.021312466031289928,
        -0.05253917766439797, 0.019936134531485693, 0.03599218209673531,
        -0.04870977338941073, 0.003237876053652045, 0.04682714167187658,
        -0.04032567066598545, -0.015382921615508697, 0.051884993542957926,
        -0.02586232659475577, -0.030711580879474214, 0.05088030884812742,
        -0.0097498319083193, -0.043801517519361455, 0.04396359673062221,
        0.009002375524304093, -0.050420526118470886, 0.03157685365039606,
        0.025140369548157515, -0.0522608882833738, 0.01589941400705925,
        0.03990240245841216, -0.04686830708734769, -0.002262469574029098,
        0.0483244662450859, -0.036854108384680714, -0.019395209870269402,
        0.052667573675240296, -0.02171294500769825, -0.03514523024331787,
        0.04916076769031284, -0.004619860924799851, -0.04569322946591792,
        0.0414408910573914, 0.013470876109425581, -0.05201427433288868,
        0.02726932376507402, 0.029685803028427337, -0.050899894439273854,
        0.01136593234406291, 0.042504131901585085, -0.04515511828699649,
        -0.0072939086423883135, 0.05035854401641437, -0.03260350884528295,
        -0.023772865670898723, 0.052028545101800175, -0.017734487243558316,
        -0.03865160213459944, 0.04794900655181333, 0.0008176460075418346,
        -0.04757029398420021, 0.03525478864316479, 0.022701155112335756,
        -0.0561183476688365, 0.024294854816936193, -0.23430381138579526,
        -0.1354829184372583, 0.28721716563088906, -0.4492385160347861,
        0.6538480922733864, -0.23260161682430255, 0.13362557912985945,
        0.008039979551098659,
      ],
      [
        -0.000608647044278474, 0.007218731090218039, -0.03279633185274442,
        0.07979740596308074, -0.04854750034937644, 0.00863735395297027,
        -0.020709568097208263, 0.009084630739805609, -0.0023244419492826477,
        0.00024800828425221386, 3.762339266171654e-5, 5.9665749854283056e-5,
        2.7770996479333686e-5, -2.925322952262893e-5, -5.991015522438929e-5,
        -3.648029947991147e-5, 1.9957002584813174e-5, 5.852117286457014e-5,
        4.441621613748526e-5, -9.680841995842016e-6, -5.504132132396107e-5,
        -5.081802793082645e-5, -8.691467935262019e-7, 4.973570115554188e-5,
        5.5371812435837974e-5, 1.1005966455723387e-5, -4.327816320296036e-5,
        -5.845341848083283e-5, -2.078860047388804e-5, 3.575395163130373e-5,
        6.014844429890865e-5, 3.0336807727436764e-5, -2.685988350862174e-5,
        -5.991373226210226e-5, -3.904895186684294e-5, 1.691208118528014e-5,
        5.752688813808753e-5, 4.6221126533964774e-5, -6.739326329800141e-6,
        -5.3527439120114244e-5, -5.19102172382732e-5, -3.350590482891722e-6,
        4.831331831774049e-5, 5.641993745136655e-5, 1.3589366752313106e-5,
        -4.1600748046676395e-5, -5.939557539041405e-5, -2.373329987923181e-5,
        3.326434544997345e-5, 6.025216725870312e-5, 3.2954745532499854e-5,
        -2.3956964242168145e-5, -5.9132231965929825e-5, -4.086251797721788e-5,
        1.4323674238685531e-5, 5.6583231641325475e-5, 4.77345054523382e-5,
        -4.285481044434474e-6, -5.2567334997958627e-5, -5.353697598071252e-5,
        -6.265363329787448e-6, 4.667797299877491e-5, 5.760190571044495e-5,
        1.6691887211496415e-5, -3.914863441106345e-5, -5.958510172625941e-5,
        -2.6242966715201105e-5, 3.073575531907119e-5, 5.989922135600997e-5,
        3.491055107573369e-5, -2.1687872337404566e-5, -5.880790524086558e-5,
        -4.2906476811868985e-5, 1.1741883035762683e-5, 5.5900776407179925e-5,
        4.976601402301534e-5, -1.1395917381819227e-6, -5.094461776998662e-5,
        -5.479111075887597e-5, -9.27660934446563e-6, 4.449607815654622e-5,
        5.800667634557949e-5, 1.9086666389217e-5, -3.7110120353911626e-5,
        -5.982923878004408e-5, -2.851364227397135e-5, 2.8635883051560706e-5,
        6.008412494480399e-5, 3.744122668149043e-5, -1.89235257815517e-5,
        -5.823876656050712e-5, -4.510585753183609e-5, 8.590488076264684e-6,
        5.441306715454531e-5, 5.1062418808226455e-5, 1.6187854710807256e-6,
        -4.9252766864580784e-5, -5.560842971607689e-5, -1.1682491140073707e-5,
        4.2902707829630483e-5, 5.887562496234748e-5, 2.1767621183102308e-5,
        -3.501917457291916e-5, -6.032008407590188e-5, -3.134105667705739e-5,
        2.578939548223582e-5, 5.958454884959848e-5, 3.9626572570259234e-5,
        -1.6015914716641517e-5, -5.710437563418336e-5, -4.655847528133055e-5,
        6.0929305736855685e-6, 5.331132731979218e-5, 5.2440707663102284e-5,
        4.200982003246916e-6, -4.794267646644544e-5, -5.697106037670051e-5,
        -1.4717163918898788e-5, 4.076065918405823e-5, 5.94909133271486e-5,
        2.4642342466027324e-5, -3.231275862876117e-5, -5.999701110827831e-5,
        -3.347038377565366e-5, 2.3283326700461877e-5, 5.9005608264954e-5,
        4.141639570033701e-5, -1.3653244686791309e-5, 0.0005201960994414995,
        -0.006399561712520265, 0.029043529165501184, -0.07043671374309045,
        0.042673956865941214, -0.007362520480677927, 0.01811826287019142,
        -0.008016343196843492, 0.002064588991875029, -0.00019293045640051795,
      ],
    ];
    const result = wavedec(data, "sym11");

    const reconstruction = waverec(result, "sym11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym11_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49747291930600246, 0.914591363768212, 1.1888006316180149,
      1.2887059596584898, 1.219698113770242, 1.0205411109618499,
      0.7519398128305619, 0.48015264521351286, 0.2599576500893877,
      0.12139752556691402, 0.06369390200627517, 0.057805986443426736,
      0.05681611975237427, 0.01125492607990669, -0.11482689340985475,
      -0.33143292673309926, -0.6172760292930126, -0.9230821571625424,
      -1.182825071113502, -1.3300657370373576, -1.3151923186151635,
      -1.1190712403158234, -0.7595045372194611, -0.2887161900446431,
      0.21761301808427297, 0.6770725300291351, 1.0188416974604624,
      1.199027992370104, 1.2092243719126101, 1.0762389911556003,
      0.8532249021150116, 0.6046424393847524, 0.38905014642427427,
      0.24423666069340527, 0.17854443817725207, 0.17057230088327124,
      0.17721450416210158, 0.14778341392197925, 0.0403496681432331,
      -0.16415980531223578, -0.45398361522664993, -0.7869394708040754,
      -1.099291002401617, -1.3208921365932007, -1.3927546579482715,
      -1.2825048182230934, -0.9936942671185998, -0.5664822244726274,
      -0.06940838515445462, 0.4157416946040146, 0.8122074705182585,
      1.0650918568773275, 1.152579825108262, 1.0888097899442686,
      0.9178289353231259, 0.7003589807535713, 0.49693450061814176,
      0.3518756888662439, 0.2822897563444888, 0.274932954038582,
      0.291666943376795, 0.28195905754144795, 0.1990042129934257,
      0.015077097303116072, -0.2680889635741601, -0.6168035010739509,
      -0.9716405014392164, -1.2609215837563035, -1.4180737973656792,
      -1.398421480351935, -1.19107032818759, -0.8227702166424262,
      -0.35268440853690736, 0.1406823901304193, 0.5771392568617193,
      0.8926240819236063, 1.0527311192469022, 1.0586268539451762,
      0.9440067944749345, 0.7640614510731387, 0.5794718131494776,
      0.43971008147896185, 0.37005551429628336, 0.3657160489169131,
      0.39454281375724315, 0.40753628721722984, 0.3542693686214137,
      0.1990372807186393, -0.06666791156909851, -0.41881255337420387,
      -0.8041994690259198, -1.1518724800127467, -1.3897313759545409,
      -1.4621458456681726, -1.3440517020890392, -1.0478803040217217,
      -0.6214893636257386, -0.1375598052536991, 0.32289655248098453,
      0.6887755101633862, 0.9142941355142542, 0.9877604065755887,
      0.9316146112037912, 0.7939236542473085, 0.633715332298739,
      0.5041123807850548, 0.43775776396554755, 0.43837733052495453,
      0.4806749113490528, 0.5185318971352127, 0.49927111561812376,
      0.3801231986652049, 0.14242796255197704, -0.20032646554450367,
      -0.6029253217010091, -0.9973973051913794, -1.3083743510053778,
      -1.470987280910803, -1.446743620551605, -1.233314028923144,
      -0.8656917692001149, -0.40838768055253266, 0.059388606603627214,
      0.4618254041785025, 0.7433286091126035, 0.8798671450672374,
      0.8820872720418799, 0.7895849562432479, 0.6580180232288391,
      0.5425818673136548, 0.48228538671894494, 0.48921179626802824,
      0.5456005121334692, 0.609496086785308, 0.6274264137347296,
      0.5506937368756158, 0.35088113011845506, 0.030352274255936174,
      -0.3751902423598934, -0.80295773574697, -1.1767041863597951,
      -1.4243527014421389, -1.4951679441313321, -1.3721007647688839,
      -1.0761429523671544, -0.6615625137229522, -0.20321651210888061,
      0.2208440774698263, 0.547077719128788, 0.7400172227737322,
      0.7983512139375945, 0.7521386938302769, 0.652082530934844,
      0.553842914769721, 0.5016380149961335, 0.5155279234964671,
      0.585772971935902, 0.6757635812265317, 0.7327328532971071,
      0.7033844109508836, 0.5502416469938076, 0.2642992219431367,
      -0.1295055273957877, -0.5756271440874117, -0.9993853658011934,
      -1.323777956175076, -1.487419323230021, -1.4590644643794282,
      -1.245026107964964, -0.8875978163160704, -0.45488977203478564,
      -0.024672168037161657, 0.3336637018618751, 0.5744664227742984,
      0.6846769557268819, 0.6840593337986792, 0.6169520233776828,
      0.5378881236378391, 0.49501346347279224, 0.5157766820928823,
      0.5987343075051658, 0.7136736788981626, 0.8100378417573334,
      0.8314209325733044, 0.7322709738365639, 0.49231792553703374,
      0.12480247022924804, -0.32382777655755013, -0.7828763970558171,
      -1.172876292608252, -1.4237409448937541, -1.4910203653375294,
      -1.3661522869285854, -1.0781213380133206, -0.6861302119052965,
      -0.26517902475574695, 0.11175220578998818, 0.3903834820087053,
      0.5464782572465572, 0.5890722279109386, 0.554942942893871,
      0.49596474345440755, 0.46284091621344076, 0.4896294674503267,
      0.583240846147927, 0.720749317421673, 0.8552755729170954,
      0.9289129206554997, 0.8892820520704848, 0.7053052529686772,
      0.3779522641931823, -0.057012565214479505, -0.535189561955764,
      -0.9772056674910506, -1.3065168293505225, -1.4668940539269377,
      -1.4351919153269337, -1.2261912981415997, -0.8883298626290282,
      -0.4914599179062009, -0.10980075699335579, 0.1955442508036711,
      0.39006693508571044, 0.47197218839272037, 0.46952317361744916,
      0.4305053650996442, 0.4067584987713706, 0.4380013148974848,
      0.5393360274641128, 0.6958269233993641, 0.8656612682952382,
      0.991115216135921, 1.0144616092067584, 0.8946174654760203,
      0.6200889397845106, 0.21469619741803983, -0.2655885221536746,
      -0.7440598762930202, -1.1401809231502096, -1.38775835317308,
      -1.4498330220578963, -1.3265546924352651, -1.0541003339839805,
      -0.6949845559427527, -0.3223048428280748, -0.0019943966875973773,
      0.2223741064656048, 0.3383992058348571, 0.36514144540832777,
      0.3450062825984116, 0.3295363032665661, 0.3630181452268166,
      0.46836670306266087, 0.6391308529513907,
    ]);
    const expected = [
      [
        2.5205138853874614, 2.2654590071229226, 1.8859699294245216,
        1.9853240089691084, 2.32289853729846, 1.500567169907376,
        2.2799677880812803, 2.1026788076265044, 1.8636450474348953,
        2.1501793125859683, 1.4487263843000049, -1.3226677208624682,
        -1.377343288966916, 2.8956358638648876, -1.2426616268990698,
        -1.807964003824259, 2.8638977590309818, -0.7322650887619223,
        -2.2286871018139807, 2.7237118059523393, -0.19197269253044544,
        -2.559099777383698, 2.472548548634954, 0.3564354892217855,
        -2.7855456933357914, 2.1208965823794994, 0.8901355751487453,
        -2.8985782135250386, 1.683342135876499, 1.3869101595809825,
        -2.8933807567348144, 1.1779645325362287, 1.8260703406331775,
        -2.769969887265174, 0.625591551196126, 2.189274689890699,
        -2.5328425428874755, 0.04740513220832663, 2.4736114040562103,
        -2.257210361396116, -0.46434583876934216, 2.0880825900777493,
        -0.16417119985684248, 0.8787839748333734, 1.257123172691498,
        0.618831620494088, 1.2171103273198243, -0.08968051103069097,
        1.1655778256433862, 0.26533976686692595,
      ],
      [
        1.429346746402319, -1.0313071124273494, -0.8759080674829461,
        1.3935354986666417, -0.13105322243565137, -1.2222662611194333,
        0.7456284179177143, 1.1676020874401232, -1.233458514798425,
        -1.0912816898578837, 0.27299622254692646, 0.8504794654615822,
        -1.3389348800931073, 0.7043600486075968, 0.5147168081214774,
        -1.2498583532186933, 0.8813445086647733, 0.24293362907031493,
        -1.1372224040168049, 1.035438060939887, -0.037011644129349076,
        -0.9913462184875005, 1.1597796971316472, -0.315997179702911,
        -0.8169130975021741, 1.2504095189621898, -0.5851444996268351,
        -0.6193983545042855, 1.3043285267001181, -0.835883610749594,
        -0.4049064015098895, 1.3195995145059833, -1.060229382513841,
        -0.17998156199660392, 1.2954149557704226, -1.2509202556886099,
        0.04708040566441786, 1.2408906441981822, -1.4558655879963947,
        0.5140280765792065, 0.1038812514645659, -0.4863692231228074,
        0.08436096621764777, -0.2910645017942637, 0.15872587345925884,
        0.02681540765716828, 0.5864916964988399, -0.5062941244462749,
        0.09570338765267969, 1.0171914835158964,
      ],
      [
        0.455093996557575, -0.6611126033322802, 0.22651523073636184,
        -0.14159491384555334, 0.002313060743902152, 0.03985758375254756,
        -0.028256954499223812, 0.35591167930059336, -0.10512744689059339,
        -0.06247858628381405, 0.07921674069723614, -0.022861474462310315,
        -0.05154823487100476, 0.0689543512618472, -0.012934706123991195,
        -0.05636329989004874, 0.06635506022171664, -0.007020839765521617,
        -0.06004242238952723, 0.06404174828981168, -0.00035815805190406044,
        -0.06332643263016437, 0.060476965920815196, 0.005562572347211997,
        -0.06615235705653896, 0.05716943370433171, 0.012225848414549222,
        -0.06836170285602822, 0.05275962380603501, 0.017978746077102765,
        -0.07024802775063747, 0.04855484411614666, 0.0244354506309115,
        -0.07131628159341355, 0.0434376843999813, 0.029849830036572208,
        -0.07220428690228116, 0.038460578629398716, 0.03589883132423218,
        -0.07210066313986783, 0.0327945818861404, 0.04081447469222913,
        -0.0719611510784807, 0.027194344024529565, 0.046266986110948656,
        -0.07069137171702576, 0.021153920203967256, 0.050538831039640915,
        -0.06952564468632363, 0.015099570631060185, 0.05522434909296094,
        -0.06713165954282937, 0.008869638349032226, 0.058726715968671954,
        -0.0649716016616713, 0.002544938820957521, 0.06249839652924543,
        -0.061530175755806514, -0.003684746418756479, 0.06512863477754731,
        -0.058437430541088395, -0.01008686427781807, 0.06786793635028772,
        -0.054057630440495774, -0.01612748661663242, 0.06955485512689277,
        -0.049928914353097334, -0.025172521255441085, 0.08981581049882353,
        -0.1233070611077052, 0.22018400286174933, -0.3297468588345132,
        0.2754120879993398, -0.14560803090137214, -0.037974350397954076,
        0.18918366952599325, -0.15558978252925879, 0.08468326930261441,
        -0.020166528282973373,
      ],
      [
        -0.0005889494767602031, 0.00713894306070855, -0.03232924477625547,
        0.07886254215140176, -0.048266752145134574, 0.008920423992312694,
        -0.020632933540094933, 0.008971803013024122, -0.002319353068275371,
        0.0002508600804692749, 7.342875887852795e-5, 8.612620963089792e-5,
        1.4786772333394969e-5, -7.102782797223603e-5, -8.762917353794633e-5,
        -1.8796369833333128e-5, 6.84012139677006e-5, 8.898041539550615e-5,
        2.2887282937804296e-5, -6.545465904826534e-5, -8.994776236791023e-5,
        -2.6749474684481783e-5, 6.249271541602222e-5, 9.074988838918155e-5,
        3.0462275752783056e-5, -5.958994113824251e-5, -9.159246373755179e-5,
        -3.431203422191654e-5, 5.644594229863885e-5, 9.223231960891931e-5,
        3.817491026396737e-5, -5.3028876376466074e-5, -9.248556788179937e-5,
        -4.176193780317151e-5, 4.9655034057465166e-5, 9.26118386007501e-5,
        4.521137087969799e-5, -4.633722954611511e-5, -9.276714215246679e-5,
        -4.8783493125510116e-5, 4.277136980503979e-5, 9.267520072706972e-5,
        5.2299293781835754e-5, -3.8989402480007034e-5, -9.220796653609491e-5,
        -5.5502692328489566e-5, 3.530640828056745e-5, 9.16553343882638e-5,
        5.858510243843241e-5, -3.167299908349636e-5, -9.111723091843031e-5,
        -6.17699597227251e-5, 2.7793966774501745e-5, 9.029563753202618e-5,
        6.483037742297272e-5, -2.3763807097470924e-5, -8.91236190033214e-5,
        -6.755362883105226e-5, 1.9883499593615066e-5, 8.790941259740447e-5,
        7.017634331981146e-5, -1.6043561857904314e-5, -8.66927595899565e-5,
        -7.287584904543314e-5, 1.1969895495586748e-5, 8.516617782282708e-5,
        7.53866566673663e-5, -7.815734249365812e-6, -8.332661642141227e-5,
        -7.754808638931777e-5, 3.8556507693742164e-6, 8.148799224432341e-5,
        7.963218816514541e-5, 7.534612816537003e-8, -7.962825030354852e-5,
        -8.176283038981749e-5, -4.218884944073959e-6, 7.744312547390867e-5,
        8.364679331628675e-5, 8.36921767448598e-6, -7.499360800104085e-5,
        -8.518200620341593e-5, -1.2289394870506725e-5, 7.258641136040417e-5,
        8.666469804664271e-5, 1.6193044637179246e-5, -7.013862963865588e-5,
        -8.816013657468785e-5, -2.0279300028021565e-5, 6.736177606505791e-5,
        8.935939676425616e-5, 2.429828249900622e-5, -6.437841636797859e-5,
        -9.02231796210925e-5, -2.806033366829094e-5, 6.147548658303064e-5,
        9.105966920295847e-5, 3.181884566399555e-5, -5.851269141841036e-5,
        -9.187281591192463e-5, -3.572218012813376e-5, 5.522924638505923e-5,
        9.235067401876105e-5, 3.948652931910343e-5, -5.18043047195487e-5,
        -9.251830925982867e-5, -4.297724993991919e-5, 4.8493275926960654e-5,
        9.268315851618505e-5, 4.647699186270092e-5, -4.5104309111661174e-5,
        -9.278767513836323e-5, -5.007716203761281e-5, 4.141511632223503e-5,
        9.252971555544036e-5, 5.347162506246635e-5, -3.765413157470669e-5,
        -9.199766876330814e-5, -5.658621763072295e-5, 3.403479539237895e-5,
        9.148556716952728e-5, 5.9721142342823603e-5, -3.032166536407652e-5,
        -9.087673229469476e-5, -6.290701771296975e-5, 2.634016853549629e-5,
        8.989125656494343e-5, 0.0001640245938511526, -0.0010035186292986688,
        0.005076310264885795, -0.018468655978607286, 0.05042001696643916,
        -0.04594456491879232, 0.013341541805834214, -0.003940361856946344,
        0.0002533967337575252, 0.00018436438975143605, -0.00012098840991192096,
      ],
    ];
    const result = wavedec(data, "sym11");

    const reconstruction = waverec(result, "sym11", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym12", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4876677838589588, 0.9015482437920775, 1.1829916872507948,
      1.3001168299699524, 1.2532701778614375, 1.0731298126151985,
      0.8120288392918926, 0.5306860713875514, 0.28360669865364685,
      0.10669472136565122, 0.01003673781272102, -0.02248231659376193,
      -0.026767993749792135, -0.04702629688306642, -0.12216385346872172,
      -0.2735664471672897, -0.49740304881780567, -0.7634847241301608,
      -1.0210863334414433, -1.2104100275825715, -1.2769560969877458,
      -1.1853152679366727, -0.9289926962615676, -0.5337970877845997,
      -0.05385658227093043, 0.4389132598498199, 0.8694921234138654,
      1.1751920892659213, 1.3182695579233354, 1.292808732714052,
      1.124346050247272, 0.8624409607317252, 0.5680773284369591,
      0.29899524029153346, 0.09651203758223875, -0.02301498458250445,
      -0.07010187774775811, -0.07709155804329643, -0.08753187105201937,
      -0.14273594182099947, -0.2689739787476674, -0.46858652627614206,
      -0.7173384655778307, -0.9687881026618489, -1.1647040892273668,
      -1.2490506902320186, -1.182149601380342, -0.9515389088661741,
      -0.5768109977359754, -0.10713867765644253, 0.38805250816047276,
      0.8331615307848985, 1.1619898129444381, 1.3312059156940381,
      1.3285863313287125, 1.174171613684621, 0.9141707019506071,
      0.6091734225179031, 0.31957383491285624, 0.09174123368752152,
      -0.051750295770519095, -0.11555110338346303, -0.12791909348054703,
      -0.13109302334188935, -0.16817144862805916, -0.2698689496489762,
      -0.4445457036679338, -0.6740935600425284, -0.9168103815457903,
      -1.1166593923009147, -1.2167160156576862, -1.1735417118937397,
      -0.9689540798804399, -0.6162535404119004, -0.15927810710467216,
      0.3356276412020529, 0.7929405828871883, 1.1435175010341767,
      1.3387747921030264, 1.3602048836315663, 1.2220583140572516,
      0.9666531835250943, 0.6535302535747964, 0.34512723851745797,
      0.09244830347675864, -0.07583802505379617, -0.15831424078722806,
      -0.17867578046065818, -0.17721575701470177, -0.19817742053174897,
      -0.2762307440636338, -0.4255373202536049, -0.6342216216187682,
      -0.8657248863176927, -1.0668086212608396, -1.1803160907366492,
      -1.1595983616874728, -0.9810617339407088, -0.651707949654919,
      -0.2097192379707758, 0.28219793903090296, 0.7492561004523499,
      1.1199656436783958, 1.340883989170159, 1.3873119413330615,
      1.2674792254015959, 1.0193152354832793, 0.7006678951520167,
      0.37538556362971387, 0.09863907832661639, -0.09499804186476668,
      -0.1979050338712816, -0.22878757415408402, -0.2253779396996595,
      -0.23241070527403784, -0.28797870050953567, -0.4117628356653341,
      -0.5981572037667591, -0.816093510703239, -1.0157042666230371,
      -1.1402595475201176, -1.140484878591514, -0.9877436597121112,
      -0.6828012425105794, -0.25792508483068055, 0.22833370848499868,
      0.7025729214994046, 1.0915804868607029, 1.3375012344706168,
      1.409604567827125, 1.3099344703169582, 1.0715816907111035,
      0.7500758639757197, 0.410027242641232, 0.11025916313452394,
      -0.10900433163993029, -0.2338720623111995, -0.27768750756159977,
      -0.2750350364502912, -0.27048171954544353, -0.3049729975196822,
      -0.40336621789483196, -0.5662930279175317, -0.7684621563268231,
      -0.9639125585966626, -1.0969951458323646, -1.116423340724658,
      -0.9889412078157704, -0.7092083145465191, -0.3033832055481021,
      0.1746100212461219, 0.6533887974424254, 1.0586613286501318,
      1.3286545355080448, 1.426832664451431, 1.348956708628482,
      1.122881700287326, 0.8012187250500052, 0.44868255860215484,
      0.1271945335455419, -0.1176874774995208, -0.26580369818621696,
      -0.3248219168586862, -0.32562608878214855, -0.31195872664708146,
      -0.3270161889091665, -0.4004323625401111, -0.5389756713943241,
      -0.7233547387025148, -0.9120072498571787, -1.0510068458610404,
      -1.087690138045161, -0.9846559347650077, -0.7306555094648712,
      -0.34561132785600757, 0.12160039958412192, 0.6022289278085846,
      1.02155723293372, 1.3144318722133461, 1.4388017165864815,
      1.3841162687909927, 1.1726550014048787, 0.8535419707232641,
      0.4909377046928257, 0.1492727879092684, -0.12093652048387249,
      -0.29333262569848323, -0.3696565206708309, -0.37657987404118726,
      -0.3563725769974308, -0.35385537176242543, -0.40298616066797244,
      -0.5165017619969301, -0.6812674346328556, -0.8605633157227247,
      -1.0028084942471411, -1.0546129375567208, -0.9749495858401506,
      -0.7469236238134301, -0.38416264467244193, 0.06987051911363332,
      0.5496401935757295, 0.9806631967198056, 1.2949802309455087,
      1.4453749294412084, 1.4150258656908932, 1.2203580690564042,
      0.9064781091727052, 0.536339327802895, 0.17626504022017314,
      -0.11870017792101423, -0.3161398743445731, -0.4116822865293534,
      -0.4273211774728916, -0.4032218594331174, -0.38518496333609403,
      -0.4109922255270311, -0.4991147210324876, -0.6426632341791662,
      -0.8101506409058417, -0.9529381820213412, -1.0175670854918817,
      -0.9599434170898702, -0.7578503138039538, -0.41863072000824153,
      0.01997199770725505, 0.4961851524472667, 0.9364158130950979,
      1.2705039906011684, 1.4464747300741971, 1.4413448530445319,
      1.265470083938802, 0.9594528954552316, 0.5843995063291899,
      0.20788843325695266, -0.11098740654792366, -0.3339583212550793,
      -0.450421020093861, -0.4772771081247491, -0.451978406742315,
      -0.4206500563870683, -0.42435528111203435, -0.4870020905543285,
      -0.6079668570226829, -0.7613277621602084, -0.9019523363367274,
      -0.9769714859769263, -0.9398168639036546, -0.7633318778106264,
      -0.44865395159959226, -0.027563661237092973, 0.44243586199649176,
      0.8892884774563689, 1.241262678553423, 1.4420836191583182,
    ]);
    const expected = [
      [
        2.3721220532699383, 2.1860979369769664, 1.8041246230027113,
        1.8888964544312603, 2.3791263560846776, 1.5212956159882574,
        2.0731282504049635, 2.287832434485246, 1.535466126159666,
        2.2765170878920795, 2.0809365137902187, 0.4207620248429195,
        -2.7166967503038193, 1.9448901218063948, 0.9936025444485368,
        -2.699195536908288, 1.2429877021739928, 1.6295140055046045,
        -2.5530502017088352, 0.4537025324987122, 2.2084222096771042,
        -2.2985423898981234, -0.3392542158639307, 2.667532804407899,
        -1.9503947071137446, -1.0616618692594602, 2.944604612603064,
        -1.5107173725894294, -1.6610848709276396, 2.993368486464933,
        -0.9759804826216285, -2.1124989561999974, 2.796587126055182,
        -0.34835262260118083, -2.415263837705747, 2.372143227597208,
        0.3531444510943398, -2.582691335153064, 1.767719949246136,
        1.0892576758317507, -2.6167676458026374, 0.9580165940163946,
        1.2513812785099105, -3.3405965803192736, 2.8585909528849216,
        -1.0937946907834981, -2.8538713210575213, 1.9691775159651903,
        0.05415245718377705, -2.7096152596050382, 3.1255014599276034,
        -1.9078537861679097,
      ],
      [
        0.6417411017283458, 1.6298999423755864, -1.262458494585528,
        -0.5442449330456027, 1.5783379220774945, -0.7289051271797713,
        -0.9626801691030379, 1.4443372640714274, 0.0448240038446877,
        -1.684476651998097, -0.0007357142278924911, 1.258296655315664,
        -1.252922520345976, 0.349376053761825, 0.8594734121744829,
        -1.5051033088620405, 1.0853586307752585, 0.1254728741890107,
        -1.2517265298665075, 1.4747357618390442, -0.6529942754957664,
        -0.5925984899088427, 1.3742229815399563, -1.1909318476517234,
        0.23648551392367234, 0.8119478008959666, -1.289056247972601,
        0.942201617076597, -0.022416806787494917, -0.9045926608460138,
        1.2773168651277178, -0.8440608863464538, -0.1668947723955583,
        1.1278545188293387, -1.372971256433047, 0.6678206655317366,
        0.5529658337806925, -1.4311427666874872, 1.301807981434083,
        -0.22499588438857848, -1.0043688499863381, 1.4467825531076635,
        -0.4719722221672531, -1.1609092739709193, 0.605332619403502,
        0.7430566219920859, -1.5689838307771111, 1.0111543420826872,
        0.5266927599370838, -0.2989020528930835, -0.5625020347707498,
        1.2013795539473002,
      ],
      [
        -0.16848648581613407, 0.4729139928996476, -0.5875996607264243,
        0.19095634679928042, -0.0854638418639381, 0.039446872771732366,
        -0.1353374872240666, 0.3805136025089402, -0.14832998326924055,
        0.06774913432087713, -0.09411993763695937, 0.02023201796127153,
        0.03702016334178531, -0.03443913100762252, -0.012684607252950703,
        0.04522650747509783, -0.024307806735144398, -0.025101179440555316,
        0.04495825839223022, -0.011938182289842189, -0.035329975393114575,
        0.04088536001920868, 0.0018673330118074713, -0.04224129334971211,
        0.03289873395052764, 0.01513954396251546, -0.04550739795463842,
        0.022124399399891633, 0.027410278506125565, -0.044455160275143436,
        0.009210405970255945, 0.03684493456674699, -0.03963356405364615,
        -0.0044372354021722255, 0.043302612448274415, -0.030955521468954268,
        -0.017737028720559208, 0.04551585855597733, -0.019787377312287698,
        -0.029428336169430382, 0.04393141625028114, -0.006504067387638368,
        -0.03842275356117054, 0.03809377290522189, 0.0070205081354415165,
        -0.044032435259383086, 0.029071115515620742, 0.020269434346984506,
        -0.04553667149859632, 0.017203389777824783, 0.031323101048482495,
        -0.043100100692785956, 0.003963347978872097, 0.03991376123504801,
        -0.036560732374488855, -0.009774273159987744, 0.04453961918277893,
        -0.026966564018257276, -0.02253332975105998, 0.04549298400112483,
        -0.01465836064898654, -0.03330817435488902, 0.04200504389002867,
        -0.001332978479490784, -0.041070642421836244, 0.03503522929748798,
        0.012440231862842412, -0.04511078515712868, 0.025039772109275753,
        0.022467666220469775, -0.03803421391298095, -0.0061235553268814925,
        0.055603155483391745, -0.08476297831559187, 0.1377683077317509,
        -0.09988400419017626, -0.02330303943089354, 0.05574972878665372,
        -0.011349672251481618, -0.034597490336397564, 0.03748540177050977,
      ],
      [
        0.0002096373449664343, -0.002722862499084774, 0.014188252166043823,
        -0.04648683794734009, 0.11163398453129904, -0.0921671016738381,
        0.02868537243558112, -0.019381645628334967, 0.007559458152626087,
        -0.0016806176761129039, 0.00013094334693265427, -1.3390562970947267e-5,
        1.5604147746208234e-5, 3.0328777414102818e-5, 1.7315306947713333e-5,
        -1.1542814072703317e-5, -2.9862993407170407e-5, -2.089300932924831e-5,
        7.172871134250811e-6, 2.8683716376595126e-5, 2.3980719050777956e-5,
        -2.6319905462921075e-6, -2.682339944682491e-5, -2.647982919721244e-5,
        -1.9210951123596495e-6, 2.4393289269802998e-5, 2.8398918721718786e-5,
        6.428490018051174e-6, -2.143416588960396e-5, -2.9714665498021376e-5,
        -1.08377432403787e-5, 1.7946024996261416e-5, 3.0329317383334743e-5,
        1.4996961517672736e-5, -1.4030946037868784e-5, -3.0217242804533327e-5,
        -1.876836376770338e-5, 9.842119734397071e-6, 2.9450339759057203e-5,
        2.212357925992264e-5, -5.443647848153292e-6, -2.804893613604423e-5,
        -2.5022543354186404e-5, 8.750128467020509e-7, 2.597512876294611e-5,
        2.733761612036283e-5, 3.721423893951096e-6, -2.3281894269625795e-5,
        -2.8987928783261826e-5, -8.185797822031053e-6, 2.009935926286063e-5,
        3.0001406710535136e-5, 1.2462389463182465e-5, -1.6485177851511664e-5,
        -3.037508436850487e-5, -1.6503838300041584e-5, 1.2454276325614228e-5,
        3.0032550208955267e-5, 2.0166458741486444e-5, -8.121259577189888e-6,
        -2.8970116541727564e-5, -2.3323912804081826e-5, 3.6487242708524426e-6,
        2.728128111642144e-5, 2.596189129747867e-5, 8.929780227871374e-7,
        -2.500709001623326e-5, -2.805643082910474e-5, -5.4610053801210185e-6,
        2.212946135611432e-5, 2.94980568683775e-5, 9.912832090722912e-6,
        -1.871983572526423e-5, -3.0225927886406195e-5, -1.4092006856157555e-5,
        1.4924573314113517e-5, 3.0288987128194458e-5, 1.7949447317714798e-5,
        -1.081503064910705e-5, -2.9705642791702638e-5, -2.1447159286194376e-5,
        6.417439380411923e-6, 2.8421164068642845e-5, 2.445365982104206e-5,
        -1.8549319922171113e-6, -2.6453461204590874e-5, -2.68576763670088e-5,
        -2.704768149982146e-6, 2.3916607292082635e-5, 2.8662127786372403e-5,
        7.189521860557401e-6, -2.0870688387614193e-5, -2.9861791929012212e-5,
        -1.1557672200772304e-5, 1.7315150034473614e-5, 3.03674139010855e-5,
        1.5671053818720022e-5, -1.3337037915897768e-5, -3.013960004888769e-5,
        -1.9381030206847894e-5, 9.095587027723408e-6, 2.9249065636760367e-5,
        2.2649333315196833e-5, -4.6720752557733185e-6, -2.7735664507306065e-5,
        -2.5451194296570732e-5, 9.992174359257184e-8, 2.5565735002104552e-5,
        2.7670787077425544e-5, 4.493575799225519e-6, -2.2777502706819845e-5,
        -2.9214874428058026e-5, -8.940074864427028e-6, 1.9503691432582392e-5,
        3.0106020576222054e-5, 1.317019756208118e-5, -1.5820905575645526e-5,
        -3.0359555635134567e-5, -1.714795972437093e-5, 1.174305676095941e-5,
        2.9907608621881507e-5, 2.0743882217466697e-5, -7.3692629138354e-6,
        -2.8732723646857574e-5, -2.382120830462974e-5, 2.8677096642103564e-6,
        2.6927191814964135e-5, 2.6356194925098567e-5, -9.810160571775266e-6,
        9.257056747769837e-5, -0.0005847630209054422, 0.0016885733703943047,
        -0.003944571373741908, 0.0030981261085026137, -0.0007466580058050526,
        0.0006181135927302668, -0.000311067880861259, 4.9444232708101456e-5,
        -3.434896004775442e-7,
      ],
    ];
    const result = wavedec(data, "sym12");

    const reconstruction = waverec(result, "sym12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym12_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4949671243176354, 0.9122271060413809, 1.1906649866827903,
      1.2983521475726743, 1.2381424565206736, 1.0450150302936356,
      0.7759599448447969, 0.49504560308289836, 0.25747652182135017,
      0.09665532971265473, 0.017454175644410264, -0.0027138954431920465,
      -0.005442666866693202, -0.03781278754125178, -0.13741534713490222,
      -0.31990286984602195, -0.5724044139527865, -0.8546385618646704,
      -1.1075807213399393, -1.2675912231183104, -1.282483720611646,
      -1.1254731030334382, -0.8034283139151126, -0.3572484271526196,
      0.14586905532402328, 0.626480952114391, 1.0099085765878482,
      1.2421029852765668, 1.3005485517738011, 1.1976261011957945,
      0.9757352960225129, 0.6955218094637489, 0.42025328018959807,
      0.2003126196762009, 0.06169736371235285, 0.0013528479458769782,
      -0.009603658946071052, -0.015740725120790278, -0.0629991901828762,
      -0.18402178632788313, -0.3870313068596389, -0.6512535960860717,
      -0.9302032103024841, -1.16212767768751, -1.2850542066138155,
      -1.2526713864460204, -1.047017184638837, -0.6847026377901332,
      -0.21498958907842952, 0.28993813364493864, 0.7502260288575893,
      1.0954600960029774, 1.2795101814345966, 1.2895434640515542,
      1.147099931609964, 0.9010975459383018, 0.6146351047671054,
      0.3489824713903889, 0.14880916615809808, 0.032339314277558595,
      -0.011171397645237446, -0.01613306483890821, -0.029000176024975177,
      -0.09345745055935162, -0.23635550695711927, -0.4581462184758025,
      -0.7304143944793555, -1.0012812836119538, -1.2074284574202179,
      -1.2897726839475236, -1.2088505861127874, -0.9559950157177994,
      -0.55740054482039, -0.06992968707972719, 0.4304362536771589,
      0.8647639701478278, 1.1680613834856581, 1.3028237623539842,
      1.2659939073548037, 1.087739134943907, 0.8224826924899522,
      0.5345432340078681, 0.2820514325499491, 0.10319822409099022,
      0.00823036175264713, -0.020889422208209024, -0.0232165825316734,
      -0.04596420309838967, -0.12949110357058413, -0.29413158571588927,
      -0.5323872243334925, -0.8086262959892635, -1.0665081763809574,
      -1.2423577368610448, -1.2811646193216737, -1.1511691012775933,
      -0.8533035589188673, -0.423011830326567, 0.07614571770766448,
      0.5656498961122665, 0.9688042453489122, 1.2270955569340458,
      1.3121923658488974, 1.2307280214232734, 1.0208123084437246,
      0.7412700604112737, 0.4563997699214821, 0.2201290306584267,
      0.06354588704026265, -0.011116791877264443, -0.028641821206468528,
      -0.03175283155131578, -0.06727896895621671, -0.1712520171610174,
      -0.3569005889296491, -0.608762880215463, -0.8845699427383155,
      -1.1245537482769934, -1.265915644332587, -1.2588388553451204,
      -1.079988285871245, -0.7400265857592732, -0.2831423640292874,
      0.2214333027561463, 0.6939504210698566, 1.0612238375385488,
      1.2721565055892465, 1.3079696750572436, 1.1847267809144624,
      0.9476560954974798, 0.6588114052757168, 0.38124835268682655,
      0.16372541269784124, 0.02975578084196273, -0.0263108588615579,
      -0.035316553817741125, -0.04260104161682404, -0.0934753421445711,
      -0.21873246242065109, -0.4240533901748429, -0.6861673416754885,
      -0.9568916420171066, -1.1741485796927313, -1.2772490962667191,
      -1.22260598634106, -0.9958804662901292, -0.6174189042046455,
      -0.13948870328448684, 0.3641410411037057, 0.813819937407067,
      1.1410838558953036, 1.303052468809806, 1.290704407017267,
      1.1291031755992162, 0.8696489582815343, 0.5764059242665105,
      0.31000514833137416, 0.1131861222164181, 0.0015759999049901885,
      -0.0380643697436257, -0.041825596858544686, -0.056558344547377126,
      -0.12495304756961062, -0.2717605720637641, -0.49482946199980105,
      -0.7633996800223717, -1.0242290022044642, -1.2141095056665787,
      -1.2756707092466115, -1.1724856830770538, -0.8996225349498855,
      -0.4868874595197095, 0.006188966514904991, 0.5025170618816422,
      0.923875154096455, 1.2076428075909935, 1.3198057764951183,
      1.2611269082986674, 1.065079268123025, 0.7881845989482559,
      0.4952767380931543, 0.2434441930257492, 0.06868975460289067,
      -0.021390686280386484, -0.04717392176005955, -0.04908111326960041,
      -0.07433837508719027, -0.16196758132069777, -0.32999930306943137,
      -0.5683285010500346, -0.8391854873769742, -1.085237199632213,
      -1.2433639260261968, -1.2606749062460765, -1.1087103050756006,
      -0.7921858343641321, -0.34996964422974586, 0.15209507216844062,
      0.6348777874730791, 1.0228887823756423, 1.2603662998910548,
      1.3226487794774298, 1.220132634596055, 0.9939615835560032,
      0.7046455454753544, 0.41654929172475613, 0.18218589015512926,
      0.030249171189492496, -0.03967358609339683, -0.054498690500116055,
      -0.05797163468679184, -0.0965516316569, -0.20462017561995782,
      -0.3929489492259065, -0.6435251787337495, -0.9122003603871025,
      -1.1386153663440164, -1.260972410882125, -1.231950887526445,
      -1.031724706877093, -0.6747224995708127, -0.20830920638897177,
      0.2964275586724665, 0.7596348341108796, 1.1098081040739336,
      1.298933011095353, 1.3120160703167234, 1.1687628494303275,
      0.9171153147904272, 0.620377412402433, 0.3412320816916721,
      0.12668886340766605, -0.002283778793392588, -0.05391808830376277,
      -0.06093765815175881, -0.06933875724456401, -0.12368801298406523,
      -0.25285103881840454, -0.4599531782397597, -0.7192867463381883,
      -0.981094812987352, -1.1831325836461126, -1.2661491511872531,
      -1.1893921953570648, -0.9421822167997049, -0.5485484942808025,
      -0.06363019132145585, 0.4374069333113293, 0.8753201862626698,
      1.1837703755242148, 1.3232368398633674, 1.2885331649675882,
      1.1081829287350515, 0.8359378482242679,
    ]);
    const expected = [
      [
        2.3715669743772, 2.1844365698468056, 1.74806862531766,
        1.8398339282320413, 2.3947052694428144, 1.444769315282941,
        2.0422360498683823, 2.2952764360511977, 1.4506616688699787,
        2.2740645411879434, 2.058891082509319, 0.3761145603753597,
        -2.701825349706151, 2.1057175650857487, 0.7723338671617715,
        -2.7550763583172118, 1.681718982189476, 1.221879468995509,
        -2.7296909965219376, 1.194111135585031, 1.648408048536731,
        -2.6274111570411476, 0.6647718534147413, 2.0370485965414606,
        -2.455234820179282, 0.11605549987094702, 2.3724810212722907,
        -2.2205623565708446, -0.42929819537802216, 2.63956213665964,
        -1.9307376366632485, -0.9496002980684745, 2.8244152136940865,
        -1.5928261005053836, -1.4254950752904443, 2.9156001410339476,
        -1.2134602166949018, -1.8437072966458254, 2.920182804616924,
        -0.8455633871914514, -2.1203831612858037, 3.2227833837738515,
        1.5662968210516408, -2.501742686017674, 3.691357875237597,
        1.0136621031922475, -2.0725989320230225, 3.9049029372079413,
        0.43422712866359653, -1.8716347895479246, 4.138640703954538,
        -0.08676232462133594,
      ],
      [
        0.6382838894189252, 1.642788410818682, -1.2447057439938851,
        -0.5313331091352025, 1.5572908650670219, -0.7242117201433309,
        -0.9436244793529942, 1.4227013492906215, 0.020279654617445797,
        -1.6584417439217154, -0.08508202479758442, 1.2959097736551997,
        -1.0420007893723602, -0.07974687848207744, 1.1895445259965838,
        -1.3701018770479825, 0.42923334436781885, 0.8985431235335833,
        -1.520917101918752, 0.8964123934565277, 0.48361273109054437,
        -1.4798736712141192, 1.2573542308151842, 0.0034490407743366473,
        -1.2539723986856977, 1.462152061355488, -0.47467483184681963,
        -0.8746228285945441, 1.4814733864581395, -0.883838057074554,
        -0.39337072173262266, 1.3105522349955327, -1.166546535465531,
        0.12504376743065976, 0.9698988352685832, -1.28253342508985,
        0.611724709753725, 0.4978645700612678, -1.1847587585026629,
        0.8921297310457607, 0.2515473566418213, -1.1504404218828619,
        -0.43103567201222626, 0.8690450848215806, -0.8451752213002154,
        -0.9477728355620268, 1.3668618418532017, 0.3890809897766252,
        -1.1712388624309493, 1.2708802014270109, 0.9247939782349267,
        -1.2012803134113386,
      ],
      [
        -0.17963944497474577, 0.4908785329056892, -0.608142367714742,
        0.2079719571751954, -0.10973106429014785, 0.0597358509602731,
        -0.14761753505260578, 0.39508361917733475, -0.15639580600651543,
        0.07515453516617168, -0.10455911881622619, 0.02744478052282959,
        0.03973561437530744, -0.0466806289157405, -0.002099639367097502,
        0.04894313694429878, -0.0413692178850319, -0.011862627572464965,
        0.05197193045552477, -0.034649588201093075, -0.021268571365210258,
        0.053574360262654046, -0.026355991676364317, -0.029868246194986427,
        0.053052332760321376, -0.017581911329286375, -0.03757928403586391,
        0.05101668885412933, -0.007792236470369871, -0.04385907973017447,
        0.0469999452834386, 0.001836287091367453, -0.04884684624696913,
        0.041613551475098466, 0.011829119501859792, -0.051954195631797324,
        0.03462924544002459, 0.02099678918697731, -0.05355966789058202,
        0.02662620163785016, 0.029872723983175052, -0.05306467257061088,
        0.0176035040573676, 0.037326338076887254, -0.05108633922424012,
        0.008065752579998286, 0.04391478394151911, -0.0470399059854382,
        -0.0017886640037090198, 0.048632245620610894, -0.04176038580347308,
        -0.011576876958947923, 0.052068616133387015, -0.03468788180805187,
        -0.020940743059034036, 0.053396875174354035, -0.026835430573220947,
        -0.029665456487346573, 0.053238069205325866, -0.01766669394564886,
        -0.03727845911345065, 0.05098144796414833, -0.00831678662203688,
        -0.04377244717579643, 0.04726485978190479, 0.0017362552852382073,
        -0.04849407385583289, 0.04064423005102401, 0.015892900034923003,
        -0.0627287206640616, 0.04797518134400826, -0.04269332287406355,
        0.19909470951809438, -0.01584209234195336, 0.03331134099755086,
        -0.09837500092039658, 0.15189779381525678, -0.38025163243290006,
        0.1769502423302435, -0.015339495487905015, -0.05005296215145679,
      ],
      [
        0.00020535258876857413, -0.002767969095299319, 0.0144175908751673,
        -0.04728402259698986, 0.11362579432601214, -0.09391411448080957,
        0.02931449030741542, -0.01974324439963758, 0.007686916866964472,
        -0.0017120988981388595, 0.00012637149632556914, -1.2642210845490427e-5,
        2.3502318768266035e-5, 3.737745971799333e-5, 1.5831926969358563e-5,
        -2.072872945563724e-5, -3.767088672249295e-5, -1.8940754134043724e-5,
        1.772694496310562e-5, 3.760673422009758e-5, 2.187488237649285e-5,
        -1.4561248430663612e-5, -3.718591153669502e-5, -2.4571240186112826e-5,
        1.1325548652437566e-5, 3.649092832345676e-5, 2.7077783830342902e-5,
        -8.00251430489851e-6, -3.5520290577702916e-5, -2.9405122264779078e-5,
        4.557272662059767e-6, 3.42039515361738e-5, 3.14598413569011e-5,
        -1.069448881372637e-6, -3.256743600565973e-5, -3.319919040895159e-5,
        -2.3727857375555153e-6, 3.070163222171113e-5, 3.4684334871167236e-5,
        5.795836155090718e-6, -2.8601159807372176e-5, -3.592123642673689e-5,
        -9.224292670389592e-6, 2.6208722832762216e-5, 3.682182712539811e-5,
        1.256868622967487e-5, -2.3572513698476156e-5, -3.7366808332916154e-5,
        -1.5752384999993706e-5, 2.0787531996715726e-5, 3.7630167954372866e-5,
        1.8813055025803803e-5, -1.784304664312934e-5, -3.761433359449534e-5,
        -2.176723147348696e-5, 1.4694462618898606e-5, 3.72404131624142e-5,
        2.4521391903820015e-5, -1.1409043495899928e-5, -3.651395001316108e-5,
        -2.701576047135763e-5, 8.080630165408202e-6, 3.551992289920955e-5,
        2.930087424207689e-5, -4.691039359536897e-6, -3.425738000777691e-5,
        -3.138737481079575e-5, 1.2071924648541678e-6, 3.265905259867433e-5,
        3.318318848504059e-5, 2.289428722544734e-6, -3.0754825957256634e-5,
        -3.4649669664530385e-5, -5.7119437804358386e-6, 2.863738295417952e-5,
        3.5850831789499505e-5, 9.088332578138157e-6, -2.63015524549943e-5,
        -3.6793089910518604e-5, -1.2442090491440955e-5, 2.3692683328686332e-5,
        3.7390516928214724e-5, 1.5683107281062986e-5, -2.0862672205190726e-5,
        -3.762837415031987e-5, -1.8737232438628248e-5, 1.790734862355631e-5,
        3.758343713814118e-5, 2.1644363461154658e-5, -1.4815631158863251e-5,
        -3.725874499464644e-5, -2.4420633126548083e-5, 1.1545147973038098e-5,
        3.657802234677478e-5, 2.697304794787591e-5, -8.165905667436825e-6,
        -3.5551419885976776e-5, -2.9245335970239973e-5, 4.771415010861003e-6,
        3.4266288023230266e-5, 3.129073930159864e-5, -1.3424447095527808e-6,
        -3.2722155810012546e-5, -3.312006793173011e-5, -2.152480465378582e-6,
        3.085449525930926e-5, 3.464277510917464e-5, 5.630289054555992e-6,
        -2.869743426578067e-5, -3.582445588440386e-5, -9.005662656910575e-6,
        2.6345274782173096e-5, 3.673202368244092e-5, 1.2308351929901906e-5,
        -2.3792926270012933e-5, -3.737241774488787e-5, -1.5560953136603582e-5,
        2.098827054730891e-5, 3.7661963303911354e-5, 1.8672979057998546e-5,
        -1.7986714109897815e-5, -3.759052788683887e-5, -2.157300786438523e-5,
        1.4884681364369455e-5, 3.723764231890649e-5, 2.430333416105896e-5,
        -1.1670563339079339e-5, 1.6982934784522095e-5, -0.0005285766685651245,
        0.0019846037617096885, -0.004215930837856643, 0.007536500519523255,
        -0.04356052160318823, 0.047977110434656786, -0.01065250386406492,
        0.001086296563036278, 0.0005894435620386136, -0.0002902326683811233,
        -7.186414511741888e-7,
      ],
    ];
    const result = wavedec(data, "sym12");

    const reconstruction = waverec(result, "sym12", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym13", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49004802792610624, 0.9054732381630071, 1.1870327655562531,
      1.3026625465075137, 1.2529789041132182, 1.0692856026141888,
      0.8046915665549169, 0.5205912978205862, 0.2718506168599287,
      0.09431056680294442, -0.002391021452445463, -0.03502463217174984,
      -0.04008782951461902, -0.06203730807398089, -0.13949548562641506,
      -0.29299363587849875, -0.5174305149019072, -0.7812528142087981,
      -1.0326897977629688, -1.2116107532977547, -1.2641545192995645,
      -1.1565555328494066, -0.8847409588609969, -0.4772647262276474,
      0.009263150548144278, 0.5012871458032875, 0.9234118095017998,
      1.2139892616159855, 1.3375555122346283, 1.2912402905382745,
      1.103725940476629, 0.8271213050678591, 0.5238102340523594,
      0.2515193813170613, 0.05023909013941835, -0.06586788396455145,
      -0.10969723154721088, -0.11541463608524628, -0.12723263161370674,
      -0.1856823167512145, -0.3149256403844777, -0.5143903661384458,
      -0.7569315335738486, -0.9940955096623264, -1.16728594550642,
      -1.222142501273627, -1.1226102318910696, -0.8612069094632071,
      -0.46288305411957403, 0.018599451869494146, 0.511042014193908,
      0.9385749766988081, 1.2373848778284011, 1.3687345096694086,
      1.326254149027726, 1.1358586478893908, 0.8484152721752416,
      0.5270201448872762, 0.2320153038222562, 0.007384719369073034,
      -0.1282148384039103, -0.1837069577556559, -0.19072857349575761,
      -0.19300508193573523, -0.23275199793181517, -0.33761637820619755,
      -0.5115282633716018, -0.7318533285133108, -0.9536638480751131,
      -1.1201633211804376, -1.176749340617201, -1.0852619746493752,
      -0.8348734931649446, -0.44685502368967617, 0.028081512450599172,
      0.5193778405283789, 0.9509910197086625, 1.257192027414903,
      1.3961131348641742, 1.35788963714492, 1.1655370631851985,
      0.8684470580484702, 0.5301495542778671, 0.21334640676730315,
      -0.03415704086281762, -0.18926008291115115, -0.25683410417810554,
      -0.2658015500462664, -0.25916006322533336, -0.28057830785462506,
      -0.3610281530743115, -0.5088962095476993, -0.7061423245011862,
      -0.9115593449036634, -1.0704098119789367, -1.1281092309353546,
      -1.044588184726617, -0.8057537588562638, -0.429139270493077,
      0.03778085904577405, 0.5263646094819745, 0.9606978886837564,
      1.2733956609830384, 1.4196177770992915, 1.3860263746961956,
      1.1926206921960276, 0.8870912276050793, 0.5331231167777507,
      0.19551347148577736, -0.07429909618400427, -0.24883902924729223,
      -0.3288630505934753, -0.3404054210329167, -0.32549894200847485,
      -0.32902827765255716, -0.3851158757480017, -0.506540491746799,
      -0.6799205876101788, -0.8679492438143548, -1.0181997707657688,
      -1.0763672350903957, -1.0006784154033537, -0.7738715370495319,
      -0.40970144990189133, 0.047767402900107836, 0.532076568535583,
      0.9677428593698015, 1.2859931975798924, 1.4391878594706078,
      1.4105549464064735, 1.2169758551342285, 0.9042239518044579,
      0.5358620707608748, 0.17851018848891803, -0.11296297109918985,
      -0.3067948421545967, -0.3995830266851768, -0.4143128157398049,
      -0.39181976057771184, -0.3779626390471874, -0.40982715616988086,
      -0.5045014086548364, -0.6533075618593045, -0.8230027865213101,
      -0.9637142762657283, -1.021678766901228, -0.9536341181786074,
      -0.7392615303946627, -0.38851460283624684, 0.058108914441538206,
      0.5365916976382956, 0.9721821517088056, 1.2949944063978898,
      1.454776028781816, 1.4313773639394738, 1.2384763117026787,
      0.9197236402643276, 0.5382847146650818, 0.16232334585295777,
      -0.15007897441001478, -0.3629789415947122, -0.4687888538298101,
      -0.4872979634078828, -0.4579179700330005, -0.4272363073735876,
      -0.43510243643829727, -0.502813033827668, -0.6264195274851654,
      -0.7768904988783689, -0.9071404153634357, -0.9642090327931596,
      -0.9035683625338804, -0.7019693580080539, -0.3655594888360623,
      0.0688705092019413, 0.5399911657279044, 0.9740805136822781,
      1.300421239906939, 1.4663482940375467, 1.4484074852335602,
      1.2570038615692891, 0.9334715722038534, 0.540306903885598,
      0.14693305461210138, -0.1855863210513865, -0.41725146597338014,
      -0.5362816622020203, -0.5591375148175404, -0.5235871799540291,
      -0.47669889757334666, -0.4608751641868298, -0.5015030159178173,
      -0.5993690825895126, -0.7297834799132278, -0.848670546104411,
      -0.9041324356573682, -0.8506055078600123, -0.6620515530449744,
      -0.3408248845789844, 0.08011414767370101, 0.5423587769176547,
      0.9735107725742023, 1.30230761939305, 1.4738841130499574,
      1.4615713893005666, 1.2724489174360367, 0.945352522710892,
      0.5418425658371965, 0.13231300983333733, -0.21943321014856865,
      -0.4694816946406652, -0.6018695803402138, -0.6296113561361644,
      -0.5886199216361712, -0.5261952710799191, -0.4870720057632991,
      -0.5005924168512375, -0.5722646504933697, -0.6818526969080922,
      -0.7885015445306898, -0.8416319433385102, -0.7948808286935303,
      -0.6195755131513534, -0.3143078461059679, 0.0918981517416032,
      0.5437804091971453, 0.9705533559698252, 1.3006991740849991,
      1.4773764268905534, 1.4708077048199655, 1.2847110480401862,
      0.9552553813371306, 0.5428042306086075, 0.11843078587799588,
      -0.2515768593039085, -0.519548428142153, -0.6653683944403413,
      -0.6985034117108759, -0.6528084217515356, -0.5755661113681909,
      -0.5136130984056972, -0.5000955887535683, -0.5452100149951824,
      -0.6332682895881117, -0.7268340385422253, -0.7768984243170935,
      -0.7365400946123577, -0.5746194036403237, -0.28601393317973023,
      0.10427674025052053, 0.5443434485206631, 0.9652957849313031,
      1.2956529352463573, 1.476831642138918, 1.4760678910527478,
    ]);
    const expected = [
      [
        2.294348142854763, 2.017022830051009, 1.4548213176591749,
        1.5598140400698888, 2.472310629537042, 1.4055058621521983,
        1.6318749361017035, 2.4905209768644783, 1.3082141505209086,
        1.6335830715797401, 2.4736189153638297, 2.3049363444379503,
        -1.6247007274645828, -0.888643412334079, 2.76034476940908,
        -1.5481125584436115, -1.4519970554435773, 2.8880751690459476,
        -1.1059404850624461, -1.9513677157299034, 2.8855461823158897,
        -0.6358331454672965, -2.321369738584734, 2.719500067447106,
        -0.13338267511014418, -2.558373776716333, 2.389082830223016,
        0.40254464892333547, -2.674199656771399, 1.9146852048097704,
        0.9629635341741517, -2.6886917006223663, 1.3352010380082167,
        1.5245917162366607, -2.6210329078960473, 0.7006581310018087,
        2.050660390361792, -2.484774017519131, 0.07265642626461288,
        2.473823123785075, -2.2436456864489496, -0.8516868440348462,
        3.837195045277886, -1.497269073199454, -0.5812690776112736,
        3.898300455890825, -1.7243525702879996, -0.665926004014383,
        3.889198248435776, -1.6561555076163457, -0.3898796168487308,
        3.8999244042383143, -1.790933243146765,
      ],
      [
        -0.9685928260710648, -0.13093870046918427, 1.5901572005264955,
        -1.4829780425627275, 0.0017467192378997458, 1.4746927816915192,
        -1.169820714584963, -0.5916522217658224, 1.6965539537698697,
        -1.2103359537375566, -0.30574072482212816, 0.9739144755785522,
        0.4951098377395909, -1.426270030193013, 1.330828557559146,
        -0.3775590287861346, -0.7741131452376749, 1.3473200779052596,
        -0.9989166243067887, 0.010085221860086107, 0.9520307484768227,
        -1.2766409710015265, 0.7700537637058423, 0.24510390742849114,
        -1.1216883616517914, 1.2735320352513846, -0.5580030098583416,
        -0.5831001704826043, 1.3692246111408737, -1.2108490101773843,
        0.16850336879352779, 1.033949675825953, -1.512977423857211,
        0.8944468562612345, 0.37960009958735563, -1.372514631352449,
        1.362702589162956, -0.38084945610017956, -0.8439660477314367,
        1.4504057251677513, -1.136203664811856, 0.15357795952760583,
        0.1105496057289557, -0.4506740288702279, 0.19593681072652816,
        0.38404952487079247, -0.6515378003831421, 0.5202678082694261,
        -0.10780497011042581, -0.3685435923912043, 0.40377025596200916,
        0.18341497107397325, -0.5102800756218071,
      ],
      [
        0.06750429910234973, -0.18991132081422757, 0.5110822497994607,
        -0.5468403338968119, 0.21606047779361787, -0.14040358307817505,
        0.17571400926218905, -0.26989328237943766, 0.558504093363591,
        -0.4722308361598579, 0.1249136028586904, -0.03746880283975715,
        -0.018696502884503596, 0.02612143436579953, 0.011296610453763786,
        -0.03836534289203081, 0.02063195545258145, 0.02117717759900324,
        -0.03820462919269677, 0.010701819720333539, 0.029349966475438766,
        -0.0351608522124081, -0.00018568791248846855, 0.03525794093354006,
        -0.029120229101211485, -0.010939748969689283, 0.03828704428630065,
        -0.02093712004421845, -0.02095312782637723, 0.038299863163596626,
        -0.010902460579727805, -0.029145716337992626, 0.03522937154832557,
        -0.0001680238784795408, -0.03516798357694595, 0.029347565153121504,
        0.010741842036591717, -0.03821210914301863, 0.02113734418538317,
        0.020642542093598747, -0.03837953837621239, 0.011202248566702471,
        0.029032107681449575, -0.035298021111556124, 0.0004274157020108034,
        0.03497818596479547, -0.02958288632685456, -0.010455509103899462,
        0.03823781885247802, -0.021315461839491658, -0.020411290647172405,
        0.03835093135177461, -0.011533633840661398, -0.028844838448730925,
        0.03547343694902566, -0.0006437392320157518, -0.034849541443841114,
        0.029706796420823276, 0.010115196809504536, -0.03820828955650996,
        0.02160227423215735, 0.020242168204380795, -0.03836310565194375,
        0.011755804219453192, 0.02858377446316744, -0.03561500340145051,
        0.0009732007374113115, 0.034668153315597916, -0.028250676855733306,
        -0.018290250549048027, 0.07394035765584615, -0.10578261552534403,
        0.19277833154052118, -0.17564105633041893, 0.1115370146145557,
        -0.18277625899379493, 0.1902616103793669, -0.12460487681944903,
        0.18291029062780267, -0.1869824210414855, 0.08431170750924175,
        -0.05890319342487489,
      ],
      [
        -7.256846629170551e-5, 0.0011045653501334327, -0.006073928452254383,
        0.023036650763536164, -0.052085549019589825, 0.12067955563495632,
        -0.11410026980284171, 0.037113529146738614, -0.014157868577297091,
        0.005701193506033675, -0.001250362929375328, 0.0001052247145800699,
        -1.4746231392710146e-5, -8.464538567261757e-6, 5.601909989930688e-6,
        1.4520745211353261e-5, 1.0091151139795878e-5, -3.616835501899265e-6,
        -1.4003314662476979e-5, -1.1520924873611722e-5, 1.5486683438447647e-6,
        1.3192168284427658e-5, 1.270786296174484e-5, 5.429795974437395e-7,
        -1.2117946225416193e-5, -1.363515766483367e-5, -2.614042429027047e-6,
        1.0812864867912385e-5, 1.4300749740869169e-5, 4.641254056881112e-6,
        -9.287649093255883e-6, -1.4682517998897376e-5, -6.5840700800432394e-6,
        7.5638922110604124e-6, 1.4757161953747906e-5, 8.38516106001127e-6,
        -5.692621941270395e-6, -1.4533584725189222e-5, -1.0010142282088652e-5,
        3.718705278400847e-6, 1.403081856600396e-5, 1.1444532665727794e-5,
        -1.6645793001354744e-6, -1.3247027425484955e-5, -1.2655858516445287e-5,
        -4.340142628398169e-7, 1.2184655150763525e-5, 1.3602047719774688e-5,
        2.5171787453583886e-6, -1.087835429510683e-5, -1.4269648085196947e-5,
        -4.5394649225819785e-6, 9.36624049476663e-6, 1.4662429690734453e-5,
        6.478423062679022e-6, -7.664095619546196e-6, -1.4765160920958266e-5,
        -8.296851201636177e-6, 5.795730014985956e-6, 1.4559378748480963e-5,
        9.939914888565312e-6, -3.8143139265316487e-6, -1.4058283319446916e-5,
        -1.1374831334369566e-5, 1.7683402489910785e-6, 1.3287382382974876e-5,
        1.2591102134983432e-5, 3.1769540114747615e-7, -1.225146035911654e-5,
        -1.3562185355725192e-5, -2.40888971103866e-6, 1.095698844350674e-5,
        1.4250501615944956e-5, 4.445951158084683e-6, -9.442149659711875e-6,
        -1.464625729568186e-5, -6.382829104863399e-6, 7.750398925618449e-6,
        1.475916948845803e-5, 8.198492167487492e-6, -5.902132233466163e-6,
        -1.458109187498392e-5, -9.85977162117249e-6, 3.92283468945302e-6,
        1.409855496938301e-5, 1.1315120408385962e-5, -1.8670278340787724e-6,
        -1.3328915634367685e-5, -1.2533952157128136e-5, -2.1395136845724593e-7,
        1.2303863381438331e-5, 1.3510138943748608e-5, 2.294170743968938e-6,
        -1.1034600964286896e-5, -1.4223527147751847e-5, -4.34027146339281e-6,
        9.5313549845989e-6, 1.4641513399679619e-5, 6.2944511325919e-6,
        -7.835281051895795e-6, -1.4758183167243637e-5, -8.11083393739241e-6,
        5.99452934699252e-6, 1.4589216100250953e-5, 9.770379987169998e-6,
        -4.033594701797373e-6, -1.4133634719228573e-5, -1.1244588614572969e-5,
        1.9790507928206085e-6, 1.3383022060400223e-5, 1.2485934566384824e-5,
        1.1405464458814972e-7, -1.2358661037125595e-5, -1.3466565730116666e-5,
        -2.1923591834750045e-6, 1.1098026117275925e-5, 1.4185033800094404e-5,
        4.229134079623355e-6, -9.618434501549149e-6, -1.4627931600539764e-5,
        -6.193258621876142e-6, 7.933518401440976e-6, 1.4768023016789509e-5,
        8.029282922856449e-6, -6.08678118696511e-6, -1.460340626829772e-5,
        -9.692262942415916e-6, 4.130350915367012e-6, -1.5297890003624075e-5,
        0.0004243381819634328, -0.002275167140080434, 0.008684898628398384,
        -0.019755874334693353, 0.04563402050507426, -0.043157713054430016,
        0.014121586242879533, -0.005339987923355581, 0.0021299631133753446,
        -0.00047797337570629233, 2.7348888720999444e-5,
      ],
    ];
    const result = wavedec(data, "sym13");

    const reconstruction = waverec(result, "sym13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym13_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5112798427515483, 0.9417406098810048, 1.227389162515258,
      1.3339076914915624, 1.2625318415296007, 1.0476807798345864,
      0.7470868132772608, 0.4269973034273877, 0.14619278782180045,
      -0.057207287285286734, -0.17294806529842494, -0.21821460500294906,
      -0.2299065783014929, -0.2518061993280222, -0.3201291089628228,
      -0.45134644567855986, -0.635567812566312, -0.8373319066016851,
      -1.0037305397732492, -1.0778802805022363, -1.0143398782937878,
      -0.7925125379111485, -0.4245157831896187, 0.044658902392382266,
      0.544972461944482, 0.9954377618278947, 1.3212027958714714,
      1.469560524144545, 1.421063847279068, 1.193106286682224,
      0.8351636759176086, 0.41692233663708056, 0.012238917382381032,
      -0.31714129730642004, -0.5341793404933788, -0.6324972337257659,
      -0.6344409852601276, -0.5819994632804815, -0.523118402273842,
      -0.4970828289906053, -0.5228339696853237, -0.593292767324888,
      -0.6771853712253315, -0.7279079604098553, -0.6971269278996408,
      -0.5495543097047582, -0.27498824713615844, 0.1056436801049842,
      0.5420143562620343, 0.9637245943981744, 1.2951258560373562,
      1.4721203660245894, 1.4568749325649473, 1.2468495780275037,
      0.8759049587029263, 0.4071754980786348, -0.08060058114705268,
      -0.5100169749641981, -0.82115008376119, -0.9831047447255795,
      -0.9983087938220645, -0.8987312243371858, -0.7352085119700419,
      -0.5627582704193579, -0.42571524077481426, -0.34650511654247895,
      -0.32088648641442946, -0.3207933024968745, -0.3039321940348907,
      -0.22753325657583295, -0.06256559245791521, 0.19541340122890533,
      0.5217655406764893, 0.8660145246685631, 1.162224874043548,
      1.344075768397623, 1.3609478054173352, 1.191018539533978,
      0.8480449373954515, 0.38003108811373304, -0.14003992007712657,
      -0.629284015557164, -1.0122509432625448, -1.2364120365060587,
      -1.282160233749865, -1.1650420740297882, -0.929858373314095,
      -0.6382641138158034, -0.35307084869962674, -0.12321546779718212,
      0.02687882701926597, 0.10099496824531551, 0.1271188102605871,
      0.14697175366623055, 0.2019649050045078, 0.3193699823555224,
      0.5024374494032415, 0.7271704300798981, 0.9467431037009011,
      1.1025706250927552, 1.139297114085111, 1.019911823416194,
      0.7371022603624837, 0.31783737916406957, -0.18017397714633815,
      -0.6794963969348323, -1.0989390218468018, -1.3707232936592897,
      -1.4547665337167235, -1.346690339714303, -1.0776910096357577,
      -0.7063950201237109, -0.3047708036332669, 0.05840655728179106,
      0.3324921141751139, 0.49472436480926774, 0.5525602204334453,
      0.5382531430284406, 0.4972992470209623, 0.47391142309227,
      0.49740299972733565, 0.5730904896180891, 0.6801311803128616,
      0.7769003044835219, 0.8125448657202051, 0.7417272477849639,
      0.5387052931716269, 0.20700933007372696, -0.21795407671752537,
      -0.6742833321891165, -1.0858528479003342, -1.3786285535169023,
      -1.4971305466493146, -1.417059064812341, -1.1510043793061113,
      -0.7458334014798653, -0.2723699426186978, 0.19014255070741565,
      0.5710534824417401, 0.8227265110336389, 0.9289871204926745,
      0.9057303738102123, 0.7937901464019846, 0.6460942589167704,
      0.5125266975632381, 0.42644003779751494, 0.3962809695552375,
      0.4044350799171019, 0.4135103634566922, 0.3783422437184377,
      0.2605083429273176, 0.041468968744378665, -0.2692285318551669,
      -0.6330061141002548, -0.9890552592559135, -1.267383250638569,
      -1.4049879274200126, -1.361196015877194, -1.1283428779274807,
      -0.7350733753106795, -0.24133240445464976, 0.27385567770204244,
      0.7289536303734736, 1.0568985165173657, 1.2184938070325468,
      1.2090919710568566, 1.0571193917735586, 0.8150090164810476,
      0.5449631678765039, 0.30320600530049285, 0.12669560387689238,
      0.025576491090619213, -0.01685667681421843, -0.03685993975589097,
      -0.07766955470854559, -0.1750767892064608, -0.3450385340023295,
      -0.5766900287737939, -0.8327363301634753, -1.0572960184837985,
      -1.1893363801831711, -1.1783650204431018, -0.9984045069804823,
      -0.6566400491853381, -0.19440896412624703, 0.3199225016417266,
      0.8046431612909035, 1.1817564515499719, 1.3933795623370528,
      1.4135921841957826, 1.2529525403756203, 0.9546915484584302,
      0.58362725018348, 0.2106044789818483, -0.10367945834377557,
      -0.3215140723447997, -0.43462761313494336, -0.4628509920331165,
      -0.44558089020280023, -0.4284508617439778, -0.44881552796555824,
      -0.5239235651018114, -0.6449340704979578, -0.778402795598326,
      -0.8749184504923958, -0.8826995003365465, -0.7626443148886715,
      -0.5008988618714636, -0.11557885365455728, 0.344282948621488,
      0.8075567949017916, 1.1956420966142596, 1.439459209631552,
      1.4947353984271263, 1.351892144273374, 1.0381376191624312,
      0.6112610781445321, 0.1466437889406767, -0.27935873400344985,
      -0.6056538418249354, -0.798400608673083, -0.8559818640863044,
      -0.805968361307028, -0.6950918758911803, -0.5749774104674961,
      -0.4874092898568971, -0.4529670408798504, -0.46595330961915765,
      -0.49688242304955177, -0.501825868614397, -0.4361214216341491,
      -0.2688009541474162, 0.006128118469504118, 0.36464299022838115,
      0.7554348801263964, 1.109964301227914, 1.3575214141487473,
      1.4416619901453334, 1.333982418379211, 1.0417986382883966,
      0.6077575072178609, 0.10137175987281942, -0.3955575814269617,
      -0.80617679516234, -1.0743814753782046, -1.1754680223639495,
      -1.1192086287329315, -0.9448065903315886, -0.7091913403234964,
      -0.47173395605122603, -0.27930000793259124, -0.1554018373568567,
      -0.09611075080727244, -0.07362356828740624,
    ]);
    const expected = [
      [
        2.2717256297437003, 2.1172972162130153, 1.1511368162590443,
        1.3459027810705022, 2.614763497847597, 1.1345762429014528,
        1.4461285804500206, 2.6371965594508247, 1.0045341523759943,
        1.423322544880308, 2.5908618189838557, 2.0420767029402427,
        -2.0948099375988725, 0.41893317842051464, 1.938175760370995,
        -2.6454965860773485, 1.0678671992361426, 1.4417896543653892,
        -2.7044681375591173, 1.6192935158265462, 0.87724511051751,
        -2.619518949732293, 2.0907692277233005, 0.2573720512132187,
        -2.391056986925176, 2.4555622524596856, -0.3866692296292523,
        -2.0272175402612835, 2.6910702608436514, -1.020860382557197,
        -1.5436275406401865, 2.7803148790361725, -1.609835592746298,
        -0.9633232601660456, 2.7134537917027317, -2.1187414858665963,
        -0.3163629806178963, 2.490744905192057, -2.5192494630101665,
        0.3398264904222127, 2.183123813612497, -2.293959507999003,
        -0.16712036549917048, -2.308637040994932, -2.079283813248753,
        -0.48219873055924023, -2.8413382541697403, -2.410950087340998,
        -0.5526267610760301, -2.4078503537298364, -2.1029485633096257,
        -0.6419817725009427, -2.355832124107768,
      ],
      [
        -0.9461371593120581, -0.15901213770103295, 1.7061667074660367,
        -1.5911914599027381, 0.00029506441582814285, 1.5739977832836698,
        -1.249641107994703, -0.6274381124871009, 1.81920525836781,
        -1.3086240631473114, -0.29004675960486775, 0.9398593267445909,
        0.7001489983057201, -1.649008760495632, 1.3134183708177836,
        -0.01152458224428774, -1.2759021258334735, 1.5478780942595411,
        -0.5976402783151986, -0.8167085074156205, 1.5768223537583979,
        -1.089502760583898, -0.2503607188533227, 1.3805740913473934,
        -1.414892650358153, 0.338294644702591, 0.991466649618225,
        -1.5284475792277747, 0.8618505311902831, 0.470538173578485,
        -1.4172312049338107, 1.2437239483151548, -0.10198228422317768,
        -1.1024727245211197, 1.429772252018858, -0.6390986188175838,
        -0.6358829383934195, 1.3952918291166616, -1.0569057027467117,
        -0.09645833423669255, 1.1365611155149429, -1.333058995612972,
        0.5404256664230122, -1.3849143189737, 1.0182977194890788,
        0.14614002890680494, -0.08363576295206906, -0.06442917711229353,
        0.14209645105319024, -1.1828396824985299, 1.422968786798193,
        -0.4307597906905953, 1.1362058707931464,
      ],
      [
        0.0738694454063003, -0.20370521909263942, 0.5402213894563086,
        -0.5763891774226856, 0.22746783084727412, -0.14412035322752595,
        0.18149851728825117, -0.28470963030657104, 0.5890618083216079,
        -0.49942183586743644, 0.13543033887578548, -0.04225694606070966,
        -0.020720833149069046, 0.03331578178690369, 0.00606719345552184,
        -0.04175266007820262, 0.030747935679833506, 0.014625986393486914,
        -0.043479684638673806, 0.023944815106965243, 0.022284485552545343,
        -0.043829381028596064, 0.016293889160990078, 0.02949984633587832,
        -0.0421523550989891, 0.00786284405551821, 0.03511794510167056,
        -0.039092918536734335, -0.0006846055526858125, 0.03980738497202224,
        -0.034277950800654294, -0.009443884643146369, 0.042491381224753676,
        -0.0282963054506305, -0.017550961153394787, 0.04394941589694641,
        -0.021080572466453822, -0.025292284149056453, 0.0432609321340096,
        -0.013112316212414904, -0.0316861126805066, 0.04128273145819653,
        -0.004610490326073659, -0.03722514257839563, 0.03730802636493667,
        0.004105702624647632, -0.04089522952463979, 0.03221996873628381,
        0.012574124495897957, -0.04339228118662546, 0.025557732698288944,
        0.0206888302837901, -0.04374835997251397, 0.018165649014067756,
        0.027804281090257434, -0.04283755362344242, 0.009835144572148683,
        0.034066532912172924, -0.039802364703182914, 0.0012983461983393106,
        0.03871444205509666, -0.03564715950480222, -0.0074179128126045935,
        0.04216536611005902, -0.029669710747842002, -0.015767070938614503,
        0.043603648990455095, -0.022795227174813838, -0.024723186855799044,
        0.04858595862323983, -0.025304385932966633, -0.027369701092132916,
        0.0802400455880163, -0.15292764986209462, 0.2629497126051962,
        -0.5046218001099528, 0.48295311936414287, -0.21501962934697577,
        0.12784245243824524, -0.08359816786602843, 0.02972664759307801,
        0.025779282293812367,
      ],
      [
        -7.333837688358698e-5, 0.001152357259951592, -0.00634884756940828,
        0.024096861750752707, -0.054528087893522564, 0.12629024056394048,
        -0.11941120010438978, 0.038874608940136605, -0.014812167363905846,
        0.0059565022440510465, -0.0013041493694637622, 0.00010743229621422719,
        -1.7458701159590747e-5, -8.497717145112415e-6, 8.486300292459654e-6,
        1.7467227817710376e-5, 9.967818342582102e-6, -6.9419574264554176e-6,
        -1.731292855035569e-5, -1.1361348597875582e-5, 5.3016810252262184e-6,
        1.6962395567101235e-5, 1.2626164454580593e-5, -3.6124880680959265e-6,
        -1.6433522442235452e-5, -1.3743672881066831e-5, 1.9159853121042706e-6,
        1.5768157673745292e-5, 1.4740624209909704e-5, -2.0091650465851708e-7,
        -1.4962778419659307e-5, -1.5617931244747107e-5, -1.544251623666555e-6,
        1.3987429166868405e-5, 1.6330542946426806e-5, 3.277877157573866e-6,
        -1.2857198850704788e-5, -1.685639183800806e-5, -4.951629070720849e-6,
        1.1621707343612749e-5, 1.7224945480432505e-5, 6.569827847088546e-6,
        -1.029219192078342e-5, -1.7451810953637534e-5, -8.150387067674084e-6,
        8.84307443576542e-6, 1.7502437022674782e-5, 9.66109127478913e-6,
        -7.2848400685403725e-6, -1.7353223882228906e-5, -1.1051305592223604e-5,
        5.67096886422842e-6, 1.7035189127769237e-5, 1.2319784890873624e-5,
        -4.025626886794973e-6, -1.6578102842150272e-5, -1.3491367011740358e-5,
        2.327783698633029e-6, 1.59600963432181e-5, 1.4546619678445473e-5,
        -5.813259334476372e-7, -1.5157427667512343e-5, -1.54369403548555e-5,
        -1.160949961957373e-6, 1.4200757509920343e-5, 1.6156931053978177e-5,
        2.864880529581545e-6, -1.3132019950422467e-5, -1.673816670314635e-5,
        -4.547341497140526e-6, 1.1942830537279835e-5, 1.7176233603540686e-5,
        6.212904642613177e-6, -1.0610057980786786e-5, -1.742834257471888e-5,
        -7.814143721957136e-6, 9.161488601373171e-6, 1.7486108994550563e-5,
        9.310521439027472e-6, -7.647913652339836e-6, -1.7386745340291296e-5,
        -1.0715444517537574e-5, 6.073877761425475e-6, 1.7141668404331928e-5,
        1.20433074010091e-5, -4.417027046206409e-6, -1.6716757179827458e-5,
        -1.3256357374231194e-5, 2.699407660612376e-6, 1.610136036880038e-5,
        1.4311532956541969e-5, -9.763829328103785e-7, -1.5336268711869884e-5,
        -1.5219454362484538e-5, -7.362928001918896e-7, 1.4447984731727305e-5,
        1.6004876815996123e-5, 2.460444981163926e-6, -1.3412758296948247e-5,
        -1.664314861282689e-5, -4.18262000127278e-6, 1.2217866614319621e-5,
        1.709230249727127e-5, 5.847687140652253e-6, -1.0904766286468689e-5,
        -1.7360587180595748e-5, -7.431241007519745e-6, 9.51280070688445e-6,
        1.7482588085527276e-5, 8.954991427221935e-6, -8.029083003188975e-6,
        -1.7448913813397256e-5, -1.04165063579487e-5, 6.438542655596025e-6,
        1.7221692722955742e-5, 1.1765683499714977e-5, -4.7797924862752345e-6,
        -1.680676674277798e-5, -1.2972460847816367e-5, 3.1015130795347874e-6,
        1.6246844814645926e-5, 1.4058727345492058e-5, -1.4010695633097522e-6,
        -1.5548447379281517e-5, -1.5034681650915873e-5, -3.3953201399394644e-7,
        1.467991834833407e-5, 1.7777094571511093e-5, 1.0782368996912655e-6,
        -9.180529582910762e-5, 0.0004532761251159068, -0.00110305936947154,
        0.0018288389613721487, 0.00017352988563415497, -0.00205203688601802,
        0.0010068216655265351, -0.0002783466371252016, 5.9545080446183176e-5,
        2.2349946791053807e-6, -1.761782897041323e-5,
      ],
    ];
    const result = wavedec(data, "sym13");

    const reconstruction = waverec(result, "sym13", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym14", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.508215998099991, 0.93652010573762, 1.2216197798116162,
      1.3295396625585898, 1.2614420771004793, 1.0513048155884566,
      0.756184659463539, 0.4415956960252064, 0.16569162328091203,
      -0.03382538369870913, -0.14689377368018067, -0.19073989430870514,
      -0.20227880327443307, -0.22541017916144035, -0.29664309065867056,
      -0.43289666566732316, -0.6247548513407568, -0.8370467902359088,
      -1.0167354034952618, -1.1062029846016257, -1.0586032623078026,
      -0.851365157369949, -0.4943355915383304, -0.030340782184736487,
      0.47219277538917426, 0.9329490051089275, 1.2765745576863248,
      1.448683332070237, 1.4272078681825326, 1.2264156027456294,
      0.8926920318805683, 0.4931941969970873, 0.10019927641126208,
      -0.225012449694927, -0.4448431077071865, -0.5516430525951203,
      -0.5662132836400077, -0.5291657619166182, -0.48755448038598975,
      -0.4803588984051587, -0.5266554820611682, -0.6195912846855998,
      -0.7277601960964768, -0.8036613679384793, -0.797076798206304,
      -0.6699079609720383, -0.40858953641629725, -0.030761537842615316,
      0.41570860505891966, 0.8613566841554718, 1.2294834783639306,
      1.4528661913651781, 1.4888103696292077, 1.3288976834652606,
      1.0010541277022984, 0.5634230898947831, 0.09151668622523268,
      -0.3382572259651056, -0.6647387003489766, -0.8539988021053819,
      -0.9043985027465202, -0.8437029459893741, -0.7192119233411945,
      -0.5835906489224189, -0.4801200485829436, -0.4311763051496388,
      -0.4328765886585785, -0.4572151537551427, -0.4610705104649994,
      -0.3996822134403518, -0.24102612761367728, 0.022743352386984883,
      0.3698989077237424, 0.7513930205571803, 1.1004228418720952,
      1.3471054105536333, 1.4347325956934212, 1.3336209072636325,
      1.0491097869455785, 0.621662774186658, 0.11894256441646163,
      -0.378312602400976, -0.7932741199277635, -1.0688451013768008,
      -1.1785995220088938, -1.130338357537228, -0.9615918866432057,
      -0.7283788809082514, -0.4901731201639908, -0.2949180472730681,
      -0.16785250507643656, -0.10688864129367631, -0.08557823177257026,
      -0.06274781736498503, 0.003829555088911918, 0.14339519019509578,
      0.3615669606733065, 0.6360082675186686, 0.9197000722131463,
      1.1511630719496115, 1.2691795059031605, 1.2283728816153419,
      1.0117223288813022, 0.6367917157318037, 0.15397039744967816,
      -0.3630235574629973, -0.832222057545271, -1.1805315269071381,
      -1.3588558487767055, -1.3516560977182643, -1.178747803319579,
      -0.889036099746416, -0.5478530003897709, -0.22110088005494133,
      0.03985944844776673, 0.2088882581136452, 0.28879426240326744,
      0.3073785496174964, 0.30702109955324053, 0.33066886663578837,
      0.4079826432871729, 0.5453384471975184, 0.7223749789327751,
      0.8960862963459084, 1.0115063052004563, 1.0163129532115822,
      0.8756308589735344, 0.5831993651390049, 0.16593115728830088,
      -0.31949672576039195, -0.7974049258021373, -1.1887763630542658,
      -1.4281336353769682, -1.4776082881914236, -1.3348429613861805,
      -1.0328595101799418, -0.6319781911926192, -0.20579991850882307,
      0.17531299838126613, 0.45925456031338263, 0.6221142951301655,
      0.6707705680887259, 0.637732486182625, 0.56977088539946,
      0.5134208047860576, 0.5011901531758065, 0.5420856304342334,
      0.6189268068806598, 0.6931526443823165, 0.7158793002324129,
      0.6423364316641679, 0.44590517548323283, 0.1280353056837204,
      -0.27867857382034544, -0.7152806891149582, -1.108141933453868,
      -1.3848437451589892, -1.4904605078598632, -1.4002925050023245,
      -1.1259313050827755, -0.7131458301665308, -0.23206216550725658,
      0.23801954905490255, 0.6255365733540414, 0.8812765530946403,
      0.9872673723726807, 0.9579628920959402, 0.8336661766486014,
      0.6680518463114785, 0.5130871110903973, 0.4052492711756288,
      0.35654988671666255, 0.35260411214996584, 0.35815153286403606,
      0.328506387105723, 0.22387820160379485, 0.022747600684951963,
      -0.26930136440152563, -0.6177544255374556, -0.9650361266189058,
      -1.2428033670421128, -1.387734949342559, -1.3569546830295305,
      -1.1392532469625822, -0.7592609390502829, -0.27342694928893324,
      0.2413416839139343, 0.7037335341402302, 1.0449855601874203,
      1.2227313322530895, 1.2285163314980927, 1.0873194144726588,
      0.8493874108171106, 0.5765672703976539, 0.3266400039418832,
      0.13959621868552902, 0.029239829094864833, -0.01789197595186917,
      -0.03619302096144002, -0.06903841103107039, -0.15445658437663906,
      -0.31226439719539445, -0.5361308124964884, -0.7927728120582666,
      -1.0286572479629374, -1.1826463514301335, -1.2014718721371427,
      -1.0541471866117362, -0.7416274630380659, -0.29915947887422306,
      0.20945446124175054, 0.7044633229600706, 1.106727599296038,
      1.3543276849957084, 1.415288464436449, 1.2934308765993994,
      1.0260389767986766, 0.6740264289303761, 0.30710315242125796,
      -0.01236996209538821, -0.2428856796311547, -0.37142138599176433,
      -0.4134826540192097, -0.40578030830807366, -0.3936244476413586,
      -0.4164412066546906, -0.4952687067107395, -0.6255560935423519,
      -0.7772099390959042, -0.9019551405440266, -0.9461778030297514,
      -0.8659765172090426, -0.6405320862572095, -0.28027318223480596,
      0.17242161581808824, 0.6504001159746426, 1.0752398522146351,
      1.373932325056638, 1.4947788201562506, 1.4186852359152995,
      1.1631436798581876, 0.7779604165699616, 0.33379322205701667,
      -0.09370131400128717, -0.4402694725981215, -0.6660830348156617,
      -0.7623395502482853, -0.7500288343772119, -0.6714225792435908,
      -0.5766547968842171, -0.5089611000448693, -0.49243578307048125,
      -0.5254775987770717, -0.5816046567641792, -0.6174043540766374,
    ]);
    const expected = [
      [
        1.6820582509787072, 2.2243375302398602, 1.962111300769524,
        -0.18459501413673807, 2.4958278797585187, 2.286110746397768,
        0.2006344387320581, 1.6347421667475108, 2.4803079406874486,
        1.188372178558591, 0.343793308471049, 2.7676527579167005,
        1.965412248981446, -0.6623518530812635, -1.7822964887782091,
        2.9660065481208506, -1.5660538736807241, -1.217766171158765,
        2.9095761680624994, -1.9948276879984155, -0.7063841334381005,
        2.7729274229918377, -2.35416363166958, -0.17122722723465952,
        2.5375129733617166, -2.6260376894168145, 0.3639637228995454,
        2.2154219279128498, -2.801084506891568, 0.8766161563807365,
        1.8231233621428156, -2.875910873320575, 1.3468357317694033,
        1.3797939189413677, -2.8528713784567117, 1.7587734181342445,
        0.905465597352193, -2.739079842002272, 2.0998412233219126,
        0.42883374639373767, -2.5829101379512744, 2.4814939801671776,
        -0.19492966535238135, -2.031378925288918, -1.4066620354478763,
        -1.2670534044472548, -1.654595072279154, -1.8500935839799202,
        0.3843127498283064, -1.0214728649799723, -1.884578493810331,
        -1.3693860920387018, -1.389610020392978, -1.6104081971742885,
        -1.8231290750678475,
      ],
      [
        1.6564950065899031, -0.32131104722528464, -0.2640058438190709,
        0.13631846802121306, -2.1637413361377185, 0.7753869358105785,
        -0.7849025238647083, 1.0366056258954874, 1.4422399225620526,
        -0.7674902243474958, 1.2940938349758, -1.3364925649358788,
        -0.9486525249239881, 0.687837413779483, 0.2669199083830631,
        -1.0926155848948693, 1.1403281384151058, -0.3452032513785226,
        -0.7049778623192746, 1.227045602588491, -0.8295873308285256,
        -0.19352813441546904, 1.0783483084460035, -1.15778908870828,
        0.36263031872368323, 0.7179250286674452, -1.2693038775943235,
        0.8632521155742643, 0.20899499335228414, -1.1417467321664845,
        1.2174684312201185, -0.3588216173503769, -0.7946413433761836,
        1.3596271988358464, -0.8850419654319712, -0.2861218991609708,
        1.260766355201032, -1.2755505638882658, 0.29463275044420484,
        0.9505635286057367, -1.5344140290000805, 1.1106010083212003,
        -0.21470453468327513, 0.15489442374818418, -0.40887488117830817,
        -0.9012650575576385, 0.27643572529289545, -1.2900136974940979,
        0.8681231328463427, 0.15860041996405602, 0.3933826035575821,
        0.879168197045083, -0.30634394447050844, 0.8440646329577499,
        -1.627803581917167,
      ],
      [
        -0.017483705169471068, -0.0810528148476355, 0.0032606036147777057,
        0.23141115409256033, 0.023885615018490527, -0.11189931888953757,
        0.14186092544204382, -0.17354259235641398, 0.2208695653864247,
        -0.5547366259045357, 0.3675783323271406, -0.07545375972244031,
        -0.007587277924383772, 0.026678322859494986, 0.002428038595761977,
        -0.03329160625582769, 0.02699064017281003, 0.009725799258959217,
        -0.03543431047234996, 0.02135854294089895, 0.01663507580727987,
        -0.03602866563608752, 0.014945956022795477, 0.023001486712470414,
        -0.03503181963729749, 0.007713783773032448, 0.02818729913611142,
        -0.032505053034007636, 0.00032034127374564586, 0.0323089323952456,
        -0.028575567567896417, -0.007270344550528902, 0.034862434383242824,
        -0.023363617530077256, -0.014354011113861748, 0.03603873244930788,
        -0.01718240429797218, -0.021004927701159193, 0.03550772516074077,
        -0.010182858437910787, -0.02654082644527789, 0.0335454815212019,
        -0.002822395846557709, -0.031116781112899665, 0.03001259241959418,
        0.004760632686102084, -0.03413391341085286, 0.025259036087462643,
        0.012021764437843491, -0.035858549824265264, 0.019327715489499808,
        0.018885554820850546, -0.03582114106053137, 0.01261026108984711,
        0.024783824955286932, -0.03441066697252406, 0.00530071288663251,
        0.029751939923848614, -0.031311187482231675, -0.0022162044687671157,
        0.03325748139283305, -0.027022987571742974, -0.009643180106777872,
        0.035482775332201434, -0.021383873989949412, -0.01665945146964691,
        0.035977460678467736, -0.014959579290608087, -0.022974326578576173,
        0.034799524828782055, -0.003887429514629508, -0.04626633247266321,
        0.08477536234083063, -0.09218695676531076, 0.07832708300410741,
        -0.05890216054793527, 0.22262590779879776, -0.26771459676815407,
        0.09318557844039757, -0.022098674991799048, -0.02194585243219974,
        0.048454826470739176, -0.046528812589276526, 0.010930668093313058,
      ],
      [
        -5.89411254673137e-5, 0.0007576911747202356, -0.004703687503587935,
        0.018701967841672364, -0.050482426645171385, 0.11465660032057821,
        -0.09328381464240079, 0.02635477888921335, -0.019132151445974577,
        0.009565090708213299, -0.0028551569713744654, 0.0005093647414193596,
        -4.602463079351172e-5, 4.888145346486694e-6, 8.118028450627253e-6,
        3.713513598012396e-6, -4.184638066569601e-6, -8.150380939627482e-6,
        -4.454299636661346e-6, 3.4298174956129937e-6, 8.090624164446211e-6,
        5.146885672533621e-6, -2.6335914801320305e-6, -7.936239203031731e-6,
        -5.776595632290516e-6, 1.8136856073830026e-6, 7.69729270896498e-6,
        6.341912323642813e-6, -9.782177434128963e-7, -7.3803022208037575e-6,
        -6.844205290799489e-6, 1.2725438088160093e-7, 6.980701563354238e-6,
        7.273253366970702e-6, 7.298157305807117e-7, -6.498266809757059e-6,
        -7.61638859306441e-6, -1.5745198773250929e-6, 5.9459180423292545e-6,
        7.873882285379512e-6, 2.396889794309111e-6, -5.334966571985419e-6,
        -8.051234912604092e-6, -3.1969460905346683e-6, 4.664922081683321e-6,
        8.143198882969724e-6, 3.967431415296668e-6, -3.937234371783894e-6,
        -8.140159959516908e-6, -4.691014239870696e-6, 3.166540102759998e-6,
        8.044709096527447e-6, 5.357495354736752e-6, -2.367744831457607e-6,
        -7.866720958288384e-6, -5.968273939828186e-6, 1.5434885899368215e-6,
        7.6063540646684885e-6, 6.519693862755768e-6, -6.957996497443155e-7,
        -7.257474313891791e-6, -6.997283558746588e-6, -1.605412674111594e-7,
        6.824911560461582e-6, 7.3920488320739636e-6, 1.0086823434862869e-6,
        -6.322475118064403e-6, -7.707773526992757e-6, -1.8441856333020426e-6,
        5.755445306512135e-6, 7.945469573325649e-6, 2.6657988818351216e-6,
        -5.120938992322324e-6, -8.094816111736713e-6, -3.460362618841681e-6,
        4.425335151024066e-6, 8.149038078143804e-6, 4.210918354995196e-6,
        -3.6852931445979475e-6, -8.114813238310071e-6, -4.912692940496815e-6,
        2.9102708862869133e-6, 7.998287967905293e-6, 5.566559559868913e-6,
        -2.0998298543779417e-6, -7.793968226974468e-6, -6.162656743301521e-6,
        1.2607141642409197e-6, 7.497731399965362e-6, 6.685665030041191e-6,
        -4.108518322588875e-7, -7.119038556152927e-6, -7.131795268575585e-6,
        -4.37561721791832e-7, 6.66893648136073e-6, 7.505123044056826e-6,
        1.2837252280220022e-6, -6.146736001152048e-6, -7.800401414488519e-6,
        -2.122000475699349e-6, 5.550766833846006e-6, 8.005335743833548e-6,
        2.9350349469607456e-6, -4.892530459038348e-6, -8.118053701175348e-6,
        -3.7095886018593417e-6, 4.187055157432554e-6, 8.146414711970503e-6,
        4.444976816540761e-6, -3.4377696510390047e-6, -8.090526761006297e-6,
        -5.138162119799462e-6, 2.6446845146577823e-6, 7.941944509369815e-6,
        5.774193373641163e-6, -1.820068036111663e-6, -7.701089345275955e-6,
        -6.3404515734084e-6, 9.81455070010718e-7, 7.3795511175594645e-6,
        6.837605783692722e-6, -1.3518329899163775e-7, -6.982834160545698e-6,
        -7.266463704740532e-6, -7.182333826301946e-7, 6.50650227852997e-6,
        7.616003126378049e-6, 1.5673657352395607e-6, -6.674679569366001e-7,
        -6.292423385817562e-5, 0.0002418683075411445, -0.0006651778878494531,
        0.0012861231657992967, -0.0028084311924167693, 0.001412162043073256,
        0.0007083324272126921, 7.954198220506648e-6, -0.00021275716559594903,
        0.00012044352550641034, -4.223948871930247e-5, -1.0326248998469778e-6,
      ],
    ];
    const result = wavedec(data, "sym14");

    const reconstruction = waverec(result, "sym14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym14_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5103141164173748, 0.9405519925018203, 1.2271523197445267,
      1.3357164422101775, 1.2668681871023628, 1.0540633129809764,
      0.7540446948680191, 0.4324132643748335, 0.14793568065883267,
      -0.06054454849371743, -0.1814414770958027, -0.23034931740406034,
      -0.2427904954288978, -0.26184583600794437, -0.32401150675725754,
      -0.4470616264025827, -0.6231682536572308, -0.8191753534760546,
      -0.9840816690041073, -1.0619229977021376, -1.0068273123619433,
      -0.796405266893405, -0.4399913942298025, 0.02051570628905114,
      0.5176565952171154, 0.9717632338331503, 1.3075834197930765,
      1.4702673579120458, 1.4369314322076612, 1.2210690079264948,
      0.8688028353231563, 0.44794231110869526, 0.03253506728591099,
      -0.3133396412071514, -0.5486576731911895, -0.6623638704733112,
      -0.6726315014402012, -0.6189090257546519, -0.5489901156025767,
      -0.504560565086017, -0.5090147881488041, -0.5607134332306916,
      -0.6334312861954713, -0.6838808241434355, -0.6643617954388774,
      -0.5372441005256181, -0.28747993929769045, 0.07020676199783554,
      0.4915001327096641, 0.9102530431061625, 1.2521339224913706,
      1.450963698423319, 1.4638278867545351, 1.2812951229108909,
      0.9302278036033387, 0.4684497976873735, -0.027498602226491337,
      -0.4786227531672126, -0.8199024386547238, -1.0130281495423898,
      -1.0525223141671727, -0.9639702061453889, -0.7950323041816028,
      -0.601672353417978, -0.4331762567911134, -0.31977535888335,
      -0.26596881340307227, -0.25114802797107016, -0.2372390592615043,
      -0.18127204322790247, -0.04951530289232303, 0.170603914480997,
      0.46402445710940926, 0.7888831138226865, 1.0846605410540453,
      1.2857771316178859, 1.3373561608557814, 1.209264226220542,
      0.9048993382852538, 0.46244019653289026, -0.05190912299441146,
      -0.5571965912169272, -0.9744461068904213, -1.242909178916855,
      -1.3320420724877997, -1.2464528007066045, -1.0227796888281657,
      -0.719425309883256, -0.40179046421667564, -0.12670760896154398,
      0.07009649657941042, 0.18050061629903216, 0.22300645560199353,
      0.23473983982741034, 0.2586802951481673, 0.32956367984200047,
      0.4622238703643979, 0.6455027276547433, 0.8434236472258207,
      1.0034540697462428, 1.0698473041679182, 0.9987167260645717,
      0.7709947439512177, 0.3998948527489921, -0.06918412389396444,
      -0.566522763466963, -1.0120062109581236, -1.3318893131754992,
      -1.4744544019735955, -1.4208553795926204, -1.1885930085804777,
      -0.8268441753561796, -0.40483313635815377, 0.0039001567192005204,
      0.3375216093040856, 0.5583868100425129, 0.6590877443910685,
      0.6607990073321546, 0.6045934146384332, 0.5381441220947925,
      0.5013559560937664, 0.5146935959642988, 0.5732454920280878,
      0.6480659318409923, 0.6944517538109631, 0.6650106563089021,
      0.5241190638626131, 0.25996795382873983, -0.10904148429117871,
      -0.535401797379863, -0.9510833865148915, -1.281696529132207,
      -1.462903372462811, -1.455141750862817, -1.2530837957475043,
      -0.8874990426353697, -0.4190178657863267, 0.074754091125764,
      0.5157192850028933, 0.8414671623899028, 1.0173536457606243,
      1.0417229942252335, 0.943220107376754, 0.7710917343092036,
      0.5810844823079493, 0.4205922979332908, 0.3168294267633568,
      0.27098066094737955, 0.25971974053418445, 0.24358375748950262,
      0.1799259998092586, 0.036986483332828, -0.1946832624928821,
      -0.49654947310560626, -0.823838025814186, -1.1144658546645962,
      -1.303097382576591, -1.3369231939827815, -1.189261477986478,
      -0.8675565197975106, -0.4136795763557624, 0.10370143707300233,
      0.6029859999599567, 1.0065187851360706, 1.256524712919887,
      1.326376995576628, 1.224617116444228, 0.9909161318212668,
      0.6851253033125821, 0.3722258761376332, 0.10694266435970401,
      -0.07819929446776791, -0.17851995186380515, -0.21530383022336044,
      -0.22708709474174915, -0.25653642904832086, -0.33645180080226406,
      -0.4786325100121751, -0.6686018447800031, -0.8676781010979379,
      -1.0219882616764593, -1.0762216197870458, -0.9886679582445275,
      -0.7436963226804003, -0.35840793572040375, 0.11839925834769335,
      0.6149332858510512, 1.0508611521569842, 1.3541591768208292,
      1.4763898131581163, 1.4027901168574415, 1.1548007337793917,
      0.7844890223630354, 0.36227481886681956, -0.03903052531462303,
      -0.3600066357085057, -0.5664643997946992, -0.6546082997595449,
      -0.6484797535991972, -0.5905768054257962, -0.5282395325545683,
      -0.4994200585786891, -0.5215661208134199, -0.5865134630041056,
      -0.662717143118138, -0.7042506246099771, -0.664243892882129,
      -0.5092615247230323, -0.23083531941362015, 0.14896096424807836,
      0.5795402562292891, 0.9911833789858185, 1.3096695059263685,
      1.4727075920989734, 1.4442212570598905, 1.2230143640065916,
      0.8436792840459615, 0.369476391050194, -0.12114907173705416,
      -0.5512167222117333, -0.861086733677804, -1.0198440349531404,
      -1.0296066072770655, -0.9219327071143516, -0.7474486780733937,
      -0.5614693768286804, -0.4093282688455015, -0.31514212591673246,
      -0.2768087542987044, -0.26841163331535356, -0.24929328097081277,
      -0.17734147665122219, -0.022941793530854293, 0.22013867190751907,
      0.5299092399546919, 0.8588050476834718, 1.1433750539509118,
      1.3187508805093726, 1.3343855676061738, 1.1671671075256216,
      0.8285971771980684, 0.3641397839748103, -0.15526051563428436,
      -0.6475841751059576, -1.0367128056956847, -1.2679953331967868,
      -1.3187708934306839, -1.2014508576678091, -0.9585796737212577,
      -0.6512424773531376, -0.34378434060679974, -0.08865767285105858,
      0.08488682988900087, 0.17557386743504566,
    ]);
    const expected = [
      [
        1.6116064525475335, 2.255936180081349, 1.9429661434692416,
        -0.27318917318292, 2.505808886433975, 2.296989923407649,
        0.12029904049688289, 1.6092976024022798, 2.503794535375469,
        1.1418283324702379, 0.27440054449150786, 2.7888619131608516,
        1.9559883027030358, -0.7391661371939463, -1.6592954899948307,
        2.9657243916036906, -1.7941563830074818, -0.9020960481820492,
        2.8217448937500063, -2.313872660880582, -0.18508261907821147,
        2.5244984078465564, -2.6913325819441103, 0.5435040359168304,
        2.068883766765158, -2.898071947422698, 1.234000036894334,
        1.4868918233389818, -2.9219707214685933, 1.840600453068362,
        0.8193985948183793, -2.76482221050204, 2.3249596045435554,
        0.11230685337033387, -2.441607816820835, 2.6591224016757953,
        -0.5876258296721227, -1.978312929293459, 2.8252278063966636,
        -1.2240108136662173, -1.460989614812099, 2.986427398600171,
        -2.002574462952261, -0.6148831783709298, -1.9865858289634066,
        -1.0435406256328872, -1.7028228694803615, -1.1285763641126387,
        -1.5204125262354469, -1.9305045540537815, -0.599037127011536,
        -2.0325380628266574, -1.2762198460019323, -1.24220057557915,
        -1.760445717392559,
      ],
      [
        1.6866145553208771, -0.3399832007823482, -0.2629804619399827,
        0.1534191838260871, -2.190431807435055, 0.8073434389266543,
        -0.8078483670198591, 1.040627353877496, 1.4548650628893944,
        -0.7954817097150451, 1.3256820752175387, -1.3637059324121856,
        -0.9285536104335013, 0.6888192322140017, 0.23840602006850695,
        -1.061741766102437, 1.144445423842958, -0.39711913943032895,
        -0.6371556224069487, 1.2011238985872077, -0.881672291819489,
        -0.08756333293754348, 0.9959319443089093, -1.1742213423046732,
        0.4857137025243082, 0.568742397888071, -1.2125917711535326,
        0.9631437886964522, 0.006844904714504747, -0.9861866420906624,
        1.2440907295275083, -0.5746259829264853, -0.5380747243879248,
        1.267031152768581, -1.0556385287216765, 0.043411708461400134,
        1.02202631099475, -1.3349928679346659, 0.6390206036072831,
        0.5750376385474372, -1.4535149695043446, 1.4918669346418592,
        -0.9640121124474513, 0.92202875174931, -0.19866586440815126,
        -2.0026979882784075, 1.598309548142968, -2.1825155995368486,
        1.5206179944317857, -0.20392800311935608, -0.1812122596381632,
        2.3334043276233873, -1.9298594522052475, 1.6786045135967016,
        -1.832308074513492,
      ],
      [
        -0.01653515283701605, -0.08185348557341281, 0.003443844319471835,
        0.23225510919808484, 0.02363369460916992, -0.11141173911511555,
        0.14091289827328035, -0.17262442639034162, 0.22055065138000224,
        -0.5559411155873835, 0.3682333705120399, -0.07550100084454,
        -0.007010099229375212, 0.02561544654967336, 0.0031719428097020962,
        -0.03289723139178879, 0.025620495417534715, 0.010768633104204178,
        -0.034877409711599035, 0.019516441635192557, 0.017848045594057154,
        -0.035099674935087914, 0.01262536897948077, 0.024233153920024727,
        -0.03357891247163924, 0.00489984417981233, 0.029227443748163676,
        -0.030346558276315667, -0.0028557493264410564, 0.032926830945326536,
        -0.025661662568462345, -0.010690405191326427, 0.03483877645647116,
        -0.01960836639129648, -0.017765960472813244, 0.035134069679792844,
        -0.012688302091644907, -0.024181059690880073, 0.03357724665176968,
        -0.005000373580447764, -0.029165530521977272, 0.03041808987917825,
        0.0027817806871461683, -0.03291235473916583, 0.02569329917637485,
        0.010598982388954067, -0.03480731221236161, 0.019706833076991257,
        0.0176972384593617, -0.03516238581476571, 0.012743146538685904,
        0.0241154999596554, -0.033579756333054926, 0.005110121374930535,
        0.02911642182233573, -0.03048661374131407, -0.0027181476656943718,
        0.032885226512470715, -0.025726013224485183, -0.01049618761002968,
        0.03478738903103335, -0.019805559878279675, -0.017640512548024085,
        0.03517961189185296, -0.012795929140851935, -0.024037080644123576,
        0.03359132912285617, -0.005193107684946293, -0.029337777955613695,
        0.03134369258429884, 0.0031992322102106134, -0.04508360226683501,
        0.07330588674927517, -0.08308647975624074, 0.09226246875141585,
        -0.09277652755693346, 0.221194037479646, -0.21430276232999457,
        0.021576348883544906, 0.041632317087418755, -0.05300797758156034,
        0.052280092333318956, -0.04786735379490342, 0.019261649217697133,
      ],
      [
        -5.913463520154834e-5, 0.0007611614582876146, -0.00472290393556049,
        0.018777347814954007, -0.050682156715682374, 0.11510613334381349,
        -0.09364218821211377, 0.026448439465460667, -0.019204842285647263,
        0.00960295580911793, -0.002866590059784337, 0.0005117552732121086,
        -4.622153695996077e-5, 4.633871134752774e-6, 7.882027950461363e-6,
        3.749630150709141e-6, -3.89529673779049e-6, -7.895966580821609e-6,
        -4.506328307012771e-6, 3.1020016134276863e-6, 7.80824415372138e-6,
        5.207743531769433e-6, -2.2651300843292468e-6, -7.6157797545435716e-6,
        -5.836728191231692e-6, 1.405302534631557e-6, 7.329980890211368e-6,
        6.390667285146123e-6, -5.332794458607823e-7, -6.959679619561698e-6,
        -6.871624029654572e-6, -3.5016985666533546e-7, 6.5011407250073655e-6,
        7.26939613680549e-6, 1.2351985781728186e-6, -5.953848154725742e-6,
        -7.5695079693733125e-6, -2.1007281547552115e-6, 5.332274582580064e-6,
        7.771249897396156e-6, 2.933518042083115e-6, -4.651366942138528e-6,
        -7.881957823814779e-6, -3.7328574196040743e-6, 3.912882581410359e-6,
        7.898378199938348e-6, 4.4923092593152445e-6, -3.118089280222153e-6,
        -7.810221108924621e-6, -5.19308117196271e-6, 2.28274722482128e-6,
        7.619252158575171e-6, 5.821723306401343e-6, -1.425982775608729e-6,
        -7.338025222960358e-6, -6.379094165998276e-6, 5.537446561703981e-7,
        6.970613352606016e-6, 6.8639390796897e-6, 3.3229096808291313e-7,
        -6.511517936178796e-6, -7.262146307938081e-6, -1.217363389967435e-6,
        5.96472516265226e-6, 7.562048127137566e-6, 2.0807140331956653e-6,
        -5.34696613347349e-6, -7.767134666419457e-6, -2.9140494772222252e-6,
        4.668915515502435e-6, 7.882388423272779e-6, 3.7169197641938385e-6,
        -3.929525142286836e-6, -7.900025440480503e-6, -4.47795581107977e-6,
        3.1339675008372567e-6, 7.811517275614443e-6, 5.177493318953416e-6,
        -2.3012475896750537e-6, -7.623319857616154e-6, -5.806883890260637e-6,
        1.4469523771589163e-6, 7.346735910480135e-6, 6.368400931309773e-6,
        -5.733452048378657e-7, -6.980949006467971e-6, -6.8561221604982496e-6,
        -3.1481099326792785e-7, 6.521079021210192e-6, 7.253923734504484e-6,
        1.1987074873047851e-6, -5.976029577089186e-6, -7.554522434363988e-6,
        -2.0601892408438686e-6, 5.362457891653892e-6, 7.76389938078859e-6,
        2.895317229245902e-6, -4.686072263733052e-6, -7.882902798808169e-6,
        -3.7015480503722427e-6, 3.945268221810243e-6, 7.900714219331906e-6,
        4.462891919037383e-6, -3.150085917612775e-6, -7.812526391717574e-6,
        -5.1612043301289075e-6, 2.320640941300254e-6, 7.6282239801213614e-6,
        5.792612961656389e-6, -1.4677626616137852e-6, -7.355747989809701e-6,
        -6.358411553184358e-6, 5.92017472442459e-7, 6.990401746727756e-6,
        6.847749352346295e-6, 2.9728908146411327e-7, -6.530154790674155e-6,
        -7.244853865677627e-6, -1.1791147513927684e-6, 5.988085666372316e-6,
        7.547369888318109e-6, 2.039580956377669e-6, -5.378457685815977e-6,
        -7.761471141938692e-6, -2.8774886990643327e-6, 4.702477821070545e-6,
        7.883053273000713e-6, 5.103523182573009e-6, -1.0455798893345868e-5,
        -2.461586330073737e-5, 0.00021793891378250245, -0.0007335232639076319,
        0.0013675976671533162, 0.0009456732524527449, -0.002399755054771084,
        0.0010079828174571303, -0.0005354420819000449, 0.00018495187698520417,
        -3.3970495125189954e-5, -4.857057274616837e-6, 5.742319143899138e-6,
      ],
    ];
    const result = wavedec(data, "sym14");

    const reconstruction = waverec(result, "sym14", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym15", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4948613995671551, 0.9149071665687436, 1.200414477118011,
      1.3183965369508464, 1.2681675417272595, 1.0796448761796327,
      0.8049239147758167, 0.5052428148189072, 0.23651925749546832,
      0.036934081302583244, -0.08050919292507913, -0.1287693729391948,
      -0.14086520429319366, -0.15889843138370274, -0.22085745482968488,
      -0.34859504715449635, -0.5400776276100578, -0.7679457444730304,
      -0.984863186513578, -1.1344457949550466, -1.1651614243696962,
      -1.0438214852855283, -0.7653320853992145, -0.3562308870876153,
      0.1290000166096542, 0.6181361819374102, 1.0356593637516107,
      1.318159947834162, 1.4271594419575504, 1.3564198784353376,
      1.1321058470740195, 0.8058500875902262, 0.44244043181044973,
      0.10509454710680455, -0.15817912483206903, -0.323945831786683,
      -0.396319760005455, -0.40301064081452453, -0.38559589128537763,
      -0.38657365879635935, -0.4365217097302485, -0.5446395167564333,
      -0.6950991380226721, -0.850182801918363, -0.9594945240821959,
      -0.9730117796268403, -0.8547626856880366, -0.5937149539683031,
      -0.20909643531247574, 0.2513171105430841, 0.7197295093521218,
      1.1218069947129499, 1.3920503054893054, 1.487512430057993,
      1.396686226980432, 1.1415126282658057, 0.7720755595668167,
      0.35526660961391426, -0.03989094342107591, -0.35680962241909325,
      -0.5624156328276273, -0.6522322866661443, -0.6484345698935645,
      -0.5915480382759521, -0.5279964261138961, -0.49668721659062237,
      -0.5180260261341278, -0.5881223158419544, -0.6796453741883496,
      -0.7491292220766591, -0.7489131182418438, -0.6407340726312484,
      -0.4075455462938322, -0.06053214593394307, 0.3605698469374977,
      0.7941261139571165, 1.1688206746216605, 1.4186602791247185,
      1.4972878906831304, 1.3882535247347738, 1.1088212202167085,
      0.7064028381191325, 0.24844046929113764, -0.19190571734699557,
      -0.5509363142868524, -0.7869552553791102, -0.8873341129197119,
      -0.8685915939962825, -0.7696680828143942, -0.6402046189089392,
      -0.5268153773336328, -0.4607891092047201, -0.4502627438751121,
      -0.4787774442403201, -0.5105312915694955, -0.5009730174510676,
      -0.4100450149411977, -0.21470740238187747, 0.08247581445967056,
      0.45096689059560796, 0.8368740843514, 1.1736287283671771,
      1.396294915369374, 1.456170551710794, 1.332222133784754,
      1.0366105665024363, 0.612942142824155, 0.12758793579851624,
      -0.3439536970073888, -0.7325146167167749, -0.9889832625640368,
      -1.09318081857871, -1.0559412053779473, -0.9140792171548653,
      -0.7196252395725422, -0.5260548956816412, -0.3749236328229356,
      -0.2861678304922261, -0.2543947577779327, -0.2519843264288076,
      -0.23813213410352804, -0.17148844095375884, -0.023150728434248258,
      0.21333286674992302, 0.5175704023225326, 0.8447953965238015,
      1.1347660764578233, 1.3250711729561857, 1.365708603324323,
      1.2314454430229906, 0.9289518557243599, 0.4969145017779141,
      -0.0010135525453212127, -0.4888755859095438, -0.8938067520101884,
      -1.160637792851717, -1.2623768009264311, -1.2042253028025032,
      -1.020325411398073, -0.7641583034958221, -0.4950062711207214,
      -0.2637931139949599, -0.1017157093740777, -0.014352994179973988,
      0.017433486702702297, 0.030175842176319995, 0.06600463798261214,
      0.15943319019992586, 0.3261203240294207, 0.556522930927682,
      0.8161449044697617, 1.0524600438693072, 1.2069295349035662,
      1.229253288664807, 1.090401942839668, 0.791219502708671,
      0.36441006598559744, -0.13071850833237197, -0.6196602124584213,
      -1.0277037653821373, -1.2950890106928883, -1.388855924321047,
      -1.3086946187635862, -1.0855233914847244, -0.7732389165497899,
      -0.435685611528503, -0.13199556834170523, 0.09620741762295631,
      0.23274552921527092, 0.28818894061562844, 0.29438195621602586,
      0.2937124640918672, 0.3259227738596536, 0.41584845232209106,
      0.5652280338738619, 0.7507107094998573, 0.9286490600748272,
      1.0455748280019506, 1.0518293655959636, 0.9150052209595285,
      0.6298519813105735, 0.2221120781823389, -0.25481292185703086,
      -0.7297527750427073, -1.128026017236156, -1.3868137781660133,
      -1.4681114222887115, -1.366275427586414, -1.1084502215999967,
      -0.7478345141453605, -0.35142707164729897, 0.014825127817120032,
      0.29997466006822904, 0.47787778885854737, 0.5506521537631125,
      0.5451434579533057, 0.5034579303494107, 0.4700495320142191,
      0.47866773926597117, 0.5424767897603455, 0.649851218768924,
      0.7669329125314297, 0.846348249076714, 0.8399415688920567,
      0.7123597700756293, 0.4520726619453455, 0.07699830876901159,
      -0.3668170632845803, -0.8133469738211745, -1.1897896937370063,
      -1.431821439588854, -1.497366048152734, -1.375670299835597,
      -1.0895635416039438, -0.6903779056475299, -0.2467282071022919,
      0.17021465528301188, 0.501519927511031, 0.7119458598742653,
      0.7954597216296784, 0.773694846059837, 0.6879187952018143,
      0.5866426480454885, 0.5120296054395759, 0.48851462492571174,
      0.5164667983570448, 0.572455976271389, 0.6160353344171509,
      0.601324721391298, 0.4904726157205854, 0.26558236600206464,
      -0.06396734474532956, -0.4607786297412242, -0.8656486194044061,
      -1.2094281820173802, -1.4278215115840889, -1.4756758248306034,
      -1.3373893058212958, -1.0309542455603407, -0.6046394176943197,
      -0.1270449273798881, 0.32718075283604814, 0.6926614438236847,
      0.9261289658015769, 1.0138684908757833, 0.9721748035211101,
      0.8409005586536014, 0.6718250309488567, 0.5147899358057004,
      0.4050453713549112, 0.35490661836722465, 0.3517275571583137,
      0.3626171627029267, 0.344647355389592, 0.25793248192845053,
    ]);
    const expected = [
      [
        0.9739308266168734, 2.5912130861065497, 1.9659068744169728,
        0.021868526780228083, 1.108986348700885, 2.5908253740909135,
        1.7964432339949892, -0.30337673210153143, 2.1907218147551344,
        2.206295302843533, 1.3459473514853442, -0.4570440669637779,
        2.906951383596201, 1.942737799483534, 0.7025731230950973,
        -2.487712019578319, 1.6380869045080182, 1.0714915176485371,
        -2.6737935911884323, 1.4684452093205624, 1.2843969497596461,
        -2.6968618463412923, 1.2739431825137377, 1.5176511475995336,
        -2.762651227847441, 1.1297290681654297, 1.7234194218361492,
        -2.8435682603253714, 1.0368600602157534, 1.8737087189651913,
        -2.903229819447606, 0.9743914999053233, 1.960476646566774,
        -2.9100420627227446, 0.9078661844279222, 1.998640587260204,
        -2.8497593176556624, 0.8031991798237427, 2.0197693974501894,
        -2.7301912840865064, 0.6383471125503696, 2.074858550731633,
        -2.661312864337293, 0.4214182639943495, 2.1298861991950497,
        0.5803526612917685, 2.717294704543927, 1.7145937935611526,
        0.792546866533521, 2.2821584018683443, 2.213572081725131,
        0.8100546598808513, 1.7634524415236348, 2.59061038602944,
        1.1699016333626737, 1.0694766350953548, 1.0873010144943789,
      ],
      [
        -1.9286545851142118, 0.4433721729889825, -0.3898904311234337,
        1.729447032189237, -0.882453633443279, -0.49131118320200123,
        -0.529121257832742, 1.2845916956292096, 0.27511599590950836,
        -0.8685824359480923, -0.33558149157679723, -0.23916126773331842,
        1.70989000369524, 0.45062706812553227, -1.447731087573496,
        1.371893672714773, -0.4270965948559806, -0.8135583147422988,
        1.4971052317787543, -1.1549358472074938, 0.03338562847464056,
        1.0898859650942123, -1.4573950706082974, 0.8497477216895151,
        0.29280130980245295, -1.2022503046271935, 1.3059271790089766,
        -0.5775832595827979, -0.4885101788476864, 1.218931887980316,
        -1.1762433607615548, 0.4029655492857864, 0.6213163136407411,
        -1.2660790520960168, 1.1208680764346728, -0.2517297247995974,
        -0.8119608232005173, 1.3827246749467528, -1.055036667063369,
        0.0015559925001670306, 1.103293940925462, -1.5289559753892157,
        1.0467745479852844, -0.18808218682418024, -0.028663142461950075,
        -0.3258127507806097, -0.22189977746153552, 0.01144206356722245,
        0.06397772986108213, -0.042785627618260935, -0.03582587269130787,
        0.2258393195859161, 0.15963347341861645, 0.46612280415460233,
        -0.360947871072949, -0.5371779891952424, 1.2450444633136952,
      ],
      [
        -0.1371966164697238, 0.3959469053446669, -0.5983238898704918,
        0.19368117618798217, -0.1582980760193064, 0.06229290366942962,
        0.01873015252550096, -0.04496752560299809, 0.036505414334186116,
        -0.002028043043626849, 0.3442360573052336, -0.12714233823658694,
        -0.026446653085545217, 0.025685143888847746, 0.0002323108172773175,
        -0.022321743553187143, 0.015513687057831791, 0.01124178787198402,
        -0.024891266842839134, 0.008915728522525, 0.017647325530906557,
        -0.023224935059815478, 0.0011645426450757085, 0.022309046508432382,
        -0.019207341296815787, -0.006762902123226617, 0.024656441120998455,
        -0.013222589358278072, -0.013945006981977674, 0.024540326440714473,
        -0.005903384941524231, -0.01976474486410191, 0.02188057404620334,
        0.0020258319286468813, -0.02351731981376371, 0.01704196715223028,
        0.009741309041169745, -0.02493221900854398, 0.010420601826167825,
        0.016471439865577833, -0.023755504775281554, 0.0027885335044643264,
        0.02152135419498423, -0.020215420524047262, -0.005177889490491142,
        0.02438379248892032, -0.01456522890010366, -0.012565911279960136,
        0.02476434435494621, -0.0074851911835497765, -0.01872768375097048,
        0.022623972697380902, 0.0004078643868602698, -0.022930586095870724,
        0.01818424145123929, 0.008208981959262816, -0.02485419803257388,
        0.011889693969132203, 0.01522426195103378, -0.024194003914965605,
        0.004391503117730601, 0.02064193046107125, -0.02112740131511417,
        -0.003561458344709151, 0.02400659203998541, -0.01585487150929982,
        -0.011141702336283745, 0.024869921637821302, -0.00893576946672005,
        -0.017730332239432343, 0.02244579451655194, 0.006224465255786613,
        -0.03607931866390349, 0.039127224152975905, 0.13371191442743016,
        -0.1625957316309911, 0.22001039787435664, -0.10223310788142406,
        -0.03602832293448763, 0.04356898044172326, -0.09555913168431764,
        -0.008217341574669381, -0.030932832346160715, 0.04045956156822633,
        -0.02387439309160266,
      ],
      [
        -3.256928960895763e-5, 0.00048624360472326075, -0.0033772513548037163,
        0.015011096877748447, -0.04111601970772402, 0.08120088768214842,
        -0.041543483694001855, -0.0033427931649343645, -0.014690221275762297,
        0.010424978818154578, -0.003989505926461095, 0.0011611941219182378,
        -0.0002118280936757775, 2.0325204228062117e-5, 1.3486320847494023e-6,
        -1.5198114460725887e-6, -3.0068762319968026e-6, -1.7606616621864802e-6,
        1.0861951565194392e-6, 2.9460326587056038e-6, 2.128294919789484e-6,
        -6.237754485819688e-7, -2.808717859594289e-6, -2.4406172690567824e-6,
        1.4576618006336323e-7, 2.5993328167242922e-6, 2.6897954416532563e-6,
        3.3499211699179507e-7, -2.324447303438687e-6, -2.870947320836541e-6,
        -8.075826834599394e-7, 1.9901790913383995e-6, 2.9792289424880684e-6,
        1.260468206542689e-6, -1.6039037853232994e-6, -3.0103764056681267e-6,
        -1.6806455201979656e-6, 1.1764650360800788e-6, 2.9638410257584447e-6,
        2.056835073489122e-6, -7.199616168496583e-7, -2.8422987056961448e-6,
        -2.3808284518282323e-6, 2.450941422599414e-7, 2.6485698788250204e-6,
        2.6448116091451405e-6, 2.371063791497861e-7, -2.3861384319868142e-6,
        -2.8405890215765366e-6, -7.132748864573861e-7, 2.062057023952484e-6,
        2.962708415477049e-6, 1.1701225550847285e-6, -1.6860895308197786e-6,
        -3.0094926754682944e-6, -1.5970037760409696e-6, 1.267485968291091e-6,
        2.9801422627691193e-6, 1.9840567158502423e-6, -8.155079475643401e-7,
        -2.873947719662264e-6, -2.3202902494336416e-6, 3.42144872997437e-7,
        2.693271579670517e-6, 2.5960594229797774e-6, 1.39040119933212e-7,
        -2.4442107452404732e-6, -2.8054150948193953e-6, -6.161863591648725e-7,
        2.1334559898143115e-6, 2.9440017568867682e-6, 1.0785082155846371e-6,
        -1.7674833434343778e-6, -3.007131135361697e-6, -1.513669019476633e-6,
        1.3553910106486438e-6, 2.9922150775814837e-6, 1.9091112164284683e-6,
        -9.092175830833739e-7, -2.9008034415454506e-6, -2.255251047367648e-6,
        4.4061529356787626e-7, 2.7361749793625836e-6, 2.544627152549624e-6,
        3.991285825375676e-8, -2.5013497360329188e-6, -2.7692499249372097e-6,
        -5.202501954428665e-7, 2.2014357688687923e-6, 2.921984313438272e-6,
        9.865989565286994e-7, -1.8453325232112774e-6, -2.9995404323297973e-6,
        -1.4268762585651884e-6, 1.4430262642092874e-6, 3.0012989219620517e-6,
        1.8313137522726723e-6, -1.0035713423922987e-6, -2.9265550530593694e-6,
        -2.189656700004038e-6, 5.373856717510035e-7, 2.77587509959488e-6,
        2.4912237698566215e-6, -5.76745241070114e-8, -2.5538152370212183e-6,
        -2.7282372955576105e-6, -4.224833092753544e-7, 2.2673881296779644e-6,
        2.896137518830998e-6, 8.920870175501556e-7, -1.923190648256304e-6,
        -2.9906392053973224e-6, -1.3398733116433088e-6, 1.528728951681684e-6,
        3.0078140441037462e-6, 1.7530633186535244e-6, -1.09487623716913e-6,
        -2.9472521343192416e-6, -2.120356163635493e-6, 6.340243252855884e-7,
        2.812011983953209e-6, 2.4336831913224186e-6, -1.5716149657453698e-7,
        -2.6054830183501794e-6, -2.6857062041635854e-6, -3.2476402075764067e-7,
        2.33144708502518e-6, 2.868618081942014e-6, -1.0740842618619736e-5,
        0.00017927965493850348, -0.0012219247682385874, 0.0052806926751769985,
        -0.014225986769008858, 0.027842417504314196, -0.013659334672038358,
        -0.0020489926968645066, -0.004500489282348849, 0.0033518071723666544,
        -0.0013243096674420366, 0.000408718311201098, -7.684235992403611e-5,
        4.764889417755587e-6,
      ],
    ];
    const result = wavedec(data, "sym15");

    const reconstruction = waverec(result, "sym15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym15_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.513346319541364, 0.944206673173422, 1.2276351052790115,
      1.3295340076115372, 1.2525644534535596, 1.0333512165297254,
      0.7318540508340775, 0.41572088657246153, 0.14365421446606802,
      -0.04799733863150818, -0.15210542245642894, -0.1895061417415539,
      -0.20017024817357865, -0.22931890984676967, -0.31231126187411884,
      -0.46243614970395314, -0.6649683920972549, -0.8791994604419626,
      -1.0480500452026082, -1.1128607793867427, -1.029557938319982,
      -0.7819672664261856, -0.3887150270671683, 0.09825500087413691,
      0.6034100565281946, 1.0433719099262675, 1.344905237699059,
      1.4607881291313274, 1.379709497644154, 1.1278183051410144,
      0.7616265859684062, 0.35411445447641554, -0.022444417617366985,
      -0.31264682446248565, -0.48914344114438846, -0.5561964274148634,
      -0.5449527395847384, -0.5019115827661202, -0.4738027767867073,
      -0.4929874264875222, -0.5673157165237472, -0.6771772882646078,
      -0.7805691221874607, -0.8248787993463906, -0.7622879795908325,
      -0.5647068027490464, -0.23421438538985623, 0.1939087810246946,
      0.6565955942448503, 1.0757326295086829, 1.3752115821979456,
      1.4981390174271936, 1.419961645644037, 1.1542496308346288,
      0.7496929055095092, 0.27904560696867053, -0.1772519939570847,
      -0.5487424213084925, -0.7895981003619676, -0.8867425634497377,
      -0.8596301323280031, -0.7520027942317334, -0.6179763769767803,
      -0.5062210202028188, -0.4464341396461234, -0.4416506012820608,
      -0.4683670096569314, -0.48438201735937425, -0.4422095728054465,
      -0.3044361845718664, -0.05685168200758439, 0.28427239455243364,
      0.6728894383275699, 1.0419426281616806, 1.318164243127785,
      1.4392911782168287, 1.3693985260130455, 1.1084665812574133,
      0.6937025463367279, 0.19218147328317978, -0.3134670405017643,
      -0.742868747357011, -1.034893269785071, -1.1597316906036819,
      -1.1232309247722005, -0.962616534918763, -0.7349043767767132,
      -0.5011218658614229, -0.31046903850917273, -0.1884939456593701,
      -0.1322557450870554, -0.11358972137635982, -0.08945292570673971,
      -0.016468929147191558, 0.13431451180875587, 0.366505011727929,
      0.6543385644696254, 0.9468060259125675, 1.1790571698119652,
      1.2882816714176062, 1.230050552041906, 0.9909113938573617,
      0.5939200698261164, 0.09553803033735656, -0.42551558182719196,
      -0.8848434146889957, -1.2103951687486876, -1.3575829188240032,
      -1.3178579955046814, -1.1187602161462713, -0.815584096288356,
      -0.4768918945956439, -0.1676100891750471, 0.06600691445200768,
      0.2058093506467949, 0.26334092095742906, 0.2734014961232224,
      0.28148918155656405, 0.3286079042520001, 0.4375940895944083,
      0.6046996427589266, 0.7987770393352702, 0.9684057732073911,
      1.0551963199404089, 1.0098522125431388, 0.806792472770493,
      0.4534402580243631, -0.008403856353216693, -0.5096964877224438,
      -0.9682278804776121, -1.3062976561342277, -1.4677082478715446,
      -1.4299345278690436, -1.2085141665718877, -0.8526348609503022,
      -0.43308117199418106, -0.025589936272470692, 0.3062291508733874,
      0.5242009869801574, 0.6219293660946572, 0.6228044480988417,
      0.5704507958397701, 0.5143256150841089, 0.4943953016900367,
      0.5290125745812343, 0.6092396667516776, 0.7011441612563672,
      0.7554786021166192, 0.7221905322294909, 0.5659049580359236,
      0.27821572903203806, -0.11660160634556804, -0.5641811118839877,
      -0.9905642574489599, -1.318165558562731, -1.4833330752639633,
      -1.4511731258915013, -1.223948507426299, -0.8409375044030123,
      -0.36975759823687493, 0.1087242181886788, 0.5181910590720716,
      0.8030379527016319, 0.9390025422971557, 0.935805532951005,
      0.831386749447557, 0.6794545575191588, 0.5337403194869794,
      0.4331393520952836, 0.3916270956085658, 0.39554374493755007,
      0.4088797581255943, 0.38507637833796415, 0.2821275328438324,
      0.07687934658936485, -0.2253975740366666, -0.5888838694220084,
      -0.9533348299461607, -1.2471063010092152, -1.4039214268672324,
      -1.379197530136617, -1.161796470686688, -0.7781627141005835,
      -0.2876941651300412, 0.22962537599542276, 0.6903716326784144,
      1.0254545059593092, 1.1942305726336513, 1.1915999065224752,
      1.0465118400217321, 0.8124683623190734, 0.5526119239205955,
      0.32330820021186896, 0.16044924751698142, 0.07193295208182748,
      0.0381232896750191, 0.019991005441400173, -0.027380191000240583,
      -0.1396411775285944, -0.33053005679361525, -0.5852295120266485,
      -0.8616607902860037, -1.0995664448087754, -1.235178601231207,
      -1.2177697522269348, -1.02382837493417, -0.6651394977199004,
      -0.1885480610354322, 0.3327386605903154, 0.8143230368652521,
      1.178638048638497, 1.3714629465235304, 1.3729471477187278,
      1.2005275184178086, 0.9031506007747595, 0.5483768985806956,
      0.20569855769098544, -0.06969985048763011, -0.2486901970719058,
      -0.3326235386633071, -0.3495164458905283, -0.3432330603164727,
      -0.3587029167628545, -0.4272235706929817, -0.5558490575652881,
      -0.7237744195047264, -0.8867757697957172, -0.988633272492943,
      -0.9766024697935883, -0.8168901726882941, -0.5060242275970772,
      -0.07500385867607412, 0.41507266109960705, 0.8850445543175182,
      1.2545699417229015, 1.4597750352531567, 1.4673630986224522,
      1.281732662878594, 0.9433843126861735, 0.5190586394509551,
      0.08609527110262677, -0.28508527160484853, -0.5460555882070569,
      -0.6793657337290127, -0.6993865566185947, -0.6450623119240002,
      -0.566691967076026, -0.5103652580439104, -0.5042392369958681,
      -0.5503133539473217, -0.6238854104640579, -0.6808301611267399,
      -0.670765262871464, -0.5525934006571035,
    ]);
    const expected = [
      [
        0.48783855823420824, 2.710383776664814, 1.9063815708661225,
        -0.21610394936287244, 0.9483959509233846, 2.6467273922129775,
        1.6744042675651511, -0.4671246560780272, 2.0827353983445818,
        2.267860480416859, 1.1440592627119013, -0.6619412204917009,
        2.8684670766912617, 1.9271201796704662, 0.4897975372147681,
        -2.4148404101125243, 2.232397281870135, 0.050681784578899415,
        -2.3312032987539224, 2.603789490591861, -0.6249866976169512,
        -1.892622109342242, 2.771041787041772, -1.2518891629829225,
        -1.3487765675509173, 2.7805381707168224, -1.8059480403390662,
        -0.7299397693720454, 2.632257120600535, -2.2560064710153225,
        -0.07143764267792801, 2.335124029156775, -2.5769065966462628,
        0.5892957513759148, 1.9064541691568802, -2.7508959699376025,
        1.2148449898187843, 1.3709026332008618, -2.7681787824991586,
        1.7676065189058565, 0.7661451912883582, -2.6601913950236633,
        2.369666150130083, -0.016253707273110797, -2.3820002507678546,
        -1.3618036735062975, -1.2201110618634314, -1.4784041006786748,
        -1.8416786792086524, -1.6187644629935956, -1.7059880338071851,
        -1.7100716579941733, -1.5947381769386615, -1.001733902466289,
        -2.0375993760132687, -1.4238531773250975, -0.5519731899243953,
      ],
      [
        -2.0064871618346727, 0.3725329036354938, -0.3148340031461554,
        1.7138049753499194, -0.8335085745084002, -0.5944672961226716,
        -0.49888746387395216, 1.3174718231339682, 0.29592219109092976,
        -0.8920671176993751, -0.3935997301875254, -0.16010827134020034,
        1.6866028567828197, 0.6513454970821562, -1.5345047310278892,
        1.0244201730921385, 0.2702438828137068, -1.3288533315732058,
        1.2618115724395893, -0.12573955478152757, -1.120477328319374,
        1.424215963982459, -0.5260708986275558, -0.8190433152529139,
        1.4763942763087332, -0.8887235647651636, -0.451283333443724,
        1.4139896906968628, -1.1851247887980572, -0.045426918517003034,
        1.2410674966917798, -1.3917052591247983, 0.3671562262068823,
        0.9703454145094758, -1.4917666451794678, 0.7543875578978736,
        0.622241553348686, -1.4767247850983987, 1.0848718704245837,
        0.2314112899987438, -1.385620218276527, 1.487099468599562,
        -0.6340539051517151, 0.03073001544598968, -0.19869117234279302,
        0.8566412861006839, 0.175845184756741, -0.05966638722379535,
        -0.06744910091471185, -0.02044255171250233, 0.21870710706979726,
        -0.2956832105657126, -0.5592030600603346, -0.413149281730959,
        0.690635727847818, -0.04445526775014188, -0.987538245035403,
      ],
      [
        -0.1503650130862896, 0.425626233432468, -0.6375987912292684,
        0.215030154027176, -0.1793674610553967, 0.08103248142411835,
        0.014329411127510112, -0.05167107355026834, 0.04075021929551121,
        -0.004724565258487763, 0.36193075279882736, -0.13254150177445062,
        -0.03357521718679145, 0.036815400974485844, -0.006855052746538279,
        -0.026606352577029948, 0.028912918789912784, 0.0016263983490518742,
        -0.030690129815222768, 0.026516503614083472, 0.006304886401733741,
        -0.032319017888275584, 0.02339253258819863, 0.010903228155858822,
        -0.033388386964089294, 0.019695263067010717, 0.015264393259197555,
        -0.0337072403322542, 0.015715054089082976, 0.019331931586599693,
        -0.033458882542469655, 0.011324477641131887, 0.023023408204364226,
        -0.032444072263997904, 0.006802234720824457, 0.026240274005082963,
        -0.03089863222446117, 0.002062594786333782, 0.028971891488512112,
        -0.028628790150269375, -0.002645083057233561, 0.03108481099351121,
        -0.025909029331954245, -0.007361893943018431, 0.03264217892845247,
        -0.02256141170464182, -0.011884047814121288, 0.03348441313437113,
        -0.01888248432569138, -0.01620768650935122, 0.03374575702575615,
        -0.014719103130679562, -0.02018821279422477, 0.03325024722452712,
        -0.01037156367812973, -0.02377897621476619, 0.032195945214275996,
        -0.0057186527541225095, -0.026904658356494873, 0.03040063362203933,
        -0.0010455355884423027, -0.02948018048779594, 0.028114706523576585,
        0.0037320378003946946, -0.031505328086375205, 0.025159627168844543,
        0.008361246287316914, -0.032827250642775946, 0.0214702457542203,
        0.014929729579492857, -0.04102969825163072, 0.04132245848446021,
        -0.0412841705971415, 0.1253848895188794, -0.22517268461923476,
        0.1647381176802932, -0.2863867774335941, 0.1632154104217637,
        -0.018696845494022524, 0.04858455737092106, 0.1300677784706617,
        -0.10616017143070923, 0.06206697447546646, -0.05471296830083155,
        0.016381112716806107,
      ],
      [
        -3.5151269048041485e-5, 0.0005024759234705249, -0.0035038857973956803,
        0.015601901098867561, -0.042777020030465955, 0.084538491547653,
        -0.043371636639209454, -0.0032962139533395064, -0.01540227602540633,
        0.010894954555496406, -0.004161758766141556, 0.0012075086598510975,
        -0.00021823267417854595, 2.2262541352691388e-5, 1.0848852083996595e-6,
        -3.1999147115689327e-6, -4.413951771895653e-6, -1.3917801425163269e-6,
        2.966612577121271e-6, 4.478745067946542e-6, 1.6933973722670068e-6,
        -2.716678637947106e-6, -4.519638752206465e-6, -1.9856054703410432e-6,
        2.4533298364523623e-6, 4.537181582331411e-6, 2.2662639590381402e-6,
        -2.179809804726237e-6, -4.533914341369539e-6, -2.5365413236790674e-6,
        1.895722650862651e-6, 4.509416468843477e-6, 2.796101938086574e-6,
        -1.6003230504503172e-6, -4.461129343545683e-6, -3.0412252777091045e-6,
        1.2965634121207033e-6, 4.3894079639048235e-6, 3.269406472901304e-6,
        -9.882747836169534e-7, -4.297300723853771e-6, -3.4817992007689076e-6,
        6.757689780375929e-7, 4.185469175560862e-6, 3.6789185606982644e-6,
        -3.581177529981106e-7, -4.05179735903898e-6, -3.857694707242701e-6,
        3.780912094184889e-8, 3.89642113190358e-6, 4.015427354098712e-6,
        2.809892555063004e-7, -3.722715145467465e-6, -4.153214110029627e-6,
        -5.973086768600592e-7, 3.5323755026365026e-6, 4.2724142296272506e-6,
        9.122409269201725e-7, -3.323837459879556e-6, -4.370804561294211e-6,
        -1.2239381742265009e-6, 3.0969956519016765e-6, 4.445662380066585e-6,
        1.52816790333974e-6, -2.8553420999642394e-6, -4.497983616521269e-6,
        -1.8233938800347305e-6, 2.6014922046632875e-6, 4.5299090286685315e-6,
        2.1108431672786575e-6, -2.3345011888584297e-6, -4.540201573818454e-6,
        -2.389447114086583e-6, 2.0540060863152614e-6, 4.526281740755594e-6,
        2.6551828975497673e-6, -1.763393052802821e-6, -4.488995075904298e-6,
        -2.9060668848546475e-6, 1.4660218926311651e-6, 4.4311475004002575e-6,
        3.1434231354410484e-6, -1.1615943824874532e-6, -4.35256195551793e-6,
        -3.3670539215633603e-6, 8.494820278789129e-7, 4.2509502239194526e-6,
        3.5734051182593527e-6, -5.327421454075676e-7, -4.126957804794728e-6,
        -3.760187170593899e-6, 2.1525638977440364e-7, 3.983891892752458e-6,
        3.9287726394503445e-6, 1.0264179952939155e-7, -3.822639373857592e-6,
        -4.0798713966856585e-6, -4.218432722066525e-7, 3.641325195986501e-6,
        4.210624467811652e-6, 7.398271860636395e-7, -3.4403471122354816e-6,
        -4.318588940022515e-6, -1.0524451190016697e-6, 3.2233120112393814e-6,
        4.405127693217173e-6, 1.3587850001849685e-6, -2.9921047560899426e-6,
        -4.471835848525122e-6, -1.6599833602369795e-6, 2.745353022659109e-6,
        4.516728636024191e-6, 1.954233676238592e-6, -2.483164794866512e-6,
        -4.537362979398018e-6, -2.237391141329809e-6, 2.209219512132821e-6,
        4.535025989051749e-6, 2.508050526596356e-6, -1.9262694523874975e-6,
        -4.512116457615934e-6, -2.7675621763527185e-6, 1.633498404810665e-6,
        4.467644050816882e-6, 3.0149690442370077e-6, -1.330691913519916e-6,
        -4.399309474507204e-6, 3.7568404435027357e-6, -7.975754140322103e-5,
        0.00048642578203983905, -0.0018127647473859321, 0.006418927033594156,
        -0.017565350155741014, 0.0499733129539443, -0.047475592496822636,
        0.01483506377846239, -0.006733482947818703, 0.0022114639084626136,
        -0.00021710197993626438, -6.840014115170012e-5, 2.3428665641753668e-5,
        1.8198315064637544e-6,
      ],
    ];
    const result = wavedec(data, "sym15");

    const reconstruction = waverec(result, "sym15", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym16", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5100222669964944, 0.9380985582110025, 1.2198391679027183,
      1.3217042173598097, 1.2468497371964382, 1.0322215781303838,
      0.7377937756357346, 0.43080814009998125, 0.1690911435290527,
      -0.012306130963008255, -0.10781792478873589, -0.13986291707294296,
      -0.14972764643951728, -0.18341727655544715, -0.2763635200248413,
      -0.4411683203653156, -0.6617588007910566, -0.8956420949795896,
      -1.083814401786977, -1.1658493341632705, -1.0962924330683124,
      -0.858085796674112, -0.469447507426272, 0.017740736758310977,
      0.5278425239292176, 0.9773695884201354, 1.2930432081114966,
      1.4276138139153973, 1.369587465665272, 1.1445315311457307,
      0.8077416388064176, 0.4302093284039237, 0.08148472411056479,
      -0.18623962664792, -0.34887226111719316, -0.4134226487924691,
      -0.41271416810230444, -0.39341816950060093, -0.4007371226211135,
      -0.46391135950368056, -0.5864803614858263, -0.7439607814975535,
      -0.889638930429867, -0.9670244278638098, -0.9257317407671068,
      -0.7366098199471901, -0.40207497947705356, 0.04121197338150634,
      0.5282480430247156, 0.9789038970977271, 1.3153052818256996,
      1.4791413821061175, 1.444644117757317, 1.2240452766298642,
      0.864191913984787, 0.43520725722061127, 0.014061853519525658,
      -0.33283566921784036, -0.5637224994429717, -0.6688328888397198,
      -0.6693685687645397, -0.608605740200118, -0.5376705719604891,
      -0.4998612296791669, -0.5177278061953845, -0.586359313854528,
      -0.6746688759408148, -0.7343451056097712, -0.7140999796011918,
      -0.5754199140701766, -0.30558763000926925, 0.07559559607230582,
      0.5173619231096447, 0.947656801880599, 1.2886989144033094,
      1.474631676514966, 1.4668958795227849, 1.2634827254134846,
      0.8997356133729868, 0.44047418551610773, -0.03462103018190732,
      -0.4487523447454922, -0.744511139716552, -0.895134309701379,
      -0.90786715465814, -0.8188192947870535, -0.680870287275239,
      -0.5479348227998633, -0.45978536130461434, -0.43142797090288504,
      -0.44979111172774644, -0.4785395855330837, -0.46967233367672584,
      -0.37876145578200937, -0.17970790585100077, 0.1250174986642854,
      0.5015325821614526, 0.8900805039820607, 1.2177478475629657,
      1.4152833411996029, 1.4338309884324727, 1.257352291031007,
      0.9075539270998765, 0.4399966614187666, -0.06773479453569081,
      -0.5329348605196778, -0.8856249016330678, -1.083001244255513,
      -1.1170220031563285, -1.0134262620224106, -0.8226553574465039,
      -0.6051859284601648, -0.415166586621733, -0.2866230913186686,
      -0.2257693868154948, -0.21132560071601358, -0.2026245133138336,
      -0.15323434739772393, -0.026369616135821505, 0.19211975364425926,
      0.4867723868701391, 0.8135842051753275, 1.1090546573574442,
      1.3050466462937063, 1.34574457672426, 1.2023908820797167,
      0.8819849514487934, 0.42761493738151835, -0.08981499650285377,
      -0.586535449448626, -0.9839310360010631, -1.2252467947260135,
      -1.2869370653093277, -1.1819707152919192, -0.9544391831842475,
      -0.6670003941338833, -0.38447359433073475, -0.15782369893898762,
      -0.012606142221978034, 0.05526763818503741, 0.07552219544579872,
      0.09250899738494572, 0.15026685368803377, 0.27774501049678385,
      0.4782343840478928, 0.7259471097081993, 0.9708075056312606,
      1.150354056162077, 1.205762041351096, 1.0978702625466072,
      0.8190272254455162, 0.397584430668074, -0.10629869031007042,
      -0.6126805788556836, -1.0388481072828992, -1.3171916395476992,
      -1.4095912491681515, -1.3148295258146017, -1.067295715247116,
      -0.7274291780335979, -0.366410028056135, -0.04901632900167263,
      0.1810276697782382, 0.3095885015668416, 0.35254400446273076,
      0.34820865117929395, 0.34396029923426064, 0.38075783708458927,
      0.47976563337715744, 0.6347264898188101, 0.8121998949414162,
      0.9597021543035216, 1.0196883647111337, 0.9457468491794043,
      0.7167428400934874, 0.3451174769026018, -0.12299593369272874,
      -0.6161049045261588, -1.0522495634993625, -1.3568738841318884,
      -1.4793104399361998, -1.4038323020339771, -1.1525717887021596,
      -0.7796359865416873, -0.3579457057212183, 0.03787218594703434,
      0.34825805573732893, 0.5410185706149554, 0.6162047845203826,
      0.6025577908812562, 0.5466884783321352, 0.4980179874781666,
      0.49356997339453124, 0.5467028807374196, 0.6428038073734339,
      0.7431132102369192, 0.7956923543076335, 0.7506424159577979,
      0.5755295038997421, 0.26686478761493077, -0.14553584177246226,
      -0.6026805418157504, -1.0282097551281804, -1.3450879618007592,
      -1.4930976746284585, -1.4428033014893094, -1.2025033727396903,
      -0.8164277853768773, -0.3546199080014433, 0.10298480548172256,
      0.48433954176306354, 0.7405528574378875, 0.8549490588736175,
      0.8438434898788427, 0.7490841086850148, 0.6245097548166931,
      0.5200050748914262, 0.4674014282708339, 0.47193932380465936,
      0.5115124939762271, 0.5438457259953876, 0.5196544897362951,
      0.3982397423083483, 0.16130005771308553, -0.1788287880749131,
      -0.5788773117741811, -0.9726126770533988, -1.2852520244195704,
      -1.4508000355844026, -1.427988397289615, -1.210792784516169,
      -0.8308302775151255, -0.35096030722269456, 0.14838925509529055,
      0.5868330860733889, 0.9012679297999873, 1.0585533353556864,
      1.0606265306068083, 0.9409795806654767, 0.7536204050015576,
      0.5575289080368107, 0.4007226598532141, 0.30808356552383015,
      0.2760627953568802, 0.275546577939212, 0.26200667515040027,
      0.19013577581212565, 0.02897779991651267, -0.22658515719637656,
      -0.551194175553319, -0.8926528603402275, -1.1831146874349898,
      -1.3551016235361755, -1.3583376145086852, -1.1731061181379105,
    ]);
    const expected = [
      [
        0.6598078878116179, 2.4138725167847115, 2.1427170751699256,
        -0.15881068768236475, 0.5330878472401028, 2.5894959014398995,
        2.029489953079225, -0.3934982620171619, 1.1331018519575295,
        2.427294896204689, 1.9852140297906098, -0.8338448618305114,
        1.5809682700009648, 2.3894572300171024, 1.8754352491012103,
        -1.7142771302799584, -0.4644682841985653, 2.550711526288382,
        -2.401272770475876, 0.08092155059967991, 2.311923628418897,
        -2.5889748032373894, 0.4928338166901277, 2.059430178851716,
        -2.7290114073187253, 0.8983779071654211, 1.7595145783098827,
        -2.810269229631557, 1.2876758967095874, 1.4181062231712167,
        -2.8300252008264417, 1.6518029116624744, 1.0421969831627267,
        -2.7868880974841903, 1.982169007598493, 0.6397649084838966,
        -2.6808925019019876, 2.2707441913670907, 0.21968177638973277,
        -2.5138728599386884, 2.510724159820411, -0.20842004594358485,
        -2.2928262099460133, 2.7269561077811324, -0.3984439139946626,
        -3.644702598758102, -0.4315559153840528, 1.308013411339589,
        -1.8552036148183468, -3.3135732835094256, 1.1596064963068498,
        1.4949766720814943, -1.1374255727913989, -3.600695029119978,
        0.6036730673216768, 0.8734944424315223, -2.8968929169042443,
        -2.2732188447984836, 1.877719129633446,
      ],
      [
        0.44293255695887584, -1.865345433315296, -0.030370687115110973,
        -0.03237969967769864, 1.5185639465496192, -1.2300887508420184,
        -0.3672887266589183, -0.25782903348691794, 1.626988494409003,
        -0.5795932235495501, -0.5458242532467176, -0.5075950024580675,
        1.4820756292965112, 0.7017899034308636, -0.6098975954841883,
        -0.8060466968326391, 1.5244232440433068, -1.0345677966188604,
        -0.2813488644695642, 1.3330397933941873, -1.2391757124940586,
        0.09063442556350634, 1.1274842225767034, -1.3783289057879564,
        0.4552899779212991, 0.8485038705126037, -1.4220662021497195,
        0.7832599871076081, 0.5164044401865625, -1.368293640258072,
        1.0524201926498362, 0.15445425524781914, -1.2216130206512612,
        1.2448119260398043, -0.21214550423420034, -0.9930048344845533,
        1.3478656725467015, -0.5580108622229049, -0.6989607619838318,
        1.3547472205683364, -0.8581130966461272, -0.3624815867763844,
        1.2561767423004935, -1.1302779866713788, 0.026248315609104768,
        -0.40869882479551295, -0.1110787091730989, 0.3327439492653913,
        -0.28618006641349986, 0.30869798278675276, -0.1399021270208808,
        0.04790667356046118, -0.15116599734134303, 0.18536430440493207,
        -0.4402747913306881, 0.6823129779181697, -0.25883120901332407,
        0.8653590036274079, 0.17172912028331783,
      ],
      [
        0.053916311039767455, -0.1763481551052279, 0.46662357876632055,
        -0.6013827771380712, 0.21686224953208155, -0.1502651820183389,
        0.1028014832318489, -0.05072574461871206, 0.05966766924613092,
        -0.17965578514641264, 0.43223608784176165, -0.15283430540128126,
        0.02995504669501356, -0.08166478161026779, 0.03227757159782222,
        0.014500904572980719, -0.02294466959254768, -0.0011895605643950974,
        0.026020173718519335, -0.023096519802984435, -0.004671968738915919,
        0.027402598996551664, -0.020643050574281542, -0.008363575026895291,
        0.028371153670794867, -0.017800363410929488, -0.011928202990987524,
        0.028800053139789245, -0.014677102876892683, -0.015264834772941648,
        0.028778120606459092, -0.01127459028901591, -0.01836137150259573,
        0.02820918178306152, -0.0076984521847246, -0.021112243632632356,
        0.027199424184949843, -0.003970400224065212, -0.02352758307307436,
        0.025670776107398135, -0.0001886815004511484, -0.025502150219461193,
        0.02374401533676887, 0.0036080014055535473, -0.027070337422217136,
        0.021360049240599723, 0.007333973557726307, -0.028131506235091516,
        0.0186503612426504, 0.010937479503667363, -0.028745174894689543,
        0.015574550123845392, 0.014350391148903444, -0.02881878388821445,
        0.012269987061730514, 0.01751207727149061, -0.02843654753302233,
        0.008713626410989822, 0.02037639058693161, -0.027516505898631388,
        0.005043214784958274, 0.02287793864263042, -0.02616579302486583,
        0.0012508610787647224, 0.024996149141558593, -0.024314509230313055,
        -0.002531313578177978, 0.026664029422645973, -0.02209764224328452,
        -0.00602306927560408, 0.0252880800394918, -0.006427469953093259,
        -0.05916958862747395, 0.14122532533259152, -0.2877090645541137,
        0.06510734514328677, 0.027328652859193538, 0.020302249022114298,
        0.08122036366465883, -0.15928425481015665, 0.1533507237843831,
        -0.299351748888497, 0.37265610130839666, -0.11937155043633704,
        0.09440746461754963, -0.04944536570872367, 0.0003762902550736618,
      ],
      [
        1.4044063970879964e-5, -0.00020618657401162528, 0.0014922529560972753,
        -0.006711444742379211, 0.021997376086726403, -0.052647562882143055,
        0.11376943069121552, -0.09005168711883972, 0.022879913883006007,
        -0.01804487503069325, 0.010571086927998704, -0.0038963470557515706,
        0.0009709345674569204, -0.00015089040123542185, 1.2099753675868382e-5,
        2.1985796935662597e-6, 7.915536616775574e-7, -1.3772683515884503e-6,
        -2.2209910252456323e-6, -9.277129764967049e-7, 1.258233284442023e-6,
        2.2335742631215e-6, 1.059874671274035e-6, -1.1335010244056103e-6,
        -2.2360833966033864e-6, -1.1870145330409184e-6, 1.0041966368825106e-6,
        2.2290608936973414e-6, 1.3089485686953423e-6, -8.708024755025692e-7,
        -2.2127697305955145e-6, -1.4256262123181229e-6, 7.333071859559298e-7,
        2.1867444694322117e-6, 1.5362094914007466e-6, -5.923417706353911e-7,
        -2.150825677520073e-6, -1.6397158662487671e-6, 4.4911010040047153e-7,
        2.105685011561715e-6, 1.735991002427706e-6, -3.0424270852775055e-7,
        -2.051828865199878e-6, -1.8251421308881092e-6, 1.5777612153121003e-7,
        1.9889980055758844e-6, 1.9065269612099885e-6, -1.0292336809366529e-8,
        -1.9171177390628104e-6, -1.979248745833714e-6, -1.3698115287600523e-7,
        1.8369668726514008e-6, 2.043207340757544e-6, 2.8330870695288954e-7,
        -1.7492748952333072e-6, -2.0986851003869734e-6, -4.28636332135029e-7,
        1.6539834405290227e-6, 2.145267693863994e-6, 5.724737028967293e-7,
        -1.5510913732425962e-6, -2.182180441024313e-6, -7.136267249895693e-7,
        1.441452887459998e-6, 2.2093944520760587e-6, 8.513008744711326e-7,
        -1.3259882128290349e-6, -2.2273740734543077e-6, -9.854557556664712e-7,
        1.2048232149872317e-6, 2.235953359962931e-6, 1.1157331612833508e-6,
        -1.078010868037032e-6, -2.2345061923231227e-6, -1.2410279610129333e-6,
        9.464410043267504e-7, 2.2230830862872037e-6, 1.3605329676510818e-6,
        -8.111820506080137e-7, -2.202325789805674e-6, -1.4742504134730112e-6,
        6.725177427448894e-7, 2.1723240451453824e-6, 1.581989467032838e-6,
        -5.30529249397623e-7, -2.1326157593493666e-6, -1.6827847799701887e-6,
        3.860966400908615e-7, 2.083329457098707e-6, 1.7758598018950694e-6,
        -2.4038623893420503e-7, -2.025267895208278e-6, -1.861283766303639e-6,
        9.380580889912521e-8, 1.9587702929143306e-6, 1.939060634507942e-6,
        5.356541040736424e-8, -1.8835425716531062e-6, -2.0084079706224833e-6,
        -2.0090539334261004e-7, 1.799780359404291e-6, 2.068617516833027e-6,
        3.4700498743288445e-7, -1.7084197444363309e-6, -2.1198429594923723e-6,
        -4.913711041575925e-7, 1.6100301221260474e-6, 2.1623004484662014e-6,
        6.339581321601054e-7, -1.5044783066426096e-6, -2.195423515359581e-6,
        -7.740501846199905e-7, 1.3920073395372425e-6, 2.218601826953389e-6,
        9.104519074296034e-7, -1.2736490356769607e-6, -2.232082515443467e-6,
        -1.042625512991742e-6, 1.150171840920829e-6, 2.2362996054613977e-6,
        1.1705895299166835e-6, -1.021586237535388e-6, -2.230923701444663e-6,
        -1.2937790409409719e-6, 8.881558406605757e-7, 2.215462541603986e-6,
        1.4110672719041955e-6, -7.509625650947609e-7, -1.1252080295018457e-5,
        0.00014218985705078766, -0.001042784544192827, 0.004673706264878142,
        -0.015280024737855077, 0.03652986914196515, -0.07896334776465597,
        0.062409386664481904, -0.015721117489570058, 0.012458289629785329,
        -0.007322477560591505, 0.002708797515386572, -0.0006783119678105419,
        0.00010331442765992286, -9.518632159405309e-6,
      ],
    ];
    const result = wavedec(data, "sym16");

    const reconstruction = waverec(result, "sym16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym16_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5135455561792504, 0.9439335053044864, 1.2258971906818916,
      1.3255870283898432, 1.2464770813390282, 1.0263317478215328,
      0.7261730784970872, 0.41419538003801326, 0.14881075901626167,
      -0.034837831203837266, -0.13152497220374784, -0.16421062114403723,
      -0.17460051925281814, -0.2086967883157098, -0.3013442364695853,
      -0.46402992143390853, -0.6793250314961686, -0.9035958096498444,
      -1.0774132478601202, -1.1410322712184982, -1.050927763097213,
      -0.7930302210569293, -0.3890924191148116, 0.10565909224818287,
      0.6132191708702315, 1.0493407286867047, 1.3418999738617383,
      1.4465886692641479, 1.3560896269050837, 1.1005282352825836,
      0.7391883292768099, 0.34567158238506196, -0.009695988851940951,
      -0.2757639258211134, -0.43081706204227793, -0.4847573815850491,
      -0.4728940850597264, -0.4432146867405956, -0.4406927182176557,
      -0.4929312619024626, -0.6010553506862457, -0.738353129803538,
      -0.8570952419723561, -0.9017746614888373, -0.8252762974257022,
      -0.6036607195612593, -0.24554766981484344, 0.20656117893255882,
      0.6836215865322136, 1.1044159348005569, 1.3934891793607604,
      1.4982352044959186, 1.400890274795049, 1.122448314872239,
      0.717534612035416, 0.26154205762063704, -0.1667342472435671,
      -0.5026269927163092, -0.7089638405679568, -0.7820584709389691,
      -0.7490398385490464, -0.6574750086665132, -0.5602154948262479,
      -0.49959560493398525, -0.4952265105923732, -0.5386356018535794,
      -0.5961590612465505, -0.6192881400830841, -0.5596727667949617,
      -0.3847215181947788, -0.08953619317981848, 0.2981624113255443,
      0.7216588426243904, 1.106738424592031, 1.378311230359636,
      1.4780512439797577, 1.3786171645038048, 1.0908387613526809,
      0.6620011697644739, 0.1655918303585258, -0.3149814964074813,
      -0.7046879950179474, -0.9526914677611931, -1.0418578917539663,
      -0.9897586978823353, -0.8411603154467694, -0.6541594377069149,
      -0.4837178583909632, -0.36696169005544693, -0.31408373076929497,
      -0.307165878161521, -0.3071198347367414, -0.266782161158991,
      -0.14655796827228268, 0.07168540431242432, 0.3763357555311593,
      0.7257694114758071, 1.0564081750525587, 1.2972129690008076,
      1.3870066919874853, 1.2902212151378412, 1.0070000290581906,
      0.5749769089599575, 0.06213795575617604, -0.4475756373976496,
      -0.8724317625259609, -1.1503978539072974, -1.2516987316071764,
      -1.1834472382349719, -0.9853736448521548, -0.717936052220062,
      -0.4460055668338917, -0.22239664143131854, -0.075481054827717,
      -0.003997072904352361, 0.019759900459773515, 0.03939962636761113,
      0.09952459233845412, 0.23056600238180552, 0.4375560733603602,
      0.6959863498142727, 0.9560307674547752, 1.1541952436912997,
      1.2294701186719204, 1.139826201438527, 0.8747343324995268,
      0.46034912020098584, -0.04416377671535565, -0.5584321949291894,
      -0.9980149997343459, -1.2927051066528326, -1.4015207097953626,
      -1.3207372825202013, -1.0830696461158935, -0.7483456705108995,
      -0.38814758549670475, -0.06838606015744014, 0.16576394199805855,
      0.2988128437531201, 0.345675718296965, 0.34421485122846834,
      0.3417975943765054, 0.3796134756600656, 0.47905837045305544,
      0.6339245222550615, 0.8105830478636759, 0.9562155299918874,
      1.0129990506608664, 0.9345365148525235, 0.7001738430585285,
      0.32333088391415954, -0.1485273646488044, -0.6425229013435215,
      -1.0756328106550472, -1.37290443141565, -1.4841427010523713,
      -1.3949492306652893, -1.1293988883709245, -0.7437378263688862,
      -0.31273887219708346, 0.08782148773815185, 0.3981635245866684,
      0.5867733459708426, 0.6549993104313045, 0.6330459119125584,
      0.568668410921316, 0.5117479617744929, 0.4989621445928838,
      0.5426940537997771, 0.6271664214487268, 0.7128493228390194,
      0.7479772521917074, 0.6841015642979626, 0.49149673217897316,
      0.17022476977946943, -0.24625105215937365, -0.6961029379403935,
      -1.1017866227942184, -1.3872723747707485, -1.4956070827080503,
      -1.402417180243634, -1.1219485104293776, -0.7040997808207289,
      -0.22316472431195483, 0.23892466169222465, 0.6106978959468361,
      0.8461315964478829, 0.9328991430499595, 0.8920166529437773,
      0.7692352817549486, 0.6206382329332365, 0.4963562694242848,
      0.426744606284897, 0.41466000747601367, 0.4358267863808926,
      0.44711641305464356, 0.400452669781153, 0.2585441925743265,
      0.008133500837395446, -0.33292817036373185, -0.7168766068009127,
      -1.0754411644003339, -1.3352435049907596, -1.435369386045815,
      -1.3426700070981217, -1.060867272923907, -0.6310684954501785,
      -0.12344959275776973, 0.3779104182492248, 0.7933378094081573,
      1.0645295148371885, 1.1660519132862195, 1.1086593153103834,
      0.9338114139284106, 0.7010051860661259, 0.471340598655081,
      0.2916482695490211, 0.18329060135869923, 0.13846709322489456,
      0.12484616779417868, 0.097134451646674, 0.012356363699846884,
      -0.1553691638714348, -0.40464495497167324, -0.7040941611387521,
      -0.9980634887516793, -1.2194315309750463, -1.30632415978067,
      -1.2184594616266078, -0.9488685590652911, -0.5278649266076654,
      -0.018077183908901714, 0.49837913571295556, 0.9375178149162291,
      1.231592806518844, 1.3432815833411966, 1.2725150628602868,
      1.0543930507637318, 0.748877897304689, 0.42502239629579763,
      0.14383166444188045, -0.055859718613516296, -0.16496225607764156,
      -0.20337827035581035, -0.21134217774348132, -0.235350956198909,
      -0.312592097192001, -0.45815650702847643, -0.6585757933001322,
      -0.8735426896712033, -1.0454981378898034, -1.1146658168167916,
      -1.0356336652181037, -0.7911106873403697,
    ]);
    const expected = [
      [
        0.5592787251777703, 2.4407188503120136, 2.132420848989852,
        -0.22887444697017312, 0.4790702646947387, 2.6018452372000063,
        2.0171858013962485, -0.46520036678265064, 1.090006235976038,
        2.443379950363034, 1.9627229345277684, -0.9119186261462451,
        1.5474507353033375, 2.4001556206625945, 1.847851226691441,
        -1.779950082753361, -0.28491738763584656, 2.426211260539174,
        -2.53828321045757, 0.4553411204033238, 2.02079408238185,
        -2.7239167455126405, 1.0379503771165293, 1.5585032793529343,
        -2.78821408341301, 1.5725261005967672, 1.0224837303321248,
        -2.7208838568346474, 2.032974585281497, 0.43806791971260256,
        -2.525072002337326, 2.3975390646649744, -0.16716230492022452,
        -2.209994281685277, 2.6489847245007923, -0.7646358247801802,
        -1.7904997156052953, 2.775402477626605, -1.3259754108325712,
        -1.2874392547169906, 2.7746301297824862, -1.835848380849548,
        -0.7001071364445486, 2.6413500991929353, -1.912805322231617,
        -2.6326512891215175, -0.9165024838340512, 0.6347988992442065,
        -1.7786329357899298, -2.795840665191423, -0.46637023641641884,
        0.44192639531506284, -2.0681493214702886, -2.649398356273144,
        -0.1675849403779293, 0.30493339076549186, -2.4898674282891666,
        -2.3108005251100305, 0.27675258249505297,
      ],
      [
        0.45344704783826556, -1.8833732173385018, -0.03602522905563316,
        -0.025618439372833177, 1.5246053696600084, -1.2331370279618816,
        -0.3776854331249296, -0.2534082054392737, 1.6349649697714643,
        -0.5792453112496917, -0.555570230142965, -0.5092441245799897,
        1.4988794643296564, 0.6947843385570827, -0.5787048611995151,
        -0.8671179576269306, 1.557137285740925, -0.9837809225166186,
        -0.3961073009506932, 1.412575914993407, -1.1896806628821308,
        -0.07395188216070894, 1.2726231660047418, -1.3582319226988753,
        0.2562101923054639, 1.069554395294516, -1.459785370728005,
        0.5735134653575659, 0.8139978747406116, -1.4894124678573075,
        0.8623471951947758, 0.5185717584878952, -1.4457086377614659,
        1.1085155480103086, 0.19784760845640567, -1.3308800605949447,
        1.299933367923018, -0.13238643572262102, -1.1503824521886257,
        1.4255283516915904, -0.44842580783365676, -0.9370179343277318,
        1.5422945601458282, -0.921974018407044, -0.15614891736538994,
        -0.29642569880056324, -0.2933680408942393, -0.4630312694984441,
        -0.2245851109267607, -0.12110950252279355, -0.0005276336053897789,
        0.061235592689845526, 0.1728496288324307, 0.32525923243638716,
        0.4615066738077036, 0.2955434006414819, 0.0233636651538583,
        0.8674916102338801, -0.4039694059181093,
      ],
      [
        0.054668854297650914, -0.17877569416441488, 0.4716178693226251,
        -0.6073732338264871, 0.21966630663357398, -0.15235741536680605,
        0.10422179489465411, -0.05166629972501193, 0.060782364797565165,
        -0.18171982938601267, 0.4363523294837789, -0.15484253866941325,
        0.03113164950005229, -0.08339338043064703, 0.033304508457749904,
        0.014805262227667882, -0.024334380333879926, 4.078809452606123e-5,
        0.026287651448576782, -0.024888475094520537, -0.0029845213168883432,
        0.027669290032719968, -0.022914415570957476, -0.00625707531054611,
        0.028778406314722952, -0.02062593401756465, -0.009480270252177488,
        0.029474897169897468, -0.018106860182089388, -0.012552839692727602,
        0.029862440029648718, -0.015344632092493905, -0.015508080955539863,
        0.029825699268454926, -0.012405629820842107, -0.0182290237264457,
        0.029472607272582517, -0.009305970912992713, -0.020770494782663105,
        0.02870439098176514, -0.0060921088961333235, -0.023005468392711705,
        0.02762814638409095, -0.00280800214489436, -0.025007782917258962,
        0.02616631875213934, 0.0005220979307270149, -0.026646423522398037,
        0.024420089308079512, 0.0038285528586707047, -0.028010811574849366,
        0.02233675625140623, 0.007110545164535438, -0.028972183670680374,
        0.020006768772882395, 0.010276132942023817, -0.029631363925929806,
        0.01740472115641731, 0.013348058272184268, -0.02986795777658386,
        0.014606003815369771, 0.016216504604684708, -0.029789455456003006,
        0.011613645691254944, 0.018926780973415637, -0.02928951511762061,
        0.008484430428164052, 0.0213470970011492, -0.028374301905495856,
        0.004753672293464756, 0.024698186716884594, -0.02655699729931062,
        -0.009048024745426576, 0.058596673194693485, -0.023172630670039288,
        -0.26797498741710685, 0.09413460918568883, -0.050690430492246336,
        0.17869235206868872, -0.219702490689702, 0.10216174949528763,
        -0.07319692766502459, 0.37418779619702913, -0.22098164260452585,
        0.09662138181483833, -0.03248895340947315, -0.01482362111260191,
      ],
      [
        1.4229147069799199e-5, -0.00020757429194446107, 0.0015025932529469758,
        -0.006760046149050052, 0.022160357753583843, -0.0530434287399955,
        0.11462255268374943, -0.09073831210851603, 0.023071395930617685,
        -0.018188315523108053, 0.010651765480893154, -0.003925177938447042,
        0.0009777449768431778, -0.0001519021944604176, 1.2283821894596529e-5,
        2.296083046861294e-6, 7.645385781557389e-7, -1.5072893889365584e-6,
        -2.3201452574763597e-6, -8.870766971676172e-7, 1.404741764612516e-6,
        2.3368236890140998e-6, 1.0069317509257175e-6, -1.2975354978971576e-6,
        -2.3458008689647936e-6, -1.1231807586991532e-6, 1.1866823562038596e-6,
        2.3476620605468114e-6, 1.2358345132917252e-6, -1.0725033109216157e-6,
        -2.3427340462769616e-6, -1.3451363195601194e-6, 9.546697383126272e-7,
        2.330455214152146e-6, 1.4504413721369926e-6, -8.334946045801016e-7,
        -2.310468261987357e-6, -1.5507980564176467e-6, 7.100297095935118e-7,
        2.2833689313906314e-6, 1.6461338567445557e-6, -5.847829538674009e-7,
        -2.2496945677837834e-6, -1.736804978809158e-6, 4.5747930641122556e-7,
        2.209064952225784e-6, 1.822363279270849e-6, -3.2831528491573056e-7,
        -2.161099746959033e-6, -1.9018741510529149e-6, 1.9833224934043764e-7,
        2.1063769026967843e-6, 1.9751858558405195e-6, -6.82002266145006e-8,
        -2.0456187731676725e-6, -2.042751299141783e-6, -6.229005435741735e-8,
        1.97864426381135e-6, 2.1043407684552573e-6, 1.9306864099798318e-7,
        -1.9050677017718347e-6, -2.1590813728399585e-6, -3.2315465499203967e-7,
        1.8254216349889184e-6, 2.206749833170066e-6, 4.5174843614472087e-7,
        -1.7405789386203326e-6, -2.2478748521167312e-6, -5.789844760138379e-7,
        1.6505658090603145e-6, 2.2824564368721057e-6, 7.049235429268178e-7,
        -1.5550090083765811e-6, -2.309725040482414e-6, -8.286924335140839e-7,
        1.4543700320192828e-6, 2.329396769031358e-6, 9.494004864145515e-7,
        -1.3496305556365916e-6, -2.342051445416349e-6, -1.0671018833869565e-6,
        1.241022236687642e-6, 2.3479190737957545e-6, 1.1819861074802401e-6,
        -1.1282013205868206e-6, -2.3463700333687767e-6, -1.293329683569095e-6,
        1.0115358573803673e-6, 2.3370733844630615e-6, 1.400193834898852e-6,
        -8.920692238779972e-7, -2.320632832160156e-6, -1.5025506905743335e-6,
        7.702269759501566e-7, 2.297497586756232e-6, 1.6007102329063376e-6,
        -6.457103428544543e-7, -2.2672077318351307e-6, -1.6941336725999507e-6,
        5.187757691634542e-7, 2.2294009080168696e-6, 1.7818791736944848e-6,
        -3.904783494987703e-7, -2.184676120961861e-6, -1.8638388354699248e-6,
        2.614165833084846e-7, 2.1336804643770676e-6, 1.9404291947091215e-6,
        -1.3135004122997163e-7, -2.0761452992608866e-6, -2.011322194828796e-6,
        4.1062391790686585e-10, 2.0116937638699326e-6, 2.0756180891755933e-6,
        1.303855511667262e-7, -1.9408916143758846e-6, -2.1331345842939366e-6,
        -2.60296102557049e-7, 1.8645529792173687e-6, 2.184375643017057e-6,
        3.8949267712426974e-7, -1.7826128366974445e-6, -2.2292399766733496e-6,
        -5.179749568996478e-7, 1.6946972573602585e-6, 2.26691283937861e-6,
        6.448146510382993e-7, -5.833661847346452e-6, 5.016049285950444e-5,
        -0.00029639590992862515, 0.0009635155572233563, -0.00172322872825551,
        0.0025265169557096285, -0.002739466177712355, 0.04939370007676667,
        -0.0633537199536144, 0.019009560889553995, -0.00455772233411395,
        0.0006164646644348402, 0.00022593919967976584, -0.0001368901653041411,
        2.6395831047067392e-5, -3.700546261324951e-6,
      ],
    ];
    const result = wavedec(data, "sym16");

    const reconstruction = waverec(result, "sym16", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym17", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.4961429374690823, 0.9174122502406596, 1.2039516704650377,
      1.322524955261226, 1.2720984307476502, 1.0822223384728666,
      0.8047278305293353, 0.50082119627584, 0.2267144050017199,
      0.021229911579197402, -0.10171049134028026, -0.1540273140023038,
      -0.16779219258470807, -0.1844668989440194, -0.24187210713591173,
      -0.3622332256496324, -0.5443774407903571, -0.7621288193352725,
      -0.9694163419283109, -1.1109449640004136, -1.135886711967788,
      -1.011266781048407, -0.7317407972758456, -0.32328227810929,
      0.16027130467911485, 0.64717154782091, 1.062016945085212,
      1.341084350100311, 1.445230994597844, 1.367423496487745,
      1.1332081157917437, 0.7940919621898112, 0.4154619755263796,
      0.06193131860442391, -0.21642943274627224, -0.3937795576129265,
      -0.4719401545316689, -0.4769331068585233, -0.44966629256404406,
      -0.43321679706052385, -0.45997136788263204, -0.5418919908101221,
      -0.666383932670733, -0.7988469823343487, -0.8913277343725311,
      -0.8951659860764645, -0.774512900197207, -0.5173408758491229,
      -0.14113041930255327, 0.3083259093876354, 0.7649187456257054,
      1.155295297933887, 1.414053360370148, 1.4975618515028832,
      1.3932080535872282, 1.1219284568330612, 0.7334476470935539,
      0.2953536187166883, -0.12142887057484236, -0.45738470579469687,
      -0.6759790423971812, -0.7694510408170467, -0.7576383153732277,
      -0.6803220297394199, -0.5851327837152012, -0.5141026199649859,
      -0.4922383625909419, -0.5209586732544083, -0.5780132126544552,
      -0.6238856897442694, -0.6130667463143357, -0.507360671525445,
      -0.2878597022847678, 0.037488324831970676, 0.43274736239114847,
      0.8397753072514486, 1.189722319551748, 1.417644084651283,
      1.4768416909696607, 1.3495604059580757, 1.0515060596966714,
      0.6290742419171916, 0.14989143714657352, -0.3111686244957618,
      -0.6872795476576863, -0.9327674704599107, -1.031071278269492,
      -0.9958456464974559, -0.8651368859900745, -0.6902073254286742,
      -0.5218382182620067, -0.39750396948982836, -0.33254921628063333,
      -0.3174814209519073, -0.3219644231698827, -0.30443460903506536,
      -0.22486536294231302, -0.05741655837718285, 0.20028376846210172,
      0.523670062708351, 0.8646150231565659, 1.1610093222706868,
      1.350372970433373, 1.3843092879707624, 1.2403582508676863,
      0.9283790563985521, 0.48985761007120965, -0.009808305702486891,
      -0.4943413396363286, -0.8919779179170118, -1.1497147506179315,
      -1.2431810717467966, -1.179953650650711, -0.995688977779576,
      -0.7441434412572262, -0.4835811962383212, -0.2628893406035587,
      -0.11073674111248788, -0.030326019825772432, -0.0008910958751771753,
      0.014574604586861717, 0.05740688222057272, 0.16025064195783134,
      0.3362768500326358, 0.5734335827307888, 0.8352915788588321,
      1.0684201035711454, 1.2146103344396582, 1.225044096896678,
      1.0729830091824273, 0.7618566191503233, 0.3266883600075353,
      -0.17163716025913656, -0.6580672897040498, -1.0584183138445362,
      -1.3143384634937758, -1.3947877713446657, -1.3014426856019925,
      -1.0668634291536236, -0.7459627512764682, -0.4028789579978247,
      -0.09641026155778065, 0.13253892587816418, 0.26858327996537823,
      0.32286674532775606, 0.3273970490427972, 0.32427230776609806,
      0.35260417385570936, 0.43648851995761667, 0.5770999189472201,
      0.750957875777615, 0.9148811219934898, 1.016483501530228,
      1.0076753325934447, 0.8578562731107344, 0.5635107821030932,
      0.1517425565413205, -0.32328627816330957, -0.7903543737126755,
      -1.1754155221422968, -1.4168356389749566, -1.478136318744273,
      -1.3553161985964088, -1.0770849774941316, -0.6980032066831214,
      -0.2861775368423264, 0.09157973887480564, 0.38365619886484853,
      0.5634068376443564, 0.6326102839943258, 0.6179816507041153,
      0.5617900199245109, 0.5090419108148799, 0.4944985294373313,
      0.5328012006073228, 0.6141868058036355, 0.706877303346632,
      0.7655648469010635, 0.7438910805373349, 0.6078066371979998,
      0.3464421688765424, -0.02231032610226169, -0.4530521337247574,
      -0.8808733171398564, -1.2343614921267352, -1.4506667420891124,
      -1.4891367252018355, -1.3403377077409844, -1.028339612947354,
      -0.6057134860928992, -0.1423931136862257, 0.28901810454629984,
      0.6280997513538757, 0.8382255524234524, 0.9123342635010094,
      0.8716764428631573, 0.7580395992395913, 0.6215058153233581,
      0.5068401784345191, 0.44189568756930364, 0.4308843778586459,
      0.454137784460069, 0.47436189106491705, 0.447776057073734,
      0.33730497319862124, 0.12446459328170567, -0.18312320912285673,
      -0.5506062081467046, -0.9216394890431836, -1.2297826336491313,
      -1.4129570713510438, -1.427584045789572, -1.2590510068688003,
      -0.9259859190033042, -0.4772581062056298, 0.017672468831198163,
      0.48287538561042687, 0.8513133488247875, 1.0779448180737008,
      1.1476143213888375, 1.0760295220999125, 0.903770949325592,
      0.6849278809085331, 0.47320716955179887, 0.3089215503100251,
      0.20999857311088416, 0.16912836585185997, 0.1576381941262825,
      0.1350165555725632, 0.061613727288376996, -0.0887419347849025,
      -0.31946070862623244, -0.6076808117181702, -0.9075589083760836,
      -1.1597191280384123, -1.3046913324238685, -1.2971583847088755,
      -1.117583838744374, -0.7783692618244684, -0.32295868097353814,
      0.182035925504586, 0.6599659332035699, 1.0395670023914672,
      1.2691593041236375, 1.3264057504979272, 1.221458850669972,
      0.9928892958717179, 0.6974878788214702, 0.39646023366074046,
      0.1413502457542099, -0.03696036853335183, -0.13362103764841754,
      -0.16839627576215904, -0.1779812420184374, -0.2040993804047433,
    ]);
    const expected = [
      [
        -0.058544207163279016, 0.17292653171829112, 2.4951252436588898,
        1.484961305589671, 0.9116004586169508, 2.4446550263938516,
        0.29855782601531455, -0.4286457237492808, -0.11674219660572059,
        0.49010026319229133, 2.645670863343194, 1.2552776934978171,
        1.0661346094108124, 2.3386313246112094, -0.19758906200318418,
        -0.7330959882414042, -1.3315382119076171, -1.764941607051031,
        1.2487984310263296, 2.8688719558639497, 0.045811131902270145,
        -1.3921830988948485, -1.006923445172069, -1.4017835937763823,
        0.5930193111121029, 2.9807484282979444, 0.6173050152596637,
        -1.9097093246056158, -1.1137823605369146, -0.8030195039370078,
        0.1653176234396544, 2.676622443953629, 1.293533350202802,
        -2.0957623443432016, -1.5911916052621253, -0.23700140435248698,
        0.13490758092390287, 2.08545754255059, 1.8021521646967666,
        -1.8605281071608497, -2.2389867583917455, 0.04561407137794993,
        0.5030555623048601, 1.4569060710692467, 1.9412846754962947,
        -1.291453907760812, -2.785035659596826, -0.08639839203762394,
        1.1030903653642172, 1.0561363895238551, 1.6645239612009577,
        -0.6164316176348646, -2.9998211178745677, -0.5895762948852938,
        1.6705842554545587, 1.0521819935724355, 1.1004696062230963,
        -0.10784558436343411, -2.7930804036561394, -1.2640662142534114,
        1.9546950244716415, 1.4467688631159512, 0.49857682741515164,
        0.03211326328520183, -2.2518108695911, -1.8377700689141179,
        1.8237878189553025, 2.073589008534672, 0.12411967830502108,
        -0.24344632955909862, -1.603521574306591, -2.082041548800529,
        1.323472225172964, 2.6612189532687593, 0.20901105946213513,
        -0.5813830660868964, -0.10338503276942584, 0.7474200451242735,
        2.7085491016913594, 0.48823184162803623, 0.14874031836065338,
        2.6442832383543737, 0.6566230375400928, -0.46693423670268414,
        -0.288864492356752, 0.45755553334418503, 2.373940967072844,
        1.0622382459805768,
      ],
      [
        -0.01822581224469435, 0.06943002667343581, -0.18258136708354814,
        0.5230098882948292, -0.47315151566926666, 0.17386487902963607,
        -0.10473791744569413, 0.06602858536804945, -0.06550066416881084,
        0.06644952064769416, -0.1254822952489938, 0.4621656266693671,
        -0.5241012124198642, 0.2288926523069977, -0.12228814588077426,
        0.026468567020897782, 0.0014587363836944197, 0.00583140685012782,
        -0.016693843832538538, 0.009985934597543059, 0.00829143855945118,
        -0.016598295357410062, 0.005049397140036483, 0.012541375545970759,
        -0.015133344664954553, -0.0003874448267273562, 0.015444331087979844,
        -0.012016729881789348, -0.005781638963242786, 0.016663005982599538,
        -0.007614185106732264, -0.010551192882572209, 0.01609218774959843,
        -0.0023736371929086787, -0.014178203093991454, 0.013767140569454555,
        0.0031094353307266624, -0.016272406330156537, 0.009965759913319942,
        0.008270433760230981, -0.016604826239797216, 0.005073116995858041,
        0.01252225911960514, -0.015142161786880253, -0.0003553988331930179,
        0.015433744776966766, -0.012039735990197807, -0.005758377554066253,
        0.01666094799456448, -0.007636383603148123, -0.010525518495793576,
        0.01610015223360399, -0.002405063130331804, -0.01416666045407851,
        0.01378287047110136, 0.003084546967470416, -0.01626242537394936,
        0.00998907257052895, 0.00824248312828616, -0.01661135660643903,
        0.005099847360678558, 0.012506489391286882, -0.015150577157192391,
        -0.0003263763083822015, 0.015419717099054256, -0.01206309424314165,
        -0.005732102064502878, 0.01666202487222971, -0.007657478814037407,
        -0.010477245908734353, 0.015831279376496383, -0.001118514863841197,
        -0.0174017162445607, 0.0168072918054552, 0.003910400520577165,
        0.009607350814629934, -0.025896594248851698, 0.043503003114478876,
        -0.14220492125940765, 0.36938115110895997, -0.37632370278458543,
        0.17272054934700595, -0.07349258963216784, 0.03213240409046918,
        -0.009668803415500964, 0.0001915505636111302, -0.020257957673242205,
        0.016843332274096883,
      ],
      [
        -6.177224943886054e-6, 0.00010589988319312173, -0.0007578571768930861,
        0.003153080121265175, -0.008092525057804273, 0.015211906679087587,
        -0.03735348868023066, 0.11133066659565705, -0.11370317254708316,
        0.049636646958185794, -0.02703635540370892, 0.009887499134447426,
        -0.0029163465084903217, 0.000613870537536697, -7.794867282849015e-5,
        4.300467732730724e-6, 2.1254882303046296e-7, 6.272237779073043e-7,
        4.735188207625684e-7, -1.0929337916537786e-7, -5.930883307647294e-7,
        -5.394629985115682e-7, 2.9930477830822683e-9, 5.427272582839109e-7,
        5.906561126766236e-7, 1.033590663488574e-7, -4.775777596498502e-7,
        -6.257197094754604e-7, -2.0682814371224607e-7, 3.994965234132872e-7,
        6.438033280525218e-7, 3.046949614993213e-7, -3.1054354076230827e-7,
        -6.44397962338647e-7, -3.943320387718437e-7, 2.1305934200078035e-7,
        6.273831189936568e-7, 4.7319943492456636e-7, -1.0976576995358632e-7,
        -5.932395617164263e-7, -5.391124371417257e-7, 3.557200609257267e-9,
        5.430012730381991e-7, 5.903752017049843e-7, 1.027417214580169e-7,
        -4.780181461955578e-7, -6.256277893128706e-7, -2.0631698363754764e-7,
        3.9995585075265963e-7, 6.438107182424155e-7, 3.042795310428427e-7,
        -3.109593694475531e-7, -6.443935132011917e-7, -3.9388128872007683e-7,
        2.1355618149270607e-7, 6.274600600746963e-7, 4.7275117910583844e-7,
        -1.1037891995954403e-7, -5.935059681694669e-7, -5.388210405235705e-7,
        4.133718860585698e-9, 5.433558922491126e-7, 5.902218914075348e-7,
        1.0226523899702571e-7, -4.783419036561209e-7, -6.254748091398298e-7,
        -2.05816885451056e-7, 4.0033484339244866e-7, 6.436900931981615e-7,
        3.037228497105221e-7, -3.114918955177074e-7, -6.444502462625672e-7,
        -3.9342019016907973e-7, 2.141319507967542e-7, 6.276635763476896e-7,
        4.7244368789862286e-7, -1.1087440962856146e-7, -5.937092441001553e-7,
        -5.38538148192068e-7, 4.632112186110444e-9, 5.435835870682963e-7,
        5.899269643465288e-7, 1.0167046535042677e-7, -4.787290455620699e-7,
        -6.253136194450228e-7, -2.0523948605428427e-7, 4.008395349468728e-7,
        6.437102495337465e-7, 3.0328479070083624e-7, -3.1195943096860604e-7,
        -6.445131001889568e-7, -3.9303498466587393e-7, 2.1458209910919017e-7,
        6.277253245767527e-7, 4.7201638749822704e-7, -1.1143561209820173e-7,
        -5.939066670297555e-7, -5.381796711901553e-7, 5.25543076536804e-9,
        5.439522411094814e-7, 5.897517000210235e-7, 1.0114244017904453e-7,
        -4.79120113122341e-7, -6.252261991383792e-7, -2.047863117873503e-7,
        4.012025575505294e-7, 6.436092471216541e-7, 3.0277868073993457e-7,
        -3.124236299055996e-7, -6.445022514823736e-7, -3.925256750462473e-7,
        2.151735023854922e-7, 6.279079144423779e-7, 4.7165758738345823e-7,
        -1.1199868763020347e-7, -5.941758830548094e-7, -5.379440533413511e-7,
        5.737314888162585e-9, 5.441986071806598e-7, 5.895061408761707e-7,
        1.0061512823412178e-7, -4.794395911713676e-7, -6.250156334697054e-7,
        -2.0419155956836723e-7, 4.0168775684556065e-7, 6.435786301318829e-7,
        3.0227271109603687e-7, -3.1295783025380065e-7, -1.7567094751240071e-6,
        1.6318692612314573e-5, -0.00011332073963724477, 0.0004463362385522633,
        -0.001061993069111698, 0.001787371862838758, -0.004340592315066379,
        0.014150837986476457, -0.014452944176789825, 0.005985084412963708,
        -0.003367191680567698, 0.0012731012005420513, -0.00040160116279964423,
        9.10284974506673e-5, -1.2154644197278826e-5, 1.4801845237330237e-6,
      ],
    ];
    const result = wavedec(data, "sym17");

    const reconstruction = waverec(result, "sym17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym17_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5122446289875402, 0.9416447440745046, 1.2231974988231917,
      1.3232276753952634, 1.2452701199519565, 1.0270314053060587,
      0.7293699979852835, 0.4202367078293952, 0.157752203963263,
      -0.02324859205678903, -0.1178388888324289, -0.14924877063686395,
      -0.15941179588681392, -0.1945033777254409, -0.2894725634357024,
      -0.45582264471748374, -0.6760307974928943, -0.9062382593238916,
      -1.0866482852834694, -1.1570108023842307, -1.0731873634383282,
      -0.820441024535123, -0.419878422452577, 0.0738121677052668,
      0.58297268032224, 1.0234474752082314, 1.322916442619059,
      1.4365951800604524, 1.3564584889901183, 1.111772005004507,
      0.7609059824439472, 0.3765931257697685, 0.028417845120057683,
      -0.23302794584984904, -0.386379975666959, -0.4416862815664836,
      -0.43421766434704795, -0.4117641913184098, -0.4189621148042665,
      -0.4829442573020239, -0.6042279292564228, -0.755348464049605,
      -0.887680837045985, -0.944705343877801, -0.8782364384026404,
      -0.6633008775013388, -0.3076425356989789, 0.14682448564715575,
      0.6312399234418022, 1.0640913483898988, 1.3691349753442266,
      1.4925365099307575, 1.414984897001358, 1.1557765361511034,
      0.7678793580533753, 0.3252494518303083, -0.09439266134545365,
      -0.42700881280852354, -0.6355922550377685, -0.7161984675880864,
      -0.6953535998330442, -0.6197717264090099, -0.5412876782969334,
      -0.5011181198718968, -0.5176901450971179, -0.5812946239854154,
      -0.6569891305544026, -0.6949713253977969, -0.6456432708274314,
      -0.47531264673080154, -0.17826228124870536, 0.21817609543847172,
      0.6571158530774569, 1.0635317409290916, 1.3608838092565423,
      1.488850112255426, 1.4177307595312842, 1.1558842747582845,
      0.7482905917547489, 0.26656000680090985, -0.20714641470412626,
      -0.5983024247915719, -0.8558259035989539, -0.9616732470066263,
      -0.9319985781981648, -0.809831313642068, -0.651393117076615,
      -0.5097777740447829, -0.4203436126224915, -0.39165988903282584,
      -0.4043422101787852, -0.41800223556205485, -0.3843743004184924,
      -0.2630301948048235, -0.03538413578223104, 0.286890712763259,
      0.6614717857966452, 1.023369995721538, 1.2994352573378432,
      1.4257992330495324, 1.3638504769709139, 1.1106493518410598,
      0.7010579977211451, 0.2009355135701024, -0.30700138025568957,
      -0.7412041886144374, -1.0387859630223781, -1.168217439186922,
      -1.1341999765576625, -0.9736919811056197, -0.7443157448275468,
      -0.5082901577674226, -0.3161290940212819, -0.1943369336044533,
      -0.1402287942071998, -0.1250941877133841, -0.1047074803362858,
      -0.03424385500629279, 0.11650835209743005, 0.3518349384080033,
      0.6458614486185702, 0.9467181076472242, 1.1882093750484415,
      1.3060959587796648, 1.2548386025347722, 1.0204636246846561,
      0.6261440583577484, 0.12891077776712634, -0.3918510914185819,
      -0.8513796478348924, -1.1778531832117558, -1.3275694920221393,
      -1.2933068017673108, -1.1039163230640532, -0.8154161505548916,
      -0.4959943417544049, -0.20883678534226685, 0.0028121599629323812,
      0.12459359671922737, 0.1718311347275772, 0.18218557740388236,
      0.20231136791631887, 0.2722262928236242, 0.41169455318203607,
      0.6123811216214736, 0.838004093869149, 1.0325903381849857,
      1.1347806525273445, 1.0944968663734649, 0.8876024335102,
      0.5246412191746649, 0.05121393577923575, -0.4603293044814256,
      -0.9259834829906722, -1.2683274290455069, -1.433441422414203,
      -1.4023523715098554, -1.1942269424916772, -0.8606105588137399,
      -0.47226038357652034, -0.10196598157162756, 0.19227996888751875,
      0.3795523363357432, 0.46072890144334566, 0.46470134225079324,
      0.4372991366642082, 0.4260514547216309, 0.46497279641640343,
      0.5635185207739798, 0.7027291708603021, 0.8396627040572978,
      0.9190023029923485, 0.8888012487218391, 0.71618866384121,
      0.39880992103721247, -0.03116955892271578, -0.5117778936933124,
      -0.9637090022535737, -1.30758450993461, -1.4817753148293968,
      -1.4563690066353026, -1.239812988004268, -0.8765940624373209,
      -0.4365644461070156, 0.0013851168164378813, 0.3672079159661199,
      0.614696413020469, 0.7299370140600877, 0.731290229102945,
      0.661162714011092, 0.5719506257599786, 0.5100130729041417,
      0.501999616723978, 0.5471896612777796, 0.6178805871193187,
      0.6677096663714277, 0.6456737670763596, 0.5120741940875038,
      0.2520637223224521, -0.11694493049101462, -0.5461831085069784,
      -0.9647688862653337, -1.2951413039694284, -1.4709035436261213,
      -1.4526201344358542, -1.2375816735444867, -0.8610428699753245,
      -0.3885748885637206, 0.09859619680249784, 0.5216386648033642,
      0.8210974935097692, 0.9686634490203719, 0.9709455260650768,
      0.8645273951428869, 0.7038200938120172, 0.5450467732440428,
      0.43064207639748464, 0.378177678847383, 0.37668551624690993,
      0.39126698605150184, 0.3746679499108459, 0.28264160826835727,
      0.08889882413009564, -0.2044742060631783, -0.5640867691481349,
      -0.9308111111656898, -1.232628223118386, -1.4016061790338736,
      -1.3907387358796444, -1.186341787026022, -0.8127841340306878,
      -0.3282429189340529, 0.187567107537932, 0.6507172370536309,
      0.9911985976496082, 1.1674339811477592, 1.173673970977188,
      1.0386069012977093, 0.8157499884654242, 0.5682650346406496,
      0.3522230339178346, 0.20267505514737677, 0.12609071350267526,
      0.10101134684634486, 0.08658091239922902, 0.0365328164172295,
      -0.085231972984325, -0.2917656192325418, -0.5664799828125515,
      -0.8647768337651625, -1.1236722078968477, -1.2770636072813686,
      -1.2727651391853456, -1.0869089780424788,
    ]);
    const expected = [
      [
        -0.10182026023172992, 0.09194248845513305, 2.4132707051353823,
        1.508377710708845, 0.9509771345646935, 2.3718898871750067,
        0.1819781745758434, -0.43699134715518695, -0.1221946425993595,
        0.384677942984532, 2.573116414685243, 1.2996402911904716,
        1.0861997960117742, 2.2501500485723773, -0.3347015097900011,
        -0.7087509827011448, -1.5294453649614987, -1.4775635086461796,
        1.9877712032239325, 2.4097275358504686, -0.6973995067394902,
        -1.1940168323490064, -1.195953476048438, -1.0981694946949978,
        2.006530186578806, 2.4292129526961244, -1.0290193486415986,
        -1.602698819302239, -0.8483524819848719, -0.661278839329872,
        1.9504142446467856, 2.353460444260761, -1.309872597929315,
        -1.958845263776794, -0.48359622227677834, -0.18697292967717022,
        1.8253961684392495, 2.1828149610577166, -1.531611541346871,
        -2.2465798494619085, -0.11623350883971655, 0.3065518837906659,
        1.6393488353545629, 1.9216384081801752, -1.6886336752573043,
        -2.4524228552791496, 0.2398107213136435, 0.7997904893228324,
        1.402147092997552, 1.5781805322720999, -1.7781660972749087,
        -2.5659355702682447, 0.571778133642464, 1.2727260280211221,
        1.1251526636488005, 1.1643335284520053, -1.8002269066154875,
        -2.5802487609844498, 0.8685402133105995, 1.7056709635629959,
        0.8206619592915926, 0.6952205298950747, -1.7574670868030635,
        -2.4924488061292833, 1.120964872511153, 2.080115630544879,
        0.5013439084368966, 0.18863056615966184, -1.6549010027777713,
        -2.3037593139416983, 1.322129111528392, 2.3819673206397063,
        0.17171373390577124, -0.3229525189407504, -1.8023401864548148,
        -2.501036069429887, -1.9697797148415552, 0.042401858994917246,
        0.5769624136384822, 1.570164631181528, 1.5169281196221958,
        0.053765319758586096, -0.5258372184615968, -2.2382341470891474,
        -2.456147563026427, -1.4875511737172489, 0.3888974317108525,
        0.5700509069189815,
      ],
      [
        -0.01587319310634483, 0.07815567235511477, -0.20233422423872846,
        0.5601657068510406, -0.5097411932420883, 0.1990092587585923,
        -0.13370324675684292, 0.11861477232391757, -0.11898559238820751,
        0.09825419010158463, -0.15287519303485997, 0.4990628759625026,
        -0.5614297994958736, 0.2509049894243019, -0.1336462719552841,
        0.02477091783041409, 0.011431994101480918, -0.002167820206029444,
        -0.019981720816678934, 0.023254684972814535, -0.0021244421033048706,
        -0.021213023988680954, 0.021949975268447976, 0.00070061204326928,
        -0.022616995030943932, 0.02042357763984653, 0.0035393799200715017,
        -0.0237180253500551, 0.018628239363485684, 0.006306828246557823,
        -0.024533563361405965, 0.01661005685899224, 0.009021137281681047,
        -0.025026361657127905, 0.01436684072400882, 0.011594826739221725,
        -0.0252127261428981, 0.011958796303119244, 0.014047980229557742,
        -0.02507234671214842, 0.009380722323741542, 0.016297887226824737,
        -0.024620208731992613, 0.00670441728345758, 0.018366354737082636,
        -0.02385367985963397, 0.003921366297713759, 0.0201787964306574,
        -0.022785878014492545, 0.0011119593807370762, 0.021758437888661306,
        -0.021431849286962228, -0.0017358726579555788, 0.023041813168002915,
        -0.019802236609434365, -0.004536488391280564, 0.02405312495924318,
        -0.017929029928445334, -0.007305655585052228, 0.024742541080037,
        -0.015819757787363803, -0.009956016278576292, 0.025134660175937407,
        -0.013521920367244297, -0.012507051147218095, 0.025195209651375214,
        -0.011039266970880217, -0.014871909771603277, 0.024935801964240074,
        -0.008440284785295595, -0.01654286728424934, 0.021510885233591834,
        0.002311167875542687, -0.04661680393347089, 0.15731159992941604,
        -0.3618956671977447, 0.10093499242108203, -0.09419570113612107,
        0.11263971556446803, -0.19002394543501067, 0.19441740325537066,
        -0.11708590737038999, 0.05220359476640133, -0.07108965220368459,
        0.33949838120066006, -0.14848613394864593, 0.08283808414943636,
        -0.013975119156647996,
      ],
      [
        -6.324565331627831e-6, 0.00010967148176624527, -0.0007825514157527435,
        0.003263125414757581, -0.0083939987883842, 0.015827307263604345,
        -0.03888408633346737, 0.11561685103338798, -0.11808034366797987,
        0.051619941987325654, -0.028088242845313333, 0.01026173472390644,
        -0.003020629458493736, 0.0006339404872321363, -8.07827789630207e-5,
        4.388577706018627e-6, 6.729985407059572e-7, 1.129931611611897e-6,
        4.934258885409763e-7, -6.20596440490506e-7, -1.134114695949343e-6,
        -5.50199638909075e-7, 5.661112736374455e-7, 1.1345929427287555e-6,
        6.051528476801191e-7, -5.098548764230843e-7, -1.1314362290053515e-6,
        -6.580947346471076e-7, 4.5210562252905677e-7, 1.1248098769232655e-6,
        7.090240100999482e-7, -3.929162440541103e-7, -1.1146779412432552e-6,
        -7.578118388430165e-7, 3.3236163069377433e-7, 1.1009118548638499e-6,
        8.041405524906775e-7, -2.7075299431323614e-7, -1.0835971338336712e-6,
        -8.478159564255879e-7, 2.084089099774195e-7, 1.0629531181236132e-6,
        8.888586375040124e-7, -1.4541865184386114e-7, -1.0390185407486152e-6,
        -9.272010753581581e-7, 8.184793252310174e-8, 1.011702127700721e-6,
        9.625689025517869e-7, -1.7993523681772993e-8, -9.81101374538781e-7,
        -9.94773554181853e-7, -4.5799904286576256e-8, 9.474811877809909e-7,
        1.0238589651024713e-6, 1.0941275048368381e-7, -9.10952591433955e-7,
        -1.0498233129405436e-6, -1.7279391058935747e-7, 8.714635789600575e-7,
        1.0724469609459183e-6, 2.3567450116085692e-7, -8.291188853329822e-7,
        -1.091555272587903e-6, -2.9769890056408874e-7, 7.842182625958492e-7,
        1.1072156156991594e-6, 3.587245056698649e-7, -7.369395096558373e-7,
        -1.119493393055695e-6, -4.1871977599914414e-7, 6.872698608319868e-7,
        1.128232602435269e-6, 4.774561917948317e-7, -6.353156873713747e-7,
        -1.1332796961513598e-6, -5.345826594211486e-7, 5.813990934335293e-7,
        1.1347241318302252e-6, 5.899415964154542e-7, -5.257562342772684e-7,
        -1.1326970213257662e-6, -6.435251750308619e-7, 4.6841167356747304e-7,
        1.1271120229037473e-6, 6.951561721799392e-7, -4.094672433785899e-7,
        -1.1178424713868494e-6, -7.445030801819886e-7, 3.492536368381939e-7,
        1.1049970127548975e-6, 7.914017122278875e-7, -2.8805452245043013e-7,
        -1.0887680309889185e-6, -8.358709453805836e-7, 2.2592812011078023e-7,
        1.0691417372434455e-6, 8.777936803190189e-7, -1.6296535325281304e-7,
        -1.0460224134111273e-6, -9.168720875306544e-7, 9.949109460432301e-8,
        1.0195337254383306e-6, 9.529434861035407e-7, -3.582367864935077e-8,
        -9.899219889611192e-7, -9.860551934885273e-7, -2.795007497237385e-8,
        9.572456376896995e-7, 1.016156479019121e-6, 9.17564266956036e-8,
        -9.214422594155585e-7, -1.042995629515141e-6, -1.552907032651288e-7,
        8.826450528863431e-7, 1.0664190386476104e-6, 2.1821414022770906e-7,
        -8.411444573427727e-7, -1.0865026322355784e-6, -2.804174851510858e-7,
        7.970675800090695e-7, 1.103265487919619e-6, 3.418499260140344e-7,
        -7.50385883634297e-7, -1.1165121931568289e-6, -4.022407456398769e-7,
        7.012356796867175e-7, 2.47194675217167e-6, -1.8195977419630812e-5,
        0.00012392624893495387, -0.0005325693469512164, 0.0014211060014243677,
        -0.0006529032600985413, -0.011056133837523399, 0.03571392620206812,
        -0.004964644911613229, -0.025266010157938466, 0.008066155093337246,
        -0.0032161942496916974, 0.00025548457532720547, 0.00019637742313116446,
        -8.821663207232507e-5, 1.8064746210157476e-5, -2.6527289641247337e-6,
      ],
    ];
    const result = wavedec(data, "sym17");

    const reconstruction = waverec(result, "sym17", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym18", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49053716586029694, 0.9051825017153177, 1.1840418187803743,
      1.2954126870739562, 1.2413078896797134, 1.055081199867427,
      0.7918649848939399, 0.5142814238820709, 0.27702293222296276,
      0.11413291686936317, 0.032099457497481, 0.010383856550631648,
      0.009117368850204671, -0.01811425615587825, -0.10976378870574716,
      -0.2838934645655095, -0.5311004727160653, -0.8147219650282557,
      -1.078403008326303, -1.2592400877845367, -1.3032812077432905,
      -1.1795307420450376, -0.8889335592810668, -0.46602016034423693,
      0.027315476065499757, 0.5145045792374119, 0.9204686469140819,
      1.1874157132656813, 1.286514404047688, 1.2227080077774688,
      1.031617956558658, 0.7694257263800524, 0.4983328437744795,
      0.2712565539836212, 0.1195628989710032, 0.0468364478585645,
      0.03013958320422855, 0.02831209026658152, -0.0049198780575032686,
      -0.10647184425132261, -0.2918576998517036, -0.5487553575480306,
      -0.837946480201625, -1.1015301475727202, -1.276461587679065,
      -1.3100978943321908, -1.1738868592637715, -0.8717515591695376,
      -0.4410012611342966, 0.05457717425947314, 0.5378759375097009,
      0.9347644183756572, 1.1896506008625858, 1.2766107345755897,
      1.2034849390697155, 1.008066804269086, 0.7474534038814709,
      0.48328737156194707, 0.26660226294064, 0.12603499024798925,
      0.06228448298629452, 0.050097229500759455, 0.04714900151274723,
      0.00744644094523611, -0.10427096128603924, -0.300902692419671,
      -0.5672095303449987, -0.8614874850896467, -1.124409795109698,
      -1.292930954807928, -1.315843029258602, -1.1671170883859576,
      -0.8536683368481, -0.41552929441501296, 0.08173143819139105,
      0.5606061181370663, 0.9480444649121096, 1.190747212550546,
      1.2657283035935043, 1.183684562497465, 0.9844814393565854,
      0.7259961483613806, 0.4691755791055033, 0.2630654562498259,
      0.1335280734058742, 0.07840120080716845, 0.07020375392888406,
      0.06557760904190882, 0.018949347647618242, -0.10317253414261884,
      -0.31101303130916785, -0.5864246103551709, -0.8852931910101753,
      -1.1469896597341138, -1.3086084281802846, -1.320499293713796,
      -1.1592308735396437, -0.8347177518076632, -0.38965410382119325,
      0.10872485415809101, 0.5826514409214514, 0.9602857178757003,
      1.1907088332014157, 1.2538959248148334, 1.163354035196899,
      0.9609156072649758, 0.7051008985558485, 0.4560259018847794,
      0.2606489829922332, 0.14201870644223435, 0.0951427172931727,
      0.09040577509211553, 0.08354834620198798, 0.02955545151250577,
      -0.10318544786534867, -0.32217087503936775, -0.6063604708373461,
      -0.9093111829895288, -1.1692180997641661, -1.323456010293616,
      -1.3240518068713798, -1.1502401637539825, -0.814935611101288,
      -0.3634264378485309, 0.13550437180143526, 0.6039697666623369,
      0.9714674432250926, 1.1895412940804315, 1.2411445355352653,
      1.142541685856023, 0.9374229810105725, 0.6848132948741854,
      0.44386457475454183, 0.2593531377977369, 0.15148117572639574,
      0.11246372576886182, 0.1106496924936716, 0.10101268539579764,
      0.03923340025291555, -0.10431605804210592, -0.3343559918818755,
      -0.6269753297380636, -0.9334885382449828, -1.1910442397987573,
      -1.337437553070914, -1.326488159584808, -1.1401593860188002,
      -0.7943595884799493, -0.33689783521856465, 0.16201742394459354,
      0.6245205923283762, 0.9815712883136658, 1.1872529595905104,
      1.2275071266367852, 1.1212969054230308, 0.9140570398328264,
      0.6651775762348402, 0.43271557267670235, 0.25917566024400257,
      0.16188755421504036, 0.13031759943497567, 0.13088180781671974,
      0.11792324789206282, 0.047953950806358, -0.10656817635519933,
      -0.34754580553789416, -0.6482258441113578, -0.9577719458156697,
      -1.212418085744828, -1.3505188396170296, -1.3277984424971816,
      -1.1290054127422078, -0.7730291393081046, -0.31012050845722194,
      0.18821204533587765, 0.6442651425301653, 0.990581323294087,
      1.1838547082898545, 1.2130186679492123, 1.0996700354134001,
      0.8908709482834751, 0.6462364800702605, 0.4226005565618578,
      0.2601117400322146, 0.17320776467219234, 0.14865649687664015,
      0.15104844642576798, 0.1342339110390067, 0.05569003554044766,
      -0.10994306188375524, -0.361715446116324, -0.6700672080677581,
      -0.9821078270714326, -1.2332906378525652, -1.3626676616093132,
      -1.3279752684998267, -1.116797523679881, -0.7509854114517367,
      -0.28314722595005776, 0.21403699003176552, 0.6631664570871285,
      0.9984840770456322, 1.1793599082258321, 1.197716029138061,
      1.0777122540683157, 0.8679174360273656, 0.6280311457265497,
      0.4135388243427465, 0.26215402792785, 0.18540964775051305,
      0.16743147031777558, 0.17109607881462657, 0.14989991263820063,
      0.06241682354022965, -0.11443941817717845, -0.3768378062974629,
      -0.6924532540310399, -1.0064424568271686, -1.2536140015029258,
      -1.3738538921476173, -1.3270137894888057, -1.1035573624219233,
      -0.7282711523398995, -0.2560311927408793, 0.23944184715375524,
      0.6811894744907275, 1.005268567542904, 1.173784386640766,
      1.181637896297494, 1.0554754606217749, 0.8452486786269602,
      0.6106010214765332, 0.4055472673903075, 0.26529265244174943,
      0.1984590347800662, 0.18659257637685792, 0.1909714417262017,
      0.16487795224250468, 0.06811177683847836, -0.12005339610648585,
      -0.39288360255540805, -0.7153365570737958, -1.0307220847888632,
      -1.2733414954970925, -1.3840495538989215, -1.3249117073815988,
      -1.0893088875359083, -0.7049306124103392, -0.2288259303433374,
      0.26437715475727763, 0.6983011110752473, 1.0109263265974535,
      1.1671463941183036, 1.1648246844370236, 1.0330121579379268,
    ]);
    const expected = [
      [
        -0.0073109478622412245, 0.12117506206123403, 2.3484122211317584,
        1.4397757049676239, 0.938367225070009, 2.4589321237274113,
        0.6260299399940714, -0.06388100489047761, -0.08510244454407875,
        0.04191057498843549, 1.6816077400875786, 2.2139459595372437,
        0.4285667102770163, 2.5270413517925174, 0.9775711612007182,
        -0.026105471936472804, -0.5885196810195212, -2.4575916928290047,
        -0.9569613503537191, 2.3932810661517196, 1.5874851495300806,
        0.022076105750074702, -0.2518983358465368, -2.142593141096072,
        -1.7526058434972391, 1.8663419982756118, 2.076625183115254,
        0.205578855095081, -0.0511471048583043, -1.6710183330744672,
        -2.3227075790247267, 1.1007299613231152, 2.4274996114966587,
        0.5108803355103333, 0.04773776498247805, -1.1407780308166393,
        -2.60812350018835, 0.18789003392519715, 2.5564329103696575,
        0.9284564687249125, 0.0930171139449495, -0.6404347040031062,
        -2.597131660399585, -0.7552596552426941, 2.4084044886819354,
        1.412461942653927, 0.14663280781746885, -0.23626880090997945,
        -2.32423740706718, -1.6060848027938213, 1.970089497379721,
        1.887702217823562, 0.2671385230466668, 0.03909827373993607,
        -1.8611193191377167, -2.257066720354935, 1.2752663609934576,
        2.26359026164606, 0.4934284777540993, 0.19032171196053696,
        -1.3009594946563874, -2.63376615890952, 0.40131959874035766,
        2.4523137611791275, 0.8328638037555244, 0.25463711592535476,
        -0.739432872367491, -2.706483095058882, -0.5426523624336334,
        2.387463808738716, 1.256903341890722, 0.28739871446539406,
        -0.24527423029034467, -2.527394250714367, -1.3378016898043434,
        1.8939734319081871, 2.2907117506859285, 1.380478084835917,
        -2.1933715808244707, -2.160764175262028, 0.1026286170623192,
        -0.6213751077030341, -2.784482196889644, -0.4206818199679843,
        2.054941476198467, 2.3763318039922843, 0.6323241190005101,
        -2.6612591852539405, -1.4777987495862772, 0.32296065818984365,
      ],
      [
        -0.0002170457515897688, -0.03703679165174685, 0.10669753477614558,
        -0.17862702686253526, 0.5571114957363457, -0.44268736139422304,
        0.18964374966150513, -0.10200561381440028, 0.1456901080681395,
        -0.19059445013993365, 0.1395808871239295, -0.03603118715299778,
        0.13356565518688665, -0.4041163531351203, 0.17289712038949429,
        -0.06802226055979249, 0.010360894380734845, -0.007172143158781503,
        0.016724268186560292, -0.012817398274685317, -0.004650885110764615,
        0.016737693856814364, -0.009829374893578453, -0.008231572778496414,
        0.01695422099430121, -0.006437431595958096, -0.011384287908512872,
        0.016286341191549165, -0.002710009405651408, -0.01394122935864216,
        0.014775219730471295, 0.0011580238158080019, -0.015777136131241837,
        0.012492275474177843, 0.0049656028821064195, -0.016789404418707025,
        0.0095638381546489, 0.008515811793911914, -0.016931958201933512,
        0.00613410910350984, 0.011622029854869735, -0.016191552068457692,
        0.002389692706384348, 0.01412583309760708, -0.014611708424038193,
        -0.0014831963601268199, 0.015893047541049588, -0.012270406955923312,
        -0.00527476588192704, 0.016836703086389036, -0.009292570366417239,
        -0.00879624001733827, 0.016902025327607467, -0.005830792619859036,
        -0.011856462870308965, 0.016092063626649344, -0.002066225326922903,
        -0.014304059239736216, 0.014441850557266468, 0.001805565302047993,
        -0.01600456236660955, 0.012044770068752498, 0.005584205764722438,
        -0.016876192817663546, 0.009017438617209423, 0.009071316045730065,
        -0.016867706813992963, 0.005525545770448665, 0.012089503053163876,
        -0.016014907869913893, 0.002038549730344262, 0.01285116751442824,
        -0.008139655875362195, -0.019429860736466797, 0.048446213888721036,
        -0.02650307017120319, 0.084831233669724, -0.21088670657608868,
        0.09439079907709315, -0.03351848854042808, -0.0005476083223011991,
        0.02006570719646269, -0.046513074981102596, 0.08109997221501934,
        -0.12158033901706031, 0.3012430880664009, -0.23840277365514223,
        0.09727396142220507, -0.03155951439943475, -0.005945570974828246,
      ],
      [
        2.0953340063987035e-6, -4.0931168745186774e-5, 0.00030601948035387645,
        -0.001416695567423657, 0.004587002385418676, -0.010630931425577216,
        0.01602317456289271, -0.018857855701205312, 0.08330578064854549,
        -0.10786733161249899, 0.05177851400861856, -0.023595938369318052,
        0.008277637273210419, -0.002259083305156089, 0.0004383828985064747,
        -5.279828365824072e-5, 2.582649708624401e-6, -2.5377931135435383e-7,
        1.2886038786161645e-7, 3.910475674974807e-7, 2.876947296318371e-7,
        -8.458747842160822e-8, -3.7779945684097067e-7, -3.1785465321677124e-7,
        3.921071719610788e-8, 3.5961937733004385e-7, 3.4386078357254593e-7,
        6.666906640622763e-9, -3.367591727284276e-7, -3.6538862335436296e-7,
        -5.2457987331930915e-8, 3.09512599601231e-7, 3.8216069546231626e-7,
        9.757542470953105e-8, -2.7822067944963006e-7, -3.939433113272166e-7,
        -1.4141889041722223e-7, 2.43297509296041e-7, 4.005814640831491e-7,
        1.8340822306014494e-7, -2.0521196418233522e-7, -4.0200376362807145e-7,
        -2.230090014465318e-7, 1.644528828924223e-7, 3.9819115899066915e-7,
        2.597117302925061e-7, -1.215391966548125e-7, -3.89178257309577e-7,
        -2.930239049467807e-7, 7.703976653181325e-8, 3.7508496115608826e-7,
        3.225060212380874e-7, -3.1546210457450894e-8, -3.561098381871898e-7,
        -3.47788234527163e-7, -1.4358990397077313e-8, 3.324961000884159e-7,
        3.6854421483773044e-7, 6.008732957275664e-8, -3.0453735305578716e-7,
        -3.8448834607732337e-7, -1.0503059071059392e-7, 2.726041536769556e-7,
        3.954112439243445e-7, 1.4859417109290244e-7, -2.3712641206650724e-7,
        -4.0118565788243006e-7, -1.9022307178238246e-7, 1.9855907999679472e-7,
        4.0173588797455646e-7, 2.2938143950723593e-7, -1.5739242904006014e-7,
        -3.9703964665041066e-7, -2.655448085417117e-7, 1.1417247195338034e-7,
        3.8716044303736035e-7, 2.982363882145863e-7, -6.947421459584934e-8,
        -3.722419203887797e-7, -3.2704445836671923e-7, 2.3869832798818496e-8,
        3.524744985938663e-7, 3.5159681756444576e-7, 2.2056164506771536e-8,
        -3.2810160459561173e-7, -3.715583600563237e-7, -6.769305962594334e-8,
        2.994469211877248e-7, 3.8666722249297946e-7, 1.1243709527809528e-7,
        -2.6689767604913254e-7, -3.9674155672105704e-7, -1.5571783336020695e-7,
        2.3087071379267095e-7, 4.01649715303221e-7, 1.969779929615071e-7,
        -1.9182314417390423e-7, -4.013125671211938e-7, -2.3566572897720455e-7,
        1.502732407007504e-7, 3.9573667677249885e-7, 2.712712456216642e-7,
        -1.0677429845031164e-7, -3.8500961652924e-7, -3.033447791027191e-7,
        6.188295202052253e-8, 3.692672340249345e-7, 3.314716662603729e-7,
        -1.6174324681100444e-8, -3.4870044724627417e-7, -3.5527021997322596e-7,
        -2.9743740300373885e-8, 3.2358320992617964e-7, 3.744284225766549e-7,
        7.526378134114734e-8, -2.9425667888980267e-7, -3.8871163219765623e-7,
        -1.198051630952356e-7, 2.6109576341141736e-7, 3.979334143831087e-7,
        1.6279425651198046e-7, -2.2452013471648326e-7, -4.0195840343939475e-7,
        -2.0365671531313872e-7, 1.8501576045187955e-7, 4.007361667295026e-7,
        2.418542881626519e-7, -1.431093440656429e-7, 6.343407255442168e-7,
        -1.7495857484319157e-5, 0.00013278677118384348, -0.000629156128032334,
        0.002082335283337323, -0.004919514627536502, 0.007617501136148284,
        -0.009296950343159853, 0.0381450178571813, -0.048904666020352684,
        0.023590943103935724, -0.01067830443671304, 0.00370127733612943,
        -0.000991768298220673, 0.00018828627667355805, -2.220881377103495e-5,
        8.046794808185974e-7,
      ],
    ];
    const result = wavedec(data, "sym18");

    const reconstruction = waverec(result, "sym18", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym18_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49536578142662513, 0.9141698570278262, 1.1958076271838998,
      1.3078280872744354, 1.2515293436306865, 1.059725776918954,
      0.7873664872912224, 0.49741474787848927, 0.24552485635494836,
      0.06729962301806275, -0.02877910976730047, -0.06110828545438385,
      -0.06762401374274588, -0.09336830602880286, -0.17624622691932013,
      -0.3347096767103209, -0.560615635939391, -0.8191996682514393,
      -1.0563056916686924, -1.211169417229855, -1.2316258010480186,
      -1.0879577499139803, -0.7818896420800381, -0.3483872516165771,
      0.15032893882641335, 0.6372478651554825, 1.0366114252113707,
      1.2897570146916806, 1.367021301642222, 1.2729251084039528,
      1.0434954746648666, 0.7364917175588677, 0.4170160159080365,
      0.14208350073135473, -0.05206625635788209, -0.15686308563610385,
      -0.19093226254623744, -0.1925411599898785, -0.20703366105048948,
      -0.27257252530260145, -0.4079256449012996, -0.605507660433881,
      -0.8315550315113083, -1.0335032218018503, -1.1528008208789764,
      -1.1399953839607777, -0.9683103385740284, -0.6422576223940927,
      -0.1990192657813191, 0.29790922179328605, 0.7714245012116114,
      1.1469170394355448, 1.3679715788711333, 1.407954558326889,
      1.274771022240527, 1.0077320419599896, 0.6673870094499629,
      0.32087140153593874, 0.02638201883859692, -0.17944177273496986,
      -0.2882186748770007, -0.31910198871221007, -0.3109956865423528,
      -0.3098409394406715, -0.3543293347291541, -0.46377813499537884,
      -0.631342497130314, -0.8243802494424463, -0.9919662791459904,
      -1.0777300177229439, -1.034816757398769, -0.8391956923365891,
      -0.49790140245714254, -0.050013738657265966, 0.4400460640508173,
      0.8954358174717665, 1.243023980387929, 1.4289216152663173,
      1.4297316235720077, 1.25686277028802, 0.952935783640667,
      0.5812235840403207, 0.21074535972744673, -0.09933826623104025,
      -0.31225601457635205, -0.42011386988321997, -0.44290307717789434,
      -0.42046819682793757, -0.3996303203980512, -0.41985761048591563,
      -0.5012175721333658, -0.6377491489384036, -0.7980078381562932,
      -0.9327098753972036, -0.9875887223793898, -0.9182318805352965,
      -0.7031257139239351, -0.3515378150023768, 0.0958864351948025,
      0.5741513652180104, 1.007019285544042, 1.3231445659159522,
      1.4714120769707355, 1.4318285517918539, 1.2193814982112658,
      0.8799803203962369, 0.4795093224881925, 0.08868025416313718,
      -0.23263510531816756, -0.44782730054448544, -0.5498033050320152,
      -0.5597060602125125, -0.5186169115124281, -0.47450064271409226,
      -0.4678210408943987, -0.5195600167651017, -0.6247411685452511,
      -0.7531485440875483, -0.8570961064855344, -0.8843017968151403,
      -0.7926026651839901, -0.5627446063508111, -0.20591963664148535,
      0.2360011483130652, 0.6977944285021122, 1.104154061786592,
      1.3858012024532465, 1.4946060350068597, 1.4141040146330925,
      1.1628903319743333, 0.7900955280842591, 0.3640592453678177,
      -0.04304368491119098, -0.37091325767568967, -0.5834158591698058,
      -0.6745822230513607, -0.6670180993803092, -0.6033237280267629,
      -0.5328467899475946, -0.49723230390789896, -0.5185005689126804,
      -0.5927163302041648, -0.6908773045932584, -0.7668073233620111,
      -0.7700493923904361, -0.6604645743333319, -0.4207769742532615,
      -0.06378159939536598, 0.36776561381390793, 0.8087495898053156,
      1.1851005846171687, 1.4298553504883165, 1.498041110074119,
      1.3768021201970808, 1.0883233996334503, 0.6848434831843967,
      0.23695996144489048, -0.18195307416266016, -0.5114754308612054,
      -0.7162776507079324, -0.7918396453690757, -0.7625320138350533,
      -0.6727358882806913, -0.5733912622668053, -0.5074724705199003,
      -0.49811932931996494, -0.5424487571474315, -0.612612058226205,
      -0.6638130159555785, -0.647224081326021, -0.524476815326601,
      -0.27997434866845333, 0.07221324200396412, 0.48878063413116046,
      0.9050398218085132, 1.2484346507764152, 1.4545298354469394,
      1.4816385530781915, 1.3205476670561502, 0.9969675706297884,
      0.5660878865875013, 0.10052878379644442, -0.3254298841891924,
      -0.6515752259990505, -0.843718274543884, -0.8991097025771841,
      -0.8441716640987751, -0.7253024365079932, -0.5952093151165052,
      -0.49830317404852037, -0.4588798004706454, -0.4750736592052757,
      -0.5200858207161677, -0.5503310604706255, -0.5183838192146666,
      -0.38737010550428264, -0.1430611850800495, 0.19952573415245772,
      0.5968596181806134, 0.9849754570404812, 1.293075301595795,
      1.4594240660012554, 1.4457047961720033, 1.2463339262158717,
      0.8904372710397256, 0.4359575659490079, -0.04273168413213613,
      -0.47076278781432074, -0.7884710489987568, -0.963145903821442,
      -0.9941201172640881, -0.9101328003144558, -0.7598047514683127,
      -0.5977471711636524, -0.46987130638244834, -0.40161975887768125,
      -0.39206498028971426, -0.4153125748997493, -0.4287840908539233,
      -0.3862016620427375, -0.2518930357821466, -0.012681394883769237,
      0.31579041512176276, 0.6900714239504422, 1.0471872697648554,
      1.318305971842419, 1.444521861058354, 1.3909254438563294,
      1.1555031908655127, 0.7706428691725178, 0.2968047730851763,
      -0.1901826010053595, -0.6152003416150498, -0.9194799293521227,
      -1.0721222080724941, -1.0748368873713527, -0.9589185730032288,
      -0.7753805535624925, -0.5808329479606658, -0.4227061489845898,
      -0.32753477785120017, -0.2952063945955154, -0.3005476442839367,
      -0.3017518509815806, -0.25341322490219187, -0.12075808516277453,
      0.10865354004512884, 0.41886189326553186, 0.7667781854729747,
      1.0906532672637916, 1.3237884859806468, 1.4101917317864143,
      1.3183518221030033, 1.049720475739995,
    ]);
    const expected = [
      [
        -0.15855743083055346, 0.0217417398376932, 2.358584586743163,
        1.4571499991648955, 0.9447074705399741, 2.481755022670757,
        0.5590755738368525, -0.20775827116628584, -0.2262737992822371,
        -0.08005305795105755, 1.676194727278192, 2.238454601244249,
        0.4322258931201991, 2.5479017768702175, 0.9442895088923511,
        -0.16530687570513566, -0.6871828411564873, -2.359017225488179,
        -0.7242531850018116, 2.590689745513222, 1.5192116925250398,
        -0.3819376009991849, -0.5799316521968532, -2.0001416186712415,
        -1.292243832277181, 2.28010940419398, 2.0682008734827524,
        -0.40255076708425686, -0.6807722065857567, -1.5878768238037873,
        -1.6600708253678114, 1.7592185861321452, 2.5595537313091743,
        -0.2130320796774783, -0.9183809243899131, -1.2334180295349115,
        -1.7911748937450331, 1.1101437584411415, 2.891357446785139,
        0.19060778398743228, -1.1999283164188703, -1.0249998573075456,
        -1.7018290919495098, 0.4406145886989824, 2.9923320413945786,
        0.7612412316801795, -1.4191082755200084, -1.0117120418637768,
        -1.4560538264224316, -0.14013990310226646, 2.83803883090882,
        1.4107667920971767, -1.4809706173889463, -1.192275762012739,
        -1.1504129753183174, -0.5457260770518247, 2.456476625066968,
        2.0296418853307587, -1.3242012186258831, -1.515394139908218,
        -0.8914261057107169, -0.7316740345857696, 1.9217901738474614,
        2.5113554888609086, -0.9357568023179135, -1.8915961235363405,
        -0.7707590943452065, -0.7049315841311602, 1.3375301880277601,
        2.7761514687898527, -0.3535301785629712, -2.2197859683446572,
        -0.8202475186912623, -0.5926584484816748, 1.0420013334896092,
        2.5291618793052337, 2.5728532827471584, 1.5459826980864297,
        -0.6095828891611051, -0.6826499006695074, -1.9114577785479232,
        -1.140187389473234, -0.6501692560386667, 0.3291155266324237,
        2.4084072379700077, 2.4949074963504763, 2.1922810138915994,
        -0.2821826886509577, -0.5653635363475843, -1.5189339966924589,
      ],
      [
        0.00042118537264117055, -0.03755598890321896, 0.10720927215794539,
        -0.1792124429295085, 0.5607100620884997, -0.44445536886834275,
        0.18852079841425326, -0.09985265012434784, 0.13592538494004436,
        -0.17806357324473937, 0.13347120297494283, -0.03253141299269085,
        0.13305442024752753, -0.40721634169759746, 0.17448078590143176,
        -0.06917718239936928, 0.01115374503513414, -0.007544001557762494,
        0.016490164759327634, -0.01219064005665984, -0.005040591239764152,
        0.016407656848846264, -0.009028869550068147, -0.008662321298028715,
        0.01646120996462191, -0.005454393800476172, -0.011784452640456208,
        0.015558649711272677, -0.0015614119008405965, -0.014218323255280732,
        0.013758910671924394, 0.002419562527652546, -0.01583508833269391,
        0.011158843892975643, 0.006262536289202947, -0.01652919389587262,
        0.007916858729038658, 0.009741230911859704, -0.016272278397461034,
        0.004212224854261787, 0.012657388053149568, -0.015067571050541082,
        0.0002683144256682206, 0.014839749862089966, -0.01299624081981496,
        -0.003695927000339979, 0.0161637188681188, -0.010167027564882181,
        -0.007441201235860035, 0.016551610068007084, -0.006754595374208375,
        -0.010760893781951174, 0.015981300882792225, -0.0029459461765512997,
        -0.013452256365782445, 0.01448618160192805, 0.0010282525863716373,
        -0.015370379515057124, 0.012151725675065617, 0.004947709955797718,
        -0.01639303335674051, 0.009114860143935867, 0.008576179415974532,
        -0.016472456441036325, 0.0055489131185815195, 0.01171248215875954,
        -0.015592389001036006, 0.0016637092856844028, 0.014168968498685491,
        -0.013889866276901653, -0.0016476936681948755, 0.012257511388127338,
        0.0020839371423891128, -0.04257643240020785, 0.08186370071359024,
        -0.11280449876526105, 0.4661051145604443, -0.32187406087256537,
        0.1723758334748019, -0.06300190730284588, -0.043202383752965014,
        0.08194572127825898, -0.07548209874033582, 0.08100275098588021,
        -0.050235681627148636, 0.09047539846775605, -0.38416864798035827,
        0.16641924414924597, -0.06670823523223511, 0.00594703205971294,
      ],
      [
        2.133457700814708e-6, -4.132170538481923e-5, 0.00030904121937723006,
        -0.0014306330571130551, 0.004631684339708766, -0.01073347421138511,
        0.01617546963520361, -0.019033632088381183, 0.08410914911850557,
        -0.10891276073292488, 0.05228023392788673, -0.023825603707866023,
        0.008358693589190247, -0.002281366976295068, 0.00044271884180132644,
        -5.330983129641132e-5, 2.626660289917542e-6, -2.505750831330621e-7,
        1.1692163109443433e-7, 3.755454868488588e-7, 2.8446445842757293e-7,
        -7.150880808917187e-8, -3.6089407964904564e-7, -3.1421765211310004e-7,
        2.5053991052606888e-8, 3.409905708825755e-7, 3.3939267669990564e-7,
        2.1750296822989554e-8, -3.161451756118516e-7, -3.5964285743375694e-7,
        -6.823619789502727e-8, 2.867168878115119e-7, 3.7468274870889424e-7,
        1.1374553056251295e-7, -2.531121794987362e-7, -3.842743753703637e-7,
        -1.5760425100406951e-7, 2.158222922779171e-7, 3.882708565080526e-7,
        1.991589995189798e-7, -1.754096922829188e-7, -3.8663408871462584e-7,
        -2.378201205469351e-7, 1.3245705755248738e-7, 3.793942488698296e-7,
        2.7304151578051514e-7, -8.756773894676259e-8, -3.6663617210056403e-7,
        -3.042967273124281e-7, 4.1399318466418905e-8, 3.485399631718462e-7,
        3.311171514986078e-7, 5.357358681401254e-9, -3.2538911224722963e-7,
        -3.531289026614747e-7, -5.2029839919720254e-8, 2.9752389894285163e-7,
        3.700259458965859e-7, 9.796002469890932e-8, -2.653282238741504e-7,
        -3.8154634247119833e-7, -1.424728806131193e-7, 2.2926694105774193e-7,
        3.8751002246551473e-7, 1.849024595865854e-7, -1.8988490443140315e-7,
        -3.8784760737299183e-7, -2.2464144470741452e-7, 1.4775571047196903e-7,
        3.825659098510164e-7, 2.611314738667985e-7, -1.0347018629636052e-7,
        -3.717237295341233e-7, -2.93832397854624e-7, 5.7671282092377735e-8,
        3.554678732270843e-7, 3.222509550154354e-7, -1.104537772235451e-8,
        -3.3405301372062093e-7, -3.459855235766103e-7, -3.573116151930467e-8,
        3.077998106402631e-7, 3.647089598461822e-7, 8.199996632967528e-8,
        -2.7707049116955023e-7, -3.781370980643257e-7, -1.2708682980416037e-7,
        2.4230294791099726e-7, 3.860579879046267e-7, 1.7031587528165748e-7,
        -2.0402178157925026e-7, -3.8836975388460366e-7, -2.1106254094465057e-7,
        1.6279039707133855e-7, 3.8505495597478256e-7, 2.487557224755632e-7,
        -1.1918765936457084e-7, -3.761476094791211e-7, -2.828433412793831e-7,
        7.384075929109153e-8, 3.617617958868618e-7, 3.128097558905064e-7,
        -2.7428772806830137e-8, -3.421214926191401e-7, -3.382254576952378e-7,
        -1.936916711516116e-8, 3.175264238752211e-7, 3.587414261005159e-7,
        6.589397242766145e-8, -2.883179780167785e-7, -3.740527216326403e-7,
        -1.1147362255950204e-7, 2.5490690907829576e-7, 3.839171822906262e-7,
        1.554251427409594e-7, -2.1779518818600618e-7, -3.881996114130825e-7,
        -1.9710757326479016e-7, 1.7753441664445984e-7, 3.868570936541531e-7,
        2.35936493575232e-7, -1.3469202278477542e-7, -3.798999070823055e-7,
        -2.7134922930461e-7, 8.987878715722456e-8, 3.674103694376561e-7,
        3.0281025416636576e-7, 5.765794592960683e-7, -8.904282825027387e-6,
        5.029918436403739e-5, -0.00014477751468891439, 3.224365124150142e-5,
        0.0013193572972974644, -0.00599900178783597, 0.021473491519935127,
        -0.06729887251883838, 0.051078290393605875, -0.0014587836177721992,
        0.00162650449259597, -0.001339269142705219, 0.000984329056394359,
        -0.0004033710376524736, 0.00010209636690690517, -1.5934663302506603e-5,
        9.606442141529308e-7,
      ],
    ];
    const result = wavedec(data, "sym18");

    const reconstruction = waverec(result, "sym18", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym19", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.49196176775499806, 0.9073492776151018, 1.1858285207748505,
      1.295661123393408, 1.2392522737168763, 1.0506525932721316,
      0.7857602768675331, 0.5077600191560336, 0.2714843654585101,
      0.1106058946568737, 0.030812204473121163, 0.010572649625375102,
      0.009165802335804274, -0.02021158905945708, -0.1157245968733917,
      -0.29444893145318163, -0.5454930347762664, -0.8305823696482192,
      -1.0920952468317178, -1.2666340307086053, -1.3007842835274834,
      -1.165118980169674, -0.8628976144297181, -0.4311953546882533,
      0.06594406276517567, 0.5507698070273188, 0.9483515232630049,
      1.2024165794979649, 1.286712596117824, 1.2092200044082255,
      1.0083083324971314, 0.7419166311228235, 0.4725468746380828,
      0.2518634995353046, 0.10874352335404519, 0.04371006722627746,
      0.03103910864555047, 0.027869577555036523, -0.012135869253077802,
      -0.12418918439031101, -0.3206844727783895, -0.5855277934741943,
      -0.8760731695471723, -1.1323122173869338, -1.291108272253587,
      -1.3019572647106812, -1.1403277948251442, -0.81519260421082,
      -0.36877559350064043, 0.1315485499029694, 0.6073283537579074,
      0.9857326196151653, 1.2148720101644788, 1.2740893955889885,
      1.176810850019249, 0.9653897838922996, 0.6993502702389826,
      0.4400494624648805, 0.23563105380646648, 0.11002124515313028,
      0.058658885645872794, 0.05192099377301331, 0.04524031498651679,
      -0.006792254762463201, -0.13606178637129568, -0.35009075851536575,
      -0.6276255148279635, -0.9219143605370824, -1.170985127288191,
      -1.3124365868832695, -1.2990821240745973, -1.111523250978502,
      -0.7644532454501005, -0.3050191899385464, 0.19647637140918292,
      0.6613623183381402, 1.019346401367551, 1.223212383871304,
      1.2579669168578647, 1.1423129704390749, 0.9222250331961258,
      0.658346888130452, 0.4104399326156696, 0.22280345835342202,
      0.11429708331259864, 0.07539566134532086, 0.0729022550345233,
      0.06099029655389987, -0.0043658767241949725, -0.15137657329502002,
      -0.3825407592836798, -0.6715285381245221, -0.9677814430600339,
      -1.207803710315424, -1.330400983563589, -1.2920885730199854,
      -1.0788016283153123, -0.7109198814445512, -0.2402522151153212,
      0.2603953897831335, 0.7126146418716154, 1.0490733050872856,
      1.227483799550311, 1.2385438901133057, 1.1060268586723412,
      0.8791404512775074, 0.6191768940820435, 0.3838654601268864,
      0.21336878293967854, 0.12140446218282674, 0.09364275278017009,
      0.09366584206490218, 0.07484470076572719, -0.005018315262896422,
      -0.17013943589305008, -0.4178815589104794, -0.7169622388116448,
      -1.0133461751282593, -1.2424681654748864, -1.3448055678532636,
      -1.2809345550534639, -1.0422865339633836, -0.6548524566171945,
      -0.17480772040514203, 0.32298084956403833, 0.760848162022195,
      1.0748212045484324, 1.2277604802524062, 1.2160408398921292,
      1.0682630498522743, 0.836458227685885, 0.5820933892962624,
      0.3604471717447186, 0.20728688238515397, 0.1311535341050069,
      0.11311005003500771, 0.11389618042298301, 0.08654375854336932,
      -0.008886305788027016, -0.19232787894562886, -0.45593546318787476,
      -0.7636370748289616, -1.058279043505109, -1.2746914335105255,
      -1.3554780527659258, -1.2656066117424298, -1.0021280311284735,
      -0.5965286254810394, -0.10902329992052023, 0.3839177512042528,
      0.8058473290754162, 1.0965260397087164, 1.224144158231036,
      1.1906983811874763, 1.0293397561268791, 0.7944939376127762,
      0.5473302759879686, 0.3402792710013439, 0.20448975646465856,
      0.1433326831254631, 0.1334972443679946, 0.1332816368399039,
      0.09584479492995562, -0.016080633840868275, -0.21789113076925543,
      -0.4965012973633605, -0.8112507473687385, -1.1022517462964132,
      -1.304201378920928, -1.3622710929031807, -1.2461200339982357,
      -0.9585015689248423, -0.536241728499291, -0.04323861895356002,
      0.44290315138097835, 0.8474197592838064, 1.1141522346081256,
      1.2167632534994404, 1.1627753653506538, 0.9895804453006156,
      0.7535541606501933, 0.515100513304866, 0.3234283683060315,
      0.2048821215821774, 0.15771019412691373, 0.15449617532312748,
      0.15151695472907792, 0.10252414121137582, -0.026685226879594293,
      -0.24675046759939773, -0.5393558825813645, -0.8594904597516035,
      -1.144939668195335, -1.3307428609860446, -1.3650634317602912,
      -1.2225187975192862, -0.9116067214555281, -0.47429865010088734,
      0.022207072982218093, 0.4996483724039654, 0.8853976137957889,
      1.1276929010648833, 1.2057718520959533, 1.1325468898158078,
      0.9493113815379772, 0.7139341693388919, 0.48559453324170204,
      0.30993302109228543, 0.20834218987149938, 0.1740360747277513,
      0.17579323763378776, 0.16830564151226535, 0.10637890295986263,
      -0.04075644990184013, -0.27879975044695793, -0.5842556801406276,
      -0.9080352573599225, -1.1860243296783524, -1.3540796781457818,
      -1.3637608535172907, -1.194875282855971, -0.8616657456378702,
      -0.41101757499979774, 0.08697742575614131, 0.5538811040630134,
      0.9196387927858654, 1.1371698266626182, 1.1913484918044577,
      1.1003021867052252, 0.9088591467212822, 0.6759157049713387,
      0.45897882850622873, 0.2998034874740639, 0.214722649805613,
      0.19204401614535183, 0.19707182968933024, 0.1833622896798095,
      0.10722857059983376, -0.05832261026330121, -0.3139061704010914,
      -0.6309385911634537, -0.9565584309583403, -1.2251957916459066,
      -1.373996371028623, -1.358296932104871, -1.1632897821864516,
      -0.8089219686394392, -0.34672565973551256, 0.15074145014291798,
      0.6053473820726404, 0.9500279357995937, 1.1426332471519691,
      1.173694764531596, 1.0663424062872495, 0.8685481612001498,
    ]);
    const expected = [
      [
        -0.7806372426292378, 0.0927347493376957, 0.6687473332480874,
        2.463012423937406, 0.782831976700159, 1.6672519372724777,
        2.2554605776528414, -0.11283238837378555, -0.1166804503837002,
        -1.4398640667379783, -0.4456152749653634, 0.14179500304895462,
        1.5794640293152402, 2.0119784133935825, 0.4672121736919181,
        2.7551772472849274, 0.9611492516762674, 0.15757668884599865,
        -0.700593011741479, -2.6702921711101255, -0.5746237767875643,
        2.4182245185133637, 1.2779827330828977, 0.22346301437982183,
        -0.28815330697817826, -2.46943714340147, -1.3951313239409653,
        2.0906543311578516, 1.7036290914254786, 0.29934572557904643,
        0.03077164976301762, -2.082076197626816, -2.0731998424974822,
        1.5340491001999452, 2.0754665057599624, 0.44740498398056056,
        0.23533160026151678, -1.5743970311849875, -2.5391976414554676,
        0.795481312533666, 2.3239836683218167, 0.68586042307132,
        0.34196676323426256, -1.0229009990447981, -2.7521460126085264,
        -0.050881517536724576, 2.388621421945566, 1.0084614461139567,
        0.3870767695986918, -0.49965721061763374, -2.7050783548168207,
        -0.9137801446554145, 2.2291798042542657, 1.3837284733379507,
        0.4178358769418004, -0.061054220018216185, -2.424675405334526,
        -1.6977606385466455, 1.834302562105761, 1.7591229298728666,
        0.4811361862473172, 0.26016642599233564, -1.9656719716065054,
        -2.3168676890673514, 1.225490380417304, 2.069490843385495,
        0.6127250776755842, 0.45830976565213855, -1.4010541722427492,
        -2.7069180642986774, 0.4558719288367658, 2.248300224761253,
        0.8283587049184976, 0.5533623126120262, -0.8047518867817713,
        -2.840038203519775, -0.46590197419466123, 2.198642727155666,
        1.9602805743259104, 1.8030108986282172, -1.7262124229977993,
        -2.1005051115458317, -0.3173677282998644, -2.3195128555772015,
        -2.0779459926089543, 1.6985896728448573, 2.153432825967308,
        1.9615485311944876, -0.08673697264361527, -2.8396062606802785,
        -0.8605799809873318,
      ],
      [
        0.04141503385201353, -0.14685661977299855, 0.36798806350534413,
        -0.5731457831262173, 0.16460088865728348, -0.10180291583367791,
        -0.006841204161600832, 0.13604537397973984, -0.09757043727104085,
        0.020113229824386493, -0.034728387445581585, 0.032058880649798525,
        0.016121494047950328, 0.3339630111986568, -0.14113796526557287,
        -0.020325463112252872, 0.016756769312784858, -0.0006186121818846985,
        -0.011505605416694733, 0.009502331494672313, 0.004987910445466729,
        -0.014677938995163028, 0.008032589638189314, 0.007625466810950682,
        -0.014719367227385288, 0.005278266436926816, 0.010092952862649154,
        -0.014125282873120133, 0.0022903105110492227, 0.012116769443074452,
        -0.012913554203246665, -0.000796454006627445, 0.013612379092697061,
        -0.0111358380766651, -0.003849600329852078, 0.014510095233601994,
        -0.008871775027749334, -0.006733230793030313, 0.014774885813663968,
        -0.006218190498612685, -0.009322984134297463, 0.014390931664543718,
        -0.003293885049994319, -0.011504123247729365, 0.013379184064798497,
        -0.0002238190551860622, -0.013182110203308702, 0.011779914464688174,
        0.0028542924916945384, -0.014283065318415203, 0.009666935505507375,
        0.005809360214830964, -0.014758755769868468, 0.007129147320152405,
        0.008508191588097735, -0.01458889788193091, 0.004280908918978423,
        0.010836708881610296, -0.013779909603580932, 0.0012439197759213747,
        0.012688833603481118, -0.012368680703140563, -0.0018463148702881865,
        0.013987744986153038, -0.010415044702090455, -0.004856728697646826,
        0.014672332468545062, -0.008006740059607765, -0.007655355468325275,
        0.014731724218558354, -0.005326568114100828, -0.009818998948232802,
        0.013676045392826639, -0.0019225047295623073, -0.007773335079300695,
        0.01970050543460389, -0.004366080809710664, 0.17483579999127588,
        -0.08220221082851824, 0.017883267345842873, -0.055519999254869716,
        0.02676108315853054, 0.03365389712481738, -0.0738215038982612,
        0.19775310411399022, -0.3140912790797527, 0.11500447564000875,
        -0.08135196426738117, 0.034709874164085226, 0.0003361538660799737,
        -0.005543232519452749,
      ],
      [
        -1.3723988274214335e-6, 3.095875934503532e-5, -0.0002872373544267508,
        0.0016902676344266031, -0.006797220540078092, 0.021211130643603162,
        -0.04511689252246027, 0.08115330808772672, -0.03878751948286077,
        -0.010654264866880793, -0.00950280603960044, 0.010623067251129483,
        -0.005030547770651839, 0.001979255446604705, -0.0006323430290892594,
        0.00013940267544296453, -1.8208591179687136e-5, 9.588594611081156e-7,
        -2.0118635778941277e-7, -8.620146023657505e-8, 1.0982358022567359e-7,
        2.026020869891433e-7, 1.0491128349110388e-7, -9.140789293947589e-8,
        -2.0179223204279743e-7, -1.2246767087880717e-7, 7.199078058836327e-8,
        1.9876857634389992e-7, 1.3867925697426383e-7, -5.178597579653255e-8,
        -1.935667607420595e-7, -1.533718065308305e-7, 3.101126834657095e-8,
        1.8624068791261575e-7, 1.6638244210497063e-7, -9.894341396513343e-9,
        -1.7686862293276126e-7, -1.7756497704737914e-7, -1.132918956141834e-8,
        1.655568171986361e-7, 1.8679878533569482e-7, 3.24266765105581e-8,
        -1.524310920333498e-7, -1.9398576396283017e-7, -5.317053565463802e-8,
        1.37631843604627e-7, 1.9904461404472162e-7, 7.333252739564053e-8,
        -1.2132015134435806e-7, -2.0191692077498556e-7, -9.268761173780223e-8,
        1.0367873660297904e-7, 2.0257393371474627e-7, 1.1102452246336852e-7,
        -8.490202838880832e-8, -2.0101105544228676e-7, -1.2814576937051391e-7,
        6.519217387189359e-8, 1.9724235316592295e-7, 1.4386199503832687e-7,
        -4.476500447059237e-8, -1.9130693077807705e-7, -1.5799723288644828e-7,
        2.3848545143902846e-8, 1.8327323607026404e-7, 1.7039832194957819e-7,
        -2.672267396700656e-9, -1.7323128749587046e-7, -1.809324976021794e-7,
        -1.8535407280654223e-8, 1.612877093362788e-7, 1.8948189547041115e-7,
        3.9541311063291426e-8, -1.475720868460384e-7, -1.9594966062580267e-7,
        -6.011112516632648e-8, 1.322386197912625e-7, 2.0026748889160395e-7,
        8.002007645695814e-8, -1.1545656138468882e-7, -2.0239072977651057e-7,
        -9.90534865311458e-8, 9.740622322744659e-8, 2.0229314246159967e-7,
        1.1700117687580558e-7, -7.828505647929746e-8, -1.999733944870615e-7,
        -1.336626331416113e-7, 5.8306733998959296e-8, 1.9546016215449578e-7,
        1.4885680761394746e-7, -3.769061349890274e-8, -1.8880500547423304e-7,
        -1.6242039505636184e-7, 1.6658974115475713e-8, 1.800774697421529e-7,
        1.742024288505155e-7, 4.557144328560082e-9, -1.6937167107463145e-7,
        -1.8407047915844135e-7, -2.5721077709513347e-8, 1.5680874939238293e-7,
        1.9191881658256118e-7, 4.6601355654959914e-8, -1.4252773025293427e-7,
        -1.976641621600936e-7, -6.697269723152096e-8, 1.2668150144556158e-7,
        2.0124065837193585e-7, 8.661040483086369e-8, -1.0944317802871539e-7,
        -2.0260652592505517e-7, -1.0529535859664569e-7, 9.100574625165012e-8,
        2.0174990930845213e-7, 1.2282415987603417e-7, -7.157183765152873e-8,
        -1.9868237361567972e-7, -1.3900795949857083e-7, 5.135075704296208e-8,
        1.9343421154102094e-7, 1.536672044380785e-7, -3.056447980454932e-8,
        -1.8606120044120498e-7, -1.66637791152552e-7, 9.444980084212121e-9,
        1.7664782796306946e-7, 1.7777980313768417e-7, -6.211491993785321e-7,
        1.395564338333433e-5, -0.00013298755376517387, 0.0007936072656838346,
        -0.0032259083011349004, 0.010139642339590887, -0.021677272530503697,
        0.03902614829035793, -0.01896782343976271, -0.004590373912710009,
        -0.004893463176017375, 0.005282513629992078, -0.0024863850186832665,
        0.000963337476985241, -0.0003021059073174209, 6.561314762289328e-5,
        -8.339325507658335e-6, 4.116963152774329e-7,
      ],
    ];
    const result = wavedec(data, "sym19");

    const reconstruction = waverec(result, "sym19", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym19_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5000255430662885, 0.9185437909111014, 1.1922569948050115,
      1.289704825887163, 1.216920763040073, 1.0137982176418399,
      0.742254659416353, 0.46939419860865667, 0.25013368471738645,
      0.11384501377314898, 0.05845739790884957, 0.05345296861388675,
      0.050809245719697416, 0.0008213994198587593, -0.13156430769819943,
      -0.3544134265828182, -0.6439095604950572, -0.9483705246157355,
      -1.2002632072104904, -1.3331584391477247, -1.2992177916821734,
      -1.0826111393762319, -0.7052812768866333, -0.22343562119098728,
      0.2844583576249412, 0.7351955884456853, 1.0594655458749145,
      1.21690279383097, 1.203802119296596, 1.0516562109480545,
      0.817058083024889, 0.5657418693543396, 0.35502977300937355,
      0.21931986204625004, 0.16239591112181023, 0.15849459889215728,
      0.1617160091406916, 0.12113156530048147, -0.002581211285992535,
      -0.22356258553329345, -0.5240335817154511, -0.8563654058474057,
      -1.153579412532445, -1.345646450473339, -1.377382898443765,
      -1.223269321447518, -0.8952737643029534, -0.4415498011638344,
      0.06376746858209162, 0.5371422221686216, 0.904422254751232,
      1.117091310481734, 1.1619240772090138, 1.0617046676220092,
      0.8669979762965557, 0.6412831312239211, 0.4434612384905435,
      0.3123905243289531, 0.2575154208659064, 0.25799987113962713,
      0.27048831170701493, 0.24330525044441176, 0.13317724681677823,
      -0.08012405654035265, -0.3852807615997068, -0.7395113792460735,
      -1.077402652323654, -1.3263236225155532, -1.424482750028095,
      -1.336945460372486, -1.065413592560825, -0.6491558900765048,
      -0.1567556761508202, 0.32928755698043366, 0.7312224776005525,
      0.9932623232480082, 1.0930333174323656, 1.044451808036848,
      0.8914676450339534, 0.6944875338340749, 0.5131803163832556,
      0.3902720134008459, 0.34062665611859566, 0.34846479787696133,
      0.37337851360687396, 0.36344000566009416, 0.27179502791631416,
      0.07218619480499255, -0.2308843302789872, -0.6002367332534191,
      -0.9730451446382842, -1.2751467275578428, -1.439007186705911,
      -1.4207161367523735, -1.2115909985564903, -0.8413332793662802,
      -0.3718505192763265, 0.1167364651219572, 0.5443680192566545,
      0.8489752616882841, 0.9995503199508424, 1.0011292275220858,
      0.8905817182553614, 0.724502005765657, 0.5625419843663331,
      0.4506864980930797, 0.40893732632498997, 0.4266601270021871,
      0.46677912178543096, 0.47762569668773824, 0.409188390817114,
      0.22931747889485887, -0.06457593965001346, -0.4416136228963593,
      -0.8425727449143319, -1.1928835953367591, -1.4202498420735135,
      -1.4723848515170521, -1.3302808791032132, -1.0135516636447395,
      -0.5764207772819224, -0.09533692045910114, 0.3486471506165893,
      0.6882572370613352, 0.8844957356650134, 0.9336477353901133,
      0.865162227395462, 0.7311659215429914, 0.5905453868850075,
      0.4919276822900718, 0.4601356910809618, 0.48973011577153525,
      0.547332445082805, 0.5820601180872245, 0.5412216916718293,
      0.386993671004413, 0.10950971947391225, -0.26728412085395303,
      -0.6887592462410703, -1.0811007889950404, -1.3683317293300319,
      -1.4905408442230335, -1.4186327713054396, -1.1617850553518703,
      -0.7656631098121477, -0.3018220342711265, 0.1490079818798137,
      0.5154917045101034, 0.7514013271223416, 0.8445350681657073,
      0.8167051317145153, 0.7150064151349868, 0.5968564258714778,
      0.5129082500054543, 0.4924599346354481, 0.5352805596489525,
      0.6120335460478777, 0.6731624065724264, 0.6638257791183447,
      0.5408299578671066, 0.2869423943705905, -0.08137010899469782,
      -0.5150213894984326, -0.9421301271340905, -1.284203321561482,
      -1.4745976740449835, -1.4745434286713892, -1.2826125675310163,
      -0.9351877008372047, -0.497802271816773, -0.049571402086168614,
      0.3352986517475032, 0.6042080046718707, 0.7368573197842694,
      0.7473283573551179, 0.6772141931544802, 0.5818109653413168,
      0.5131890672193107, 0.5047513617925306, 0.5614535300768937,
      0.6583235185919283, 0.747681019945329, 0.773115671421641,
      0.6864538492980646, 0.4631129769671757, 0.11163065398680794,
      -0.32533621261761153, -0.7790148394221423, -1.169624994945525,
      -1.424810507511571, -1.496710080559236, -1.3733033345337522,
      -1.0811275996431424, -0.6786795085651344, -0.24221256494289717,
      0.15240959253374625, 0.4471538227544264, 0.6141263690897053,
      0.6597029242215013, 0.619600644165065, 0.5463986437698403,
      0.4929893485743944, 0.4964898902731905, 0.5669866481987034,
      0.684170385798498, 0.8027931880080104, 0.8655042068502004,
      0.8196271277210716, 0.6333563069563485, 0.30695956518825646,
      -0.12414285265403738, -0.5954366929117453, -1.0271262815902544,
      -1.3422716226295848, -1.4846629758624807, -1.4318833651656822,
      -1.2002339763626544, -0.8402894730459115, -0.4242626425372421,
      -0.028459232092571396, 0.2846550600150062, 0.48019595830528344,
      0.5569691964006427, 0.5445375600833839, 0.492227833636376,
      0.45317753602183775, 0.46781081577789957, 0.5512551557894327,
      0.6881352535410357, 0.836192968661582, 0.9378084548350862,
      0.9363653652452602, 0.7930767550351103, 0.4997202716231003,
      0.0837686570269604, -0.3956259411839815, -0.8599449455063415,
      -1.2288842182961182, -1.438776362653423, -1.4571826062411335,
      -1.2899548293407053, -0.9790049590746182, -0.5914132235739332,
      -0.20273201011784608, 0.12118367957032278, 0.3391493751838409,
      0.442640695577322, 0.4548812672579381, 0.4214728169151425,
      0.3952431820758411, 0.41950235592354346, 0.5142955280875552,
      0.6694217636976671, 0.8461653497188143,
    ]);
    const expected = [
      [
        -0.951734767029967, 0.21047837998923183, 0.5958518302289691,
        2.427071813008495, 0.8130822412037862, 1.6573346148486838,
        2.199340872002883, -0.09324723841654547, -0.1079032804092765,
        -1.675397806029603, -0.4500790661162664, 0.18314040192784384,
        1.4816455965626287, 2.035154262769935, 0.47234564053750333,
        2.731817013698937, 0.9082340364125139, 0.22800514934229366,
        -0.8572389966184504, -2.7474508743415913, -0.1507494945071822,
        2.3753791423697117, 0.9885329548140579, 0.46613544462322803,
        -0.5942307051826987, -2.803906584769335, -0.5918011080229912,
        2.208072370851959, 1.1305035580699228, 0.6657614695114827,
        -0.2912008584312302, -2.7975946463913126, -1.016447848917566,
        1.9922985021105653, 1.230046261220839, 0.8461885631007964,
        0.03219646939260667, -2.725657585631608, -1.4150114596070018,
        1.7346575049189443, 1.2853817814371726, 1.0008872499499357,
        0.36768867393607124, -2.58904497130802, -1.7781465731943826,
        1.442704262706677, 1.2960857478072665, 1.1240682083182678,
        0.706493622901999, -2.390340806675014, -2.097432519117078,
        1.1247521837674315, 1.2630857539245073, 1.2108617827793928,
        1.0395546013828714, -2.133708653812068, -2.3655830170431877,
        0.7896411373762469, 1.1886191812541262, 1.2574719144992523,
        1.3577853185217872, -1.8247951577426273, -2.5766257141803175,
        0.4464935197545313, 1.0761535975831307, 1.2612996078348648,
        1.6523182895534307, -1.4705943259064407, -2.7260476953808777,
        0.10447472346957168, 0.9301961054344177, 1.2214053692587514,
        1.9136324332141657, -1.0765834597673116, -2.8220588356254703,
        -0.18826107100943007, 0.7410007840059873, 1.0144767476445382,
        1.4883937803028346, 0.8965670157960359, 0.28235706943167777,
        -2.6307727219097305, -2.317064559256571, -2.6198574301354998,
        -0.23146272721850172, 0.9763737930645247, 1.0069366275991538,
        1.4995312936823433, 0.7652945680175816, -0.13533234670649663,
        -2.789251802154916,
      ],
      [
        0.04079164424741609, -0.15471913350357774, 0.385373901720417,
        -0.5964767158109209, 0.1785211347715138, -0.1132599686468004,
        0.00046890544199022685, 0.13409283781874787, -0.10335853657559489,
        0.03091770539558312, -0.04383721368610101, 0.038468510590574774,
        0.012776160929962069, 0.3429971306072929, -0.14304035185897254,
        -0.02576936405237649, 0.02363968239524748, -0.004329455557686227,
        -0.014212059529471355, 0.016842569946560273, -0.00024597087893028915,
        -0.01741607272888138, 0.017224860683819135, 0.0007663243408891291,
        -0.01796717091008816, 0.016589296549616904, 0.001943671723049448,
        -0.01846561305214025, 0.01589352984514721, 0.0031120855610827216,
        -0.018900911639896097, 0.015145160010850598, 0.004272246664285837,
        -0.019270712890245803, 0.014342860705259558, 0.005415218453431597,
        -0.019575031359973464, 0.013492992149958747, 0.006542132072014765,
        -0.01981112470581913, 0.012595192814738294, 0.0076439799967496,
        -0.01998027732058193, 0.01165548757132292, 0.008722149967853096,
        -0.020079427103717167, 0.01067452988327116, 0.009767757439654766,
        -0.020111081996462558, 0.009657886343160846, 0.010782356960506233,
        -0.020071936107799036, 0.008607251643785781, 0.011757379784242404,
        -0.01996564754305436, 0.007527627634166481, 0.012694455549529412,
        -0.019788755727219304, 0.006421751552474, 0.01358551846374787,
        -0.019545970523177594, 0.005293972788928822, 0.014432182796050989,
        -0.01923377649710992, 0.004148046858491086, 0.015227062549691788,
        -0.01885780781443318, 0.0029874905122910466, 0.015973738307862355,
        -0.01843825661207013, 0.002008715616789871, 0.015584532703522565,
        -0.013191654458928467, -0.01499679471766444, 0.06236329031616909,
        -0.11413880710966993, 0.18942455926964796, -0.19783355781752968,
        -0.005677636629150184, 0.12547294403423354, -0.26595808241381963,
        0.16158607824757895, -0.026094749429912804, 0.10878525057639198,
        -0.13708837163552054, 0.24456032121404547, -0.17465650948226907,
        0.06304735166156619, -0.012059545867151139, -0.01610634567728807,
        0.015944196983949055,
      ],
      [
        -1.298263035232889e-6, 3.137666203300518e-5, -0.00029186216910217784,
        0.0017189758647912588, -0.006919912309425793, 0.021609986585275725,
        -0.04599008896358976, 0.08273682226828953, -0.03961462220004418,
        -0.010744636813539285, -0.009760177329659489, 0.010867596704770596,
        -0.005142315693905263, 0.002019868891387489, -0.0006440411381735168,
        0.00014187739996152722, -1.851819424899479e-5, 8.60043179491016e-7,
        -2.9135248503713317e-7, -5.464092256286893e-8, 2.3578998901593537e-7,
        2.9441153623693535e-7, 6.359168784179165e-8, -2.2974559903909774e-7,
        -2.972143324110926e-7, -7.248505496996097e-8, 2.2350533022460002e-7,
        2.997616812928002e-7, 8.131452200620401e-8, -2.1707576052343974e-7,
        -3.0205466358316133e-7, -9.00769930394518e-8, 2.1045785182341505e-7,
        3.040878216725979e-7, 9.876341928888554e-8, -2.0365644861371213e-7,
        -3.058564303503461e-7, -1.0736197558931062e-7, 1.9668203169733612e-7,
        3.0736269931932223e-7, 1.1586714634125217e-7, -1.8954105773603151e-7,
        -3.0860800474283214e-7, -1.2427583004551406e-7, 1.8223497645707365e-7,
        3.0958732371982515e-7, 1.3257858311824493e-7, -1.7477001085772714e-7,
        -3.102974753246456e-7, -1.4076422909237494e-7, 1.6715724777169587e-7,
        3.107419914602816e-7, 1.4882831064423457e-7, -1.5940291724453937e-7,
        -3.1092249493721096e-7, -1.5676769792249692e-7, 1.5150902353300582e-7,
        3.10834510845424e-7, 1.645726983899667e-7, -1.4348305656799293e-7,
        -3.104764732930364e-7, -1.7223303247502874e-7, 1.3533651005375248e-7,
        3.098531444351609e-7, 1.797452793206318e-7, -1.270753020758931e-7,
        -3.089663299335513e-7, -1.8710630488617002e-7, 1.1870202125360553e-7,
        3.078122444612232e-7, 1.9430633314480154e-7, -1.1022532468188961e-7,
        -3.06390970149604e-7, -2.01336146254115e-7, 1.0165688530322075e-7,
        3.0470836490284726e-7, 2.0819340630464247e-7, -9.300223889167684e-8,
        -3.027663889434449e-7, -2.1487493236115048e-7, 8.426459161118601e-8,
        3.0056204248258313e-7, 2.2137106905440126e-7, -7.545362798258091e-8,
        -2.9809708172708567e-7, -2.2767383600941167e-7, 6.658096934854858e-8,
        2.953783192649957e-7, 2.337819337543326e-7, -5.765173626373243e-8,
        -2.924078235729933e-7, -2.396921655937554e-7, 4.866974666574572e-8,
        2.8918348744521534e-7, 2.4539516897332324e-7, -3.964556680453881e-8,
        -2.857087363415664e-7, -2.5088434293907637e-7, 3.0590544073760714e-8,
        2.8199114980478245e-7, 2.561593969673258e-7, -2.150934127423531e-8,
        -2.780329037989134e-7, -2.6121713123233746e-7, 1.240641344379709e-8,
        2.7383287783368907e-7, 2.6604865610834644e-7, -3.2929773485554055e-9,
        -2.6939608233595327e-7, -2.7064886792702925e-7, -5.820052769299951e-9,
        2.6473073911317323e-7, 2.750184342805478e-7, 1.4928511214224837e-8,
        -2.5983908164430157e-7, -2.791541672657224e-7, -2.4027333461885026e-8,
        2.547210609872581e-7, 2.8304784770168877e-7, 3.310481453414781e-8,
        -2.4938319684753923e-7, -2.86695942964722e-7, -4.215071129124463e-8,
        2.43834152530556e-7, 2.90100004454246e-7, 5.11613349746291e-8,
        -2.3807625007448736e-7, -4.60587440669628e-8, -4.0427857077731145e-6,
        3.269547316906679e-5, -0.00016382109278414815, 0.0006282912665816743,
        -0.0018551239494717362, 0.005574363673952416, -0.012404729010507645,
        0.03265653155038923, -0.03185102817610841, 0.010458382228148355,
        -0.0047787834599552085, 0.002171913951246546, -0.0004938632254413705,
        1.017578730711484e-5, 2.5892216271186715e-5, -8.310098016893511e-6,
        1.3763480465791212e-6, 2.3329311202703253e-7,
      ],
    ];
    const result = wavedec(data, "sym19");

    const reconstruction = waverec(result, "sym19", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym20", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.5092481261256588, 0.9369409050736504, 1.2189374678221525,
      1.32171166965858, 1.248186035039578, 1.0349007576025893,
      0.7413913236952675, 0.43458616101272624, 0.17224680839444667,
      -0.010348237121946047, -0.10716964674530749, -0.1400814777589094,
      -0.14991731252144286, -0.18251126151599872, -0.27351261455081194,
      -0.43611996632151756, -0.6551005418117155, -0.8888120936620498,
      -1.0788431890535055, -1.1648750585729777, -1.1009644518141755,
      -0.869016491922046, -0.485874359878902, -0.0020346368665089543,
      0.5078982505416714, 0.9608141359518692, 1.2830081484208704,
      1.426052227152758, 1.3767748864815468, 1.1589650041326307,
      0.8264820092059256, 0.4495943690288474, 0.09803695245345284,
      -0.1749471526907273, -0.34362736773697633, -0.4132316668981357,
      -0.4151589278892805, -0.3954297186417632, -0.39958412210238275,
      -0.4581317942742528, -0.5764874127784871, -0.7321302586835093,
      -0.8798191369976371, -0.9635659664610012, -0.9322729227713779,
      -0.7549345585658936, -0.43135957125144564, 0.0045326540624079925,
      0.48991651867963265, 0.9456803162898834, 1.2934758530549724,
      1.4730582417145708, 1.4556676040196221, 1.2501701573951696,
      0.9004725679567207, 0.47489442209796306, 0.05017757129082473,
      -0.30587820933834114, -0.5488676532545524, -0.665825216553741,
      -0.6750388554376185, -0.6179297733126545, -0.5453231940554752,
      -0.5018497295680437, -0.5126574589077031, -0.5759712783690308,
      -0.6634769785965906, -0.7284366732249737, -0.7193949389268075,
      -0.5958406113600416, -0.3416349323465402, 0.027451542385353966,
      0.4642665379422819, 0.8989830132162953, 1.253994695817052,
      1.4613967880008816, 1.4787439141448802, 1.2991644931739836,
      0.953294139577074, 0.5025204108169604, 0.025191889955045288,
      -0.4008127338939493, -0.7148774944204332, -0.8857261339820588,
      -0.9159346505618517, -0.8379723564154139, -0.7030206214241381,
      -0.5656379147214355, -0.4683584409664177, -0.43027182442002493,
      -0.4425471802687987, -0.4720188671410931, -0.4718209919858718,
      -0.3961937571751977, -0.21546872332382128, 0.07283868584196362,
      0.4399200692214923, 0.8298483311215402, 1.1711940552098947,
      1.3933006716203087, 1.4431925383960995, 1.2988687502435192,
      0.9755963660234765, 0.523543871112095, 0.017251266336574783,
      -0.4605306109952806, -0.8366998623818849, -1.0630241791989843,
      -1.1250722359981178, -1.0428112638452114, -0.8629383266242615,
      -0.6450919042483887, -0.4456065199376638, -0.30304155318412707,
      -0.22919476600418726, -0.20783953169684719, -0.20138405266895876,
      -0.16356826033107452, -0.054726978052308306, 0.14453418751803354,
      0.4250043555839729, 0.748249301568534, 1.0540801312995716,
      1.274364351643279, 1.349755218228094, 1.2451046616315824,
      0.959595871488249, 0.5289191073118116, 0.018793275691261137,
      -0.4886965463740356, -0.912671016295991, -1.1906817457980943,
      -1.2914252391175614, -1.2199218325653605, -1.0140349073138868,
      -0.7333784273238872, -0.44355397955271286, -0.19979096422869552,
      -0.034149801068306285, 0.050529360706794424, 0.07853589799465588,
      0.091792232523322, 0.13561780241396987, 0.2436498403246788,
      0.42603142413708933, 0.6641206031185729, 0.9132678523402347,
      1.1130924743475563, 1.202707698186084, 1.1370109044132701,
      0.8998159135511699, 0.5103503397507019, 0.021285959043517905,
      -0.49140368618718977, -0.9443983622729871, -1.2649606833366391,
      -1.4064894367503349, -1.3579309973882583, -1.1448173663331485,
      -0.8217925544522489, -0.45860855894746594, -0.12317934005994918,
      0.1340310973390469, 0.29041367735100776, 0.35392596961183115,
      0.35763513402442154, 0.34773360840726014, 0.3683481690064408,
      0.4472734860664584, 0.5864962880974085, 0.7601056433908632,
      0.9202372982688575, 1.0095784162934651, 0.9772115390839755,
      0.7936556384511415, 0.4611083750699739, 0.01607388212312033,
      -0.47652433266532607, -0.9364836269121546, -1.28559745406032,
      -1.4648722741536264, -1.4474755278794968, -1.2442513321302422,
      -0.9004873845955158, -0.4847938341324217, -0.07290929123197881,
      0.2695153082983365, 0.5008996181267701, 0.6111027987380024,
      0.6205241222332113, 0.5714146510939709, 0.5138725301608759,
      0.4903365187387548, 0.5227409645321855, 0.6057637462634615,
      0.7079778024448175, 0.7806262916432135, 0.7717215148925891,
      0.6417407659918056, 0.3767283621865912, -0.00476499097409161,
      -0.4529229396394601, -0.8960163984114154, -1.255714962204669,
      -1.464651930402421, -1.4819206134137402, -1.302656953042371,
      -0.959317095520962, -0.5143203427852672, -0.04587429861166886,
      0.36951524253680434, 0.6735496210267903, 0.8376491917059081,
      0.866765918285842, 0.7947696209964576, 0.6728281064794819,
      0.5539678551302092, 0.47793697495578086, 0.46035927519894904,
      0.48900555209533836, 0.5281179463776825, 0.5295945972325116,
      0.44802483622978295, 0.2555296096727315, -0.04762349051505749,
      -0.4295975270367702, -0.8318813125320872, -1.1814802295306424,
      -1.4074785277422748, -1.4578817568267453, -1.3125183672100484,
      -0.9887246855324986, -0.5383198613989484, -0.03654503886167798,
      0.4343569218900948, 0.8029172947296032, 1.0232529026525752,
      1.0833671648453922, 1.0050597491598408, 0.8356931770861498,
      0.634114441293343, 0.45447717183560743, 0.3321878139729486,
      0.27558947127549815, 0.2654604393546781, 0.26233946579102746,
      0.21962998628668, 0.09891264810608463, -0.11669743812265199,
      -0.4148212438317329, -0.7539368612932701, -1.0715371496968762,
      -1.2984103797523416, -1.37550829513716, -1.2691411583598997,
    ]);
    const expected = [
      [
        -1.270040647743199, -0.281692850306999, 0.3256709006102063,
        2.5102959711048887, 0.9487598132077727, 1.5008997220735865,
        2.3283252407457993, -0.17968310848180064, -0.3132197419873526,
        -1.6768239927360522, -1.0719842089075133, -0.22768910834119233,
        0.7822510617989975, 2.5796043075476307, 0.4485195434564663,
        2.268148413433933, 1.6157181255227815, -0.20578182919117544,
        -0.4912052225323805, -2.237380274518177, -0.9539807165991773,
        2.5655661682869444, 1.6030685880380058, -0.6172220416308268,
        -0.7561644174085482, -1.8382231785423315, -0.8613271091212069,
        2.606842054615001, 1.753866146186305, -1.0433875645738568,
        -1.036123980091405, -1.407399019625803, -0.6983789639982282,
        2.545435960708702, 1.8671461148876705, -1.3935914103106508,
        -1.3435984693064187, -0.9620610750107822, -0.46318517835995304,
        2.3937276733406065, 1.9237714574634555, -1.656495122263882,
        -1.65998961119047, -0.5270147414112292, -0.15804841234162523,
        2.168862586546033, 1.9073947263987803, -1.8272969383920463,
        -1.963743536716561, -0.1245605919880708, 0.20848664737725112,
        1.8915749908280695, 1.805965639774457, -1.9078031446633048,
        -2.232006932979966, 0.22705334180595854, 0.6220131257364513,
        1.584472473180599, 1.612954600495939, -1.905985447970185,
        -2.44243188665057, 0.5148264740515462, 1.0631302011061734,
        1.2702147552609444, 1.3281581953387944, -1.8350642888124227,
        -2.574985120002329, 0.7317570392248022, 1.5087356080135659,
        0.9697327116504797, 0.9580290856271936, -1.7123350851251364,
        -2.61274237802902, 0.8736406608363712, 1.9435540872564443,
        0.6750098930851476, 0.5530550341004206, -1.4813826791820905,
        -2.7928471494517657, -2.0242746989151947, 0.0594354528630239,
        0.5090600371202743, 1.6151629019120666, 2.2210236160962724,
        0.9300473823231091, 0.5596288267141866, -0.8729919876283855,
        -2.753672234877636, -2.3318688979146542, -0.35667885720622255,
        0.5720411143832994, 1.295913872476039, 2.035358640205576,
      ],
      [
        -0.013976301918447497, 0.07595656291087374, -0.17118899492353581,
        0.4380305488922209, -0.563182229582763, 0.16692077926679563,
        -0.07821480779910649, -0.0314242368163639, 0.1499697611073547,
        -0.1397481737062418, 0.037833700009689754, 0.05129411340753416,
        -0.17179233352092282, 0.40975468121024494, -0.11222404892023032,
        -0.011366710983760487, -0.06292778046589177, 0.03386585689968583,
        -0.0022053715351233044, -0.007296429319290418, -0.0023427588960091834,
        0.013426496296260302, -0.011028365394557513, -0.0031263124886719514,
        0.013875535997663257, -0.009596226428245947, -0.005078146403076844,
        0.014252635929412538, -0.007988014415235719, -0.006927935021292901,
        0.014339331365538272, -0.006220548266923873, -0.008636787480367066,
        0.014139883613715439, -0.004325979819222995, -0.010172895558681935,
        0.013652274053981268, -0.002345659494118194, -0.011502261341749174,
        0.0128923811388659, -0.00031674085373800724, -0.012601454800476869,
        0.011869506859752446, 0.0017174602926475072, -0.013444593751104746,
        0.010610246508838466, 0.0037179351257297863, -0.01401871389730642,
        0.00913410660710282, 0.005642731341213846, -0.014307897850208782,
        0.0074766312221860925, 0.007454238989692116, -0.014310935337546009,
        0.005665604576851197, 0.009115137219540177, -0.014022884833872883,
        0.003743021511089512, 0.010592307259936793, -0.013454670864145608,
        0.001742367987434615, 0.011856006344537779, -0.012612424807017481,
        -0.00029094464983571395, 0.012880287783252911, -0.011518643100152564,
        -0.0023207415393678237, 0.013645376886517267, -0.010189707054173283,
        -0.004302441966304969, 0.01415453436627258, -0.008860816538557739,
        -0.004901602837286853, 0.00855119279407543, 0.012355431034307437,
        -0.06224941535216604, 0.11643556194804912, -0.22456231171306687,
        0.04185646113868064, 0.02347899621919129, 0.038031507209674714,
        -0.042183962877506344, -0.018827989637529168, 0.06858204539190593,
        -0.07672757814067367, 0.10503257797551492, -0.22691288309308538,
        0.2864600478033805, -0.08221022435961821, 0.06612314261168688,
        -0.03987628227126133, 0.01068975627012359, 0.009344968119614864,
      ],
      [
        8.121951231736085e-7, -1.4440383129235701e-5, 0.0001354238108017541,
        -0.0007927483603961668, 0.0032734530103349663, -0.010384574459941339,
        0.026668472586421955, -0.054861637026300175, 0.11110490011278903,
        -0.08406022714179318, 0.01701768118182678, -0.015417678785940157,
        0.011296312480312029, -0.005503588030318243, 0.0019814464834001437,
        -0.0005326947359819572, 0.00010018063954415049, -1.1527620738876626e-5,
        6.755915529196784e-7, -7.111172441508938e-8, -1.1831964727465377e-7,
        -5.2028993241373814e-8, 6.41708454757743e-8, 1.188147572411034e-7,
        5.948545051496523e-8, -5.690498630382525e-8, -1.1870838497195095e-7,
        -6.66397144348816e-8, 4.935345844557009e-8, 1.1800358814538168e-7,
        7.34573713089223e-8, -4.155398295495575e-8, -1.1670493664095538e-7,
        -7.990614556016112e-8, 3.3543263485997435e-8, 1.1481652767684318e-7,
        8.595193856098864e-8, -2.5361946027563486e-8, -1.1234672338493835e-7,
        -9.156198016978164e-8, 1.70540142258515e-8, 1.0931035093014585e-7,
        9.670935578935743e-8, -8.6613757900789e-9, -1.0572408731578338e-7,
        -1.0137041702980597e-7, 2.2370282161202624e-10, 1.0160375553144128e-7,
        1.0552041033282365e-7, 8.21656096732488e-9, -9.696865280825354e-8,
        -1.0913595802280318e-7, -1.6614141136064118e-8, 9.184435026078838e-8,
        1.1219987164021907e-7, 2.4926309757312627e-8, -8.625836400936938e-8,
        -1.1469918529385484e-7, -3.3113761363315825e-8, 8.02368319136775e-8,
        1.1662039897979087e-7, 4.113568493782654e-8, -7.380835363540955e-8,
        -1.1795124725885951e-7, -4.8948980805270204e-8, 6.700731869349745e-8,
        1.1868572713039926e-7, 5.651350210735881e-8, -5.986998005065606e-8,
        -1.1882274434009638e-7, -6.379362733896606e-8, 5.243056054142168e-8,
        1.1836106787435697e-7, 7.075349010560259e-8, -4.4724571021458684e-8,
        -1.1730038784741128e-7, -7.735546838989212e-8, 3.679255385353235e-8,
        1.1564640983518329e-7, 8.356516944888294e-8, -2.867672808490876e-8,
        -1.1341014051565829e-7, -8.935367777797709e-8, 2.0416539851546004e-8,
        1.1060271720257572e-7, 9.469300521738148e-8, -1.2051417345139996e-8,
        -1.0723563286496443e-7, -9.955385156351973e-8, 3.6249398042356925e-9,
        1.0332584052095238e-7, 1.0391029467050133e-7, 4.817991282528982e-9,
        -9.889576726634455e-8, -1.0774259106669226e-7, -1.3235954647804464e-8,
        9.396798512465576e-8, 1.110329472686176e-7, 2.1588907695119205e-8,
        -8.856470880791397e-8, -1.1376260149163165e-7, -2.983365674199424e-8,
        8.271280982701351e-8, 1.1591609230174012e-7, 3.792606761145135e-8,
        -7.644446111674178e-8, -1.1748456354399209e-7, -4.582614572767507e-8,
        6.979189018954561e-8, 1.1846194111765766e-7, 5.3496586202844485e-8,
        -6.278608440985524e-8, -1.188413891593334e-7, -6.089800382408286e-8,
        5.546163035495125e-8, 1.1861902850028774e-7, 6.799041491451284e-8,
        -4.7858054454984953e-8, -1.1779774457453417e-7, -7.473850384448453e-8,
        4.001467886553482e-8, 1.1638377271378435e-7, 8.111085786712081e-8,
        -3.196860423389328e-8, -1.1438262165346975e-7, -8.707502564096382e-8,
        2.3759345648732107e-8, 1.1180220487164742e-7, -3.373751379089939e-7,
        8.287195248398064e-6, -7.686917290663618e-5, 0.00044720006587584685,
        -0.0018394066184844818, 0.00581559278525746, -0.014902751341363384,
        0.03062383438430728, -0.06211595209889635, 0.04689072449304655,
        -0.00929087751156536, 0.008506817911991715, -0.006275745751310157,
        0.003070284895244443, -0.0011101926421047692, 0.00029972629419279084,
        -5.6723474972548806e-5, 6.625642075489706e-6, -2.5669786954432186e-7,
      ],
    ];
    const result = wavedec(data, "sym20");

    const reconstruction = waverec(result, "sym20", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });

  test("test_sym20_odd", async () => {
    await init();
    const data = new Float64Array([
      0.0, 0.48422102311307047, 0.89617962628356, 1.1782405787891626,
      1.2986800541904848, 1.257075936837865, 1.082647890222141,
      0.8260545187758569, 0.5466901065116718, 0.2985637553586673,
      0.11814202353057468, 0.01702337917243496, -0.01888541253061013,
      -0.02361447695943751, -0.040325594138299115, -0.10821319453483885,
      -0.25042512318337473, -0.46606775770553327, -0.7283652971939508,
      -0.9895421209686194, -1.1913517868960166, -1.278783385704469,
      -1.2136722399773532, -0.9849227949339074, -0.6128241903429453,
      -0.14632047492565856, 0.34624161896158023, 0.7908208035172286,
      1.1227216105786877, 1.2995257139122227, 1.3089708438547558,
      1.1700284619670744, 0.927036863718743, 0.6383791508482863,
      0.3624657517127779, 0.14438638923998298, 0.0063939109726637855,
      -0.05557660841853737, -0.06863298548296316, -0.07382349914563335,
      -0.11355228900337827, -0.2187022045980972, -0.3987229171041603,
      -0.6372179889406022, -0.8942227539200113, -1.114728733751948,
      -1.2414744943157303, -1.2289582306266593, -1.055292012568435,
      -0.728994624384276, -0.2889973323029896, 0.2022655815792383,
      0.6711735759179727, 1.0478524987455353, 1.2803081027631324,
      1.3445310311683587, 1.248294588409793, 1.0278552048001848,
      0.738436235654515, 0.44082960290308076, 0.18734018213936832,
      0.010413598155437631, -0.08339597235139076, -0.11277861168252615,
      -0.11463471188637037, -0.13250016926763358, -0.20337708486943762,
      -0.3462991749097935, -0.5555344183892639, -0.8001943269981384,
      -1.030452847796115, -1.1889560522304987, -1.2247179113735487,
      -1.106158722300587, -0.8301070488282856, -0.424516499539095,
      0.05587567918003664, 0.5400525355507166, 0.9550254653461021,
      1.2406812626925907, 1.361769603865005, 1.3143045145974845,
      1.1249705961942447, 0.8437723999900943, 0.5317498054095603,
      0.2467255602138937, 0.030481386453713788, -0.09962442846162411,
      -0.15268769098541496, -0.15958183701224363, -0.16285099830271088,
      -0.20376531136847786, -0.30981459049177706, -0.4858030682706251,
      -0.7108253914896339, -0.9419654028207344, -1.1239114339613445,
      -1.2022225222391383, -1.1370618466554425, -0.9140597228977367,
      -0.5496182396964762, -0.08926952757907693, 0.4006601776986818,
      0.8462400975963816, 1.1809809928221453, 1.3592931025816086,
      1.3652802414927128, 1.2148920295906702, 0.9510204861528063,
      0.6327844342296391, 0.3215997995535173, 0.06736328829828486,
      -0.10199138597092922, -0.18515264614097277, -0.20531369928615031,
      -0.20193729681034095, -0.21854430525587154, -0.2896265953050209,
      -0.42998886655794083, -0.6292248191510457, -0.8527753907779889,
      -1.0494040515308776, -1.1633455275584923, -1.1482211001018223,
      -0.9793475753424581, -0.6614126085591887, -0.2295658123717192,
      0.25647327904750467, 0.7240334476031898, 1.1022153998084199,
      1.3363547335722867, 1.398910632169971, 1.2943046552439799,
      1.056657700921788, 0.7410426430890954, 0.4103867619577056,
      0.12116030785423682, -0.08876260510085099, -0.20724449477936738,
      -0.2484330259923077, -0.24673209299666396, -0.24580540498519354,
      -0.28542139219538704, -0.38946245173105115, -0.5581278912687173,
      -0.7663297709785971, -0.9687629173696497, -1.1104909848702325,
      -1.140525394403552, -1.0251134767300318, -0.7574813420073281,
      -0.3615913889255595, 0.11111926285716121, 0.5913904874446334,
      1.0060308855839013, 1.2928840117552367, 1.4134375655553206,
      1.3601917512975403, 1.157134123349741, 0.8532888791194855,
      0.5109318301890664, 0.19130095161631938, -0.05880826252500376,
      -0.21642509533303653, -0.2856258698453519, -0.29396439660343676,
      -0.28312761819901716, -0.296228234489516, -0.3649515146998725,
      -0.4997963592141583, -0.6858862289116703, -0.8854586494969275,
      -1.0465025800543297, -1.1154967724414164, -1.0511757744526222,
      -0.835962436775503, -0.4822282943632941, -0.03175291146424877,
      0.45163820410726174, 0.8946548158127605, 1.229491720570015,
      1.407721965226688, 1.4099459541334691, 1.2490024341847576,
      0.9660599835194756, 0.6205782977242245, 0.2765586098627226,
      -0.011648701225776381, -0.21064499021526834, -0.31378799949067904,
      -0.34024373830182886, -0.3276703595692168, -0.3204580524687306,
      -0.3565160029252411, -0.4559361514412763, -0.6143931269500005,
      -0.8029744846448799, -0.9745566818043838, -1.0752312060724625,
      -1.0580310877972445, -0.8956143242551184, -0.5887725961698292,
      -0.16860259569817398, 0.30832722036366916, 0.7708169698837107,
      1.1474500000479881, 1.381287270611095, 1.4414656569889002,
      1.329044096479888, 1.0757908751176026, 0.7362624101010233,
      0.37509317894103356, 0.05252382919400522, -0.18842323508375003,
      -0.3301435961640047, -0.38218918181897776, -0.3762817532916148,
      -0.3559649986338601, -0.36354809385442927, -0.42763575208267257,
      -0.5543810640266906, -0.7246770480793207, -0.8980433559434023,
      -1.0223184443508408, -1.046832270312792, -0.9358572876144984,
      -0.6790293799654203, -0.2961232714108946, 0.16510528630907195,
      0.6376526534795987, 1.0486482890257076, 1.3343387472393258,
      1.4532330291420044, 1.3943873469239498, 1.178944197450881,
      0.8546235683105663, 0.4845154021886833, 0.1328482521586567,
      -0.14890626583329314, -0.33235187807563377, -0.4165580514175351,
      -0.4256185059960069, -0.40012863955180444, -0.3847969330089099,
      -0.4153275152243541, -0.5078700336862099, -0.6536916372494845,
      -0.8204397225294185, -0.9597438687366255, -1.0193423599810352,
      -0.9567906095430154, -0.7513890351401895, -0.4113597224820382,
      0.025587285096891954, 0.49859102901224217,
    ]);
    const expected = [
      [
        -0.8945194863524836, -0.05414091384517759, 0.5829096964212579,
        2.5281407253417094, 0.8933968212204401, 1.4506358452700094,
        2.408085317457442, 0.08282453986033186, -0.03165600188563263,
        -1.344875873817948, -0.7461607699117824, 0.037046813141754974,
        1.0051962441434033, 2.544977964495556, 0.41619906887100916,
        2.2044143699074894, 1.7628926872006219, 0.05119657390894705,
        -0.1304916168566058, -2.054803653739789, -1.9761564083590506,
        1.5885039267803671, 2.2707061700228643, 0.3260488248445467,
        -0.04785419408142667, -1.3151312935029564, -2.5029458715785213,
        0.4293775466206688, 2.6358538282495436, 0.8656440371274745,
        -0.11749477767071848, -0.683344809031627, -2.4494813745771014,
        -0.8329583666048397, 2.4619824423507124, 1.6336625812726246,
        -0.11661072469058026, -0.3440321057371472, -1.955685664578415,
        -1.8432519372344602, 1.7054122348735392, 2.3664361458137,
        0.16903823286107808, -0.30305207836607617, -1.299517451575278,
        -2.349641698546198, 0.5391125243696102, 2.753143489279456,
        0.8037355395201023, -0.39024275967686295, -0.7677732522055669,
        -2.2991923564834833, -0.7105844586567767, 2.5749176238298426,
        1.6552957640332178, -0.3535192208806185, -0.5269233088345108,
        -1.8460998150945773, -1.693921952732493, 1.808044695660221,
        2.441112658849417, 0.007728008929128448, -0.5542613958592674,
        -1.269976691834783, -2.17699721747498, 0.644078517443461,
        2.847117613175041, 0.7321681742549296, -0.6600137438718698,
        -0.8423437433907036, -2.1289579162489254, -0.5829429564156084,
        2.6663805428601566, 1.6599588110273056, -0.5850150382197089,
        -0.7231993155131874, -1.6744771085847598, -1.3262639365217226,
        0.6333444956362388, -1.9517515554044258, -1.2857570534608493,
        -0.8476286086255551, -0.20405280252660893, 0.8732873515808215,
        -0.9301405423887238, -0.8164413633951436, -1.9369246711756662,
        -0.600816690642851, 0.21746353934853432, -2.2346595173986246,
        -0.9296579321267014, -0.9114038615848169, 0.33279988361767304,
      ],
      [
        -0.01735255662554054, 0.0706472798376268, -0.15459517193317932,
        0.40182117082169433, -0.5177082722892844, 0.14173114026792796,
        -0.05258426799683323, -0.06185629438861834, 0.20042052932366927,
        -0.17214267444287956, 0.03843024167493874, 0.04255935380143135,
        -0.15345877338270889, 0.37761545918261097, -0.09733218290146517,
        -0.018632330604380357, -0.052584834667846705, 0.028947115133938845,
        -0.004635832486142752, -0.0010772891285198538, -0.005504026764840398,
        0.009329659819350765, -0.002944642092881704, -0.006806044668275064,
        0.008341235387784893, 0.0001706656221456592, -0.008477396485223972,
        0.006573275646222602, 0.0032482464537889905, -0.009157007091076506,
        0.0040367955152978965, 0.005945441463833739, -0.00876702906748459,
        0.0010288188653194965, 0.007948622658231843, -0.007351932706076772,
        -0.0020995167185285583, 0.009022183950085349, -0.005078351623084593,
        -0.004982490585377825, 0.009042084479584926, -0.0022105816099340357,
        -0.007283095929250202, 0.008004709904400453, 0.0009147485019711212,
        -0.008732819550549324, 0.006032420790133751, 0.003933976031107311,
        -0.00916167733436877, 0.0033547509032689385, 0.006492672285437903,
        -0.00852033817762465, 0.00028536150278228963, 0.0082934211748981,
        -0.006882764048171845, -0.0028175815805697034, 0.009124229165662004,
        -0.004441486678306537, -0.005591171757400697, 0.008889489350883005,
        -0.0014804811636689801, -0.007711339648384368, 0.00761525910113566,
        0.001652789700215767, -0.00893050547662393, 0.005451682376190434,
        0.004593695548500038, -0.009105770251605054, 0.0026499522860300075,
        0.007005553459285438, -0.008277669057402409, -0.00022234844005421126,
        0.00812353122692346, -0.006853721991368428, 0.0035560810334589184,
        -0.014990592000902716, 0.048099416584392825, -0.01179734604380005,
        -0.2776926001382485, 0.037742834855308036, 0.030688747991577843,
        -0.04287966052773141, 0.17871996864119336, -0.20367376988179578,
        0.037447795421839715, 0.05442094937758884, -0.09482292441336909,
        0.44921048540031233, -0.261261722729997, 0.09139547454441599,
        -0.02595636950457074, 0.004672572871704905, -0.00585435812929114,
      ],
      [
        7.641550134841318e-7, -1.381587043749736e-5, 0.00012878078113897232,
        -0.0007526800713651137, 0.0031031243540188087, -0.009831244346510632,
        0.02522596947444229, -0.05187021200869975, 0.10510710517468588,
        -0.0794519101812796, 0.01595118020738699, -0.014511215502539596,
        0.01066114901313492, -0.005202604866849441, 0.0018762678169477638,
        -0.000505308588146062, 9.516113243469549e-5, -1.1023154150610278e-5,
        6.425983983554055e-7, -1.968322323190217e-8, -6.199032258800751e-8,
        -4.834988601442787e-8, 8.927348857716868e-9, 5.814746918053441e-8,
        5.4888285117292507e-8, 2.0913344194250316e-9, -5.2592926069055356e-8,
        -5.981074446390114e-8, -1.3047934276017436e-8, 4.549093559730902e-8,
        6.297313932353958e-8, 2.3620529247210995e-8, -3.7050304950664856e-8,
        -6.428255614127625e-8, -3.349845977582839e-8, 2.7518722435942494e-8,
        6.369968834866395e-8, 4.239036959210851e-8, -1.717705071153921e-8,
        -6.124163625406592e-8, -5.003414259324067e-8, 6.330346324744983e-9,
        5.698152652850817e-8, 5.62054979492591e-8, 4.702588163815616e-9,
        -5.104467891352015e-8, -6.072310843850591e-8, -1.5597640733404506e-8,
        4.360504695432707e-8, 6.345328501695196e-8, 2.603364080076757e-8,
        -3.488178274445826e-8, -6.431546237582407e-8, -3.5702889695451776e-8,
        2.5132366610992043e-8, 6.328503931251316e-8, 4.432141260340097e-8,
        -1.4643450631835524e-8, -6.03924250223814e-8, -5.16359983635171e-8,
        3.7230364854831652e-9, 5.572198140869566e-8, 5.7430688335811704e-8,
        7.307059710909031e-9, -4.941118832103143e-8, -6.153459695238728e-8,
        -1.8121573902024703e-8, 4.1646567831855804e-8, 6.382765431995163e-8,
        2.8402702138538086e-8, -3.2656492667890094e-8, -6.424261412264582e-8,
        -3.7848420590236775e-8, 2.27048109857385e-8, 6.276650586463247e-8,
        4.618014687844366e-8, -1.2084673643714544e-8, -5.9442644031535405e-8,
        -5.315217724105788e-8, 1.1093640885884864e-9, 5.43696391219973e-8,
        5.8559978100852497e-8, 9.89845680822968e-9, -4.769680492367925e-8,
        -6.224475411645215e-8, -2.0615471582783408e-8, 3.961975317654624e-8,
        6.409735765623612e-8, 3.072580146134842e-8, -3.037631780726732e-8,
        -6.406298158593873e-8, -3.993127782391518e-8, 2.0239310068137196e-8,
        6.214339542114714e-8, 4.796152522954115e-8, -9.506860934597561e-9,
        -5.839524629204331e-8, -5.458071321880216e-8, -1.5058851083116582e-9,
        5.292808623573986e-8, 5.959338725953606e-8, 1.2474473271727804e-8,
        -4.5902771337956386e-8, -6.285161060174706e-8, -2.3075400119372785e-8,
        3.752685251808919e-8, 6.42601730555901e-8, 3.299708947762649e-8,
        -2.8046774033076253e-8, -6.377793776293686e-8, -4.194814477023122e-8,
        1.7740787772098108e-8, 6.141834210202078e-8, 4.966460041287433e-8,
        -6.912400039775447e-9, -5.725065075977621e-8, -5.591880216972151e-8,
        -4.118952474850399e-9, 5.139828711545851e-8, 6.052729091772652e-8,
        1.502888776864072e-8, -4.403358238598214e-8, -6.335486935678529e-8,
        -2.549700942871965e-8, 3.537251007300691e-8, 6.431765290675683e-8,
        3.5214813863367605e-8, -3.0221226579051495e-7, 4.535374775074916e-6,
        -3.485207567287662e-5, 0.00015900623636184625, -0.00047838073428835325,
        0.0008916402426272427, -0.0008224679199545208, 0.0006452739476874746,
        -0.00023426038793297578, 0.053717373123342634, -0.07223285639409215,
        0.024103321010866367, -0.007522524559981936, 0.002123745157567722,
        -0.0002636867975263591, -0.00010745841413776487, 6.722231909067335e-5,
        -1.7761577718652195e-5, 2.4775749251479476e-6, -1.7693562456652057e-7,
      ],
    ];
    const result = wavedec(data, "sym20");

    const reconstruction = waverec(result, "sym20", data.length);
    expectArrayCloseTo(reconstruction, data);

    expect(result.length).toBe(expected.length);

    for (let i = 0; i < result.length; i++) {
      expectArrayCloseTo(result[i], expected[i]);
    }
  });
});
// prettier-ignore-end
